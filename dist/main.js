function t(t){const e=t.split(","),i=e[0],n=e[1],s=-1!==i.indexOf(";base64"),r=i.match(/data:([^;]+)/),a=r?r[1]:"application/octet-stream";let o;if(s){const t=atob(n),e=t.length,i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.charCodeAt(n);o=i}else{const t=decodeURIComponent(e[1]),i=t.length,n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t.charCodeAt(e);o=n}return new Blob([o],{type:a})}class e{static#t=null;static#e={};static#i=null;static#n=[];static#s=null;static#r="app-cache";static#a=1;static#o="files";static#h="meta";static#l={html:"text/html",htm:"text/html",js:"application/javascript",mjs:"application/javascript",css:"text/css",json:"application/json",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",txt:"text/plain",xml:"application/xml"};constructor(){if(e.#t)return e.#t;e.#t=this}static async#u(){return this.#s?this.#s:new Promise((t,e)=>{const i=indexedDB.open(this.#r,this.#a);i.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this.#o)||e.createObjectStore(this.#o,{keyPath:"path"}),e.objectStoreNames.contains(this.#h)||e.createObjectStore(this.#h,{keyPath:"key"})},i.onsuccess=()=>{this.#s=i.result,t(this.#s)},i.onerror=()=>e(i.error),i.onblocked=()=>{}})}static async#c(t,e,i={}){const n=await this.#u();return new Promise((s,r)=>{const a=n.transaction(this.#o,"readwrite").objectStore(this.#o),o={path:t,value:e,meta:i},h=a.put(o);h.onsuccess=()=>s(!0),h.onerror=()=>r(h.error)})}static async#d(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#o,"readonly").objectStore(this.#o).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#f(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction(this.#o,"readonly").objectStore(this.#o).getAll();n.onsuccess=()=>{const t=n.result||[],i={};for(const e of t)i[e.path]=e.value;e(i)},n.onerror=()=>i(n.error)})}static async#p(t,e){const i=await this.#u();return new Promise((n,s)=>{const r=i.transaction(this.#h,"readwrite").objectStore(this.#h).put({key:t,value:e});r.onsuccess=()=>n(!0),r.onerror=()=>s(r.error)})}static async#g(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#h,"readonly").objectStore(this.#h).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#v(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction([this.#o,this.#h],"readwrite");n.objectStore(this.#o).clear(),n.objectStore(this.#h).clear(),n.oncomplete=()=>e(!0),n.onerror=()=>i(n.error)})}static#m(t){const e=new Uint8Array(t);let i="";for(let t=0;t<e.length;t+=32768){const n=e.subarray(t,t+32768);i+=String.fromCharCode.apply(null,n)}return btoa(i)}static#y(t){if("string"!=typeof t)return!1;const e=t.replace(/\s+/g,"");return-1===e.indexOf("ï¿½")&&(e.length%4==0&&/^[A-Za-z0-9+/]+={0,2}$/.test(e))}static async load(t,e=[],i=null){if(this.#i===t)return;this.#e={},this.#n=[...e];try{await this.#u()}catch(n){return console.warn("IndexedDB unavailable, falling back to memory-only cache.",n),void await this.#x(t,e,!1,i)}if(await this.#g("version")===t)try{const n=await this.#f();let s=0;const r=e.length;for(const t of e)if(Object.prototype.hasOwnProperty.call(n,t)?this.#e[t]=n[t]:this.#e[t]=null,s++,i){i({percentage:Math.round(s/r*100),file:s,totalFiles:r})}return void(this.#i=t)}catch(n){return console.warn("Failed to read cache from DB, reloading from network.",n),void await this.#x(t,e,!0,i)}else await this.#x(t,e,!0,i)}static async#x(t,e,i=!0,n=null){let s=0;const r=e.length,a=e.map(async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const n=await e.arrayBuffer();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB:",t,e)}}catch(e){try{const e=await fetch(t);if(!e.ok)throw new Error("fallback failed");const n=await e.text();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB (text):",t,e)}}catch(e){this.#e[t]=null}}finally{if(s++,n){const t=Math.round(s/r*100);n({percentage:t,file:s,totalFiles:r})}}});if(await Promise.all(a),i)try{await this.#p("version",t)}catch(t){console.warn("Failed to write version meta to DB",t)}this.#i=t}static get(t){return t in this.#e?this.#e[t]:null}static getBlob(i,n={returnBlob:!1}){const s=this.#e[i];if(null==s)return{dataUrl:null,blob:null};const r=(i.split(".").pop()||"").toLowerCase(),a=this.#l[r]||"application/octet-stream";if("string"==typeof s&&s.startsWith("data:")){const e=s;return{dataUrl:e,blob:n.returnBlob?t(e):null}}if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)){const t=s instanceof ArrayBuffer?s:s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength);return{dataUrl:`data:${a};base64,${e.#m(t)}`,blob:n.returnBlob?new Blob([t],{type:a}):null}}if("string"==typeof s){const i=s.trim(),r=i.startsWith('"')&&i.endsWith('"')||i.startsWith("'")&&i.endsWith("'")?i.slice(1,-1):i;if(r.startsWith("data:")){const e=r;return{dataUrl:e,blob:n.returnBlob?t(e):null}}const o=r.replace(/\s+/g,"");if(this.#y(o)){const e=`data:${a};base64,${o}`;return{dataUrl:e,blob:n.returnBlob?t(e):null}}const h=(new TextEncoder).encode(r);return{dataUrl:`data:${a};base64,${e.#m(h.buffer)}`,blob:n.returnBlob?new Blob([h],{type:a+";charset=utf-8"}):null}}const o=JSON.stringify(s),h=(new TextEncoder).encode(o);return{dataUrl:`data:application/json;charset=utf-8;base64,${e.#m(h.buffer)}`,blob:n.returnBlob?new Blob([h],{type:"application/json;charset=utf-8"}):null}}static async clear(){this.#e={},this.#i=null,this.#n=[];try{await this.#v()}catch(t){console.warn("Failed to clear IndexedDB",t)}}static getVersion(){return this.#i}static getFileList(){return[...this.#n]}}function i(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function n(){return{username:localStorage.getItem("username"),password:localStorage.getItem("password")}}function s(t,e){return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})}function r(t){return Array.from(document.querySelectorAll(t))}function a(){return[{type:"image",key:"lightRadial",url:e.getBlob("assets/masks/lightMask.png").dataUrl},{type:"image",key:"wah",url:e.getBlob("assets/wah.png").dataUrl},{type:"image",key:"props",url:e.getBlob("assets/game/props.png").dataUrl},{type:"image",key:"plants",url:e.getBlob("assets/game/plants.png").dataUrl},{type:"image",key:"building",url:e.getBlob("assets/game/building.png").dataUrl},{type:"image",key:"animated",url:e.getBlob("assets/game/animated.png").dataUrl},{type:"image",key:"tilemap",url:e.getBlob("assets/tilemap.png").dataUrl},{type:"spritesheet",key:"grass2",url:e.getBlob("assets/game/grass2.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"dirt",url:e.getBlob("assets/game/dirt.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"flame",url:e.getBlob("assets/masks/flame.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}}]}function o(t,e){const i=t.load;for(const t of e){const{type:e,key:n,url:s}=t;"image"===e?i.image(n,s):"spritesheet"===e?i.spritesheet(n,s,t.frameConfig||{}):"audio"===e?i.audio(n,s):"json"===e?i.json(n,s):i.file(n,{type:e||"image",url:s})}}function h(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(n.result),n.readAsDataURL(t)})}async function l(t){const e=new Image;return await new Promise((i,n)=>{e.onerror=()=>n(new Error("Could not load image")),e.onload=()=>i(e),e.src=t})}function u(t,e,i=128){const n=e.getContext("2d");n.clearRect(0,0,i,i);const s=t.width/t.height;let r=i,a=i;s>1?a=i/s:s<1&&(r=i*s);const o=Math.round((i-r)/2),h=Math.round((i-a)/2);n.drawImage(t,o,h,r,a)}async function c(t,e){const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await i.text().catch(()=>"");let s=null;try{s=n?JSON.parse(n):null}catch{}if(!i.ok){const t=s&&s.error||n||`HTTP ${i.status}`;throw new Error(t)}return s}const d=3,f=32,p=3,g=16,v=8,m=16,y="/api/friends/list",x="/api/friends/requests",w="/api/friends/pending",b="/api/friends/send",T="/api/friends/cancel",S="/api/friends/accept",E="/api/friends/deny",_="/api/friends/remove",C="/api/auth/check",A="https://discord.gg/P8yrhaeCgy",P=[{name:"zt3xdv2",username:"tsumugi_dev",role:"Main Development"},{name:"Asura",username:"asurawhite_1",role:"Domain gifter :3"}],M=["You can change your in-game avatar in profile page","You can change your username in profile page"];const R="0.0.1-beta",L="0.0.2-release",O="tsumugi_dev";class F{static queue=[];static isShowing=!1;static add(t,e,i){this.queue.push({title:t,html:e,callback:i}),this.showNext()}static showNext(){if(this.isShowing||0===this.queue.length)return;const t=this.queue.shift();this.isShowing=!0;const e=document.createElement("div");e.className="alert",e.innerHTML=`\n            <h3 class="title">${t.title}</h3>\n            <div class="content">${t.html}</div>\n            <button class="btn close-btn">Accept</button>\n        `,document.body.appendChild(e);e.querySelector(".close-btn").addEventListener("click",()=>{t.callback?t.callback():this.closeAlert(e)})}static closeAlert(t){t.classList.add("fade-out"),t.addEventListener("transitionend",()=>{t.remove(),this.isShowing=!1,this.showNext()})}}var D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function I(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var k,B,N,z,U,Y,X,G,W,H,V,j,q,K,Z,J,$,Q,tt,et,it,nt,st,rt,at,ot,ht,lt,ut,ct,dt,ft,pt,gt,vt,mt,yt,xt,wt,bt,Tt,St,Et,_t,Ct,At,Pt,Mt,Rt,Lt,Ot,Ft,Dt,It,kt,Bt,Nt,zt,Ut,Yt,Xt,Gt,Wt,Ht,Vt,jt,qt,Kt,Zt,Jt,$t,Qt,te,ee,ie,ne,se,re,ae,oe,he,le,ue,ce,de,fe,pe,ge,ve,me,ye,xe,we,be,Te,Se,Ee,_e,Ce,Ae,Pe,Me,Re,Le,Oe,Fe,De,Ie,ke,Be,Ne,ze,Ue,Ye,Xe,Ge,We,He,Ve,je,qe,Ke,Ze,Je,$e,Qe,ti,ei,ii,ni,si,ri,ai,oi,hi,li,ui,ci,di,fi,pi,gi,vi,mi,yi,xi,wi,bi,Ti,Si,Ei,_i,Ci,Ai,Pi,Mi,Ri,Li,Oi,Fi,Di,Ii,ki,Bi,Ni,zi,Ui,Yi,Xi,Gi,Wi,Hi,Vi,ji,qi,Ki,Zi,Ji,$i,Qi,tn,en,nn,sn,rn,an,on,hn,ln,un,cn,dn,fn,pn,gn,vn,mn,yn,xn,wn,bn,Tn,Sn,En,_n,Cn,An,Pn,Mn,Rn,Ln,On,Fn,Dn,In,kn,Bn,Nn,zn,Un,Yn,Xn,Gn,Wn,Hn,Vn,jn,qn,Kn,Zn,Jn,$n,Qn,ts,es,is,ns,ss,rs,as,os,hs,ls,us,cs,ds,fs,ps,gs,vs,ms,ys,xs,ws,bs,Ts,Ss,Es,_s,Cs,As,Ps,Ms,Rs,Ls,Os,Fs,Ds,Is,ks,Bs,Ns,zs,Us,Ys,Xs,Gs,Ws,Hs,Vs,js,qs,Ks,Zs,Js,$s,Qs,tr,er,ir,nr,sr,rr,ar,or,hr,lr,ur,cr,dr,fr,pr,gr,vr,mr,yr,xr,wr,br,Tr,Sr,Er,_r,Cr,Ar,Pr,Mr,Rr,Lr,Or,Fr,Dr,Ir,kr,Br,Nr,zr,Ur,Yr,Xr,Gr,Wr,Hr,Vr,jr,qr,Kr,Zr,Jr,$r,Qr,ta,ea,ia,na,sa,ra,aa,oa,ha,la,ua,ca,da,fa,pa,ga,va,ma,ya,xa,wa,ba,Ta,Sa,Ea,_a,Ca,Aa,Pa,Ma,Ra,La,Oa,Fa,Da,Ia,ka,Ba,Na,za,Ua,Ya,Xa,Ga,Wa,Ha,Va,ja,qa,Ka,Za,Ja,$a,Qa,to,eo,io,no,so,ro,ao,oo,ho,lo,uo,co,fo,po,go,vo,mo,yo,xo,wo,bo,To,So,Eo,_o,Co,Ao,Po,Mo,Ro,Lo,Oo,Fo,Do,Io,ko,Bo,No,zo,Uo,Yo,Xo,Go,Wo,Ho,Vo,jo,qo,Ko,Zo,Jo,$o;function Qo(){return N?B:(N=1,B={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27})}function th(){if(U)return z;U=1;return z={DEFAULT:0,LINEAR:0,NEAREST:1}}function eh(){if(X)return Y;X=1;var t={VERSION:"3.90.0",LOG_VERSION:"v390",BlendModes:Qo(),ScaleModes:th(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};return Y=t}function ih(){if(W)return G;W=1;return G=function(t){if(!t||"object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}}function nh(){if(V)return H;V=1;var t=ih(),e=function(){var i,n,s,r,a,o,h=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof h&&(c=h,h=arguments[1]||{},l=2),u===l&&(h=this,--l);l<u;l++)if(null!=(i=arguments[l]))for(n in i)s=h[n],h!==(r=i[n])&&(c&&r&&(t(r)||(a=Array.isArray(r)))?(a?(a=!1,o=s&&Array.isArray(s)?s:[]):o=s&&t(s)?s:{},h[n]=e(c,o,r)):void 0!==r&&(h[n]=r));return h};return H=e}function sh(){if(q)return j;q=1;return j={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12}}function rh(){if(Z)return K;Z=1;return K=function(t){return t.y+t.height-t.height*t.originY}}function ah(){if($)return J;$=1;return J=function(t){return t.x-t.width*t.originX+.5*t.width}}function oh(){if(tt)return Q;tt=1;return Q=function(t,e){var i=t.width*t.originX;return t.x=e+i-.5*t.width,t}}function hh(){if(it)return et;it=1;return et=function(t,e){return t.y=e+t.height*t.originY,t}}function lh(){if(st)return nt;st=1;var t=rh(),e=ah(),i=oh(),n=hh();return nt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function uh(){if(at)return rt;at=1;return rt=function(t){return t.x-t.width*t.originX}}function ch(){if(ht)return ot;ht=1;return ot=function(t,e){return t.x=e+t.width*t.originX,t}}function dh(){if(ut)return lt;ut=1;var t=rh(),e=uh(),i=ch(),n=hh();return lt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)-a),n(s,t(r)+o),s}}function fh(){if(dt)return ct;dt=1;return ct=function(t){return t.x+t.width-t.width*t.originX}}function ph(){if(pt)return ft;pt=1;return ft=function(t,e){return t.x=e-t.width+t.width*t.originX,t}}function gh(){if(vt)return gt;vt=1;var t=rh(),e=fh(),i=ph(),n=hh();return gt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function vh(){if(yt)return mt;yt=1;return mt=function(t,e){return t.y=e-t.height+t.height*t.originY,t}}function mh(){if(wt)return xt;wt=1;var t=rh(),e=uh(),i=vh(),n=ph();return xt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function yh(){if(Tt)return bt;Tt=1;return bt=function(t){return t.y-t.height*t.originY+.5*t.height}}function xh(){if(Et)return St;Et=1;return St=function(t,e){var i=t.height*t.originY;return t.y=e+i-.5*t.height,t}}function wh(){if(Ct)return _t;Ct=1;var t=yh(),e=uh(),i=xh(),n=ph();return _t=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function bh(){if(Pt)return At;Pt=1;return At=function(t){return t.y-t.height*t.originY}}function Th(){if(Rt)return Mt;Rt=1;var t=uh(),e=bh(),i=ph(),n=hh();return Mt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function Sh(){if(Ot)return Lt;Ot=1;var t=rh(),e=fh(),i=vh(),n=ch();return Lt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Eh(){if(Dt)return Ft;Dt=1;var t=yh(),e=fh(),i=xh(),n=ch();return Ft=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function _h(){if(kt)return It;kt=1;var t=fh(),e=bh(),i=ch(),n=hh();return It=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Ch(){if(Nt)return Bt;Nt=1;var t=ah(),e=bh(),i=vh(),n=oh();return Bt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function Ah(){if(Ut)return zt;Ut=1;var t=uh(),e=bh(),i=vh(),n=ch();return zt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)-a),i(s,e(r)-o),s}}function Ph(){if(Xt)return Yt;Xt=1;var t=fh(),e=bh(),i=vh(),n=ph();return Yt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function Mh(){if(Wt)return Gt;Wt=1;var t=sh(),e=[];e[t.BOTTOM_CENTER]=lh(),e[t.BOTTOM_LEFT]=dh(),e[t.BOTTOM_RIGHT]=gh(),e[t.LEFT_BOTTOM]=mh(),e[t.LEFT_CENTER]=wh(),e[t.LEFT_TOP]=Th(),e[t.RIGHT_BOTTOM]=Sh(),e[t.RIGHT_CENTER]=Eh(),e[t.RIGHT_TOP]=_h(),e[t.TOP_CENTER]=Ch(),e[t.TOP_LEFT]=Ah(),e[t.TOP_RIGHT]=Ph();return Gt=function(t,i,n,s,r){return e[n](t,i,s,r)},Gt}function Rh(){if(Vt)return Ht;Vt=1;var t=Mh();return Ht=function(e,i,n,s){for(var r=e[0],a=1;a<e.length;a++){var o=e[a];t(o,r,i,n,s),r=o}return e},Ht}function Lh(){if(qt)return jt;qt=1;return jt=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]+=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]+=i+o*n,o++;return t}}function Oh(){if(Zt)return Kt;Zt=1;var t=Lh();return Kt=function(e,i,n,s,r){return t(e,"angle",i,n,s,r)}}function Fh(){if($t)return Jt;$t=1;return Jt=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];e.call(i,s)}return t}}function Dh(){if(te)return Qt;te=1;return Qt=function(t,e,i){void 0===i&&(i=0);for(var n=i;n<t.length;n++){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}}function Ih(){if(ie)return ee;ie=1;return ee=function(t,e,i){void 0===i&&(i=0);for(var n=t.length-1;n>=i;n--){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}}function kh(){if(se)return ne;se=1;var t=rh(),e=ah(),i=vh(),n=oh();return ne=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Bh(){if(ae)return re;ae=1;var t=rh(),e=uh(),i=vh(),n=ch();return re=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Nh(){if(he)return oe;he=1;var t=rh(),e=fh(),i=vh(),n=ph();return oe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function zh(){if(ue)return le;ue=1;var t=oh(),e=xh();return le=function(i,n,s){return t(i,n),e(i,s)}}function Uh(){if(de)return ce;de=1;var t=zh(),e=ah(),i=yh();return ce=function(n,s,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t(n,e(s)+r,i(s)+a),n}}function Yh(){if(pe)return fe;pe=1;var t=yh(),e=uh(),i=xh(),n=ch();return fe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Xh(){if(ve)return ge;ve=1;var t=yh(),e=fh(),i=xh(),n=ph();return ge=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Gh(){if(ye)return me;ye=1;var t=ah(),e=bh(),i=oh(),n=hh();return me=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Wh(){if(we)return xe;we=1;var t=uh(),e=bh(),i=ch(),n=hh();return xe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function Hh(){if(Te)return be;Te=1;var t=fh(),e=bh(),i=ph(),n=hh();return be=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Vh(){if(Ee)return Se;Ee=1;var t=sh(),e=[];e[t.BOTTOM_CENTER]=kh(),e[t.BOTTOM_LEFT]=Bh(),e[t.BOTTOM_RIGHT]=Nh(),e[t.CENTER]=Uh(),e[t.LEFT_CENTER]=Yh(),e[t.RIGHT_CENTER]=Xh(),e[t.TOP_CENTER]=Gh(),e[t.TOP_LEFT]=Wh(),e[t.TOP_RIGHT]=Hh(),e[t.LEFT_BOTTOM]=e[t.BOTTOM_LEFT],e[t.LEFT_TOP]=e[t.TOP_LEFT],e[t.RIGHT_BOTTOM]=e[t.BOTTOM_RIGHT],e[t.RIGHT_TOP]=e[t.TOP_RIGHT];return Se=function(t,i,n,s,r){return e[n](t,i,s,r)},Se}function jh(){if(Ce)return _e;Ce=1;return _e=function(t,e,i){var n=typeof t;return t&&"number"!==n&&"string"!==n&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:i}}function qh(){if(Pe)return Ae;Pe=1;return Ae=function(){}}function Kh(){if(Re)return Me;function t(t,e,i){var n=i?t[e]:Object.getOwnPropertyDescriptor(t,e);return!i&&n.value&&"object"==typeof n.value&&(n=n.value),!(!n||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(n))&&(void 0===n.enumerable&&(n.enumerable=!0),void 0===n.configurable&&(n.configurable=!0),n)}function e(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!!i&&(i.value&&"object"==typeof i.value&&(i=i.value),!1===i.configurable)}function i(i,n,r,a){for(var o in n)if(n.hasOwnProperty(o)){var h=t(n,o,r);if(!1!==h){if(e((a||i).prototype,o)){if(s.ignoreFinals)continue;throw new Error("cannot override final property '"+o+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(i.prototype,o,h)}else i.prototype[o]=n[o]}}function n(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)i(t,e[n].prototype||e[n])}}function s(t){var e,s;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var r=t.Extends;e=function(){r.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,s=t.Extends,delete t.Extends):e.prototype.constructor=e;var a=null;return t.Mixins&&(a=t.Mixins,delete t.Mixins),n(e,a),i(e,t,!0,s),e}return Re=1,s.extend=i,s.mixin=n,s.ignoreFinals=!1,Me=s}function Zh(){if(Oe)return Le;Oe=1;return Le=function(t,e,i){return t.radius>0&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-i)*(t.y-i)<=t.radius*t.radius},Le}function Jh(){if(De)return Fe;De=1;return Fe={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}}function $h(){if(ke)return Ie;ke=1;var t=Kh(),e=Jh(),i=new t({initialize:function(t,i){void 0===t&&(t=0),void 0===i&&(i=t),this.type=e.POINT,this.x=t,this.y=i},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});return Ie=i}function Qh(){if(Ne)return Be;Ne=1;var t=$h();return Be=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x+e.radius*Math.cos(i),n.y=e.y+e.radius*Math.sin(i),n},Be}function tl(){if(Ue)return ze;Ue=1;return ze=function(t,e,i){return Math.max(e,Math.min(i,t))}}function el(){if(Xe)return Ye;Xe=1;var t=tl();return Ye=function(e,i,n){return(n-i)*(e=t(e,0,1))+i}}function il(){if(We)return Ge;We=1;var t={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};return Ge=t}function nl(){if(Ve)return He;Ve=1;var t=Qh(),e=el(),i=il(),n=$h();return He=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},He}function sl(){if(qe)return je;qe=1;return je=function(t){return Math.PI*t.radius*2},je}function rl(){if(Ze)return Ke;Ze=1;var t=sl(),e=Qh(),i=el(),n=il();return Ke=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},Ke}function al(){if($e)return Je;$e=1;var t=$h();return Je=function(e,i){void 0===i&&(i=new t);var n=2*Math.PI*Math.random(),s=Math.random()+Math.random(),r=s>1?2-s:s,a=r*Math.cos(n),o=r*Math.sin(n);return i.x=e.x+a*e.radius,i.y=e.y+o*e.radius,i},Je}function ol(){if(ti)return Qe;ti=1;var t=Kh(),e=Zh(),i=nl(),n=rl(),s=Jh(),r=al(),a=new t({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.type=s.CIRCLE,this.x=t,this.y=e,this._radius=i,this._diameter=2*i},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i){return this.x=t,this.y=e,this._radius=i,this._diameter=2*i,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});return Qe=a}function hl(){if(ii)return ei;ii=1;var t=tl();return ei={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(e,i,n,s){return void 0===e&&(e=1),void 0===i?this.alpha=e:(this._alphaTL=t(e,0,1),this._alphaTR=t(i,0,1),this._alphaBL=t(n,0,1),this._alphaBR=t(s,0,1)),this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,this._alphaTL=i,this._alphaTR=i,this._alphaBL=i,this._alphaBR=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(e){var i=t(e,0,1);this._alphaTL=i,0!==i&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(e){var i=t(e,0,1);this._alphaTR=i,0!==i&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(e){var i=t(e,0,1);this._alphaBL=i,0!==i&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(e){var i=t(e,0,1);this._alphaBR=i,0!==i&&(this.renderFlags|=2)}}}}function ll(){if(si)return ni;si=1;var t=tl();return ni={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}}}}function ul(){if(ai)return ri;ai=1;var t=Qo(),e={_blendMode:t.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(e){"string"==typeof e&&(e=t[e]),(e|=0)>=-1&&(this._blendMode=e)}},setBlendMode:function(t){return this.blendMode=t,this}};return ri=e}function cl(){if(hi)return oi;hi=1;return oi={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}}function dl(){if(di)return ci;di=1;return ci=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))return!1;for(var e=t[0].length,i=1;i<t.length;i++)if(t[i].length!==e)return!1;return!0},ci}function fl(){if(pi)return fi;pi=1;return fi=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=" "),void 0===n&&(n=3);var s=0;if(e+1>=(t=t.toString()).length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var r=Math.ceil((s=e-t.length)/2);t=new Array(s-r+1).join(i)+t+new Array(r+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t}}function pl(){if(vi)return gi;vi=1;var t=fl(),e=dl();return gi=function(i){var n="";if(!e(i))return n;for(var s=0;s<i.length;s++){for(var r=0;r<i[s].length;r++){var a=i[s][r].toString();n+="undefined"!==a?t(a,2):"?",r<i[s].length-1&&(n+=" |")}if(s<i.length-1){n+="\n";for(var o=0;o<i[s].length;o++)n+="---",o<i[s].length-1&&(n+="+");n+="\n"}}return n},gi}function gl(){if(yi)return mi;yi=1;return mi=function(t){return t.reverse()},mi}function vl(){if(wi)return xi;wi=1;return xi=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t},xi}function ml(){if(Ti)return bi;Ti=1;return bi=function(t){for(var e=t.length,i=t[0].length,n=new Array(i),s=0;s<i;s++){n[s]=new Array(e);for(var r=e-1;r>-1;r--)n[s][r]=t[r][s]}return n},bi}function yl(){if(Ei)return Si;Ei=1;var t=dl(),e=ml();return Si=function(i,n){if(void 0===n&&(n=90),!t(i))return null;if("string"!=typeof n&&(n=(n%360+360)%360),90===n||-270===n||"rotateLeft"===n)(i=e(i)).reverse();else if(-90===n||270===n||"rotateRight"===n)i.reverse(),i=e(i);else if(180===Math.abs(n)||"rotate180"===n){for(var s=0;s<i.length;s++)i[s].reverse();i.reverse()}return i},Si}function xl(){if(Ci)return _i;Ci=1;var t=yl();return _i=function(e){return t(e,180)},_i}function wl(){if(Pi)return Ai;Pi=1;var t=yl();return Ai=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,90);return e},Ai}function bl(){if(Ri)return Mi;Ri=1;var t=yl();return Mi=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,-90);return e},Mi}function Tl(){if(Oi)return Li;Oi=1;return Li=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.shift(),t.push(i);return i},Li}function Sl(){if(Di)return Fi;Di=1;return Fi=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.pop(),t.unshift(i);return i},Fi}function El(){if(ki)return Ii;ki=1;var t=Tl(),e=Sl();return Ii=function(i,n,s){if(void 0===n&&(n=0),void 0===s&&(s=0),0!==s&&(s<0?t(i,Math.abs(s)):e(i,s)),0!==n)for(var r=0;r<i.length;r++){var a=i[r];n<0?t(a,Math.abs(n)):e(a,n)}return i},Ii}function _l(){if(Ui)return zi;Ui=1;return zi=function(t,e,i,n,s){if(void 0===s&&(s=t),i>0){var r=i-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),n&&n.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.splice(a,1),a--;if(0===(a=e.length))return null;i>0&&a>r&&(e.splice(r),a=r);for(var o=0;o<a;o++){var h=e[o];t.push(h),n&&n.call(s,h)}return e},zi}function Cl(){if(Xi)return Yi;Xi=1;return Yi=function(t,e,i,n,s,r){if(void 0===i&&(i=0),void 0===r&&(r=t),n>0){var a=n-t.length;if(a<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(i,0,e),s&&s.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.pop(),o--;if(0===(o=e.length))return null;n>0&&o>a&&(e.splice(a),o=a);for(var h=o-1;h>=0;h--){var l=e[h];t.splice(i,0,l),s&&s.call(r,l)}return e},Yi}function Al(){if(Wi)return Gi;Wi=1;return Gi=function(t,e){var i=t.indexOf(e);return-1!==i&&i<t.length&&(t.splice(i,1),t.push(e)),e},Gi}function Pl(){if(Vi)return Hi;Vi=1;return Hi=function(t,e,i,n){var s=t.length;if(e<0||e>=s||e>=i||i>s){if(n)throw new Error("Range Error: Values outside acceptable range");return!1}return!0},Hi}function Ml(){if(qi)return ji;qi=1;var t=Pl();return ji=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=0;if(t(e,s,r))for(var o=s;o<r;o++){e[o][i]===n&&a++}return a},ji}function Rl(){if(Zi)return Ki;Zi=1;return Ki=function(t,e,i){var n,s=[null];for(n=3;n<arguments.length;n++)s.push(arguments[n]);for(n=0;n<t.length;n++)s[0]=t[n],e.apply(i,s);return t},Ki}function Ll(){if($i)return Ji;$i=1;var t=Pl();return Ji=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r)){var a,o=[null];for(a=5;a<arguments.length;a++)o.push(arguments[a]);for(a=s;a<r;a++)o[0]=e[a],i.apply(n,o)}return e},Ji}function Ol(){if(tn)return Qi;tn=1;return Qi=function(t,e,i){if(!e.length)return NaN;if(1===e.length)return e[0];var n,s,r=1;if(i){if(t<e[0][i])return e[0];for(;e[r][i]<t;)r++}else for(;e[r]<t;)r++;return r>e.length&&(r=e.length),i?(n=e[r-1][i],(s=e[r][i])-t<=t-n?e[r]:e[r-1]):(n=e[r-1],(s=e[r])-t<=t-n?s:n)},Qi}function Fl(){if(nn)return en;nn=1;var t=function(e,i){void 0===i&&(i=[]);for(var n=0;n<e.length;n++)Array.isArray(e[n])?t(e[n],i):i.push(e[n]);return i};return en=t}function Dl(){if(rn)return sn;rn=1;var t=Pl();return sn=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=[];if(t(e,s,r))for(var o=s;o<r;o++){var h=e[o];(!i||i&&void 0===n&&h.hasOwnProperty(i)||i&&void 0!==n&&h[i]===n)&&a.push(h)}return a},sn}function Il(){if(on)return an;on=1;var t=Pl();return an=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),-1!==s){if(t(e,s,r))for(var a=s;a<r;a++){var o=e[a];if(!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o}}else if(t(e,0,r))for(a=r;a>=0;a--){o=e[a];if(!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o}return null},an}function kl(){if(ln)return hn;ln=1;return hn=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length);var n=e+Math.floor(Math.random()*i);return void 0===t[n]?null:t[n]},hn}function Bl(){if(cn)return un;cn=1;return un=function(t,e){var i=t.indexOf(e);if(i>0){var n=t[i-1],s=t.indexOf(n);t[i]=n,t[s]=e}return t},un}function Nl(){if(fn)return dn;fn=1;return dn=function(t,e,i){var n=t.indexOf(e);if(-1===n||i<0||i>=t.length)throw new Error("Supplied index out of bounds");return n!==i&&(t.splice(n,1),t.splice(i,0,e)),e},dn}function zl(){if(gn)return pn;gn=1;return pn=function(t,e){var i=t.indexOf(e);if(-1!==i&&i<t.length-1){var n=t[i+1],s=t.indexOf(n);t[i]=n,t[s]=e}return t},pn}function Ul(){if(mn)return vn;mn=1;return vn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n>s||(t.splice(n,1),s=t.indexOf(i),t.splice(s+1,0,e)),t},vn}function Yl(){if(xn)return yn;xn=1;return yn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n<s||(t.splice(n,1),0===s?t.unshift(e):t.splice(s,0,e)),t},yn}function Xl(){if(bn)return wn;bn=1;return wn=function(t,e,i,n){var s,r=[],a=!1;if((i||n)&&(a=!0,i||(i=""),n||(n="")),e<t)for(s=t;s>=e;s--)a?r.push(i+s.toString()+n):r.push(s);else for(s=t;s<=e;s++)a?r.push(i+s.toString()+n):r.push(s);return r}}function Gl(){if(Sn)return Tn;Sn=1;return Tn=function(t){return t>0?Math.ceil(t):Math.floor(t)}}function Wl(){if(_n)return En;_n=1;var t=Gl();return En=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=1),null===i&&(i=e,e=0);for(var s=[],r=Math.max(t((i-e)/(n||1)),0),a=0;a<r;a++)s.push(e),e+=n;return s}}function Hl(){if(An)return Cn;function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}An=1;var i=function(n,s,r,a,o){for(void 0===r&&(r=0),void 0===a&&(a=n.length-1),void 0===o&&(o=e);a>r;){if(a-r>600){var h=a-r+1,l=s-r+1,u=Math.log(h),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(h-c)/h)*(l-h/2<0?-1:1),f=Math.max(r,Math.floor(s-l*c/h+d)),p=Math.min(a,Math.floor(s+(h-l)*c/h+d));i(n,s,f,p,o)}var g=n[s],v=r,m=a;for(t(n,r,s),o(n[a],g)>0&&t(n,r,a);v<m;){for(t(n,v,m),v++,m--;o(n[v],g)<0;)v++;for(;o(n[m],g)>0;)m--}0===o(n[r],g)?t(n,r,m):t(n,++m,a),m<=s&&(r=m+1),s<=m&&(a=m-1)}};return Cn=i}function Vl(){if(Mn)return Pn;Mn=1;return Pn=function(t,e,i,n){if(!t&&!n||"number"==typeof t)return i;if(t&&t.hasOwnProperty(e))return t[e];if(n&&n.hasOwnProperty(e))return n[e];if(-1!==e.indexOf(".")){for(var s=e.split("."),r=t,a=n,o=i,h=i,l=!0,u=!0,c=0;c<s.length;c++)r&&r.hasOwnProperty(s[c])?(o=r[s[c]],r=r[s[c]]):l=!1,a&&a.hasOwnProperty(s[c])?(h=a[s[c]],a=a[s[c]]):u=!1;return l?o:u?h:i}return i}}function jl(){if(Ln)return Rn;Ln=1;return Rn=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},Rn}function ql(){if(Fn)return On;Fn=1;var t=Vl(),e=jl(),i=function(t,e,i){for(var n=[],s=0;s<t.length;s++)for(var r=0;r<e.length;r++)for(var a=0;a<i;a++)n.push({a:t[s],b:e[r]});return n};return On=function(n,s,r){var a=t(r,"max",0),o=t(r,"qty",1),h=t(r,"random",!1),l=t(r,"randomB",!1),u=t(r,"repeat",0),c=t(r,"yoyo",!1),d=[];if(l&&e(s),-1===u)if(0===a)u=0;else{var f=n.length*s.length*o;c&&(f*=2),u=Math.ceil(a/f)}for(var p=0;p<=u;p++){var g=i(n,s,o);h&&e(g),d=d.concat(g),c&&(g.reverse(),d=d.concat(g))}return a&&d.splice(a),d}}function Kl(){if(In)return Dn;In=1;return Dn=function(t,e){if(!(e>=t.length)){for(var i=t.length-1,n=t[e],s=e;s<i;s++)t[s]=t[s+1];return t.length=i,n}},Dn}function Zl(){if(Bn)return kn;Bn=1;var t=Kl();return kn=function(e,i,n,s){var r;if(void 0===s&&(s=e),!Array.isArray(i))return-1!==(r=e.indexOf(i))?(t(e,r),n&&n.call(s,i),i):null;for(var a=i.length-1,o=[];a>=0;){var h=i[a];-1!==(r=e.indexOf(h))&&(t(e,r),o.push(h),n&&n.call(s,h)),a--}return o},kn}function Jl(){if(zn)return Nn;zn=1;var t=Kl();return Nn=function(e,i,n,s){if(void 0===s&&(s=e),i<0||i>e.length-1)throw new Error("Index out of bounds");var r=t(e,i);return n&&n.call(s,r),r},Nn}function $l(){if(Yn)return Un;Yn=1;var t=Pl();return Un=function(e,i,n,s,r){if(void 0===i&&(i=0),void 0===n&&(n=e.length),void 0===r&&(r=e),t(e,i,n)){var a=n-i,o=e.splice(i,a);if(s)for(var h=0;h<o.length;h++){var l=o[h];s.call(r,l)}return o}return[]},Un}function Ql(){if(Gn)return Xn;Gn=1;var t=Kl();return Xn=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);var s=i+Math.floor(Math.random()*n);return t(e,s)},Xn}function tu(){if(Hn)return Wn;Hn=1;return Wn=function(t,e,i){var n=t.indexOf(e),s=t.indexOf(i);return-1!==n&&-1===s&&(t[n]=i,!0)},Wn}function eu(){if(jn)return Vn;jn=1;return Vn=function(t,e){var i=t.indexOf(e);return-1!==i&&i>0&&(t.splice(i,1),t.unshift(e)),e},Vn}function iu(){if(Kn)return qn;Kn=1;var t=Pl();return qn=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r))for(var a=s;a<r;a++){var o=e[a];o.hasOwnProperty(i)&&(o[i]=n)}return e},qn}function nu(){if(Jn)return Zn;Jn=1;return Zn=function(t){var e=/\D/g;return t.sort(function(t,i){return parseInt(t.replace(e,""),10)-parseInt(i.replace(e,""),10)}),t},Zn}function su(){if(Qn)return $n;Qn=1;var t={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};return $n=function(){if("function"==typeof importScripts)return t;var e=navigator.userAgent;/Windows/.test(e)?t.windows=!0:/Mac OS/.test(e)&&!/like Mac OS/.test(e)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(t.iOS=!0,t.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),t.iOSVersion=parseInt(RegExp.$1,10)):t.macOS=!0:/Android/.test(e)?t.android=!0:/Linux/.test(e)?t.linux=!0:/iP[ao]d|iPhone/i.test(e)?(t.iOS=!0,navigator.appVersion.match(/OS (\d+)/),t.iOSVersion=parseInt(RegExp.$1,10),t.iPhone=-1!==e.toLowerCase().indexOf("iphone"),t.iPad=-1!==e.toLowerCase().indexOf("ipad")):/Kindle/.test(e)||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)?t.kindle=!0:/CrOS/.test(e)&&(t.chromeOS=!0),(/Windows Phone/i.test(e)||/IEMobile/i.test(e))&&(t.android=!1,t.iOS=!1,t.macOS=!1,t.windows=!0,t.windowsPhone=!0);var i=/Silk/.test(e);return(t.windows||t.macOS||t.linux&&!i||t.chromeOS)&&(t.desktop=!0),(t.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(t.desktop=!1),navigator.standalone&&(t.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(t.cordova=!0),void 0!==window.ejecta&&(t.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(t.node=!0),t.node&&"object"==typeof process.versions&&(t.nodeWebkit=!!process.versions["node-webkit"],t.electron=!!process.versions.electron),/Crosswalk/.test(e)&&(t.crosswalk=!0),t.pixelRatio=window.devicePixelRatio||1,t}()}function ru(){if(es)return ts;es=1;var t,e=su(),i={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};return t=navigator.userAgent,/Edg\/\d+/.test(t)?(i.edge=!0,i.es2019=!0):/OPR/.test(t)?(i.opera=!0,i.es2019=!0):/Chrome\/(\d+)/.test(t)&&!e.windowsPhone?(i.chrome=!0,i.chromeVersion=parseInt(RegExp.$1,10),i.es2019=i.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(i.firefox=!0,i.firefoxVersion=parseInt(RegExp.$1,10),i.es2019=i.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&e.iOS?(i.mobileSafari=!0,i.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(i.ie=!0,i.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!e.windowsPhone?(i.safari=!0,i.safariVersion=parseInt(RegExp.$1,10),i.es2019=i.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(i.ie=!0,i.trident=!0,i.tridentVersion=parseInt(RegExp.$1,10),i.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(i.silk=!0),ts=i}function au(){if(ns)return is;ns=1;var t,e="";return is={disable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!1),i},enable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!0),i},getPrefix:t=function(t){for(var e=["i","webkitI","msI","mozI","oI"],i=0;i<e.length;i++){var n=e[i]+"mageSmoothingEnabled";if(n in t)return n}return null},isEnabled:function(t){return null!==e?t[e]:null}}}function ou(){if(rs)return ss;rs=1;var t=eh(),e=au(),i=[],n=!1;return ss=function(){var s=function(s,a,o,h,l){var u;void 0===a&&(a=1),void 0===o&&(o=1),void 0===h&&(h=t.CANVAS),void 0===l&&(l=!1);var c=r(h);return null===c?(c={parent:s,canvas:document.createElement("canvas"),type:h},h===t.CANVAS&&i.push(c),u=c.canvas):(c.parent=s,u=c.canvas),l&&(c.parent=u),u.width=a,u.height=o,n&&h===t.CANVAS&&e.disable(u.getContext("2d",{willReadFrequently:!1})),u},r=function(e){if(void 0===e&&(e=t.CANVAS),e===t.WEBGL)return null;for(var n=0;n<i.length;n++){var s=i[n];if(!s.parent&&s.type===e)return s}return null},a=function(){var t=0;return i.forEach(function(e){e.parent&&t++}),t};return{create2D:function(e,i,n){return s(e,i,n,t.CANVAS)},create:s,createWebGL:function(e,i,n){return s(e,i,n,t.WEBGL)},disableSmoothing:function(){n=!0},enableSmoothing:function(){n=!1},first:r,free:function(){return i.length-a()},pool:i,remove:function(t){var e=t instanceof HTMLCanvasElement;i.forEach(function(i){(e&&i.canvas===t||!e&&i.parent===t)&&(i.parent=null,i.canvas.width=1,i.canvas.height=1)})},total:a}}(),ss}function hu(){if(os)return as;os=1;var t=su(),e=ru(),i=ou(),n={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};return as=function(){if("function"==typeof importScripts)return n;n.canvas=!!window.CanvasRenderingContext2D;try{n.localStorage=!!localStorage.getItem}catch(t){n.localStorage=!1}n.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),n.fileSystem=!!window.requestFileSystem;var s,r,a,o=!1;return n.webGL=function(){if(window.WebGLRenderingContext)try{var t=i.createWebGL(this),e=t.getContext("webgl")||t.getContext("experimental-webgl"),n=i.create2D(this),s=n.getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return o=s.data instanceof Uint8ClampedArray,i.remove(t),i.remove(n),!!e}catch(t){return!1}return!1}(),n.worker=!!window.Worker,n.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,n.getUserMedia=n.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,e.firefox&&e.firefoxVersion<21&&(n.getUserMedia=!1),!t.iOS&&(e.ie||e.firefox||e.chrome)&&(n.canvasBitBltShift=!0),(e.safari||e.mobileSafari)&&(n.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(n.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(n.littleEndian=(s=new ArrayBuffer(4),r=new Uint8Array(s),a=new Uint32Array(s),r[0]=161,r[1]=178,r[2]=195,r[3]=212,3569595041===a[0]||2712847316!==a[0]&&null)),n.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==n.littleEndian&&o,n}(),as}function lu(){if(ls)return hs;ls=1;var t=ru(),e={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};return"function"==typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(e.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(e.mspointer=!0),navigator.getGamepads&&(e.gamepads=!0),"onwheel"in window||t.ie&&"WheelEvent"in window?e.wheelEvent="wheel":"onmousewheel"in window?e.wheelEvent="mousewheel":t.firefox&&"MouseScrollEvent"in window&&(e.wheelEvent="DOMMouseScroll")),hs=e}function uu(){if(cs)return us;cs=1;var t=ru(),e={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};return us=function(){if("function"==typeof importScripts)return e;e.audioData=!!window.Audio,e.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var i=document.createElement("audio"),n=!!i.canPlayType;try{if(n){var s=function(t,e){var n=i.canPlayType("audio/"+t).replace(/^no$/,"");return e?Boolean(n||i.canPlayType("audio/"+e).replace(/^no$/,"")):Boolean(n)};if(e.ogg=s('ogg; codecs="vorbis"'),e.opus=s('ogg; codecs="opus"',"opus"),e.mp3=s("mpeg"),e.wav=s("wav"),e.m4a=s("x-m4a"),e.aac=s("aac"),e.flac=s("flac","x-flac"),e.webm=s('webm; codecs="vorbis"'),""!==i.canPlayType('audio/mp4; codecs="ec-3"'))if(t.edge)e.dolby=!0;else if(t.safari&&t.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var r=parseInt(RegExp.$1,10),a=parseInt(RegExp.$2,10);(10===r&&a>=11||r>10)&&(e.dolby=!0)}}}catch(t){}return e}()}function cu(){if(fs)return ds;fs=1;var t=jh(),e={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};return ds=function(){if("function"==typeof importScripts)return e;var i=document.createElement("video"),n=!!i.canPlayType,s=/^no$/;try{n&&(i.canPlayType('video/ogg; codecs="theora"').replace(s,"")&&(e.ogg=!0),i.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(s,"")&&(e.h264=!0,e.mp4=!0),i.canPlayType("video/x-m4v").replace(s,"")&&(e.m4v=!0),i.canPlayType('video/webm; codecs="vp8, vorbis"').replace(s,"")&&(e.webm=!0),i.canPlayType('video/webm; codecs="vp9"').replace(s,"")&&(e.vp9=!0),i.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(s,"")&&(e.hls=!0))}catch(t){}return i.parentNode&&i.parentNode.removeChild(i),e.getVideoURL=function(i){Array.isArray(i)||(i=[i]);for(var n=0;n<i.length;n++){var s,r=t(i[n],"url",i[n]);if(0===r.indexOf("blob:"))return{url:r,type:""};if(s=0===r.indexOf("data:")?r.split(",")[0].match(/\/(.*?);/):r.match(/\.([a-zA-Z0-9]+)($|\?)/),s=t(i[n],"type",s?s[1]:"").toLowerCase(),e[s])return{url:r,type:s}}return null},e}()}function du(){if(gs)return ps;gs=1;var t={available:!1,cancel:"",keyboard:!1,request:""};return ps=function(){if("function"==typeof importScripts)return t;var e,i="Fullscreen",n="FullScreen",s=["request"+i,"request"+n,"webkitRequest"+i,"webkitRequest"+n,"msRequest"+i,"msRequest"+n,"mozRequest"+n,"mozRequest"+i];for(e=0;e<s.length;e++)if(document.documentElement[s[e]]){t.available=!0,t.request=s[e];break}var r=["cancel"+n,"exit"+i,"webkitCancel"+n,"webkitExit"+i,"msCancel"+n,"msExit"+i,"mozCancel"+n,"mozExit"+i];if(t.available)for(e=0;e<r.length;e++)if(document[r[e]]){t.cancel=r[e];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(t.keyboard=!0),Object.defineProperty(t,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),t}()}function fu(){if(ms)return vs;ms=1;var t,e,i,n=ou(),s={supportInverseAlpha:!1,supportNewBlendModes:!1};return"function"!=typeof importScripts&&void 0!==document&&(s.supportNewBlendModes=(t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",(i=new Image).onload=function(){var r=new Image;r.onload=function(){var t=n.create2D(r,6).getContext("2d",{willReadFrequently:!0});if(t.globalCompositeOperation="multiply",t.drawImage(i,0,0),t.drawImage(r,2,0),!t.getImageData(2,0,1,1))return!1;var e=t.getImageData(2,0,1,1).data;n.remove(r),s.supportNewBlendModes=255===e[0]&&0===e[1]&&0===e[2]},r.src=t+"/wCKxvRF"+e},i.src=t+"AP804Oa6"+e,!1),s.supportInverseAlpha=function(){var t=n.create2D(this,2).getContext("2d",{willReadFrequently:!0});t.fillStyle="rgba(10, 20, 30, 0.5)",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1);if(null===e)return!1;t.putImageData(e,1,0);var i=t.getImageData(1,0,1,1),s=i.data[0]===e.data[0]&&i.data[1]===e.data[1]&&i.data[2]===e.data[2]&&i.data[3]===e.data[3];return n.remove(this),s}()),vs=s}function pu(){return xs?ys:(xs=1,ys={os:su(),browser:ru(),features:hu(),input:lu(),audio:uu(),video:cu(),fullscreen:du(),canvasFeatures:fu()})}function gu(){if(bs)return ws;bs=1;var t=pu();function e(t,e){return String(t).localeCompare(e)}function i(t,e,i,n){var s,r,a,o,h,l=t.length,u=0,c=2*i;for(s=0;s<l;s+=c)for(a=(r=s+i)+i,r>l&&(r=l),a>l&&(a=l),o=s,h=r;;)if(o<r&&h<a)e(t[o],t[h])<=0?n[u++]=t[o++]:n[u++]=t[h++];else if(o<r)n[u++]=t[o++];else{if(!(h<a))break;n[u++]=t[h++]}}return ws=function(n,s){if(void 0===s&&(s=e),!n||n.length<2)return n;if(t.features.stableSort)return n.sort(s);var r=function(t,e){var n=t.length;if(n<=1)return t;for(var s=new Array(n),r=1;r<n;r*=2){i(t,e,r,s);var a=t;t=s,s=a}return t}(n,s);return r!==n&&i(r,null,n.length,n),n},ws}function vu(){if(Ss)return Ts;Ss=1;return Ts=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return t[n]=i,t[s]=e,t},Ts}function mu(){return _s?Es:(_s=1,Es={Matrix:Ni?Bi:(Ni=1,Bi={CheckMatrix:dl(),MatrixToString:pl(),ReverseColumns:gl(),ReverseRows:vl(),Rotate180:xl(),RotateLeft:wl(),RotateMatrix:yl(),RotateRight:bl(),Translate:El(),TransposeMatrix:ml()}),Add:_l(),AddAt:Cl(),BringToTop:Al(),CountAllMatching:Ml(),Each:Rl(),EachInRange:Ll(),FindClosestInSorted:Ol(),Flatten:Fl(),GetAll:Dl(),GetFirst:Il(),GetRandom:kl(),MoveDown:Bl(),MoveTo:Nl(),MoveUp:zl(),MoveAbove:Ul(),MoveBelow:Yl(),NumberArray:Xl(),NumberArrayStep:Wl(),QuickSelect:Hl(),Range:ql(),Remove:Zl(),RemoveAt:Jl(),RemoveBetween:$l(),RemoveRandomElement:Ql(),Replace:tu(),RotateLeft:Tl(),RotateRight:Sl(),SafeRange:Pl(),SendToBack:eu(),SetAll:iu(),Shuffle:jl(),SortByDigits:nu(),SpliceOne:Kl(),StableSort:gu(),Swap:vu()})}function yu(){if(As)return Cs;As=1;var t=mu(),e={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this},setToTop:function(){var e=this.getDisplayList();return e&&t.BringToTop(e,this),this},setToBack:function(){var e=this.getDisplayList();return e&&t.SendToBack(e,this),this},setAbove:function(e){var i=this.getDisplayList();return i&&e&&t.MoveAbove(i,this,e),this},setBelow:function(e){var i=this.getDisplayList();return i&&e&&t.MoveBelow(i,this,e),this}};return Cs=e}function xu(){if(Ms)return Ps;Ms=1;return Ps={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}}function wu(){if(Ls)return Rs;Ls=1;return Rs={GLOW:4,SHADOW:5,PIXELATE:6,VIGNETTE:7,SHINE:8,BLUR:9,GRADIENT:12,BLOOM:13,COLOR_MATRIX:14,CIRCLE:15,BARREL:16,DISPLACEMENT:17,WIPE:18,BOKEH:19}}function bu(){if(Fs)return Os;Fs=1;var t=new(Kh())({initialize:function(t,e){this.type=t,this.gameObject=e,this.active=!0},setActive:function(t){return this.active=t,this},destroy:function(){this.gameObject=null,this.active=!1}});return Os=t}function Tu(){if(Is)return Ds;Is=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.BARREL,t),this.amount=n}});return Ds=n}function Su(){if(Bs)return ks;Bs=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=1),void 0===o&&(o=1),void 0===h&&(h=4),e.call(this,i.BLOOM,t),this.steps=h,this.offsetX=s,this.offsetY=r,this.blurStrength=a,this.strength=o,this.glcolor=[1,1,1],null!=n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return ks=n}function Eu(){if(zs)return Ns;zs=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===n&&(n=0),void 0===s&&(s=2),void 0===r&&(r=2),void 0===a&&(a=1),void 0===h&&(h=4),e.call(this,i.BLUR,t),this.quality=n,this.x=s,this.y=r,this.steps=h,this.strength=a,this.glcolor=[1,1,1],null!=o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Ns=n}function _u(){if(Ys)return Us;Ys=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=.5),void 0===s&&(s=1),void 0===r&&(r=.2),void 0===a&&(a=!1),void 0===o&&(o=1),void 0===h&&(h=1),void 0===l&&(l=1),e.call(this,i.BOKEH,t),this.radius=n,this.amount=s,this.contrast=r,this.isTiltShift=a,this.strength=l,this.blurX=o,this.blurY=h}});return Us=n}function Cu(){if(Gs)return Xs;Gs=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o){void 0===n&&(n=8),void 0===a&&(a=1),void 0===o&&(o=.005),e.call(this,i.CIRCLE,t),this.scale=a,this.feather=o,this.thickness=n,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],null!=s&&(this.color=s),null!=r&&(this.backgroundColor=r)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundColor:{get:function(){var t=this.glcolor2;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor2;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundAlpha:{get:function(){return this.glcolor2[3]},set:function(t){this.glcolor2[3]=t}}});return Xs=n}function Au(){if(Hs)return Ws;Hs=1;var t=Kh(),e=new Float32Array(20),i=new t({initialize:function(){this._matrix=new Float32Array(20),this.alpha=1,this._dirty=!0,this._data=new Float32Array(20),this.reset()},set:function(t){return this._matrix.set(t),this._dirty=!0,this},reset:function(){var t=this._matrix;return t.fill(0),t[0]=1,t[6]=1,t[12]=1,t[18]=1,this.alpha=1,this._dirty=!0,this},getData:function(){var t=this._data;return this._dirty&&(t.set(this._matrix),t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,this._dirty=!1),t},brightness:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t;return this.multiply([i,0,0,0,0,0,i,0,0,0,0,0,i,0,0,0,0,0,1,0],e)},saturate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=2*t/3+1,n=-.5*(i-1);return this.multiply([i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0],e)},desaturate:function(t){return void 0===t&&(t=!1),this.saturate(-1,t)},hue:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),t=t/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),s=.213,r=.715,a=.072;return this.multiply([s+.787*i+n*-s,r+i*-r+n*-r,a+i*-a+.928*n,0,0,s+i*-s+.143*n,r+i*(1-r)+.14*n,a+i*-a+-.283*n,0,0,s+i*-s+-.787*n,r+i*-r+n*r,a+.928*i+n*a,0,0,0,0,0,1,0],e)},grayscale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!1),this.saturate(-t,e)},blackWhite:function(t){return void 0===t&&(t=!1),this.multiply(i.BLACK_WHITE,t)},contrast:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t+1,n=-.5*(i-1);return this.multiply([i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0],e)},negative:function(t){return void 0===t&&(t=!1),this.multiply(i.NEGATIVE,t)},desaturateLuminance:function(t){return void 0===t&&(t=!1),this.multiply(i.DESATURATE_LUMINANCE,t)},sepia:function(t){return void 0===t&&(t=!1),this.multiply(i.SEPIA,t)},night:function(t,e){return void 0===t&&(t=.1),void 0===e&&(e=!1),this.multiply([-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},lsd:function(t){return void 0===t&&(t=!1),this.multiply(i.LSD,t)},brown:function(t){return void 0===t&&(t=!1),this.multiply(i.BROWN,t)},vintagePinhole:function(t){return void 0===t&&(t=!1),this.multiply(i.VINTAGE,t)},kodachrome:function(t){return void 0===t&&(t=!1),this.multiply(i.KODACHROME,t)},technicolor:function(t){return void 0===t&&(t=!1),this.multiply(i.TECHNICOLOR,t)},polaroid:function(t){return void 0===t&&(t=!1),this.multiply(i.POLAROID,t)},shiftToBGR:function(t){return void 0===t&&(t=!1),this.multiply(i.SHIFT_BGR,t)},multiply:function(t,i){void 0===i&&(i=!1),i||this.reset();var n=this._matrix,s=e;return s.set(n),n.set([s[0]*t[0]+s[1]*t[5]+s[2]*t[10]+s[3]*t[15],s[0]*t[1]+s[1]*t[6]+s[2]*t[11]+s[3]*t[16],s[0]*t[2]+s[1]*t[7]+s[2]*t[12]+s[3]*t[17],s[0]*t[3]+s[1]*t[8]+s[2]*t[13]+s[3]*t[18],s[0]*t[4]+s[1]*t[9]+s[2]*t[14]+s[3]*t[19]+s[4],s[5]*t[0]+s[6]*t[5]+s[7]*t[10]+s[8]*t[15],s[5]*t[1]+s[6]*t[6]+s[7]*t[11]+s[8]*t[16],s[5]*t[2]+s[6]*t[7]+s[7]*t[12]+s[8]*t[17],s[5]*t[3]+s[6]*t[8]+s[7]*t[13]+s[8]*t[18],s[5]*t[4]+s[6]*t[9]+s[7]*t[14]+s[8]*t[19]+s[9],s[10]*t[0]+s[11]*t[5]+s[12]*t[10]+s[13]*t[15],s[10]*t[1]+s[11]*t[6]+s[12]*t[11]+s[13]*t[16],s[10]*t[2]+s[11]*t[7]+s[12]*t[12]+s[13]*t[17],s[10]*t[3]+s[11]*t[8]+s[12]*t[13]+s[13]*t[18],s[10]*t[4]+s[11]*t[9]+s[12]*t[14]+s[13]*t[19]+s[14],s[15]*t[0]+s[16]*t[5]+s[17]*t[10]+s[18]*t[15],s[15]*t[1]+s[16]*t[6]+s[17]*t[11]+s[18]*t[16],s[15]*t[2]+s[16]*t[7]+s[17]*t[12]+s[18]*t[17],s[15]*t[3]+s[16]*t[8]+s[17]*t[13]+s[18]*t[18],s[15]*t[4]+s[16]*t[9]+s[17]*t[14]+s[18]*t[19]+s[19]]),this._dirty=!0,this}});return i.BLACK_WHITE=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],i.NEGATIVE=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],i.DESATURATE_LUMINANCE=[.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],i.SEPIA=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],i.LSD=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],i.BROWN=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],i.VINTAGE=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],i.KODACHROME=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],i.TECHNICOLOR=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],i.POLAROID=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],i.SHIFT_BGR=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],Ws=i}function Pu(){if(js)return Vs;js=1;var t=Kh(),e=Au(),i=wu(),n=new t({Extends:e,initialize:function(t){e.call(this),this.type=i.COLOR_MATRIX,this.gameObject=t,this.active=!0},destroy:function(){this.gameObject=null,this._matrix=null,this._data=null}});return Vs=n}function Mu(){if(Ks)return qs;Ks=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r){void 0===n&&(n="__WHITE"),void 0===s&&(s=.005),void 0===r&&(r=.005),e.call(this,i.DISPLACEMENT,t),this.x=s,this.y=r,this.glTexture,this.setTexture(n)},setTexture:function(t){var e=this.gameObject.scene.sys.textures.getFrame(t);return e&&(this.glTexture=e.glTexture),this}});return qs=n}function Ru(){if(Js)return Zs;Js=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===s&&(s=4),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.GLOW,t),this.outerStrength=s,this.innerStrength=r,this.knockout=a,this.glcolor=[1,1,1,1],void 0!==n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Zs=n}function Lu(){if(Qs)return $s;Qs=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l,u){void 0===r&&(r=.2),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=1),void 0===u&&(u=0),e.call(this,i.GRADIENT,t),this.alpha=r,this.size=u,this.fromX=a,this.fromY=o,this.toX=h,this.toY=l,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],null!=n&&(this.color1=n),null!=s&&(this.color2=s)},color1:{get:function(){var t=this.glcolor1;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor1;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}},color2:{get:function(){var t=this.glcolor2;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor2;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}}});return $s=n}function Ou(){if(er)return tr;er=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.PIXELATE,t),this.amount=n}});return tr=n}function Fu(){if(nr)return ir;nr=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=.1),void 0===a&&(a=1),void 0===h&&(h=6),void 0===l&&(l=1),e.call(this,i.SHADOW,t),this.x=n,this.y=s,this.decay=r,this.power=a,this.glcolor=[0,0,0,1],this.samples=h,this.intensity=l,void 0!==o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return ir=n}function Du(){if(rr)return sr;rr=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=3),void 0===a&&(a=!1),e.call(this,i.SHINE,t),this.speed=n,this.lineWidth=s,this.gradient=r,this.reveal=a}});return sr=n}function Iu(){if(or)return ar;or=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=.5),void 0===a&&(a=.5),e.call(this,i.VIGNETTE,t),this.x=n,this.y=s,this.radius=r,this.strength=a}});return ar=n}function ku(){if(lr)return hr;lr=1;var t=Kh(),e=bu(),i=wu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.1),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.WIPE,t),this.progress=0,this.wipeWidth=n,this.direction=s,this.axis=r,this.reveal=a}});return hr=n}function Bu(){if(cr)return ur;cr=1;var t=nh(),e=wu(),i={Barrel:Tu(),Controller:bu(),Bloom:Su(),Blur:Eu(),Bokeh:_u(),Circle:Cu(),ColorMatrix:Pu(),Displacement:Mu(),Glow:Ru(),Gradient:Lu(),Pixelate:Ou(),Shadow:Fu(),Shine:Du(),Vignette:Iu(),Wipe:ku()};return i=t(!1,i,e),ur=i}function Nu(){if(fr)return dr;fr=1;var t=Kh(),e=Bu(),i=Kl(),n=new t({initialize:function(t,e){this.gameObject=t,this.isPost=e,this.enabled=!1,this.list=[],this.padding=0},setPadding:function(t){return void 0===t&&(t=0),this.padding=t,this.gameObject},onFXCopy:function(){},onFX:function(){},enable:function(t){if(!this.isPost){var e=this.gameObject.scene.sys.renderer;e&&e.pipelines?(this.gameObject.pipeline=e.pipelines.FX_PIPELINE,void 0!==t&&(this.padding=t),this.enabled=!0):this.enabled=!1}},clear:function(){if(this.isPost)this.gameObject.resetPostPipeline(!0);else{for(var t=this.list,e=0;e<t.length;e++)t[e].destroy();this.list=[]}return this.enabled=!1,this.gameObject},remove:function(t){var e;if(this.isPost){var n=this.gameObject.getPostPipeline(String(t.type));for(Array.isArray(n)||(n=[n]),e=0;e<n.length;e++){var s=n[e];if(s.controller===t){this.gameObject.removePostPipeline(s),t.destroy();break}}}else{var r=this.list;for(e=0;e<r.length;e++)r[e]===t&&(i(r,e),t.destroy())}return this.gameObject},disable:function(t){return void 0===t&&(t=!1),this.isPost||this.gameObject.resetPipeline(),this.enabled=!1,t&&this.clear(),this.gameObject},add:function(t,e){if(!this.isPost)return this.enabled||this.enable(),this.list.push(t),t;var i=String(t.type);this.gameObject.setPostPipeline(i,e);var n=this.gameObject.getPostPipeline(i);return n?(Array.isArray(n)&&(n=n.pop()),n&&(n.controller=t),t):void 0},addGlow:function(t,i,n,s,r,a){return this.add(new e.Glow(this.gameObject,t,i,n,s),{quality:r,distance:a})},addShadow:function(t,i,n,s,r,a,o){return this.add(new e.Shadow(this.gameObject,t,i,n,s,r,a,o))},addPixelate:function(t){return this.add(new e.Pixelate(this.gameObject,t))},addVignette:function(t,i,n,s){return this.add(new e.Vignette(this.gameObject,t,i,n,s))},addShine:function(t,i,n,s){return this.add(new e.Shine(this.gameObject,t,i,n,s))},addBlur:function(t,i,n,s,r,a){return this.add(new e.Blur(this.gameObject,t,i,n,s,r,a))},addGradient:function(t,i,n,s,r,a,o,h){return this.add(new e.Gradient(this.gameObject,t,i,n,s,r,a,o,h))},addBloom:function(t,i,n,s,r,a){return this.add(new e.Bloom(this.gameObject,t,i,n,s,r,a))},addColorMatrix:function(){return this.add(new e.ColorMatrix(this.gameObject))},addCircle:function(t,i,n,s,r){return this.add(new e.Circle(this.gameObject,t,i,n,s,r))},addBarrel:function(t){return this.add(new e.Barrel(this.gameObject,t))},addDisplacement:function(t,i,n){return this.add(new e.Displacement(this.gameObject,t,i,n))},addWipe:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n))},addReveal:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n,!0))},addBokeh:function(t,i,n){return this.add(new e.Bokeh(this.gameObject,t,i,n))},addTiltShift:function(t,i,n,s,r,a){return this.add(new e.Bokeh(this.gameObject,t,i,n,!0,s,r,a))},destroy:function(){this.clear(),this.gameObject=null}});return dr=n}function zu(){if(gr)return pr;gr=1;return pr=function(t,e,i){return!(t.width<=0||t.height<=0)&&(t.x<=e&&t.x+t.width>=e&&t.y<=i&&t.y+t.height>=i)}}function Uu(){if(mr)return vr;mr=1;return vr=function(t){return 2*(t.width+t.height)}}function Yu(){if(xr)return yr;xr=1;var t=Uu(),e=$h();return yr=function(i,n,s){if(void 0===s&&(s=new e),n<=0||n>=1)return s.x=i.x,s.y=i.y,s;var r=t(i)*n;return n>.5?(r-=i.width+i.height)<=i.width?(s.x=i.right-r,s.y=i.bottom):(s.x=i.x,s.y=i.bottom-(r-i.width)):r<=i.width?(s.x=i.x+r,s.y=i.y):(s.x=i.right,s.y=i.y+(r-i.width)),s},yr}function Xu(){if(br)return wr;br=1;var t=Yu(),e=Uu();return wr=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=e(i)/s);for(var a=0;a<n;a++){var o=a/n;r.push(t(i,o))}return r},wr}function Gu(){if(Sr)return Tr;Sr=1;var t=$h();return Tr=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x1+(e.x2-e.x1)*i,n.y=e.y1+(e.y2-e.y1)*i,n},Tr}function Wu(){if(_r)return Er;_r=1;return Er=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))},Er}function Hu(){if(Ar)return Cr;Ar=1;var t=Wu(),e=$h();return Cr=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=t(i)/s);for(var a=i.x1,o=i.y1,h=i.x2,l=i.y2,u=0;u<n;u++){var c=u/n,d=a+(h-a)*c,f=o+(l-o)*c;r.push(new e(d,f))}return r},Cr}function Vu(){if(Mr)return Pr;Mr=1;var t=$h();return Pr=function(e,i){void 0===i&&(i=new t);var n=Math.random();return i.x=e.x1+n*(e.x2-e.x1),i.y=e.y1+n*(e.y2-e.y1),i},Pr}function ju(){if(Lr)return Rr;Lr=1;return Rr=function(t,e,i){return void 0===i&&(i=1e-4),Math.abs(t-e)<i}}function qu(){if(Fr)return Or;Fr=1;var t=Kh(),e=ju(),i=new t({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new i(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,i){return e(this.x,t.x,i)&&e(this.y,t.y,i)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,i=t*t+e*e;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this},transformMat3:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},transformMat4:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[4]*i+n[12],this.y=n[1]*e+n[5]*i+n[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e*this.x-i*this.y,i*this.x+e*this.y)},project:function(t){var e=this.dot(t)/t.dot(t);return this.copy(t).scale(e)}});return i.ZERO=new i,i.RIGHT=new i(1,0),i.LEFT=new i(-1,0),i.UP=new i(0,-1),i.DOWN=new i(0,1),i.ONE=new i(1,1),Or=i}function Ku(){if(Ir)return Dr;Ir=1;var t=Kh(),e=Gu(),i=Hu(),n=Jh(),s=Vu(),r=qu(),a=new t({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.type=n.LINE,this.x1=t,this.y1=e,this.x2=i,this.y2=s},getPoint:function(t,i){return e(this,t,i)},getPoints:function(t,e,n){return i(this,t,e,n)},getRandomPoint:function(t){return s(this,t)},setTo:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this},setFromObjects:function(t,e){return this.x1=t.x,this.y1=t.y,this.x2=e.x,this.y2=e.y,this},getPointA:function(t){return void 0===t&&(t=new r),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new r),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});return Dr=a}function Zu(){if(Br)return kr;Br=1;var t=$h();return kr=function(e,i){return void 0===i&&(i=new t),i.x=e.x+Math.random()*e.width,i.y=e.y+Math.random()*e.height,i}}function Ju(){if(zr)return Nr;zr=1;var t=Kh(),e=zu(),i=Yu(),n=Xu(),s=Jh(),r=Ku(),a=Zu(),o=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.RECTANGLE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return Nr=o}function $u(){if(Yr)return Ur;Yr=1;return Ur=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x-e,o=t.y-i;return t.x=a*s-o*r+e,t.y=a*r+o*s+i,t},Ur}function Qu(){if(Gr)return Xr;Gr=1;var t=Ju(),e=$u(),i=qu();return Xr={prepareBoundsOutput:function(t,i){(void 0===i&&(i=!1),0!==this.rotation&&e(t,this.x,this.y,this.rotation),i&&this.parentContainer)&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t);return t},getCenter:function(t,e){return void 0===t&&(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getTopLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(e){var i,n,s,r,a,o,h,l;if(void 0===e&&(e=new t),this.parentContainer){var u=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(e),u.transformPoint(e.x,e.y,e),i=e.x,n=e.y,this.getTopRight(e),u.transformPoint(e.x,e.y,e),s=e.x,r=e.y,this.getBottomLeft(e),u.transformPoint(e.x,e.y,e),a=e.x,o=e.y,this.getBottomRight(e),u.transformPoint(e.x,e.y,e),h=e.x,l=e.y}else this.getTopLeft(e),i=e.x,n=e.y,this.getTopRight(e),s=e.x,r=e.y,this.getBottomLeft(e),a=e.x,o=e.y,this.getBottomRight(e),h=e.x,l=e.y;return e.x=Math.min(i,s,a,h),e.y=Math.min(n,r,o,l),e.width=Math.max(i,s,a,h)-e.x,e.height=Math.max(n,r,o,l)-e.y,e}}}function tc(){if(Hr)return Wr;Hr=1;var t={},e={},i={register:function(e,i,n,s){void 0===s&&(s=!1),t[e]={plugin:i,mapping:n,custom:s}},registerCustom:function(t,i,n,s){e[t]={plugin:i,mapping:n,data:s}},hasCore:function(e){return t.hasOwnProperty(e)},hasCustom:function(t){return e.hasOwnProperty(t)},getCore:function(e){return t[e]},getCustom:function(t){return e[t]},getCustomClass:function(t){return e.hasOwnProperty(t)?e[t].plugin:null},remove:function(e){t.hasOwnProperty(e)&&delete t[e]},removeCustom:function(t){e.hasOwnProperty(t)&&delete e[t]},destroyCorePlugins:function(){for(var e in t)t.hasOwnProperty(e)&&delete t[e]},destroyCustomPlugins:function(){for(var t in e)e.hasOwnProperty(t)&&delete e[t]}};return Wr=i}function ec(){return Ba?ka:(Ba=1,ka={ADDED_TO_SCENE:jr?Vr:(jr=1,Vr="addedtoscene"),BOOT:Kr?qr:(Kr=1,qr="boot"),CREATE:Jr?Zr:(Jr=1,Zr="create"),DESTROY:Qr?$r:(Qr=1,$r="destroy"),PAUSE:ea?ta:(ea=1,ta="pause"),POST_UPDATE:na?ia:(na=1,ia="postupdate"),PRE_RENDER:ra?sa:(ra=1,sa="prerender"),PRE_UPDATE:oa?aa:(oa=1,aa="preupdate"),READY:la?ha:(la=1,ha="ready"),REMOVED_FROM_SCENE:ca?ua:(ca=1,ua="removedfromscene"),RENDER:fa?da:(fa=1,da="render"),RESUME:ga?pa:(ga=1,pa="resume"),SHUTDOWN:ma?va:(ma=1,va="shutdown"),SLEEP:xa?ya:(xa=1,ya="sleep"),START:ba?wa:(ba=1,wa="start"),TRANSITION_COMPLETE:Sa?Ta:(Sa=1,Ta="transitioncomplete"),TRANSITION_INIT:_a?Ea:(_a=1,Ea="transitioninit"),TRANSITION_OUT:Aa?Ca:(Aa=1,Ca="transitionout"),TRANSITION_START:Ma?Pa:(Ma=1,Pa="transitionstart"),TRANSITION_WAKE:La?Ra:(La=1,Ra="transitionwake"),UPDATE:Fa?Oa:(Fa=1,Oa="update"),WAKE:Ia?Da:(Ia=1,Da="wake")})}function ic(){if(za)return Na;za=1;var t=Kh(),e=tc(),i=ec(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectFactory",n,"add"),Na=n}function nc(){if(Ya)return Ua;Ya=1;var t=Kh(),e=ic(),i=new t({initialize:function(t,e,i,n,s,r){e||(e=t.sys.make.image({x:i,y:n,key:s,frame:r,add:!1})),this.bitmapMask=e,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,i)},postRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e,i)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});return e.register("bitmapMask",function(t,e,n,s,r){return new i(this.scene,t,e,n,s,r)}),Ua=i}function sc(){if(Ga)return Xa;Ga=1;var t=new(Kh())({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,i){var n=t.gl;t.flush(),0===t.maskStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:i}),this.applyStencil(t,i,!0),t.maskCount++},applyStencil:function(t,e,i){var n=t.gl,s=this.geometryMask,r=t.maskCount,a=255;n.colorMask(!1,!1,!1,!1),i?(n.stencilFunc(n.EQUAL,r,a),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r++):(n.stencilFunc(n.EQUAL,r+1,a),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),this.level=r,s.renderWebGL(t,s,e),t.flush(),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.invertAlpha?n.stencilFunc(n.NOTEQUAL,r,a):n.stencilFunc(n.EQUAL,r,a)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var i=t.currentMask;if(0===t.maskStack.length)i.mask=null,e.disable(e.STENCIL_TEST);else{var n=t.maskStack[t.maskStack.length-1];n.mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null}},preRenderCanvas:function(t,e,i){var n=this.geometryMask;t.currentContext.save(),n.renderCanvas(t,n,i,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});return Xa=t}function rc(){if(Ha)return Wa;Ha=1;var t=nc(),e=sc(),i={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(e,i,n,s,r){return void 0===e&&(this.texture||this.shader||this.geom)&&(e=this),new t(this.scene,e,i,n,s,r)},createGeometryMask:function(t){return void 0!==t||"Graphics"!==this.type&&!this.geom||(t=this),new e(this.scene,t)}};return Wa=i}function ac(){if(Ka)return qa;Ka=1;var t=il();return qa=function(e){return e*t.DEG_TO_RAD},qa}function oc(){if(Ja)return Za;Ja=1;return Za=function(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}}function hc(){if(Qa)return $a;Qa=1;return $a={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999}}function lc(){if(eo)return to;eo=1;var t=ac(),e=oc(),i=Vl(),n=hc(),s=qu(),r={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:n.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var i=this.pathTween;return i&&i.isPlaying()&&i.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(r,a){void 0===r&&(r={}),void 0===a&&(a=0);var o=this.pathTween;o&&o.isPlaying()&&o.stop(),"number"==typeof r&&(r={duration:r}),r.from=i(r,"from",0),r.to=i(r,"to",1);var h=e(r,"positionOnPath",!1);this.rotateToPath=e(r,"rotateToPath",!1),this.pathRotationOffset=i(r,"rotationOffset",0);var l=i(r,"startAt",a);if(l&&(r.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var i=e.ease(e.progress);e.current=e.start+(e.end-e.start)*i,e.setTargetValue()}),this.pathOffset||(this.pathOffset=new s(this.x,this.y)),this.pathVector||(this.pathVector=new s),this.pathDelta||(this.pathDelta=new s),this.pathDelta.reset(),r.persist=!0,this.pathTween=this.scene.sys.tweens.addCounter(r),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=n.PLAYING_FORWARD,this.rotateToPath){var u=this.path.getPoint(.1);this.rotation=Math.atan2(u.y-this.y,u.x-this.x)+t(this.pathRotationOffset)}return this.pathConfig=r,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var e=this.pathTween;if(e&&e.data){var i=e.data[0],s=this.pathDelta,r=this.pathVector;if(s.copy(r).negate(),i.state===n.COMPLETE)return this.path.getPoint(i.end,r),s.add(r),r.add(this.pathOffset),void this.setPosition(r.x,r.y);if(i.state!==n.PLAYING_FORWARD&&i.state!==n.PLAYING_BACKWARD)return;this.path.getPoint(e.getValue(),r),s.add(r),r.add(this.pathOffset);var a=this.x,o=this.y;this.setPosition(r.x,r.y);var h=this.x-a,l=this.y-o;if(0===h&&0===l)return;if(i.state!==this._prevDirection)return void(this._prevDirection=i.state);this.rotateToPath&&(this.rotation=Math.atan2(l,h)+t(this.pathRotationOffset))}}};return to=r}function uc(){if(no)return io;no=1;var t=function(e){var i,n,s;if("object"!=typeof e||null===e)return e;for(s in i=Array.isArray(e)?[]:{},e)n=e[s],i[s]=t(n);return i};return io=t}function cc(){if(ro)return so;ro=1;var t=uc(),e={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(t){this.pipelineData={};var e=this.scene.sys.renderer;if(!e)return!1;var i=e.pipelines;if(i){void 0===t&&(t=i.default);var n=i.get(t);if(n)return this.defaultPipeline=n,this.pipeline=n,!0}return!1},setPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){var a=r.get(e);a&&(this.pipeline=a),i&&(this.pipelineData=n?t(i):i)}return this},setPipelineData:function(t,e){var i=this.pipelineData;return void 0===e?delete i[t]:i[t]=e,this},resetPipeline:function(t){return void 0===t&&(t=!1),this.pipeline=this.defaultPipeline,t&&(this.pipelineData={}),null!==this.pipeline},getPipelineName:function(){return null===this.pipeline?null:this.pipeline.name}};return so=e}function dc(){if(oo)return ao;oo=1;var t=uc(),e=Nu(),i=Kl(),n={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(t){this.postPipelines=[],this.postPipelineData={},this.postFX=new e(this,!0),t&&(this.preFX=new e(this,!1))},setPostPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){Array.isArray(e)||(e=[e]);for(var a=0;a<e.length;a++){var o=r.getPostPipeline(e[a],this,i);o&&this.postPipelines.push(o)}i&&(this.postPipelineData=n?t(i):i)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(t,e){var i=this.postPipelineData;return void 0===e?delete i[t]:i[t]=e,this},getPostPipeline:function(t){for(var e="string"==typeof t,i=this.postPipelines,n=[],s=0;s<i.length;s++){var r=i[s];(e&&r.name===t||!e&&r instanceof t)&&n.push(r)}return 1===n.length?n[0]:n},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,i=0;i<e.length;i++)e[i].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.postPipelineData={})},removePostPipeline:function(t){for(var e="string"==typeof t,n=this.postPipelines,s=n.length-1;s>=0;s--){var r=n[s];(e&&r.name===t||!e&&r===t)&&(r.destroy(),i(n,s))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};return ao=n}function fc(){if(co)return uo;co=1;var t={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight;var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};return uo=t}function pc(){if(po)return fo;po=1;var t=Kh(),e=tl(),i=nh(),n=new t({initialize:function(t,e,i,n,s,r,a){this.texture=t,this.name=e,this.source=t.source[i],this.sourceIndex=i,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(r,a,n,s)},setCutPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.cutX=t,this.cutY=e,this.updateUVs()},setCutSize:function(t,e){return this.cutWidth=t,this.cutHeight=e,this.updateUVs()},setSize:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.setCutPosition(i,n),this.setCutSize(t,e),this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var s=this.data,r=s.cut;r.x=i,r.y=n,r.w=t,r.h=e,r.r=i+t,r.b=n+e,s.sourceSize.w=t,s.sourceSize.h=e,s.spriteSourceSize.w=t,s.spriteSourceSize.h=e,s.radius=.5*Math.sqrt(t*t+e*e);var a=s.drawImage;return a.x=i,a.y=n,a.width=t,a.height=e,this.updateUVs()},setTrim:function(t,e,i,n,s,r){var a=this.data,o=a.spriteSourceSize;return a.trim=!0,a.sourceSize.w=t,a.sourceSize.h=e,o.x=i,o.y=n,o.w=s,o.h=r,o.r=i+s,o.b=n+r,this.x=i,this.y=n,this.width=s,this.height=r,this.halfWidth=.5*s,this.halfHeight=.5*r,this.centerX=Math.floor(s/2),this.centerY=Math.floor(r/2),this.updateUVs()},setScale9:function(t,e,i,n){var s=this.data;return s.scale9=!0,s.is3Slice=0===e&&n===this.height,s.scale9Borders.x=t,s.scale9Borders.y=e,s.scale9Borders.w=i,s.scale9Borders.h=n,this},setCropUVs:function(t,i,n,s,r,a,o){var h=this.cutX,l=this.cutY,u=this.cutWidth,c=this.cutHeight,d=this.realWidth,f=this.realHeight,p=h+(i=e(i,0,d)),g=l+(n=e(n,0,f)),v=s=e(s,0,d-i),m=r=e(r,0,f-n),y=this.data;if(y.trim){var x=y.spriteSourceSize,w=i+(s=e(s,0,x.x+u-i)),b=n+(r=e(r,0,x.y+c-n));if(!(x.r<i||x.b<n||x.x>w||x.y>b)){var T=Math.max(x.x,i),S=Math.max(x.y,n),E=Math.min(x.r,w)-T,_=Math.min(x.b,b)-S;v=E,m=_,p=a?h+(u-(T-x.x)-E):h+(T-x.x),g=o?l+(c-(S-x.y)-_):l+(S-x.y),i=T,n=S,s=E,r=_}else p=0,g=0,v=0,m=0}else a&&(p=h+(u-i-s)),o&&(g=l+(c-n-r));var C=this.source.width,A=this.source.height;return t.u0=Math.max(0,p/C),t.v0=Math.max(0,g/A),t.u1=Math.min(1,(p+v)/C),t.v1=Math.min(1,(g+m)/A),t.x=i,t.y=n,t.cx=p,t.cy=g,t.cw=v,t.ch=m,t.width=s,t.height=r,t.flipX=a,t.flipY=o,t},updateCropUVs:function(t,e,i){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,i)},setUVs:function(t,e,i,n,s,r){var a=this.data.drawImage;return a.width=t,a.height=e,this.u0=i,this.v0=n,this.u1=s,this.v1=r,this},updateUVs:function(){var t=this.cutX,e=this.cutY,i=this.cutWidth,n=this.cutHeight,s=this.data.drawImage;s.width=i,s.height=n;var r=this.source.width,a=this.source.height;return this.u0=t/r,this.v0=e/a,this.u1=(t+i)/r,this.v1=(e+n)/a,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new n(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=i(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});return fo=n}function gc(){if(vo)return go;vo=1;var t=pc();return go={texture:null,frame:null,isCropped:!1,setTexture:function(t,e,i,n){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e,i,n)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}}function vc(){if(yo)return mo;yo=1;var t=pc();return mo={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}}function mc(){if(To)return bo;To=1;return bo=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}}function yc(){if(Eo)return So;Eo=1;var t=Kh(),e=il(),i=qu(),n=new t({initialize:function(t,e,i,n,s,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),this.matrix=new Float32Array([t,e,i,n,s,r,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,i=t[0],n=t[1],s=t[2],r=t[3];return i||n?n>0?Math.acos(i/this.scaleX):-Math.acos(i/this.scaleX):s||r?e.TAU-(r>0?Math.acos(-s/this.scaleY):-Math.acos(s/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var i=this.matrix;return i[4]=i[0]*t+i[2]*e+i[4],i[5]=i[1]*t+i[3]*e+i[5],this},scale:function(t,e){var i=this.matrix;return i[0]*=t,i[1]*=t,i[2]*=e,i[3]*=e,this},rotate:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3];return n[0]=s*i+a*e,n[1]=r*i+o*e,n[2]=s*-e+a*i,n[3]=r*-e+o*i,this},multiply:function(t,e){var i=this.matrix,n=t.matrix,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=n[0],c=n[1],d=n[2],f=n[3],p=n[4],g=n[5],v=void 0===e?i:e.matrix;return v[0]=u*s+c*a,v[1]=u*r+c*o,v[2]=d*s+f*a,v[3]=d*r+f*o,v[4]=p*s+g*a+h,v[5]=p*r+g*o+l,v},multiplyWithOffset:function(t,e,i){var n=this.matrix,s=t.matrix,r=n[0],a=n[1],o=n[2],h=n[3],l=e*r+i*o+n[4],u=e*a+i*h+n[5],c=s[0],d=s[1],f=s[2],p=s[3],g=s[4],v=s[5];return n[0]=c*r+d*o,n[1]=c*a+d*h,n[2]=f*r+p*o,n[3]=f*a+p*h,n[4]=g*r+v*o+l,n[5]=g*a+v*h+u,this},transform:function(t,e,i,n,s,r){var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5];return a[0]=t*o+e*l,a[1]=t*h+e*u,a[2]=i*o+n*l,a[3]=i*h+n*u,a[4]=s*o+r*l+c,a[5]=s*h+r*u+d,this},transformPoint:function(t,e,i){void 0===i&&(i={x:0,y:0});var n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3],h=n[4],l=n[5];return i.x=t*s+e*a+h,i.y=t*r+e*o+l,i},invert:function(){var t=this.matrix,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=e*s-i*n;return t[0]=s/o,t[1]=-i/o,t[2]=-n/o,t[3]=e/o,t[4]=(n*a-s*r)/o,t[5]=-(e*a-i*r)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,i,n,s,r){var a=this.matrix;return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=s,a[5]=r,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(t.translateX=e[4],t.translateY=e[5],i||n){var o=Math.sqrt(i*i+n*n);t.rotation=n>0?Math.acos(i/o):-Math.acos(i/o),t.scaleX=o,t.scaleY=a/o}else if(s||r){var h=Math.sqrt(s*s+r*r);t.rotation=.5*Math.PI-(r>0?Math.acos(-s/h):-Math.acos(s/h)),t.scaleX=a/h,t.scaleY=h}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,i,n,s){var r=this.matrix,a=Math.sin(i),o=Math.cos(i);return r[4]=t,r[5]=e,r[0]=o*n,r[1]=a*n,r[2]=-a*s,r[3]=o*s,this},applyInverse:function(t,e,n){void 0===n&&(n=new i);var s=this.matrix,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=1/(r*h+o*-a);return n.x=h*c*t+-o*c*e+(u*o-l*h)*c,n.y=r*c*e+-a*c*t+(-u*r+l*a)*c,n},setQuad:function(t,e,i,n,s,r){void 0===s&&(s=!1),void 0===r&&(r=this.quad);var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5],f=t*o+e*l+c,p=t*h+e*u+d,g=t*o+n*l+c,v=t*h+n*u+d,m=i*o+n*l+c,y=i*h+n*u+d,x=i*o+e*l+c,w=i*h+e*u+d;if(s){var b=Math.floor(f+.5),T=Math.floor(p+.5),S=b-f,E=T-p;r[0]=b,r[1]=T,r[2]=g+S,r[3]=v+E,r[4]=m+S,r[5]=y+E,r[6]=x+S,r[7]=w+E}else r[0]=f,r[1]=p,r[2]=g,r[3]=v,r[4]=m,r[5]=y,r[6]=x,r[7]=w;return r},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,i){var n=this.getX(t,e);return i&&(n=Math.floor(n+.5)),n},getYRound:function(t,e,i){var n=this.getY(t,e);return i&&(n=Math.floor(n+.5)),n},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});return So=n}function xc(){if(Co)return _o;Co=1;var t=qu();return _o=function(e,i,n,s,r,a,o,h){void 0===h&&(h=new t);var l=Math.sin(r),u=Math.cos(r),c=u*a,d=l*a,f=-l*o,p=u*o,g=1/(c*p+f*-d);return h.x=p*g*e+-f*g*i+(s*f-n*p)*g,h.y=c*g*i+-d*g*e+(-s*c+n*d)*g,h},_o}function wc(){if(Po)return Ao;Po=1;return Ao=function(t,e,i){var n=i-e;return e+((t-e)%n+n)%n}}function bc(){if(Ro)return Mo;Ro=1;var t=wc();return Mo=function(e){return t(e,-Math.PI,Math.PI)},Mo}function Tc(){if(Oo)return Lo;Oo=1;var t=wc();return Lo=function(e){return t(e,-180,180)},Lo}function Sc(){if(Do)return Fo;Do=1;var t=il(),e=yc(),i=xc(),n=bc(),s=Tc(),r=qu(),a={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:0!==this._scaleY&&(this.renderFlags|=4)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:0!==this._scaleX&&(this.renderFlags|=4)}},angle:{get:function(){return s(this._rotation*t.RAD_TO_DEG)},set:function(e){this.rotation=s(e)*t.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=n(t)}},setPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=i,this.w=n,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.scene.sys.scale.width),void 0===n&&(n=this.scene.sys.scale.height),this.x=t+Math.random()*i,this.y=e+Math.random()*n,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new e),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,i){void 0===t&&(t=new e);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);var s=!1;for(i||(i=new e,s=!0),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)i.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),i.multiply(t,t),n=n.parentContainer;return s&&i.destroy(),t},getLocalPoint:function(t,e,n,s){n||(n=new r),s||(s=this.scene.sys.cameras.main);var a=s.scrollX,o=s.scrollY,h=t+a*this.scrollFactorX-a,l=e+o*this.scrollFactorY-o;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(h,l,n):i(h,l,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getWorldPoint:function(t,e,i){if(void 0===t&&(t=new r),!this.parentContainer)return t.x=this.x,t.y=this.y,t;var n=this.getWorldTransformMatrix(e,i);return t.x=n.tx,t.y=n.ty,t},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};return Fo=a}function Ec(){if(ko)return Io;ko=1;return Io={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}}function _c(){return No?Bo:(No=1,Bo={Alpha:hl(),AlphaSingle:ll(),BlendMode:ul(),ComputedSize:cl(),Crop:ui?li:(ui=1,li={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}),Depth:yu(),Flip:xu(),FX:Nu(),GetBounds:Qu(),Mask:rc(),Origin:ja?Va:(ja=1,Va={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}),PathFollower:lc(),Pipeline:cc(),PostPipeline:dc(),ScrollFactor:lo?ho:(lo=1,ho={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}),Size:fc(),Texture:gc(),TextureCrop:vc(),Tint:wo?xo:(wo=1,xo={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,i,n){return void 0===t&&(t=16777215),void 0===e&&(e=t,i=t,n=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=i,this.tintBottomRight=n,this.tintFill=!1,this},setTintFill:function(t,e,i,n){return this.setTint(t,e,i,n),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}),ToJSON:mc(),Transform:Sc(),TransformMatrix:yc(),Visible:Ec()})}function Cc(){return Zo?Ko:(Zo=1,Ko={CHANGE_DATA:Uo?zo:(Uo=1,zo="changedata"),CHANGE_DATA_KEY:Xo?Yo:(Xo=1,Yo="changedata-"),DESTROY:Wo?Go:(Wo=1,Go="destroy"),REMOVE_DATA:Vo?Ho:(Vo=1,Ho="removedata"),SET_DATA:qo?jo:(qo=1,jo="setdata")})}function Ac(){if($o)return Jo;$o=1;var t=Kh(),e=Cc(),i=new t({initialize:function(t,i){this.parent=t,this.events=i,i||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(e.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var i=[],n=0;n<t.length;n++)i.push(e[t[n]]);return i}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var i in this.list)this.list.hasOwnProperty(i)&&i.match(t)&&(e[i]=this.list[i]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var i in t)this.setValue(i,t[i]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var i=this.get(t);return void 0===i&&(i=0),this.set(t,i+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,i){if(this._frozen)return this;if(this.has(t))this.values[t]=i;else{var n=this,s=this.list,r=this.events,a=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return s[t]},set:function(i){if(!n._frozen){var o=s[t];s[t]=i,r.emit(e.CHANGE_DATA,a,t,i,o),r.emit(e.CHANGE_DATA_KEY+t,a,i,o)}}}),s[t]=i,r.emit(e.SET_DATA,a,t,i)}return this},each:function(t,e){for(var i=[this.parent,null,void 0],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[1]=s,i[2]=this.list[s],t.apply(e,i);return this},merge:function(t,e){for(var i in void 0===e&&(e=!0),t)t.hasOwnProperty(i)&&(e||!e&&!this.has(i))&&this.setValue(i,t[i]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var i=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)}return this},pop:function(t){var i=void 0;return!this._frozen&&this.has(t)&&(i=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)),i},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(e.CHANGE_DATA),this.events.off(e.SET_DATA),this.events.off(e.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});return Jo=i}var Pc,Mc,Rc,Lc,Oc,Fc,Dc,Ic,kc,Bc,Nc,zc,Uc,Yc,Xc,Gc,Wc,Hc,Vc,jc,qc,Kc,Zc,Jc,$c,Qc,td,ed,id,nd,sd,rd,ad,od,hd,ld,ud,cd,dd,fd,pd,gd,vd,md,yd,xd,wd,bd,Td,Sd,Ed,_d,Cd,Ad,Pd,Md,Rd,Ld,Od,Fd,Dd,Id,kd,Bd,Nd,zd,Ud,Yd,Xd,Gd,Wd,Hd,Vd,jd,qd,Kd,Zd,Jd,$d,Qd,tf,ef,nf,sf,rf,af,of,hf,lf,uf,cf,df,ff,pf,gf,vf,mf,yf,xf,wf,bf,Tf,Sf,Ef,_f,Cf,Af,Pf,Mf,Rf,Lf,Of,Ff,Df,If,kf,Bf,Nf,zf,Uf,Yf,Xf,Gf,Wf,Hf,Vf,jf,qf,Kf,Zf,Jf,$f,Qf,tp,ep,ip,np,sp,rp,ap,op,hp,lp,up,cp,dp,fp,pp,gp,vp,mp,yp,xp,wp,bp,Tp,Sp,Ep,_p,Cp,Ap,Pp,Mp,Rp,Lp,Op,Fp,Dp,Ip,kp,Bp,Np,zp,Up,Yp,Xp,Gp,Wp,Hp,Vp,jp,qp,Kp,Zp,Jp,$p,Qp,tg,eg,ig,ng,sg,rg,ag,og,hg,lg,ug,cg,dg,fg,pg,gg,vg,mg,yg,xg,wg,bg,Tg,Sg,Eg,_g,Cg,Ag,Pg,Mg,Rg,Lg,Og,Fg,Dg,Ig,kg,Bg,Ng,zg,Ug,Yg,Xg,Gg,Wg,Hg,Vg,jg,qg,Kg,Zg,Jg,$g,Qg,tv,ev,iv,nv,sv,rv,av,ov,hv,lv,uv,cv,dv,fv,pv,gv,vv,mv,yv,xv,wv,bv,Tv,Sv,Ev,_v,Cv,Av,Pv,Mv,Rv,Lv,Ov,Fv,Dv,Iv,kv,Bv,Nv,zv,Uv,Yv,Xv,Gv,Wv,Hv,Vv,jv,qv,Kv,Zv,Jv,$v,Qv,tm,em,im,nm,sm,rm,am,om,hm,lm,um,cm,dm,fm,pm,gm,vm,mm,ym,xm,wm,bm,Tm,Sm,Em,_m,Cm,Am,Pm,Mm,Rm,Lm,Om,Fm,Dm,Im,km,Bm,Nm,zm,Um,Ym,Xm,Gm,Wm,Hm,Vm,jm,qm,Km,Zm,Jm,$m,Qm,ty,ey,iy,ny,sy,ry,ay,oy,hy,ly,uy,cy,dy,fy,py,gy,vy,my,yy,xy,wy,by,Ty,Sy,Ey,_y,Cy,Ay,Py,My,Ry,Ly,Oy,Fy,Dy,Iy,ky,By,Ny,zy,Uy,Yy,Xy,Gy,Wy,Hy,Vy,jy,qy,Ky,Zy,Jy,$y,Qy,tx,ex,ix,nx,sx,rx,ax,ox,hx,lx,ux,cx,dx,fx,px,gx,vx,mx,yx,xx,wx,bx,Tx,Sx,Ex,_x,Cx,Ax,Px,Mx,Rx,Lx,Ox,Fx,Dx,Ix,kx,Bx,Nx,zx,Ux,Yx,Xx,Gx,Wx,Hx,Vx,jx,qx,Kx,Zx,Jx,$x,Qx,tw,ew,iw,nw,sw,rw,aw,ow,hw,lw,uw,cw,dw,fw,pw,gw,vw,mw,yw,xw,ww,bw,Tw,Sw,Ew,_w,Cw,Aw,Pw,Mw,Rw,Lw,Ow,Fw,Dw,Iw,kw,Bw,Nw,zw,Uw,Yw,Xw,Gw,Ww,Hw,Vw,jw,qw,Kw,Zw,Jw,$w,Qw,tb,eb,ib,nb,sb,rb,ab,ob,hb,lb,ub,cb,db,fb,pb,gb,vb,mb,yb,xb,wb,bb,Tb,Sb,Eb,_b,Cb,Ab,Pb,Mb,Rb,Lb,Ob,Fb,Db,Ib,kb,Bb,Nb,zb,Ub,Yb,Xb,Gb,Wb,Hb,Vb,jb,qb,Kb,Zb,Jb,$b,Qb,tT,eT,iT,nT,sT,rT,aT,oT,hT,lT,uT,cT,dT,fT,pT,gT,vT,mT,yT,xT,wT,bT,TT,ST,ET,_T,CT,AT,PT,MT,RT,LT,OT,FT,DT,IT,kT,BT,NT,zT,UT,YT,XT,GT,WT,HT,VT,jT,qT,KT,ZT,JT,$T,QT,tS,eS,iS,nS,sS,rS,aS,oS,hS,lS,uS,cS,dS,fS,pS,gS,vS,mS,yS,xS,wS,bS,TS,SS,ES,_S,CS,AS,PS,MS,RS,LS,OS,FS,DS,IS,kS,BS,NS,zS,US,YS,XS,GS,WS,HS,VS,jS,qS,KS,ZS,JS,$S,QS,tE,eE,iE,nE,sE,rE,aE,oE,hE,lE,uE,cE,dE,fE,pE,gE,vE,mE,yE,xE,wE,bE,TE,SE,EE,_E,CE,AE,PE,ME,RE,LE,OE,FE,DE,IE,kE,BE,NE,zE,UE,YE,XE,GE,WE,HE,VE,jE,qE,KE,ZE,JE,$E,QE,t_,e_,i_,n_,s_,r_,a_,o_,h_,l_,u_,c_,d_,f_,p_,g_,v_,m_,y_,x_,w_,b_,T_,S_,E_,__,C_,A_,P_,M_,R_,L_,O_,F_,D_,I_,k_,B_,N_,z_,U_,Y_,X_,G_,W_,H_,V_,j_,q_,K_,Z_,J_,$_,Q_,tC,eC,iC,nC,sC,rC,aC,oC,hC,lC,uC,cC,dC,fC,pC,gC,vC,mC,yC,xC,wC,bC,TC,SC,EC,_C,CC,AC,PC,MC,RC,LC,OC,FC,DC,IC,kC,BC,NC,zC,UC,YC,XC,GC,WC,HC,VC,jC,qC,KC,ZC,JC,$C,QC,tA,eA,iA,nA,sA,rA,aA,oA,hA,lA,uA,cA,dA,fA,pA,gA,vA,mA,yA,xA,wA,bA,TA,SA,EA,_A,CA,AA,PA,MA,RA,LA,OA,FA,DA,IA,kA,BA,NA,zA,UA,YA,XA,GA,WA,HA,VA,jA,qA,KA,ZA,JA,$A,QA,tP,eP,iP,nP,sP,rP,aP,oP,hP,lP,uP,cP,dP,fP,pP,gP,vP,mP,yP,xP,wP,bP,TP,SP,EP,_P,CP,AP,PP,MP,RP,LP,OP,FP,DP,IP,kP,BP,NP,zP,UP,YP,XP,GP,WP,HP,VP,jP,qP,KP,ZP,JP,$P,QP,tM,eM,iM,nM,sM,rM,aM,oM,hM,lM,uM,cM,dM,fM,pM,gM,vM,mM,yM,xM,wM,bM,TM,SM,EM,_M,CM,AM,PM,MM,RM,LM,OM,FM,DM,IM,kM,BM,NM,zM,UM,YM,XM,GM,WM,HM,VM,jM,qM,KM,ZM,JM,$M,QM,tR,eR,iR,nR,sR,rR,aR,oR,hR,lR,uR,cR,dR,fR,pR,gR,vR,mR,yR,xR,wR,bR,TR,SR,ER,_R,CR,AR,PR,MR,RR,LR,OR,FR,DR,IR,kR,BR,NR,zR,UR,YR,XR,GR,WR,HR,VR,jR,qR,KR,ZR,JR,$R,QR,tL,eL,iL,nL,sL,rL,aL,oL,hL,lL,uL,cL,dL,fL,pL,gL,vL,mL,yL,xL,wL,bL,TL,SL,EL,_L,CL,AL,PL,ML,RL,LL,OL,FL,DL,IL,kL,BL,NL,zL,UL,YL,XL,GL,WL,HL,VL,jL,qL,KL,ZL,JL,$L,QL,tO,eO,iO,nO,sO,rO,aO,oO,hO,lO,uO,cO,dO,fO,pO,gO,vO,mO,yO,xO,wO,bO,TO,SO,EO,_O,CO,AO,PO,MO,RO,LO,OO,FO,DO,IO,kO,BO,NO,zO,UO,YO,XO,GO,WO,HO,VO,jO,qO,KO,ZO,JO,$O,QO,tF,eF,iF,nF,sF,rF,aF,oF,hF,lF,uF,cF,dF,fF,pF,gF,vF,mF,yF,xF,wF,bF,TF,SF,EF,_F,CF,AF,PF,MF,RF,LF,OF,FF,DF,IF,kF,BF,NF,zF,UF,YF,XF,GF,WF,HF,VF,jF,qF,KF,ZF,JF,$F,QF,tD,eD,iD,nD,sD,rD,aD,oD,hD,lD,uD,cD,dD,fD,pD,gD,vD,mD,yD,xD,wD,bD,TD,SD,ED,_D,CD,AD,PD,MD,RD,LD,OD,FD,DD,ID,kD,BD,ND,zD,UD,YD,XD,GD,WD,HD,VD,jD,qD,KD,ZD,JD,$D,QD,tI,eI,iI,nI,sI,rI,aI,oI,hI,lI,uI,cI,dI,fI,pI,gI,vI,mI,yI,xI,wI,bI,TI,SI,EI,_I,CI,AI,PI,MI,RI,LI,OI,FI,DI,II,kI,BI,NI,zI,UI,YI,XI,GI,WI,HI,VI,jI,qI,KI,ZI,JI,$I,QI,tk,ek,ik,nk,sk,rk,ak,ok,hk,lk,uk,ck,dk,fk,pk,gk,vk,mk,yk,xk,wk,bk,Tk,Sk,Ek,_k,Ck,Ak,Pk,Mk,Rk,Lk,Ok,Fk,Dk,Ik,kk,Bk,Nk,zk,Uk,Yk,Xk,Gk,Wk,Hk,Vk,jk,qk,Kk,Zk,Jk,$k,Qk,tB,eB,iB,nB,sB,rB,aB,oB,hB,lB,uB,cB,dB,fB,pB,gB,vB,mB,yB,xB,wB,bB,TB,SB,EB,_B,CB,AB,PB,MB,RB,LB,OB,FB,DB,IB,kB,BB,NB,zB,UB,YB,XB,GB,WB,HB,VB,jB,qB,KB,ZB,JB,$B,QB,tN,eN,iN,nN,sN,rN,aN,oN,hN,lN,uN,cN,dN,fN,pN,gN,vN,mN,yN,xN,wN,bN,TN,SN,EN,_N,CN,AN,PN,MN,RN,LN,ON,FN,DN,IN,kN,BN,NN,zN,UN,YN,XN,GN,WN,HN,VN,jN,qN,KN,ZN,JN,$N,QN,tz,ez,iz,nz,sz,rz,az,oz,hz,lz,uz,cz,dz,fz,pz,gz,vz,mz,yz,xz,wz,bz,Tz,Sz,Ez,_z,Cz,Az,Pz,Mz,Rz,Lz,Oz,Fz,Dz,Iz,kz,Bz,Nz,zz,Uz,Yz,Xz,Gz,Wz,Hz,Vz,jz,qz,Kz,Zz,Jz,$z,Qz,tU,eU,iU,nU,sU,rU,aU,oU,hU,lU,uU={exports:{}};function cU(){return Pc||(Pc=1,function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(t,e,n,r,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new s(n,r||t,a),h=i?i+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],o]:t._events[h].push(o):(t._events[h]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,n,s=[];if(0===this._eventsCount)return s;for(n in t=this._events)e.call(t,n)&&s.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},o.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,r=n.length,a=new Array(r);s<r;s++)a[s]=n[s].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,s,r,a){var o=i?i+t:t;if(!this._events[o])return!1;var h,l,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,s),!0;case 5:return u.fn.call(u.context,e,n,s,r),!0;case 6:return u.fn.call(u.context,e,n,s,r,a),!0}for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,n);break;case 4:u[l].fn.call(u[l].context,e,n,s);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},o.prototype.on=function(t,e,i){return r(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return r(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,n,s){var r=i?i+t:t;if(!this._events[r])return this;if(!e)return a(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||s&&!o.once||n&&o.context!==n||a(this,r);else{for(var h=0,l=[],u=o.length;h<u;h++)(o[h].fn!==e||s&&!o[h].once||n&&o[h].context!==n)&&l.push(o[h]);l.length?this._events[r]=1===l.length?l[0]:l:a(this,r)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(uU)),uU.exports}function dU(){return dd?cd:(dd=1,cd={ADDED_TO_SCENE:Rc?Mc:(Rc=1,Mc="addedtoscene"),DESTROY:Oc?Lc:(Oc=1,Lc="destroy"),REMOVED_FROM_SCENE:Dc?Fc:(Dc=1,Fc="removedfromscene"),VIDEO_COMPLETE:kc?Ic:(kc=1,Ic="complete"),VIDEO_CREATED:Nc?Bc:(Nc=1,Bc="created"),VIDEO_ERROR:Uc?zc:(Uc=1,zc="error"),VIDEO_LOCKED:Xc?Yc:(Xc=1,Yc="locked"),VIDEO_LOOP:Wc?Gc:(Wc=1,Gc="loop"),VIDEO_METADATA:Vc?Hc:(Vc=1,Hc="metadata"),VIDEO_PLAY:qc?jc:(qc=1,jc="play"),VIDEO_PLAYING:Zc?Kc:(Zc=1,Kc="playing"),VIDEO_SEEKED:$c?Jc:($c=1,Jc="seeked"),VIDEO_SEEKING:td?Qc:(td=1,Qc="seeking"),VIDEO_STALLED:id?ed:(id=1,ed="stalled"),VIDEO_STOP:sd?nd:(sd=1,nd="stop"),VIDEO_TEXTURE:ad?rd:(ad=1,rd="textureready"),VIDEO_UNLOCKED:hd?od:(hd=1,od="unlocked"),VIDEO_UNSUPPORTED:ud?ld:(ud=1,ld="unsupported")})}function fU(){if(pd)return fd;pd=1;var t=Kh(),e=mc(),i=Ac(),n=cU(),s=dU(),r=ec(),a=new t({Extends:n,initialize:function(t,e){n.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(s.ADDED_TO_SCENE,this.addedToScene,this),this.on(s.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new i(this)),this},setData:function(t,e){return this.data||(this.data=new i(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new i(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new i(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new i(this)),this.data.get(t)},setInteractive:function(t,e,i){return this.scene.sys.input.enable(this,t,e,i),this},disableInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.disable(this,t),this},removeInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.clear(this),t&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return e(this)},willRender:function(t){return!(!(!this.displayList||!this.displayList.active||this.displayList.willRender(t))||a.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?i.unshift(this.displayList.getIndex(t)):i.unshift(this.scene.sys.displayList.getIndex(t)),i},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(s.ADDED_TO_SCENE,this,this.scene),t.events.emit(r.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t&&t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(s.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(r.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){this.scene&&!this.ignoreDestroy&&(void 0===t&&(t=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(s.DESTROY,this,t),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});return a.RENDER_MASK=15,fd=a}function pU(){if(vd)return gd;vd=1;var t=Qo(),e=ol(),i=Zh(),n=Kh(),s=_c(),r=fU(),a=Ju(),o=zu(),h=new n({Extends:r,Mixins:[s.Depth,s.GetBounds,s.Origin,s.Transform,s.ScrollFactor,s.Visible],initialize:function(e,i,n,s,a){void 0===s&&(s=1),void 0===a&&(a=s),r.call(this,e,"Zone"),this.setPosition(i,n),this.width=s,this.height=a,this.blendMode=t.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,i){void 0===i&&(i=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var n=this.input;return i&&n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new e(0,0,t),i)},setRectangleDropZone:function(t,e){return this.setDropZone(new a(0,0,t,e),o)},setDropZone:function(t,e){return this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,i){i.addToRenderList(e)},renderWebGL:function(t,e,i){i.addToRenderList(e)}});return gd=h}function gU(){if(yd)return md;yd=1;var t=Vh(),e=sh(),i=jh(),n=qh(),s=new(pU())({sys:{queueDepthSort:n,events:{once:n}}},0,0,1,1).setOrigin(0,0);return md=function(n,r){void 0===r&&(r={});var a=r.hasOwnProperty("width"),o=r.hasOwnProperty("height"),h=i(r,"width",-1),l=i(r,"height",-1),u=i(r,"cellWidth",1),c=i(r,"cellHeight",u),d=i(r,"position",e.TOP_LEFT),f=i(r,"x",0),p=i(r,"y",0),g=0,v=0,m=h*u,y=l*c;s.setPosition(f,p),s.setSize(u,c);for(var x=0;x<n.length;x++)if(t(n[x],s,d),a&&-1===h)s.x+=u;else if(o&&-1===l)s.y+=c;else if(o&&!a){if(v+=c,s.y+=c,v===y&&(v=0,g+=u,s.y=p,s.x+=u,g===m))break}else if(g+=u,s.x+=u,g===m&&(g=0,v+=c,s.x=f,s.y+=c,v===y))break;return n},md}function vU(){if(wd)return xd;wd=1;var t=Lh();return xd=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function mU(){if(Td)return bd;Td=1;var t=Lh();return bd=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function yU(){if(Ed)return Sd;Ed=1;var t=Lh();return Sd=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function xU(){if(Cd)return _d;Cd=1;var t=Lh();return _d=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function wU(){if(Pd)return Ad;Pd=1;return Ad=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.x,o=e.y,h=e.radius,l=0;l<t.length;l++)t[l].x=a+h*Math.cos(s),t[l].y=o+h*Math.sin(s),s+=r;return t},Ad}function bU(){if(Rd)return Md;Rd=1;return Md=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.width/2,o=e.height/2,h=0;h<t.length;h++)t[h].x=e.x+a*Math.cos(s),t[h].y=e.y+o*Math.sin(s),s+=r;return t},Md}function TU(){if(Od)return Ld;Od=1;return Ld=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}}function SU(){if(Dd)return Fd;Dd=1;return Fd=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}}function EU(){if(kd)return Id;kd=1;return Id=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}}function _U(){if(Nd)return Bd;Nd=1;return Bd=function(t,e){void 0===e&&(e=1.70158);var i=1.525*e;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)}}function CU(){return Ud?zd:(Ud=1,zd={In:SU(),Out:EU(),InOut:_U()})}function AU(){if(Xd)return Yd;Xd=1;return Yd=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}}function PU(){if(Wd)return Gd;Wd=1;return Gd=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}}function MU(){if(Vd)return Hd;Vd=1;return Hd=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}}function RU(){return qd?jd:(qd=1,jd={In:AU(),Out:PU(),InOut:MU()})}function LU(){if(Zd)return Kd;Zd=1;return Kd=function(t){return 1-Math.sqrt(1-t*t)}}function OU(){if($d)return Jd;$d=1;return Jd=function(t){return Math.sqrt(1- --t*t)}}function FU(){if(tf)return Qd;tf=1;return Qd=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}}function DU(){return nf?ef:(nf=1,ef={In:LU(),Out:OU(),InOut:FU()})}function IU(){if(rf)return sf;rf=1;return sf=function(t){return t*t*t}}function kU(){if(of)return af;of=1;return af=function(t){return--t*t*t+1}}function BU(){if(lf)return hf;lf=1;return hf=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}function NU(){return cf?uf:(cf=1,uf={In:IU(),Out:kU(),InOut:BU()})}function zU(){if(ff)return df;ff=1;return df=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)}}function UU(){if(gf)return pf;gf=1;return pf=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-n)*(2*Math.PI)/i)+1}}function YU(){if(mf)return vf;mf=1;return vf=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*.5+1}}function XU(){return xf?yf:(xf=1,yf={In:zU(),Out:UU(),InOut:YU()})}function GU(){if(bf)return wf;bf=1;return wf=function(t){return Math.pow(2,10*(t-1))-.001}}function WU(){if(Sf)return Tf;Sf=1;return Tf=function(t){return 1-Math.pow(2,-10*t)}}function HU(){if(_f)return Ef;_f=1;return Ef=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}}function VU(){return Af?Cf:(Af=1,Cf={In:GU(),Out:WU(),InOut:HU()})}function jU(){return Lf?Rf:(Lf=1,Rf=Mf?Pf:(Mf=1,Pf=function(t){return t}))}function qU(){if(Ff)return Of;Ff=1;return Of=function(t){return t*t}}function KU(){if(If)return Df;If=1;return Df=function(t){return t*(2-t)}}function ZU(){if(Bf)return kf;Bf=1;return kf=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}}function JU(){return zf?Nf:(zf=1,Nf={In:qU(),Out:KU(),InOut:ZU()})}function $U(){if(Yf)return Uf;Yf=1;return Uf=function(t){return t*t*t*t}}function QU(){if(Gf)return Xf;Gf=1;return Xf=function(t){return 1- --t*t*t*t}}function tY(){if(Hf)return Wf;Hf=1;return Wf=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}}function eY(){return jf?Vf:(jf=1,Vf={In:$U(),Out:QU(),InOut:tY()})}function iY(){if(Kf)return qf;Kf=1;return qf=function(t){return t*t*t*t*t}}function nY(){if(Jf)return Zf;Jf=1;return Zf=function(t){return--t*t*t*t*t+1}}function sY(){if(Qf)return $f;Qf=1;return $f=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}}function rY(){return ep?tp:(ep=1,tp={In:iY(),Out:nY(),InOut:sY()})}function aY(){if(np)return ip;np=1;return ip=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}}function oY(){if(rp)return sp;rp=1;return sp=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}}function hY(){if(op)return ap;op=1;return ap=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}}function lY(){return lp?hp:(lp=1,hp={In:aY(),Out:oY(),InOut:hY()})}function uY(){return fp?dp:(fp=1,dp=cp?up:(cp=1,up=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}))}function cY(){if(gp)return pp;gp=1;var t=CU(),e=RU(),i=DU(),n=NU(),s=XU(),r=VU(),a=jU(),o=JU(),h=eY(),l=rY(),u=lY(),c=uY();return pp={Power0:a,Power1:o.Out,Power2:n.Out,Power3:h.Out,Power4:l.Out,Linear:a,Quad:o.Out,Cubic:n.Out,Quart:h.Out,Quint:l.Out,Sine:u.Out,Expo:r.Out,Circ:i.Out,Elastic:s.Out,Back:t.Out,Bounce:e.Out,Stepped:c,"Quad.easeIn":o.In,"Cubic.easeIn":n.In,"Quart.easeIn":h.In,"Quint.easeIn":l.In,"Sine.easeIn":u.In,"Expo.easeIn":r.In,"Circ.easeIn":i.In,"Elastic.easeIn":s.In,"Back.easeIn":t.In,"Bounce.easeIn":e.In,"Quad.easeOut":o.Out,"Cubic.easeOut":n.Out,"Quart.easeOut":h.Out,"Quint.easeOut":l.Out,"Sine.easeOut":u.Out,"Expo.easeOut":r.Out,"Circ.easeOut":i.Out,"Elastic.easeOut":s.Out,"Back.easeOut":t.Out,"Bounce.easeOut":e.Out,"Quad.easeInOut":o.InOut,"Cubic.easeInOut":n.InOut,"Quart.easeInOut":h.InOut,"Quint.easeInOut":l.InOut,"Sine.easeInOut":u.InOut,"Expo.easeInOut":r.InOut,"Circ.easeInOut":i.InOut,"Elastic.easeInOut":s.InOut,"Back.easeInOut":t.InOut,"Bounce.easeInOut":e.InOut}}function dY(){if(mp)return vp;mp=1;return vp=function(t){return t&&t[0].toUpperCase()+t.slice(1)}}function fY(){if(xp)return yp;xp=1;var t=cY(),e=dY();return yp=function(i,n){var s=t.Power0;if("string"==typeof i)if(t.hasOwnProperty(i))s=t[i];else{var r="";if(i.indexOf(".")){var a=(r=i.substring(i.indexOf(".")+1)).toLowerCase();"in"===a?r="easeIn":"out"===a?r="easeOut":"inout"===a&&(r="easeInOut")}i=e(i.substring(0,i.indexOf(".")+1)+r),t.hasOwnProperty(i)&&(s=t[i])}else"function"==typeof i&&(s=i);if(!n)return s;var o=n.slice(0);return o.unshift(0),function(t){return o[0]=t,s.apply(this,o)}}}function pY(){if(bp)return wp;bp=1;var t=TU(),e=fY(),i=$h();return wp=function(n,s,r,a,o){void 0===a&&(a=0),void 0===o&&(o=[]);var h,l,u=[],c=n.x1,d=n.y1,f=n.x2-c,p=n.y2-d,g=e(s,o),v=r-1;for(h=0;h<v;h++)l=g(h/v),u.push(new i(c+f*l,d+p*l));if(l=g(1),u.push(new i(c+f*l,d+p*l)),a>0){var m=u[0],y=[m];for(h=1;h<u.length-1;h++){var x=u[h];t(m,x)>=a&&(y.push(x),m=x)}var w=u[u.length-1];return t(m,w)<a&&y.pop(),y.push(w),y}return u},wp}function gY(){if(Sp)return Tp;Sp=1;var t=Hu(),e=pY();return Tp=function(i,n,s){var r;r=s?e(n,s,i.length):t(n,i.length);for(var a=0;a<i.length;a++){var o=i[a],h=r[a];o.x=h.x,o.y=h.y}return i},Tp}function vY(){if(_p)return Ep;_p=1;var t=Uu(),e=$h();return Ep=function(i,n,s,r){if(void 0===r&&(r=[]),!n&&!s)return r;n?s=Math.round(t(i)/n):n=t(i)/s;for(var a=i.x,o=i.y,h=0,l=0;l<s;l++)switch(r.push(new e(a,o)),h){case 0:(a+=n)>=i.right&&(h=1,o+=a-i.right,a=i.right);break;case 1:(o+=n)>=i.bottom&&(h=2,a-=o-i.bottom,o=i.bottom);break;case 2:(a-=n)<=i.left&&(h=3,o-=i.left-a,a=i.left);break;case 3:(o-=n)<=i.top&&(h=0,o=i.top)}return r}}function mY(){if(Ap)return Cp;Ap=1;var t=vY(),e=Tl(),i=Sl();return Cp=function(n,s,r){void 0===r&&(r=0);var a=t(s,!1,n.length);r>0?e(a,r):r<0&&i(a,Math.abs(r));for(var o=0;o<n.length;o++)n[o].x=a[o].x,n[o].y=a[o].y;return n}}function yY(){if(Mp)return Pp;Mp=1;return Pp=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=[]);var n=Math.round(t.x1),s=Math.round(t.y1),r=Math.round(t.x2),a=Math.round(t.y2),o=Math.abs(r-n),h=Math.abs(a-s),l=n<r?1:-1,u=s<a?1:-1,c=o-h;i.push({x:n,y:s});for(var d=1;n!==r||s!==a;){var f=c<<1;f>-h&&(c-=h,n+=l),f<o&&(c+=o,s+=u),d%e===0&&i.push({x:n,y:s}),d++}return i},Pp}function xY(){if(Lp)return Rp;Lp=1;var t=yY();return Rp=function(e,i,n){var s=t({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n),r=t({x1:i.x2,y1:i.y2,x2:i.x3,y2:i.y3},n),a=t({x1:i.x3,y1:i.y3,x2:i.x1,y2:i.y1},n);s.pop(),r.pop(),a.pop();for(var o=(s=s.concat(r,a)).length/e.length,h=0,l=0;l<e.length;l++){var u=e[l],c=s[Math.floor(h)];u.x=c.x,u.y=c.y,h+=o}return e},Rp}function wY(){if(Fp)return Op;Fp=1;return Op=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];s.anims&&s.anims.play(e,i)}return t}}function bY(){if(Ip)return Dp;Ip=1;return Dp=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]=i+o*n,o++;return t}}function TY(){if(Bp)return kp;Bp=1;var t=al();return kp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},kp}function SY(){if(zp)return Np;zp=1;var t=$h();return Np=function(e,i){void 0===i&&(i=new t);var n=Math.random()*Math.PI*2,s=Math.sqrt(Math.random());return i.x=e.x+s*Math.cos(n)*e.width/2,i.y=e.y+s*Math.sin(n)*e.height/2,i},Np}function EY(){if(Yp)return Up;Yp=1;var t=SY();return Up=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},Up}function _Y(){if(Gp)return Xp;Gp=1;var t=Vu();return Xp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},Xp}function CY(){if(Hp)return Wp;Hp=1;var t=Zu();return Wp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e}}function AY(){if(jp)return Vp;jp=1;var t=$h();return Vp=function(e,i){void 0===i&&(i=new t);var n=e.x2-e.x1,s=e.y2-e.y1,r=e.x3-e.x1,a=e.y3-e.y1,o=Math.random(),h=Math.random();return o+h>=1&&(o=1-o,h=1-h),i.x=e.x1+(n*o+r*h),i.y=e.y1+(s*o+a*h),i},Vp}function PY(){if(Kp)return qp;Kp=1;var t=AY();return qp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},qp}function MY(){if(Jp)return Zp;Jp=1;var t=Lh();return Zp=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function RY(){if(Qp)return $p;Qp=1;return $p=function(t,e,i,n,s){var r=n+Math.atan2(t.y-i,t.x-e);return t.x=e+s*Math.cos(r),t.y=i+s*Math.sin(r),t},$p}function LY(){if(eg)return tg;eg=1;return tg=function(t,e,i,n){var s=t-i,r=e-n;return Math.sqrt(s*s+r*r)}}function OY(){if(ng)return ig;ng=1;var t=RY(),e=LY();return ig=function(i,n,s){for(var r=n.x,a=n.y,o=0;o<i.length;o++){var h=i[o];t(h,r,a,s,Math.max(1,e(h.x,h.y,r,a)))}return i},ig}function FY(){if(rg)return sg;rg=1;var t=RY();return sg=function(e,i,n,s){var r=i.x,a=i.y;if(0===s)return e;for(var o=0;o<e.length;o++)t(e[o],r,a,n,s);return e},sg}function DY(){if(og)return ag;og=1;var t=Lh();return ag=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function IY(){if(lg)return hg;lg=1;var t=Lh();return hg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function kY(){if(cg)return ug;cg=1;var t=Lh();return ug=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function BY(){if(fg)return dg;fg=1;var t=bY();return dg=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function NY(){if(gg)return pg;gg=1;var t=bY();return pg=function(e,i,n,s){return t(e,"blendMode",i,0,n,s)}}function zY(){if(mg)return vg;mg=1;var t=bY();return vg=function(e,i,n,s,r){return t(e,"depth",i,n,s,r)}}function UY(){if(xg)return yg;xg=1;return yg=function(t,e,i){for(var n=0;n<t.length;n++)t[n].setInteractive(e,i);return t}}function YY(){if(bg)return wg;bg=1;var t=bY();return wg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"originX",i,s,a,o),t(e,"originY",n,r,a,o),e.forEach(function(t){t.updateDisplayOrigin()}),e}}function XY(){if(Sg)return Tg;Sg=1;var t=bY();return Tg=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function GY(){if(_g)return Eg;_g=1;var t=bY();return Eg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function WY(){if(Ag)return Cg;Ag=1;var t=bY();return Cg=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function HY(){if(Mg)return Pg;Mg=1;var t=bY();return Pg=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function VY(){if(Lg)return Rg;Lg=1;var t=bY();return Rg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scrollFactorX",i,s,a,o),t(e,"scrollFactorY",n,r,a,o)}}function jY(){if(Fg)return Og;Fg=1;var t=bY();return Og=function(e,i,n,s,r){return t(e,"scrollFactorX",i,n,s,r)}}function qY(){if(Ig)return Dg;Ig=1;var t=bY();return Dg=function(e,i,n,s,r){return t(e,"scrollFactorY",i,n,s,r)}}function KY(){if(Bg)return kg;Bg=1;return kg=function(t,e,i,n,s){for(var r=0;r<t.length;r++)t[r].setTint(e,i,n,s);return t}}function ZY(){if(zg)return Ng;zg=1;var t=bY();return Ng=function(e,i,n,s){return t(e,"visible",i,0,n,s)}}function JY(){if(Yg)return Ug;Yg=1;var t=bY();return Ug=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function $Y(){if(Gg)return Xg;Gg=1;var t=bY();return Xg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function QY(){if(Hg)return Wg;Hg=1;var t=bY();return Wg=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function tX(){if(jg)return Vg;jg=1;var t=qu();return Vg=function(e,i,n,s,r){var a,o;void 0===s&&(s=0),void 0===r&&(r=new t);var h=e.length;if(1===h)a=e[0].x,o=e[0].y,e[0].x=i,e[0].y=n;else{var l=1,u=0;0===s&&(u=h-1,l=h-2),a=e[u].x,o=e[u].y,e[u].x=i,e[u].y=n;for(var c=0;c<h;c++)if(!(l>=h||-1===l)){var d=e[l],f=d.x,p=d.y;d.x=a,d.y=o,a=f,o=p,0===s?l--:l++}}return r.x=a,r.y=o,r}}function eX(){if(Kg)return qg;Kg=1;var t=jl();return qg=function(e){return t(e)}}function iX(){if(Jg)return Zg;Jg=1;return Zg=function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*t*(t*(6*t-15)+10)}}function nX(){if(Qg)return $g;Qg=1;var t=iX();return $g=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function sX(){if(ev)return tv;ev=1;return tv=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)}}function rX(){if(nv)return iv;nv=1;var t=sX();return iv=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function aX(){if(rv)return sv;rv=1;return sv=function(t,e,i,n,s){if(void 0===s&&(s=!1),0===t.length)return t;if(1===t.length)return s?t[0][e]+=(n+i)/2:t[0][e]=(n+i)/2,t;var r,a=Math.abs(n-i)/(t.length-1);if(s)for(r=0;r<t.length;r++)t[r][e]+=r*a+i;else for(r=0;r<t.length;r++)t[r][e]=r*a+i;return t}}function oX(){if(ov)return av;ov=1;return av=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}}function hX(){if(lv)return hv;lv=1;var t=wc();return hv=function(e,i,n){void 0===n&&(n=0);for(var s=0;s<e.length;s++){var r=e[s];r.x=t(r.x,i.left-n,i.right+n),r.y=t(r.y,i.top-n,i.bottom+n)}return e}}function lX(){return cv?uv:(cv=1,uv={AlignTo:Rh(),Angle:Oh(),Call:Fh(),GetFirst:Dh(),GetLast:Ih(),GridAlign:gU(),IncAlpha:vU(),IncX:mU(),IncXY:yU(),IncY:xU(),PlaceOnCircle:wU(),PlaceOnEllipse:bU(),PlaceOnLine:gY(),PlaceOnRectangle:mY(),PlaceOnTriangle:xY(),PlayAnimation:wY(),PropertyValueInc:Lh(),PropertyValueSet:bY(),RandomCircle:TY(),RandomEllipse:EY(),RandomLine:_Y(),RandomRectangle:CY(),RandomTriangle:PY(),Rotate:MY(),RotateAround:OY(),RotateAroundDistance:FY(),ScaleX:DY(),ScaleXY:IY(),ScaleY:kY(),SetAlpha:BY(),SetBlendMode:NY(),SetDepth:zY(),SetHitArea:UY(),SetOrigin:YY(),SetRotation:XY(),SetScale:GY(),SetScaleX:WY(),SetScaleY:HY(),SetScrollFactor:VY(),SetScrollFactorX:jY(),SetScrollFactorY:qY(),SetTint:KY(),SetVisible:ZY(),SetX:JY(),SetXY:$Y(),SetY:QY(),ShiftPosition:tX(),Shuffle:eX(),SmootherStep:nX(),SmoothStep:rX(),Spread:aX(),ToggleVisible:oX(),WrapInRectangle:hX()})}function uX(){return Iv?Dv:(Iv=1,Dv={ADD_ANIMATION:fv?dv:(fv=1,dv="add"),ANIMATION_COMPLETE:gv?pv:(gv=1,pv="animationcomplete"),ANIMATION_COMPLETE_KEY:mv?vv:(mv=1,vv="animationcomplete-"),ANIMATION_REPEAT:xv?yv:(xv=1,yv="animationrepeat"),ANIMATION_RESTART:bv?wv:(bv=1,wv="animationrestart"),ANIMATION_START:Sv?Tv:(Sv=1,Tv="animationstart"),ANIMATION_STOP:_v?Ev:(_v=1,Ev="animationstop"),ANIMATION_UPDATE:Av?Cv:(Av=1,Cv="animationupdate"),PAUSE_ALL:Mv?Pv:(Mv=1,Pv="pauseall"),REMOVE_ANIMATION:Lv?Rv:(Lv=1,Rv="remove"),RESUME_ALL:Fv?Ov:(Fv=1,Ov="resumeall")})}function cX(){if(Bv)return kv;Bv=1;var t=new(Kh())({initialize:function(t,e,i,n,s){void 0===s&&(s=!1),this.textureKey=t,this.textureFrame=e,this.index=i,this.frame=n,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=s},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});return kv=t}function dX(){if(zv)return Nv;zv=1;var t=tl(),e=Kh(),i=uX(),n=Ol(),s=cX(),r=Vl(),a=nu(),o=new e({initialize:function(t,e,n){this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,r(n,"frames",[]),r(n,"defaultTextureKey",null),r(n,"sortFrames",!0)),this.frameRate=r(n,"frameRate",null),this.duration=r(n,"duration",null),this.msPerFrame,this.skipMissedFrames=r(n,"skipMissedFrames",!0),this.delay=r(n,"delay",0),this.repeat=r(n,"repeat",0),this.repeatDelay=r(n,"repeatDelay",0),this.yoyo=r(n,"yoyo",!1),this.showBeforeDelay=r(n,"showBeforeDelay",!1),this.showOnStart=r(n,"showOnStart",!1),this.hideOnComplete=r(n,"hideOnComplete",!1),this.randomFrame=r(n,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(i.PAUSE_ALL,this.pause,this),this.manager.on(i.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,i,n){null===i&&null===n?(t.frameRate=24,t.duration=24/e*1e3):i&&null===n?(t.duration=i,t.frameRate=e/(i/1e3)):(t.frameRate=n,t.duration=e/n*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var i=this.getFrames(this.manager.textureManager,e);if(i.length>0){if(0===t)this.frames=i.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(i);else{var n=this.frames.slice(0,t),s=this.frames.slice(t);this.frames=n.concat(i,s)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,i,n){void 0===n&&(n=!0);var o,h,l,u,c=[],d=1;if("string"==typeof e){if(u=e,!t.exists(u))return console.warn('Texture "%s" not found',u),c;var f=t.get(u).getFrameNames();n&&a(f),e=[],f.forEach(function(t){e.push({key:u,frame:t})})}if(!Array.isArray(e)||0===e.length)return c;for(l=0;l<e.length;l++){var p=e[l],g=r(p,"key",i);if(g){var v=r(p,"frame",0),m=t.getFrame(g,v);m?((h=new s(g,v,d,m)).duration=r(p,"duration",0),h.isFirst=!o,o&&(o.nextFrame=h,h.prevFrame=o),c.push(h),o=h,d++):console.warn('Texture "%s" not found',g)}}if(c.length>0){h.isLast=!0,h.nextFrame=c[0],c[0].prevFrame=h;var y=1/(c.length-1);for(l=0;l<c.length;l++)c[l].progress=l*y}return c},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameByProgress:function(e){return e=t(e,0,1),n(e,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0)return(0===t.repeatDelay||t.pendingRepeat)&&(t.forward=e),void this.repeatAnimation(t);if(t.inReverse===e||0!==t.repeatCounter){t.forward=e;var i=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,i)}else t.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?(t.inReverse&&!t.forward||(t.forward=!0),this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop){if(0===t._pendingStopValue)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(e){t.frames.push(e.toJSON())}),t},updateFrameSequence:function(){for(var t,e=this.frames.length,i=1/(e-1),n=0;n<e;n++)(t=this.frames[n]).index=n+1,t.isFirst=!1,t.isLast=!1,t.progress=n*i,0===n?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[n+1])):n===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[n-1],t.nextFrame=this.frames[n+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(i.PAUSE_ALL,this.pause,this),this.manager.off(i.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});return Nv=o}function fX(){if(Yv)return Uv;Yv=1;var t=new(Kh())({initialize:function(t){this.entries={},this.size=0,this.setAll(t)},setAll:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1]);return this},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(t){delete this.entries[t]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var i in e)if(!1===t(i,e[i]))break;return this},contains:function(t){var e=this.entries;for(var i in e)if(e[i]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var i=this.entries,n=t.entries;for(var s in n)i.hasOwnProperty(s)&&e?i[s]=n[s]:this.set(s,n[s]);return this}});return Uv=t}function pX(){return bm?wm:(bm=1,wm={BLUR:Gv?Xv:(Gv=1,Xv="blur"),BOOT:Hv?Wv:(Hv=1,Wv="boot"),CONTEXT_LOST:jv?Vv:(jv=1,Vv="contextlost"),DESTROY:Kv?qv:(Kv=1,qv="destroy"),FOCUS:Jv?Zv:(Jv=1,Zv="focus"),HIDDEN:Qv?$v:(Qv=1,$v="hidden"),PAUSE:em?tm:(em=1,tm="pause"),POST_RENDER:nm?im:(nm=1,im="postrender"),POST_STEP:rm?sm:(rm=1,sm="poststep"),PRE_RENDER:om?am:(om=1,am="prerender"),PRE_STEP:lm?hm:(lm=1,hm="prestep"),READY:cm?um:(cm=1,um="ready"),RESUME:fm?dm:(fm=1,dm="resume"),STEP:gm?pm:(gm=1,pm="step"),SYSTEM_READY:mm?vm:(mm=1,vm="systemready"),VISIBLE:xm?ym:(xm=1,ym="visible")})}function gX(){if(Sm)return Tm;Sm=1;var t=dX(),e=Kh(),i=fX(),n=cU(),s=uX(),r=pX(),a=jh(),o=Vl(),h=il(),l=Xl(),u=fl(),c=new e({Extends:n,initialize:function(t){n.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new i,this.mixes=new i,this.paused=!1,this.name="AnimationManager",t.events.once(r.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(r.DESTROY,this.destroy,this)},addMix:function(t,e,i){var n=this.anims,s=this.mixes,r="string"==typeof t?t:t.key,a="string"==typeof e?e:e.key;if(n.has(r)&&n.has(a)){var o=s.get(r);o||(o={}),o[a]=i,s.set(r,o)}return this},removeMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s=i.get(n);if(s)if(e){var r="string"==typeof e?e:e.key;s.hasOwnProperty(r)&&delete s[r]}else e||i.delete(n);return this},getMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s="string"==typeof e?e:e.key,r=i.get(n);return r&&r.hasOwnProperty(s)?r[s]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(s.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e,i){var n=[],s=this.game.cache.json.get(t);if(!s)return console.warn("No Aseprite data found for: "+t),n;var r=this,l=o(s,"meta",null),u=o(s,"frames",null);l&&u&&o(l,"frameTags",[]).forEach(function(s){var o=[],l=a(s,"name",null),c=a(s,"from",0),d=a(s,"to",0),f=a(s,"direction","forward");if(l&&(!e||e&&e.indexOf(l)>-1)){for(var p=0,g=c;g<=d;g++){var v=g.toString(),m=u[v];if(m){var y=a(m,"duration",h.MAX_SAFE_INTEGER);o.push({key:t,frame:v,duration:y}),p+=y}}"reverse"===f&&(o=o.reverse());var x,w={key:l,frames:o,duration:p,yoyo:"pingpong"===f};i?i.anims&&(x=i.anims.create(w)):x=r.create(w),x&&n.push(x)}});return n},create:function(e){var i=e.key,n=!1;return i&&((n=this.get(i))?console.warn("AnimationManager key already exists: "+i):(n=new t(this,i,e),this.anims.set(i,n),this.emit(s.ADD_ANIMATION,i,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"==typeof t&&(t=JSON.parse(t));var i=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var n=0;n<t.anims.length;n++)i.push(this.create(t.anims[n]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&i.push(this.create(t));return i},generateFrameNames:function(t,e){var i=o(e,"prefix",""),n=o(e,"start",0),s=o(e,"end",0),r=o(e,"suffix",""),a=o(e,"zeroPad",0),h=o(e,"outputArray",[]),c=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),h;var d,f=this.textureManager.get(t);if(!f)return h;if(e)for(c||(c=l(n,s)),d=0;d<c.length;d++){var p=i+u(c[d],a,"0",1)+r;f.has(p)?h.push({key:t,frame:p}):console.warn('Frame "%s" not found in texture "%s"',p,t)}else for(c=f.getFrameNames(),d=0;d<c.length;d++)h.push({key:t,frame:c[d]});return h},generateFrameNumbers:function(t,e){var i=o(e,"start",0),n=o(e,"end",-1),s=o(e,"first",!1),r=o(e,"outputArray",[]),a=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),r;var h=this.textureManager.get(t);if(!h)return r;s&&h.has(s)&&r.push({key:t,frame:s}),a||(-1===n&&(n=h.frameTotal-2),a=l(i,n));for(var u=0;u<a.length;u++){var c=a[u];h.has(c)?r.push({key:t,frame:c}):console.warn('Frame "%s" not found in texture "%s"',c,t)}return r},get:function(t){return this.anims.get(t)},getAnimsFromTexture:function(t){for(var e=this.textureManager.get(t).key,i=this.anims.getArray(),n=[],s=0;s<i.length;s++)for(var r=i[s],a=r.frames,o=0;o<a.length;o++)if(a[o].textureKey===e){n.push(r.key);break}return n},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(s.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)e[i].anims.play(t);return this},staggerPlay:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var s=e.length;n||s--;for(var r=0;r<e.length;r++){var a=i<0?Math.abs(i)*(s-r):i*r;e[r].anims.playAfterDelay(t,a)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(s.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(s.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==t&&""!==t?e.anims.push(this.anims.get(t).toJSON()):this.anims.each(function(t,i){e.anims.push(i.toJSON())}),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});return Tm=c}function vX(){if(_m)return Em;_m=1;return Em=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}}function mX(){if(Am)return Cm;Am=1;var t=dX(),e=vX(),i=Kh(),n=fX(),s=uX(),r=jh(),a=new i({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.on(s.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(void 0===t)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];this.nextAnim?this.nextAnimsQueue.push(n):this.nextAnim=n}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var i=this.animationManager,n="string"==typeof t?t:r(t,"key",null),s=this.exists(n)?this.get(n):i.get(n);if(s){this.currentAnim=s;var a=s.getTotalFrames(),o=r(t,"frameRate",s.frameRate),h=r(t,"duration",s.duration);s.calculateDuration(this,a,h,o),this.delay=r(t,"delay",s.delay),this.repeat=r(t,"repeat",s.repeat),this.repeatDelay=r(t,"repeatDelay",s.repeatDelay),this.yoyo=r(t,"yoyo",s.yoyo),this.showBeforeDelay=r(t,"showBeforeDelay",s.showBeforeDelay),this.showOnStart=r(t,"showOnStart",s.showOnStart),this.hideOnComplete=r(t,"hideOnComplete",s.hideOnComplete),this.skipMissedFrames=r(t,"skipMissedFrames",s.skipMissedFrames),this.randomFrame=r(t,"randomFrame",s.randomFrame),this.timeScale=r(t,"timeScale",this.timeScale);var l=r(t,"startFrame",0);l>a&&(l=0),this.randomFrame&&(l=e(0,a-1));var u=s.frames[l];0!==l||this.forward||(u=s.getLastFrame()),this.currentFrame=u}else console.warn("Missing animation: "+n);return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}else this.delayCounter=e,this.play(t,!0);return this.parent},playAfterRepeat:function(t,e){if(void 0===e&&(e=1),this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),-1!==this.repeatCounter&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}else this.play(t);return this.parent},play:function(t,e){void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent,s="string"==typeof t?t:t.key;if(e&&this.isPlaying&&i.key===s)return n;if(i&&this.isPlaying){var r=this.animationManager.getMix(i.key,t);if(r>0)return this.playAfterDelay(t,r)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){void 0===e&&(e=!1);var i="string"==typeof t?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===i?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,i=this.parent;return e?(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame),i):i},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(s.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(s.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(s.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(s.ANIMATION_COMPLETE,s.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var i=this.currentAnim;if(i){var n=this.currentFrame,s=this.parent,r=n.textureFrame;s.emit(t,i,n,s,r),e&&s.emit(e+i.key,i,n,s,r)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent;return i?(e&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),i.getFirstTick(this),this.emitEvents(s.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(i.frames[0]),this.parent):n},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return void 0===t&&(t=1),-1!==this.repeatCounter&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var i=this.currentAnim;if(this.isPlaying&&i&&!i.paused){if(this.accumulator+=e*this.timeScale*this.animationManager.globalTimeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?i.nextFrame(this):i.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var n=0;do{this.forward?i.nextFrame(this):i.previousFrame(this),n++}while(this.isPlaying&&this.accumulator>this.nextTick&&n<60)}}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(s.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return!!this.anims&&this.anims.has(t)},create:function(e){var i=e.key,s=!1;return i&&((s=this.get(i))?console.warn("Animation key already exists: "+i):(s=new t(this,i,e),this.anims||(this.anims=new n),this.anims.set(i,s))),s},createFromAseprite:function(t,e){return this.animationManager.createFromAseprite(t,e,this.parent)},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(s.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});return Cm=a}function yX(){return Im?Dm:(Im=1,Dm={ADD:Lm?Rm:(Lm=1,Rm="add"),REMOVE:Fm?Om:(Fm=1,Om="remove")})}function xX(){if(Bm)return km;Bm=1;var t=Kh(),e=fX(),i=cU(),n=yX(),s=new t({initialize:function(){this.entries=new e,this.events=new i},add:function(t,e){return this.entries.set(t,e),this.events.emit(n.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(n.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});return km=s}function wX(){if(zm)return Nm;zm=1;var t=xX(),e=Kh(),i=pX(),n=new e({initialize:function(e){this.game=e,this.binary=new t,this.bitmapFont=new t,this.json=new t,this.physics=new t,this.shader=new t,this.audio=new t,this.video=new t,this.text=new t,this.html=new t,this.obj=new t,this.tilemap=new t,this.xml=new t,this.custom={},this.game.events.once(i.DESTROY,this.destroy,this)},addCustom:function(e){return this.custom.hasOwnProperty(e)||(this.custom[e]=new t),this.custom[e]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var i in this.custom)this.custom[i].destroy();this.custom=null,this.game=null}});return Nm=n}function bX(){if(Gm)return Xm;Gm=1;var t=Kh(),e=Vl(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.speedX=0,this.speedY=0;var i=e(t,"speed",null);"number"==typeof i?(this.speedX=i,this.speedY=i):(this.speedX=e(t,"speed.x",0),this.speedY=e(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<this.minZoom&&(e.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed,e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return Xm=i}function TX(){if(Hm)return Wm;Hm=1;var t=Kh(),e=Vl(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.accelX=0,this.accelY=0;var i=e(t,"acceleration",null);"number"==typeof i?(this.accelX=i,this.accelY=i):(this.accelX=e(t,"acceleration.x",0),this.accelY=e(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=e(t,"drag",null);"number"==typeof n?(this.dragX=n,this.dragY=n):(this.dragX=e(t,"drag.x",0),this.dragY=e(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var s=e(t,"maxSpeed",null);"number"==typeof s?(this.maxSpeedX=s,this.maxSpeedY=s):(this.maxSpeedX=e(t,"maxSpeed.x",0),this.maxSpeedY=e(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<this.minZoom?e.zoom=this.minZoom:e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return Wm=i}function SX(){return Ly?Ry:(Ly=1,Ry={DESTROY:Km?qm:(Km=1,qm="cameradestroy"),FADE_IN_COMPLETE:Jm?Zm:(Jm=1,Zm="camerafadeincomplete"),FADE_IN_START:Qm?$m:(Qm=1,$m="camerafadeinstart"),FADE_OUT_COMPLETE:ey?ty:(ey=1,ty="camerafadeoutcomplete"),FADE_OUT_START:ny?iy:(ny=1,iy="camerafadeoutstart"),FLASH_COMPLETE:ry?sy:(ry=1,sy="cameraflashcomplete"),FLASH_START:oy?ay:(oy=1,ay="cameraflashstart"),FOLLOW_UPDATE:ly?hy:(ly=1,hy="followupdate"),PAN_COMPLETE:cy?uy:(cy=1,uy="camerapancomplete"),PAN_START:fy?dy:(fy=1,dy="camerapanstart"),POST_RENDER:gy?py:(gy=1,py="postrender"),PRE_RENDER:my?vy:(my=1,vy="prerender"),ROTATE_COMPLETE:xy?yy:(xy=1,yy="camerarotatecomplete"),ROTATE_START:by?wy:(by=1,wy="camerarotatestart"),SHAKE_COMPLETE:Sy?Ty:(Sy=1,Ty="camerashakecomplete"),SHAKE_START:_y?Ey:(_y=1,Ey="camerashakestart"),ZOOM_COMPLETE:Ay?Cy:(Ay=1,Cy="camerazoomcomplete"),ZOOM_START:My?Py:(My=1,Py="camerazoomstart")})}function EX(){if(Fy)return Oy;Fy=1;return Oy=function(t,e,i){return t<<16|e<<8|i}}function _X(){if(Iy)return Dy;Iy=1;return Dy=function(t,e,i,n){return n<<24|t<<16|e<<8|i}}function CX(){if(By)return ky;By=1;var t=EX();function e(t,e,i,n){var s=(t+6*e)%6,r=Math.min(s,4-s,1);return Math.round(255*(n-n*i*Math.max(0,r)))}return ky=function(i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=1);var a=e(5,i,n,s),o=e(3,i,n,s),h=e(1,i,n,s);return r?r.setTo?r.setTo(a,o,h,r.alpha,!0):(r.r=a,r.g=o,r.b=h,r.color=t(a,o,h),r):{r:a,g:o,b:h,color:t(a,o,h)}}}function AX(){if(zy)return Ny;zy=1;return Ny=function(t,e,i,n){void 0===n&&(n={h:0,s:0,v:0}),t/=255,e/=255,i/=255;var s=Math.min(t,e,i),r=Math.max(t,e,i),a=r-s,o=0,h=0===r?0:a/r,l=r;return r!==s&&(r===t?o=(e-i)/a+(e<i?6:0):r===e?o=(i-t)/a+2:r===i&&(o=(t-e)/a+4),o/=6),n.hasOwnProperty("_h")?(n._h=o,n._s=h,n._v=l):(n.h=o,n.s=h,n.v=l),n}}function PX(){if(Yy)return Uy;Yy=1;var t=Kh(),e=EX(),i=_X(),n=CX(),s=AX(),r=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,i,n)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,i,n,s){return void 0===n&&(n=255),void 0===s&&(s=!0),this._locked=!0,this.red=t,this.green=e,this.blue=i,this.alpha=n,this._locked=!1,this.update(s)},setGLTo:function(t,e,i,n){return void 0===n&&(n=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=i,this.alphaGL=n,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,i){return n(t,e,i,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var n=this.r,r=this.g,a=this.b,o=this.a;return this._color=e(n,r,a),this._color32=i(n,r,a,o),this._rgba="rgba("+n+","+r+","+a+","+o/255+")",t&&s(n,r,a,this),this},updateHSV:function(){var t=this.r,e=this.g,i=this.b;return s(t,e,i,this),this},clone:function(){return new r(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t)),n=Math.floor(t+Math.random()*(e-t)),s=Math.floor(t+Math.random()*(e-t));return this.setTo(i,n,s)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t));return this.setTo(i,i,i)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,i=this.g,n=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),this.setTo(e,i,n)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,n(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,n(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,n(this._h,this._s,t,this)}}});return Uy=r}function MX(){if(Gy)return Xy;Gy=1;var t=PX();return Xy=function(e){var i=new t;e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(n){var s=parseInt(n[1],16),r=parseInt(n[2],16),a=parseInt(n[3],16);i.setTo(s,r,a)}return i},Xy}function RX(){if(Hy)return Wy;Hy=1;return Wy=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}},Wy}function LX(){if(jy)return Vy;jy=1;var t=PX(),e=RX();return Vy=function(i){var n=e(i);return new t(n.r,n.g,n.b,n.a)},Vy}function OX(){if(Ky)return qy;Ky=1;var t=PX();return qy=function(e){return new t(e.r,e.g,e.b,e.a)},qy}function FX(){if(Jy)return Zy;Jy=1;var t=PX();return Zy=function(e){var i=new t,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase());if(n){var s=parseInt(n[1],10),r=parseInt(n[2],10),a=parseInt(n[3],10),o=void 0!==n[4]?parseFloat(n[4]):1;i.setTo(s,r,a,255*o)}return i},Zy}function DX(){if(Qy)return $y;Qy=1;var t=MX(),e=LX(),i=OX(),n=FX();return $y=function(s){switch(typeof s){case"string":return"rgb"===s.substr(0,3).toLowerCase()?n(s):t(s);case"number":return e(s);case"object":return i(s)}},$y}function IX(){if(ex)return tx;ex=1;var t=Kh(),e=_c(),i=ac(),n=cU(),s=SX(),r=Ju(),a=yc(),o=DX(),h=qu(),l=new t({Extends:n,Mixins:[e.AlphaSingle,e.Visible],initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),n.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new r,this.dirty=!0,this._x=t,this._y=e,this._width=i,this._height=s,this._bounds=new r,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new a,this.transparent=!0,this.backgroundColor=o("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new h(i/2,s/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,i){void 0===i&&(i=new h);var n=.5*this.width,s=.5*this.height;return i.x=t-n,i.y=e-s,this.useBounds&&(i.x=this.clampX(i.x),i.y=this.clampY(i.y)),i},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,i=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-i}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(!a)return t;var o=e[4],h=e[5],l=this.scrollX,u=this.scrollY,c=this.width,d=this.height,f=this.y,p=f+d,g=this.x,v=g+c,m=this.culledObjects,y=t.length;a=1/a,m.length=0;for(var x=0;x<y;++x){var w=t[x];if(w.hasOwnProperty("width")&&!w.parentContainer){var b=w.width,T=w.height,S=w.x-l*w.scrollFactorX-b*w.originX,E=w.y-u*w.scrollFactorY-T*w.originY;(S+b)*i+(E+T)*s+o>g&&S*i+E*s+o<v&&(S+b)*n+(E+T)*r+h>f&&S*n+E*r+h<p&&m.push(w)}else m.push(w)}return m},getWorldPoint:function(t,e,i){void 0===i&&(i=new h);var n=this.matrix.matrix,s=n[0],r=n[1],a=n[2],o=n[3],l=n[4],u=n[5],c=s*o-r*a;if(!c)return i.x=t,i.y=e,i;var d=o*(c=1/c),f=-r*c,p=-a*c,g=s*c,v=(a*u-o*l)*c,m=(r*l-s*u)*c,y=Math.cos(this.rotation),x=Math.sin(this.rotation),w=this.zoomX,b=this.zoomY,T=this.scrollX,S=this.scrollY,E=t+(T*y-S*x)*w,_=e+(T*x+S*y)*b;return i.x=E*d+_*p+v,i.y=E*f+_*g+m,i},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];Array.isArray(n)?this.ignore(n):n.isParent?this.ignore(n.getChildren()):n.cameraFilter|=e}return this},clampX:function(t){var e=this._bounds,i=this.displayWidth,n=e.x+(i-this.width)/2,s=Math.max(n,n+e.width-i);return t<n?t=n:t>s&&(t=s),t},clampY:function(t){var e=this._bounds,i=this.displayHeight,n=e.y+(i-this.height)/2,s=Math.max(n,n+e.height-i);return t<n?t=n:t>s&&(t=s),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=i(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=o(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,i,n,s){return void 0===s&&(s=!1),this._bounds.setTo(t,e,i,n),this.dirty=!0,this.useBounds=!0,s?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new r);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t,e){void 0===e&&(e=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t,this.isSceneCamera=e;var i=t.sys;return this.sceneManager=i.game.scene,this.scaleManager=i.scale,this.cameraManager=i.cameras,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setZoom:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),0===t&&(t=.001),0===e&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},setIsSceneCamera:function(t){return this.isSceneCamera=t,this},updateSystem:function(){if(this.scaleManager&&this.isSceneCamera){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(s.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){t!==this._scrollX&&(this._scrollX=t,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(t){t!==this._scrollY&&(this._scrollY=t,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});return tx=l}function kX(){if(nx)return ix;nx=1;return ix=function(t,e,i){return t.x=e-t.width/2,t.y=i-t.height/2,t}}function BX(){if(rx)return sx;rx=1;var t=tl(),e=Kh(),i=SX(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o,h){if(void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),!a&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=s,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h;var l=t?i.FADE_OUT_START:i.FADE_IN_START;return this.camera.emit(l,this.camera,this,e,n,s,r),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?i.FADE_OUT_COMPLETE:i.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return sx=n}function NX(){if(ox)return ax;ox=1;var t=tl(),e=Kh(),i=SX(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===s&&(s=255),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=s,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(i.FLASH_START,this.camera,this,t,e,n,s)),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return ax=n}function zX(){if(lx)return hx;lx=1;var t=tl(),e=Kh(),i=cY(),n=SX(),s=qu(),r=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new s,this.current=new s,this.destination=new s,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=i.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene);var l=this.camera;return!a&&this.isRunning||(this.isRunning=!0,this.duration=s,this.progress=0,this.source.set(l.scrollX,l.scrollY),this.destination.set(t,e),l.getScroll(t,e,this.current),"string"==typeof r&&i.hasOwnProperty(r)?this.ease=i[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.camera.emit(n.PAN_START,this.camera,this,s,t,e)),l},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);s.getScroll(this.destination.x,this.destination.y,this.current);var a=this.source.x+(this.current.x-this.source.x)*r,o=this.source.y+(this.current.y-this.source.y)*r;s.setScroll(a,o),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,a,o)}else s.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,s.scrollX,s.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return hx=r}function UX(){if(cx)return ux;cx=1;var t=tl(),e=Kh(),i=SX(),n=qu(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new n,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===s&&(s=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"==typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=s,this._onUpdateScope=r,this.camera.emit(i.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(e,i){if(this.isRunning)if(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,s=this.camera.width,r=this.camera.height,a=this.camera.zoom;this._offsetX=(Math.random()*n.x*s*2-n.x*s)*a,this._offsetY=(Math.random()*n.y*r*2-n.y*r)*a,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});return ux=s}function YX(){if(fx)return dx;fx=1;var t=tl(),e=Kh(),i=SX(),n=cY(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=n.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),void 0===e&&(e=!1),this.shortestPath=e;var l=t;t<0?(l=-1*t,this.clockwise=!1):this.clockwise=!0;var u=360*Math.PI/180;l-=Math.floor(l/u)*u;var c=this.camera;if(!a&&this.isRunning)return c;if(this.isRunning=!0,this.duration=s,this.progress=0,this.source=c.rotation,this.destination=l,"string"==typeof r&&n.hasOwnProperty(r)?this.ease=n[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.shortestPath){var d=0,f=0;(d=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+u)-this.source)<(f=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+u)-this.destination)?this.clockwise=!0:d>f&&(this.clockwise=!1)}return this.camera.emit(i.ROTATE_START,this.camera,this,s,l),c},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);this.current=s.rotation;var a=0,o=360*Math.PI/180,h=this.destination,l=this.current;!1===this.clockwise&&(h=this.current,l=this.destination),a=h>=l?Math.abs(h-l):Math.abs(h+o)-l;var u=0;u=this.clockwise?s.rotation+a*r:s.rotation-a*r,s.rotation=u,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,u)}else s.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return dx=s}function XX(){if(gx)return px;gx=1;var t=tl(),e=Kh(),i=cY(),n=SX(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o){void 0===e&&(e=1e3),void 0===s&&(s=i.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene);var h=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=h.zoom,this.destination=t,"string"==typeof s&&i.hasOwnProperty(s)?this.ease=i[s]:"function"==typeof s&&(this.ease=s),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(n.ZOOM_START,this.camera,this,e,t)),h},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return px=s}function GX(){return mx?vx:(mx=1,vx={Fade:BX(),Flash:NX(),Pan:zX(),Shake:UX(),RotateTo:YX(),Zoom:XX()})}function WX(){if(xx)return yx;xx=1;return yx=function(t,e,i){return(e-t)*i+t}}function HX(){if(bx)return wx;bx=1;var t=IX(),e=kX(),i=tl(),n=Kh(),s=_c(),r=GX(),a=SX(),o=WX(),h=Ju(),l=qu(),u=new n({Extends:t,Mixins:[s.PostPipeline],initialize:function(e,i,n,s){t.call(this,e,i,n,s),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new r.Fade(this),this.flashEffect=new r.Flash(this),this.shakeEffect=new r.Shake(this),this.panEffect=new r.Pan(this),this.rotateToEffect=new r.RotateTo(this),this.zoomEffect=new r.Zoom(this),this.lerp=new l(1,1),this.followOffset=new l,this.deadzone=null,this._follow=null},setDeadzone:function(t,i){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=i):this.deadzone=new h(0,0,t,i),this._follow){var n=this.width/2,s=this.height/2,r=this._follow.x-this.followOffset.x,a=this._follow.y-this.followOffset.y;this.midPoint.set(r,a),this.scrollX=r-n,this.scrollY=a-s}e(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,i,n,s,r){return this.fadeEffect.start(!1,t,e,i,n,!0,s,r)},fadeOut:function(t,e,i,n,s,r){return this.fadeEffect.start(!0,t,e,i,n,!0,s,r)},fadeFrom:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!1,t,e,i,n,s,r,a)},fade:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!0,t,e,i,n,s,r,a)},flash:function(t,e,i,n,s,r,a){return this.flashEffect.start(t,e,i,n,s,r,a)},shake:function(t,e,i,n,s){return this.shakeEffect.start(t,e,i,n,s)},pan:function(t,e,i,n,s,r,a){return this.panEffect.start(t,e,i,n,s,r,a)},rotateTo:function(t,e,i,n,s,r,a){return this.rotateToEffect.start(t,e,i,n,s,r,a)},zoomTo:function(t,e,i,n,s,r){return this.zoomEffect.start(t,e,i,n,s,r)},preRender:function(){this.renderList.length=0;var t=this.width,i=this.height,n=.5*t,s=.5*i,r=this.zoomX,h=this.zoomY,l=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(r)&&Number.isInteger(h);var u=t*this.originX,c=i*this.originY,d=this._follow,f=this.deadzone,p=this.scrollX,g=this.scrollY;f&&e(f,this.midPoint.x,this.midPoint.y);var v=!1;if(d&&!this.panEffect.isRunning){var m=this.lerp,y=d.x-this.followOffset.x,x=d.y-this.followOffset.y;f?(y<f.x?p=o(p,p-(f.x-y),m.x):y>f.right&&(p=o(p,p+(y-f.right),m.x)),x<f.y?g=o(g,g-(f.y-x),m.y):x>f.bottom&&(g=o(g,g+(x-f.bottom),m.y))):(p=o(p,y-u,m.x),g=o(g,x-c,m.y)),v=!0}this.roundPixels&&(p=Math.floor(p),g=Math.floor(g)),this.useBounds&&(p=this.clampX(p),g=this.clampY(g)),this.scrollX=p,this.scrollY=g;var w=p+n,b=g+s;this.midPoint.set(w,b);var T=Math.floor(t/r+.5),S=Math.floor(i/h+.5),E=Math.floor(w-T/2+.5),_=Math.floor(b-S/2+.5);this.worldView.setTo(E,_,T,S),l.applyITRS(Math.floor(this.x+u+.5),Math.floor(this.y+c+.5),this.rotation,r,h),l.translate(-u,-c),this.shakeEffect.preRender(),v&&this.emit(a.FOLLOW_UPDATE,this,d)},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,s,r,a){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===s&&(s=n),void 0===r&&(r=0),void 0===a&&(a=r),this._follow=t,this.roundPixels=e,n=i(n,0,1),s=i(s,0,1),this.lerp.set(n,s),this.followOffset.set(r,a);var o=this.width/2,h=this.height/2,l=t.x-r,u=t.y-a;return this.midPoint.set(l,u),this.scrollX=l-o,this.scrollY=u-h,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.rotateToEffect.update(t,e),this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.resetFX(),t.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});return wx=u}function VX(){return Ix?Dx:(Ix=1,Dx={ENTER_FULLSCREEN:Sx?Tx:(Sx=1,Tx="enterfullscreen"),FULLSCREEN_FAILED:_x?Ex:(_x=1,Ex="fullscreenfailed"),FULLSCREEN_UNSUPPORTED:Ax?Cx:(Ax=1,Cx="fullscreenunsupported"),LEAVE_FULLSCREEN:Mx?Px:(Mx=1,Px="leavefullscreen"),ORIENTATION_CHANGE:Lx?Rx:(Lx=1,Rx="orientationchange"),RESIZE:Fx?Ox:(Fx=1,Ox="resize")})}function jX(){if(Bx)return kx;Bx=1;var t=HX(),e=Kh(),i=jh(),n=tc(),s=zu(),r=VX(),a=ec(),o=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,t.sys.events.once(a.BOOT,this.boot,this),t.sys.events.on(a.START,this.start,this)},boot:function(){var e=this.systems;e.settings.cameras?this.fromJSON(e.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new t(0,0,e.scale.width,e.scale.height).setScene(this.scene),e.game.scale.on(r.RESIZE,this.onResize,this),this.systems.events.once(a.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(a.UPDATE,this.update,this),e.once(a.SHUTDOWN,this.shutdown,this)},add:function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===s&&(s=this.scene.sys.scale.height),void 0===r&&(r=!1),void 0===a&&(a="");var o=new t(e,i,n,s);return o.setName(a),o.setScene(this.scene),o.setRoundPixels(this.roundPixels),o.id=this.getNextID(),this.cameras.push(o),r&&(this.main=o),o},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,i=0;i<32;i++){for(var n=!1,s=0;s<t.length;s++){var r=t[s];r&&r.id===e&&(n=!0)}if(!n)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,i=this.cameras,n=0;n<i.length;n++){var s=i[n];(!t||t&&s.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,s=0;s<t.length;s++){var r=t[s],a=i(r,"x",0),o=i(r,"y",0),h=i(r,"width",e),l=i(r,"height",n),u=this.add(a,o,h,l);u.name=i(r,"name",""),u.zoom=i(r,"zoom",1),u.rotation=i(r,"rotation",0),u.scrollX=i(r,"scrollX",0),u.scrollY=i(r,"scrollY",0),u.roundPixels=i(r,"roundPixels",!1),u.visible=i(r,"visible",!0);var c=i(r,"backgroundColor",!1);c&&u.setBackgroundColor(c);var d=i(r,"bounds",null);if(d){var f=i(d,"x",0),p=i(d,"y",0),g=i(d,"width",e),v=i(d,"height",n);u.setBounds(f,p,g,v)}}return this},getCamera:function(t){for(var e=this.cameras,i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,i=t.x,n=t.y,r=[],a=0;a<e.length;a++){var o=e[a];o.visible&&o.inputEnabled&&s(o,i,n)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0,n=this.cameras,s=0;s<t.length;s++){var r=n.indexOf(t[s]);-1!==r&&(e?n[r].destroy():n[r].renderList=[],n.splice(r,1),i++)}return!this.main&&n[0]&&(this.main=n[0]),i},render:function(t,e){for(var i=this.scene,n=this.cameras,s=0;s<n.length;s++){var r=n[s];if(r.visible&&r.alpha>0){r.preRender();var a=this.getVisibleChildren(e.getChildren(),r);t.render(i,a,r)}}},getVisibleChildren:function(t,e){return t.filter(function(t){return t.willRender(e)})},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].update(t,e)},onResize:function(t,e,i,n,s){for(var r=0;r<this.cameras.length;r++){var a=this.cameras[r];0===a._x&&0===a._y&&a._width===n&&a._height===s&&a.setSize(e.width,e.height)}},resize:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(a.UPDATE,this.update,this),e.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(a.START,this.start,this),this.systems.events.off(a.DESTROY,this.destroy,this),this.systems.game.scale.off(r.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});return n.register("CameraManager",o,"cameras"),kx=o}function qX(){if(Gx)return Xx;Gx=1;var t={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};return t.DefaultScene.push("CameraManager3D"),t.Global.push("facebook"),Xx=t}function KX(){if(Hx)return Wx;Hx=1;return Wx=function(t,e,i,n){return Math.atan2(n-e,i-t)}}function ZX(){if(jx)return Vx;jx=1;return Vx=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}}function JX(){if(Kx)return qx;Kx=1;return qx=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}}function $X(){if(Jx)return Zx;Jx=1;return Zx=function(t,e,i,n){return Math.atan2(i-t,n-e)}}function QX(){if(Qx)return $x;Qx=1;var t=il();return $x=function(e){return e>Math.PI&&(e-=t.PI2),Math.abs(((e+t.TAU)%t.PI2-t.PI2)%t.PI2)},$x}function tG(){if(ew)return tw;ew=1;return tw=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI},tw}function eG(){if(nw)return iw;nw=1;var t=tG();return iw=function(e,i){return t(i-e)}}function iG(){if(rw)return sw;rw=1;var t=tG(),e=2*Math.PI;return sw=function(i,n){var s=t(n-i);return s>0&&(s-=e),s},sw}function nG(){if(ow)return aw;ow=1;var t=bc();return aw=function(e,i){return t(i-e)}}function sG(){if(lw)return hw;lw=1;return hw=function(t,e){return Math.random()*(e-t)+t}}function rG(){if(cw)return uw;cw=1;var t=sG();return uw=function(){return t(-Math.PI,Math.PI)}}function aG(){if(fw)return dw;fw=1;var t=sG();return dw=function(){return t(-180,180)}}function oG(){if(gw)return pw;gw=1;var t=tG();return pw=function(e){return t(e+Math.PI)},pw}function hG(){if(mw)return vw;mw=1;var t=il();return vw=function(e,i,n){return void 0===n&&(n=.05),e===i||(Math.abs(i-e)<=n||Math.abs(i-e)>=t.PI2-n?e=i:(Math.abs(i-e)>Math.PI&&(i<e?i+=t.PI2:i-=t.PI2),i>e?e+=n:i<e&&(e-=n))),e}}function lG(){if(xw)return yw;xw=1;return yw=function(t,e){var i=e-t;return 0===i?0:i-360*Math.floor((i- -180)/360)}}function uG(){if(Sw)return Tw;Sw=1;return Tw=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}}function cG(){if(_w)return Ew;_w=1;return Ew=function(t,e,i,n){return Math.max(Math.abs(t-i),Math.abs(e-n))}}function dG(){if(Aw)return Cw;Aw=1;return Cw=function(t,e,i,n,s){return void 0===s&&(s=2),Math.sqrt(Math.pow(i-t,s)+Math.pow(n-e,s))}}function fG(){if(Mw)return Pw;Mw=1;return Pw=function(t,e,i,n){return Math.abs(t-i)+Math.abs(e-n)}}function pG(){if(Lw)return Rw;Lw=1;return Rw=function(t,e,i,n){var s=t-i,r=e-n;return s*s+r*r}}function gG(){if(Bw)return kw;Bw=1;return kw=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}}function vG(){if(zw)return Nw;zw=1;return Nw=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}}function mG(){if(Yw)return Uw;Yw=1;return Uw=function(t,e,i){return void 0===i&&(i=1e-4),t>e-i}}function yG(){if(Gw)return Xw;Gw=1;return Xw=function(t,e,i){return void 0===i&&(i=1e-4),t<e+i}}function xG(){if(jw)return Vw;jw=1;return Vw=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}}function wG(){if(Kw)return qw;Kw=1;var t=xG();return qw=function(e,i){return t(e)/t(i)/t(e-i)}}function bG(){if(Jw)return Zw;Jw=1;var t=wG();return Zw=function(e,i){for(var n=0,s=e.length-1,r=0;r<=s;r++)n+=Math.pow(1-i,s-r)*Math.pow(i,r)*e[r]*t(s,r);return n}}function TG(){if(Qw)return $w;Qw=1;return $w=function(t,e,i,n,s){var r=.5*(n-e),a=.5*(s-i),o=t*t;return(2*i-2*n+r+a)*(t*o)+(-3*i+3*n-2*r-a)*o+r*t+i}}function SG(){if(eb)return tb;eb=1;var t=TG();return tb=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return e[0]===e[n]?(i<0&&(r=Math.floor(s=n*(1+i))),t(s-r,e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n])):i<0?e[0]-(t(-s,e[0],e[0],e[1],e[1])-e[0]):i>1?e[n]-(t(s-n,e[n],e[n],e[n-1],e[n-1])-e[n]):t(s-r,e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2])}}function EG(){if(nb)return ib;nb=1;return ib=function(t,e,i,n,s){return function(t,e){var i=1-t;return i*i*i*e}(t,e)+function(t,e){var i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,s)}}function _G(){if(rb)return sb;rb=1;var t=WX();return sb=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return i<0?t(e[0],e[1],s):i>1?t(e[n],e[n-1],n-s):t(e[r],e[r+1>n?n:r+1],s-r)}}function CG(){if(ob)return ab;ob=1;return ab=function(t,e,i,n){return function(t,e){var i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)}}function AG(){if(lb)return hb;lb=1;var t=sX();return hb=function(e,i,n){return i+(n-i)*t(e,0,1)}}function PG(){if(cb)return ub;cb=1;var t=iX();return ub=function(e,i,n){return i+(n-i)*t(e,0,1)}}function MG(){if(gb)return pb;gb=1;return pb=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}}function RG(){if(mb)return vb;mb=1;return vb=function(t,e){return t>0&&!(t&t-1)&&e>0&&!(e&e-1)}}function LG(){if(xb)return yb;xb=1;return yb=function(t){return t>0&&!(t&t-1)}}function OG(){if(Sb)return Tb;Sb=1;return Tb=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.ceil(t/e),n?(i+t)/e:i+t)}}function FG(){if(_b)return Eb;_b=1;return Eb=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.floor(t/e),n?(i+t)/e:i+t)}}function DG(){if(Ab)return Cb;Ab=1;return Cb=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.round(t/e),n?(i+t)/e:i+t)}}function IG(){if(Lb)return Rb;Lb=1;var t=new(Kh())({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,i=this.n;t=t.toString();for(var n=0;n<t.length;n++)e=.02519603282416938*(i+=t.charCodeAt(n)),e-=i=e>>>0,i=(e*=i)>>>0,i+=4294967296*(e-=i);return this.n=i,2.3283064365386963e-10*(i>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-.5)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(this.frac()*(e+1)),n=t[i];t[i]=t[e],t[e]=n}return t}});return Rb=t}function kG(){if(Fb)return Ob;Fb=1;return Ob=function(t){for(var e=0,i=0;i<t.length;i++)e+=+t[i];return e/t.length}}function BG(){if(Ib)return Db;Ib=1;return Db=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.ceil(t*n)/n}}function NG(){if(Bb)return kb;Bb=1;return kb=function(t,e){return Math.abs(t-e)}}function zG(){if(zb)return Nb;zb=1;var t=new(Kh())({initialize:function(t,e,i){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new t(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},crossVectors:function(t,e){var i=t.x,n=t.y,s=t.z,r=e.x,a=e.y,o=e.z;return this.x=n*o-s*a,this.y=s*r-i*o,this.z=i*a-n*r,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return Math.sqrt(e*e+i*i+n*n)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return e*e+i*i+n*n},length:function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},lengthSq:function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},normalize:function(){var t=this.x,e=this.y,i=this.z,n=t*t+e*e+i*i;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n,this.z=i*n),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z;return this.x=i*a-n*r,this.y=n*s-e*a,this.z=e*r-i*s,this},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this},transformMat3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=e*s[0]+i*s[3]+n*s[6],this.y=e*s[1]+i*s[4]+n*s[7],this.z=e*s[2]+i*s[5]+n*s[8],this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12],this.y=s[1]*e+s[5]*i+s[9]*n+s[13],this.z=s[2]*e+s[6]*i+s[10]*n+s[14],this},transformCoordinates:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=e*s[0]+i*s[4]+n*s[8]+s[12],a=e*s[1]+i*s[5]+n*s[9]+s[13],o=e*s[2]+i*s[6]+n*s[10]+s[14],h=e*s[3]+i*s[7]+n*s[11]+s[15];return this.x=r/h,this.y=a/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},project:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],d=s[7],f=s[8],p=s[9],g=s[10],v=s[11],m=s[12],y=s[13],x=s[14],w=1/(e*h+i*d+n*v+s[15]);return this.x=(e*r+i*l+n*f+m)*w,this.y=(e*a+i*u+n*p+y)*w,this.z=(e*o+i*c+n*g+x)*w,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=this.x-i,o=r-this.y-1-n,h=this.z;return this.x=2*a/s-1,this.y=2*o/r-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});return t.ZERO=new t,t.RIGHT=new t(1,0,0),t.LEFT=new t(-1,0,0),t.UP=new t(0,-1,0),t.DOWN=new t(0,1,0),t.FORWARD=new t(0,0,1),t.BACK=new t(0,0,-1),t.ONE=new t(1,1,1),Nb=t}function UG(){if(Yb)return Ub;Yb=1;var t=Kh(),e=zG(),i=1e-6,n=new t({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new n(this)},set:function(t){return this.copy(t)},setValues:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g){var v=this.val;return v[0]=t,v[1]=e,v[2]=i,v[3]=n,v[4]=s,v[5]=r,v[6]=a,v[7]=o,v[8]=h,v[9]=l,v[10]=u,v[11]=c,v[12]=d,v[13]=f,v[14]=p,v[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,i){var n=s.fromQuat(i).val,r=e.x,a=e.y,o=e.z;return this.setValues(n[0]*r,n[1]*r,n[2]*r,0,n[4]*a,n[5]*a,n[6]*a,0,n[8]*o,n[9]*o,n[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,i){this.identity();var n=this.val;return n[12]=t,n[13]=e,n[14]=i,this},scaling:function(t,e,i){this.zero();var n=this.val;return n[0]=t,n[5]=e,n[10]=i,n[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[3],s=t[6],r=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=s,t[11]=t[14],t[12]=n,t[13]=r,t[14]=a,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15],m=e*a-i*r,y=e*o-n*r,x=e*h-s*r,w=i*o-n*a,b=i*h-s*a,T=n*h-s*o,S=l*p-u*f,E=l*g-c*f,_=l*v-d*f,C=u*g-c*p,A=u*v-d*p,P=c*v-d*g,M=m*P-y*A+x*C+w*_-b*E+T*S;return M?(M=1/M,this.setValues((a*P-o*A+h*C)*M,(n*A-i*P-s*C)*M,(p*T-g*b+v*w)*M,(c*b-u*T-d*w)*M,(o*_-r*P-h*E)*M,(e*P-n*_+s*E)*M,(g*x-f*T-v*y)*M,(l*T-c*x+d*y)*M,(r*A-a*_+h*S)*M,(i*_-e*A-s*S)*M,(f*b-p*x+v*m)*M,(u*x-l*b-d*m)*M,(a*E-r*C-o*S)*M,(e*C-i*E+n*S)*M,(p*y-f*w-g*m)*M,(l*w-u*y+c*m)*M)):this},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return this.setValues(a*(c*v-d*g)-u*(o*v-h*g)+p*(o*d-h*c),-(i*(c*v-d*g)-u*(n*v-s*g)+p*(n*d-s*c)),i*(o*v-h*g)-a*(n*v-s*g)+p*(n*h-s*o),-(i*(o*d-h*c)-a*(n*d-s*c)+u*(n*h-s*o)),-(r*(c*v-d*g)-l*(o*v-h*g)+f*(o*d-h*c)),e*(c*v-d*g)-l*(n*v-s*g)+f*(n*d-s*c),-(e*(o*v-h*g)-r*(n*v-s*g)+f*(n*h-s*o)),e*(o*d-h*c)-r*(n*d-s*c)+l*(n*h-s*o),r*(u*v-d*p)-l*(a*v-h*p)+f*(a*d-h*u),-(e*(u*v-d*p)-l*(i*v-s*p)+f*(i*d-s*u)),e*(a*v-h*p)-r*(i*v-s*p)+f*(i*h-s*a),-(e*(a*d-h*u)-r*(i*d-s*u)+l*(i*h-s*a)),-(r*(u*g-c*p)-l*(a*g-o*p)+f*(a*c-o*u)),e*(u*g-c*p)-l*(i*g-n*p)+f*(i*c-n*u),-(e*(a*g-o*p)-r*(i*g-n*p)+f*(i*o-n*a)),e*(a*c-o*u)-r*(i*c-n*u)+l*(i*o-n*a))},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return(e*a-i*r)*(c*v-d*g)-(e*o-n*r)*(u*v-d*p)+(e*h-s*r)*(u*g-c*p)+(i*o-n*a)*(l*v-d*f)-(i*h-s*a)*(l*g-c*f)+(n*h-s*o)*(l*p-u*f)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=t.val,x=y[0],w=y[1],b=y[2],T=y[3];return e[0]=x*i+w*a+b*u+T*p,e[1]=x*n+w*o+b*c+T*g,e[2]=x*s+w*h+b*d+T*v,e[3]=x*r+w*l+b*f+T*m,x=y[4],w=y[5],b=y[6],T=y[7],e[4]=x*i+w*a+b*u+T*p,e[5]=x*n+w*o+b*c+T*g,e[6]=x*s+w*h+b*d+T*v,e[7]=x*r+w*l+b*f+T*m,x=y[8],w=y[9],b=y[10],T=y[11],e[8]=x*i+w*a+b*u+T*p,e[9]=x*n+w*o+b*c+T*g,e[10]=x*s+w*h+b*d+T*v,e[11]=x*r+w*l+b*f+T*m,x=y[12],w=y[13],b=y[14],T=y[15],e[12]=x*i+w*a+b*u+T*p,e[13]=x*n+w*o+b*c+T*g,e[14]=x*s+w*h+b*d+T*v,e[15]=x*r+w*l+b*f+T*m,this},multiplyLocal:function(t){var e=this.val,i=t.val;return this.setValues(e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+e[3]*i[12],e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+e[3]*i[13],e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+e[3]*i[14],e[0]*i[3]+e[1]*i[7]+e[2]*i[11]+e[3]*i[15],e[4]*i[0]+e[5]*i[4]+e[6]*i[8]+e[7]*i[12],e[4]*i[1]+e[5]*i[5]+e[6]*i[9]+e[7]*i[13],e[4]*i[2]+e[5]*i[6]+e[6]*i[10]+e[7]*i[14],e[4]*i[3]+e[5]*i[7]+e[6]*i[11]+e[7]*i[15],e[8]*i[0]+e[9]*i[4]+e[10]*i[8]+e[11]*i[12],e[8]*i[1]+e[9]*i[5]+e[10]*i[9]+e[11]*i[13],e[8]*i[2]+e[9]*i[6]+e[10]*i[10]+e[11]*i[14],e[8]*i[3]+e[9]*i[7]+e[10]*i[11]+e[11]*i[15],e[12]*i[0]+e[13]*i[4]+e[14]*i[8]+e[15]*i[12],e[12]*i[1]+e[13]*i[5]+e[14]*i[9]+e[15]*i[13],e[12]*i[2]+e[13]*i[6]+e[14]*i[10]+e[15]*i[14],e[12]*i[3]+e[13]*i[7]+e[14]*i[11]+e[15]*i[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.val,n=e.val,s=i[0],r=i[4],a=i[8],o=i[12],h=i[1],l=i[5],u=i[9],c=i[13],d=i[2],f=i[6],p=i[10],g=i[14],v=i[3],m=i[7],y=i[11],x=i[15],w=n[0],b=n[4],T=n[8],S=n[12],E=n[1],_=n[5],C=n[9],A=n[13],P=n[2],M=n[6],R=n[10],L=n[14],O=n[3],F=n[7],D=n[11],I=n[15];return this.setValues(s*w+r*E+a*P+o*O,h*w+l*E+u*P+c*O,d*w+f*E+p*P+g*O,v*w+m*E+y*P+x*O,s*b+r*_+a*M+o*F,h*b+l*_+u*M+c*F,d*b+f*_+p*M+g*F,v*b+m*_+y*M+x*F,s*T+r*C+a*R+o*D,h*T+l*C+u*R+c*D,d*T+f*C+p*R+g*D,v*T+m*C+y*R+x*D,s*S+r*A+a*L+o*I,h*S+l*A+u*L+c*I,d*S+f*A+p*L+g*I,v*S+m*A+y*L+x*I)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,i){var n=this.val;return n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,i){var n=this.val;return n[0]=n[0]*t,n[1]=n[1]*t,n[2]=n[2]*t,n[3]=n[3]*t,n[4]=n[4]*e,n[5]=n[5]*e,n[6]=n[6]*e,n[7]=n[7]*e,n[8]=n[8]*i,n[9]=n[9]*i,n[10]=n[10]*i,n[11]=n[11]*i,this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,a=t.y,o=t.z,h=s*r,l=s*a;return this.setValues(h*r+i,h*a-n*o,h*o+n*a,0,h*a+n*o,l*a+i,l*o-n*r,0,h*o-n*a,l*o+n*r,s*o*o+i,0,0,0,0,1)},rotate:function(t,e){var n=this.val,s=e.x,r=e.y,a=e.z,o=Math.sqrt(s*s+r*r+a*a);if(Math.abs(o)<i)return this;s*=o=1/o,r*=o,a*=o;var h=Math.sin(t),l=Math.cos(t),u=1-l,c=n[0],d=n[1],f=n[2],p=n[3],g=n[4],v=n[5],m=n[6],y=n[7],x=n[8],w=n[9],b=n[10],T=n[11],S=n[12],E=n[13],_=n[14],C=n[15],A=s*s*u+l,P=r*s*u+a*h,M=a*s*u-r*h,R=s*r*u-a*h,L=r*r*u+l,O=a*r*u+s*h,F=s*a*u+r*h,D=r*a*u-s*h,I=a*a*u+l;return this.setValues(c*A+g*P+x*M,d*A+v*P+w*M,f*A+m*P+b*M,p*A+y*P+T*M,c*R+g*L+x*O,d*R+v*L+w*O,f*R+m*L+b*O,p*R+y*L+T*O,c*F+g*D+x*I,d*F+v*D+w*I,f*F+m*D+b*I,p*F+y*D+T*I,S,E,_,C)},rotateX:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[4],r=e[5],a=e[6],o=e[7],h=e[8],l=e[9],u=e[10],c=e[11];return e[4]=s*n+h*i,e[5]=r*n+l*i,e[6]=a*n+u*i,e[7]=o*n+c*i,e[8]=h*n-s*i,e[9]=l*n-r*i,e[10]=u*n-a*i,e[11]=c*n-o*i,this},rotateY:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[8],l=e[9],u=e[10],c=e[11];return e[0]=s*n-h*i,e[1]=r*n-l*i,e[2]=a*n-u*i,e[3]=o*n-c*i,e[8]=s*i+h*n,e[9]=r*i+l*n,e[10]=a*i+u*n,e[11]=o*i+c*n,this},rotateZ:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[4],l=e[5],u=e[6],c=e[7];return e[0]=s*n+h*i,e[1]=r*n+l*i,e[2]=a*n+u*i,e[3]=o*n+c*i,e[4]=h*n-s*i,e[5]=l*n-r*i,e[6]=u*n-a*i,e[7]=c*n-o*i,this},fromRotationTranslation:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=i+i,o=n+n,h=s+s,l=i*a,u=i*o,c=i*h,d=n*o,f=n*h,p=s*h,g=r*a,v=r*o,m=r*h;return this.setValues(1-(d+p),u+m,c-v,0,u-m,1-(l+p),f+g,0,c+v,f-g,1-(l+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,v=s*o;return this.setValues(1-(c+f),l+v,u-g,0,l-v,1-(h+f),d+p,0,u+g,d-p,1-(h+c),0,0,0,0,1)},frustum:function(t,e,i,n,s,r){var a=1/(e-t),o=1/(n-i),h=1/(s-r);return this.setValues(2*s*a,0,0,0,0,2*s*o,0,0,(e+t)*a,(n+i)*o,(r+s)*h,-1,0,0,r*s*2*h,0)},perspective:function(t,e,i,n){var s=1/Math.tan(t/2),r=1/(i-n);return this.setValues(s/e,0,0,0,0,s,0,0,0,0,(n+i)*r,-1,0,0,2*n*i*r,0)},perspectiveLH:function(t,e,i,n){return this.setValues(2*i/t,0,0,0,0,2*i/e,0,0,0,0,-n/(i-n),1,0,0,i*n/(i-n),0)},ortho:function(t,e,i,n,s,r){var a=t-e,o=i-n,h=s-r;return a=0===a?a:1/a,o=0===o?o:1/o,h=0===h?h:1/h,this.setValues(-2*a,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*a,(n+i)*o,(r+s)*h,1)},lookAtRH:function(t,e,i){var n=this.val;return h.subVectors(t,e),0===h.lengthSq()&&(h.z=1),h.normalize(),a.crossVectors(i,h),0===a.lengthSq()&&(1===Math.abs(i.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),a.crossVectors(i,h)),a.normalize(),o.crossVectors(h,a),n[0]=a.x,n[1]=a.y,n[2]=a.z,n[4]=o.x,n[5]=o.y,n[6]=o.z,n[8]=h.x,n[9]=h.y,n[10]=h.z,this},lookAt:function(t,e,n){var s=t.x,r=t.y,a=t.z,o=n.x,h=n.y,l=n.z,u=e.x,c=e.y,d=e.z;if(Math.abs(s-u)<i&&Math.abs(r-c)<i&&Math.abs(a-d)<i)return this.identity();var f=s-u,p=r-c,g=a-d,v=1/Math.sqrt(f*f+p*p+g*g),m=h*(g*=v)-l*(p*=v),y=l*(f*=v)-o*g,x=o*p-h*f;(v=Math.sqrt(m*m+y*y+x*x))?(m*=v=1/v,y*=v,x*=v):(m=0,y=0,x=0);var w=p*x-g*y,b=g*m-f*x,T=f*y-p*m;return(v=Math.sqrt(w*w+b*b+T*T))?(w*=v=1/v,b*=v,T*=v):(w=0,b=0,T=0),this.setValues(m,w,f,0,y,b,p,0,x,T,g,0,-(m*s+y*r+x*a),-(w*s+b*r+T*a),-(f*s+p*r+g*a),1)},yawPitchRoll:function(t,e,i){this.zero(),s.zero(),r.zero();var n=this.val,a=s.val,o=r.val,h=Math.sin(i),l=Math.cos(i);return n[10]=1,n[15]=1,n[0]=l,n[1]=h,n[4]=-h,n[5]=l,h=Math.sin(e),l=Math.cos(e),a[0]=1,a[15]=1,a[5]=l,a[10]=l,a[9]=-h,a[6]=h,h=Math.sin(t),l=Math.cos(t),o[5]=1,o[15]=1,o[0]=l,o[2]=-h,o[8]=h,o[10]=l,this.multiplyLocal(s),this.multiplyLocal(r),this},setWorldMatrix:function(t,e,i,n,a){return this.yawPitchRoll(t.y,t.x,t.z),s.scaling(i.x,i.y,i.z),r.xyz(e.x,e.y,e.z),this.multiplyLocal(s),this.multiplyLocal(r),n&&this.multiplyLocal(n),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var i=this.val,n=t.val,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=i[6],c=i[7],d=i[8],f=i[9],p=i[10],g=i[11],v=i[12],m=i[13],y=i[14],x=i[15],w=n[0],b=n[1],T=n[2],S=n[3],E=n[4],_=n[5],C=n[6],A=n[7],P=n[8],M=n[9],R=n[10],L=n[11],O=n[12],F=n[13],D=n[14],I=n[15];return e.setValues(w*s+b*h+T*d+S*v,b*r+b*l+T*f+S*m,T*a+b*u+T*p+S*y,S*o+b*c+T*g+S*x,E*s+_*h+C*d+A*v,E*r+_*l+C*f+A*m,E*a+_*u+C*p+A*y,E*o+_*c+C*g+A*x,P*s+M*h+R*d+L*v,P*r+M*l+R*f+L*m,P*a+M*u+R*p+L*y,P*o+M*c+R*g+L*x,O*s+F*h+D*d+I*v,O*r+F*l+D*f+I*m,O*a+F*u+D*p+I*y,O*o+F*c+D*g+I*x)},fromRotationXYTranslation:function(t,e,i){var n=e.x,s=e.y,r=e.z,a=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),l=Math.cos(t.y),u=n,c=s,d=r,f=-a,p=0-f*h,g=0-o*h,v=f*l,m=o*l;return i||(u=l*n+h*r,c=p*n+o*s+v*r,d=g*n+a*s+m*r),this.setValues(l,p,g,0,0,o,a,0,h,v,m,0,u,c,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}}),s=new n,r=new n,a=new e,o=new e,h=new e;return Ub=n}function YG(){if(Gb)return Xb;Gb=1;var t=tl(),e=Kh(),i=UG(),n=qh(),s=new i,r=new e({initialize:function t(e,i,s,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===r&&(r=t.DefaultOrder),this._x=e,this._y=i,this._z=s,this._order=r,this.onChangeCallback=n},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,i,n){return void 0===n&&(n=this._order),this._x=t,this._y=e,this._z=i,this._order=n,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,i){return void 0===e&&(e=this._order),void 0===i&&(i=!1),s.fromQuat(t),this.setFromRotationMatrix(s,e,i)},setFromRotationMatrix:function(e,i,n){void 0===i&&(i=this._order),void 0===n&&(n=!1);var s=e.val,r=s[0],a=s[4],o=s[8],h=s[1],l=s[5],u=s[9],c=s[2],d=s[6],f=s[10],p=0,g=0,v=0,m=.99999;switch(i){case"XYZ":g=Math.asin(t(o,-1,1)),Math.abs(o)<m?(p=Math.atan2(-u,f),v=Math.atan2(-a,r)):p=Math.atan2(d,l);break;case"YXZ":p=Math.asin(-t(u,-1,1)),Math.abs(u)<m?(g=Math.atan2(o,f),v=Math.atan2(h,l)):g=Math.atan2(-c,r);break;case"ZXY":p=Math.asin(t(d,-1,1)),Math.abs(d)<m?(g=Math.atan2(-c,f),v=Math.atan2(-a,l)):v=Math.atan2(h,r);break;case"ZYX":g=Math.asin(-t(c,-1,1)),Math.abs(c)<m?(p=Math.atan2(d,f),v=Math.atan2(h,r)):v=Math.atan2(-a,l);break;case"YZX":v=Math.asin(t(h,-1,1)),Math.abs(h)<m?(p=Math.atan2(-u,l),g=Math.atan2(-c,r)):g=Math.atan2(o,f);break;case"XZY":v=Math.asin(-t(a,-1,1)),Math.abs(a)<m?(p=Math.atan2(d,l),g=Math.atan2(o,r)):p=Math.atan2(-u,f)}return this._x=p,this._y=g,this._z=v,this._order=i,n&&this.onChangeCallback(this),this}});return r.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],r.DefaultOrder="XYZ",Xb=r}function XG(){if(Hb)return Wb;Hb=1;return Wb=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.floor(t*n)/n}}function GG(){if(jb)return Vb;jb=1;return Vb=function(t,e){return t/e/1e3},Vb}function WG(){if(Kb)return qb;Kb=1;return qb=function(t){return t==parseFloat(t)?!(t%2):void 0}}function HG(){if(Jb)return Zb;Jb=1;return Zb=function(t){return t===parseFloat(t)?!(t%2):void 0}}function VG(){if(Qb)return $b;Qb=1;return $b=function(t,e,i){return void 0===i&&(i=0),t.clone().lerp(e,i)}}function jG(){if(eT)return tT;eT=1;return tT=function(t,e,i){return Math.min(t+e,i)}}function qG(){if(nT)return iT;nT=1;return iT=function(t){var e=t.length;if(0===e)return 0;t.sort(function(t,e){return t-e});var i=Math.floor(e/2);return e%2==0?(t[i]+t[i-1])/2:t[i]}}function KG(){if(rT)return sT;rT=1;return sT=function(t,e,i){return Math.max(t-e,i)}}function ZG(){if(oT)return aT;oT=1;return aT=function(t,e,i,n){void 0===i&&(i=e+1);var s=(t-e)/(i-e);return s>1?void 0!==n?(s=(n-t)/(n-i))<0&&(s=0):s=1:s<0&&(s=0),s}}function JG(){if(lT)return hT;lT=1;var t=il();return hT=function(e){return e*t.RAD_TO_DEG},hT}function $G(){if(cT)return uT;cT=1;return uT=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI;return t.x=Math.cos(i)*e,t.y=Math.sin(i)*e,t},uT}function QG(){if(fT)return dT;fT=1;return dT=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI,n=2*Math.random()-1,s=Math.sqrt(1-n*n)*e;return t.x=Math.cos(i)*s,t.y=Math.sin(i)*s,t.z=n*e,t}}function tW(){if(gT)return pT;gT=1;return pT=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t},pT}function eW(){if(mT)return vT;mT=1;return vT=function(t,e){var i=t.x,n=t.y;return t.x=i*Math.cos(e)-n*Math.sin(e),t.y=i*Math.sin(e)+n*Math.cos(e),t},vT}function iW(){if(xT)return yT;xT=1;return yT=function(t,e,i,n,s){return t.x=e+s*Math.cos(n),t.y=i+s*Math.sin(n),t},yT}function nW(){if(bT)return wT;bT=1;return wT=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.round(t*n)/n}}function sW(){if(ST)return TT;ST=1;return TT=function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),n*=Math.PI/t;for(var s=[],r=[],a=0;a<t;a++)e+=(i-=e*n)*n,s[a]=i,r[a]=e;return{sin:r,cos:s,length:t}}}function rW(){if(_T)return ET;_T=1;var t=qu();return ET=function(e,i,n,s){void 0===s&&(s=new t);var r=0,a=0;return e>0&&e<=i*n&&(r=e>i-1?e-(a=Math.floor(e/i))*i:e),s.set(r,a)}}function aW(){if(AT)return CT;AT=1;return CT=function(t,e,i){return Math.abs(t-e)<=i}}function oW(){if(MT)return PT;MT=1;var t=new(Kh())({initialize:function(t,e,i,n){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},clone:function(){return new t(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,i,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this.x=t*s,this.y=e*s,this.z=i*s,this.w=n*s),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this.w=r+e*(t.w-r),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return Math.sqrt(e*e+i*i+n*n+s*s)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return e*e+i*i+n*n+s*s},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.val;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*s,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*s,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*s,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*s,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});return t.prototype.sub=t.prototype.subtract,t.prototype.mul=t.prototype.multiply,t.prototype.div=t.prototype.divide,t.prototype.dist=t.prototype.distance,t.prototype.distSq=t.prototype.distanceSq,t.prototype.len=t.prototype.length,t.prototype.lenSq=t.prototype.lengthSq,PT=t}function hW(){if(LT)return RT;LT=1;var t=new(Kh())({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new t(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},fromMat4:function(t){var e=t.val,i=this.val;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=i,t[7]=n,this},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=l*r-a*h,c=-l*s+a*o,d=h*s-r*o,f=e*u+i*c+n*d;return f?(f=1/f,t[0]=u*f,t[1]=(-l*i+n*h)*f,t[2]=(a*i-n*r)*f,t[3]=c*f,t[4]=(l*e-n*o)*f,t[5]=(-a*e+n*s)*f,t[6]=d*f,t[7]=(-h*e+i*o)*f,t[8]=(r*e-i*s)*f,this):null},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return t[0]=r*l-a*h,t[1]=n*h-i*l,t[2]=i*a-n*r,t[3]=a*o-s*l,t[4]=e*l-n*o,t[5]=n*s-e*a,t[6]=s*h-r*o,t[7]=i*o-e*h,t[8]=e*r-i*s,this},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return e*(l*r-a*h)+i*(-l*s+a*o)+n*(h*s-r*o)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=t.val,d=c[0],f=c[1],p=c[2],g=c[3],v=c[4],m=c[5],y=c[6],x=c[7],w=c[8];return e[0]=d*i+f*r+p*h,e[1]=d*n+f*a+p*l,e[2]=d*s+f*o+p*u,e[3]=g*i+v*r+m*h,e[4]=g*n+v*a+m*l,e[5]=g*s+v*o+m*u,e[6]=y*i+x*r+w*h,e[7]=y*n+x*a+w*l,e[8]=y*s+x*o+w*u,this},translate:function(t){var e=this.val,i=t.x,n=t.y;return e[6]=i*e[0]+n*e[3]+e[6],e[7]=i*e[1]+n*e[4]+e[7],e[8]=i*e[2]+n*e[5]+e[8],this},rotate:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=Math.sin(t),l=Math.cos(t);return e[0]=l*i+h*r,e[1]=l*n+h*a,e[2]=l*s+h*o,e[3]=l*r-h*i,e[4]=l*a-h*n,e[5]=l*o-h*s,this},scale:function(t){var e=this.val,i=t.x,n=t.y;return e[0]=i*e[0],e[1]=i*e[1],e[2]=i*e[2],e[3]=n*e[3],e[4]=n*e[4],e[5]=n*e[5],this},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,v=s*o,m=this.val;return m[0]=1-(c+f),m[3]=l+v,m[6]=u-g,m[1]=l-v,m[4]=1-(h+f),m[7]=d+p,m[2]=u+g,m[5]=d-p,m[8]=1-(h+c),this},normalFromMat4:function(t){var e=t.val,i=this.val,n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],d=e[9],f=e[10],p=e[11],g=e[12],v=e[13],m=e[14],y=e[15],x=n*h-s*o,w=n*l-r*o,b=n*u-a*o,T=s*l-r*h,S=s*u-a*h,E=r*u-a*l,_=c*v-d*g,C=c*m-f*g,A=c*y-p*g,P=d*m-f*v,M=d*y-p*v,R=f*y-p*m,L=x*R-w*M+b*P+T*A-S*C+E*_;return L?(L=1/L,i[0]=(h*R-l*M+u*P)*L,i[1]=(l*A-o*R-u*C)*L,i[2]=(o*M-h*A+u*_)*L,i[3]=(r*M-s*R-a*P)*L,i[4]=(n*R-r*A+a*C)*L,i[5]=(s*A-n*M-a*_)*L,i[6]=(v*E-m*S+y*T)*L,i[7]=(m*b-g*E-y*w)*L,i[8]=(g*S-v*b+y*x)*L,this):null}});return RT=t}function lW(){if(FT)return OT;FT=1;var t=Kh(),e=hW(),i=qh(),n=zG(),s=1e-6,r=new Int8Array([1,2,0]),a=new Float32Array([0,0,0]),o=new n(1,0,0),h=new n(0,1,0),l=new n,u=new e,c=new t({initialize:function(t,e,n,s){this.onChangeCallback=i,this.set(t,e,n,s)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,i,n,s){return void 0===s&&(s=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=i||0,this._w=n||0),s&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this._x=t*s,this._y=e*s,this._z=i*s,this._w=n*s),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.set(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s),r+e*(t.w-r))},rotationTo:function(t,e){var i=t.x*e.x+t.y*e.y+t.z*e.z;return i<-.999999?(l.copy(o).cross(t).length()<s&&l.copy(h).cross(t),l.normalize(),this.setAxisAngle(l,Math.PI)):i>.999999?this.set(0,0,0,1):(l.copy(t).cross(e),this._x=l.x,this._y=l.y,this._z=l.z,this._w=1+i,this.normalize())},setAxes:function(t,e,i){var n=u.val;return n[0]=e.x,n[3]=e.y,n[6]=e.z,n[1]=i.x,n[4]=i.y,n[7]=i.z,n[2]=-t.x,n[5]=-t.y,n[8]=-t.z,this.fromMat3(u).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var i=Math.sin(e);return this.set(i*t.x,i*t.y,i*t.z,Math.cos(e))},multiply:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.x,a=t.y,o=t.z,h=t.w;return this.set(e*h+s*r+i*o-n*a,i*h+s*a+n*r-e*o,n*h+s*o+e*a-i*r,s*h-e*r-i*a-n*o)},slerp:function(t,e){var i=this.x,n=this.y,r=this.z,a=this.w,o=t.x,h=t.y,l=t.z,u=t.w,c=i*o+n*h+r*l+a*u;c<0&&(c=-c,o=-o,h=-h,l=-l,u=-u);var d=1-e,f=e;if(1-c>s){var p=Math.acos(c),g=Math.sin(p);d=Math.sin((1-e)*p)/g,f=Math.sin(e*p)/g}return this.set(d*i+f*o,d*n+f*h,d*r+f*l,d*a+f*u)},invert:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n,r=s?1/s:0;return this.set(-t*r,-e*r,-i*r,n*r)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+s*r,i*a+n*r,n*a-i*r,s*a-e*r)},rotateY:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a-n*r,i*a+s*r,n*a+e*r,s*a-i*r)},rotateZ:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+i*r,i*a-e*r,n*a+s*r,s*a-n*r)},calculateW:function(){var t=this.x,e=this.y,i=this.z;return this.w=-Math.sqrt(1-t*t-e*e-i*i),this},setFromEuler:function(t,e){var i=t.x/2,n=t.y/2,s=t.z/2,r=Math.cos(i),a=Math.cos(n),o=Math.cos(s),h=Math.sin(i),l=Math.sin(n),u=Math.sin(s);switch(t.order){case"XYZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"YXZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"ZXY":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"ZYX":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"YZX":this.set(h*a*o+r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o-h*l*u,e);break;case"XZY":this.set(h*a*o-r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o+h*l*u,e)}return this},setFromRotationMatrix:function(t){var e,i=t.val,n=i[0],s=i[4],r=i[8],a=i[1],o=i[5],h=i[9],l=i[2],u=i[6],c=i[10],d=n+o+c;return d>0?(e=.5/Math.sqrt(d+1),this.set((u-h)*e,(r-l)*e,(a-s)*e,.25/e)):n>o&&n>c?(e=2*Math.sqrt(1+n-o-c),this.set(.25*e,(s+a)/e,(r+l)/e,(u-h)/e)):o>c?(e=2*Math.sqrt(1+o-n-c),this.set((s+a)/e,.25*e,(h+u)/e,(r-l)/e)):(e=2*Math.sqrt(1+c-n-o),this.set((r+l)/e,(h+u)/e,.25*e,(a-s)/e)),this},fromMat3:function(t){var e,i=t.val,n=i[0]+i[4]+i[8];if(n>0)e=Math.sqrt(n+1),this.w=.5*e,e=.5/e,this._x=(i[7]-i[5])*e,this._y=(i[2]-i[6])*e,this._z=(i[3]-i[1])*e;else{var s=0;i[4]>i[0]&&(s=1),i[8]>i[3*s+s]&&(s=2);var o=r[s],h=r[o];e=Math.sqrt(i[3*s+s]-i[3*o+o]-i[3*h+h]+1),a[s]=.5*e,e=.5/e,a[o]=(i[3*o+s]+i[3*s+o])*e,a[h]=(i[3*h+s]+i[3*s+h])*e,this._x=a[0],this._y=a[1],this._z=a[2],this._w=(i[3*h+o]-i[3*o+h])*e}return this.onChangeCallback(this),this}});return OT=c}function uW(){if(IT)return DT;IT=1;var t=zG(),e=UG(),i=lW(),n=new e,s=new i,r=new t;return DT=function(t,e,i){return s.setAxisAngle(e,i),n.fromRotationTranslation(s,r.set(0,0,0)),t.transformMat4(n)},DT}function cW(){if(BT)return kT;BT=1;var t=il(),e=nh(),i={Angle:bw?ww:(bw=1,ww={Between:KX(),BetweenPoints:ZX(),BetweenPointsY:JX(),BetweenY:$X(),CounterClockwise:QX(),GetClockwiseDistance:eG(),GetCounterClockwiseDistance:iG(),GetShortestDistance:nG(),Normalize:tG(),Random:rG(),RandomDegrees:aG(),Reverse:oG(),RotateTo:hG(),ShortestBetween:lG(),Wrap:bc(),WrapDegrees:Tc()}),Distance:Fw?Ow:(Fw=1,Ow={Between:LY(),BetweenPoints:TU(),BetweenPointsSquared:uG(),Chebyshev:cG(),Power:dG(),Snake:fG(),Squared:pG()}),Easing:Iw?Dw:(Iw=1,Dw={Back:CU(),Bounce:RU(),Circular:DU(),Cubic:NU(),Elastic:XU(),Expo:VU(),Linear:jU(),Quadratic:JU(),Quartic:eY(),Quintic:rY(),Sine:lY(),Stepped:uY()}),Fuzzy:Hw?Ww:(Hw=1,Ww={Ceil:gG(),Equal:ju(),Floor:vG(),GreaterThan:mG(),LessThan:yG()}),Interpolation:fb?db:(fb=1,db={Bezier:bG(),CatmullRom:SG(),CubicBezier:EG(),Linear:_G(),QuadraticBezier:CG(),SmoothStep:AG(),SmootherStep:PG()}),Pow2:bb?wb:(bb=1,wb={GetNext:MG(),IsSize:RG(),IsValue:LG()}),Snap:Mb?Pb:(Mb=1,Pb={Ceil:OG(),Floor:FG(),To:DG()}),RandomDataGenerator:IG(),Average:kG(),Bernstein:wG(),Between:vX(),CatmullRom:TG(),CeilTo:BG(),Clamp:tl(),DegToRad:ac(),Difference:NG(),Euler:YG(),Factorial:xG(),FloatBetween:sG(),FloorTo:XG(),FromPercent:el(),GetSpeed:GG(),IsEven:WG(),IsEvenStrict:HG(),Linear:WX(),LinearXY:VG(),MaxAdd:jG(),Median:qG(),MinSub:KG(),Percent:ZG(),RadToDeg:JG(),RandomXY:$G(),RandomXYZ:QG(),RandomXYZW:tW(),Rotate:eW(),RotateAround:$u(),RotateAroundDistance:RY(),RotateTo:iW(),RoundAwayFromZero:Gl(),RoundTo:nW(),SinCosTableGenerator:sW(),SmootherStep:iX(),SmoothStep:sX(),ToXY:rW(),TransformXY:xc(),Within:aW(),Wrap:wc(),Vector2:qu(),Vector3:zG(),Vector4:oW(),Matrix3:hW(),Matrix4:UG(),Quaternion:lW(),RotateVec3:uW()};return i=e(!1,i,t),kT=i}function dW(){if(zT)return NT;zT=1;return NT={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"}}function fW(){if(YT)return UT;YT=1;var t=Kh(),e=eh(),i=qX(),n=pu(),s=jh(),r=Vl(),a=ih(),o=qh(),h=cW(),l=dW(),u=DX(),c=new t({initialize:function(t){void 0===t&&(t={});var c=r(t,"scale",null);this.width=r(c,"width",1024,t),this.height=r(c,"height",768,t),this.zoom=r(c,"zoom",1,t),this.parent=r(c,"parent",void 0,t),this.scaleMode=r(c,c?"mode":"scaleMode",0,t),this.expandParent=r(c,"expandParent",!0,t),this.autoRound=r(c,"autoRound",!1,t),this.autoCenter=r(c,"autoCenter",0,t),this.resizeInterval=r(c,"resizeInterval",500,t),this.fullscreenTarget=r(c,"fullscreenTarget",null,t),this.minWidth=r(c,"min.width",0,t),this.maxWidth=r(c,"max.width",0,t),this.minHeight=r(c,"min.height",0,t),this.maxHeight=r(c,"max.height",0,t),this.snapWidth=r(c,"snap.width",0,t),this.snapHeight=r(c,"snap.height",0,t),this.renderType=e.WEBGL,this.canvas=r(t,"canvas",null),this.context=r(t,"context",null),this.canvasStyle=r(t,"canvasStyle",null),this.customEnvironment=r(t,"customEnvironment",!1),this.sceneConfig=r(t,"scene",null),this.seed=r(t,"seed",[(Date.now()*Math.random()).toString()]),h.RND=new h.RandomDataGenerator(this.seed),this.gameTitle=r(t,"title",""),this.gameURL=r(t,"url",""),this.gameVersion=r(t,"version",""),this.autoFocus=r(t,"autoFocus",!0),this.stableSort=r(t,"stableSort",-1),-1===this.stableSort&&(this.stableSort=n.browser.es2019?1:0),n.features.stableSort=this.stableSort,this.domCreateContainer=r(t,"dom.createContainer",!1),this.domPointerEvents=r(t,"dom.pointerEvents","none"),this.inputKeyboard=r(t,"input.keyboard",!0),this.inputKeyboardEventTarget=r(t,"input.keyboard.target",window),this.inputKeyboardCapture=r(t,"input.keyboard.capture",[]),this.inputMouse=r(t,"input.mouse",!0),this.inputMouseEventTarget=r(t,"input.mouse.target",null),this.inputMousePreventDefaultDown=r(t,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=r(t,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=r(t,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=r(t,"input.mouse.preventDefaultWheel",!0),this.inputTouch=r(t,"input.touch",n.input.touch),this.inputTouchEventTarget=r(t,"input.touch.target",null),this.inputTouchCapture=r(t,"input.touch.capture",!0),this.inputActivePointers=r(t,"input.activePointers",1),this.inputSmoothFactor=r(t,"input.smoothFactor",0),this.inputWindowEvents=r(t,"input.windowEvents",!0),this.inputGamepad=r(t,"input.gamepad",!1),this.inputGamepadEventTarget=r(t,"input.gamepad.target",window),this.disableContextMenu=r(t,"disableContextMenu",!1),this.audio=r(t,"audio",{}),this.bannerTextColor=r(t,"banner.text","#ffffff"),this.bannerBackgroundColor=r(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),this.fps=r(t,"fps",null),this.disablePreFX=r(t,"disablePreFX",!1),this.disablePostFX=r(t,"disablePostFX",!1);var d=r(t,"render",null);this.pipeline=r(d,"pipeline",null,t),this.autoMobilePipeline=r(d,"autoMobilePipeline",!0,t),this.defaultPipeline=r(d,"defaultPipeline",l.MULTI_PIPELINE,t),this.antialias=r(d,"antialias",!0,t),this.antialiasGL=r(d,"antialiasGL",!0,t),this.mipmapFilter=r(d,"mipmapFilter","",t),this.desynchronized=r(d,"desynchronized",!1,t),this.roundPixels=r(d,"roundPixels",!1,t),this.pixelArt=r(d,"pixelArt",1!==this.zoom,t),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=r(d,"transparent",!1,t),this.clearBeforeRender=r(d,"clearBeforeRender",!0,t),this.preserveDrawingBuffer=r(d,"preserveDrawingBuffer",!1,t),this.premultipliedAlpha=r(d,"premultipliedAlpha",!0,t),this.failIfMajorPerformanceCaveat=r(d,"failIfMajorPerformanceCaveat",!1,t),this.powerPreference=r(d,"powerPreference","default",t),this.batchSize=r(d,"batchSize",4096,t),this.maxTextures=r(d,"maxTextures",-1,t),this.maxLights=r(d,"maxLights",10,t);var f=r(t,"backgroundColor",0);this.backgroundColor=u(f),this.transparent&&(this.backgroundColor=u(0),this.backgroundColor.alpha=0),this.preBoot=r(t,"callbacks.preBoot",o),this.postBoot=r(t,"callbacks.postBoot",o),this.physics=r(t,"physics",{}),this.defaultPhysicsSystem=r(this.physics,"default",!1),this.loaderBaseURL=r(t,"loader.baseURL",""),this.loaderPath=r(t,"loader.path",""),this.loaderMaxParallelDownloads=r(t,"loader.maxParallelDownloads",n.os.android?6:32),this.loaderCrossOrigin=r(t,"loader.crossOrigin",void 0),this.loaderResponseType=r(t,"loader.responseType",""),this.loaderAsync=r(t,"loader.async",!0),this.loaderUser=r(t,"loader.user",""),this.loaderPassword=r(t,"loader.password",""),this.loaderTimeout=r(t,"loader.timeout",0),this.loaderMaxRetries=r(t,"loader.maxRetries",2),this.loaderWithCredentials=r(t,"loader.withCredentials",!1),this.loaderImageLoadType=r(t,"loader.imageLoadType","XHR"),this.loaderLocalScheme=r(t,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=r(t,"fx.glow.quality",.1),this.glowFXDistance=r(t,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var p=r(t,"plugins",null),g=i.DefaultScene;p&&(Array.isArray(p)?this.defaultPlugins=p:a(p)&&(this.installGlobalPlugins=s(p,"global",[]),this.installScenePlugins=s(p,"scene",[]),Array.isArray(p.default)?g=p.default:Array.isArray(p.defaultMerge)&&(g=g.concat(p.defaultMerge)))),this.defaultPlugins=g;var v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=r(t,"images.default",v+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=r(t,"images.missing",v+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=r(t,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC")}});return UT=c}function pW(){if(GT)return XT;GT=1;return XT={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach(function(e){t.style["image-rendering"]=e}),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}},XT}function gW(){if(HT)return WT;HT=1;var t=ou(),e=PX(),i=jh();return WT=function(n,s){var r=i(s,"callback"),a=i(s,"type","image/png"),o=i(s,"encoder",.92),h=Math.abs(Math.round(i(s,"x",0))),l=Math.abs(Math.round(i(s,"y",0))),u=Math.floor(i(s,"width",n.width)),c=Math.floor(i(s,"height",n.height));if(i(s,"getPixel",!1)){var d=n.getContext("2d",{willReadFrequently:!1}).getImageData(h,l,1,1).data;r.call(null,new e(d[0],d[1],d[2],d[3]))}else if(0!==h||0!==l||u!==n.width||c!==n.height){var f=t.createWebGL(this,u,c),p=f.getContext("2d",{willReadFrequently:!0});u>0&&c>0&&p.drawImage(n,h,l,u,c,0,0,u,c);var g=new Image;g.onerror=function(){r.call(null),t.remove(f)},g.onload=function(){r.call(null,g),t.remove(f)},g.src=f.toDataURL(a,o)}else{var v=new Image;v.onerror=function(){r.call(null)},v.onload=function(){r.call(null,v)},v.src=n.toDataURL(a,o)}},WT}function vW(){return rS?sS:(rS=1,sS={LOSE_WEBGL:jT?VT:(jT=1,VT="losewebgl"),POST_RENDER:KT?qT:(KT=1,qT="postrender"),PRE_RENDER:JT?ZT:(JT=1,ZT="prerender"),RENDER:QT?$T:(QT=1,$T="render"),RESIZE:eS?tS:(eS=1,tS="resize"),RESTORE_WEBGL:nS?iS:(nS=1,iS="restorewebgl")})}function mW(){if(oS)return aS;oS=1;var t=Qo(),e=fu();return aS=function(){var i=[],n=e.supportNewBlendModes,s="source-over";return i[t.NORMAL]=s,i[t.ADD]="lighter",i[t.MULTIPLY]=n?"multiply":s,i[t.SCREEN]=n?"screen":s,i[t.OVERLAY]=n?"overlay":s,i[t.DARKEN]=n?"darken":s,i[t.LIGHTEN]=n?"lighten":s,i[t.COLOR_DODGE]=n?"color-dodge":s,i[t.COLOR_BURN]=n?"color-burn":s,i[t.HARD_LIGHT]=n?"hard-light":s,i[t.SOFT_LIGHT]=n?"soft-light":s,i[t.DIFFERENCE]=n?"difference":s,i[t.EXCLUSION]=n?"exclusion":s,i[t.HUE]=n?"hue":s,i[t.SATURATION]=n?"saturation":s,i[t.COLOR]=n?"color":s,i[t.LUMINOSITY]=n?"luminosity":s,i[t.ERASE]="destination-out",i[t.SOURCE_IN]="source-in",i[t.SOURCE_OUT]="source-out",i[t.SOURCE_ATOP]="source-atop",i[t.DESTINATION_OVER]="destination-over",i[t.DESTINATION_IN]="destination-in",i[t.DESTINATION_OUT]="destination-out",i[t.DESTINATION_ATOP]="destination-atop",i[t.LIGHTER]="lighter",i[t.COPY]="copy",i[t.XOR]="xor",i}}function yW(){return SS?TS:(SS=1,TS={ADD:lS?hS:(lS=1,hS="addtexture"),ADD_KEY:cS?uS:(cS=1,uS="addtexture-"),ERROR:fS?dS:(fS=1,dS="onerror"),LOAD:gS?pS:(gS=1,pS="onload"),READY:mS?vS:(mS=1,vS="ready"),REMOVE:xS?yS:(xS=1,yS="removetexture"),REMOVE_KEY:bS?wS:(bS=1,wS="removetexture-")})}function xW(){if(_S)return ES;_S=1;var t=SX(),e=gW(),i=Kh(),n=eh(),s=cU(),r=vW(),a=mW(),o=VX(),h=yW(),l=pX(),u=yc(),c=new i({Extends:s,initialize:function(t){s.call(this);var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,backgroundColor:e.backgroundColor,antialias:e.antialias,roundPixels:e.roundPixels,transparent:e.transparent},this.game=t,this.type=n.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=t.canvas;var i={alpha:e.transparent,desynchronized:e.desynchronized,willReadFrequently:!1};this.gameContext=e.context?e.context:this.gameCanvas.getContext("2d",i),this.currentContext=this.gameContext,this.antialias=e.antialias,this.blendModes=a(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new u,this._tempMatrix2=new u,this._tempMatrix3=new u,this.isBooted=!1,this.init()},init:function(){var t=this.game;t.events.once(l.BOOT,function(){var t=this.config;if(!t.transparent){var e=this.gameContext,i=this.gameCanvas;e.fillStyle=t.backgroundColor.rgba,e.fillRect(0,0,i.width,i.height)}},this),t.textures.once(h.READY,this.boot,this)},boot:function(){var t=this.game,e=t.scale.baseSize;this.width=e.width,this.height=e.height,this.isBooted=!0,t.scale.on(o.RESIZE,this.onResize,this),this.resize(e.width,e.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e,this.emit(r.RESIZE,t,e)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,i=this.width,n=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),this.emit(r.PRE_RENDER_CLEAR),e.clearBeforeRender&&(t.clearRect(0,0,i,n),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,i,n))),t.save(),this.drawCount=0,this.emit(r.PRE_RENDER)},render:function(e,i,n){var s=i.length;this.emit(r.RENDER,e,n);var a=n.x,o=n.y,h=n.width,l=n.height,u=n.renderToTexture?n.context:e.sys.context;u.save(),this.game.scene.customViewports&&(u.beginPath(),u.rect(a,o,h,l),u.clip()),n.emit(t.PRE_RENDER,n),this.currentContext=u;var c=n.mask;c&&c.preRenderCanvas(this,null,n._maskCamera),n.transparent||(u.fillStyle=n.backgroundColor.rgba,u.fillRect(a,o,h,l)),u.globalAlpha=n.alpha,u.globalCompositeOperation="source-over",this.drawCount+=s,n.renderToTexture&&n.emit(t.PRE_RENDER,n),n.matrix.copyToContext(u);for(var d=0;d<s;d++){var f=i[d];f.mask&&f.mask.preRenderCanvas(this,f,n),f.renderCanvas(this,f,n),f.mask&&f.mask.postRenderCanvas(this,f,n)}u.setTransform(1,0,0,1,0,0),u.globalCompositeOperation="source-over",u.globalAlpha=1,n.flashEffect.postRenderCanvas(u),n.fadeEffect.postRenderCanvas(u),n.dirty=!1,c&&c.postRenderCanvas(this),u.restore(),n.renderToTexture&&(n.emit(t.POST_RENDER,n),n.renderToGame&&e.sys.context.drawImage(n.canvas,a,o)),n.emit(t.POST_RENDER,n)},postRender:function(){this.gameContext.restore(),this.emit(r.POST_RENDER);var t=this.snapshotState;t.callback&&(e(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,i,n,s,r,a,o,h,l){void 0===n&&(n=!1),this.snapshotArea(s,r,a,o,i,h,l);var u=this.snapshotState;return u.getPixel=n,e(t,u),u.callback=null,this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=Math.min(i,this.gameCanvas.width),o.height=Math.min(n,this.gameCanvas.height),this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,i,n){var s=i.alpha*t.alpha;if(0!==s){var r=this.currentContext,a=this._tempMatrix1,o=this._tempMatrix2,h=e.canvasData,l=h.x,u=h.y,c=e.cutWidth,d=e.cutHeight,f=e.customPivot,p=e.source.resolution,g=t.displayOriginX,v=t.displayOriginY,m=-g+e.x,y=-v+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),c=x.cw,d=x.ch,l=x.cx,u=x.cy,m=-g+x.x,y=-v+x.y,t.flipX&&(m>=0?m=-(m+c):m<0&&(m=Math.abs(m)-c)),t.flipY&&(y>=0?y=-(y+d):y<0&&(y=Math.abs(y)-d))}var w=1,b=1;t.flipX&&(f||(m+=-e.realWidth+2*g),w=-1),t.flipY&&(f||(y+=-e.realHeight+2*v),b=-1);var T=t.x,S=t.y;if(i.roundPixels&&(T=Math.floor(T),S=Math.floor(S)),o.applyITRS(T,S,t.rotation,t.scaleX*w,t.scaleY*b),a.copyFrom(i.matrix),n?(a.multiplyWithOffset(n,-i.scrollX*t.scrollFactorX,-i.scrollY*t.scrollFactorY),o.e=T,o.f=S):(o.e-=i.scrollX*t.scrollFactorX,o.f-=i.scrollY*t.scrollFactorY),a.multiply(o),i.renderRoundPixels&&(a.e=Math.floor(a.e+.5),a.f=Math.floor(a.f+.5)),r.save(),a.setToContext(r),r.globalCompositeOperation=this.blendModes[t.blendMode],r.globalAlpha=s,r.imageSmoothingEnabled=!e.source.scaleMode,t.mask&&t.mask.preRenderCanvas(this,t,i),c>0&&d>0){var E=c/p,_=d/p;i.roundPixels&&(m=Math.floor(m+.5),y=Math.floor(y+.5),E+=.5,_+=.5),r.drawImage(e.source.image,l,u,c,d,m,y,E,_)}t.mask&&t.mask.postRenderCanvas(this,t,i),r.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});return ES=c}function wW(){if(AS)return CS;AS=1;var t=Kh(),e=vW(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){void 0===s&&(s=1),void 0===r&&(r=0),void 0===a&&(a=!0),void 0===o&&(o=!1),void 0===h&&(h=!0),void 0===l&&(l=!0),this.renderer=t,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=s,this.minFilter=r,this.autoClear=a,this.autoResize=!0,this.hasDepthBuffer=h,this.forceClamp=l,this.init(i,n),o?this.renderer.on(e.RESIZE,this.resize,this):this.autoResize=!1},init:function(t,e){var i=this.renderer;this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(e.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(e.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){if(this.autoResize&&this.willResize(t,e)){var i=this.renderer;i.deleteFramebuffer(this.framebuffer),i.deleteTexture(this.texture),this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e}return this},willResize:function(t,e){return"number"==typeof t&&"number"==typeof e&&(t=Math.round(t*this.scale),e=Math.round(e*this.scale),t=Math.max(t,1),e=Math.max(e,1),t!==this.width||e!==this.height)},bind:function(t,e,i){void 0===t&&(t=!1);var n=this.renderer;if(t&&n.flush(),e&&i&&this.resize(e,i),n.pushFramebuffer(this.framebuffer,!1,!1),t&&this.adjustViewport(),this.autoClear){var s=this.renderer.gl;s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)}n.clearStencilMask()},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(t,e,i,n){var s=this.renderer,r=s.gl;s.pushFramebuffer(this.framebuffer),void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?(r.enable(r.SCISSOR_TEST),r.scissor(t,e,i,n)):r.disable(r.SCISSOR_TEST),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),s.popFramebuffer(),s.resetScissor()},unbind:function(t){void 0===t&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.off(e.RESIZE,this.resize,this),t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});return CS=i}function bW(){return MS?PS:(MS=1,PS=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join("\n"))}function TW(){return LS?RS:(LS=1,RS=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join("\n"))}function SW(){if(FS)return OS;FS=1;return OS={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}}}function EW(){return KS?qS:(KS=1,qS={AFTER_FLUSH:IS?DS:(IS=1,DS="pipelineafterflush"),BEFORE_FLUSH:BS?kS:(BS=1,kS="pipelinebeforeflush"),BIND:zS?NS:(zS=1,NS="pipelinebind"),BOOT:YS?US:(YS=1,US="pipelineboot"),DESTROY:GS?XS:(GS=1,XS="pipelinedestroy"),REBIND:HS?WS:(HS=1,WS="pipelinerebind"),RESIZE:jS?VS:(jS=1,VS="pipelineresize")})}function _W(){return JS||(JS=1,ZS={getTintFromFloats:function(t,e,i,n){return((255*n&255)<<24|(255*t&255)<<16|(255*e&255)<<8|255*i&255)>>>0},getTintAppendFloatAlpha:function(t,e){return((255*e&255)<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255*e&255)<<24|(255&t)<<16|(t>>8&255)<<8|t>>16&255)>>>0},getFloatsFromUintRGB:function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},checkShaderMax:function(t,e){var i=Math.min(16,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));return e&&-1!==e?Math.min(i,e):i},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var i="",n=0;n<e;n++)n>0&&(i+="\n\telse "),n<e-1&&(i+="if (outTexId < "+n+".5)"),i+="\n\t{",i+="\n\t\ttexture = texture2D(uMainSampler["+n+"], outTexCoord);",i+="\n\t}";return(t=t.replace(/%count%/gi,e.toString())).replace(/%forloop%/gi,i)},setGlowQuality:function(t,e,i,n){return void 0===i&&(i=e.config.glowFXQuality),void 0===n&&(n=e.config.glowFXDistance),t=(t=t.replace(/__SIZE__/gi,(1/i/n).toFixed(7))).replace(/__DIST__/gi,n.toFixed(0)+".0")}}),ZS}function CW(){if(QS)return $S;QS=1;var t=Kh(),e=Rl(),i=jh(),n=SW(),s=new t({initialize:function(t,e,i,n,s){this.pipeline=t,this.name=e,this.renderer=t.renderer,this.gl=this.renderer.gl,this.fragSrc=n,this.vertSrc=i,this.program=this.renderer.createProgram(i,n),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(s),this.createUniforms()},createAttributes:function(t){var e=0,s=0,r=[];this.vertexComponentCount=0;for(var a=0;a<t.length;a++){var o=t[a],h=o.name,l=i(o,"size",1),u=i(o,"type",n.FLOAT),c=u.enum,d=u.size,f=!!o.normalized;r.push({name:h,size:l,type:c,normalized:f,offset:s,enabled:!1,location:-1}),4===d?e+=l:e++,s+=l*d}this.vertexSize=s,this.vertexComponentCount=e,this.attributes=r},bind:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){void 0===t&&(t=!1);for(var e=this.gl,i=this.renderer,n=this.vertexSize,s=this.attributes,r=this.program,a=0;a<s.length;a++){var o=s[a],h=o.size,l=o.type,u=o.offset,c=o.enabled,d=o.location,f=!!o.normalized;if(t){-1!==d&&i.deleteAttribLocation(d);var p=this.renderer.createAttribLocation(r,o.name);p.webGLAttribLocation>=0?(e.enableVertexAttribArray(p.webGLAttribLocation),e.vertexAttribPointer(p.webGLAttribLocation,h,l,f,n,u),o.enabled=!0,o.location=p):-1!==p.webGLAttribLocation&&e.disableVertexAttribArray(p.webGLAttribLocation)}else c?e.vertexAttribPointer(d.webGLAttribLocation,h,l,f,n,u):!c&&-1!==d&&d.webGLAttribLocation>-1&&(e.disableVertexAttribArray(d.webGLAttribLocation),o.location=-1)}return this},createUniforms:function(){var t,e,i,n=this.gl,s=this.program,r=this.uniforms,a=n.getProgramParameter(s.webGLProgram,n.ACTIVE_UNIFORMS);for(t=0;t<a;t++){var o=n.getActiveUniform(s.webGLProgram,t);if(o){e=o.name,null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null});var h=e.indexOf("[");h>0&&(e=e.substr(0,h),r.hasOwnProperty(e)||null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null}))}}return this},syncUniforms:function(){var t=this.gl;for(var e in this.renderer.setProgram(this.program),this.uniforms){var i=this.uniforms[e];i.setter&&i.setter.call(t,i.location.webGLUniformLocation,i.value1,i.value2,i.value3,i.value4)}},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,i,n){var s=this.uniforms[e];return s?((n||s.value1!==i)&&(s.setter||(s.setter=t),s.value1=i,this.renderer.setProgram(this.program),t.call(this.gl,s.location.webGLUniformLocation,i),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,i,n,s){var r=this.uniforms[e];return r?((s||r.value1!==i||r.value2!==n)&&(r.setter||(r.setter=t),r.value1=i,r.value2=n,this.renderer.setProgram(this.program),t.call(this.gl,r.location.webGLUniformLocation,i,n),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,i,n,s,r){var a=this.uniforms[e];return a?((r||a.value1!==i||a.value2!==n||a.value3!==s)&&(a.setter||(a.setter=t),a.value1=i,a.value2=n,a.value3=s,this.renderer.setProgram(this.program),t.call(this.gl,a.location.webGLUniformLocation,i,n,s),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,i,n,s,r,a){var o=this.uniforms[e];return o?((a||o.value1!==i||o.value2!==n||o.value3!==s||o.value4!==r)&&(o.setter||(o.setter=t),o.value1=i,o.value2=n,o.value3=s,o.value4=r,this.renderer.setProgram(this.program),t.call(this.gl,o.location.webGLUniformLocation,i,n,s,r),this.pipeline.currentShader=this),this):this},setBoolean:function(t,e){return this.setUniform1(this.gl.uniform1i,t,Number(e))},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,i){return this.setUniform2(this.gl.uniform2f,t,e,i)},set3f:function(t,e,i,n){return this.setUniform3(this.gl.uniform3f,t,e,i,n)},set4f:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4f,t,e,i,n,s)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e,!0)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e,!0)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e,!0)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e,!0)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e,!0)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e,!0)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e,!0)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e,!0)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,i){return this.setUniform2(this.gl.uniform2i,t,e,i)},set3i:function(t,e,i,n){return this.setUniform3(this.gl.uniform3i,t,e,i,n)},set4i:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4i,t,e,i,n,s)},setMatrix2fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,i,!0)},setMatrix3fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,i,!0)},setMatrix4fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,i,!0)},createProgram:function(t,e){return void 0===t&&(t=this.vertSrc),void 0===e&&(e=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=t,this.fragSrc=e,this.program=this.renderer.createProgram(t,e),this.createUniforms(),this.rebind()},destroy:function(){var t=this.renderer;e(this.uniforms,function(e){t.deleteUniformLocation(e.location)}),this.uniforms=null,e(this.attributes,function(e){t.deleteAttribLocation(e.location)}),this.attributes=null,t.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});return $S=s}function AW(){if(eE)return tE;eE=1;var t=Kh(),e=uc(),i=cU(),n=EW(),s=jh(),r=UG(),a=vW(),o=wW(),h=_W(),l=CW(),u=new t({Extends:i,initialize:function(t){i.call(this);var e=t.game,n=e.renderer,r=n.gl;this.name=s(t,"name","WebGLPipeline"),this.game=e,this.renderer=n,this.manager,this.gl=r,this.view=e.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=s(t,"topology",r.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=s(t,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=t,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=s(t,"resizeUniform","")},boot:function(){var t,e=this.gl,i=this.config,h=this.renderer;this.isPostFX||(this.projectionMatrix=(new r).identity());var l=this.renderTargets,u=s(i,"renderTarget",!1);"boolean"==typeof u&&u&&(u=1);var c=h.width,d=h.height;if("number"==typeof u)for(t=0;t<u;t++)l.push(new o(h,c,d,1,0,!0));else if(Array.isArray(u))for(t=0;t<u.length;t++){var f=s(u[t],"scale",1),p=s(u[t],"minFilter",0),g=s(u[t],"autoClear",1),v=s(u[t],"autoResize",!1),m=s(u[t],"width",null),y=s(u[t],"height",m);m?l.push(new o(h,m,y,1,p,g,v)):l.push(new o(h,c,d,f,p,g,v))}l.length&&(this.currentRenderTarget=l[0]),this.setShadersFromConfig(i);var x=this.shaders,w=0;for(t=0;t<x.length;t++)x[t].vertexSize>w&&(w=x[t].vertexSize);var b=s(i,"batchSize",h.config.batchSize);this.vertexCapacity=6*b;var T=new ArrayBuffer(this.vertexCapacity*w);this.vertexData=T,this.bytes=new Uint8Array(T),this.vertexViewF32=new Float32Array(T),this.vertexViewU32=new Uint32Array(T);var S=s(i,"vertices",null);for(S?(this.vertexViewF32.set(S),this.vertexBuffer=h.createVertexBuffer(T,e.STATIC_DRAW)):this.vertexBuffer=h.createVertexBuffer(T.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=x.length-1;t>=0;t--)x[t].rebind();this.hasBooted=!0,h.on(a.RESIZE,this.resize,this),h.on(a.PRE_RENDER,this.onPreRender,this),h.on(a.RENDER,this.onRender,this),h.on(a.POST_RENDER,this.onPostRender,this),this.emit(n.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e,i){var n=this.renderer;t===this.currentShader&&n.currentProgram===this.currentShader.program||(this.flush(),this.setVertexBuffer(i)&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t);return this},getShaderByName:function(t){for(var e=this.shaders,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},setShadersFromConfig:function(t){var i,n=this.shaders,r=this.renderer;for(i=0;i<n.length;i++)n[i].destroy();var a="vertShader",o="fragShader",u="attributes",c=s(t,a,null),d=h.parseFragmentShaderMaxTextures(s(t,o,null),r.maxTextures),f=s(t,u,null),p=s(t,"shaders",[]),g=p.length;if(0===g)c&&d&&(this.shaders=[new l(this,"default",c,d,e(f))]);else{var v=[];for(i=0;i<g;i++){var m,y,x,w,b=p[i];if("string"==typeof b?(m="default",y=c,x=h.parseFragmentShaderMaxTextures(b,r.maxTextures),w=f):(m=s(b,"name","default"),y=s(b,a,c),x=h.parseFragmentShaderMaxTextures(s(b,o,d),r.maxTextures),w=s(b,u,f)),"default"===m){var T=x.split("\n")[0].trim();T.indexOf("#define SHADER_NAME")>-1&&(m=T.substring(20))}y&&x&&v.push(new l(this,m,y,x,e(w)))}this.shaders=v}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},createBatch:function(t){return this.currentBatch={start:this.vertexCount,count:0,texture:[t],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=t,this.batch.push(this.currentBatch),0},addTextureToBatch:function(t){var e=this.currentBatch;e&&(e.texture.push(t),e.unit++,e.maxUnit++)},pushBatch:function(t){if(!this.currentBatch||this.forceZero&&t!==this.currentTexture)return this.createBatch(t);if(t===this.currentTexture)return this.currentUnit;var e=this.currentBatch,i=e.texture.indexOf(t);return-1===i?e.texture.length===this.renderer.maxTextures?this.createBatch(t):(e.unit++,e.maxUnit++,e.texture.push(t),this.currentUnit=e.unit,this.currentTexture=t,e.unit):(this.currentUnit=i,this.currentTexture=t,i)},setGameObject:function(t,e){return void 0===e&&(e=t.frame),this.pushBatch(e.source.glTexture)},shouldFlush:function(t){return void 0===t&&(t=0),this.vertexCount+t>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(t,e){t===this.width&&e===this.height||this.flush(),this.width=t,this.height=e;for(var i=this.renderTargets,s=0;s<i.length;s++)i[s].resize(t,e);return this.setProjectionMatrix(t,e),this.resizeUniform&&this.set2f(this.resizeUniform,t,e),this.emit(n.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var i=this.projectionMatrix;if(!i)return this;this.projectionWidth=t,this.projectionHeight=e,i.ortho(0,t,e,0,-1e3,1e3);for(var n=this.shaders,s="uProjectionMatrix",r=0;r<n.length;r++){var a=n[r];a.hasUniform(s)&&(a.resetUniform(s),a.setMatrix4fv(s,!1,i.val,a))}return this},flipProjectionMatrix:function(t){void 0===t&&(t=!0);var e=this.projectionMatrix;if(!e)return this;var i=this.projectionWidth,n=this.projectionHeight;t?e.ortho(0,i,0,n,-1e3,1e3):e.ortho(0,i,n,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,e.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;this.projectionWidth===t&&this.projectionHeight===e||this.setProjectionMatrix(t,e)}},bind:function(t){if(void 0===t&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=!1,i=this.gl;return i.getParameter(i.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,e=!0),t.bind(e),this.currentShader=t,this.activeTextures.length=0,this.emit(n.BIND,this,t),this.onActive(t),this},rebind:function(t){this.activeBuffer=null,this.setVertexBuffer();for(var e=this.shaders,i=e.length-1;i>=0;i--){var s=e[i].rebind();t&&s!==t||(this.currentShader=s)}return this.activeTextures.length=0,this.emit(n.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var t=this.shaders,e=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,e&&this.setVertexBuffer();for(var i=0;i<t.length;i++){var n=t[i];n.syncUniforms(),e&&n.rebind()}},setVertexBuffer:function(t){if(void 0===t&&(t=this.vertexBuffer),t!==this.activeBuffer){var e=this.gl;return this.gl.bindBuffer(e.ARRAY_BUFFER,t.webGLBuffer),this.activeBuffer=t,!0}return!1},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(void 0===t&&(t=!1),this.vertexCount>0){this.emit(n.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,i=this.vertexCount,s=this.currentShader.vertexSize,r=this.topology;if(this.active){var a,o,h;this.setVertexBuffer(),i===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,i*s));var l=this.batch,u=this.activeTextures;if(this.forceZero)for(u[0]||e.activeTexture(e.TEXTURE0),a=0;a<l.length;a++)h=(o=l[a]).texture[0],u[0]!==h&&(e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[0]=h),e.drawArrays(r,o.start,o.count);else for(a=0;a<l.length;a++){o=l[a];for(var c=0;c<=o.maxUnit;c++)h=o.texture[c],u[c]!==h&&(e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[c]=h);e.drawArrays(r,o.start,o.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(n.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,i,n,s,r,a){var o=this.vertexViewF32,h=this.vertexViewU32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;o[++l]=t,o[++l]=e,o[++l]=i,o[++l]=n,o[++l]=s,o[++l]=r,h[++l]=a,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x){void 0===x&&(x=this.currentUnit);var w=!1;this.shouldFlush(6)&&(this.flush(),w=!0),this.currentBatch||(x=this.setTexture2D(y));var b=this.vertexViewF32,T=this.vertexViewU32,S=this.vertexCount*this.currentShader.vertexComponentCount-1;return b[++S]=e,b[++S]=i,b[++S]=l,b[++S]=u,b[++S]=x,b[++S]=m,T[++S]=f,b[++S]=n,b[++S]=s,b[++S]=l,b[++S]=d,b[++S]=x,b[++S]=m,T[++S]=g,b[++S]=r,b[++S]=a,b[++S]=c,b[++S]=d,b[++S]=x,b[++S]=m,T[++S]=v,b[++S]=e,b[++S]=i,b[++S]=l,b[++S]=u,b[++S]=x,b[++S]=m,T[++S]=f,b[++S]=r,b[++S]=a,b[++S]=c,b[++S]=d,b[++S]=x,b[++S]=m,T[++S]=v,b[++S]=o,b[++S]=h,b[++S]=c,b[++S]=u,b[++S]=x,b[++S]=m,T[++S]=p,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),w},batchTri:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v){void 0===v&&(v=this.currentUnit);var m=!1;this.shouldFlush(3)&&(this.flush(),m=!0),this.currentBatch||(v=this.setTexture2D(g));var y=this.vertexViewF32,x=this.vertexViewU32,w=this.vertexCount*this.currentShader.vertexComponentCount-1;return y[++w]=e,y[++w]=i,y[++w]=o,y[++w]=h,y[++w]=v,y[++w]=p,x[++w]=c,y[++w]=n,y[++w]=s,y[++w]=o,y[++w]=u,y[++w]=v,y[++w]=p,x[++w]=d,y[++w]=r,y[++w]=a,y[++w]=l,y[++w]=u,y[++w]=v,y[++w]=p,x[++w]=f,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),m},drawFillRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=this.renderer.whiteTexture),void 0===o&&(o=!0),t=Math.floor(t),e=Math.floor(e);var l=Math.floor(t+i),u=Math.floor(e+n),c=this.setTexture2D(a),d=h.getTintAppendFloatAlphaAndSwap(s,r),f=0,p=1;o&&(f=1,p=0),this.batchQuad(null,t,e,t,u,l,u,l,e,0,f,1,p,d,d,d,d,0,a,c)},setTexture2D:function(t){return void 0===t&&(t=this.renderer.whiteTexture),this.pushBatch(t)},bindTexture:function(t,e){void 0===e&&(e=0);var i=this.gl;return i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,t.webGLTexture),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t,e){return this.set1f(t,this.game.loop.getDuration(),e),this},setBoolean:function(t,e,i){return void 0===i&&(i=this.currentShader),i.setBoolean(t,e),this},set1f:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1f(t,e),this},set2f:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2f(t,e,i),this},set3f:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3f(t,e,i,n),this},set4f:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4f(t,e,i,n,s),this},set1fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1fv(t,e),this},set2fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2fv(t,e),this},set3fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3fv(t,e),this},set4fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4fv(t,e),this},set1iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1iv(t,e),this},set2iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2iv(t,e),this},set3iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3iv(t,e),this},set4iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4iv(t,e),this},set1i:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1i(t,e),this},set2i:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2i(t,e,i),this},set3i:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3i(t,e,i,n),this},set4i:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4i(t,e,i,n,s),this},setMatrix2fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix2fv(t,e,i),this},setMatrix3fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix3fv(t,e,i),this},setMatrix4fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix4fv(t,e,i),this},destroy:function(){var t;this.emit(n.DESTROY,this);var e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var i=this.renderTargets;for(t=0;t<i.length;t++)i[t].destroy();var s=this.renderer;return s.deleteBuffer(this.vertexBuffer),s.off(a.RESIZE,this.resize,this),s.off(a.PRE_RENDER,this.onPreRender,this),s.off(a.RENDER,this.onRender,this),s.off(a.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});return tE=u}function PW(){if(nE)return iE;nE=1;var t=Kh(),e=jh(),i=bW(),n=TW(),s=SW(),r=AW(),a=new t({Extends:r,initialize:function(t){t.fragShader=e(t,"fragShader",i),t.vertShader=e(t,"vertShader",n),t.batchSize=e(t,"batchSize",1),t.vertices=e(t,"vertices",[-1,1,-1,-7,7,1]),t.attributes=e(t,"attributes",[{name:"inPosition",size:2,type:s.FLOAT}]),r.call(this,t)},boot:function(){r.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){r.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,i){this.renderer.beginBitmapMask(t,i)},endMask:function(t,e,i){var n=this.gl,s=this.renderer,r=t.bitmapMask;r&&n&&(s.drawBitmapMask(r,e,this),i&&this.set2f("uResolution",i.width,i.height),this.set1i("uInvertMaskAlpha",t.invertAlpha),n.drawArrays(this.topology,0,3),i&&this.set2f("uResolution",this.width,this.height),n.bindTexture(n.TEXTURE_2D,null))}});return iE=a}function MW(){return rE?sE:(rE=1,sE=["#define SHADER_NAME BARREL_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float amount;","varying vec2 outTexCoord;","vec2 Distort(vec2 p)","{","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, amount);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * (p + 1.0);","}","void main()","{","    vec2 xy = 2.0 * outTexCoord - 1.0;","    vec2 texCoord = outTexCoord;","    if (length(xy) < 1.0)","    {","        texCoord = Distort(xy);","    }","    gl_FragColor = texture2D(uMainSampler, texCoord);","}"].join("\n"))}function RW(){return oE?aE:(oE=1,aE=["#define SHADER_NAME PHASER_POSTFX_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}"].join("\n"))}function LW(){return lE?hE:(lE=1,hE=["#define SHADER_NAME PHASER_QUAD_VS","precision mediump float;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","varying vec2 outFragCoord;","varying vec2 outTexCoord;","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","    gl_Position = vec4(inPosition, 0, 1);","}"].join("\n"))}function OW(){if(cE)return uE;cE=1;var t=Kh(),e=Au(),i=jh(),n=RW(),s=LW(),r=AW(),a=new t({Extends:r,initialize:function(t){t.renderTarget=i(t,"renderTarget",1),t.fragShader=i(t,"fragShader",n),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.batchSize=1,t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],r.call(this,t),this.isPostFX=!0,this.gameObject,this.controller,this.colorMatrix=new e,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines)},bootFX:function(){r.prototype.boot.call(this);var t=this.manager.UTILITY_PIPELINE;this.fullFrame1=t.fullFrame1,this.fullFrame2=t.fullFrame2,this.halfFrame1=t.halfFrame1,this.halfFrame2=t.halfFrame2;var e=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",e.width,e.height);for(var i=this.renderTargets,n=0;n<i.length;n++)i[n].autoResize=!0},postBatch:function(t){return this.hasBooted||(this.bootFX(),this.currentRenderTarget&&this.currentRenderTarget.bind()),this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(t){this.bindAndDraw(t)},getController:function(t){return void 0!==t?t:this.controller?this.controller:this},copySprite:function(t,e,i){void 0===i&&(i=!1);var n=this.gl;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.texture.webGLTexture);var s=n.getParameter(n.FRAMEBUFFER_BINDING);n.bindFramebuffer(n.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.texture.webGLTexture,0),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.bufferData(n.ARRAY_BUFFER,this.vertexData,n.STATIC_DRAW),n.drawArrays(n.TRIANGLES,0,6),i&&(n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,s))},copyFrame:function(t,e,i,n,s){this.manager.copyFrame(t,e,i,n,s)},copyToGame:function(t){this.manager.copyToGame(t)},drawFrame:function(t,e,i){this.manager.drawFrame(t,e,i,this.colorMatrix)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},clearFrame:function(t,e){this.manager.clearFrame(t,e)},blitFrame:function(t,e,i,n,s,r){this.manager.blitFrame(t,e,i,n,s,r)},copyFrameRect:function(t,e,i,n,s,r,a,o){this.manager.copyFrameRect(t,e,i,n,s,r,a,o)},bindAndDraw:function(t,e,i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);var r=this.gl,a=this.renderer;this.bind(s),this.set1i("uMainSampler",0),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0),i&&(n?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT))):(a.popFramebuffer(!1,!1),a.currentFramebuffer||r.viewport(0,0,a.width,a.height)),a.restoreStencilMask(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),e&&(r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,a.currentFramebuffer.webGLFramebuffer))},destroy:function(){return this.controller&&this.controller.destroy(),this.gameObject=null,this.controller=null,this.colorMatrix=null,this.fullFrame1=null,this.fullFrame2=null,this.halfFrame1=null,this.halfFrame2=null,this.manager.removePostPipeline(this),r.prototype.destroy.call(this),this}});return uE=a}function FW(){if(fE)return dE;fE=1;var t=Kh(),e=MW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e){t=this.getController(t),this.set1f("amount",t.amount,e)}});return dE=n}function DW(){return gE?pE:(gE=1,pE=["#define SHADER_NAME BLOOM_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;","    gl_FragColor = (sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913) * vec4(color, 1);","}"].join("\n"))}function IW(){if(mE)return vE;mE=1;var t=Kh(),e=DW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.steps=4,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.strength=1,this.glcolor=[1,1,1]},onPreRender:function(t){t=this.getController(t),this.set1f("strength",t.blurStrength),this.set3fv("color",t.glcolor)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1,n=this.fullFrame2;this.copyFrame(t,n);for(var s=2/t.width*e.offsetX,r=2/t.height*e.offsetY,a=0;a<e.steps;a++)this.set2f("offset",s,0),this.copySprite(t,i),this.set2f("offset",0,r),this.copySprite(i,t);this.blendFrames(n,t,i,e.strength),this.copyToGame(i)}});return vE=n}function kW(){return xE?yE:(xE=1,yE=["#define SHADER_NAME BLUR_LOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 offset = vec2(1.333) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.29411764705882354;","    col += texture2D(uMainSampler, uv + (offset / resolution)) * 0.35294117647058826;","    col += texture2D(uMainSampler, uv - (offset / resolution)) * 0.35294117647058826;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function BW(){return bE?wE:(bE=1,wE=["#define SHADER_NAME BLUR_MED_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.3846153846) * offset * strength;","    vec2 off2 = vec2(3.2307692308) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.2270270270;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.0702702703;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.0702702703;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function NW(){return SE?TE:(SE=1,TE=["#define SHADER_NAME BLUR_HIGH_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.411764705882353) * offset * strength;","    vec2 off2 = vec2(3.2941176470588234) * offset * strength;","    vec2 off3 = vec2(5.176470588235294) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.1964825501511404;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv + (off3 / resolution)) * 0.010381362401148057;","    col += texture2D(uMainSampler, uv - (off3 / resolution)) * 0.010381362401148057;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function zW(){if(_E)return EE;_E=1;var t=Kh(),e=kW(),i=BW(),n=NW(),s=OW(),r=new t({Extends:s,initialize:function(t){s.call(this,{game:t,shaders:[{name:"Gaussian5",fragShader:e},{name:"Gaussian9",fragShader:i},{name:"Gaussian13",fragShader:n}]}),this.activeShader=this.shaders[0],this.x=2,this.y=2,this.steps=4,this.strength=1,this.glcolor=[1,1,1]},setQualityLow:function(){return this.activeShader=this.shaders[0],this},setQualityMedium:function(){return this.activeShader=this.shaders[1],this},setQualityHigh:function(){return this.activeShader=this.shaders[2],this},onDraw:function(t){var e=this.getController(),i=this.gl,n=this.fullFrame1,s=i.getParameter(i.FRAMEBUFFER_BINDING);this.bind(this.shaders[e.quality]),i.activeTexture(i.TEXTURE0),i.viewport(0,0,t.width,t.height),this.set1i("uMainSampler",0),this.set2f("resolution",t.width,t.height),this.set1f("strength",e.strength),this.set3fv("color",e.glcolor);for(var r=0;r<e.steps;r++)this.set2f("offset",e.x,0),this.copySprite(t,n),this.set2f("offset",0,e.y),this.copySprite(n,t);i.bindFramebuffer(i.FRAMEBUFFER,s),i.bindTexture(i.TEXTURE_2D,null),this.copyToGame(t)}});return EE=r}function UW(){return AE?CE:(AE=1,CE=["#define SHADER_NAME BOKEH_FS","precision mediump float;","#define ITERATIONS 100.0","#define ONEOVER_ITR 1.0 / ITERATIONS","#define PI 3.141596","#define GOLDEN_ANGLE 2.39996323","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float radius;","uniform float amount;","uniform float contrast;","uniform bool isTiltShift;","uniform float strength;","uniform vec2 blur;","varying vec2 outTexCoord;","vec2 Sample (in float theta, inout float r)","{","    r += 1.0 / r;","    return (r - 1.0) * vec2(cos(theta), sin(theta)) * 0.06;","}","vec3 Bokeh (sampler2D tex, vec2 uv, float radius)","{","    vec3 acc = vec3(0.0);","    vec3 div = vec3(0.0);","    vec2 pixel = vec2(resolution.y / resolution.x, 1.0) * radius * .025;","    float r = 1.0;","    for (float j = 0.0; j < GOLDEN_ANGLE * ITERATIONS; j += GOLDEN_ANGLE)","    {","        vec3 col = texture2D(tex, uv + pixel * Sample(j, r)).xyz;","        col = contrast > 0.0 ? col * col * (1.0 + contrast) : col;","        vec3 bokeh = vec3(0.5) + pow(col, vec3(10.0)) * amount;","        acc += col * bokeh;","        div += bokeh;","    }","    return acc / div;","}","void main ()","{","    float shift = 1.0;","    if (isTiltShift)","    {","        vec2 uv = vec2(gl_FragCoord.xy / resolution + vec2(-0.5, -0.5)) * 2.0;","        float centerStrength = 1.0;","        shift = length(uv * blur * strength) * centerStrength;","    }","    gl_FragColor = vec4(Bokeh(uMainSampler, outTexCoord * vec2(1.0, 1.0), radius * shift), 0.0);","}"].join("\n"))}function YW(){if(ME)return PE;ME=1;var t=Kh(),e=UW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.isTiltShift=!1,this.strength=1,this.blurX=1,this.blurY=1,this.radius=.5,this.amount=1,this.contrast=.2},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("amount",t.amount,e),this.set1f("contrast",t.contrast,e),this.set1f("strength",t.strength,e),this.set2f("blur",t.blurX,t.blurY,e),this.setBoolean("isTiltShift",t.isTiltShift,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return PE=n}function XW(){return LE?RE:(LE=1,RE=["#define SHADER_NAME CIRCLE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec3 color;","uniform vec4 backgroundColor;","uniform float thickness;","uniform float scale;","uniform float feather;","varying vec2 outTexCoord;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 position = (gl_FragCoord.xy / resolution.xy) * 2.0 - 1.0;","    float aspectRatio = resolution.x / resolution.y;","    position.x *= aspectRatio;","    float grad = length(position);","    float outer = aspectRatio;","    float inner = outer - (thickness * 2.0 / resolution.y);","    if (aspectRatio >= 1.0)","    {","        float f = 2.0 + (resolution.y / resolution.x);","        outer = 1.0;","        inner = 1.0 - (thickness * f / resolution.x);","    }","    outer *= scale;","    inner *= scale;","    float circle = smoothstep(outer, outer - 0.01, grad);","    float ring = circle - smoothstep(inner, inner - feather, grad);","    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);","    texture = (texture * (circle - ring));","    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);","}"].join("\n"))}function GW(){if(FE)return OE;FE=1;var t=Kh(),e=XW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.scale=1,this.feather=.005,this.thickness=8,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("scale",t.scale,e),this.set1f("feather",t.feather,e),this.set1f("thickness",t.thickness,e),this.set3fv("color",t.glcolor,e),this.set4fv("backgroundColor",t.glcolor2,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return OE=n}function WW(){if(IE)return DE;IE=1;var t=Kh(),e=OW(),i=new t({Extends:e,initialize:function(t){e.call(this,{game:t})},onDraw:function(t){var e=this.fullFrame1;this.controller?this.manager.drawFrame(t,e,!0,this.controller):this.drawFrame(t,e),this.copyToGame(e)}});return DE=i}function HW(){return BE?kE:(BE=1,kE=["#define SHADER_NAME DISPLACEMENT_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform sampler2D uDisplacementSampler;","uniform vec2 amount;","varying vec2 outTexCoord;","void main ()","{","    vec2 disp = (-vec2(0.5, 0.5) + texture2D(uDisplacementSampler, outTexCoord).rr) * amount;","    gl_FragColor = texture2D(uMainSampler, outTexCoord + disp).rgba;","}"].join("\n"))}function VW(){if(zE)return NE;zE=1;var t=Kh(),e=HW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.005,this.y=.005,this.glTexture},onBoot:function(){this.setTexture("__WHITE")},setTexture:function(t){var e=this.game.textures.getFrame(t);e&&(this.glTexture=e.glTexture)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1;this.bind(),this.set1i("uMainSampler",0),this.set1i("uDisplacementSampler",1),this.set2f("amount",e.x,e.y),this.bindTexture(e.glTexture,1),this.copySprite(t,i),this.copyToGame(i)}});return NE=n}function jW(){return YE?UE:(YE=1,UE=["#define SHADER_NAME GLOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform float outerStrength;","uniform float innerStrength;","uniform vec2 resolution;","uniform vec4 glowColor;","uniform bool knockout;","const float PI = 3.14159265358979323846264;","const float DIST = __DIST__;","const float SIZE = min(__SIZE__, PI * 2.0);","const float STEP = ceil(PI * 2.0 / SIZE);","const float MAX_ALPHA = STEP * DIST * (DIST + 1.0) / 2.0;","void main ()","{","    vec2 px = vec2(1.0 / resolution.x, 1.0 / resolution.y);","    float totalAlpha = 0.0;","    vec2 direction;","    vec2 displaced;","    vec4 color;","    for (float angle = 0.0; angle < PI * 2.0; angle += SIZE)","    {","        direction = vec2(cos(angle), sin(angle)) * px;","        for (float curDistance = 0.0; curDistance < DIST; curDistance++)","        {","            displaced = outTexCoord + direction * (curDistance + 1.0);","            color = texture2D(uMainSampler, displaced);","            totalAlpha += (DIST - curDistance) * color.a;","        }","    }","    color = texture2D(uMainSampler, outTexCoord);","    float alphaRatio = (totalAlpha / MAX_ALPHA);","    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * color.a;","    float innerGlowStrength = min(1.0, innerGlowAlpha);","    vec4 innerColor = mix(color, glowColor, innerGlowStrength);","    float outerGlowAlpha = alphaRatio * outerStrength * (1.0 - color.a);","    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);","    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;","    if (knockout)","    {","        float resultAlpha = outerGlowAlpha + innerGlowAlpha;","        gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);","    }","    else","    {","        gl_FragColor = innerColor + outerGlowColor;","    }","}"].join("\n"))}function qW(){if(GE)return XE;GE=1;var t=Kh(),e=jh(),i=jW(),n=OW(),s=_W(),r=new t({Extends:n,initialize:function(t,r){var a=e(r,"quality",.1),o=e(r,"distance",10);n.call(this,{game:t,fragShader:s.setGlowQuality(i,t,a,o)}),this.outerStrength=4,this.innerStrength=0,this.knockout=!1,this.glcolor=[1,1,1,1]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("outerStrength",t.outerStrength,e),this.set1f("innerStrength",t.innerStrength,e),this.set4fv("glowColor",t.glcolor,e),this.setBoolean("knockout",t.knockout,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return XE=r}function KW(){return HE?WE:(HE=1,WE=["#define SHADER_NAME GRADIENT_FS","#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))","#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))","#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 positionFrom;","uniform vec2 positionTo;","uniform vec3 color1;","uniform vec3 color2;","uniform float alpha;","uniform int size;","varying vec2 outTexCoord;","float gradientNoise(in vec2 uv)","{","    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(magic.z * fract(dot(uv, magic.xy)));","}","float stepped (in float s, in float scale, in int steps)","{","    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;","}","void main ()","{","    vec2 a = positionFrom;","    vec2 b = positionTo;","    vec2 ba = b - a;","    float d = dot(outTexCoord - a, ba) / dot(ba, ba);","    float t = size > 0 ? stepped(d, 1.0, size) : d;","    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));","    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);","    color = LINEAR_TO_SRGB(color);","    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;","}"].join("\n"))}function ZW(){if(jE)return VE;jE=1;var t=Kh(),e=KW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.alpha=.2,this.size=0,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0]},onPreRender:function(t,e){t=this.getController(t),this.set1f("alpha",t.alpha,e),this.set1i("size",t.size,e),this.set3fv("color1",t.glcolor1,e),this.set3fv("color2",t.glcolor2,e),this.set2f("positionFrom",t.fromX,t.fromY,e),this.set2f("positionTo",t.toX,t.toY,e)}});return VE=n}function JW(){return KE?qE:(KE=1,qE=["#define SHADER_NAME PIXELATE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float amount;","varying vec2 outTexCoord;","void main ()","{","    float pixelSize = floor(2.0 + amount);","    vec2 center = pixelSize * floor(outTexCoord * resolution / pixelSize) + pixelSize * vec2(0.5, 0.5);","    vec2 corner1 = center + pixelSize * vec2(-0.5, -0.5);","    vec2 corner2 = center + pixelSize * vec2(+0.5, -0.5);","    vec2 corner3 = center + pixelSize * vec2(+0.5, +0.5);","    vec2 corner4 = center + pixelSize * vec2(-0.5, +0.5);","    vec4 pixel = 0.4 * texture2D(uMainSampler, center / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner1 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner2 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner3 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner4 / resolution);","    gl_FragColor = pixel;","}"].join("\n"))}function $W(){if(JE)return ZE;JE=1;var t=Kh(),e=JW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("amount",t.amount,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return ZE=n}function QW(){return QE?$E:(QE=1,$E=["#define SHADER_NAME SHADOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform vec2 lightPosition;","uniform vec4 color;","uniform float decay;","uniform float power;","uniform float intensity;","uniform int samples;","const int MAX = 12;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 pc = (lightPosition - outTexCoord) * intensity;","    float shadow = 0.0;","    float limit = max(float(MAX), float(samples));","    for (int i = 0; i < MAX; ++i)","    {","        if (i >= samples)","        {","            break;","        }","        shadow += texture2D(uMainSampler, outTexCoord + float(i) * decay / limit * pc).a * power;","    }","    float mask = 1.0 - texture.a;","    gl_FragColor = mix(texture, color, shadow * mask);","}"].join("\n"))}function tH(){if(e_)return t_;e_=1;var t=Kh(),e=QW(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=0,this.y=0,this.decay=.1,this.power=1,this.glcolor=[0,0,0,1],this.samples=6,this.intensity=1},onPreRender:function(t,e){var i=(t=this.getController(t)).samples;this.set1i("samples",i,e),this.set1f("intensity",t.intensity,e),this.set1f("decay",t.decay,e),this.set1f("power",t.power/i,e),this.set2f("lightPosition",t.x,t.y,e),this.set4fv("color",t.glcolor,e)}});return t_=n}function eH(){return n_?i_:(n_=1,i_=["#define SHADER_NAME SHINE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform bool reveal;","uniform float speed;","uniform float time;","uniform float lineWidth;","uniform float gradient;","varying vec2 outTexCoord;","void main ()","{","\tvec2 uv = gl_FragCoord.xy / resolution.xy;","    vec4 tex = texture2D(uMainSampler, outTexCoord);","    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);","    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);","    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;","    float y = uv.x * gradient;","    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);","    gl_FragColor = (((s * col1) + (s * col2)) * tex);","    if (!reveal)","    {","        gl_FragColor += tex;","    }","}"].join("\n"))}function iH(){if(r_)return s_;r_=1;var t=Kh(),e=eH(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1},onPreRender:function(t,e,i,n){t=this.getController(t),this.setTime("time",e),this.set1f("speed",t.speed,e),this.set1f("lineWidth",t.lineWidth,e),this.set1f("gradient",t.gradient,e),this.setBoolean("reveal",t.reveal,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return s_=n}function nH(){return o_?a_:(o_=1,a_=["#define SHADER_NAME VIGNETTE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float radius;","uniform float strength;","uniform vec2 position;","varying vec2 outTexCoord;","void main ()","{","    vec4 col = vec4(1.0);","    float d = length(outTexCoord - position);","    if (d <= radius)","    {","        float g = d / radius;","        g = sin(g * 3.14 * strength);","    \tcol = vec4(g * g * g);","    }","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = texture * (1.0 - col);","}"].join("\n"))}function sH(){if(l_)return h_;l_=1;var t=Kh(),e=nH(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5},onPreRender:function(t,e){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("strength",t.strength,e),this.set2f("position",t.x,t.y,e)}});return h_=n}function rH(){return c_?u_:(c_=1,u_=["#define SHADER_NAME WIPE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec4 config;","uniform bool reveal;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 color0;","    vec4 color1;","    if (reveal)","    {","        color0 = vec4(0);","        color1 = texture2D(uMainSampler, uv);","    }","    else","    {","        color0 = texture2D(uMainSampler, uv);","        color1 = vec4(0);","    }","    float distance = config.x;","    float width = config.y;","    float direction = config.z;","    float axis = uv.x;","    if (config.w == 1.0)","    {","        axis = uv.y;","    }","    float adjust = mix(width, -width, distance);","    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);","    gl_FragColor = mix(color1, color0, value);","}"].join("\n"))}function aH(){if(f_)return d_;f_=1;var t=Kh(),e=rH(),i=OW(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1},onPreRender:function(t,e){var i=(t=this.getController(t)).progress,n=t.wipeWidth,s=t.direction,r=t.axis;this.set4f("config",i,n,s,r,e),this.setBoolean("reveal",t.reveal,e)}});return d_=n}function oH(){if(g_)return p_;g_=1;var t={Barrel:FW(),Bloom:IW(),Blur:zW(),Bokeh:YW(),Circle:GW(),ColorMatrix:WW(),Displacement:VW(),Glow:qW(),Gradient:ZW(),Pixelate:$W(),Shadow:tH(),Shine:iH(),Vignette:sH(),Wipe:aH()};return p_=t}function hH(){return m_?v_:(m_=1,v_=["#define SHADER_NAME PHASER_COLORMATRIX_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","varying vec2 outTexCoord;","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","        return;","    }","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","    vec4 result;","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","    rgb *= result.a;","    gl_FragColor = vec4(rgb, result.a);","}"].join("\n"))}function lH(){if(x_)return y_;function t(t,i,s){s=s||2;var r,a,o,u,c,f,p,g=i&&i.length,v=g?i[0]*s:t.length,m=e(t,0,v,s,!0),y=[];if(!m||m.next===m.prev)return y;if(g&&(m=function(t,i,n,s){var r,a,o,u=[];for(r=0,a=i.length;r<a;r++)(o=e(t,i[r]*s,r<a-1?i[r+1]*s:t.length,s,!1))===o.next&&(o.steiner=!0),u.push(d(o));for(u.sort(h),r=0;r<u.length;r++)n=l(u[r],n);return n}(t,i,m,s)),t.length>80*s){r=o=t[0],a=u=t[1];for(var x=s;x<v;x+=s)(c=t[x])<r&&(r=c),(f=t[x+1])<a&&(a=f),c>o&&(o=c),f>u&&(u=f);p=0!==(p=Math.max(o-r,u-a))?32767/p:0}return n(m,y,s,r,a,p,0),y}function e(t,e,i,n,s){var r,a;if(s===_(t,e,i,n)>0)for(r=e;r<i;r+=n)a=T(r,t[r],t[r+1],a);else for(r=i-n;r>=e;r-=n)a=T(r,t[r],t[r+1],a);return a&&v(a,a.next)&&(S(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!v(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(S(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function n(t,e,h,l,u,d,f){if(t){!f&&d&&function(t,e,i,n){var s=t;do{0===s.z&&(s.z=c(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,function(t){var e,i,n,s,r,a,o,h,l=1;do{for(i=t,t=null,r=null,a=0;i;){for(a++,n=i,o=0,e=0;e<l&&(o++,n=n.nextZ);e++);for(h=l;o>0||h>0&&n;)0!==o&&(0===h||!n||i.z<=n.z)?(s=i,i=i.nextZ,o--):(s=n,n=n.nextZ,h--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(a>1)}(s)}(t,l,u,d);for(var p,g,v=t;t.prev!==t.next;)if(p=t.prev,g=t.next,d?r(t,l,u,d):s(t))e.push(p.i/h|0),e.push(t.i/h|0),e.push(g.i/h|0),S(t),t=g.next,v=g.next;else if((t=g)===v){f?1===f?n(t=a(i(t),e,h),e,h,l,u,d,2):2===f&&o(t,e,h,l,u,d):n(i(t),e,h,l,u,d,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(g(e,i,n)>=0)return!1;for(var s=e.x,r=i.x,a=n.x,o=e.y,h=i.y,l=n.y,u=s<r?s<a?s:a:r<a?r:a,c=o<h?o<l?o:l:h<l?h:l,d=s>r?s>a?s:a:r>a?r:a,p=o>h?o>l?o:l:h>l?h:l,v=n.next;v!==e;){if(v.x>=u&&v.x<=d&&v.y>=c&&v.y<=p&&f(s,o,r,h,a,l,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function r(t,e,i,n){var s=t.prev,r=t,a=t.next;if(g(s,r,a)>=0)return!1;for(var o=s.x,h=r.x,l=a.x,u=s.y,d=r.y,p=a.y,v=o<h?o<l?o:l:h<l?h:l,m=u<d?u<p?u:p:d<p?d:p,y=o>h?o>l?o:l:h>l?h:l,x=u>d?u>p?u:p:d>p?d:p,w=c(v,m,e,i,n),b=c(y,x,e,i,n),T=t.prevZ,S=t.nextZ;T&&T.z>=w&&S&&S.z<=b;){if(T.x>=v&&T.x<=y&&T.y>=m&&T.y<=x&&T!==s&&T!==a&&f(o,u,h,d,l,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;if(T=T.prevZ,S.x>=v&&S.x<=y&&S.y>=m&&S.y<=x&&S!==s&&S!==a&&f(o,u,h,d,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;T&&T.z>=w;){if(T.x>=v&&T.x<=y&&T.y>=m&&T.y<=x&&T!==s&&T!==a&&f(o,u,h,d,l,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;S&&S.z<=b;){if(S.x>=v&&S.x<=y&&S.y>=m&&S.y<=x&&S!==s&&S!==a&&f(o,u,h,d,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(t,e,n){var s=t;do{var r=s.prev,a=s.next.next;!v(r,a)&&m(r,s,s.next,a)&&w(r,a)&&w(a,r)&&(e.push(r.i/n|0),e.push(s.i/n|0),e.push(a.i/n|0),S(s),S(s.next),s=t=a),s=s.next}while(s!==t);return i(s)}function o(t,e,s,r,a,o){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&p(h,l)){var u=b(h,l);return h=i(h,h.next),u=i(u,u.next),n(h,e,s,r,a,o,0),void n(u,e,s,r,a,o,0)}l=l.next}h=h.next}while(h!==t)}function h(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var i,n=e,s=t.x,r=t.y,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var o=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=s&&o>a&&(a=o,i=n.x<n.next.x?n:n.next,o===s))return i}n=n.next}while(n!==e);if(!i)return null;var h,l=i,c=i.x,d=i.y,p=1/0;n=i;do{s>=n.x&&n.x>=c&&s!==n.x&&f(r<d?s:a,r,c,d,r<d?a:s,r,n.x,n.y)&&(h=Math.abs(r-n.y)/(s-n.x),w(n,t)&&(h<p||h===p&&(n.x>i.x||n.x===i.x&&u(i,n)))&&(i=n,p=h)),n=n.next}while(n!==l);return i}(t,e);if(!n)return e;var s=b(n,t);return i(s,s.next),i(n,n.next)}function u(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function c(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,n,s,r,a,o){return(s-a)*(e-o)>=(t-a)*(r-o)&&(t-a)*(n-o)>=(i-a)*(e-o)&&(i-a)*(r-o)>=(s-a)*(n-o)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&m(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,i,n){var s=x(g(t,e,i)),r=x(g(t,e,n)),a=x(g(i,n,t)),o=x(g(i,n,e));return s!==r&&a!==o||(!(0!==s||!y(t,i,e))||(!(0!==r||!y(t,n,e))||(!(0!==a||!y(i,t,n))||!(0!==o||!y(i,e,n)))))}function y(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function x(t){return t>0?1:t<0?-1:0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var i=new E(t.i,t.x,t.y),n=new E(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function T(t,e,i,n){var s=new E(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(t,e,i,n){for(var s=0,r=e,a=i-n;r<i;r+=n)s+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return s}return x_=1,t.deviation=function(t,e,i,n){var s=e&&e.length,r=s?e[0]*i:t.length,a=Math.abs(_(t,0,r,i));if(s)for(var o=0,h=e.length;o<h;o++){var l=e[o]*i,u=o<h-1?e[o+1]*i:t.length;a-=Math.abs(_(t,l,u,i))}var c=0;for(o=0;o<n.length;o+=3){var d=n[o]*i,f=n[o+1]*i,p=n[o+2]*i;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,s=0;s<t.length;s++){for(var r=0;r<t[s].length;r++)for(var a=0;a<e;a++)i.vertices.push(t[s][r][a]);s>0&&(n+=t[s-1].length,i.holes.push(n))}return i},y_=t}function uH(){return b_?w_:(b_=1,w_=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function cH(){return S_?T_:(S_=1,T_=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function dH(){if(__)return E_;__=1;var t=Kh(),e=lH(),i=jh(),n=uH(),s=cH(),r=yc(),a=_W(),o=SW(),h=AW(),l=new t({Extends:h,initialize:function(t){var e=t.game.renderer,l=i(t,"fragShader",n);t.fragShader=a.parseFragmentShaderMaxTextures(l,e.maxTextures),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:o.UNSIGNED_BYTE,normalized:!0}]),t.resizeUniform="uResolution",h.call(this,t),this._tempMatrix1=new r,this._tempMatrix2=new r,this._tempMatrix3=new r,this.calcMatrix=new r,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){h.prototype.boot.call(this);var t=this.renderer;this.set1iv("uMainSampler",t.textureIndexes),this.set2f("uResolution",t.width,t.height)},batchSprite:function(t,e,i){this.manager.set(this,t);var n=this._tempMatrix1,s=this._tempMatrix2,r=this._tempMatrix3,o=t.frame,h=o.glTexture,l=o.u0,u=o.v0,c=o.u1,d=o.v1,f=o.x,p=o.y,g=o.cutWidth,v=o.cutHeight,m=o.customPivot,y=t.displayOriginX,x=t.displayOriginY,w=-y+f,b=-x+p;if(t.isCropped){var T=t._crop;T.flipX===t.flipX&&T.flipY===t.flipY||o.updateCropUVs(T,t.flipX,t.flipY),l=T.u0,u=T.v0,c=T.u1,d=T.v1,g=T.width,v=T.height,w=-y+(f=T.x),b=-x+(p=T.y)}var S=1,E=1;t.flipX&&(m||(w+=-o.realWidth+2*y),S=-1),t.flipY&&(m||(b+=-o.realHeight+2*x),E=-1);var _=t.x,C=t.y;e.roundPixels&&(_=Math.floor(_),C=Math.floor(C)),s.applyITRS(_,C,t.rotation,t.scaleX*S,t.scaleY*E),n.copyFrom(e.matrix),i?(n.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),s.e=_,s.f=C):(s.e-=e.scrollX*t.scrollFactorX,s.f-=e.scrollY*t.scrollFactorY),n.multiply(s,r);var A=r.setQuad(w,b,w+g,b+v,e.renderRoundPixels),P=a.getTintAppendFloatAlpha,M=e.alpha,R=P(t.tintTopLeft,M*t._alphaTL),L=P(t.tintTopRight,M*t._alphaTR),O=P(t.tintBottomLeft,M*t._alphaBL),F=P(t.tintBottomRight,M*t._alphaBR);this.shouldFlush(6)&&this.flush();var D=this.setGameObject(t,o);this.manager.preBatch(t),this.batchQuad(t,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],l,u,c,d,R,L,O,F,t.tintFill,h,D),this.manager.postBatch(t)},batchTexture:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,b,T,S,E,_,C,A,P,M,R,L,O){void 0===O&&(O=!1),this.manager.set(this,t);var F=this._tempMatrix1,D=this._tempMatrix2,I=this._tempMatrix3,k=m/i+C,B=y/n+A,N=(m+x)/i+C,z=(y+w)/n+A,U=a,Y=o,X=-g,G=-v;if(t.isCropped){var W=t._crop,H=W.width,V=W.height;U=H,Y=V,a=H,o=V;var j=m=W.x,q=y=W.y;c&&(j=x-W.x-H),d&&(q=w-W.y-V),k=j/i+C,B=q/n+A,N=(j+H)/i+C,z=(q+V)/n+A,X=-g+m,G=-v+y}c&&(U*=-1,X+=a),(d^=!R&&e.isRenderTexture?1:0)&&(Y*=-1,G+=o),P.roundPixels&&(s=Math.floor(s),r=Math.floor(r)),D.applyITRS(s,r,u,h,l),F.copyFrom(P.matrix),M?(F.multiplyWithOffset(M,-P.scrollX*f,-P.scrollY*p),D.e=s,D.f=r):(D.e-=P.scrollX*f,D.f-=P.scrollY*p),F.multiply(D,I);var K=I.setQuad(X,G,X+U,G+Y,P.renderRoundPixels);null==L&&(L=this.setTexture2D(e)),t&&!O&&this.manager.preBatch(t),this.batchQuad(t,K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],k,B,N,z,b,T,S,E,_,e,L),t&&!O&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,i,n,s,r,o){this.manager.set(this);var h=this._tempMatrix1.copyFrom(r),l=this._tempMatrix2;o?h.multiply(o,l):l=h;var u=l.setQuad(e,i,e+t.width,i+t.height),c=this.setTexture2D(t.source.glTexture);n=a.getTintAppendFloatAlpha(n,s),this.batchQuad(null,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],t.u0,t.v0,t.u1,t.v1,n,n,n,n,0,t.glTexture,c)},batchFillRect:function(t,e,i,n,s,r){this.renderer.pipelines.set(this);var a=this.calcMatrix;r&&r.multiply(s,a);var o=a.setQuad(t,e,t+i,e+n),h=this.fillTint;this.batchQuad(null,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],0,0,1,1,h.TL,h.TR,h.BL,h.BR,2)},batchFillTriangle:function(t,e,i,n,s,r,a,o){this.renderer.pipelines.set(this);var h=this.calcMatrix;o&&o.multiply(a,h);var l=h.getX(t,e),u=h.getY(t,e),c=h.getX(i,n),d=h.getY(i,n),f=h.getX(s,r),p=h.getY(s,r),g=this.fillTint;this.batchTri(null,l,u,c,d,f,p,0,0,1,1,g.TL,g.TR,g.BL,2)},batchStrokeTriangle:function(t,e,i,n,s,r,a,o,h){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=a,l[1].x=i,l[1].y=n,l[1].width=a,l[2].x=s,l[2].y=r,l[2].width=a,l[3].x=t,l[3].y=e,l[3].width=a,this.batchStrokePath(l,a,!1,o,h)},batchFillPath:function(t,i,n){this.renderer.pipelines.set(this);var s=this.calcMatrix;n&&n.multiply(i,s);for(var r,a,o=t.length,h=this.polygonCache,l=this.fillTint.TL,u=this.fillTint.TR,c=this.fillTint.BL,d=0;d<o;++d)a=t[d],h.push(a.x,a.y);o=(r=e(h)).length;for(var f=0;f<o;f+=3){var p=2*r[f+0],g=2*r[f+1],v=2*r[f+2],m=h[p+0],y=h[p+1],x=h[g+0],w=h[g+1],b=h[v+0],T=h[v+1],S=s.getX(m,y),E=s.getY(m,y),_=s.getX(x,w),C=s.getY(x,w),A=s.getX(b,T),P=s.getY(b,T);this.batchTri(null,S,E,_,C,A,P,0,0,1,1,l,u,c,2)}h.length=0},batchStrokePath:function(t,e,i,n,s){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var r=t.length-1,a=0;a<r;a++){var o=t[a],h=t[a+1];this.batchLine(o.x,o.y,h.x,h.y,o.width/2,h.width/2,e,a,!i&&a===r-1,n,s)}},batchLine:function(t,e,i,n,s,r,a,o,h,l,u){this.renderer.pipelines.set(this);var c=this.calcMatrix;u&&u.multiply(l,c);var d=i-t,f=n-e,p=Math.sqrt(d*d+f*f);if(0!==p){var g=s*(n-e)/p,v=s*(t-i)/p,m=r*(n-e)/p,y=r*(t-i)/p,x=i-m,w=n-y,b=t-g,T=e-v,S=i+m,E=n+y,_=t+g,C=e+v,A=c.getX(x,w),P=c.getY(x,w),M=c.getX(b,T),R=c.getY(b,T),L=c.getX(S,E),O=c.getY(S,E),F=c.getX(_,C),D=c.getY(_,C),I=this.strokeTint,k=I.TL,B=I.TR,N=I.BL,z=I.BR;if(this.batchQuad(null,F,D,M,R,A,P,L,O,0,0,1,1,k,B,N,z,2),!(a<=2)){var U=this.prevQuad,Y=this.firstQuad;o>0&&U[4]?this.batchQuad(null,F,D,M,R,U[0],U[1],U[2],U[3],0,0,1,1,k,B,N,z,2):(Y[0]=F,Y[1]=D,Y[2]=M,Y[3]=R,Y[4]=1),h&&Y[4]?this.batchQuad(null,A,P,L,O,Y[0],Y[1],Y[2],Y[3],0,0,1,1,k,B,N,z,2):(U[0]=A,U[1]=P,U[2]=L,U[3]=O,U[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,h.prototype.destroy.call(this),this}});return E_=l}function fH(){return A_?C_:(A_=1,C_=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function pH(){return M_?P_:(M_=1,P_=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function gH(){if(L_)return R_;L_=1;var t=Qo(),e=kX(),i=Kh(),n=hH(),s=jh(),r=dH(),a=RW(),o=Ju(),h=wW(),l=fH(),u=pH(),c=AW(),d=new i({Extends:r,initialize:function(t){var e=s(t,"fragShader",a),i=s(t,"vertShader",u),h=s(t,"drawShader",a),c=[{name:"DrawSprite",fragShader:l,vertShader:u},{name:"CopySprite",fragShader:e,vertShader:i},{name:"DrawGame",fragShader:h,vertShader:u},{name:"ColorMatrix",fragShader:n}],d=s(t,"shaders",[]);t.shaders=c.concat(d),t.vertShader||(t.vertShader=i),t.batchSize=1,r.call(this,t),this.isPreFX=!0,this.customMainSampler=null,this.drawSpriteShader,this.copyShader,this.gameShader,this.colorMatrixShader,this.quadVertexData,this.quadVertexBuffer,this.quadVertexViewF32,this.spriteBounds=new o,this.targetBounds=new o,this.fsTarget,this.tempSprite,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){c.prototype.boot.call(this);var t=this.shaders,e=this.renderer;this.drawSpriteShader=t[0],this.copyShader=t[1],this.gameShader=t[2],this.colorMatrixShader=t[3],this.fsTarget=new h(e,e.width,e.height,1,0,!0,!0),this.renderTargets=this.manager.renderTargets.concat(this.fsTarget);var i=new ArrayBuffer(168);this.quadVertexData=i,this.quadVertexViewF32=new Float32Array(i),this.quadVertexBuffer=e.createVertexBuffer(i,this.gl.STATIC_DRAW),this.onResize(e.width,e.height),this.currentShader=this.copyShader,this.set2f("uResolution",e.width,e.height)},onResize:function(t,e){var i=this.quadVertexViewF32;i[1]=e,i[22]=e,i[14]=t,i[28]=t,i[35]=t,i[36]=e},batchQuad:function(t,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x){var w=Math.min(i,s,a,h),b=Math.min(n,r,o,l),T=Math.max(i,s,a,h)-w,S=Math.max(n,r,o,l)-b,E=this.spriteBounds.setTo(w,b,T,S),_=t?t.preFX.padding:0,C=T+2*_,A=S+2*_,P=Math.abs(Math.max(C,A)),M=this.manager.getRenderTarget(P),R=this.targetBounds.setTo(0,0,M.width,M.height);e(R,Math.round(E.centerX),Math.round(E.centerY)),this.tempSprite=t;var L=this.gl,O=this.renderer;O.clearStencilMask(),this.setShader(this.drawSpriteShader),this.set1i("uMainSampler",0),this.set2f("uResolution",O.width,O.height),this.flipProjectionMatrix(!0),t&&(this.onDrawSprite(t,M),t.preFX.onFX(this));var F=this.fsTarget;return this.flush(),L.viewport(0,0,O.width,O.height),L.bindFramebuffer(L.FRAMEBUFFER,F.framebuffer.webGLFramebuffer),L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_2D,F.texture.webGLTexture,0),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),this.setTexture2D(x),this.batchVert(i,n,u,c,0,y,p),this.batchVert(s,r,u,f,0,y,v),this.batchVert(a,o,d,f,0,y,m),this.batchVert(i,n,u,c,0,y,p),this.batchVert(a,o,d,f,0,y,m),this.batchVert(h,l,d,c,0,y,g),this.flush(),this.flipProjectionMatrix(!1),L.activeTexture(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,M.texture.webGLTexture),L.copyTexSubImage2D(L.TEXTURE_2D,0,0,0,R.x,R.y,R.width,R.height),L.bindFramebuffer(L.FRAMEBUFFER,null),L.bindTexture(L.TEXTURE_2D,null),this.onBatch(t),this.currentShader=this.copyShader,this.onDraw(M,this.manager.getSwapRenderTarget(),this.manager.getAltSwapRenderTarget()),!0},onDrawSprite:function(){},onCopySprite:function(){},copySprite:function(e,i,n,s,r,a,o){void 0===n&&(n=!0),void 0===s&&(s=!0),void 0===r&&(r=!1),void 0===o&&(o=this.copyShader);var h=this.gl,l=this.tempSprite;a&&(o=this.colorMatrixShader),this.currentShader=o;var u=this.setVertexBuffer(this.quadVertexBuffer);o.bind(u,!1);var c=this.renderer;if(this.set1i("uMainSampler",0),this.set2f("uResolution",c.width,c.height),l.preFX.onFXCopy(this),this.onCopySprite(e,i,l),a&&(this.set1fv("uColorMatrix",a.getData()),this.set1f("uAlpha",a.alpha)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),e.height>i.height)h.viewport(0,0,e.width,e.height),this.setTargetUVs(e,i);else{var d=i.height-e.height;h.viewport(0,d,e.width,e.height),this.resetUVs()}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),n&&(h.clearColor(0,0,0,Number(!s)),h.clear(h.COLOR_BUFFER_BIT)),r){var f=this.renderer.currentBlendMode;this.renderer.setBlendMode(t.ERASE)}h.bufferData(h.ARRAY_BUFFER,this.quadVertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),r&&this.renderer.setBlendMode(f),h.bindFramebuffer(h.FRAMEBUFFER,null)},copy:function(t,e){var i=this.gl;this.set1i("uMainSampler",0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.webGLTexture),i.viewport(0,0,t.width,t.height),this.setUVs(0,0,0,1,1,1,1,0),i.bindFramebuffer(i.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.texture.webGLTexture,0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.bufferData(i.ARRAY_BUFFER,this.quadVertexData,i.STATIC_DRAW),i.drawArrays(i.TRIANGLES,0,6),i.bindFramebuffer(i.FRAMEBUFFER,null)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},drawToGame:function(t){this.currentShader=null,this.setShader(this.copyShader),this.bindAndDraw(t)},copyToGame:function(t){this.currentShader=null,this.setShader(this.gameShader),this.bindAndDraw(t)},bindAndDraw:function(t){var e=this.gl,i=this.renderer;this.set1i("uMainSampler",0),this.customMainSampler?this.setTexture2D(this.customMainSampler):this.setTexture2D(t.texture);var n=this._tempMatrix1.loadIdentity(),s=this.targetBounds.x,r=this.targetBounds.y,a=s+t.width,o=r+t.height,h=n.getX(s,r),l=n.getX(s,o),u=n.getX(a,o),c=n.getX(a,r),d=n.getY(s,r),f=n.getY(s,o),p=n.getY(a,o),g=n.getY(a,r),v=16777215;this.batchVert(h,d,0,0,0,0,v),this.batchVert(l,f,0,1,0,0,v),this.batchVert(u,p,1,1,0,0,v),this.batchVert(h,d,0,0,0,0,v),this.batchVert(u,p,1,1,0,0,v),this.batchVert(c,g,1,0,0,0,v),i.restoreFramebuffer(!1,!0),i.currentFramebuffer||e.viewport(0,0,i.width,i.height),i.restoreStencilMask(),this.flush(),this.tempSprite=null},onDraw:function(t){this.drawToGame(t)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.quadVertexViewF32;h[2]=t,h[3]=e,h[9]=i,h[10]=n,h[16]=s,h[17]=r,h[23]=t,h[24]=e,h[30]=s,h[31]=r,h[37]=a,h[38]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)},destroy:function(){return this.renderer.deleteBuffer(this.quadVertexBuffer),this.drawSpriteShader=null,this.copyShader=null,this.gameShader=null,this.colorMatrixShader=null,this.quadVertexData=null,this.quadVertexBuffer=null,this.quadVertexViewF32=null,this.fsTarget=null,this.tempSprite=null,r.prototype.destroy.call(this),this}});return R_=d}function vH(){return F_?O_:(F_=1,O_=["#define SHADER_NAME PHASER_ADD_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = frame1 + frame2 * uStrength;","}"].join("\n"))}function mH(){return I_?D_:(I_=1,D_=["#define SHADER_NAME PHASER_COPY_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uBrightness;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}"].join("\n"))}function yH(){return B_?k_:(B_=1,k_=["#define SHADER_NAME PHASER_LIGHT_FS","precision mediump float;","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","const int kMaxLights = %LIGHT_COUNT%;","uniform vec4 uCamera; ","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","uniform int uLightCount;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","    for (int index = 0; index < kMaxLights; ++index)","    {","        if (index < uLightCount)","        {","            Light light = uLights[index];","            vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","            vec3 lightNormal = normalize(lightDir);","            float distToSurf = length(lightDir) * uCamera.w;","            float diffuseFactor = max(dot(normal, lightNormal), 0.0);","            float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","            float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","            vec3 diffuse = light.color * diffuseFactor;","            finalColor += (attenuation * diffuse) * light.intensity;","        }","    }","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}"].join("\n"))}function xH(){return z_?N_:(z_=1,N_=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}"].join("\n"))}function wH(){return K_?q_:(K_=1,q_=["#define SHADER_NAME PHASER_POINTLIGHT_FS","precision mediump float;","uniform vec2 uResolution;","uniform float uCameraZoom;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","    float distToSurf = length(center - gl_FragCoord.xy);","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}"].join("\n"))}function bH(){return J_?Z_:(J_=1,Z_=["#define SHADER_NAME PHASER_POINTLIGHT_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}"].join("\n"))}function TH(){if(eC)return tC;eC=1;var t=Kh(),e=oH(),i=wu(),n=jh(),s=gH(),r=Q_?$_:(Q_=1,$_={AddBlendFrag:vH(),BitmapMaskFrag:bW(),BitmapMaskVert:TW(),ColorMatrixFrag:hH(),CopyFrag:mH(),FXBarrelFrag:MW(),FXBloomFrag:DW(),FXBlurHighFrag:NW(),FXBlurLowFrag:kW(),FXBlurMedFrag:BW(),FXBokehFrag:UW(),FXCircleFrag:XW(),FXDisplacementFrag:HW(),FXGlowFrag:jW(),FXGradientFrag:KW(),FXPixelateFrag:JW(),FXShadowFrag:QW(),FXShineFrag:eH(),FXVignetteFrag:nH(),FXWipeFrag:rH(),LightFrag:yH(),LinearBlendFrag:xH(),MeshFrag:Y_?U_:(Y_=1,U_=["#define SHADER_NAME PHASER_MESH_FS","precision mediump float;","uniform vec3 uLightPosition;","uniform vec3 uLightAmbient;","uniform vec3 uLightDiffuse;","uniform vec3 uLightSpecular;","uniform vec3 uFogColor;","uniform float uFogNear;","uniform float uFogFar;","uniform vec3 uMaterialAmbient;","uniform vec3 uMaterialDiffuse;","uniform vec3 uMaterialSpecular;","uniform float uMaterialShine;","uniform vec3 uCameraPosition;","uniform sampler2D uTexture;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main (void)","{","    vec4 color = texture2D(uTexture, vTextureCoord);","    vec3 ambient = uLightAmbient * uMaterialAmbient;","    vec3 norm = normalize(vNormal);","    vec3 lightDir = normalize(uLightPosition - vPosition);","    float diff = max(dot(norm, lightDir), 0.0);","    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);","    vec3 viewDir = normalize(uCameraPosition - vPosition);","    vec3 reflectDir = reflect(-lightDir, norm);","    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);","    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);","    vec3 result = (ambient + diffuse + specular) * color.rgb;","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep(uFogNear, uFogFar, depth);","    gl_FragColor.rgb = mix(result.rgb, uFogColor, fogFactor);","    gl_FragColor.a = color.a;","}"].join("\n")),MeshVert:G_?X_:(G_=1,X_=["#define SHADER_NAME PHASER_MESH_VS","precision mediump float;","attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uViewProjectionMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uNormalMatrix;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main ()","{","    vTextureCoord = aTextureCoord;","    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));","    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));","    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);","}"].join("\n")),MobileFrag:H_?W_:(H_=1,W_=["#define SHADER_NAME PHASER_MOBILE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")),MobileVert:j_?V_:(j_=1,V_=["#define SHADER_NAME PHASER_MOBILE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")),MultiFrag:uH(),MultiVert:cH(),PointLightFrag:wH(),PointLightVert:bH(),PostFXFrag:RW(),QuadVert:LW(),SingleFrag:fH(),SingleVert:pH()}),a=_W(),o=new t({Extends:s,initialize:function(t){t.shaders=[a.setGlowQuality(r.FXGlowFrag,t.game),r.FXShadowFrag,r.FXPixelateFrag,r.FXVignetteFrag,r.FXShineFrag,r.FXBlurLowFrag,r.FXBlurMedFrag,r.FXBlurHighFrag,r.FXGradientFrag,r.FXBloomFrag,r.ColorMatrixFrag,r.FXCircleFrag,r.FXBarrelFrag,r.FXDisplacementFrag,r.FXWipeFrag,r.FXBokehFrag],s.call(this,t);var n=this.game;this.glow=new e.Glow(n),this.shadow=new e.Shadow(n),this.pixelate=new e.Pixelate(n),this.vignette=new e.Vignette(n),this.shine=new e.Shine(n),this.gradient=new e.Gradient(n),this.circle=new e.Circle(n),this.barrel=new e.Barrel(n),this.wipe=new e.Wipe(n),this.bokeh=new e.Bokeh(n);var o=[];o[i.GLOW]=this.onGlow,o[i.SHADOW]=this.onShadow,o[i.PIXELATE]=this.onPixelate,o[i.VIGNETTE]=this.onVignette,o[i.SHINE]=this.onShine,o[i.BLUR]=this.onBlur,o[i.GRADIENT]=this.onGradient,o[i.BLOOM]=this.onBloom,o[i.COLOR_MATRIX]=this.onColorMatrix,o[i.CIRCLE]=this.onCircle,o[i.BARREL]=this.onBarrel,o[i.DISPLACEMENT]=this.onDisplacement,o[i.WIPE]=this.onWipe,o[i.BOKEH]=this.onBokeh,this.fxHandlers=o,this.source,this.target,this.swap},onDraw:function(t,e,i){this.source=t,this.target=e,this.swap=i;var n=t.width,s=t.height,r=this.tempSprite,a=this.fxHandlers;if(r&&r.preFX)for(var o=r.preFX.list,h=0;h<o.length;h++){var l=o[h];l.active&&a[l.type].call(this,l,n,s)}this.drawToGame(this.source)},runDraw:function(){var t=this.source,e=this.target;this.copy(t,e),this.source=e,this.target=t},onGlow:function(t,e,n){var s=this.shaders[i.GLOW];this.setShader(s),this.glow.onPreRender(t,s,e,n),this.runDraw()},onShadow:function(t){var e=this.shaders[i.SHADOW];this.setShader(e),this.shadow.onPreRender(t,e),this.runDraw()},onPixelate:function(t,e,n){var s=this.shaders[i.PIXELATE];this.setShader(s),this.pixelate.onPreRender(t,s,e,n),this.runDraw()},onVignette:function(t){var e=this.shaders[i.VIGNETTE];this.setShader(e),this.vignette.onPreRender(t,e),this.runDraw()},onShine:function(t,e,n){var s=this.shaders[i.SHINE];this.setShader(s),this.shine.onPreRender(t,s,e,n),this.runDraw()},onBlur:function(t,e,s){var r=n(t,"quality"),a=this.shaders[i.BLUR+r];this.setShader(a),this.set1i("uMainSampler",0),this.set2f("resolution",e,s),this.set1f("strength",n(t,"strength")),this.set3fv("color",n(t,"glcolor"));for(var o=n(t,"x"),h=n(t,"y"),l=n(t,"steps"),u=0;u<l;u++)this.set2f("offset",o,0),this.runDraw(),this.set2f("offset",0,h),this.runDraw()},onGradient:function(t){var e=this.shaders[i.GRADIENT];this.setShader(e),this.gradient.onPreRender(t,e),this.runDraw()},onBloom:function(t,e,s){var r=this.shaders[i.BLOOM];this.copySprite(this.source,this.swap),this.setShader(r),this.set1i("uMainSampler",0),this.set1f("strength",n(t,"blurStrength")),this.set3fv("color",n(t,"glcolor"));for(var a=2/e*n(t,"offsetX"),o=2/s*n(t,"offsetY"),h=n(t,"steps"),l=0;l<h;l++)this.set2f("offset",a,0),this.runDraw(),this.set2f("offset",0,o),this.runDraw();this.blendFrames(this.swap,this.source,this.target,n(t,"strength")),this.copySprite(this.target,this.source)},onColorMatrix:function(t){this.setShader(this.colorMatrixShader),this.set1fv("uColorMatrix",t.getData()),this.set1f("uAlpha",t.alpha),this.runDraw()},onCircle:function(t,e,n){var s=this.shaders[i.CIRCLE];this.setShader(s),this.circle.onPreRender(t,s,e,n),this.runDraw()},onBarrel:function(t){var e=this.shaders[i.BARREL];this.setShader(e),this.barrel.onPreRender(t,e),this.runDraw()},onDisplacement:function(t){this.setShader(this.shaders[i.DISPLACEMENT]),this.set1i("uDisplacementSampler",1),this.set2f("amount",t.x,t.y),this.bindTexture(t.glTexture,1),this.runDraw()},onWipe:function(t){var e=this.shaders[i.WIPE];this.setShader(e),this.wipe.onPreRender(t,e),this.runDraw()},onBokeh:function(t,e,n){var s=this.shaders[i.BOKEH];this.setShader(s),this.bokeh.onPreRender(t,s,e,n),this.runDraw()},destroy:function(){return this.glow.destroy(),this.shadow.destroy(),this.pixelate.destroy(),this.vignette.destroy(),this.shine.destroy(),this.gradient.destroy(),this.circle.destroy(),this.barrel.destroy(),this.wipe.destroy(),this.bokeh.destroy(),this.fxHandlers=null,this.source=null,this.target=null,this.swap=null,s.prototype.destroy.call(this),this}});return tC=o}function SH(){if(nC)return iC;nC=1;var t=Kh(),e=jh(),i=yH(),n=dH(),s=yc(),r=qu(),a=AW(),o=new t({Extends:n,initialize:function(t){var a=e(t,"fragShader",i);t.fragShader=a.replace("%LIGHT_COUNT%",t.game.renderer.config.maxLights),n.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.currentNormalMap,this.lightsActive=!0,this.tempVec2=new r,this._tempMatrix=new s,this._tempMatrix2=new s},boot:function(){a.prototype.boot.call(this)},onRender:function(t,e){var i=t.sys.lights;if(this.lightsActive=!1,i&&i.active){var n,s=i.getLights(e),r=s.length;this.lightsActive=!0;var a=this.renderer.height,o=e.matrix,h=this.tempVec2;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",e.x,e.y,e.rotation,e.zoom),this.set3f("uAmbientLightColor",i.ambientColor.r,i.ambientColor.g,i.ambientColor.b),this.set1i("uLightCount",r),n=0;n<r;n++){var l=s[n].light,u=l.color,c="uLights["+n+"].";o.transformPoint(l.x,l.y,h),this.set2f(c+"position",h.x-e.scrollX*l.scrollFactorX*e.zoom,a-(h.y-e.scrollY*l.scrollFactorY*e.zoom)),this.set3f(c+"color",u.r,u.g,u.b),this.set1f(c+"intensity",l.intensity),this.set1f(c+"radius",l.radius)}this.currentNormalMapRotation=null}},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.vertexCount){this.vertexCount>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var i=-t,n=Math.cos(i),s=Math.sin(i);e[1]=s,e[3]=-s,e[0]=e[4]=n}else e[0]=e[4]=1,e[1]=e[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},setTexture2D:function(t,e){var i=this.renderer;void 0===t&&(t=i.whiteTexture);var n=this.getNormalMap(e);this.isNewNormalMap(t,n)&&(this.flush(),this.createBatch(t),this.addTextureToBatch(n),this.currentNormalMap=n);var s=0;e&&e.parentContainer?s=e.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2).rotationNormalized:e&&(s=e.rotation);return null===this.currentBatch&&(this.createBatch(t),this.addTextureToBatch(n)),this.setNormalMapRotation(s),0},setGameObject:function(t,e){void 0===e&&(e=t.frame);var i=e.glTexture,n=this.getNormalMap(t);if(this.isNewNormalMap(i,n)&&(this.flush(),this.createBatch(i),this.addTextureToBatch(n),this.currentNormalMap=n),t.parentContainer){var s=t.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);this.setNormalMapRotation(s.rotationNormalized)}else this.setNormalMapRotation(t.rotation);return null===this.currentBatch&&(this.createBatch(i),this.addTextureToBatch(n)),0},isNewNormalMap:function(t,e){return this.currentTexture!==t||this.currentNormalMap!==e},getNormalMap:function(t){var e;return t?(t.displayTexture?e=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?e=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(e=Array.isArray(t.tileset)?t.tileset[0].image.dataSource[0]:t.tileset.image.dataSource[0]),e?e.glTexture:this.renderer.normalTexture):this.renderer.normalTexture},batchSprite:function(t,e,i){this.lightsActive&&n.prototype.batchSprite.call(this,t,e,i)},batchTexture:function(t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,b,T,S,E,_,C,A,P,M,R,L,O){this.lightsActive&&n.prototype.batchTexture.call(this,t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,b,T,S,E,_,C,A,P,M,R,L,O)},batchTextureFrame:function(t,e,i,s,r,a,o){this.lightsActive&&n.prototype.batchTextureFrame.call(this,t,e,i,s,r,a,o)}});return iC=o}function EH(){if(rC)return sC;rC=1;var t=Kh(),e=jh(),i=dH(),n=fH(),s=pH(),r=SW(),a=AW(),o=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:r.UNSIGNED_BYTE,normalized:!0}]),t.forceZero=!0,t.resizeUniform="uResolution",i.call(this,t)},boot:function(){a.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return sC=o}function _H(){if(oC)return aC;oC=1;var t=Kh(),e=jh(),i=wH(),n=bH(),s=AW(),r=new t({Extends:s,initialize:function(t){t.vertShader=e(t,"vertShader",n),t.fragShader=e(t,"fragShader",i),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),s.call(this,t)},onRender:function(t,e){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",e.zoom)},batchPointLight:function(t,e,i,n,s,r,a,o,h,l,u,c){var d=t.color,f=t.intensity,p=t.radius,g=t.attenuation,v=d.r*f,m=d.g*f,y=d.b*f,x=e.alpha*t.alpha;this.shouldFlush(6)&&this.flush(),this.currentBatch||this.setTexture2D(),this.batchLightVert(i,n,u,c,p,g,v,m,y,x),this.batchLightVert(s,r,u,c,p,g,v,m,y,x),this.batchLightVert(a,o,u,c,p,g,v,m,y,x),this.batchLightVert(i,n,u,c,p,g,v,m,y,x),this.batchLightVert(a,o,u,c,p,g,v,m,y,x),this.batchLightVert(h,l,u,c,p,g,v,m,y,x),this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchLightVert:function(t,e,i,n,s,r,a,o,h,l){var u=this.vertexViewF32,c=this.vertexCount*this.currentShader.vertexComponentCount-1;u[++c]=t,u[++c]=e,u[++c]=i,u[++c]=n,u[++c]=s,u[++c]=r,u[++c]=a,u[++c]=o,u[++c]=h,u[++c]=l,this.vertexCount++}});return aC=r}function CH(){if(lC)return hC;lC=1;var t=Kh(),e=jh(),i=dH(),n=new t({Extends:i,initialize:function(t){t.topology=5,t.batchSize=e(t,"batchSize",256),i.call(this,t)}});return hC=n}function AH(){if(cC)return uC;cC=1;var t=Kh(),e=jh(),i=dH(),n=fH(),s=pH(),r=AW(),a=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.forceZero=!0,i.call(this,t)},boot:function(){r.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return uC=a}function PH(){if(fC)return dC;fC=1;var t=vH(),e=Qo(),i=Kh(),n=Au(),s=hH(),r=mH(),a=jh(),o=xH(),h=LW(),l=AW(),u=new i({Extends:l,initialize:function(e){e.renderTarget=a(e,"renderTarget",[{scale:1,autoResize:!0},{scale:1,autoResize:!0},{scale:.5,autoResize:!0},{scale:.5,autoResize:!0}]),e.vertShader=a(e,"vertShader",h),e.shaders=a(e,"shaders",[{name:"Copy",fragShader:r},{name:"AddBlend",fragShader:t},{name:"LinearBlend",fragShader:o},{name:"ColorMatrix",fragShader:s}]),e.attributes=a(e,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),e.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],e.batchSize=1,l.call(this,e),this.colorMatrix=new n,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){l.prototype.boot.call(this);var t=this.shaders,e=this.renderTargets;this.copyShader=t[0],this.addShader=t[1],this.linearShader=t[2],this.colorMatrixShader=t[3],this.fullFrame1=e[0],this.fullFrame2=e[1],this.halfFrame1=e[2],this.halfFrame2=e[3]},copyFrame:function(t,e,i,n,s){void 0===i&&(i=1),void 0===n&&(n=!0),void 0===s&&(s=!0);var r=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",i),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0)):r.viewport(0,0,t.width,t.height),n&&(s?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT)),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)},blitFrame:function(t,i,n,s,r,a,o){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===a&&(a=!1),void 0===o&&(o=!1);var h=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,t.texture.webGLTexture),t.height>i.height)h.viewport(0,0,t.width,t.height),this.setTargetUVs(t,i);else{var l=i.height-t.height;h.viewport(0,l,t.width,t.height)}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),s&&(r?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),a){var u=this.renderer.currentBlendMode;this.renderer.setBlendMode(e.ERASE)}o&&this.flipY(),h.bufferData(h.ARRAY_BUFFER,this.vertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),a&&this.renderer.setBlendMode(u),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=!0),void 0===o&&(o=!0);var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,t.texture.webGLTexture,0),a&&(o?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),h.copyTexSubImage2D(h.TEXTURE_2D,0,0,0,i,n,s,r),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null)},copyToGame:function(t){var e=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture.webGLTexture),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),e.drawArrays(e.TRIANGLES,0,6)},drawFrame:function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=this.colorMatrix);var s=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",n.getData()),this.set1f("uAlpha",n.alpha),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture.webGLTexture),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture.webGLTexture,0)):s.viewport(0,0,t.width,t.height),i?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D,null)},blendFrames:function(t,e,i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=this.linearShader);var a=this.gl;this.setShader(r),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",n),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture.webGLTexture),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,e.texture.webGLTexture),i?(a.bindFramebuffer(a.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i.texture.webGLTexture,0),a.viewport(0,0,i.width,i.height)):a.viewport(0,0,t.width,t.height),s?a.clearColor(0,0,0,0):a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.bufferData(a.ARRAY_BUFFER,this.vertexData,a.STATIC_DRAW),a.drawArrays(a.TRIANGLES,0,6),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindTexture(a.TEXTURE_2D,null)},blendFramesAdditive:function(t,e,i,n,s){this.blendFrames(t,e,i,n,s,this.addShader)},clearFrame:function(t,e){void 0===e&&(e=!0);var i=this.gl;i.viewport(0,0,t.width,t.height),i.bindFramebuffer(i.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),e?i.clearColor(0,0,0,0):i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);var n=this.renderer.currentFramebuffer;i.bindFramebuffer(i.FRAMEBUFFER,n.webGLFramebuffer)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.vertexViewF32;h[2]=t,h[3]=e,h[6]=i,h[7]=n,h[10]=s,h[11]=r,h[14]=t,h[15]=e,h[18]=s,h[19]=r,h[22]=a,h[23]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});return dC=u}function MH(){if(gC)return pC;gC=1;var t=Kh(),e=dW(),i=fX(),n=pu(),s=jh(),r=wW(),a=OG(),o=PW(),h=oH(),l=wu(),u=TH(),c=SH(),d=EH(),f=dH(),p=_H(),g=CH(),v=AH(),m=PH(),y=Rl(),x=Zl(),w=new t({initialize:function(t){this.game=t.game,this.renderer=t,this.classes=new i([[e.UTILITY_PIPELINE,m],[e.MULTI_PIPELINE,f],[e.BITMAPMASK_PIPELINE,o],[e.SINGLE_PIPELINE,v],[e.ROPE_PIPELINE,g],[e.LIGHT_PIPELINE,c],[e.POINTLIGHT_PIPELINE,p],[e.MOBILE_PIPELINE,d]]),this.postPipelineClasses=new i,this.pipelines=new i,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(t,i,a){var o=this.renderer,c=this.renderTargets;this.frameInc=Math.floor(s(t,"frameInc",32));var d,f,p=o.width,g=o.height,v=this.game.config.disablePreFX;if(this.game.config.disablePostFX||this.postPipelineClasses.setAll([[String(l.BARREL),h.Barrel],[String(l.BLOOM),h.Bloom],[String(l.BLUR),h.Blur],[String(l.BOKEH),h.Bokeh],[String(l.CIRCLE),h.Circle],[String(l.COLOR_MATRIX),h.ColorMatrix],[String(l.DISPLACEMENT),h.Displacement],[String(l.GLOW),h.Glow],[String(l.GRADIENT),h.Gradient],[String(l.PIXELATE),h.Pixelate],[String(l.SHADOW),h.Shadow],[String(l.SHINE),h.Shine],[String(l.VIGNETTE),h.Vignette],[String(l.WIPE),h.Wipe]]),!v){this.classes.set(e.FX_PIPELINE,u);for(var m=Math.min(p,g),y=Math.ceil(m/this.frameInc),x=1;x<y;x++){var w=x*this.frameInc;c.push(new r(o,w,w)),c.push(new r(o,w,w)),c.push(new r(o,w,w)),this.maxDimension=w}c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0))}var b=this,T=this.game;if(this.classes.each(function(t,i){d=b.add(t,new i({game:T})),t===e.UTILITY_PIPELINE&&(b.UTILITY_PIPELINE=d,b.fullFrame1=d.fullFrame1,b.fullFrame2=d.fullFrame2,b.halfFrame1=d.halfFrame1,b.halfFrame2=d.halfFrame2)}),this.MULTI_PIPELINE=this.get(e.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(e.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(e.MOBILE_PIPELINE),v||(this.FX_PIPELINE=this.get(e.FX_PIPELINE)),t)for(f in t){var S=t[f];(d=new S(T)).name=f,d.isPostFX?this.postPipelineClasses.set(f,S):this.has(f)||(this.classes.set(f,S),this.add(f,d))}this.default=this.get(i),a&&!n.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(t){var e=this.get(t);return e&&(this.default=e),e},add:function(t,e){if(!e.isPostFX){var i=this.pipelines,n=this.renderer;return i.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,i.set(t,e)),e.hasBooted||e.boot(),0===n.width||0===n.height||e.isPreFX||e.resize(n.width,n.height),e}console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return"string"==typeof t?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;return"string"==typeof t?e.get(t):e.contains(t)?t:void 0},getPostPipeline:function(t,e,i){var n,s=this.postPipelineClasses,r="",a=typeof t;if("string"===a||"number"===a?(n=s.get(t),r=t):"function"===a?(s.contains(t)&&(n=t),r=t.name):"object"===a&&(n=s.get(t.name),r=t.name),n){var o=new n(this.game,i);return o.name=r,e&&(o.gameObject=e),this.postPipelineInstances.push(o),o}},removePostPipeline:function(t){x(this.postPipelineInstances,t)},remove:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),this.pipelines.delete(t),e&&this.classes.delete(t),i&&this.postPipelineClasses.delete(t)},set:function(t,e,i){if(!t.isPostFX)return this.isCurrent(t,i)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(i)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},isCurrent:function(t,e){var i=this.renderer,n=this.current;return n&&!e&&(e=n.currentShader),!(n!==t||e.program!==i.currentProgram)},copyFrame:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,i,n,s),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,i,n){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,i,n),this},blendFrames:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,i,n,s),this},blendFramesAdditive:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,i,n,s),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,i,n,s,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,i,n,s,r),this},copyFrameRect:function(t,e,i,n,s,r,a,o){return this.UTILITY_PIPELINE.copyFrameRect(t,e,i,n,s,r,a,o),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(t,e){e.restoreContext()}),y(this.postPipelineInstances,function(t){t.restoreContext()})},rebind:function(t){void 0===t&&this.previous&&(t=this.previous);var e=this.renderer,i=e.gl;i.disable(i.DEPTH_TEST),i.disable(i.CULL_FACE),e.hasActiveStencilMask()?i.clear(i.DEPTH_BUFFER_BIT):(i.disable(i.STENCIL_TEST),i.clear(i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT)),i.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var n=e.vaoExtension;n&&n.bindVertexArrayOES(null);var s=this.pipelines.entries;for(var r in s)s[r].glReset=!0;t&&(this.current=t,t.rebind())},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0);var e=t.vaoExtension;e&&e.bindVertexArrayOES(null)},getRenderTarget:function(t){var e=this.renderTargets;if(t>this.maxDimension)return this.targetIndex=e.length-3,e[this.targetIndex];var i=3*(a(t,this.frameInc,0,!0)-1);return this.targetIndex=i,e[i]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});return pC=w}function RH(){if(mC)return vC;mC=1;var t=ou(),e=PX(),i=jh();return vC=function(n,s){var r=n,a=i(s,"callback"),o=i(s,"type","image/png"),h=i(s,"encoder",.92),l=Math.abs(Math.round(i(s,"x",0))),u=Math.abs(Math.round(i(s,"y",0))),c=i(s,"getPixel",!1),d=i(s,"isFramebuffer",!1),f=d?i(s,"bufferWidth",1):r.drawingBufferWidth,p=d?i(s,"bufferHeight",1):r.drawingBufferHeight;if(c){var g=new Uint8Array(4),v=d?u:p-u;r.readPixels(l,v,1,1,r.RGBA,r.UNSIGNED_BYTE,g),a.call(null,new e(g[0],g[1],g[2],g[3]))}else{var m=Math.floor(i(s,"width",f)),y=Math.floor(i(s,"height",p)),x=m*y*4,w=new Uint8Array(x);r.readPixels(l,p-u-y,m,y,r.RGBA,r.UNSIGNED_BYTE,w);for(var b=t.createWebGL(this,m,y),T=b.getContext("2d",{willReadFrequently:!0}),S=T.getImageData(0,0,m,y),E=S.data,_=0;_<y;_++)for(var C=0;C<m;C++){var A=4*((y-_-1)*m+C),P=d?x-4*(_*m+(m-C)):4*(_*m+C);E[P+0]=w[A+0],E[P+1]=w[A+1],E[P+2]=w[A+2],E[P+3]=w[A+3]}T.putImageData(S,0,0);var M=new Image;M.onerror=function(){a.call(null),t.remove(b)},M.onload=function(){a.call(null,M),t.remove(b)},M.src=b.toDataURL(o,h)}},vC}function LH(){if(xC)return yC;xC=1;var t=new(Kh())({initialize:function(t,e,i,n){this.webGLBuffer=null,this.gl=t,this.initialDataOrSize=e,this.bufferType=i,this.bufferUsage=n,this.createResource()},createResource:function(){if(null!==this.initialDataOrSize){var t=this.gl;if(!t.isContextLost()){var e=this.bufferType,i=t.createBuffer();this.webGLBuffer=i,t.bindBuffer(e,this.webGLBuffer),t.bufferData(e,this.initialDataOrSize,this.bufferUsage),t.bindBuffer(e,null)}}},destroy:function(){var t=this.gl;t.isContextLost()||t.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});return yC=t}function OH(){if(bC)return wC;bC=1;var t=new(Kh())({initialize:function(t,e,i){this.webGLProgram=null,this.gl=t,this.vertexSource=e,this.fragmentSource=i,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var e=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,this.vertexSource),t.shaderSource(n,this.fragmentSource),t.compileShader(i),t.compileShader(n);var s="Shader failed:\n";if(!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex "+s+t.getShaderInfoLog(i));if(!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment "+s+t.getShaderInfoLog(n));if(t.attachShader(e,i),t.attachShader(e,n),t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS))throw new Error("Link "+s+t.getProgramInfoLog(e));t.useProgram(e),this.webGLProgram=e}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});return wC=t}function FH(){if(SC)return TC;SC=1;var t=Kh(),e=RG(),i=new t({initialize:function(t,e,i,n,s,r,a,o,h,l,u,c,d){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=t,this.mipLevel=e,this.minFilter=i,this.magFilter=n,this.wrapT=s,this.wrapS=r,this.format=a,this.pixels=o,this.width=h,this.height=l,this.pma=null==u||u,this.forceSize=!!c,this.flipY=!!d,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost())if(this.pixels instanceof i)this.webGLTexture=this.pixels.webGLTexture;else{var e=t.createTexture();e.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=e,this._processTexture()}},update:function(t,e,i,n,s,r,a,o,h){0!==e&&0!==i&&(this.pixels=t,this.width=e,this.height=i,this.flipY=n,this.wrapS=s,this.wrapT=r,this.minFilter=a,this.magFilter=o,this.format=h,this.gl.isContextLost()||this._processTexture())},_processTexture:function(){var t=this.gl;t.activeTexture(t.TEXTURE0);var i=t.getParameter(t.TEXTURE_BINDING_2D);t.bindTexture(t.TEXTURE_2D,this.webGLTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY);var n=this.pixels,s=this.mipLevel,r=this.width,a=this.height,o=this.format,h=!1;if(null==n)t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,null),h=e(r,a);else if(n.compressed){r=n.width,a=n.height,h=n.generateMipmap;for(var l=0;l<n.mipmaps.length;l++)t.compressedTexImage2D(t.TEXTURE_2D,l,n.internalFormat,n.mipmaps[l].width,n.mipmaps[l].height,0,n.mipmaps[l].data)}else n instanceof Uint8Array?(t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,n),h=e(r,a)):(this.forceSize||(r=n.width,a=n.height),t.texImage2D(t.TEXTURE_2D,s,o,o,t.UNSIGNED_BYTE,n),h=e(r,a));h&&t.generateMipmap(t.TEXTURE_2D),i?t.bindTexture(t.TEXTURE_2D,i):t.bindTexture(t.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(t){this.__SPECTOR_Metadata=t,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=t)}},destroy:function(){null!==this.webGLTexture&&(this.gl.isContextLost()||this.pixels instanceof i||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});return TC=i}function DH(){if(_C)return EC;_C=1;var t=Kh(),e={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},i=new t({initialize:function(t,e,i,n,s){this.webGLFramebuffer=null,this.gl=t,this.width=e,this.height=i,this.renderTexture=n,this.addDepthStencilBuffer=!!s,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var i,n=this.renderTexture,s=t.createFramebuffer();if(this.webGLFramebuffer=s,t.bindFramebuffer(t.FRAMEBUFFER,s),n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.webGLTexture,0),(i=t.checkFramebufferStatus(t.FRAMEBUFFER))!==t.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(e[i]||i));if(this.addDepthStencilBuffer){var r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r)}t.bindFramebuffer(t.FRAMEBUFFER,null)}},destroy:function(){if(null!==this.webGLFramebuffer){var t=this.gl;if(!t.isContextLost()){t.bindFramebuffer(t.FRAMEBUFFER,this.webGLFramebuffer);var e=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==e&&(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.deleteTexture(e));var i=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==i&&t.deleteRenderbuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});return EC=i}function IH(){if(AC)return CC;AC=1;var t=new(Kh())({initialize:function(t,e,i){this.webGLAttribLocation=-1,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLAttribLocation=t.getAttribLocation(this.program.webGLProgram,this.name))}else this.webGLAttribLocation=-1},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});return CC=t}function kH(){if(MC)return PC;MC=1;var t=new(Kh())({initialize:function(t,e,i){this.webGLUniformLocation=null,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLUniformLocation=t.getUniformLocation(this.program.webGLProgram,this.name))}else this.webGLUniformLocation=null},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});return PC=t}function BH(){if(LC)return RC;LC=1;var t=Rl(),e=Zl(),i=SX(),n=Kh(),s=eh(),r=cU(),a=vW(),o=RG(),h=UG(),l=qh(),u=MH(),c=wW(),d=VX(),f=yW(),p=_W(),g=RH(),v=LH(),m=OH(),y=FH(),x=DH(),w=IH(),b=kH(),T=new n({Extends:r,initialize:function(t){r.call(this);var e=t.config,i={alpha:e.transparent,desynchronized:e.desynchronized,depth:!0,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference,preserveDrawingBuffer:e.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:i,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights,mipmapFilter:e.mipmapFilter},this.game=t,this.type=s.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=l,this.contextRestoredHandler=l,this.previousContextLostHandler=l,this.previousContextRestoredHandler=l,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(t){var e,i=this.game,n=this.canvas,r=t.backgroundColor;if(!(e=i.config.context?i.config.context:n.getContext("webgl",t.contextCreation)||n.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e,this.setExtensions(),this.setContextHandlers(),i.context=e;for(var a=0;a<=27;a++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats=[e.BYTE,e.SHORT,e.UNSIGNED_BYTE,e.UNSIGNED_SHORT,e.FLOAT],this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}},t.maxTextures&&-1!==t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),e.clear(e.COLOR_BUFFER_BIT);return-1!==["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"].indexOf(t.mipmapFilter)&&(this.mipmapFilter=e[t.mipmapFilter]),this.maxTextures=p.checkShaderMax(e,t.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new u(this),this.setBlendMode(s.BlendModes.NORMAL),this.projectionMatrix=(new h).identity(),i.textures.once(f.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,i=t.scale.baseSize,n=i.width,s=i.height;this.width=n,this.height=s,this.isBooted=!0,this.renderTarget=new c(this,n,s,1,0,!0,!0),this.maskTarget=new c(this,n,s,1,0,!0,!0),this.maskSource=new c(this,n,s,1,0,!0,!0);var r=t.config;e.boot(r.pipeline,r.defaultPipeline,r.autoMobilePipeline),this.blankTexture=t.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=t.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=t.textures.getFrame("__WHITE").glTexture;var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),t.scale.on(d.RESIZE,this.onResize,this),this.resize(n,s)},setExtensions:function(){var t=this.gl,e=t.getSupportedExtensions();this.supportedExtensions=e;var i="ANGLE_instanced_arrays";this.instancedArraysExtension=e.indexOf(i)>-1?t.getExtension(i):null;var n="OES_vertex_array_object";this.vaoExtension=e.indexOf(n)>-1?t.getExtension(n):null},setContextHandlers:function(t,e){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),this.contextLostHandler="function"==typeof t?t.bind(this):this.dispatchContextLost.bind(this),this.contextRestoredHandler="function"==typeof e?e.bind(this):this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(t){this.contextLost=!0,console&&console.warn("WebGL Context lost. Renderer disabled"),this.emit(a.LOSE_WEBGL,this),t.preventDefault()},dispatchContextRestored:function(e){var i=this.gl;if(i.isContextLost())console&&console.log("WebGL Context restored, but context is still lost");else{this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(s.BlendModes.NORMAL),i.disable(i.BLEND),i.disable(i.DEPTH_TEST),i.enable(i.CULL_FACE),this.compression=this.getCompressedTextures();var n=function(t){t.createResource()};t(this.glTextureWrappers,n),t(this.glBufferWrappers,n),t(this.glFramebufferWrappers,n),t(this.glProgramWrappers,n),t(this.glAttribLocationWrappers,n),t(this.glUniformLocationWrappers,n),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,console&&console.warn("WebGL Context restored. Renderer running again."),this.emit(a.RESTORE_WEBGL,this),e.preventDefault()}},createTemporaryTextures:function(){for(var t=this.gl,e=0;e<this.maxTextures;e++){var i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(e)}},captureFrame:function(t,e){},captureNextFrame:function(){},getFps:function(){},log:function(){},startCapture:function(t,e,i){},stopCapture:function(){},onCapture:function(t){},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},beginCapture:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var i=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),i.viewport(0,0,t,e),this.drawingBufferHeight=i.drawingBufferHeight,i.scissor(0,i.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(a.RESIZE,t,e),this},getCompressedTextures:function(){var t="WEBGL_compressed_texture_",e="WEBKIT_"+t,i=function(i,n){var s=i.getExtension(t+n)||i.getExtension(e+n)||i.getExtension("EXT_texture_compression_"+n);if(s){var r={};for(var a in s)r[s[a]]=a;return r}},n=this.gl;return{ETC:i(n,"etc"),ETC1:i(n,"etc1"),ATC:i(n,"atc"),ASTC:i(n,"astc"),BPTC:i(n,"bptc"),RGTC:i(n,"rgtc"),PVRTC:i(n,"pvrtc"),S3TC:i(n,"s3tc"),S3TCSRGB:i(n,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(t,e){var i=this.compression[t.toUpperCase()];if(e in i)return i[e]},supportsCompressedTexture:function(t,e){var i=this.compression[t.toUpperCase()];return!!i&&(!e||e in i)},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return t===this.projectionWidth&&e===this.projectionHeight||(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=[t,e,i,n];return this.scissorStack.push(r),this.setScissor(t,e,i,n,s),this.currentScissor=r,r},setScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=this.gl,a=this.currentScissor,o=i>0&&n>0;if(a&&o){var h=a[0],l=a[1],u=a[2],c=a[3];o=h!==t||l!==e||u!==i||c!==n}o&&(this.flush(),r.scissor(t,s-e-n,i,n))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var i=e[0],n=e[1],s=e[2],r=e[3];s>0&&r>0&&t.scissor(i,this.drawingBufferHeight-n-r,s,r)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){void 0===e&&(e=!1);var i=this.gl,n=this.blendModes[t];return!!(e||t!==s.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),i.enable(i.BLEND),i.blendEquation(n.equation),n.func.length>2?i.blendFuncSeparate(n.func[0],n.func[1],n.func[2],n.func[3]):i.blendFunc(n.func[0],n.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,i){return this.blendModes[t]&&(this.blendModes[t].func=e,i&&(this.blendModes[t].equation=i)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},pushFramebuffer:function(t,e,i,n,s){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,i,n,s))},setFramebuffer:function(t,e,i,n,s){if(void 0===e&&(e=!1),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===s&&(s=!1),t===this.currentFramebuffer)return this;var r=this.gl,a=this.width,o=this.height;return t&&t.renderTexture&&i?(a=t.renderTexture.width,o=t.renderTexture.height):this.flush(),t?r.bindFramebuffer(r.FRAMEBUFFER,t.webGLFramebuffer):r.bindFramebuffer(r.FRAMEBUFFER,null),i&&r.viewport(0,0,a,o),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.webGLTexture,0),s&&(r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)),e&&(t?(this.drawingBufferHeight=o,this.pushScissor(0,0,a,o)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,this},popFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack;i.pop();var n=i[i.length-1];return n||(n=null),this.setFramebuffer(n,t,e),n},restoreFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack,n=i[i.length-1];n||(n=null),this.currentFramebuffer=null,this.setFramebuffer(n,t,e)},setProgram:function(t){return t!==this.currentProgram&&(this.flush(),this.gl.useProgram(t.webGLProgram),this.currentProgram=t,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(t,e,i,n,r){void 0===r&&(r=!1);var a=this.gl,h=a.NEAREST,l=a.NEAREST,u=a.CLAMP_TO_EDGE;e=t?t.width:e,i=t?t.height:i;var c=o(e,i);if(c&&!r&&(u=a.REPEAT),n===s.ScaleModes.LINEAR&&this.config.antialias){var d=t&&t.compressed,f=!d&&c||d&&t.mipmaps.length>1;h=this.mipmapFilter&&f?this.mipmapFilter:a.LINEAR,l=a.LINEAR}return t||"number"!=typeof e||"number"!=typeof i?this.createTexture2D(0,h,l,u,u,a.RGBA,t):this.createTexture2D(0,h,l,u,u,a.RGBA,null,e,i)},createTexture2D:function(t,e,i,n,s,r,a,o,h,l,u,c){"number"!=typeof o&&(o=a?a.width:1),"number"!=typeof h&&(h=a?a.height:1);var d=new y(this.gl,t,e,i,n,s,r,a,o,h,l,u,c);return this.glTextureWrappers.push(d),d},createFramebuffer:function(t,e,i,n){this.currentFramebuffer=null;var s=new x(this.gl,t,e,i,n);return this.glFramebufferWrappers.push(s),s},beginBitmapMask:function(t,e){this.gl&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==t&&(this.currentMask.mask=t,this.currentMask.camera=e))},drawBitmapMask:function(t,e,i){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),t.renderWebGL(this,t,e),this.maskSource.unbind(!0),this.maskTarget.unbind();var n=this.gl,s=this.getCurrentStencilMask();s?(n.enable(n.STENCIL_TEST),s.mask.applyStencil(this,s.camera,!0)):this.currentMask.mask=null,this.pipelines.set(i),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.maskTarget.texture.webGLTexture),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(t,e){var i=new m(this.gl,t,e);return this.glProgramWrappers.push(i),i},createVertexBuffer:function(t,e){var i=this.gl,n=new v(i,t,i.ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},createAttribLocation:function(t,e){var i=new w(this.gl,t,e);return this.glAttribLocationWrappers.push(i),i},createUniformLocation:function(t,e){var i=new b(this.gl,t,e);return this.glUniformLocationWrappers.push(i),i},createIndexBuffer:function(t,e){var i=this.gl,n=new v(i,t,i.ELEMENT_ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},deleteTexture:function(t){if(t)return e(this.glTextureWrappers,t),t.destroy(),this},deleteFramebuffer:function(t){return t?(e(this.fboStack,t),e(this.glFramebufferWrappers,t),t.destroy(),this):this},deleteProgram:function(t){return t&&(e(this.glProgramWrappers,t),t.destroy()),this},deleteAttribLocation:function(t){return t&&(e(this.glAttribLocationWrappers,t),t.destroy()),this},deleteUniformLocation:function(t){return t&&(e(this.glUniformLocationWrappers,t),t.destroy()),this},deleteBuffer:function(t){return t?(e(this.glBufferWrappers,t),t.destroy(),this):this},preRenderCamera:function(t){var e=t.x,n=t.y,s=t.width,r=t.height,a=t.backgroundColor;(t.emit(i.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,n,s,r),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),a.alphaGL>0)&&this.pipelines.setMulti().drawFillRect(e,n,s,r,p.getTintFromFloats(a.blueGL,a.greenGL,a.redGL,1),a.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,i=this.currentCameraMask;return e.length>0?t=e[e.length-1]:i.mask&&i.mask.isStencil&&(t=i),t},postRenderCamera:function(t){var e=t.flashEffect,n=t.fadeEffect;if(e.isRunning||n.isRunning||n.isComplete){var s=this.pipelines.setMulti();e.postRenderWebGL(s,p.getTintFromFloats),n.postRenderWebGL(s,p.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(i.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.emit(a.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(a.PRE_RENDER)}},render:function(t,e,i){if(!this.contextLost){var n=e.length;if(this.emit(a.RENDER,t,i),this.preRenderCamera(i),0===n)return this.setBlendMode(s.BlendModes.NORMAL),void this.postRenderCamera(i);this.currentType="";for(var r=this.currentMask,o=0;o<n;o++){this.finalType=o===n-1;var h=e[o],l=h.mask;(r=this.currentMask).mask&&r.mask!==l&&r.mask.postRenderWebGL(this,r.camera),l&&r.mask!==l&&l.preRenderWebGL(this,h,i),h.blendMode!==this.currentBlendMode&&this.setBlendMode(h.blendMode);var u=h.type;u!==this.currentType&&(this.newType=!0,this.currentType=u),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[o+1].type===this.currentType,h.renderWebGL(this,h,i),this.newType=!1}(r=this.currentMask).mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(s.BlendModes.NORMAL),this.postRenderCamera(i)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(a.POST_RENDER);var t=this.snapshotState;t.callback&&(g(this.gl,t),t.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var t=this.gl,e=this.getCurrentStencilMask();if(e){var i=e.mask;t.enable(t.STENCIL_TEST),i.invertAlpha?t.stencilFunc(t.NOTEQUAL,i.level,255):t.stencilFunc(t.EQUAL,i.level,255)}},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=i,o.height=n,this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,i,n,s,r,a,o,h,l,u){void 0===s&&(s=!1),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=e),void 0===h&&(h=i),"pixel"===l&&(s=!0,l="image/png");var c=this.currentFramebuffer;this.snapshotArea(r,a,o,h,n,l,u);var d=this.snapshotState;return d.getPixel=s,d.isFramebuffer=!0,d.bufferWidth=e,d.bufferHeight=i,d.width=Math.min(d.width,e),d.height=Math.min(d.height,i),this.setFramebuffer(t),g(this.gl,d),this.setFramebuffer(c),d.callback=null,d.isFramebuffer=!1,this},canvasToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.width,l=t.height,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!1,n)},createCanvasTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.canvasToTexture(t,null,e,i)},updateCanvasTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.canvasToTexture(t,e,n,i)},videoToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.videoWidth,l=t.videoHeight,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!0,n)},createVideoTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.videoToTexture(t,null,e,i)},updateVideoTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.videoToTexture(t,e,n,i)},createUint8ArrayTexture:function(t,e,i){var n=this.gl,s=n.NEAREST,r=n.NEAREST,a=n.CLAMP_TO_EDGE;return o(e,i)&&(a=n.REPEAT),this.createTexture2D(0,s,r,a,a,n.RGBA,t,e,i)},setTextureFilter:function(t,e){var i=this.gl,n=0===e?i.LINEAR:i.NEAREST;i.activeTexture(i.TEXTURE0);var s=i.getParameter(i.TEXTURE_BINDING_2D);return i.bindTexture(i.TEXTURE_2D,t.webGLTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n),t.minFilter=n,t.magFilter=n,s&&i.bindTexture(i.TEXTURE_2D,s),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var e=function(t){t.destroy()};t(this.glAttribLocationWrappers,e),t(this.glBufferWrappers,e),t(this.glFramebufferWrappers,e),t(this.glProgramWrappers,e),t(this.glTextureWrappers,e),t(this.glUniformLocationWrappers,e),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}});return RC=T}function NH(){if(FC)return OC;FC=1;var t=pW(),e=ou(),i=eh(),n=hu();return OC=function(s){var r=s.config;if((r.customEnvironment||r.canvas)&&r.renderType===i.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!r.customEnvironment&&!r.canvas&&r.renderType!==i.HEADLESS)if(r.renderType===i.AUTO&&(r.renderType=n.webGL?i.WEBGL:i.CANVAS),r.renderType===i.WEBGL){if(!n.webGL)throw new Error("Cannot create WebGL context, aborting.")}else{if(r.renderType!==i.CANVAS)throw new Error("Unknown value for renderer type: "+r.renderType);if(!n.canvas)throw new Error("Cannot create Canvas context, aborting.")}r.antialias||e.disableSmoothing();var a,o,h=s.scale.baseSize,l=h.width,u=h.height;(r.canvas?(s.canvas=r.canvas,s.canvas.width=l,s.canvas.height=u):s.canvas=e.create(s,l,u,r.renderType),r.canvasStyle&&(s.canvas.style=r.canvasStyle),r.antialias||t.setCrisp(s.canvas),r.renderType!==i.HEADLESS)&&(a=xW(),o=BH(),r.renderType===i.WEBGL?s.renderer=new o(s):(s.renderer=new a(s),s.context=s.renderer.gameContext))}}function zH(){if(IC)return DC;IC=1;var t=Kh(),e=qh(),i=new t({initialize:function(){this.isRunning=!1,this.callback=e,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var t=this;this.step=function e(i){t.callback(i),t.isRunning&&(t.timeOutID=window.requestAnimationFrame(e))},this.stepTimeout=function e(){t.isRunning&&(t.timeOutID=window.setTimeout(e,t.delay)),t.callback(window.performance.now())}},start:function(t,e,i){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.delay=i,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=e}});return DC=i}function UH(){if(BC)return kC;BC=1;var t=Kh();Vl();var e=qh();zH();var i=new t({initialize:function(t,i){this.game=t,this.rafId=null,this.started=!1,this.running=!1,this.callback=e,this.lastTime=0},start:function(t){if(this.started)return this;this.started=!0,this.running=!0,this.callback=t,this.lastTime=performance.now(),this.rafId=requestAnimationFrame(this.tick.bind(this))},tick:function(t){var e=t-this.lastTime;this.callback(t,e),this.lastTime=t,this.rafId=requestAnimationFrame(this.tick.bind(this))},stop:function(){this.running&&(cancelAnimationFrame(this.rafId),this.running=!1)},destroy:function(){this.stop()}});return kC=i}function YH(){if(zC)return NC;zC=1;var t=pX();return NC=function(e){var i,n=e.events;if(void 0!==document.hidden)i="visibilitychange";else{["webkit","moz","ms"].forEach(function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},i=t+"visibilitychange")})}i&&document.addEventListener(i,function(e){document.hidden||"pause"===e.type?n.emit(t.HIDDEN):n.emit(t.VISIBLE)},!1),window.onblur=function(){n.emit(t.BLUR)},window.onfocus=function(){n.emit(t.FOCUS)},window.focus&&e.config.autoFocus&&window.focus()}}function XH(){return GC?XC:(GC=1,XC={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"})}function GH(){if(HC)return WC;HC=1;var t=XH(),e=ou(),i=Vl();return WC=function(n){var s=i(n,"data",[]),r=i(n,"canvas",null),a=i(n,"palette",t),o=i(n,"pixelWidth",1),h=i(n,"pixelHeight",o),l=i(n,"resizeCanvas",!0),u=i(n,"clearCanvas",!0),c=i(n,"preRender",null),d=i(n,"postRender",null),f=Math.floor(Math.abs(s[0].length*o)),p=Math.floor(Math.abs(s.length*h));r||(r=e.create2D(this,f,p),l=!1,u=!1),l&&(r.width=f,r.height=p);var g=r.getContext("2d",{willReadFrequently:!0});u&&g.clearRect(0,0,f,p),c&&c(r,g);for(var v=0;v<s.length;v++)for(var m=s[v],y=0;y<m.length;y++){var x=m[y];"."!==x&&" "!==x&&(g.fillStyle=a[x],g.fillRect(y*o,v*h,o,h))}return d&&d(r,g),r},WC}function WH(){if(rA)return sA;rA=1;var t=Ju(),e=il();return sA=function(i,n){if(void 0===n&&(n=new t),0===i.length)return n;for(var s,r,a,o=Number.MAX_VALUE,h=Number.MAX_VALUE,l=e.MIN_SAFE_INTEGER,u=e.MIN_SAFE_INTEGER,c=0;c<i.length;c++)s=i[c],Array.isArray(s)?(r=s[0],a=s[1]):(r=s.x,a=s.y),o=Math.min(o,r),h=Math.min(h,a),l=Math.max(l,r),u=Math.max(u,a);return n.x=o,n.y=h,n.width=l-o,n.height=u-h,n}}function HH(){if(oA)return aA;oA=1;var t=Kh(),e=WH(),i=Ju(),n=qu(),s=new t({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new n,this._tmpVec2B=new n},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,n){t||(t=new i),void 0===n&&(n=16);var s=this.getLength();n>s&&(n=s/2);var r=Math.max(1,Math.round(s/n));return e(this.getSpacedPoints(r),t)},getDistancePoints:function(t){var e=this.getLength(),i=Math.max(1,e/t);return this.getSpacedPoints(i)},getEndPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i=[],n=this.getPoint(0,this._tmpVec2A),s=0;i.push(0);for(var r=1;r<=t;r++)s+=(e=this.getPoint(r/t,this._tmpVec2B)).distance(n),i.push(s),n.copy(e);return this.cacheArcLengths=i,i},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++)i.push(this.getPoint(n/t));return i},getRandomPoint:function(t){return void 0===t&&(t=new n),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++){var s=this.getUtoTmapping(n/t,null,t);i.push(this.getPoint(s))}return i},getStartPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new n);var i=1e-4,s=t-i,r=t+i;return s<0&&(s=0),r>1&&(r=1),this.getPoint(s,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var i=this.getUtoTmapping(t);return this.getTangent(i,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,i){var n,s=this.getLengths(i),r=0,a=s.length;n=e?Math.min(e,s[a-1]):t*s[a-1];for(var o,h=0,l=a-1;h<=l;)if((o=s[r=Math.floor(h+(l-h)/2)]-n)<0)h=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(s[r=l]===n)return r/(a-1);var u=s[r];return(r+(n-u)/(s[r+1]-u))/(a-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});return aA=s}function VH(){if(lA)return hA;lA=1;var t=Kh(),e=EG(),i=HH(),n=qu(),s=new t({Extends:i,initialize:function(t,e,s,r){i.call(this,"CubicBezierCurve"),Array.isArray(t)&&(r=new n(t[6],t[7]),s=new n(t[4],t[5]),e=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=e,this.p2=s,this.p3=r},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,i){void 0===i&&(i=new n);var s=this.p0,r=this.p1,a=this.p2,o=this.p3;return i.set(e(t,s.x,r.x,a.x,o.x),e(t,s.y,r.y,a.y,o.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]),o=new n(e[6],e[7]);return new s(i,r,a,o)},hA=s}function jH(){if(cA)return uA;cA=1;var t=Kh(),e=HH(),i=ac(),n=Vl(),s=JG(),r=qu(),a=new t({Extends:e,initialize:function(t,s,a,o,h,l,u,c){if("object"==typeof t){var d=t;t=n(d,"x",0),s=n(d,"y",0),a=n(d,"xRadius",0),o=n(d,"yRadius",a),h=n(d,"startAngle",0),l=n(d,"endAngle",360),u=n(d,"clockwise",!1),c=n(d,"rotation",0)}else void 0===o&&(o=a),void 0===h&&(h=0),void 0===l&&(l=360),void 0===u&&(u=!1),void 0===c&&(c=0);e.call(this,"EllipseCurve"),this.p0=new r(t,s),this._xRadius=a,this._yRadius=o,this._startAngle=i(h),this._endAngle=i(l),this._clockwise=u,this._rotation=i(c)},getStartPoint:function(t){return void 0===t&&(t=new r),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new r);for(var i=2*Math.PI,n=this._endAngle-this._startAngle,s=Math.abs(n)<Number.EPSILON;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(n=s?0:i),this._clockwise&&!s&&(n===i?n=-i:n-=i);var a=this._startAngle+t*n,o=this.p0.x+this._xRadius*Math.cos(a),h=this.p0.y+this._yRadius*Math.sin(a);if(0!==this._rotation){var l=Math.cos(this._rotation),u=Math.sin(this._rotation),c=o-this.p0.x,d=h-this.p0.y;o=c*l-d*u+this.p0.x,h=c*u+d*l+this.p0.y}return e.set(o,h)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return s(this._startAngle)},set:function(t){this._startAngle=i(t)}},endAngle:{get:function(){return s(this._endAngle)},set:function(t){this._endAngle=i(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return s(this._rotation)},set:function(t){this._rotation=i(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:s(this._startAngle),endAngle:s(this._endAngle),clockwise:this._clockwise,rotation:s(this._rotation)}}});return a.fromJSON=function(t){return new a(t)},uA=a}function qH(){if(fA)return dA;fA=1;var t=Kh(),e=HH(),i=WH(),n=Ju(),s=qu(),r=new t({Extends:e,initialize:function(t,i){e.call(this,"LineCurve"),Array.isArray(t)&&(i=new s(t[2],t[3]),t=new s(t[0],t[1])),this.p0=t,this.p1=i,this.arcLengthDivisions=1},getBounds:function(t){return void 0===t&&(t=new n),i([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new s),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new s),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(t,e){return void 0===e&&(e=new s),e.copy(this.p1).subtract(this.p0).normalize(),e},getUtoTmapping:function(t,e,i){var n;if(e){var s=this.getLengths(i),r=s[s.length-1];n=Math.min(e,r)/r}else n=t;return n},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});return r.fromJSON=function(t){var e=t.points,i=new s(e[0],e[1]),n=new s(e[2],e[3]);return new r(i,n)},dA=r}function KH(){if(gA)return pA;gA=1;var t=Kh(),e=qu(),i=new t({initialize:function(t,i){this.active=!1,this.p0=new e(t,i)},getPoint:function(t,i){return void 0===i&&(i=new e),i.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});return pA=i}function ZH(){if(mA)return vA;mA=1;var t=Kh(),e=HH(),i=CG(),n=qu(),s=new t({Extends:e,initialize:function(t,i,s){e.call(this,"QuadraticBezierCurve"),Array.isArray(t)&&(s=new n(t[4],t[5]),i=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=i,this.p2=s},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new n);var s=this.p0,r=this.p1,a=this.p2;return e.set(i(t,s.x,r.x,a.x),i(t,s.y,r.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]);return new s(i,r,a)},vA=s}function JH(){if(xA)return yA;xA=1;var t=TG(),e=Kh(),i=HH(),n=qu(),s=new e({Extends:i,initialize:function(t){void 0===t&&(t=[]),i.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var i=new n;"number"==typeof t[e]?(i.x=t[e],i.y=t[e+1],e++):Array.isArray(t[e])?(i.x=t[e][0],i.y=t[e][1]):(i.x=t[e].x,i.y=t[e].y),this.points.push(i)}return this},addPoint:function(t,e){var i=new n(t,e);return this.points.push(i),i},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(e,i){void 0===i&&(i=new n);var s=this.points,r=(s.length-1)*e,a=Math.floor(r),o=r-a,h=s[0===a?a:a-1],l=s[a],u=s[a>s.length-2?s.length-1:a+1],c=s[a>s.length-3?s.length-1:a+2];return i.set(t(o,h.x,l.x,u.x,c.x),t(o,h.y,l.y,u.y,c.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});return s.fromJSON=function(t){return new s(t.points)},yA=s}function $H(){if(bA)return wA;bA=1;var t=Kh(),e=VH(),i=jH(),n=ic(),s=qH(),r=KH(),a=ZH(),o=Ju(),h=JH(),l=qu(),u=il(),c=new t({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.defaultDivisions=12,this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new l,this._tmpVec2A=new l,this._tmpVec2B=new l,"object"==typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,i){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,i)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new s(e,t)),this},cubicBezierTo:function(t,i,n,s,r,a){var o,h,u,c=this.getEndPoint();return t instanceof l?(o=t,h=i,u=n):(o=new l(n,s),h=new l(r,a),u=new l(t,i)),this.add(new e(c,o,h,u))},quadraticBezierTo:function(t,e,i,n){var s,r,o=this.getEndPoint();return t instanceof l?(s=t,r=e):(s=new l(i,n),r=new l(t,e)),this.add(new a(o,s,r))},draw:function(t,e){for(var i=0;i<this.curves.length;i++){var n=this.curves[i];n.active&&n.draw(t,e)}return t},ellipseTo:function(t,e,n,s,r,a){var o=new i(0,0,t,e,n,s,r,a),h=this.getEndPoint(this._tmpVec2A),l=o.getStartPoint(this._tmpVec2B);return h.subtract(l),o.x=h.x,o.y=h.y,this.add(o)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var n=0;n<t.curves.length;n++){var r=t.curves[n];switch(r.type){case"LineCurve":this.add(s.fromJSON(r));break;case"EllipseCurve":this.add(i.fromJSON(r));break;case"SplineCurve":this.add(h.fromJSON(r));break;case"CubicBezierCurve":this.add(e.fromJSON(r));break;case"QuadraticBezierCurve":this.add(a.fromJSON(r))}}return this},getBounds:function(t,e){void 0===t&&(t=new o),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var i=new o,n=u.MIN_SAFE_INTEGER,s=u.MIN_SAFE_INTEGER,r=0;r<this.curves.length;r++){var a=this.curves[r];a.active&&(a.getBounds(i,e),t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),n=Math.max(n,i.right),s=Math.max(s,i.bottom))}return t.right=n,t.bottom=s,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0;i<this.curves.length;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getCurveAt:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e)return this.curves[n];n++}return null},getEndPoint:function(t){return void 0===t&&(t=new l),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getPointAt(h,e)}s++}return null},getPoints:function(t,e){t||e||(t=this.defaultDivisions);for(var i,n=[],s=0;s<this.curves.length;s++){var r=this.curves[s];if(r.active)for(var a=r.getResolution(t),o=r.getPoints(a,e),h=0;h<o.length;h++){var l=o[h];i&&i.equals(l)||(n.push(l),i=l)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},getRandomPoint:function(t){return void 0===t&&(t=new l),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new l),t.copy(this.startPoint)},getTangent:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getTangentAt(h,e)}s++}return null},lineTo:function(t,e){t instanceof l?this._tmpVec2B.copy(t):"object"==typeof t?this._tmpVec2B.setFromObject(t):this._tmpVec2B.set(t,e);var i=this.getEndPoint(this._tmpVec2A);return this.add(new s([i.x,i.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new h(t))},moveTo:function(t,e){return t instanceof l?this.add(new r(t.x,t.y)):this.add(new r(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});return n.register("path",function(t,e){return new c(t,e)}),wA=c}function QH(){if(_A)return EA;_A=1;var t=Kh(),e=Ac(),i=tc(),n=ec(),s=new t({Extends:e,initialize:function(t){e.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){e.prototype.destroy.call(this),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("DataManagerPlugin",s,"data"),EA=s}function tV(){if(FA)return OA;FA=1;var t=sh(),e=nh(),i={In:MA?PA:(MA=1,PA={BottomCenter:kh(),BottomLeft:Bh(),BottomRight:Nh(),Center:Uh(),LeftCenter:Yh(),QuickSet:Vh(),RightCenter:Xh(),TopCenter:Gh(),TopLeft:Wh(),TopRight:Hh()}),To:LA?RA:(LA=1,RA={BottomCenter:lh(),BottomLeft:dh(),BottomRight:gh(),LeftBottom:mh(),LeftCenter:wh(),LeftTop:Th(),QuickSet:Mh(),RightBottom:Sh(),RightCenter:Eh(),RightTop:_h(),TopCenter:Ch(),TopLeft:Ah(),TopRight:Ph()})};return i=e(!1,i,t),OA=i}function eV(){if(IA)return DA;IA=1;var t=new(Kh())({initialize:function(t,e,i,n){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),i&&""!==i||(i=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===n&&(n=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=i,this.uniforms=n}});return DA=t}function iV(){if(BA)return kA;BA=1;var t=rh(),e=uh(),i=fh(),n=bh(),s=Ju();return kA=function(r,a){void 0===a&&(a=new s);var o=e(r),h=n(r);return a.x=o,a.y=h,a.width=i(r)-o,a.height=t(r)-h,a}}function nV(){if(zA)return NA;zA=1;return NA=function(t){return t.width*t.originX}}function sV(){if(YA)return UA;YA=1;return UA=function(t){return t.height*t.originY}}function rV(){if(HA)return WA;HA=1;return WA=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t},WA}function aV(){if(jA)return VA;jA=1;return VA=function(t,e){void 0===e&&(e="none");return["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(i){t.style[i+"user-select"]=e}),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t},VA}function oV(){if(eP)return tP;eP=1;return tP=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},tP}function hV(){if(nP)return iP;nP=1;return iP=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}}function lV(){if(gP)return pP;gP=1;var t=PX();return t.ColorSpectrum=function(){if(JA)return ZA;JA=1;var t=EX();return ZA=function(e){void 0===e&&(e=1024);var i,n=[],s=255,r=255,a=0,o=0;for(i=0;i<=s;i++)n.push({r:r,g:i,b:o,color:t(r,i,o)});for(a=255,i=s;i>=0;i--)n.push({r:i,g:a,b:o,color:t(i,a,o)});for(r=0,i=0;i<=s;i++,a--)n.push({r:r,g:a,b:i,color:t(r,a,i)});for(a=0,o=255,i=0;i<=s;i++,o--,r++)n.push({r:r,g:a,b:o,color:t(r,a,o)});if(1024===e)return n;var h=[],l=0,u=1024/e;for(i=0;i<e;i++)h.push(n[Math.floor(l)]),l+=u;return h}}(),t.ColorToRGBA=(QA||(QA=1,$A=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}),$A),t.ComponentToHex=oV(),t.GetColor=EX(),t.GetColor32=_X(),t.HexStringToColor=MX(),t.HSLToColor=function(){if(rP)return sP;rP=1;var t=PX(),e=hV();return sP=function(i,n,s){var r=s,a=s,o=s;if(0!==n){var h=s<.5?s*(1+n):s+n-s*n,l=2*s-h;r=e(l,h,i+1/3),a=e(l,h,i),o=e(l,h,i-1/3)}return(new t).setGLTo(r,a,o,1)}}(),t.HSVColorWheel=function(){if(oP)return aP;oP=1;var t=CX();return aP=function(e,i){void 0===e&&(e=1),void 0===i&&(i=1);for(var n=[],s=0;s<=359;s++)n.push(t(s/359,e,i));return n}}(),t.HSVToRGB=CX(),t.HueToComponent=hV(),t.IntegerToColor=LX(),t.IntegerToRGB=RX(),t.Interpolate=function(){if(lP)return hP;lP=1;var t=WX(),e=EX(),i=function(i,n,s,r,a,o,h,l){void 0===h&&(h=100),void 0===l&&(l=0);var u=l/h,c=t(i,r,u),d=t(n,a,u),f=t(s,o,u);return{r:c,g:d,b:f,a:255,color:e(c,d,f)}};return hP={RGBWithRGB:i,ColorWithRGB:function(t,e,n,s,r,a){return void 0===r&&(r=100),void 0===a&&(a=0),i(t.r,t.g,t.b,e,n,s,r,a)},ColorWithColor:function(t,e,n,s){return void 0===n&&(n=100),void 0===s&&(s=0),i(t.r,t.g,t.b,e.r,e.g,e.b,n,s)}},hP}(),t.ObjectToColor=OX(),t.RandomRGB=function(){if(cP)return uP;cP=1;var t=vX(),e=PX();return uP=function(i,n){return void 0===i&&(i=0),void 0===n&&(n=255),new e(t(i,n),t(i,n),t(i,n))}}(),t.RGBStringToColor=FX(),t.RGBToHSV=AX(),t.RGBToString=function(){if(fP)return dP;fP=1;var t=oV();return dP=function(e,i,n,s,r){return void 0===s&&(s=255),void 0===r&&(r="#"),"#"===r?"#"+((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1,7):"0x"+t(s)+t(e)+t(i)+t(n)}}(),t.ValueToColor=DX(),pP=t}function uV(){if(xP)return yP;xP=1;var t=Kh(),e=qh(),i=new t({initialize:function(t,i,n){this._rgb=[0,0,0],this.onChangeCallback=e,this.dirty=!1,this.set(t,i,n)},set:function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._rgb=[t,e,i],this.onChange(),this},equals:function(t,e,i){var n=this._rgb;return n[0]===t&&n[1]===e&&n[2]===i},onChange:function(){this.dirty=!0;var t=this._rgb;this.onChangeCallback.call(this,t[0],t[1],t[2])},r:{get:function(){return this._rgb[0]},set:function(t){this._rgb[0]=t,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(t){this._rgb[1]=t,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(t){this._rgb[2]=t,this.onChange()}},destroy:function(){this.onChangeCallback=null}});return yP=i}function cV(){if(SP)return TP;SP=1;return TP=function(t,e){var i;if(e)"string"==typeof e?i=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(i=e);else if(t.parentElement||null===e)return t;return i||(i=document.body),i.appendChild(t),t},TP}function dV(){if(_P)return EP;_P=1;var t=su();return EP=function(e){if("complete"!==document.readyState&&"interactive"!==document.readyState){var i=function(){document.removeEventListener("deviceready",i,!0),document.removeEventListener("DOMContentLoaded",i,!0),window.removeEventListener("load",i,!0),e()};document.body?t.cordova?document.addEventListener("deviceready",i,!1):(document.addEventListener("DOMContentLoaded",i,!0),window.addEventListener("load",i,!0)):window.setTimeout(i,20)}else e()}}function fV(){if(AP)return CP;AP=1;return CP=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),i={w:0,h:0},n=document.createElement("div");return n.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(n),i.w=90===e?n.offsetHeight:window.innerWidth,i.h=90===e?window.innerWidth:n.offsetHeight,document.documentElement.removeChild(n),n=null,90!==Math.abs(window.orientation)?i.h:i.w}}function pV(){return MP?PP:(MP=1,PP={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3})}function gV(){return LP?RP:(LP=1,RP={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"})}function vV(){return FP?OP:(FP=1,OP={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6})}function mV(){return IP?DP:(IP=1,DP={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1})}function yV(){if(BP)return kP;BP=1;var t={CENTER:pV(),ORIENTATION:gV(),SCALE_MODE:vV(),ZOOM:mV()};return kP=t}function xV(){if(zP)return NP;zP=1;var t=yV();return NP=function(e,i){var n=window.screen,s=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);return s&&"string"==typeof s.type?s.type:"string"==typeof s?s:"number"==typeof window.orientation?0===window.orientation||180===window.orientation?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?t.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?t.ORIENTATION.LANDSCAPE:void 0:i>e?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE}}function wV(){if(YP)return UP;YP=1;return UP=function(t){var e;return""!==t&&("string"==typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e},UP}function bV(){if(GP)return XP;GP=1;return XP=function(t){var e="";try{if(window.DOMParser)e=(new DOMParser).parseFromString(t,"text/xml");else(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null},XP}function TV(){if(HP)return WP;HP=1;return WP=function(t){t.parentNode&&t.parentNode.removeChild(t)}}function SV(){if(jP)return VP;jP=1;var t={AddToDOM:cV(),DOMContentLoaded:dV(),GetInnerHeight:fV(),GetScreenOrientation:xV(),GetTarget:wV(),ParseXML:bV(),RemoveFromDOM:TV(),RequestAnimationFrame:zH()};return VP=t}function EV(){if(KP)return qP;KP=1;var t=Kh(),e=cU(),i=tc(),n=new t({Extends:e,initialize:function(){e.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});return i.register("EventEmitter",n,"events"),qP=n}function _V(){if(eM)return tM;eM=1;return tM={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8}}function CV(){return YR?UR:(YR=1,UR={BOOT:nM?iM:(nM=1,iM="boot"),DESTROY:rM?sM:(rM=1,sM="destroy"),DRAG_END:oM?aM:(oM=1,aM="dragend"),DRAG_ENTER:lM?hM:(lM=1,hM="dragenter"),DRAG:cM?uM:(cM=1,uM="drag"),DRAG_LEAVE:fM?dM:(fM=1,dM="dragleave"),DRAG_OVER:gM?pM:(gM=1,pM="dragover"),DRAG_START:mM?vM:(mM=1,vM="dragstart"),DROP:xM?yM:(xM=1,yM="drop"),GAME_OUT:bM?wM:(bM=1,wM="gameout"),GAME_OVER:SM?TM:(SM=1,TM="gameover"),GAMEOBJECT_DOWN:_M?EM:(_M=1,EM="gameobjectdown"),GAMEOBJECT_DRAG_END:AM?CM:(AM=1,CM="dragend"),GAMEOBJECT_DRAG_ENTER:MM?PM:(MM=1,PM="dragenter"),GAMEOBJECT_DRAG:LM?RM:(LM=1,RM="drag"),GAMEOBJECT_DRAG_LEAVE:FM?OM:(FM=1,OM="dragleave"),GAMEOBJECT_DRAG_OVER:IM?DM:(IM=1,DM="dragover"),GAMEOBJECT_DRAG_START:BM?kM:(BM=1,kM="dragstart"),GAMEOBJECT_DROP:zM?NM:(zM=1,NM="drop"),GAMEOBJECT_MOVE:YM?UM:(YM=1,UM="gameobjectmove"),GAMEOBJECT_OUT:GM?XM:(GM=1,XM="gameobjectout"),GAMEOBJECT_OVER:HM?WM:(HM=1,WM="gameobjectover"),GAMEOBJECT_POINTER_DOWN:jM?VM:(jM=1,VM="pointerdown"),GAMEOBJECT_POINTER_MOVE:KM?qM:(KM=1,qM="pointermove"),GAMEOBJECT_POINTER_OUT:JM?ZM:(JM=1,ZM="pointerout"),GAMEOBJECT_POINTER_OVER:QM?$M:(QM=1,$M="pointerover"),GAMEOBJECT_POINTER_UP:eR?tR:(eR=1,tR="pointerup"),GAMEOBJECT_POINTER_WHEEL:nR?iR:(nR=1,iR="wheel"),GAMEOBJECT_UP:rR?sR:(rR=1,sR="gameobjectup"),GAMEOBJECT_WHEEL:oR?aR:(oR=1,aR="gameobjectwheel"),MANAGER_BOOT:lR?hR:(lR=1,hR="boot"),MANAGER_PROCESS:cR?uR:(cR=1,uR="process"),MANAGER_UPDATE:fR?dR:(fR=1,dR="update"),POINTER_DOWN:gR?pR:(gR=1,pR="pointerdown"),POINTER_DOWN_OUTSIDE:mR?vR:(mR=1,vR="pointerdownoutside"),POINTER_MOVE:xR?yR:(xR=1,yR="pointermove"),POINTER_OUT:bR?wR:(bR=1,wR="pointerout"),POINTER_OVER:SR?TR:(SR=1,TR="pointerover"),POINTER_UP:_R?ER:(_R=1,ER="pointerup"),POINTER_UP_OUTSIDE:AR?CR:(AR=1,CR="pointerupoutside"),POINTER_WHEEL:MR?PR:(MR=1,PR="wheel"),POINTERLOCK_CHANGE:LR?RR:(LR=1,RR="pointerlockchange"),PRE_UPDATE:FR?OR:(FR=1,OR="preupdate"),SHUTDOWN:IR?DR:(IR=1,DR="shutdown"),START:BR?kR:(BR=1,kR="start"),UPDATE:zR?NR:(zR=1,NR="update")})}function AV(){if(GR)return XR;GR=1;return XR={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175}}function PV(){if(HR)return WR;HR=1;var t=Zl(),e=Kh(),i=pX(),n=CV(),s=AV(),r=qh(),a=new e({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=r,this.onKeyUp=r,t.events.once(n.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(i.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}},this.onKeyUp=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,i=0;i<t.length;i++){var n=t[i];"string"==typeof n&&(n=s[n.trim().toUpperCase()]),-1===e.indexOf(n)&&e.push(n)}this.preventDefault=e.length>0},removeCapture:function(e){"string"==typeof e&&(e=e.split(",")),Array.isArray(e)||(e=[e]);for(var i=this.captures,n=0;n<e.length;n++){var r=e[n];"string"==typeof r&&(r=s[r.toUpperCase()]),t(i,r)}this.preventDefault=i.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(i.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});return WR=a}function MV(){if(jR)return VR;jR=1;var t=Kh(),e=hu(),i=CV(),n=qh(),s=new t({initialize:function(t){this.manager=t,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=n,this.onMouseDown=n,this.onMouseUp=n,this.onMouseDownWindow=n,this.onMouseUpWindow=n,this.onMouseOver=n,this.onMouseOut=n,this.onMouseWheel=n,this.pointerLockChange=n,this.isTop=!0,t.events.once(i.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},requestPointerLock:function(){if(e.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){e.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var i=this,n=this.manager,s=n.canvas,r=window&&window.focus&&n.game.config.autoFocus;this.onMouseMove=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseMove(t),i.preventDefaultMove&&t.preventDefault())},this.onMouseDown=function(t){r&&window.focus(),!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseDown(t),i.preventDefaultDown&&t.target===s&&t.preventDefault())},this.onMouseDownWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseDown(t)},this.onMouseUp=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseUp(t),i.preventDefaultUp&&t.target===s&&t.preventDefault())},this.onMouseUpWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseUp(t)},this.onMouseOver=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOver(t)},this.onMouseOut=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOut(t)},this.onMouseWheel=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.onMouseWheel(t),i.preventDefaultWheel&&t.target===s&&t.preventDefault()};var a={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,a),t.addEventListener("mouseout",this.onMouseOut,a),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,a),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,a),window.top.addEventListener("mouseup",this.onMouseUpWindow,a)}catch(t){window.addEventListener("mousedown",this.onMouseDownWindow,a),window.addEventListener("mouseup",this.onMouseUpWindow,a),this.isTop=!1}e.pointerLock&&(this.pointerLockChange=function(t){var e=i.target;i.locked=document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e,n.onPointerLockChange(t)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&((t=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),e.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return VR=s}function RV(){if(KR)return qR;KR=1;var t=KX(),e=Kh(),i=LY(),n=ju(),s=AG(),r=qu(),a=su(),o=new e({initialize:function(t,e){this.manager=t,this.id=e,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new r,this.prevPosition=new r,this.midPoint=new r(-1,-1),this.velocity=new r,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var e=this.position.x,i=this.position.y,r=this.midPoint.x,a=this.midPoint.y;if(e!==r||i!==a){var o=s(this.motionFactor,r,e),h=s(this.motionFactor,a,i);n(o,e,.1)&&(o=e),n(h,i,.1)&&(h=i),this.midPoint.set(o,h);var l=e-o,u=i-h;this.velocity.set(l,u),this.angle=t(o,h,e,i),this.distance=Math.sqrt(l*l+u*u)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),a.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.buttons?0===this.button&&!this.isDown:0===this.button},rightButtonReleased:function(){return 0===this.buttons?2===this.button&&!this.isDown:2===this.button},middleButtonReleased:function(){return 0===this.buttons?1===this.button&&!this.isDown:1===this.button},backButtonReleased:function(){return 0===this.buttons?3===this.button&&!this.isDown:3===this.button},forwardButtonReleased:function(){return 0===this.buttons?4===this.button&&!this.isDown:4===this.button},getDistance:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?t(this.downX,this.downY,this.x,this.y):t(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var i=this.prevPosition.x,n=this.prevPosition.y,r=this.position.x,a=this.position.y,o=0;o<t;o++){var h=1/t*o;e[o]={x:s(h,i,r),y:s(h,n,a)}}return e},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=0===this.id},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});return qR=o}function LV(){if(JR)return ZR;JR=1;var t=Kh(),e=CV(),i=qh(),n=new t({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=i,this.onTouchStartWindow=i,this.onTouchMove=i,this.onTouchEnd=i,this.onTouchEndWindow=i,this.onTouchCancel=i,this.onTouchCancelWindow=i,this.isTop=!0,t.events.once(e.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},startListeners:function(){var t=this.target;if(t){var e=this,i=this.manager,n=i.canvas,s=window&&window.focus&&i.game.config.autoFocus;this.onTouchMove=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchMove(t),e.capture&&t.cancelable&&t.preventDefault())},this.onTouchStart=function(t){s&&window.focus(),!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchStart(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchStartWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchStart(t)},this.onTouchEnd=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchEnd(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchEndWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchEnd(t)},this.onTouchCancel=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchCancel(t),e.capture&&t.preventDefault())},this.onTouchCancelWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&i.onTouchCancel(t)};var r=this.capture,a={passive:!0},o={passive:!1};if(t.addEventListener("touchstart",this.onTouchStart,r?o:a),t.addEventListener("touchmove",this.onTouchMove,r?o:a),t.addEventListener("touchend",this.onTouchEnd,r?o:a),t.addEventListener("touchcancel",this.onTouchCancel,r?o:a),window&&i.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,o),window.top.addEventListener("touchend",this.onTouchEndWindow,o),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,o)}catch(t){window.addEventListener("touchstart",this.onTouchStartWindow,o),window.addEventListener("touchend",this.onTouchEndWindow,o),window.addEventListener("touchcancel",this.onTouchCancelWindow,o),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),window&&((t=this.isTop?window.top:window).removeEventListener("touchstart",this.onTouchStartWindow),t.removeEventListener("touchend",this.onTouchEndWindow),t.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return ZR=n}function OV(){if(QR)return $R;QR=1;var t=Kh(),e=_V(),i=cU(),n=CV(),s=pX(),r=PV(),a=MV(),o=RV(),h=LV(),l=yc(),u=xc(),c=new t({initialize:function(t,e){this.game=t,this.scaleManager,this.canvas,this.config=e,this.enabled=!0,this.events=new i,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new r(this):null,this.mouse=e.inputMouse?new a(this):null,this.touch=e.inputTouch?new h(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers;for(var n=0;n<=this.pointersTotal;n++){var u=new o(this,n);u.smoothFactor=e.inputSmoothFactor,this.pointers.push(u)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new l,this._tempMatrix2=new l,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(s.BOOT,this.boot,this)},boot:function(){var t=this.game,e=t.events;this.canvas=t.canvas,this.scaleManager=t.scale,this.events.emit(n.MANAGER_BOOT),e.on(s.PRE_RENDER,this.preRender,this),e.once(s.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(n.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(n.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,i=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(n.MANAGER_UPDATE);for(var s=0;s<i.length;s++){var r=i[s];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t,e){(e||t&&t.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var i=0;i<t;i++){var n=this.pointers.length,s=new o(this,n);s.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(s),this.pointersTotal++,e.push(s)}return e},updateInputPlugins:function(t,e){var i=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var n=0;n<i.length;n++){var s=i[n];if(s.sys.input)if(s.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip)return}},onTouchStart:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(!o.active){o.touchstart(r,t),this.activePointer=o,n.push(o);break}}this.updateInputPlugins(e.TOUCH_START,n)},onTouchMove:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){var h=document.elementFromPoint(r.clientX,r.clientY)===this.canvas;!this.isOver&&h?this.setCanvasOver(t):this.isOver&&!h&&this.setCanvasOut(t),this.isOver&&(o.touchmove(r,t),this.activePointer=o,n.push(o));break}}this.updateInputPlugins(e.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchend(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_END,n)},onTouchCancel:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchcancel(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_CANCEL,n)},onMouseDown:function(t){var i=this.mousePointer;i.down(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var i=this.mousePointer;i.move(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var i=this.mousePointer;i.up(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var i=this.mousePointer;i.wheel(t),this.activePointer=i,this.updateInputPlugins(e.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(n.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var i=t.input;if(!i||!i.enabled||!t.willRender(e))return!1;var n=!0,s=t.parentContainer;if(s)do{if(!s.willRender(e)){n=!1;break}s=s.parentContainer}while(s);return n},hitTest:function(t,e,i,n){void 0===n&&(n=this._tempHitTest);var s=this._tempPoint,r=i.scrollX,a=i.scrollY;n.length=0;var o=t.x,h=t.y;i.getWorldPoint(o,h,s),t.worldX=s.x,t.worldY=s.y;for(var l={x:0,y:0},c=this._tempMatrix,d=this._tempMatrix2,f=0;f<e.length;f++){var p=e[f];if(this.inputCandidate(p,i)){var g=s.x+r*p.scrollFactorX-r,v=s.y+a*p.scrollFactorY-a;p.parentContainer?(p.getWorldTransformMatrix(c,d),c.applyInverse(g,v,l)):u(g,v,p.x,p.y,p.rotation,p.scaleX,p.scaleY,l),this.pointWithinHitArea(p,l.x,l.y)&&n.push(p)}}return n},pointWithinHitArea:function(t,e,i){e+=t.displayOriginX,i+=t.displayOriginY;var n=t.input;return!(!n||!n.hitAreaCallback(n.hitArea,e,i,t))&&(n.localX=e,n.localY=i,!0)},pointWithinInteractiveObject:function(t,e,i){return!!t.hitArea&&(e+=t.gameObject.displayOriginX,i+=t.gameObject.displayOriginY,t.localX=e,t.localY=i,t.hitAreaCallback(t.hitArea,e,i,t))},transformPointer:function(t,e,i,n){var s=t.position,r=t.prevPosition;r.x=s.x,r.y=s.y;var a=this.scaleManager.transformX(e),o=this.scaleManager.transformY(i),h=t.smoothFactor;n&&0!==h?(s.x=a*h+r.x*(1-h),s.y=o*h+r.y*(1-h)):(s.x=a,s.y=o)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(s.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});return $R=c}function FV(){if(eL)return tL;eL=1;var t={},e={install:function(e){for(var i in t)e[i]=t[i]},register:function(e,i){t[e]=i},destroy:function(){t={}}};return tL=e}function DV(){if(nL)return iL;nL=1;var t=Kh(),e=tc(),i=ec(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectCreator",n,"make"),iL=n}function IV(){if(rL)return sL;rL=1;var t=Kh(),e=pX(),i=cU(),n=FV(),s=DV(),r=ic(),a=jh(),o=tc(),h=Zl(),l=eh(),u=new t({Extends:i,initialize:function(t){i.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted||t.config.renderType===l.HEADLESS?this.boot():t.events.once(e.BOOT,this.boot,this)},boot:function(){var t,i,n,s,r,o,h,l=this.game.config,u=l.installGlobalPlugins;for(u=u.concat(this._pendingGlobal),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),r=a(i,"start",!1),o=a(i,"mapping",null),h=a(i,"data",null),n&&(s?this.install(n,s,r,o,h):console.warn("Missing `plugin` for key: "+n));for(u=(u=l.installScenePlugins).concat(this._pendingScene),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),o=a(i,"mapping",null),n&&(s?this.installScenePlugin(n,s,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(e.DESTROY,this.destroy,this)},addToScene:function(t,e,i){var n,s,r,a=this.game,h=t.scene,l=t.settings.map,u=t.settings.isBooted;for(n=0;n<e.length;n++)a[s=e[n]]?(t[s]=a[s],l.hasOwnProperty(s)&&(h[l[s]]=t[s])):"game"===s&&l.hasOwnProperty(s)&&(h[l[s]]=a);for(var c=0;c<i.length;c++)for(r=i[c],n=0;n<r.length;n++)if(s=r[n],o.hasCore(s)){var d=o.getCore(s),f=d.mapping,p=new d.plugin(h,this,f);t[f]=p,d.custom?h[f]=p:l.hasOwnProperty(f)&&(h[l[f]]=p),u&&p.boot()}for(r=this.plugins,n=0;n<r.length;n++){var g=r[n];g.mapping&&(h[g.mapping]=g.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t=t.concat(this.scenePlugins)},installScenePlugin:function(t,e,i,n,s){if(void 0===s&&(s=!1),"function"==typeof e){if(o.hasCore(t)||o.register(t,e,i,!0),-1===this.scenePlugins.indexOf(t))this.scenePlugins.push(t);else if(!s&&o.hasCore(t))return void console.warn("Scene Plugin key in use: "+t);if(n){var r=new e(n,this,t);n.sys[t]=r,i&&""!==i&&(n[i]=r),r.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,i,n,s){if(void 0===i&&(i=!1),void 0===n&&(n=null),void 0===s&&(s=null),"function"!=typeof e)return console.warn("Invalid Plugin: "+t),null;if(o.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==n&&(i=!0),this.game.isBooted){if(o.registerCustom(t,e,n,s),i)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:i,mapping:n,data:s});return null},getIndex:function(t){for(var e=this.plugins,i=0;i<e.length;i++){if(e[i].key===t)return i}return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var i=this.getEntry(e);return i&&!i.active?(i.active=!0,i.plugin.start()):i||(i=this.createEntry(t,e)),i?i.plugin:null},createEntry:function(t,e){var i=o.getCustom(t);if(i){var n=new i.plugin(this);i={key:e,plugin:n,active:!0,mapping:i.mapping,data:i.data},this.plugins.push(i),n.init(i.data),n.start()}return i},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var i=this.getEntry(t);if(i)return i.plugin;var n=this.getClass(t);return n&&e?(i=this.createEntry(t,t))?i.plugin:null:n||null},getClass:function(t){return o.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&h(this.plugins,e),o.removeCustom(t)},removeScenePlugin:function(t){h(this.scenePlugins,t),o.remove(t)},registerGameObject:function(t,e,i){return e&&r.register(t,e),i&&s.register(t,i),this},removeGameObject:function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),e&&r.remove(t),i&&s.remove(t),this},registerFileType:function(t,e,i){n.register(t,e),i&&i.sys.load&&(i.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();o.destroyCustomPlugins(),this.game.noReturn&&o.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});return sL=u}function kV(){if(oL)return aL;oL=1;var t=tl(),e=Kh(),i=FG(),n=qu(),s=new e({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===s&&(s=null),this._width=t,this._height=e,this._parent=s,this.aspectMode=i,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new n},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(e,i){return void 0===e&&(e=0),void 0===i&&(i=e),this.minWidth=t(e,0,this.maxWidth),this.minHeight=t(i,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(e,i){return void 0===e&&(e=Number.MAX_VALUE),void 0===i&&(i=e),this.maxWidth=t(e,this.minWidth,Number.MAX_VALUE),this.maxHeight=t(i,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case s.NONE:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case s.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case s.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(i(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case s.FIT:this.constrain(t,e,!0);break;case s.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minWidth,this.maxWidth),i&&this._parent&&e>this._parent.width&&(e=Math.max(this.minWidth,this._parent.width)),e},getNewHeight:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minHeight,this.maxHeight),i&&this._parent&&e>this._parent.height&&(e=Math.max(this.minHeight,this._parent.height)),e},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var s=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=i(t,s.x))/this.aspectRatio,s.y>0&&(t=(e=i(e,s.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=i(e,s.y))*this.aspectRatio,s.x>0&&(e=(t=i(t,s.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});return s.NONE=0,s.WIDTH_CONTROLS_HEIGHT=1,s.HEIGHT_CONTROLS_WIDTH=2,s.FIT=3,s.ENVELOP=4,aL=s}function BV(){if(lL)return hL;lL=1;var t=yV(),e=Kh(),i=tl(),n=cU(),s=VX(),r=pX(),a=fV(),o=wV(),h=xV(),l=qh(),u=Ju(),c=kV(),d=FG(),f=qu(),p=HX(),g=new e({Extends:n,initialize:function(e){n.call(this),this.game=e,this.canvas,this.canvasBounds=new u,this.parent=null,this.parentIsWindow=!1,this.parentSize=new c,this.gameSize=new c,this.baseSize=new c,this.displaySize=new c,this.scaleMode=t.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new f(1,1),this.autoRound=!1,this.autoCenter=t.CENTER.NO_CENTER,this.orientation=t.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:l,windowResize:l,fullScreenChange:l,fullScreenError:l}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(r.BOOT,this.boot,this)},boot:function(){var e=this.game;this.canvas=e.canvas,this.fullscreen=e.device.fullscreen;var i=this.scaleMode;i!==t.SCALE_MODE.RESIZE&&i!==t.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(i),i===t.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),e.events.on(r.PRE_STEP,this.step,this),e.events.once(r.READY,this.refresh,this),e.events.once(r.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(e){this.getParent(e),this.getParentBounds();var i=e.width,n=e.height,s=e.scaleMode,r=e.zoom,a=e.autoRound;if("string"==typeof i)if("%"!==i.substr(-1))i=parseInt(i,10);else{var o=this.parentSize.width;0===o&&(o=window.innerWidth);var l=parseInt(i,10)/100;i=Math.floor(o*l)}if("string"==typeof n)if("%"!==n.substr(-1))n=parseInt(n,10);else{var u=this.parentSize.height;0===u&&(u=window.innerHeight);var c=parseInt(n,10)/100;n=Math.floor(u*c)}this.scaleMode=s,this.autoRound=a,this.autoCenter=e.autoCenter,this.resizeInterval=e.resizeInterval,a&&(i=Math.floor(i),n=Math.floor(n)),this.gameSize.setSize(i,n),r===t.ZOOM.MAX_ZOOM&&(r=this.getMaxZoom()),this.zoom=r,1!==r&&(this._resetZoom=!0),this.baseSize.setSize(i,n),a&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),e.minWidth>0&&this.displaySize.setMin(e.minWidth*r,e.minHeight*r),e.maxWidth>0&&this.displaySize.setMax(e.maxWidth*r,e.maxHeight*r),this.displaySize.setSize(i,n),(e.snapWidth>0||e.snapHeight>0)&&this.displaySize.setSnap(e.snapWidth,e.snapHeight),this.orientation=h(i,n)},getParent:function(e){var i=e.parent;if(null!==i){if(this.parent=o(i),this.parentIsWindow=this.parent===document.body,e.expandParent&&e.scaleMode!==t.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}e.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=o(e.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=a(!0));var i=e.width,n=e.height;if(t.width!==i||t.height!==n)return t.setSize(i,n),!0;if(this.canvas){var s=this.canvasBounds,r=this.canvas.getBoundingClientRect();if(r.x!==s.x||r.y!==s.y)return!0}return!1},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e.call(screen,t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var n=this.width,s=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(n,s)},resize:function(t,e){var i=this.zoom,n=this.autoRound;n&&(t=Math.floor(t),e=Math.floor(e));var s=this.width,r=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*i,e*i),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var a=this.canvas.style,o=t*i,h=e*i;return n&&(o=Math.floor(o),h=Math.floor(h)),o===t&&h===e||(a.width=o+"px",a.height=h+"px"),this.refresh(s,r)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displaySize.setSnap(t,e),this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var i=this.game.domContainer;if(i){this.baseSize.setCSS(i);var n=this.canvas.style,r=i.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=n.marginLeft,r.marginTop=n.marginTop}return this.emit(s.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=h(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(s.ORIENTATION_CHANGE,t))}},updateScale:function(){var e,n,s=this.canvas.style,r=this.gameSize.width,a=this.gameSize.height,o=this.zoom,h=this.autoRound;if(this.scaleMode===t.SCALE_MODE.NONE)this.displaySize.setSize(r*o,a*o),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this._resetZoom&&(s.width=e+"px",s.height=n+"px",this._resetZoom=!1);else if(this.scaleMode===t.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this.canvas.width=e,this.canvas.height=n;else if(this.scaleMode===t.SCALE_MODE.EXPAND){var l,u,c=this.game.config.width,d=this.game.config.height,f=this.parentSize.width,p=this.parentSize.height,g=f/c,v=p/d;g<v?(l=c,u=0!==g?p/g:d):(l=0!==v?f/v:c,u=d);var m=i(l,this.displaySize.minWidth,this.displaySize.maxWidth),y=i(u,this.displaySize.minHeight,this.displaySize.maxHeight);this.baseSize.setSize(m,y),this.gameSize.setSize(m,y),h&&(m=Math.floor(m),y=Math.floor(y)),this.canvas.width=m,this.canvas.height=y;var x=f*(m/l),w=p*(y/u);this.displaySize.setSize(x,w),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px"}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=d(this.parentSize.width,this.gameSize.width,0,!0),e=d(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var e=this.autoCenter;if(e!==t.CENTER.NO_CENTER){var i=this.canvas,n=i.style,s=i.getBoundingClientRect(),r=s.width,a=s.height,o=Math.floor((this.parentSize.width-r)/2),h=Math.floor((this.parentSize.height-a)/2);e===t.CENTER.CENTER_HORIZONTALLY?h=0:e===t.CENTER.CENTER_VERTICALLY&&(o=0),n.marginLeft=o+"px",n.marginTop=h+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var i=this.getFullscreenTarget();e.keyboard?i[e.request](Element.ALLOW_KEYBOARD_INPUT):i[e.request](t)}}else this.emit(s.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(s.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(s.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas));return this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(s.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(s.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.domlisteners;if(e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0,t.refresh()},e.windowResize=function(){t.updateBounds(),t.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",e.orientationChange,!1):window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available){e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)};["webkit","moz",""].forEach(function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1)}},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(t,e){t instanceof p||(e=t,t=void 0),void 0===e&&(e=new u);var i,n,s=this.baseSize,r=this.parentSize,a=this.canvasBounds,o=this.displayScale,h=a.x>=0?0:-a.x*o.x,l=a.y>=0?0:-a.y*o.y;return i=r.width>=a.width?s.width:s.width-(a.width-r.width)*o.x,n=r.height>=a.height?s.height:s.height-(a.height-r.height)*o.y,e.setTo(h,l,i,n),t&&(e.width/=t.zoomX,e.height/=t.zoomY,e.centerX=t.centerX+t.scrollX,e.centerY=t.centerY+t.scrollY),e},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",t.orientationChange,!1):window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1);["webkit","moz",""].forEach(function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===t.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===t.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});return hL=g}function NV(){if(cL)return uL;cL=1;return uL={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9}}function zV(){return FL?OL:(FL=1,OL={ADD:fL?dL:(fL=1,dL="addfile"),COMPLETE:gL?pL:(gL=1,pL="complete"),FILE_COMPLETE:mL?vL:(mL=1,vL="filecomplete"),FILE_KEY_COMPLETE:xL?yL:(xL=1,yL="filecomplete-"),FILE_LOAD_ERROR:bL?wL:(bL=1,wL="loaderror"),FILE_LOAD:SL?TL:(SL=1,TL="load"),FILE_PROGRESS:_L?EL:(_L=1,EL="fileprogress"),POST_PROCESS:AL?CL:(AL=1,CL="postprocess"),PROGRESS:ML?PL:(ML=1,PL="progress"),START:LL?RL:(LL=1,RL="start")})}function UV(){if(IL)return DL;IL=1;var t=jh(),e=dY();return DL=function(i){var n=i.game.config.defaultPhysicsSystem,s=t(i.settings,"physics",!1);if(n||s){var r=[];if(n&&r.push(e(n+"Physics")),s)for(var a in s)a=e(a.concat("Physics")),-1===r.indexOf(a)&&r.push(a);return r}}}function YV(){if(BL)return kL;BL=1;var t=jh();return kL=function(e){var i=e.plugins.getDefaultScenePlugins(),n=t(e.settings,"plugins",!1);return Array.isArray(n)?n:i||[]}}function XV(){if(zL)return NL;zL=1;return NL=function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i]=t[i].slice(0):e[i]=t[i];return e}}function GV(){if(YL)return UL;YL=1;var t=XV();return UL=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)||(n[s]=i[s]);return n}}function WV(){if(HL)return WL;HL=1;var t=NV(),e=Vl(),i=GV(),n=function(){if(GL)return XL;GL=1;var t={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter",cameras3d:"cameras3d",facebook:"facebook"};return XL=t}();return WL={create:function(s){return"string"==typeof s?s={key:s}:void 0===s&&(s={}),{status:t.PENDING,key:e(s,"key",""),active:e(s,"active",!1),visible:e(s,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:e(s,"pack",!1),cameras:e(s,"cameras",null),map:e(s,"map",i(n,e(s,"mapAdd",{}))),physics:e(s,"physics",{}),loader:e(s,"loader",{}),plugins:e(s,"plugins",!1),input:e(s,"input",{})}}}}function HV(){if(jL)return VL;jL=1;var t=Kh(),e=NV(),i=qX(),n=ec(),s=UV(),r=YV(),a=qh(),o=WV(),h=new t({initialize:function(t,e){this.scene=t,this.game,this.renderer,this.facebook,this.config=e,this.settings=o.create(e),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=a},init:function(t){this.settings.status=e.INIT,this.sceneUpdate=a,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var o=t.plugins;this.plugins=o,o.addToScene(this,i.Global,[i.CoreScene,r(this),s(this)]),this.events.emit(n.BOOT,this),this.settings.isBooted=!0},step:function(t,e){var i=this.events;i.emit(n.PRE_UPDATE,t,e),i.emit(n.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),i.emit(n.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(n.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(n.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot pause non-running Scene",i.key):this.settings.active&&(i.status=e.PAUSED,i.active=!1,this.events.emit(n.PAUSE,this,t)),this},resume:function(t){var i=this.events,s=this.settings;return this.settings.active||(s.status=e.RUNNING,s.active=!0,i.emit(n.RESUME,this,t)),this},sleep:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot sleep non-running Scene",i.key):(i.status=e.SLEEPING,i.active=!1,i.visible=!1,this.events.emit(n.SLEEP,this,t)),this},wake:function(t){var i=this.events,s=this.settings;return s.status=e.RUNNING,s.active=!0,s.visible=!0,i.emit(n.WAKE,this,t),s.isTransition&&i.emit(n.TRANSITION_WAKE,s.transitionFrom,s.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var t=this.settings.status;return t>e.PENDING&&t<=e.RUNNING},isSleeping:function(){return this.settings.status===e.SLEEPING},isActive:function(){return this.settings.status===e.RUNNING},isPaused:function(){return this.settings.status===e.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var i=this.events,s=this.settings;t&&(s.data=t),s.status=e.START,s.active=!0,s.visible=!0,i.emit(n.START,this),i.emit(n.READY,this,t)},shutdown:function(t){var i=this.events,s=this.settings;i.off(n.TRANSITION_INIT),i.off(n.TRANSITION_START),i.off(n.TRANSITION_COMPLETE),i.off(n.TRANSITION_OUT),s.status=e.SHUTDOWN,s.active=!1,s.visible=!1,i.emit(n.SHUTDOWN,this,t)},destroy:function(){var t=this.events,i=this.settings;i.status=e.DESTROYED,i.active=!1,i.visible=!1,t.emit(n.DESTROY,this),t.removeAllListeners();for(var s=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],r=0;r<s.length;r++)this[s[r]]=null}});return VL=h}function VV(){if(KL)return qL;KL=1;var t=Kh(),e=HV(),i=new t({initialize:function(t){this.sys=new e(this,t),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.facebook,this.scale,this.plugins,this.renderer},update:function(){}});return qL=i}function jV(){if(JL)return ZL;JL=1;var t=Kh(),e=NV(),i=ec(),n=pX(),s=Vl(),r=zV(),a=qh(),o=VV(),h=HV(),l=new t({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)this._pending.push({key:"default",scene:e[i],autoStart:0===i,data:{}})}t.events.once(n.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,i,s;for(this.systemScene=this.createSceneFromInstance("__SYSTEM",new o),this.game.events.emit(n.SYSTEM_READY,this.systemScene,this),t=0;t<this._pending.length;t++){var r;i=(e=this._pending[t]).key,(s=e.scene)instanceof o?r=this.createSceneFromInstance(i,s):"object"==typeof s?r=this.createSceneFromObject(i,s):"function"==typeof s&&(r=this.createSceneFromFunction(i,s)),i=r.sys.settings.key,this.keys[i]=r,this.scenes.push(r),this._data[i]&&(r.sys.settings.data=this._data[i].data,this._data[i].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(i)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(0!==t||0!==e){var i,n;if(t){for(i=0;i<t;i++)n=this._pending[i],this.add(n.key,n.scene,n.autoStart,n.data);for(i=0;i<this._start.length;i++)n=this._start[i],this.start(n);this._start.length=0,this._pending.length=0}for(i=0;i<this._queue.length;i++)this[(n=this._queue[i]).op](n.keyA,n.keyB,n.data);this._queue.length=0}},add:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:i,data:n}),this.isBooted||(this._data[t]={data:n}),null):(t=this.getKey(t,e),e instanceof o?s=this.createSceneFromInstance(t,e):"object"==typeof e?(e.key=t,s=this.createSceneFromObject(t,e)):"function"==typeof e&&(s=this.createSceneFromFunction(t,e)),s.sys.settings.data=n,t=s.sys.settings.key,this.keys[t]=s,this.scenes.push(s),(i||s.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),s);var s},remove:function(t){if(this.isProcessing)return this.queueOp("remove",t);var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var i=this.scenes.indexOf(e),n=e.sys.settings.key;return i>-1&&(delete this.keys[n],this.scenes.splice(i,1),this._start.indexOf(n)>-1&&(i=this._start.indexOf(n),this._start.splice(i,1)),e.sys.destroy()),this},bootScene:function(t){var n,s=t.sys,o=s.settings;s.sceneUpdate=a,t.init&&(t.init.call(t,o.data),o.status=e.INIT,o.isTransition&&s.events.emit(i.TRANSITION_INIT,o.transitionFrom,o.transitionDuration)),s.load&&(n=s.load).reset(),n&&t.preload?(t.preload.call(t),o.status=e.LOADING,n.once(r.COMPLETE,this.loadComplete,this),n.start()):this.create(t)},loadComplete:function(t){this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,i){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var s=this.scenes[n].sys;s.settings.status>e.START&&s.settings.status<=e.RUNNING&&s.step(t,i),s.scenePlugin&&s.scenePlugin._target&&s.scenePlugin.step(t,i)}},render:function(t){for(var i=0;i<this.scenes.length;i++){var n=this.scenes[i].sys;n.settings.visible&&n.settings.status>=e.LOADING&&n.settings.status<e.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var n=t.sys,s=n.settings;t.create&&(s.status=e.CREATING,t.create.call(t,s.data),s.status===e.DESTROYED)||(s.isTransition&&n.events.emit(i.TRANSITION_START,s.transitionFrom,s.transitionDuration),t.update&&(n.sceneUpdate=t.update),s.status=e.RUNNING,n.events.emit(i.CREATE,t))},createSceneFromFunction:function(t,e){var i=new e;if(i instanceof o){var n=i.sys.settings.key;if(""!==n&&(t=n),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return this.createSceneFromInstance(t,i)}return i.sys=new h(i),i.sys.settings.key=t,i.sys.init(this.game),i},createSceneFromInstance:function(t,e){return""===e.sys.settings.key&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var i=new o(e),n=i.sys.settings.key;""!==n?t=n:i.sys.settings.key=t,i.sys.init(this.game);for(var r=["init","preload","create","update","render"],a=0;a<r.length;a++){var h=s(e,r[a],null);h&&(i[r[a]]=h)}if(e.hasOwnProperty("extend"))for(var l in e.extend)if(e.extend.hasOwnProperty(l)){var u=e.extend[l];"data"===l&&i.hasOwnProperty("data")&&"object"==typeof u?i.data.merge(u):"sys"!==l&&(i[l]=u)}return i},getKey:function(t,e){if(t||(t="default"),"function"==typeof e)return t;if(e instanceof o?t=e.sys.settings.key:"object"==typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var i=[],n=this.scenes,s=0;s<n.length;s++){var r=n[s];r&&(!t||t&&r.sys.isActive())&&i.push(r)}return e?i.reverse():i},getScene:function(t){if("string"==typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var i=this.getScene(t);return i&&i.sys.pause(e),this},resume:function(t,e){var i=this.getScene(t);return i&&i.sys.resume(e),this},sleep:function(t,e){var i=this.getScene(t);return i&&!i.sys.isTransitioning()&&i.sys.sleep(e),this},wake:function(t,e){var i=this.getScene(t);return i&&i.sys.wake(e),this},run:function(t,e){var i=this.getScene(t);if(!i){for(var n=0;n<this._pending.length;n++)if(this._pending[n].key===t){this.queueOp("start",t,e);break}return this}i.sys.isSleeping()?i.sys.wake(e):i.sys.isPaused()?i.sys.resume(e):this.start(t,e)},start:function(t,i){if(!this.isBooted)return this._data[t]={autoStart:!0,data:i},this;var n=this.getScene(t);if(!n)return console.warn("Scene key not found: "+t),this;var s,o=n.sys,h=o.settings.status;if(h>=e.START&&h<=e.CREATING)return this;if(h>=e.RUNNING&&h<=e.SLEEPING)o.shutdown(),o.sceneUpdate=a,o.start(i);else if(o.sceneUpdate=a,o.start(i),o.load&&(s=o.load),s&&o.settings.hasOwnProperty("pack")&&(s.reset(),s.addPack({payload:o.settings.pack})))return o.settings.status=e.LOADING,s.once(r.COMPLETE,this.payloadComplete,this),s.start(),this;return this.bootScene(n),this},stop:function(t,i){var n=this.getScene(t);if(n&&!n.sys.isTransitioning()&&n.sys.settings.status!==e.SHUTDOWN){var s=n.sys.load;s&&(s.off(r.COMPLETE,this.loadComplete,this),s.off(r.COMPLETE,this.payloadComplete,this)),n.sys.shutdown(i)}return this},switch:function(t,e,i){var n=this.getScene(t),s=this.getScene(e);return n&&s&&n!==s&&(this.sleep(t),this.isSleeping(e)?this.wake(e,i):this.start(e,i)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)return this.queueOp("bringToTop",t);var e=this.getIndex(t),i=this.scenes;if(-1!==e&&e<i.length){var n=this.getScene(t);i.splice(e,1),i.push(n)}return this},sendToBack:function(t){if(this.isProcessing)return this.queueOp("sendToBack",t);var e=this.getIndex(t);if(-1!==e&&e>0){var i=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(i)}return this},moveDown:function(t){if(this.isProcessing)return this.queueOp("moveDown",t);var e=this.getIndex(t);if(e>0){var i=e-1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveUp:function(t){if(this.isProcessing)return this.queueOp("moveUp",t);var e=this.getIndex(t);if(e<this.scenes.length-1){var i=e+1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveAbove",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n<i){var s=this.getAt(n);this.scenes.splice(n,1),this.scenes.splice(i+(n>i),0,s)}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveBelow",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n>i){var s=this.getAt(n);this.scenes.splice(n,1),0===i?this.scenes.unshift(s):this.scenes.splice(i-(n<i),0,s)}return this},queueOp:function(t,e,i,n){return this._queue.push({op:t,keyA:e,keyB:i,data:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("swapPosition",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(i!==n&&-1!==i&&-1!==n){var s=this.getAt(i);this.scenes[i]=this.scenes[n],this.scenes[n]=s}return this},dump:function(){for(var t=[],i=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var s=this.scenes[n].sys,r=!s.settings.visible||s.settings.status!==e.RUNNING&&s.settings.status!==e.PAUSED?"[-] ":"[*] ";r+=s.settings.key+" ("+i[s.settings.status]+")",t.push(r)}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++){this.scenes[t].sys.destroy()}this.systemScene.sys.destroy(),this.update=a,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});return ZL=l}function qV(){if(QL)return $L;QL=1;var t=ou(),e=Kh(),i=RG(),n=th(),s=FH(),r=new e({initialize:function(t,e,r,a,o){void 0===o&&(o=!1);var h=t.manager.game;this.renderer=h.renderer,this.texture=t,this.source=e,this.image=e.compressed?null:e,this.compressionAlgorithm=e.compressed?e.format:null,this.resolution=1,this.width=r||e.naturalWidth||e.videoWidth||e.width||0,this.height=a||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=n.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type||"DynamicTexture"===e.type,this.isGLTexture=e instanceof s,this.isPowerOf2=i(this.width,this.height),this.glTexture=null,this.flipY=o,this.init(h)},init:function(t){var e=this.renderer;if(e){var i=this.source;if(e.gl){var n=this.image,s=this.flipY,r=this.width,a=this.height,o=this.scaleMode;this.isCanvas?this.glTexture=e.createCanvasTexture(n,!1,s):this.isVideo?this.glTexture=e.createVideoTexture(n,!1,s):this.isRenderTexture?this.glTexture=e.createTextureFromSource(null,r,a,o):this.isGLTexture?this.glTexture=i:this.compressionAlgorithm?this.glTexture=e.createTextureFromSource(i,void 0,void 0,o):i instanceof Uint8Array?this.glTexture=e.createUint8ArrayTexture(i,r,a,o):this.glTexture=e.createTextureFromSource(n,r,a,o),this.glTexture.spectorMetadata={textureKey:this.texture.key}}else this.isRenderTexture&&(this.image=i.canvas)}t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),t===this.flipY||(this.flipY=t,this.update()),this},update:function(){var t=this.renderer,e=this.image,i=this.flipY,n=t.gl;n&&this.isCanvas?t.updateCanvasTexture(e,this.glTexture,i):n&&this.isVideo&&t.updateVideoTexture(e,this.glTexture,i)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&t.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});return $L=r}function KV(){if(eO)return tO;eO=1;var t=Kh(),e=pc(),i=qV(),n='Texture "%s" has no frame "%s"',s=new t({initialize:function(t,e,n,s,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var a=0;a<n.length;a++)this.source.push(new i(this,n[a],s,r))},add:function(t,i,n,s,r,a){if(this.has(t))return null;var o=new e(this,t,i,n,s,r,a);return this.frames[t]=o,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,o},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames.hasOwnProperty(t)},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(n,this.key,t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var i=[];for(var n in this.frames)if("__BASE"!==n||e){var s=this.frames[n];s.sourceIndex===t&&i.push(s)}return i},getFrameBounds:function(t){void 0===t&&(t=0);for(var e=this.getFramesFromTextureSource(t,!0),i=e[0],n=i.cutX,s=i.cutY,r=i.cutX+i.cutWidth,a=i.cutY+i.cutHeight,o=1;o<e.length;o++){var h=e[o];h.cutX<n&&(n=h.cutX),h.cutY<s&&(s=h.cutY),h.cutX+h.cutWidth>r&&(r=h.cutX+h.cutWidth),h.cutY+h.cutHeight>a&&(a=h.cutY+h.cutHeight)}return{x:n,y:s,width:r-n,height:a-s}},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var i=e.indexOf("__BASE");-1!==i&&e.splice(i,1)}return e},getSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(n,this.key,t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e,i=this.frames[t];return i?e=i.sourceIndex:(console.warn(n,this.key,t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new i(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t,e=this.source,i=this.dataSource;for(t=0;t<e.length;t++)e[t]&&e[t].destroy();for(t=0;t<i.length;t++)i[t]&&i[t].destroy();for(var n in this.frames){var s=this.frames[n];s&&s.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});return tO=s}function ZV(){if(nO)return iO;nO=1;var t=Kh(),e=tl(),i=PX(),n=eh(),s=RG(),r=KV(),a=new t({Extends:r,initialize:function(t,e,i,n,s){r.call(this,t,e,i,n,s),this.add("__BASE",0,0,0,n,s),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=n,this.height=s,this.imageData=this.context.getImageData(0,0,n,s),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===n.WEBGL&&this.refresh(),this},draw:function(t,e,i,n){return void 0===n&&(n=!0),this.context.drawImage(i,t,e),n&&this.update(),this},drawFrame:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=!0);var r=this.manager.getFrame(t,e);if(r){var a=r.canvasData,o=r.cutWidth,h=r.cutHeight,l=r.source.resolution;this.context.drawImage(r.source.image,a.x,a.y,o,h,i,n,o/l,h/l),s&&this.update()}return this},setPixel:function(t,e,i,n,s,r){if(void 0===r&&(r=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var a=this.context.getImageData(t,e,1,1);a.data[0]=i,a.data[1]=n,a.data[2]=s,a.data[3]=r,this.context.putImageData(a,t,e)}return this},putData:function(t,e,i,n,s,r,a){return void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=t.width),void 0===a&&(a=t.height),this.context.putImageData(t,e,i,n,s,r,a),this},getData:function(t,i,n,s){return t=e(Math.floor(t),0,this.width-1),i=e(Math.floor(i),0,this.height-1),n=e(n,1,this.width-t),s=e(s,1,this.height-i),this.context.getImageData(t,i,n,s)},getPixel:function(t,e,n){n||(n=new i);var s=this.getIndex(t,e);if(s>-1){var r=this.data,a=r[s+0],o=r[s+1],h=r[s+2],l=r[s+3];n.setTo(a,o,h,l)}return n},getPixels:function(t,n,s,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=s),t=Math.abs(Math.round(t)),n=Math.abs(Math.round(n));for(var a=e(t,0,this.width),o=e(t+s,0,this.width),h=e(n,0,this.height),l=e(n+r,0,this.height),u=new i,c=[],d=h;d<l;d++){for(var f=[],p=a;p<o;p++)u=this.getPixel(p,d,u),f.push({x:p,y:d,color:u.color,alpha:u.alphaGL});c.push(f)}return c},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,i,n,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=!0),this.context.clearRect(t,e,i,n),s&&this.update(),this},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=s(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){r.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});return iO=a}function JV(){if(rO)return sO;rO=1;var t=Qo(),e=HX(),i=ou(),n=Kh(),s=eh(),r=pc(),a=jh(),o=dW(),h=wW(),l=KV(),u=_W(),c=new n({Extends:l,initialize:function(t,n,r,a,u){void 0===r&&(r=256),void 0===a&&(a=256),void 0===u&&(u=!0),this.type="DynamicTexture";var c=t.game.renderer,d=c&&c.type===s.CANVAS,f=d?i.create2D(this,r,a):[this];l.call(this,t,n,f,r,a),this.add("__BASE",0,0,0,r,a),this.renderer=c,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=d?f:null,this.context=d?f.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new e(0,0,r,a).setScene(t.game.scene.systemScene,!1),this.renderTarget=d?null:new h(c,r,a,1,0,!1,!1,!0,!1),this.pipeline=d?null:c.pipelines.get(o.SINGLE_PIPELINE),this.setSize(r,a,u)},setSize:function(t,e,i){void 0===e&&(e=t),void 0===i&&(i=!0),i&&((t=Math.floor(t))%2!=0&&t++,(e=Math.floor(e))%2!=0&&e++);var n=this.get(),s=n.source;if(t!==this.width||e!==this.height){this.canvas&&(this.canvas.width=t,this.canvas.height=e);var r=this.renderTarget;r&&(r.willResize(t,e)&&r.resize(t,e),r.texture!==s.glTexture&&this.renderer.deleteTexture(s.glTexture),this.setFromRenderTarget()),this.camera.setSize(t,e),s.width=t,s.height=e,n.setSize(t,e),this.width=t,this.height=e}else{var a=this.getSourceImage();n.cutX+t>a.width&&(t=a.width-n.cutX),n.cutY+e>a.height&&(e=a.height-n.cutY),n.setSize(t,e,n.cutX,n.cutY)}return this},setFromRenderTarget:function(){var t=this.get().source,e=this.renderTarget;return t.isRenderTexture=!0,t.isGLTexture=!0,t.glTexture=e.texture,this},setIsSpriteTexture:function(t){return this.isSpriteTexture=t,this},fill:function(t,e,i,n,s,r){var a=this.camera,o=this.renderer;void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=this.height);var h=t>>16&255,l=t>>8&255,c=255&t,d=this.renderTarget;if(a.preRender(),d){d.bind(!0);var f=this.pipeline.manager.set(this.pipeline),p=o.width/d.width,g=o.height/d.height,v=d.height-(n+r);f.drawFillRect(i*p,v*g,s*p,r*g,u.getTintFromFloats(c/255,l/255,h/255,1),e),d.unbind(!0)}else{var m=this.context;o.setContext(m),m.globalCompositeOperation="source-over",m.fillStyle="rgba("+h+","+l+","+c+","+e+")",m.fillRect(i,n,s,r),o.setContext()}return this.dirty=!0,this},clear:function(t,e,i,n){if(this.dirty){var s=this.context,r=this.renderTarget;r?r.clear(t,e,i,n):s&&(void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?s.clearRect(t,e,i,n):(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,this.width,this.height),s.restore())),this.dirty=!1}return this},stamp:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0);var r=a(s,"alpha",1),o=a(s,"tint",16777215),h=a(s,"angle",0),l=a(s,"rotation",0),u=a(s,"scale",1),c=a(s,"scaleX",u),d=a(s,"scaleY",u),f=a(s,"originX",.5),p=a(s,"originY",.5),g=a(s,"blendMode",0),v=a(s,"erase",!1),m=a(s,"skipBatch",!1),y=this.manager.resetStamp(r,o);return y.setAngle(0),0!==h?y.setAngle(h):0!==l&&y.setRotation(l),y.setScale(c,d),y.setTexture(t,e),y.setOrigin(f,p),y.setBlendMode(g),v&&(this._eraseMode=!0),m?this.batchGameObject(y,i,n):this.draw(y,i,n),v&&(this._eraseMode=!1),this},erase:function(t,e,i){return this._eraseMode=!0,this.draw(t,e,i),this._eraseMode=!1,this},draw:function(t,e,i,n,s){return this.beginDraw(),this.batchDraw(t,e,i,n,s),this.endDraw(),this},drawFrame:function(t,e,i,n,s,r){return this.beginDraw(),this.batchDrawFrame(t,e,i,n,s,r),this.endDraw(),this},repeat:function(t,e,i,n,s,a,o,h,l){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=1),void 0===h&&(h=16777215),void 0===l&&(l=!1),!(e=t instanceof r?t:this.manager.getFrame(t,e)))return this;var u=this.manager.resetStamp(o,h);u.setFrame(e),u.setOrigin(0);var c=e.width,d=e.height;s=Math.floor(s),a=Math.floor(a);var f=Math.ceil(s/c),p=Math.ceil(a/d),g=f*c-s,v=p*d-a;g>0&&(g=c-g),v>0&&(v=d-v),i<0&&(f+=Math.ceil(Math.abs(i)/c)),n<0&&(p+=Math.ceil(Math.abs(n)/d));var m=i,y=n,x=!1,w=this.manager.stampCrop.setTo(0,0,c,d);l||this.beginDraw();for(var b=0;b<p;b++)if(y+d<0)y+=d;else{for(var T=0;T<f;T++)x=!1,m+c<0||(m<0&&(x=!0,w.width=c+m,w.x=c-w.width),y<0&&(x=!0,w.height=d+y,w.y=d-w.height),g>0&&T===f-1&&(x=!0,w.width=g),v>0&&b===p-1&&(x=!0,w.height=v),x&&u.setCrop(w),this.batchGameObject(u,m,y),u.isCropped=!1,w.setTo(0,0,c,d)),m+=c;m=i,y+=d}return l||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var t=this.camera,e=this.renderer,i=this.renderTarget;t.preRender(),i?e.beginCapture(i.width,i.height):e.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(t,e,i,n,s){return Array.isArray(t)||(t=[t]),this.batchList(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===r&&(r=16777215);var a=this.manager.getFrame(t,e);return a&&(this.renderTarget?this.pipeline.batchTextureFrame(a,i,n,r,s,this.camera.matrix,null):this.batchTextureFrame(a,i,n,s,r)),this},endDraw:function(t){if(void 0===t&&(t=this._eraseMode),this.isDrawing){var e=this.renderer,i=this.renderTarget;if(i){var n=e.endCapture();e.pipelines.setUtility().blitFrame(n,i,1,!1,!1,t,this.isSpriteTexture),e.resetScissor(),e.resetViewport()}else e.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(t,e,i,n,s){var a=t.length;if(0!==a)for(var o=0;o<a;o++){var h=t[o];h&&h!==this&&(h.renderWebGL||h.renderCanvas?this.batchGameObject(h,e,i):h.isParent||h.list?this.batchGroup(h.getChildren(),e,i):"string"==typeof h?this.batchTextureFrameKey(h,null,e,i,n,s):h instanceof r?this.batchTextureFrame(h,e,i,n,s):Array.isArray(h)&&this.batchList(h,e,i,n,s))}},batchGroup:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0;n<t.length;n++){var s=t[n];s.willRender(this.camera)&&this.batchGameObject(s,s.x+e,s.y+i)}},batchGameObject:function(e,i,n){void 0===i&&(i=e.x),void 0===n&&(n=e.y);var s=e.x,r=e.y,a=this.camera,o=this.renderer,h=this._eraseMode,l=e.mask;if(e.setPosition(i,n),this.canvas){if(h){var u=e.blendMode;e.blendMode=t.ERASE}l&&l.preRenderCanvas(o,e,a),e.renderCanvas(o,e,a,null),l&&l.postRenderCanvas(o,e,a),h&&(e.blendMode=u)}else o&&(l&&l.preRenderWebGL(o,e,a),h||o.setBlendMode(e.blendMode),e.renderWebGL(o,e,a),l&&l.postRenderWebGL(o,a,this.renderTarget));e.setPosition(s,r)},batchTextureFrameKey:function(t,e,i,n,s,r){var a=this.manager.getFrame(t,e);a&&this.batchTextureFrame(a,i,n,s,r)},batchTextureFrame:function(t,e,i,n,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=16777215);var r=this.camera.matrix;if(this.renderTarget)this.pipeline.batchTextureFrame(t,e,i,s,n,r,null);else{var a=this.context,o=t.canvasData,h=t.source.image;a.save(),a.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",a.globalAlpha=n,r.setToContext(a),o.width>0&&o.height>0&&a.drawImage(h,o.x,o.y,o.width,o.height,e,i,o.width,o.height),a.restore()}},snapshotArea:function(t,e,i,n,s,r,a){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,s,!1,t,e,i,n,r,a):this.renderer.snapshotCanvas(this.canvas,s,!1,t,e,i,n,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(t,e,i,n){var s=this.manager.resetStamp();s.setTexture(this),s.setOrigin(0),s.renderWebGL(t,s,i,n)},renderCanvas:function(){},destroy:function(){var t=this.manager.stamp;t&&t.texture===this&&this.manager.resetStamp(),l.prototype.destroy.call(this),i.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});return sO=c}function $V(){if(cO)return uO;cO=1;qh();return oO||(oO=1,aO=function(t,e,i,n){i.addToRenderList(e),this.pipeline.batchSprite(e,i,n)}),lO||(lO=1,hO=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),uO={renderWebGL:aO,renderCanvas:hO}}function QV(){if(fO)return dO;fO=1;var t=Kh(),e=_c(),i=fU(),n=$V(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.TextureCrop,e.Tint,e.Transform,e.Visible,n],initialize:function(t,e,n,s,r){i.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(s,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});return dO=s}function tj(){if(gO)return pO;gO=1;return pO=function(t,e,i){if(i.getElementsByTagName("TextureAtlas")){var n=t.source[e];t.add("__BASE",e,0,0,n.width,n.height);for(var s,r=i.getElementsByTagName("SubTexture"),a=0;a<r.length;a++){var o=r[a].attributes,h=o.name.value,l=parseInt(o.x.value,10),u=parseInt(o.y.value,10),c=parseInt(o.width.value,10),d=parseInt(o.height.value,10);if(s=t.add(h,e,l,u,c,d),o.frameX){var f=Math.abs(parseInt(o.frameX.value,10)),p=Math.abs(parseInt(o.frameY.value,10)),g=parseInt(o.frameWidth.value,10),v=parseInt(o.frameHeight.value,10);s.setTrim(c,d,f,p,g,v)}}return t}console.warn("Invalid Texture Atlas XML given")},pO}function ej(){if(mO)return vO;mO=1;return vO=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}}function ij(){if(xO)return yO;xO=1;return yO=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}}function nj(){if(bO)return wO;bO=1;var t=XV();return wO=function(e,i,n){if(n.frames||n.textures){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);for(var r,a=Array.isArray(n.textures)?n.textures[i].frames:n.frames,o=0;o<a.length;o++){var h=a[o];if(r=e.add(h.filename,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+h.filename)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Array")},wO}function sj(){if(SO)return TO;SO=1;var t=XV();return TO=function(e,i,n){if(n.frames){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);var r,a=n.frames;for(var o in a)if(a.hasOwnProperty(o)){var h=a[o];if(r=e.add(o,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+o)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")},TO}function rj(){if(_O)return EO;_O=1;return EO=function(t){var e,i=[171,75,84,88,32,49,49,187,13,10,26,10],n=new Uint8Array(t,0,12);for(e=0;e<n.length;e++)if(n[e]!==i[e])return void console.warn("KTXParser - Invalid file format");var s=Uint32Array.BYTES_PER_ELEMENT,r=new DataView(t,12,13*s),a=67305985===r.getUint32(0,!0);if(0===r.getUint32(1*s,a)){var o=r.getUint32(4*s,a),h=r.getUint32(6*s,a),l=r.getUint32(7*s,a),u=Math.max(1,r.getUint32(11*s,a)),c=r.getUint32(12*s,a),d=new Array(u),f=64+c,p=h,g=l;for(e=0;e<u;e++){var v=new Int32Array(t,f,1)[0];f+=4,d[e]={data:new Uint8Array(t,f,v),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=v}return{mipmaps:d,width:h,height:l,internalFormat:o,compressed:!0,generateMipmap:!1}}console.warn("KTXParser - Only compressed formats supported")},EO}function aj(){if(AO)return CO;function t(t,e,i,n,s,r,a){return void 0===a&&(a=16),Math.floor((t+i)/s)*Math.floor((e+n)/r)*a}function e(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function i(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function n(t,e){return Math.ceil(t/4)*Math.ceil(e/4)*16}function s(e,i){return t(e,i,3,3,4,4,8)}function r(e,i){return t(e,i,3,3,4,4)}AO=1;var a={0:{sizeFunc:e,glFormat:[35841]},1:{sizeFunc:e,glFormat:[35843]},2:{sizeFunc:i,glFormat:[35840]},3:{sizeFunc:i,glFormat:[35842]},6:{sizeFunc:s,glFormat:[36196]},7:{sizeFunc:s,glFormat:[33776,35916]},8:{sizeFunc:r,glFormat:[33777,35917]},9:{sizeFunc:r,glFormat:[33778,35918]},11:{sizeFunc:r,glFormat:[33779,35919]},14:{sizeFunc:n,glFormat:[36494,36495]},15:{sizeFunc:n,glFormat:[36492,36493]},22:{sizeFunc:s,glFormat:[37492,37493]},23:{sizeFunc:r,glFormat:[37496,37497]},24:{sizeFunc:s,glFormat:[37494,37495]},25:{sizeFunc:s,glFormat:[37488]},26:{sizeFunc:r,glFormat:[37490]},27:{sizeFunc:r,glFormat:[37808,37840]},28:{sizeFunc:function(e,i){return t(e,i,4,3,5,4)},glFormat:[37809,37841]},29:{sizeFunc:function(e,i){return t(e,i,4,4,5,5)},glFormat:[37810,37842]},30:{sizeFunc:function(e,i){return t(e,i,5,4,6,5)},glFormat:[37811,37843]},31:{sizeFunc:function(e,i){return t(e,i,5,5,6,6)},glFormat:[37812,37844]},32:{sizeFunc:function(e,i){return t(e,i,7,4,8,5)},glFormat:[37813,37845]},33:{sizeFunc:function(e,i){return t(e,i,7,5,8,6)},glFormat:[37814,37846]},34:{sizeFunc:function(e,i){return t(e,i,7,7,8,8)},glFormat:[37815,37847]},35:{sizeFunc:function(e,i){return t(e,i,9,4,10,5)},glFormat:[37816,37848]},36:{sizeFunc:function(e,i){return t(e,i,9,5,10,6)},glFormat:[37817,37849]},37:{sizeFunc:function(e,i){return t(e,i,9,7,10,8)},glFormat:[37818,37850]},38:{sizeFunc:function(e,i){return t(e,i,9,9,10,10)},glFormat:[37819,37851]},39:{sizeFunc:function(e,i){return t(e,i,11,9,12,10)},glFormat:[37820,37852]},40:{sizeFunc:function(e,i){return t(e,i,11,11,12,12)},glFormat:[37821,37853]}};return CO=function(t){for(var e=new Uint32Array(t,0,13),i=55727696===e[0]?e[2]:e[3],n=e[4],s=a[i].glFormat[n],r=a[i].sizeFunc,o=e[11],h=e[7],l=e[6],u=52+e[12],c=new Uint8Array(t,u),d=new Array(o),f=0,p=h,g=l,v=0;v<o;v++){var m=r(p,g);d[v]={data:new Uint8Array(c.buffer,c.byteOffset+f,m),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=m}return{mipmaps:d,width:h,height:l,internalFormat:s,compressed:!0,generateMipmap:!1}},CO}function oj(){if(MO)return PO;MO=1;var t=jh();return PO=function(e,i,n,s,r,a,o){var h=t(o,"frameWidth",null),l=t(o,"frameHeight",h);if(null===h)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var u=e.source[i];e.add("__BASE",i,0,0,u.width,u.height);var c=t(o,"startFrame",0),d=t(o,"endFrame",-1),f=t(o,"margin",0),p=t(o,"spacing",0),g=Math.floor((r-f+p)/(h+p))*Math.floor((a-f+p)/(l+p));0===g&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",e.key),(c>g||c<-g)&&(c=0),c<0&&(c=g+c),(-1===d||d>g||d<c)&&(d=g);for(var v=f,m=f,y=0,x=0,w=0,b=0;b<g;b++){y=0,x=0;var T=v+h,S=m+l;T>r&&(y=T-r),S>a&&(x=S-a),b>=c&&b<=d&&(e.add(w,i,n+v,s+m,h-y,l-x),w++),(v+=h+p)+h>r&&(v=f,m+=l+p)}return e},PO}function hj(){if(LO)return RO;LO=1;var t=jh();return RO=function(e,i,n){var s=t(n,"frameWidth",null),r=t(n,"frameHeight",s);if(!s)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var a=e.source[0];e.add("__BASE",0,0,0,a.width,a.height),t(n,"startFrame",0),t(n,"endFrame",-1);for(var o,h=t(n,"margin",0),l=t(n,"spacing",0),u=i.cutX,c=i.cutY,d=i.cutWidth,f=i.cutHeight,p=i.realWidth,g=i.realHeight,v=Math.floor((p-h+l)/(s+l)),m=Math.floor((g-h+l)/(r+l)),y=i.x,x=s-y,w=s-(p-d-y),b=i.y,T=r-b,S=r-(g-f-b),E=h,_=h,C=0,A=0;A<m;A++){for(var P=0===A,M=A===m-1,R=0;R<v;R++){var L=0===R,O=R===v-1;if(o=e.add(C,0,u+E,c+_,s,r),L||P||O||M){var F=L?y:0,D=P?b:0,I=0,k=0;L&&(I+=s-x),O&&(I+=s-w),P&&(k+=r-T),M&&(k+=r-S);var B=s-I,N=r-k;o.cutWidth=B,o.cutHeight=N,o.setTrim(s,r,F,D,B,N)}E+=l,E+=L?x:O?w:s,C++}E=h,_+=l,_+=P?T:M?S:r}return e}}function lj(){if(FO)return OO;FO=1;var t=0,e=function(e,i,n,s){var r=t-s.y-s.height;e.add(n,i,s.x,r,s.width,s.height)};return OO=function(i,n,s){var r=i.source[n];i.add("__BASE",n,0,0,r.width,r.height),t=r.height;for(var a=s.split("\n"),o=/^[ ]*(- )*(\w+)+[: ]+(.*)/,h="",l="",u={x:0,y:0,width:0,height:0},c=0;c<a.length;c++){var d=a[c].match(o);if(d){var f="- "===d[1],p=d[2],g=d[3];if(f&&(l!==h&&(e(i,n,l,u),h=l),u={x:0,y:0,width:0,height:0}),"name"!==p)switch(p){case"x":case"y":case"width":case"height":u[p]=parseInt(g,10)}else l=g}}return l!==h&&e(i,n,l,u),i},OO}function uj(){return IO?DO:(IO=1,DO={AtlasXML:tj(),Canvas:ej(),Image:ij(),JSONArray:nj(),JSONHash:sj(),KTXParser:rj(),PVRParser:aj(),SpriteSheet:oj(),SpriteSheetFromAtlas:hj(),UnityYAML:lj()})}function cj(){if(BO)return kO;BO=1;var t=ou(),e=ZV(),i=Kh(),n=PX(),s=eh(),r=JV(),a=cU(),o=yW(),h=pc(),l=pX(),u=GH(),c=Vl(),d=QV(),f=ih(),p=uj(),g=Ju(),v=KV(),m=new i({Extends:a,initialize:function(e){a.call(this),this.game=e,this.name="TextureManager",this.list={},this._tempCanvas=t.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new g,this.silentWarnings=!1,e.events.once(l.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(o.LOAD,this.updatePending,this),this.on(o.ERROR,this.updatePending,this);var t=this.game.config;null!==t.defaultImage&&this.addBase64("__DEFAULT",t.defaultImage),null!==t.missingImage&&this.addBase64("__MISSING",t.missingImage),null!==t.whiteImage&&this.addBase64("__WHITE",t.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(l.DESTROY,this.destroy,this),this.game.events.once(l.SYSTEM_READY,function(t){this.stamp=new d(t).setOrigin(0)},this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(o.LOAD),this.off(o.ERROR),this.emit(o.READY))},checkKey:function(t){return!(!t||"string"!=typeof t||this.exists(t))||(this.silentWarnings||console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"==typeof t){if(!this.exists(t))return this.silentWarnings||console.warn("No texture found matching key: "+t),this;t=this.get(t)}var e=t.key;return this.list.hasOwnProperty(e)&&(t.destroy(),this.emit(o.REMOVE,e),this.emit(o.REMOVE_KEY+e)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var i=this,n=new Image;n.onerror=function(){i.emit(o.ERROR,t)},n.onload=function(){var e=i.create(t,n);e&&(p.Image(e,0),i.emit(o.ADD,t,e),i.emit(o.ADD_KEY+t,e),i.emit(o.LOAD,t,e))},n.src=e}return this},getBase64:function(e,i,n,s){void 0===n&&(n="image/png"),void 0===s&&(s=.92);var r="",a=this.getFrame(e,i);if(a&&(a.source.isRenderTexture||a.source.isGLTexture))this.silentWarnings||console.warn("Cannot getBase64 from WebGL Texture");else if(a){var o=a.canvasData,h=t.create2D(this,o.width,o.height),l=h.getContext("2d",{willReadFrequently:!0});o.width>0&&o.height>0&&l.drawImage(a.source.image,o.x,o.y,o.width,o.height,0,0,o.width,o.height),r=h.toDataURL(n,s),t.remove(h)}return r},addImage:function(t,e,i){var n=null;return this.checkKey(t)&&(n=this.create(t,e),p.Image(n,0),i&&n.setDataSource(i),this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)),n},addGLTexture:function(t,e){var i=null;if(this.checkKey(t)){var n=e.width,s=e.height;(i=this.create(t,e,n,s)).add("__BASE",0,0,0,n,s),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)}return i},addCompressedTexture:function(t,e,i){var n=null;if(this.checkKey(t)){if((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),i){var s=function(t,e,i){Array.isArray(i.textures)||Array.isArray(i.frames)?p.JSONArray(t,e,i):p.JSONHash(t,e,i)};if(Array.isArray(i))for(var r=0;r<i.length;r++)s(n,r,i[r]);else s(n,0,i)}this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)}return n},addRenderTexture:function(t,e){var i=null;return this.checkKey(t)&&((i=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)),i},generate:function(e,i){if(this.checkKey(e)){var n=t.create(this,1,1);return i.canvas=n,u(i),this.addCanvas(e,n)}return null},createCanvas:function(e,i,n){if(void 0===i&&(i=256),void 0===n&&(n=256),this.checkKey(e)){var r=t.create(this,i,n,s.CANVAS,!0);return this.addCanvas(e,r)}return null},addCanvas:function(t,i,n){void 0===n&&(n=!1);var s=null;return n?s=new e(this,t,i,i.width,i.height):this.checkKey(t)&&(s=new e(this,t,i,i.width,i.height),this.list[t]=s,this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addDynamicTexture:function(t,e,i){var n=null;return"string"!=typeof t||this.exists(t)?t=(n=t).key:n=new r(this,t,e,i),this.checkKey(t)?(this.list[t]=n,this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)):n=null,n},addAtlas:function(t,e,i,n){return Array.isArray(i.textures)||Array.isArray(i.frames)?this.addAtlasJSONArray(t,e,i,n):this.addAtlasJSONHash(t,e,i,n)},addAtlasJSONArray:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=1===i.length,a=0;a<s.source.length;a++){var h=r?i[0]:i[a];p.JSONArray(s,a,h)}else p.JSONArray(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasJSONHash:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=0;r<i.length;r++)p.JSONHash(s,r,i[r]);else p.JSONHash(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasXML:function(t,e,i,n){var s=null;return e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.AtlasXML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addUnityAtlas:function(t,e,i,n){var s=null;return e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.UnityYAML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addSpriteSheet:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){var r=s.source[0].width,a=s.source[0].height;p.SpriteSheet(s,0,0,0,r,a,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var i=c(e,"atlas",null),n=c(e,"frame",null);if(i&&n){var s=this.get(i).get(n);if(s){var r=s.source.image;r||(r=s.source.glTexture);var a=this.create(t,r);return s.trimmed?p.SpriteSheetFromAtlas(a,s,e):p.SpriteSheet(a,0,s.cutX,s.cutY,s.cutWidth,s.cutHeight,e),this.emit(o.ADD,t,a),this.emit(o.ADD_KEY+t,a),a}}},addUint8Array:function(t,e,i,n){if(!this.checkKey(t)||e.length/4!==i*n)return null;var s=this.create(t,e,i,n);return s.add("__BASE",0,0,0,i,n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s),s},create:function(t,e,i,n){var s=null;return this.checkKey(t)&&(s=new v(this,t,e,i,n),this.list[t]=s),s},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof v?t:t instanceof h?t.texture:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},parseFrame:function(t){if(t)return"string"==typeof t?this.getFrame(t):Array.isArray(t)&&2===t.length?this.getFrame(t[0],t[1]):f(t)?this.getFrame(t.key,t.frame):t instanceof v?t.get():t instanceof h?t:void 0},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&"__WHITE"!==e&&"__NORMAL"!==e&&t.push(e);return t},getPixel:function(t,e,i,s){var r=this.getFrame(i,s);if(r){t-=r.x,e-=r.y;var a=r.data.cut;if(t+=a.x,e+=a.y,t>=a.x&&t<a.r&&e>=a.y&&e<a.b){var o=this._tempContext;o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1);var h=o.getImageData(0,0,1,1);return new n(h.data[0],h.data[1],h.data[2],h.data[3])}}return null},getPixelAlpha:function(t,e,i,n){var s=this.getFrame(i,n);if(s){t-=s.x,e-=s.y;var r=s.data.cut;if(t+=r.x,e+=r.y,t>=r.x&&t<r.r&&e>=r.y&&e<r.b){var a=this._tempContext;return a.clearRect(0,0,1,1),a.drawImage(s.source.image,t,e,1,1,0,0,1,1),a.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,i){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(i)),t},renameTexture:function(t,e){var i=this.get(t);return!(!i||t===e)&&(i.key=e,this.list[e]=i,delete this.list[t],!0)},each:function(t,e){for(var i=[null],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[0]=this.list[s],t.apply(e,i)},resetStamp:function(t,e){void 0===t&&(t=1),void 0===e&&(e=16777215);var i=this.stamp;return i.setCrop(),i.setPosition(0),i.setAngle(0),i.setScale(1),i.setAlpha(t),i.setTint(e),i.setTexture("__WHITE"),i},destroy:function(){for(var e in this.list)this.list[e].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,t.remove(this._tempCanvas)}});return kO=m}function dj(){if(zO)return NO;zO=1;var t=cV(),e=gX(),i=wX(),n=ou(),s=Kh(),r=fW(),a=function(){if(QP)return $P;QP=1;var t=cV();return $P=function(e){var i=e.config;if(i.parent&&i.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+e.scale.width+"px;","height: "+e.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+i.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),e.domContainer=n,t(n,i.parent)}}}(),o=NH(),h=Ac(),l=pu(),u=dV(),c=cU(),d=pX(),f=OV(),p=tc(),g=IV(),v=BV(),m=jV(),y=yW(),x=cj(),w=UH(),b=YH(),T=new s({initialize:function(t){this.config=new r(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new c,this.anims=new e(this),this.textures=new x(this),this.cache=new i(this),this.registry=new h(this,new c),this.input=new f(this,this.config),this.scene=new m(this,this.config.sceneConfig),this.device=l,this.scale=new v(this,this.config),this.sound=null,this.loop=new w(this,this.config.fps),this.plugins=new g(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,u(this.boot.bind(this))},boot:function(){p.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),o(this),a(this),t(this.canvas,this.config.parent),this.textures.once(y.READY,this.texturesReady,this),this.events.emit(d.BOOT),window&&(window.PHASER_GAME=this)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(d.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),b(this);var t=this.events;t.on(d.HIDDEN,this.onHidden,this),t.on(d.VISIBLE,this.onVisible,this),t.on(d.BLUR,this.onBlur,this),t.on(d.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(d.PRE_STEP,t,e),i.emit(d.STEP,t,e),this.scene.update(t,e),i.emit(d.POST_STEP,t,e);var n=this.renderer;n.preRender(),i.emit(d.PRE_RENDER,n,t,e),this.scene.render(n),n.postRender(),i.emit(d.POST_RENDER,n,t,e)}},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(d.PRE_STEP,t,e),i.emit(d.STEP,t,e),this.scene.update(t,e),i.emit(d.POST_STEP,t,e),this.scene.isProcessing=!1,i.emit(d.PRE_RENDER,null,t,e),i.emit(d.POST_RENDER,null,t,e)}},onHidden:function(){this.loop.pause(),this.events.emit(d.PAUSE)},pause:function(){var t=this.isPaused;this.isPaused=!0,t||this.events.emit(d.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(d.RESUME,this.loop.pauseDuration)},resume:function(){var t=this.isPaused;this.isPaused=!1,t&&this.events.emit(d.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(d.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(n.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});return NO=T}function fj(){if(YO)return UO;YO=1;var t=mu(),e=Kh(),i=qh(),n=gu(),s=new e({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=i,this.removeCallback=i,this._sortKey=""},add:function(e,i){return i?t.Add(this.list,e):t.Add(this.list,e,0,this.addCallback,this)},addAt:function(e,i,n){return n?t.AddAt(this.list,e,i):t.AddAt(this.list,e,i,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,i){return e[t]-i[t]}),n(this.list,e),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i){return t.CountAllMatching(this.list,e,i)},swap:function(e,i){t.Swap(this.list,e,i)},moveTo:function(e,i){return t.MoveTo(this.list,e,i)},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i)},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i)},remove:function(e,i){return i?t.Remove(this.list,e):t.Remove(this.list,e,this.removeCallback,this)},removeAt:function(e,i){return i?t.RemoveAt(this.list,e):t.RemoveAt(this.list,e,this.removeCallback,this)},removeBetween:function(e,i,n){return n?t.RemoveBetween(this.list,e,i):t.RemoveBetween(this.list,e,i,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(e){return t.BringToTop(this.list,e)},sendToBack:function(e){return t.SendToBack(this.list,e)},moveUp:function(e){return t.MoveUp(this.list,e),e},moveDown:function(e){return t.MoveDown(this.list,e),e},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i){return t.Replace(this.list,e,i)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});return UO=s}function pj(){if(GO)return XO;GO=1;var t=Kh(),e=fj(),i=tc(),n=dU(),s=ec();gu();var r=new t({Extends:e,initialize:function(t){e.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.events.once(s.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(n.ADDED_TO_SCENE,t,this.scene),this.events.emit(s.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(n.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(s.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&this.list.sort(this.sortByDepth)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list,e=t.length;e--;)t[e]&&t[e].destroy(!0);t.length=0,this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});return i.register("DisplayList",r,"displayList"),XO=r}function gj(){return KO?qO:(KO=1,qO={PROCESS_QUEUE_ADD:HO?WO:(HO=1,WO="add"),PROCESS_QUEUE_REMOVE:jO?VO:(jO=1,VO="remove")})}function vj(){if(JO)return ZO;JO=1;var t=Kh(),e=cU(),i=gj(),n=new t({Extends:e,initialize:function(){e.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(t){return this._active.indexOf(t)>-1},isPending:function(t){return this._toProcess>0&&this._pending.indexOf(t)>-1},isDestroying:function(t){return this._destroy.indexOf(t)>-1},add:function(t){return this.checkQueue&&this.isActive(t)&&!this.isDestroying(t)||this.isPending(t)||(this._pending.push(t),this._toProcess++),t},remove:function(t){if(this.isPending(t)){var e=this._pending,i=e.indexOf(t);-1!==i&&e.splice(i,1)}else this.isActive(t)&&(this._destroy.push(t),this._toProcess++);return t},removeAll:function(){for(var t=this._active,e=this._destroy,i=t.length;i--;)e.push(t[i]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,s=this._active;for(t=0;t<n.length;t++){e=n[t];var r=s.indexOf(e);-1!==r&&(s.splice(r,1),this.emit(i.PROCESS_QUEUE_REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)e=n[t],(!this.checkQueue||this.checkQueue&&-1===s.indexOf(e))&&(s.push(e),this.emit(i.PROCESS_QUEUE_ADD,e));return n.length=0,this._toProcess=0,s},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});return ZO=n}function mj(){if(QO)return $O;QO=1;var t=Kh(),e=vj(),i=tc(),n=ec(),s=new t({Extends:e,initialize:function(t){e.call(this),this.checkQueue=!0,this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.systems.events.once(n.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(n.PRE_UPDATE,this.update,this),t.on(n.UPDATE,this.sceneUpdate,this),t.once(n.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var i=this._active,n=i.length,s=0;s<n;s++){var r=i[s];r.active&&r.preUpdate.call(r,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(n.PRE_UPDATE,this.update,this),e.off(n.UPDATE,this.sceneUpdate,this),e.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("UpdateList",s,"updateList"),$O=s}function yj(){if(eF)return tF;eF=1;var t=yc(),e=new t,i=new t,n=new t,s={camera:e,sprite:i,calc:n};return tF=function(t,r,a){var o=e,h=i,l=n;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),o.copyFrom(r.matrix),a?(o.multiplyWithOffset(a,-r.scrollX*t.scrollFactorX,-r.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=r.scrollX*t.scrollFactorX,h.f-=r.scrollY*t.scrollFactorY),o.multiply(h,l),s},tF}function xj(){if(nF)return iF;nF=1;var t=cW(),e=Vl();return iF=function(i,n,s){var r=e(i,n,null);if(null===r)return s;if(Array.isArray(r))return t.RND.pick(r);if("object"==typeof r){if(r.hasOwnProperty("randInt"))return t.RND.integerInRange(r.randInt[0],r.randInt[1]);if(r.hasOwnProperty("randFloat"))return t.RND.realInRange(r.randFloat[0],r.randFloat[1])}else if("function"==typeof r)return r(n);return r}}function wj(){if(rF)return sF;rF=1;var t=Qo(),e=xj();return sF=function(i,n,s){n.x=e(s,"x",0),n.y=e(s,"y",0),n.depth=e(s,"depth",0),n.flipX=e(s,"flipX",!1),n.flipY=e(s,"flipY",!1);var r=e(s,"scale",null);"number"==typeof r?n.setScale(r):null!==r&&(n.scaleX=e(r,"x",1),n.scaleY=e(r,"y",1));var a=e(s,"scrollFactor",null);"number"==typeof a?n.setScrollFactor(a):null!==a&&(n.scrollFactorX=e(a,"x",1),n.scrollFactorY=e(a,"y",1)),n.rotation=e(s,"rotation",0);var o=e(s,"angle",null);null!==o&&(n.angle=o),n.alpha=e(s,"alpha",1);var h=e(s,"origin",null);if("number"==typeof h)n.setOrigin(h);else if(null!==h){var l=e(h,"x",.5),u=e(h,"y",.5);n.setOrigin(l,u)}return n.blendMode=e(s,"blendMode",t.NORMAL),n.visible=e(s,"visible",!0),e(s,"add",!0)&&i.sys.displayList.add(n),n.preUpdate&&i.sys.updateList.add(n),n},sF}function bj(){if(oF)return aF;oF=1;var t=xj();return aF=function(e,i){var n=t(i,"anims",null);if(null===n)return e;if("string"==typeof n)e.anims.play(n);else if("object"==typeof n){var s=e.anims,r=t(n,"key",void 0);if(r){var a=t(n,"startFrame",void 0),o=t(n,"delay",0),h=t(n,"repeat",0),l=t(n,"repeatDelay",0),u=t(n,"yoyo",!1),c=t(n,"play",!1),d=t(n,"delayedPlay",0),f={key:r,delay:o,repeat:h,repeatDelay:l,yoyo:u,startFrame:a};c?s.play(f):d>0?s.playAfterDelay(f,d):s.load(f)}}return e}}function Tj(){if(cF)return uF;function t(t,e){return parseInt(t.getAttribute(e),10)}cF=1;return uF=function(e,i,n,s,r){void 0===n&&(n=0),void 0===s&&(s=0);var a=i.cutX,o=i.cutY,h=i.source.width,l=i.source.height,u=i.sourceIndex,c={},d=e.getElementsByTagName("info")[0],f=e.getElementsByTagName("common")[0];c.font=d.getAttribute("face"),c.size=t(d,"size"),c.lineHeight=t(f,"lineHeight")+s,c.chars={};var p=e.getElementsByTagName("char"),g=void 0!==i&&i.trimmed;if(g)var v=i.height,m=i.width;for(var y=0;y<p.length;y++){var x=p[y],w=t(x,"id"),b=String.fromCharCode(w),T=t(x,"x"),S=t(x,"y"),E=t(x,"width"),_=t(x,"height");g&&(T<m&&(m=T),S<v&&(v=S)),g&&0!==v&&0!==m&&(T-=i.x,S-=i.y);var C=(a+T)/h,A=(o+S)/l,P=(a+T+E)/h,M=(o+S+_)/l;if(c.chars[w]={x:T,y:S,width:E,height:_,centerX:Math.floor(E/2),centerY:Math.floor(_/2),xOffset:t(x,"xoffset"),yOffset:t(x,"yoffset"),xAdvance:t(x,"xadvance")+n,data:{},kerning:{},u0:C,v0:A,u1:P,v1:M},r&&0!==E&&0!==_){var R=r.add(b,u,T,S,E,_);R&&R.setUVs(E,_,C,A,P,M)}}var L=e.getElementsByTagName("kerning");for(y=0;y<L.length;y++){var O=L[y],F=t(O,"first"),D=t(O,"second"),I=t(O,"amount");c.chars[D].kerning[F]=I}return c},uF}function Sj(){if(mF)return vF;mF=1;var t=(gF||(gF=1,pF=function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p){var g=i.x-e.displayOriginX+s,v=i.y-e.displayOriginY+r,m=g+i.w,y=v+i.h,x=a.a,w=a.b,b=a.c,T=a.d,S=a.e,E=a.f,_=g*x+v*b+S,C=g*w+v*T+E,A=g*x+y*b+S,P=g*w+y*T+E,M=m*x+y*b+S,R=m*w+y*T+E,L=m*x+v*b+S,O=m*w+v*T+E;o&&(_=Math.round(_),C=Math.round(C),A=Math.round(A),P=Math.round(P),M=Math.round(M),R=Math.round(R),L=Math.round(L),O=Math.round(O)),t.batchQuad(e,_,C,A,P,M,R,L,O,n.u0,n.v0,n.u1,n.v1,h,l,u,c,d,f,p)}),pF),e=yj(),i=_W();return vF=function(n,s,r,a){if(0!==s._text.length){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline,s),h=e(s,r,a).calc;n.pipelines.preBatch(s);var l,u,c,d=r.roundPixels,f=r.alpha,p=s.charColors,g=s.tintFill,v=i.getTintAppendFloatAlpha,m=v(s.tintTopLeft,f*s._alphaTL),y=v(s.tintTopRight,f*s._alphaTR),x=v(s.tintBottomLeft,f*s._alphaBL),w=v(s.tintBottomRight,f*s._alphaBR),b=s.frame.glTexture,T=o.setGameObject(s),S=s.getTextBounds(!1).characters,E=s.dropShadowX,_=s.dropShadowY;if(0!==E||0!==_){var C=s.dropShadowColor,A=s.dropShadowAlpha,P=v(C,f*A*s._alphaTL),M=v(C,f*A*s._alphaTR),R=v(C,f*A*s._alphaBL),L=v(C,f*A*s._alphaBR);for(l=0;l<S.length;l++)c=(u=S[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height&&t(o,s,u,c,E,_,h,d,P,M,R,L,1,b,T)}for(l=0;l<S.length;l++)if(c=(u=S[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height)if(o.shouldFlush(6)&&(o.flush(),T=o.setGameObject(s)),p[u.i]){var O=p[u.i],F=O.tintEffect,D=v(O.tintTL,f*s._alphaTL),I=v(O.tintTR,f*s._alphaTR),k=v(O.tintBL,f*s._alphaBL),B=v(O.tintBR,f*s._alphaBR);t(o,s,u,c,0,0,h,d,D,I,k,B,F,b,T)}else t(o,s,u,c,0,0,h,d,m,y,x,w,g,b,T);n.pipelines.postBatch(s)}},vF}function Ej(){if(xF)return yF;xF=1;var t=yj();return yF=function(e,i,n,s,r){var a=s.alpha*n.alpha;if(a<=0)return!1;var o=t(n,s,r).calc;return i.globalCompositeOperation=e.blendModes[n.blendMode],i.globalAlpha=a,i.save(),o.setToContext(i),i.imageSmoothingEnabled=n.frame?!n.frame.source.scaleMode:e.antialias,!0},yF}function _j(){if(SF)return TF;SF=1;var t=qh(),e=t,i=t;return e=Sj(),i=function(){if(bF)return wF;bF=1;var t=Ej();return wF=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.fontData.chars,u=i.fontData.lineHeight,c=i._letterSpacing,d=i._lineSpacing,f=0,p=0,g=0,v=null,m=0,y=0,x=0,w=0,b=0,T=0,S=null,E=0,_=h.source.image,C=h.cutX,A=h.cutY,P=i._fontSize/i.fontData.size,M=i._align,R=0,L=0,O=i.getTextBounds(!1);i.maxWidth>0&&(a=(r=O.wrappedText).length);var F=i._bounds.lines;1===M?L=(F.longest-F.lengths[0])/2:2===M&&(L=F.longest-F.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);for(var D=n.roundPixels,I=0;I<a;I++)if(10!==(g=r.charCodeAt(I))){if(v=l[g]){if(m=C+v.x,y=A+v.y,x=v.width,w=v.height,b=v.xOffset+f,T=v.yOffset+p,null!==S){var k=v.kerning[E];b+=void 0!==k?k:0}b*=P,T*=P,b+=L,f+=v.xAdvance+c+(void 0!==k?k:0),S=v,E=g,0!==x&&0!==w&&32!==g&&(D&&(b=Math.round(b),T=Math.round(T)),o.save(),o.translate(b,T),o.scale(P,P),o.drawImage(_,m,y,x,w,0,0,x,w),o.restore())}}else R++,1===M?L=(F.longest-F.lengths[R])/2:2===M&&(L=F.longest-F.lengths[R]),f=0,p+=u+d,S=null;o.restore()}},wF}(),TF={renderWebGL:e,renderCanvas:i}}function Cj(){if(_F)return EF;_F=1;var t=Kh(),e=tl(),i=_c(),n=fU(),s=(lF||(lF=1,hF=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n)return{local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var s,r,a,o=t.text,h=o.length,l=t.maxWidth,u=t.wordWrapCharCode,c=Number.MAX_VALUE,d=Number.MAX_VALUE,f=0,p=0,g=t.fontData.chars,v=t.fontData.lineHeight,m=t.letterSpacing,y=t.lineSpacing,x=0,w=0,b=0,T=null,S=t._align,E=0,_=0,C=t.fontSize/t.fontData.size,A=C*t.scaleX,P=C*t.scaleY,M=null,R=0,L=[],O=Number.MAX_VALUE,F=0,D=0,I=0,k=[],B=[],N=null,z=function(t,e){for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n),r=e.chars[s];r&&(i+=r.xAdvance)}return i*A};if(l>0){a=o.split("\n");var U=[];for(s=0;s<a.length;s++){var Y=a[s],X="",G="",W="",H="";for(r=0;r<Y.length;r++)b=Y.charCodeAt(r),X+=Y[r],(b===u||r===Y.length-1)&&(z(H=W+X,t.fontData)<=l?W=H:(G=G.slice(0,-1),G+=(G?"\n":"")+W,W=X),X="");G=G.slice(0,-1),G+=(G?"\n":"")+W,U.push(G)}o=U.join("\n"),n.wrappedText=o,h=o.length}var V=0;for(s=0;s<h;s++)if(10!==(b=o.charCodeAt(s))){if(T=g[b]){if(E=x,_=w,null!==M){var j=T.kerning[R];E+=void 0!==j?j:0}c>E&&(c=E),d>_&&(d=_);var q=E+T.xAdvance,K=_+v;f<q&&(f=q),p<K&&(p=K);var Z=T.xOffset+T.xAdvance+(void 0!==j?j:0);b===u?null!==N&&(k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),N=null):(null===N&&(N={word:"",i:V,x:x,y:w,w:0,h:v}),N.word=N.word.concat(o[s]),N.w+=Z),B.push({i:V,idx:s,char:o[s],code:b,x:(T.xOffset+E)*C,y:(T.yOffset+w)*C,w:T.width*C,h:T.height*C,t:w*C,r:q*C,b:v*C,line:D,glyph:T}),x+=T.xAdvance+m+(void 0!==j?j:0),M=T,R=b,I=q*C,V++}}else null!==N&&(k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),N=null),M=null,L[D]=I,I>F&&(F=I),I<O&&(O=I),I=0,x=0,w=(v+y)*++D;if(null!==N&&k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),L[D]=I,I>F&&(F=I),I<O&&(O=I),S>0)for(var J=0;J<B.length;J++){var $=B[J];if(1===S){var Q=(F-L[$.line])/2;$.x+=Q,$.r+=Q}else if(2===S){var tt=F-L[$.line];$.x+=tt,$.r+=tt}}var et=n.local,it=n.global;return a=n.lines,et.x=c*C,et.y=d*C,et.width=f*C,et.height=p*C,it.x=t.x-t._displayOriginX+c*A,it.y=t.y-t._displayOriginY+d*P,it.width=f*A,it.height=p*P,a.shortest=O,a.longest=F,a.lengths=L,e&&(et.x=Math.ceil(et.x),et.y=Math.ceil(et.y),et.width=Math.ceil(et.width),et.height=Math.ceil(et.height),it.x=Math.ceil(it.x),it.y=Math.ceil(it.y),it.width=Math.ceil(it.width),it.height=Math.ceil(it.height),a.shortest=Math.ceil(O),a.longest=Math.ceil(F)),i&&(t._displayOriginX=t.originX*et.width,t._displayOriginY=t.originY*et.height,it.x=t.x-t._displayOriginX*t.scaleX,it.y=t.y-t._displayOriginY*t.scaleY,e&&(it.x=Math.ceil(it.x),it.y=Math.ceil(it.y))),n.words=k,n.characters=B,n.lines.height=v,n.scale=C,n.scaleX=t.scaleX,n.scaleY=t.scaleY,n}),hF),r=function(){if(fF)return dF;fF=1;var t=Tj();return dF=function(e,i,n,s,r,a,o){var h=e.sys.textures.get(n),l=h.get(s),u=e.sys.cache.xml.get(r);if(l&&u){var c=t(u,l,a,o,h);return e.sys.cache.bitmapFont.add(i,{data:c,texture:n,frame:s,fromAtlas:!0}),!0}return!1},dF}(),a=Tj(),o=Ju(),h=_j(),l=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Texture,i.Tint,i.Transform,i.Visible,h],initialize:function(t,e,i,r,a,o,h){void 0===a&&(a=""),void 0===h&&(h=0),n.call(this,t,"BitmapText"),this.font=r;var l=this.scene.sys.cache.bitmapFont.get(r);if(!l)throw new Error("Invalid BitmapText key: "+r);this.fontData=l.data,this._text="",this._fontSize=o||this.fontData.size,this._letterSpacing=0,this._lineSpacing=0,this._align=h,this._bounds=s(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.fromAtlas=l.fromAtlas,this.setTexture(l.texture,l.frame),this.setPosition(e,i),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(),this.setText(a)},setLeftAlign:function(){return this._align=l.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=l.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=l.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setLineSpacing:function(t){return void 0===t&&(t=0),this.lineSpacing=t,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=.5),this.dropShadowX=t,this.dropShadowY=e,this.dropShadowColor=i,this.dropShadowAlpha=n,this},setCharacterTint:function(t,i,n,s,r,a,o){void 0===t&&(t=0),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===s&&(s=-1),void 0===r&&(r=s,a=s,o=s);var h=this.text.length;-1===i&&(i=h),t<0&&(t=h+t),t=e(t,0,h-1);for(var l=e(t+i,t,h),u=this.charColors,c=t;c<l;c++){var d=u[c];if(-1===s)u[c]=null;else{var f=n?1:0;d?(d.tintEffect=f,d.tintTL=s,d.tintTR=r,d.tintBL=a,d.tintBR=o):u[c]={tintEffect:f,tintTL:s,tintTR:r,tintBL:a,tintBR:o}}}return this},setWordTint:function(t,e,i,n,s,r,a){void 0===e&&(e=1);for(var o=this.getTextBounds().words,h="number"==typeof t,l=0,u=0;u<o.length;u++){var c=o[u];if((h&&u===t||!h&&c.word===t)&&(this.setCharacterTint(c.i,c.word.length,i,n,s,r,a),++l===e))return this}return this},getTextBounds:function(t){var e=this._bounds;return(this._dirty||t||this.scaleX!==e.scaleX||this.scaleY!==e.scaleY)&&(s(this,t,!0,e),this._dirty=!1),e},getCharacterAt:function(t,e,i){for(var n=this.getLocalPoint(t,e,null,i),s=this.getTextBounds().characters,r=new o,a=0;a<s.length;a++){var h=s[a];if(r.setTo(h.x,h.t,h.r-h.x,h.b),r.contains(n.x,n.y))return h}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(t,e,i){void 0===e&&(e=this._fontSize),void 0===i&&(i=this._align);var n=this.scene.sys.cache.bitmapFont.get(t);return n&&(this.font=t,this.fontData=n.data,this._fontSize=e,this._align=i,this.fromAtlas=!0===n.fromAtlas,this.setTexture(n.texture,n.frame),s(this,!1,!0,this._bounds)),this},setMaxWidth:function(t,e){return this._maxWidth=t,this._dirty=!0,void 0!==e&&(this.wordWrapCharCode=e),this},setDisplaySize:function(t,e){this.setScale(1,1),this.getTextBounds(!1);var i=t/this.width,n=e/this.height;return this.setScale(i,n),this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},lineSpacing:{set:function(t){this._lineSpacing=t,this._dirty=!0},get:function(){return this._lineSpacing}},maxWidth:{set:function(t){this._maxWidth=t,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},displayWidth:{set:function(t){this.setScaleX(1),this.getTextBounds(!1);var e=t/this.width;this.setScaleX(e)},get:function(){return this.width}},displayHeight:{set:function(t){this.setScaleY(1),this.getTextBounds(!1);var e=t/this.height;this.setScaleY(e)},get:function(){return this.height}},toJSON:function(){var t=i.ToJSON(this),e={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineSpacing:this.lineSpacing,align:this.align};return t.data=e,t},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});return l.ALIGN_LEFT=0,l.ALIGN_CENTER=1,l.ALIGN_RIGHT=2,l.ParseFromAtlas=r,l.ParseXMLBitmapFont=a,EF=l}function Aj(){if(LF)return RF;LF=1;var t=qh(),e=t;return e=function(){if(AF)return CF;AF=1;var t=yc(),e=_W(),i=new t;return CF=function(t,n,s,r){var a=n.getRenderList(),o=s.alpha*n.alpha;if(0!==a.length&&0!==o){s.addToRenderList(n);var h=t.pipelines.set(this.pipeline,n),l=s.scrollX*n.scrollFactorX,u=s.scrollY*n.scrollFactorY,c=i.copyFrom(s.matrix);r&&(c.multiplyWithOffset(r,-l,-u),l=0,u=0);var d=n.x-l,f=n.y-u,p=-1,g=s.roundPixels;t.pipelines.preBatch(n);for(var v=0;v<a.length;v++){var m=a[v],y=m.frame,x=m.alpha*o;if(0!==x){var w=y.width,b=y.height,T=d+m.x+y.x,S=f+m.y+y.y;m.flipX&&(w*=-1,T+=y.width),m.flipY&&(b*=-1,S+=y.height);var E=c.setQuad(T,S,T+w,S+b,g),_=e.getTintAppendFloatAlpha(m.tint,x);if(y.sourceIndex!==p){var C=h.setGameObject(n,y);p=y.sourceIndex}h.batchQuad(n,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],y.u0,y.v0,y.u1,y.v1,_,_,_,_,!1,y.glTexture,C)&&(p=-1)}}t.pipelines.postBatch(n)}},CF}(),MF||(MF=1,PF=function(t,e,i,n){var s=e.getRenderList();if(0!==s.length){var r=t.currentContext,a=i.alpha*e.alpha;if(0!==a){i.addToRenderList(e),r.globalCompositeOperation=t.blendModes[e.blendMode],r.imageSmoothingEnabled=!e.frame.source.scaleMode;var o=e.x-i.scrollX*e.scrollFactorX,h=e.y-i.scrollY*e.scrollFactorY;r.save(),n&&n.copyToContext(r);for(var l=i.roundPixels,u=0;u<s.length;u++){var c=s[u],d=c.flipX||c.flipY,f=c.frame,p=f.canvasData,g=f.x,v=f.y,m=1,y=1,x=c.alpha*a;0!==x&&(r.globalAlpha=x,d?(c.flipX&&(m=-1,g-=p.width),c.flipY&&(y=-1,v-=p.height),p.width>0&&p.height>0&&(r.save(),r.translate(c.x+o,c.y+h),r.scale(m,y),r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g,v,p.width,p.height),r.restore())):(l&&(g=Math.round(g),v=Math.round(v)),p.width>0&&p.height>0&&r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g+c.x+o,v+c.y+h,p.width,p.height)))}r.restore()}}}),RF={renderWebGL:e,renderCanvas:PF}}function Pj(){if(FF)return OF;FF=1;var t=Kh(),e=pc(),i=new t({initialize:function(t,e,i,n,s){this.parent=t,this.x=e,this.y=i,this.frame=n,this.data={},this.tint=16777215,this._visible=s,this._alpha=1,this.flipX=!1,this.flipY=!1,this.hasTransformComponent=!0},setFrame:function(t){return void 0===t?this.frame=this.parent.frame:t instanceof e&&t.texture===this.parent.texture?this.frame=t:this.frame=this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,i){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,i&&this.setFrame(i),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!=t>0,this._alpha=t}}});return OF=i}function Mj(){if(IF)return DF;IF=1;var t=Aj(),e=Pj(),i=Kh(),n=_c(),s=pc(),r=fU(),a=fj(),o=new i({Extends:r,Mixins:[n.Alpha,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Size,n.Texture,n.Transform,n.Visible,t],initialize:function(t,e,i,n,s){r.call(this,t,"Blitter"),this.setTexture(n,s),this.setPosition(e,i),this.initPipeline(),this.initPostPipeline(),this.children=new a,this.renderList=[],this.dirty=!1},create:function(t,i,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=this.children.length),void 0===n?n=this.frame:n instanceof s||(n=this.texture.get(n));var o=new e(this,t,i,n,r);return this.children.addAt(o,a,!1),this.dirty=!0,o},createFromCallback:function(t,e,i,n){for(var s=this.createMultiple(e,i,n),r=0;r<s.length;r++){var a=s[r];t.call(this,a,r)}return s},createMultiple:function(t,e,i){void 0===e&&(e=this.frame.name),void 0===i&&(i=!0),Array.isArray(e)||(e=[e]);var n=[],s=this;return e.forEach(function(e){for(var r=0;r<t;r++)n.push(s.create(0,0,e,i))}),n},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});return DF=o}function Rj(){if(YF)return UF;YF=1;qh();return BF||(BF=1,kF=function(t,e,i,n){i.addToRenderList(e);var s=e.list,r=s.length;if(0!==r){var a=e.localTransform;n?(a.loadIdentity(),a.multiply(n),a.translate(e.x,e.y),a.rotate(e.rotation),a.scale(e.scaleX,e.scaleY)):a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var h=e.alpha,l=e.scrollFactorX,u=e.scrollFactorY,c=0;c<r;c++){var d=s[c];if(d.willRender(i)){var f,p,g,v;if(void 0!==d.alphaTopLeft)f=d.alphaTopLeft,p=d.alphaTopRight,g=d.alphaBottomLeft,v=d.alphaBottomRight;else{var m=d.alpha;f=m,p=m,g=m,v=m}var y=d.scrollFactorX,x=d.scrollFactorY;o||d.blendMode===t.currentBlendMode||t.setBlendMode(d.blendMode);var w=d.mask;w&&w.preRenderWebGL(t,d,i);var b=d.type;b!==t.currentType&&(t.newType=!0,t.currentType=b),t.nextTypeMatch=c<r-1&&s[c+1].type===t.currentType,d.setScrollFactor(y*l,x*u),d.setAlpha(f*h,p*h,g*h,v*h),d.renderWebGL(t,d,i,a,e),d.setAlpha(f,p,g,v),d.setScrollFactor(y,x),w&&w.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),zF||(zF=1,NF=function(t,e,i,n){i.addToRenderList(e);var s=e.list;if(0!==s.length){var r=e.localTransform;n?(r.loadIdentity(),r.multiply(n),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var a=-1!==e.blendMode;a||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,l=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var u=0;u<s.length;u++){var c=s[u];if(c.willRender(i)){var d=c.alpha,f=c.scrollFactorX,p=c.scrollFactorY;a||c.blendMode===t.currentBlendMode||t.setBlendMode(c.blendMode),c.setScrollFactor(f*h,p*l),c.setAlpha(d*o),c.renderCanvas(t,c,i,r),c.setAlpha(d),c.setScrollFactor(f,p)}}e.mask&&e.mask.postRenderCanvas(t)}}),UF={renderWebGL:kF,renderCanvas:NF}}function Lj(){if(GF)return XF;GF=1;var t=Ju();return XF=function(e,i,n){void 0===n&&(n=new t);var s=Math.min(e.x,i.x),r=Math.min(e.y,i.y),a=Math.max(e.right,i.right)-s,o=Math.max(e.bottom,i.bottom)-r;return n.setTo(s,r,a,o)}}function Oj(){if(HF)return WF;HF=1;var t=mu(),e=Qo(),i=Kh(),n=_c(),s=dU(),r=fU(),a=Ju(),o=Rj(),h=Lj(),l=qu(),u=new n.TransformMatrix,c=new i({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.ComputedSize,n.Depth,n.Mask,n.PostPipeline,n.Transform,n.Visible,o],initialize:function(t,i,s,a){r.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new n.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(i,s),this.setBlendMode(e.SKIP_CHECK),a&&this.add(a)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new a),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);t.setTo(e.x,e.y,0,0)}if(this.list.length>0){var i=this.list,n=new a,s=!1;t.setEmpty();for(var r=0;r<i.length;r++){var o=i[r];o.getBounds&&(o.getBounds(n),s?h(n,t,t):(t.setTo(n.x,n.y,n.width,n.height),s=!0))}}return t},addHandler:function(t){t.once(s.DESTROY,this.onChildDestroyed,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this,t.removeFromDisplayList(),t.addedToScene())},removeHandler:function(t){t.off(s.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer=null,t.removedFromScene(),t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new l),this.parentContainer?this.parentContainer.pointToContainer(t,e):(e.x=t.x,e.y=t.y);var i=u;return i.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),i.invert(),i.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(u,this.localTransform)},add:function(e){return t.Add(this.list,e,this.maxSize,this.addHandler,this),this},addAt:function(e,i){return t.AddAt(this.list,e,i,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(e,i){return e?(void 0===i&&(i=function(t,i){return t[e]-i[e]}),t.StableSort(this.list,i),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i,n,s){return t.CountAllMatching(this.list,e,i,n,s)},swap:function(e,i){return t.Swap(this.list,e,i),this},moveTo:function(e,i){return t.MoveTo(this.list,e,i),this},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i),this},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i),this},remove:function(e,i){var n=t.Remove(this.list,e,this.removeHandler,this);if(i&&n){Array.isArray(n)||(n=[n]);for(var s=0;s<n.length;s++)n[s].destroy()}return this},removeAt:function(e,i){var n=t.RemoveAt(this.list,e,this.removeHandler,this);return i&&n&&n.destroy(),this},removeBetween:function(e,i,n){var s=t.RemoveBetween(this.list,e,i,this.removeHandler,this);if(n)for(var r=0;r<s.length;r++)s[r].destroy();return this},removeAll:function(e){var i=this.list;if(e){for(var n=0;n<i.length;n++)i[n]&&i[n].scene&&(i[n].off(s.DESTROY,this.onChildDestroyed,this),i[n].destroy());this.list=[]}else t.RemoveBetween(i,0,i.length,this.removeHandler,this);return this},bringToTop:function(e){return t.BringToTop(this.list,e),this},sendToBack:function(e){return t.SendToBack(this.list,e),this},moveUp:function(e){return t.MoveUp(this.list,e),this},moveDown:function(e){return t.MoveDown(this.list,e),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i,n){return t.Replace(this.list,e,i)&&(this.addHandler(i),this.removeHandler(e),n&&e.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){var i,n=[null],s=this.list.slice(),r=s.length;for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<r;i++)n[0]=s[i],t.apply(e,n);return this},iterate:function(t,e){var i,n=[null];for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(e,i,n){return void 0===i&&(i=e),void 0===n&&(n=!1),this.scrollFactorX=e,this.scrollFactorY=i,n&&(t.SetAll(this.list,"scrollFactorX",e),t.SetAll(this.list,"scrollFactorY",i)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(e){t.Remove(this.list,e),this.exclusive&&(e.parentContainer=null,e.removedFromScene())}});return WF=c}function Fj(){return jF?VF:(jF=1,VF=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"])}function Dj(){if(KF)return qF;KF=1;var t=Fj(),e=fU(),i=yc(),n=new i,s=new i,r=new i;return qF=function(i,a,o,h){if(a.node){var l=a.node.style,u=a.scene.sys.settings;if(!l||!u.visible||e.RENDER_MASK!==a.renderFlags||0!==a.cameraFilter&&a.cameraFilter&o.id||a.parentContainer&&!a.parentContainer.willRender())l.display="none";else{var c=a.parentContainer,d=o.alpha*a.alpha;c&&(d*=c.alpha);var f=n,p=s,g=r,v=0,m=0,y="0%",x="0%";h?(v=a.width*a.scaleX*a.originX,m=a.height*a.scaleY*a.originY,p.applyITRS(a.x-v,a.y-m,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),f.multiplyWithOffset(h,-o.scrollX*a.scrollFactorX,-o.scrollY*a.scrollFactorY),p.e=a.x-v,p.f=a.y-m,f.multiply(p,g)):(v=a.width*a.originX,m=a.height*a.originY,p.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),y=100*a.originX+"%",x=100*a.originY+"%",p.e-=o.scrollX*a.scrollFactorX,p.f-=o.scrollY*a.scrollFactorY,f.multiply(p,g),g.e-=v,g.f-=m),a.transformOnly||(l.display="block",l.opacity=d,l.zIndex=a._depth,l.pointerEvents=a.pointerEvents,l.mixBlendMode=t[a._blendMode]),l.transform=g.getCSSMatrix()+" skew("+a.skewX+"rad, "+a.skewY+"rad) rotate3d("+a.rotate3d.x+","+a.rotate3d.y+","+a.rotate3d.z+","+a.rotate3d.w+a.rotate3dAngle+")",l.transformOrigin=y+" "+x}}},qF}function Ij(){if(JF)return ZF;JF=1;var t=qh(),e=t,i=t;return e=Dj(),i=Dj(),ZF={renderWebGL:e,renderCanvas:i}}function kj(){if(QF)return $F;QF=1;var t=Kh(),e=_c(),i=Ij(),n=fU(),s=ih(),r=TV(),a=ec(),o=oW(),h=new t({Extends:n,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Origin,e.ScrollFactor,e.Transform,e.Visible,i],initialize:function(t,e,i,s,r,h){if(n.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,!this.parent)throw new Error("No DOM Container set in game config");this.cache=t.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new o,this.rotate3dAngle="deg",this.pointerEvents="auto",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,i),"string"==typeof s?"#"===s[0]?this.setElement(s.substr(1),r,h):this.createElement(s,r,h):s&&this.setElement(s,r,h),t.sys.events.on(a.SLEEP,this.handleSceneEvent,this),t.sys.events.on(a.WAKE,this.handleSceneEvent,this),t.sys.events.on(a.PRE_RENDER,this.preRender,this)},handleSceneEvent:function(t){var e=this.node,i=e.style;e&&(i.display=t.settings.visible?"block":"none")},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,i){return this.setElement(document.createElement(t),e,i)},setElement:function(t,e,i){var n;if(this.removeElement(),"string"==typeof t?("#"===t[0]&&(t=t.substr(1)),n=document.getElementById(t)):"object"==typeof t&&1===t.nodeType&&(n=t),!n)return this;if(this.node=n,e&&s(e))for(var r in e)n.style[r]=e[r];else"string"==typeof e&&(n.style=e);return n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent.appendChild(n),i&&(n.innerText=i),this.updateSize()},createFromCache:function(t,e){var i=this.cache.get(t);return i&&this.createFromHTML(i,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var i=document.createElement(e);return this.node=i,i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent.appendChild(i),i.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(r(this.node),this.node=null),this},updateSize:function(){var t=this.node;return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=this.width*this.scaleX,this.displayHeight=this.height*this.scaleY,this},getChildByProperty:function(t,e){if(this.node)for(var i=this.node.querySelectorAll("*"),n=0;n<i.length;n++)if(i[n][t]===e)return i[n];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preRender:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(a.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(a.WAKE,this.handleSceneEvent,this),this.scene.sys.events.off(a.PRE_RENDER,this.preRender,this)}});return $F=h}function Bj(){if(rD)return sD;rD=1;var t=qh(),e=t,i=t;return e=function(){if(eD)return tD;eD=1;var t=yj(),e=yc(),i=_W(),n=new e;return tD=function(e,s,r,a){var o=s.text,h=o.length;if(0!==h){r.addToRenderList(s);var l=e.pipelines.set(s.pipeline,s),u=t(s,r,a);e.pipelines.preBatch(s);var c=u.sprite,d=u.calc,f=n,p=s.cropWidth>0||s.cropHeight>0;p&&(l.flush(),e.pushScissor(d.tx,d.ty,s.cropWidth*d.scaleX,s.cropHeight*d.scaleY));var g,v,m=s.frame.glTexture,y=s.tintFill,x=i.getTintAppendFloatAlpha(s.tintTopLeft,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(s.tintTopRight,r.alpha*s._alphaTR),b=i.getTintAppendFloatAlpha(s.tintBottomLeft,r.alpha*s._alphaBL),T=i.getTintAppendFloatAlpha(s.tintBottomRight,r.alpha*s._alphaBR),S=l.setGameObject(s),E=0,_=0,C=0,A=0,P=s.letterSpacing,M=0,R=0,L=s.scrollX,O=s.scrollY,F=s.fontData,D=F.chars,I=F.lineHeight,k=s.fontSize/F.size,B=0,N=s._align,z=0,U=0,Y=s.getTextBounds(!1);s.maxWidth>0&&(h=(o=Y.wrappedText).length);var X=s._bounds.lines;1===N?U=(X.longest-X.lengths[0])/2:2===N&&(U=X.longest-X.lengths[0]);for(var G=r.roundPixels,W=s.displayCallback,H=s.callbackData,V=0;V<h;V++)if(10!==(C=o.charCodeAt(V))){if(g=D[C]){M=g.width,R=g.height;var j=g.xOffset+E-L,q=g.yOffset+_-O;if(null!==v){var K=g.kerning[A]||0;j+=K,E+=K}if(E+=g.xAdvance+P,v=g,A=C,0!==M&&0!==R&&32!==C){if(k=s.fontSize/s.fontData.size,B=0,W){H.color=0,H.tint.topLeft=x,H.tint.topRight=w,H.tint.bottomLeft=b,H.tint.bottomRight=T,H.index=V,H.charCode=C,H.x=j,H.y=q,H.scale=k,H.rotation=B,H.data=g.data;var Z=W(H);j=Z.x,q=Z.y,k=Z.scale,B=Z.rotation,Z.color?(x=Z.color,w=Z.color,b=Z.color,T=Z.color):(x=Z.tint.topLeft,w=Z.tint.topRight,b=Z.tint.bottomLeft,T=Z.tint.bottomRight),x=i.getTintAppendFloatAlpha(x,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(w,r.alpha*s._alphaTR),b=i.getTintAppendFloatAlpha(b,r.alpha*s._alphaBL),T=i.getTintAppendFloatAlpha(T,r.alpha*s._alphaBR)}j*=k,q*=k,j-=s.displayOriginX,q-=s.displayOriginY,j+=U,f.applyITRS(j,q,B,k,k),d.multiply(f,c);var J=g.u0,$=g.v0,Q=g.u1,tt=g.v1,et=M,it=R,nt=c.e,st=c.f,rt=it*c.c+c.e,at=it*c.d+c.f,ot=et*c.a+it*c.c+c.e,ht=et*c.b+it*c.d+c.f,lt=et*c.a+c.e,ut=et*c.b+c.f;G&&(nt=Math.round(nt),st=Math.round(st),rt=Math.round(rt),at=Math.round(at),ot=Math.round(ot),ht=Math.round(ht),lt=Math.round(lt),ut=Math.round(ut)),l.shouldFlush(6)&&(l.flush(),S=l.setGameObject(s)),l.batchQuad(s,nt,st,rt,at,ot,ht,lt,ut,J,$,Q,tt,x,w,b,T,y,m,S)}}}else z++,1===N?U=(X.longest-X.lengths[z])/2:2===N&&(U=X.longest-X.lengths[z]),E=0,_+=I,v=null;p&&(l.flush(),e.popScissor()),e.pipelines.postBatch(s)}},tD}(),i=function(){if(nD)return iD;nD=1;var t=Ej();return iD=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.displayCallback,u=i.callbackData,c=i.fontData.chars,d=i.fontData.lineHeight,f=i._letterSpacing,p=0,g=0,v=0,m=null,y=0,x=0,w=0,b=0,T=0,S=0,E=null,_=0,C=i.frame.source.image,A=h.cutX,P=h.cutY,M=0,R=0,L=i._fontSize/i.fontData.size,O=i._align,F=0,D=0;i.getTextBounds(!1);var I=i._bounds.lines;1===O?D=(I.longest-I.lengths[0])/2:2===O&&(D=I.longest-I.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);var k=n.roundPixels;i.cropWidth>0&&i.cropHeight>0&&(o.beginPath(),o.rect(0,0,i.cropWidth,i.cropHeight),o.clip());for(var B=0;B<a;B++)if(R=L,M=0,10!==(v=r.charCodeAt(B))){if(m=c[v]){if(y=A+m.x,x=P+m.y,w=m.width,b=m.height,T=m.xOffset+p-i.scrollX,S=m.yOffset+g-i.scrollY,null!==E){var N=m.kerning[_];T+=void 0!==N?N:0}if(l){u.index=B,u.charCode=v,u.x=T,u.y=S,u.scale=R,u.rotation=M,u.data=m.data;var z=l(u);T=z.x,S=z.y,R=z.scale,M=z.rotation}T*=R,S*=R,T+=D,p+=m.xAdvance+f+(void 0!==N?N:0),E=m,_=v,0!==w&&0!==b&&32!==v&&(k&&(T=Math.round(T),S=Math.round(S)),o.save(),o.translate(T,S),o.rotate(M),o.scale(R,R),o.drawImage(C,y,x,w,b,0,0,w,b),o.restore())}}else F++,1===O?D=(I.longest-I.lengths[F])/2:2===O&&(D=I.longest-I.lengths[F]),p=0,g+=d,E=null;o.restore()}},iD}(),sD={renderWebGL:e,renderCanvas:i}}function Nj(){if(oD)return aD;oD=1;var t=Cj(),e=Kh(),i=Bj(),n=new e({Extends:t,Mixins:[i],initialize:function(e,i,n,s,r,a,o){t.call(this,e,i,n,s,r,a,o),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});return aD=n}function zj(){if(cD)return uD;cD=1;var t=qh();return t=function(){if(lD)return hD;lD=1;var t=yj();return hD=function(e,i,n,s){e.pipelines.clear();var r=t(i,n,s).calc;i.render.call(i,e,n,r),e.pipelines.rebind()},hD}(),uD={renderWebGL:t}}function Uj(){if(fD)return dD;fD=1;var t=Kh(),e=_c(),i=fU(),n=zj(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.Origin,e.ScrollFactor,e.Size,e.Texture,e.Tint,e.Transform,e.Visible,n],initialize:function(t){i.call(this,t,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});return dD=s}function Yj(){return gD?pD:(gD=1,pD={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22})}function Xj(){if(mD)return vD;mD=1;return vD=function(t,e,i){if(t.width<=0||t.height<=0)return!1;var n=(e-t.x)/t.width,s=(i-t.y)/t.height;return(n*=n)+(s*=s)<.25},vD}function Gj(){if(xD)return yD;xD=1;var t=$h();return yD=function(e,i,n){void 0===n&&(n=new t);var s=e.width/2,r=e.height/2;return n.x=e.x+s*Math.cos(i),n.y=e.y+r*Math.sin(i),n},yD}function Wj(){if(bD)return wD;bD=1;var t=Gj(),e=el(),i=il(),n=$h();return wD=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},wD}function Hj(){if(SD)return TD;SD=1;return TD=function(t){var e=t.width/2,i=t.height/2,n=Math.pow(e-i,2)/Math.pow(e+i,2);return Math.PI*(e+i)*(1+3*n/(10+Math.sqrt(4-3*n)))},TD}function Vj(){if(_D)return ED;_D=1;var t=Hj(),e=Gj(),i=el(),n=il();return ED=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},ED}function jj(){if(AD)return CD;AD=1;var t=Kh(),e=Xj(),i=Wj(),n=Vj(),s=Jh(),r=SY(),a=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.ELLIPSE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return CD=a}function qj(){if(LD)return RD;LD=1;var t=Yj(),e=Ej();return RD=function(i,n,s,r,a,o){var h=n.commandBuffer,l=h.length,u=a||i.currentContext;if(0!==l&&e(i,u,n,s,r)){s.addToRenderList(n);var c=1,d=1,f=0,p=0,g=1,v=0,m=0,y=0;u.beginPath();for(var x=0;x<l;++x){switch(h[x]){case t.ARC:u.arc(h[x+1],h[x+2],h[x+3],h[x+4],h[x+5],h[x+6]),x+=7;break;case t.LINE_STYLE:g=h[x+1],f=h[x+2],c=h[x+3],v=(16711680&f)>>>16,m=(65280&f)>>>8,y=255&f,u.strokeStyle="rgba("+v+","+m+","+y+","+c+")",u.lineWidth=g,x+=3;break;case t.FILL_STYLE:p=h[x+1],d=h[x+2],v=(16711680&p)>>>16,m=(65280&p)>>>8,y=255&p,u.fillStyle="rgba("+v+","+m+","+y+","+d+")",x+=2;break;case t.BEGIN_PATH:u.beginPath();break;case t.CLOSE_PATH:u.closePath();break;case t.FILL_PATH:o||u.fill();break;case t.STROKE_PATH:o||u.stroke();break;case t.FILL_RECT:o?u.rect(h[x+1],h[x+2],h[x+3],h[x+4]):u.fillRect(h[x+1],h[x+2],h[x+3],h[x+4]),x+=4;break;case t.FILL_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.fill(),x+=6;break;case t.STROKE_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.stroke(),x+=6;break;case t.LINE_TO:u.lineTo(h[x+1],h[x+2]),x+=2;break;case t.MOVE_TO:u.moveTo(h[x+1],h[x+2]),x+=2;break;case t.LINE_FX_TO:u.lineTo(h[x+1],h[x+2]),x+=5;break;case t.MOVE_FX_TO:u.moveTo(h[x+1],h[x+2]),x+=5;break;case t.SAVE:u.save();break;case t.RESTORE:u.restore();break;case t.TRANSLATE:u.translate(h[x+1],h[x+2]),x+=2;break;case t.SCALE:u.scale(h[x+1],h[x+2]),x+=2;break;case t.ROTATE:u.rotate(h[x+1]),x+=1;break;case t.GRADIENT_FILL_STYLE:x+=5;break;case t.GRADIENT_LINE_STYLE:x+=6}}u.restore()}},RD}function Kj(){if(FD)return OD;FD=1;var t=qh(),e=t,i=t;return e=function(){if(MD)return PD;MD=1;var t=Yj(),e=yj(),i=yc(),n=_W(),s=function(t,e,i){this.x=t,this.y=e,this.width=i},r=function(t,e,i){this.points=[],this.pointsLength=1,this.points[0]=new s(t,e,i)},a=[],o=new i;return PD=function(i,h,l,u){if(0!==h.commandBuffer.length){l.addToRenderList(h);var c=i.pipelines.set(h.pipeline,h);i.pipelines.preBatch(h);for(var d=e(h,l,u).calc,f=o.loadIdentity(),p=h.commandBuffer,g=l.alpha*h.alpha,v=1,m=c.fillTint,y=c.strokeTint,x=0,w=0,b=0,T=2*Math.PI,S=[],E=0,_=!0,C=null,A=n.getTintAppendFloatAlpha,P=0;P<p.length;P++)switch(p[P]){case t.BEGIN_PATH:S.length=0,C=null,_=!0;break;case t.CLOSE_PATH:_=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case t.FILL_PATH:for(E=0;E<S.length;E++)c.batchFillPath(S[E].points,f,d);break;case t.STROKE_PATH:for(E=0;E<S.length;E++)c.batchStrokePath(S[E].points,v,_,f,d);break;case t.LINE_STYLE:v=p[++P];var M=A(p[++P],p[++P]*g);y.TL=M,y.TR=M,y.BL=M,y.BR=M;break;case t.FILL_STYLE:var R=A(p[++P],p[++P]*g);m.TL=R,m.TR=R,m.BL=R,m.BR=R;break;case t.GRADIENT_FILL_STYLE:var L=p[++P]*g,O=p[++P]*g,F=p[++P]*g,D=p[++P]*g;m.TL=A(p[++P],L),m.TR=A(p[++P],O),m.BL=A(p[++P],F),m.BR=A(p[++P],D);break;case t.GRADIENT_LINE_STYLE:v=p[++P];var I=p[++P]*g;y.TL=A(p[++P],I),y.TR=A(p[++P],I),y.BL=A(p[++P],I),y.BR=A(p[++P],I);break;case t.ARC:var k=0,B=p[++P],N=p[++P],z=p[++P],U=p[++P],Y=p[++P],X=p[++P],G=p[++P];for(Y-=U,X?Y<-T?Y=-T:Y>0&&(Y=Y%T-T):Y>T?Y=T:Y<0&&(Y=T+Y%T),null===C&&(C=new r(B+Math.cos(U)*z,N+Math.sin(U)*z,v),S.push(C),k+=.01);k<1+G;)b=Y*k+U,x=B+Math.cos(b)*z,w=N+Math.sin(b)*z,C.points.push(new s(x,w,v)),k+=.01;b=Y+U,x=B+Math.cos(b)*z,w=N+Math.sin(b)*z,C.points.push(new s(x,w,v));break;case t.FILL_RECT:c.batchFillRect(p[++P],p[++P],p[++P],p[++P],f,d);break;case t.FILL_TRIANGLE:c.batchFillTriangle(p[++P],p[++P],p[++P],p[++P],p[++P],p[++P],f,d);break;case t.STROKE_TRIANGLE:c.batchStrokeTriangle(p[++P],p[++P],p[++P],p[++P],p[++P],p[++P],v,f,d);break;case t.LINE_TO:null!==C?C.points.push(new s(p[++P],p[++P],v)):(C=new r(p[++P],p[++P],v),S.push(C));break;case t.MOVE_TO:C=new r(p[++P],p[++P],v),S.push(C);break;case t.SAVE:a.push(f.copyToArray());break;case t.RESTORE:f.copyFromArray(a.pop());break;case t.TRANSLATE:B=p[++P],N=p[++P],f.translate(B,N);break;case t.SCALE:B=p[++P],N=p[++P],f.scale(B,N);break;case t.ROTATE:f.rotate(p[++P])}i.pipelines.postBatch(h)}},PD}(),i=qj(),i=qj(),OD={renderWebGL:e,renderCanvas:i}}function Zj(){if(ID)return DD;ID=1;var t=IX(),e=Kh(),i=Yj(),n=_c(),s=jj(),r=fU(),a=jh(),o=Vl(),h=il(),l=Kj(),u=new e({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.Transform,n.Visible,n.ScrollFactor,l],initialize:function(t,e){var i=o(e,"x",0),n=o(e,"y",0);r.call(this,t,"Graphics"),this.setPosition(i,n),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(e)},setDefaultStyles:function(t){return o(t,"lineStyle",null)&&(this.defaultStrokeWidth=o(t,"lineStyle.width",1),this.defaultStrokeColor=o(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=o(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),o(t,"fillStyle",null)&&(this.defaultFillColor=o(t,"fillStyle.color",16777215),this.defaultFillAlpha=o(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(i.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(i.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,s,r,a,o,h){return void 0===r&&(r=1),void 0===a&&(a=r),void 0===o&&(o=r),void 0===h&&(h=r),this.commandBuffer.push(i.GRADIENT_FILL_STYLE,r,a,o,h,t,e,n,s),this},lineGradientStyle:function(t,e,n,s,r,a){return void 0===a&&(a=1),this.commandBuffer.push(i.GRADIENT_LINE_STYLE,t,a,e,n,s,r),this},beginPath:function(){return this.commandBuffer.push(i.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(i.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(i.FILL_PATH),this},fill:function(){return this.commandBuffer.push(i.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(i.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(i.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.fillPath(),this},strokeCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,s){return this.commandBuffer.push(i.FILL_RECT,t,e,n,s),this},strokeRect:function(t,e,i,n){var s=this._lineWidth/2,r=t-s,a=t+s;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+n),this.strokePath(),this.beginPath(),this.moveTo(t+i,e),this.lineTo(t+i,e+n),this.strokePath(),this.beginPath(),this.moveTo(r,e),this.lineTo(a+i,e),this.strokePath(),this.beginPath(),this.moveTo(r,e+n),this.lineTo(a+i,e+n),this.strokePath(),this},fillRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var c=r>=0,d=o>=0,f=l>=0,p=u>=0;return r=Math.abs(r),o=Math.abs(o),l=Math.abs(l),u=Math.abs(u),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),d?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),p?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),f?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),c?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s,c=Math.min(i,n)/2;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var d=r>=0,f=o>=0,p=l>=0,g=u>=0;return r=Math.min(Math.abs(r),c),o=Math.min(Math.abs(o),c),l=Math.min(Math.abs(l),c),u=Math.min(Math.abs(u),c),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),this.moveTo(t+i-o,e),f?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),this.moveTo(t+i,e+n-u),g?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),this.moveTo(t+l,e+n),p?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),this.moveTo(t,e+r),d?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(i.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.FILL_TRIANGLE,t,e,n,s,r,a),this},strokeTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.STROKE_TRIANGLE,t,e,n,s,r,a),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,i,n){return this.beginPath(),this.moveTo(t,e),this.lineTo(i,n),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(i.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(i.MOVE_TO,t,e),this},strokePoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.strokePoints(i,!0)},strokeEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.strokePoints(a,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.fillPoints(i,!0)},fillEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.fillPoints(a,!0)},arc:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this},slice:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.BEGIN_PATH),this.commandBuffer.push(i.MOVE_TO,t,e),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this.commandBuffer.push(i.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(i.SAVE),this},restore:function(){return this.commandBuffer.push(i.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(i.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(i.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(i.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,i){var n,s,r=this.scene.sys,a=r.game.renderer;void 0===e&&(e=r.scale.width),void 0===i&&(i=r.scale.height),u.TargetCamera.setScene(this.scene),u.TargetCamera.setViewport(0,0,e,i),u.TargetCamera.scrollX=this.x,u.TargetCamera.scrollY=this.y;var o={willReadFrequently:!0};if("string"==typeof t)if(r.textures.exists(t)){var h=(n=r.textures.get(t)).getSourceImage();h instanceof HTMLCanvasElement&&(s=h.getContext("2d",o))}else s=(n=r.textures.createCanvas(t,e,i)).getSourceImage().getContext("2d",o);else t instanceof HTMLCanvasElement&&(s=t.getContext("2d",o));return s&&(this.renderCanvas(a,this,u.TargetCamera,null,s,!1),n&&n.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});return u.TargetCamera=new t,DD=u}function Jj(){if(BD)return kD;BD=1;return kD=function(t,e){return t.hasOwnProperty(e)}}function $j(){if(zD)return ND;zD=1;var t=new(Kh())({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var i=0;i<this.entries.length;i++){var n=this.entries[i];if(n[t]===e)return n}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var i,n=this.entries.slice(),s=n.length;if(e)for(i=0;i<s&&!1!==t.call(e,n[i],i);i++);else for(i=0;i<s&&!1!==t(n[i],i);i++);return this},iterate:function(t,e){var i,n=this.entries.length;if(e)for(i=0;i<n&&!1!==t.call(e,this.entries[i],i);i++);else for(i=0;i<n&&!1!==t(this.entries[i],i);i++);return this},iterateLocal:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var n=this.entries.length;for(e=0;e<n;e++){var s=this.entries[e];s[t].apply(s,i)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(e){var i=new t;return e.entries.forEach(function(t){i.set(t)}),this.entries.forEach(function(t){i.set(t)}),i},intersect:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)&&i.set(t)}),i},difference:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)||i.set(t)}),i},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});return ND=t}function Qj(){if(HD)return WD;HD=1;qh();return YD||(YD=1,UD=function(t,e,i,n){i.addToRenderList(e),e.pipeline.batchSprite(e,i,n)}),GD||(GD=1,XD=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),WD={renderWebGL:UD,renderCanvas:XD}}function tq(){if(jD)return VD;jD=1;var t=mX(),e=Kh(),i=_c(),n=fU(),s=Qj(),r=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Size,i.TextureCrop,i.Tint,i.Transform,i.Visible,s],initialize:function(e,i,s,r,a){n.call(this,e,"Sprite"),this._crop=this.resetCropObject(),this.anims=new t(this),this.setTexture(r,a),this.setPosition(i,s),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return i.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});return VD=r}function eq(){if(KD)return qD;KD=1;var t=lX(),e=Kh(),i=dU(),n=cU(),s=Dl(),r=jh(),a=Vl(),o=Jj(),h=ih(),l=ql(),u=$j(),c=tq(),d=new e({Extends:n,initialize:function(t,e,s){n.call(this),s?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?h(e[0])&&(s=e,e=null):h(e)&&(s=e,e=null),this.scene=t,this.children=new u,this.isParent=!0,this.type="Group",this.classType=r(s,"classType",c),this.name=r(s,"name",""),this.active=r(s,"active",!0),this.maxSize=r(s,"maxSize",-1),this.defaultKey=r(s,"defaultKey",null),this.defaultFrame=r(s,"defaultFrame",null),this.runChildUpdate=r(s,"runChildUpdate",!1),this.createCallback=r(s,"createCallback",null),this.removeCallback=r(s,"removeCallback",null),this.createMultipleCallback=r(s,"createMultipleCallback",null),this.internalCreateCallback=r(s,"internalCreateCallback",null),this.internalRemoveCallback=r(s,"internalRemoveCallback",null),e&&this.addMultiple(e),s&&this.createMultiple(s),this.on(i.ADDED_TO_SCENE,this.addedToScene,this),this.on(i.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,i,n,s,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.defaultKey),void 0===n&&(n=this.defaultFrame),void 0===s&&(s=!0),void 0===r&&(r=!0),this.isFull())return null;var a=new this.classType(this.scene,t,e,i,n);return a.addToDisplayList(this.scene.sys.displayList),a.addToUpdateList(),a.visible=s,a.setActive(r),this.add(a),a},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var i=0;i<t.length;i++){var n=this.createFromConfig(t[i]);e=e.concat(n)}return e},createFromConfig:function(e){if(this.isFull())return[];this.classType=r(e,"classType",this.classType);var i=r(e,"key",void 0),n=r(e,"frame",null),s=r(e,"visible",!0),h=r(e,"active",!0),u=[];if(void 0===i)return u;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);var c=r(e,"repeat",0),d=r(e,"randomKey",!1),f=r(e,"randomFrame",!1),p=r(e,"yoyo",!1),g=r(e,"quantity",!1),v=r(e,"frameQuantity",1),m=r(e,"max",0),y=l(i,n,{max:m,qty:g||v,random:d,randomB:f,repeat:c,yoyo:p});e.createCallback&&(this.createCallback=e.createCallback),e.removeCallback&&(this.removeCallback=e.removeCallback),e.internalCreateCallback&&(this.internalCreateCallback=e.internalCreateCallback),e.internalRemoveCallback&&(this.internalRemoveCallback=e.internalRemoveCallback);for(var x=0;x<y.length;x++){var w=this.create(0,0,y[x].a,y[x].b,s,h);if(!w)break;u.push(w)}if(o(e,"setXY")){var b=a(e,"setXY.x",0),T=a(e,"setXY.y",0),S=a(e,"setXY.stepX",0),E=a(e,"setXY.stepY",0);t.SetXY(u,b,T,S,E)}if(o(e,"setRotation")){var _=a(e,"setRotation.value",0),C=a(e,"setRotation.step",0);t.SetRotation(u,_,C)}if(o(e,"setScale")){var A=a(e,"setScale.x",1),P=a(e,"setScale.y",A),M=a(e,"setScale.stepX",0),R=a(e,"setScale.stepY",0);t.SetScale(u,A,P,M,R)}if(o(e,"setOrigin")){var L=a(e,"setOrigin.x",.5),O=a(e,"setOrigin.y",L),F=a(e,"setOrigin.stepX",0),D=a(e,"setOrigin.stepY",0);t.SetOrigin(u,L,O,F,D)}if(o(e,"setAlpha")){var I=a(e,"setAlpha.value",1),k=a(e,"setAlpha.step",0);t.SetAlpha(u,I,k)}if(o(e,"setDepth")){var B=a(e,"setDepth.value",0),N=a(e,"setDepth.step",0);t.SetDepth(u,B,N)}if(o(e,"setScrollFactor")){var z=a(e,"setScrollFactor.x",1),U=a(e,"setScrollFactor.y",z),Y=a(e,"setScrollFactor.stepX",0),X=a(e,"setScrollFactor.stepY",0);t.SetScrollFactor(u,z,U,Y,X)}var G=r(e,"hitArea",null),W=r(e,"hitAreaCallback",null);G&&t.SetHitArea(u,G,W);var H=r(e,"gridAlign",!1);return H&&t.GridAlign(u,H),this.createMultipleCallback&&this.createMultipleCallback.call(this,u),u},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var i=this.children.entries.slice(),n=0;n<i.length;n++){var s=i[n];s.active&&s.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(i.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(i.DESTROY,this.remove,this),n?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,s=0;s<n.size;s++){var r=n.entries[s];r.off(i.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,i,n){return s(this.children.entries,t,e,i,n)},getFirst:function(t,e,i,n,s,r,a){return this.getHandler(!0,1,t,e,i,n,s,r,a)},getFirstNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!0,t,e,i,n,s,r,a,o)},getLast:function(t,e,i,n,s,r,a){return this.getHandler(!1,1,t,e,i,n,s,r,a)},getLastNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!1,t,e,i,n,s,r,a,o)},getHandler:function(t,e,i,n,s,r,a,o,h){var l,u;void 0===i&&(i=!1),void 0===n&&(n=!1);var c=0,d=this.children.entries;if(t)for(u=0;u<d.length;u++)if((l=d[u]).active===i){if(++c===e)break}else l=null;else for(u=d.length-1;u>=0;u--)if((l=d[u]).active===i){if(++c===e)break}else l=null;return l?("number"==typeof s&&(l.x=s),"number"==typeof r&&(l.y=r),l):n?this.create(s,r,a,o,h):null},get:function(t,e,i,n,s){return this.getFirst(!1,!0,t,e,i,n,s)},getFirstAlive:function(t,e,i,n,s,r){return this.getFirst(!0,t,e,i,n,s,r)},getFirstDead:function(t,e,i,n,s,r){return this.getFirst(!1,t,e,i,n,s,r)},playAnimation:function(e,i){return t.PlayAnimation(this.children.entries,e,i),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,i=0;i<this.children.size;i++)this.children.entries[i].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(e,i,n,s,r){return t.PropertyValueSet(this.children.entries,e,i,n,s,r),this},propertyValueInc:function(e,i,n,s,r){return t.PropertyValueInc(this.children.entries,e,i,n,s,r),this},setX:function(e,i){return t.SetX(this.children.entries,e,i),this},setY:function(e,i){return t.SetY(this.children.entries,e,i),this},setXY:function(e,i,n,s){return t.SetXY(this.children.entries,e,i,n,s),this},incX:function(e,i){return t.IncX(this.children.entries,e,i),this},incY:function(e,i){return t.IncY(this.children.entries,e,i),this},incXY:function(e,i,n,s){return t.IncXY(this.children.entries,e,i,n,s),this},shiftPosition:function(e,i,n){return t.ShiftPosition(this.children.entries,e,i,n),this},angle:function(e,i){return t.Angle(this.children.entries,e,i),this},rotate:function(e,i){return t.Rotate(this.children.entries,e,i),this},rotateAround:function(e,i){return t.RotateAround(this.children.entries,e,i),this},rotateAroundDistance:function(e,i,n){return t.RotateAroundDistance(this.children.entries,e,i,n),this},setAlpha:function(e,i){return t.SetAlpha(this.children.entries,e,i),this},setTint:function(e,i,n,s){return t.SetTint(this.children.entries,e,i,n,s),this},setOrigin:function(e,i,n,s){return t.SetOrigin(this.children.entries,e,i,n,s),this},scaleX:function(e,i){return t.ScaleX(this.children.entries,e,i),this},scaleY:function(e,i){return t.ScaleY(this.children.entries,e,i),this},scaleXY:function(e,i,n,s){return t.ScaleXY(this.children.entries,e,i,n,s),this},setDepth:function(e,i){return t.SetDepth(this.children.entries,e,i),this},setBlendMode:function(e){return t.SetBlendMode(this.children.entries,e),this},setHitArea:function(e,i){return t.SetHitArea(this.children.entries,e,i),this},shuffle:function(){return t.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(e,i,n){return t.SetVisible(this.children.entries,e,i,n),this},toggleVisible:function(){return t.ToggleVisible(this.children.entries),this},destroy:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.scene&&!this.ignoreDestroy&&(this.emit(i.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});return qD=d}function iq(){if(eI)return tI;eI=1;qh();return JD||(JD=1,ZD=function(t,e,i){var n=e.list,s=n.length;if(0!==s){e.depthSort(),t.pipelines.preBatch(e);var r=-1!==e.blendMode;r||t.setBlendMode(0);for(var a=e.alpha,o=0;o<s;o++){var h=n[o];if(h.willRender(i)){var l,u,c,d;if(void 0!==h.alphaTopLeft)l=h.alphaTopLeft,u=h.alphaTopRight,c=h.alphaBottomLeft,d=h.alphaBottomRight;else{var f=h.alpha;l=f,u=f,c=f,d=f}r||h.blendMode===t.currentBlendMode||t.setBlendMode(h.blendMode);var p=h.mask;p&&p.preRenderWebGL(t,h,i);var g=h.type;g!==t.currentType&&(t.newType=!0,t.currentType=g),t.nextTypeMatch=o<s-1&&n[o+1].type===t.currentType,h.setAlpha(l*a,u*a,c*a,d*a),h.renderWebGL(t,h,i),h.setAlpha(l,u,c,d),p&&p.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),QD||(QD=1,$D=function(t,e,i){var n=e.list;if(0!==n.length){e.depthSort();var s=-1!==e.blendMode;s||t.setBlendMode(0);var r=e._alpha;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var a=0;a<n.length;a++){var o=n[a];if(o.willRender(i)){var h=o.alpha;s||o.blendMode===t.currentBlendMode||t.setBlendMode(o.blendMode),o.setAlpha(h*r),o.renderCanvas(t,o,i),o.setAlpha(h)}}e.mask&&e.mask.postRenderCanvas(t)}}),tI={renderWebGL:ZD,renderCanvas:$D}}function nq(){if(nI)return iI;nI=1;var t=Qo(),e=Kh(),i=_c(),n=mc(),s=Ac(),r=cU(),a=dU(),o=fj(),h=iq(),l=ec(),u=gu(),c=new e({Extends:o,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Mask,i.PostPipeline,i.Visible,r,h],initialize:function(e,i){o.call(this,e),r.call(this),this.scene=e,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=e.sys,this.events=e.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPostPipeline(),this.clearAlpha(),this.setBlendMode(t.SKIP_CHECK),i&&this.add(i),e.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return n(this)},willRender:function(t){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return i.unshift(this.displayList.getIndex(t)),i},addChildCallback:function(t){var e=t.displayList;e&&e!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(a.ADDED_TO_SCENE,t,this.scene),this.events.emit(l.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(a.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(l.REMOVED_FROM_SCENE,t,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(u(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(a.ADDED_TO_SCENE,this,this.scene),t.events.emit(l.ADDED_TO_SCENE,this,this.scene)),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(a.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(l.REMOVED_FROM_SCENE,this,this.scene)),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){if(this.scene&&!this.ignoreDestroy){this.emit(a.DESTROY,this);for(var e=this.list;e.length;)e[0].destroy(t);this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0,!1),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}});return iI=c}function sq(){if(rI)return sI;rI=1;var t=bG(),e=SG(),i={bezier:t,catmull:e,catmullrom:e,linear:_G()};return sI=function(t){if(null===t)return null;var e=i.linear;return"string"==typeof t?i.hasOwnProperty(t)&&(e=i[t]):"function"==typeof t&&(e=t),e},sI}function rq(){if(oI)return aI;oI=1;var t=vX(),e=tl(),i=Kh(),n=sG(),s=fY(),r=jh(),a=sq(),o=DG(),h=wc(),l=new i({initialize:function(t,e,i){void 0===i&&(i=!1),this.propertyKey=t,this.propertyValue=e,this.defaultValue=e,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=i,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=r(t,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(t){var i;switch(this.method){case 1:case 3:case 8:i=t;break;case 2:this.propertyValue.indexOf(t)>=0&&(i=t);break;case 4:var n=(this.end-this.start)/this.steps;i=o(t,n),this.counter=i;break;case 5:case 6:case 7:i=e(t,this.start,this.end);break;case 9:i=this.start[0]}return this.current=i,this},getMethod:function(){var t=this.propertyValue;if(null===t)return 0;var e=typeof t;if("number"===e)return 1;if(Array.isArray(t))return 2;if("function"===e)return 3;if("object"===e){if(this.hasBoth(t,"start","end"))return this.has(t,"steps")?4:5;if(this.hasBoth(t,"min","max"))return 6;if(this.has(t,"random"))return 7;if(this.hasEither(t,"onEmit","onUpdate"))return 8;if(this.hasEither(t,"values","interpolation"))return 9}return 0},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,n=this.defaultUpdate;switch(this.method){case 1:i=this.staticValueEmit;break;case 2:i=this.randomStaticValueEmit,e=t[0];break;case 3:this._onEmit=t,i=this.proxyEmit,e=this.defaultValue;break;case 4:this.start=t.start,this.end=t.end,this.steps=t.steps,this.counter=this.start,this.yoyo=!!this.has(t,"yoyo")&&t.yoyo,this.direction=0,i=this.steppedEmit,e=this.start;break;case 5:this.start=t.start,this.end=t.end;var r=this.has(t,"ease")?t.ease:"Linear";this.ease=s(r,t.easeParams),i=this.has(t,"random")&&t.random?this.randomRangedValueEmit:this.easedValueEmit,n=this.easeValueUpdate,e=this.start;break;case 6:this.start=t.min,this.end=t.max,i=this.has(t,"int")&&t.int?this.randomRangedIntEmit:this.randomRangedValueEmit,e=this.start;break;case 7:var o=t.random;Array.isArray(o)&&(this.start=o[0],this.end=o[1]),i=this.randomRangedIntEmit,e=this.start;break;case 8:this._onEmit=this.has(t,"onEmit")?t.onEmit:this.defaultEmit,this._onUpdate=this.has(t,"onUpdate")?t.onUpdate:this.defaultUpdate,i=this.proxyEmit,n=this.proxyUpdate,e=this.defaultValue;break;case 9:this.start=t.values;var h=this.has(t,"ease")?t.ease:"Linear";this.ease=s(h,t.easeParams),this.interpolation=a(t.interpolation),i=this.easedValueEmit,n=this.easeValueUpdate,e=this.start[0]}return this.onEmit=i,this.onUpdate=n,this.current=e,this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,i){return t.hasOwnProperty(e)&&t.hasOwnProperty(i)},hasEither:function(t,e,i){return t.hasOwnProperty(e)||t.hasOwnProperty(i)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(t,e,i,n){return n},proxyEmit:function(t,e,i){var n=this._onEmit(t,e,i);return this.current=n,n},proxyUpdate:function(t,e,i,n){var s=this._onUpdate(t,e,i,n);return this.current=s,s},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[t],this.current},randomRangedValueEmit:function(t,e){var i=n(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=i,t.data[e].max=this.end),this.current=i,i},randomRangedIntEmit:function(e,i){var n=t(this.start,this.end);return e&&e.data[i]&&(e.data[i].min=n,e.data[i].max=this.end),this.current=n,n},steppedEmit:function(){var t,e=this.counter,i=e,n=(this.end-this.start)/this.steps;this.yoyo?(0===this.direction?(i+=n)>=this.end&&(t=i-this.end,i=this.end-t,this.direction=1):(i-=n)<=this.start&&(t=this.start-i,i=this.start+t,this.direction=0),this.counter=i):this.counter=h(i+n,this.start,this.end);return this.current=e,e},easedValueEmit:function(t,e){if(t&&t.data[e]){var i=t.data[e];i.min=this.start,i.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(t,e,i){var n,s=t.data[e],r=this.ease(i);return n=this.interpolation?this.interpolation(this.start,r):(s.max-s.min)*r+s.min,this.current=n,n},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});return aI=l}function aq(){if(lI)return hI;lI=1;var t=Kh(),e=rq(),i=EX(),n=fY(),s=sq(),r=RX(),a=new t({Extends:e,initialize:function(t){e.call(this,t,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return null===this.propertyValue?0:9},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,a=this.defaultUpdate;if(9===this.method){this.start=t[0],this.ease=n("Linear"),this.interpolation=s("linear"),i=this.easedValueEmit,a=this.easeValueUpdate,e=t[0],this.active=!0,this.r.length=0,this.g.length=0,this.b.length=0;for(var o=0;o<t.length;o++){var h=r(t[o]);this.r.push(h.r),this.g.push(h.g),this.b.push(h.b)}}return this.onEmit=i,this.onUpdate=a,this.current=e,this},setEase:function(t){this.easeName=t,this.ease=n(t)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(t,e,n){var s=this.ease(n),r=this.interpolation(this.r,s),a=this.interpolation(this.g,s),o=this.interpolation(this.b,s),h=i(r,a,o);return this.current=h,h}});return hI=a}function oq(){return bI?wI:(bI=1,wI={COMPLETE:cI?uI:(cI=1,uI="complete"),DEATH_ZONE:fI?dI:(fI=1,dI="deathzone"),EXPLODE:gI?pI:(gI=1,pI="explode"),START:mI?vI:(mI=1,vI="start"),STOP:xI?yI:(xI=1,yI="stop")})}function hq(){if(SI)return TI;SI=1;var t=new(Kh())({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!0),this.emitter,this.x=t,this.y=e,this.active=i},update:function(){},destroy:function(){this.emitter=null}});return TI=t}function lq(){if(_I)return EI;_I=1;var t=Kh(),e=jh(),i=hq(),n=new t({Extends:i,initialize:function(t,n,s,r,a){if("object"==typeof t){var o=t;t=e(o,"x",0),n=e(o,"y",0),s=e(o,"power",0),r=e(o,"epsilon",100),a=e(o,"gravity",50)}else void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=100),void 0===a&&(a=50);i.call(this,t,n,!0),this._gravity=a,this._power=s*a,this._epsilon=r*r},update:function(t,e){var i=this.x-t.x,n=this.y-t.y,s=i*i+n*n;if(0!==s){var r=Math.sqrt(s);s<this._epsilon&&(s=this._epsilon);var a=this._power*e/(s*r)*100;t.velocityX+=i*a,t.velocityY+=n*a}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});return EI=n}function uq(){if(AI)return CI;AI=1;var t=mX(),e=tl(),i=Kh(),n=ac(),s=Ju(),r=$u(),a=qu(),o=new i({initialize:function(e){this.emitter=e,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new a,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=e.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new t(this)),this.bounds=new s},emit:function(t,e,i,n,s,r){return this.emitter.emit(t,e,i,n,s,r)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},fire:function(t,e){var i=this.emitter,s=i.ops,r=i.getAnim();if(r?this.anims.play(r):(this.frame=i.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(i.getEmitZone(this),void 0===t?this.x+=s.x.onEmit(this,"x"):s.x.steps>0?this.x+=t+s.x.onEmit(this,"x"):this.x+=t,void 0===e?this.y+=s.y.onEmit(this,"y"):s.y.steps>0?this.y+=e+s.y.onEmit(this,"y"):this.y+=e,this.life=s.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=s.delay.onEmit(this,"delay"),this.holdCurrent=s.hold.onEmit(this,"hold"),this.scaleX=s.scaleX.onEmit(this,"scaleX"),this.scaleY=s.scaleY.active?s.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=s.rotate.onEmit(this,"rotate"),this.rotation=n(this.angle),i.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),0===this.delayCurrent&&i.getDeathZone(this))return this.lifeCurrent=0,!1;var a=s.speedX.onEmit(this,"speedX"),o=s.speedY.active?s.speedY.onEmit(this,"speedY"):a;if(i.radial){var h=n(s.angle.onEmit(this,"angle"));this.velocityX=Math.cos(h)*Math.abs(a),this.velocityY=Math.sin(h)*Math.abs(o)}else if(i.moveTo){var l=s.moveToX.onEmit(this,"moveToX"),u=s.moveToY.onEmit(this,"moveToY"),c=this.life/1e3;this.velocityX=(l-this.x)/c,this.velocityY=(u-this.y)/c}else this.velocityX=a,this.velocityY=o;return i.acceleration&&(this.accelerationX=s.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=s.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=s.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=s.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=s.bounce.onEmit(this,"bounce"),this.alpha=s.alpha.onEmit(this,"alpha"),s.color.active?this.tint=s.color.onEmit(this,"tint"):this.tint=s.tint.onEmit(this,"tint"),!0},update:function(t,i,s){if(this.lifeCurrent<=0)return!(this.holdCurrent>0)||(this.holdCurrent-=t,this.holdCurrent<=0);if(this.delayCurrent>0)return this.delayCurrent-=t,!1;this.anims&&this.anims.update(0,t);var r=this.emitter,a=r.ops,o=1-this.lifeCurrent/this.life;if(this.lifeT=o,this.x=a.x.onUpdate(this,"x",o,this.x),this.y=a.y.onUpdate(this,"y",o,this.y),r.moveTo){var h=a.moveToX.onUpdate(this,"moveToX",o,r.moveToX),l=a.moveToY.onUpdate(this,"moveToY",o,r.moveToY),u=this.lifeCurrent/1e3;this.velocityX=(h-this.x)/u,this.velocityY=(l-this.y)/u}return this.computeVelocity(r,t,i,s,o),this.scaleX=a.scaleX.onUpdate(this,"scaleX",o,this.scaleX),a.scaleY.active?this.scaleY=a.scaleY.onUpdate(this,"scaleY",o,this.scaleY):this.scaleY=this.scaleX,this.angle=a.rotate.onUpdate(this,"rotate",o,this.angle),this.rotation=n(this.angle),r.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=e(a.alpha.onUpdate(this,"alpha",o,this.alpha),0,1),a.color.active?this.tint=a.color.onUpdate(this,"color",o,this.tint):this.tint=a.tint.onUpdate(this,"tint",o,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(t,i,n,s,r){var a=t.ops,o=this.velocityX,h=this.velocityY,l=a.accelerationX.onUpdate(this,"accelerationX",r,this.accelerationX),u=a.accelerationY.onUpdate(this,"accelerationY",r,this.accelerationY),c=a.maxVelocityX.onUpdate(this,"maxVelocityX",r,this.maxVelocityX),d=a.maxVelocityY.onUpdate(this,"maxVelocityY",r,this.maxVelocityY);this.bounce=a.bounce.onUpdate(this,"bounce",r,this.bounce),o+=t.gravityX*n+l*n,h+=t.gravityY*n+u*n,o=e(o,-c,c),h=e(h,-d,d),this.velocityX=o,this.velocityY=h,this.x+=o*n,this.y+=h*n,t.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var f=0;f<s.length;f++){var p=s[f];p.active&&p.update(this,i,n,r)}},setSizeToFrame:function(){},getBounds:function(t){void 0===t&&(t=this.emitter.getWorldTransformMatrix());var e=Math.abs(t.scaleX)*this.scaleX,i=Math.abs(t.scaleY)*this.scaleY,n=this.x,s=this.y,o=this.rotation,h=this.frame.width*e/2,l=this.frame.height*i/2,u=this.bounds,c=new a(n-h,s-l),d=new a(n+h,s-l),f=new a(n-h,s+l),p=new a(n+h,s+l);return 0!==o&&(r(c,n,s,o),r(d,n,s,o),r(f,n,s,o),r(p,n,s,o)),t.transformPoint(c.x,c.y,c),t.transformPoint(d.x,d.y,d),t.transformPoint(f.x,f.y,f),t.transformPoint(p.x,p.y,p),u.x=Math.min(c.x,d.x,f.x,p.x),u.y=Math.min(c.y,d.y,f.y,p.y),u.width=Math.max(c.x,d.x,f.x,p.x)-u.x,u.height=Math.max(c.y,d.y,f.y,p.y)-u.y,u},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});return CI=o}function cq(){if(MI)return PI;MI=1;var t=Kh(),e=hq(),i=Ju(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===a&&(a=!0),void 0===o&&(o=!0),void 0===h&&(h=!0),void 0===l&&(l=!0),e.call(this,t,n,!0),this.bounds=new i(t,n,s,r),this.collideLeft=a,this.collideRight=o,this.collideTop=h,this.collideBottom=l},update:function(t){var e=this.bounds,i=-t.bounce,n=t.worldPosition;n.x<e.x&&this.collideLeft?(t.x+=e.x-n.x,t.velocityX*=i):n.x>e.right&&this.collideRight&&(t.x-=n.x-e.right,t.velocityX*=i),n.y<e.y&&this.collideTop?(t.y+=e.y-n.y,t.velocityY*=i):n.y>e.bottom&&this.collideBottom&&(t.y-=n.y-e.bottom,t.velocityY*=i)}});return PI=n}function dq(){if(LI)return RI;LI=1;return RI=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}}function fq(){if(FI)return OI;FI=1;var t=new(Kh())({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=t.worldPosition,i=this.source.contains(e.x,e.y);return i&&this.killOnEnter||!i&&!this.killOnEnter}});return OI=t}function pq(){if(II)return DI;II=1;var t=new(Kh())({initialize:function(t,e,i,n,s,r){void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===r&&(r=-1),this.source=t,this.points=[],this.quantity=e,this.stepRate=i,this.yoyo=n,this.counter=-1,this.seamless=s,this._length=0,this._direction=0,this.total=r,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var i=this._length;return this._length=this.points.length,this._length<i&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});return DI=t}function gq(){if(BI)return kI;BI=1;return kI=function(t,e){for(var i=0;i<e.length;i++)if(!t.hasOwnProperty(e[i]))return!1;return!0}}function vq(){if(zI)return NI;zI=1;return NI=function(t,e){for(var i=0;i<e.length;i++)if(t.hasOwnProperty(e[i]))return!0;return!1}}function mq(){if(YI)return UI;YI=1;var t=kX();return UI=function(e,i,n){var s=e.centerX,r=e.centerY;return e.setSize(e.width+2*i,e.height+2*n),t(e,s,r)}}function yq(){if(GI)return XI;GI=1;return XI=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.right,e.right);t.x=i,t.width=n-i;var s=Math.min(t.y,e.y),r=Math.max(t.bottom,e.bottom);return t.y=s,t.height=r-s,t},XI}function xq(){if(HI)return WI;HI=1;var t=XV();return WI=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)&&(n[s]=i[s]);return n}}function wq(){if(jI)return VI;jI=1;var t=Kh(),e=qu(),i=new t({initialize:function(t){this.source=t,this._tempVec=new e,this.total=-1},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});return VI=i}function bq(){if(KI)return qI;KI=1;return qI=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0)&&!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}}function Tq(){if(ek)return tk;ek=1;var t=qh(),e=t,i=t;return e=function(){if(JI)return ZI;JI=1;var t=bq(),e=yc(),i=_W(),n=new e,s=new e,r=new e,a=new e;return ZI=function(e,o,h,l){var u=e.pipelines.set(o.pipeline),c=n,d=s,f=r,p=a;l?(p.loadIdentity(),p.multiply(l),p.translate(o.x,o.y),p.rotate(o.rotation),p.scale(o.scaleX,o.scaleY)):p.applyITRS(o.x,o.y,o.rotation,o.scaleX,o.scaleY);var g=i.getTintAppendFloatAlpha,v=h.alpha,m=o.alpha;e.pipelines.preBatch(o);var y=o.alive,x=y.length,w=o.viewBounds;if(0!==x&&(!w||t(w,h.worldView))){o.sortCallback&&o.depthSort(),h.addToRenderList(o),c.copyFrom(h.matrix),c.multiplyWithOffset(p,-h.scrollX*o.scrollFactorX,-h.scrollY*o.scrollFactorY),e.setBlendMode(o.blendMode),o.mask&&(o.mask.preRenderWebGL(e,o,h),e.pipelines.set(o.pipeline));for(var b,T,S=o.tintFill,E=0;E<x;E++){var _=y[E],C=_.alpha*m*v;if(!(C<=0||0===_.scaleX||0===_.scaleY)){f.applyITRS(_.x,_.y,_.rotation,_.scaleX,_.scaleY),f.e=_.x,f.f=_.y,c.multiply(f,d);var A=_.frame;A.glTexture!==T&&(T=A.glTexture,b=u.setGameObject(o,A));var P=-A.halfWidth,M=-A.halfHeight,R=d.setQuad(P,M,P+A.width,M+A.height),L=g(_.tint,C);u.shouldFlush(6)&&(u.flush(),b=u.setGameObject(o,A)),u.batchQuad(o,R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],A.u0,A.v0,A.u1,A.v1,L,L,L,L,S,T,b)}}o.mask&&o.mask.postRenderWebGL(e,h),e.pipelines.postBatch(o)}},ZI}(),i=function(){if(QI)return $I;QI=1;var t=bq(),e=yc(),i=new e,n=new e,s=new e,r=new e;return $I=function(e,a,o,h){var l=i,u=n,c=s,d=r;h?(d.loadIdentity(),d.multiply(h),d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.scaleX,a.scaleY)):d.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY);var f=e.currentContext,p=o.roundPixels,g=o.alpha,v=a.alpha,m=a.alive,y=m.length,x=a.viewBounds;if(a.visible&&0!==y&&(!x||t(x,o.worldView))){a.sortCallback&&a.depthSort(),o.addToRenderList(a);var w=a.scrollFactorX,b=a.scrollFactorY;f.save(),f.globalCompositeOperation=e.blendModes[a.blendMode];for(var T=0;T<y;T++){var S=m[T],E=S.alpha*v*g;if(!(E<=0||0===S.scaleX||0===S.scaleY)){c.applyITRS(S.x,S.y,S.rotation,S.scaleX,S.scaleY),l.copyFrom(o.matrix),l.multiplyWithOffset(d,-o.scrollX*w,-o.scrollY*b),c.e=S.x,c.f=S.y,l.multiply(c,u);var _=S.frame,C=_.canvasData;if(C.width>0&&C.height>0){var A=-_.halfWidth,P=-_.halfHeight;f.globalAlpha=E,f.save(),u.setToContext(f),p&&(A=Math.round(A),P=Math.round(P)),f.imageSmoothingEnabled=!_.source.scaleMode,f.drawImage(_.source.image,C.x,C.y,C.width,C.height,A,P,C.width,C.height),f.restore()}}}f.restore()}},$I}(),tk={renderWebGL:e,renderCanvas:i}}function Sq(){if(nk)return ik;nk=1;var t=Kh(),e=_c(),i=mc(),n=dq(),s=fq(),r=pq(),a=aq(),o=rq(),h=oq(),l=fU(),u=jh(),c=kl(),d=lq(),f=gq(),p=vq(),g=Jj(),v=mq(),m=fj(),y=yq(),x=xq(),w=uq(),b=cq(),T=wq(),S=Ju(),E=bq(),_=Zl(),C=Tq(),A=gu(),P=yc(),M=qu(),R=wc(),L=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],O=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],F=new t({Extends:l,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,C],initialize:function(t,e,i,n,s){l.call(this,t,"ParticleEmitter"),this.particleClass=w,this.config=null,this.ops={accelerationX:new o("accelerationX",0),accelerationY:new o("accelerationY",0),alpha:new o("alpha",1),angle:new o("angle",{min:0,max:360},!0),bounce:new o("bounce",0),color:new a("color"),delay:new o("delay",0,!0),hold:new o("hold",0,!0),lifespan:new o("lifespan",1e3,!0),maxVelocityX:new o("maxVelocityX",1e4),maxVelocityY:new o("maxVelocityY",1e4),moveToX:new o("moveToX",0),moveToY:new o("moveToY",0),quantity:new o("quantity",1,!0),rotate:new o("rotate",0),scaleX:new o("scaleX",1),scaleY:new o("scaleY",1),speedX:new o("speedX",0,!0),speedY:new o("speedY",0,!0),tint:new o("tint",16777215),x:new o("x",0),y:new o("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new M,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new P,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new m(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(e,i),this.setTexture(n),s&&this.setConfig(s)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(t){if(!t)return this;this.config=t;var e=0,i="",n=this.ops;for(e=0;e<O.length;e++)n[i=O[e]].loadConfig(t);for(e=0;e<L.length;e++)g(t,i=L[e])&&(this[i]=u(t,i));if(this.acceleration=0!==this.accelerationX||0!==this.accelerationY,this.moveTo=f(t,["moveToX","moveToY"]),g(t,"speed")&&(n.speedX.loadConfig(t,"speed"),n.speedY.active=!1),(p(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),g(t,"scale")&&(n.scaleX.loadConfig(t,"scale"),n.scaleY.active=!1),g(t,"callbackScope")){var s=u(t,"callbackScope",null);this.emitCallbackScope=s,this.deathCallbackScope=s}if(g(t,"emitZone")&&this.addEmitZone(t.emitZone),g(t,"deathZone")&&this.addDeathZone(t.deathZone),g(t,"bounds")){var r=this.addParticleBounds(t.bounds);r.collideLeft=u(t,"collideLeft",!0),r.collideRight=u(t,"collideRight",!0),r.collideTop=u(t,"collideTop",!0),r.collideBottom=u(t,"collideBottom",!0)}return g(t,"followOffset")&&this.followOffset.setFromObject(u(t,"followOffset",0)),g(t,"texture")&&this.setTexture(t.texture),g(t,"frame")?this.setEmitterFrame(t.frame):g(t,"anim")&&this.setAnim(t.anim),g(t,"reserve")&&this.reserve(t.reserve),g(t,"advance")&&this.fastForward(t.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(h.START,this),this},updateConfig:function(t){return t&&(this.config?this.setConfig(x(this.config,t)):this.setConfig(t)),this},toJSON:function(){var t=i(this),e=0,n="";for(e=0;e<L.length;e++)t[n=L[e]]=this[n];var s=this.ops;for(e=0;e<O.length;e++)s[n=O[e]]&&(t[n]=s[n].toJSON());return s.speedY.active||(delete t.speedX,t.speed=s.speedX.toJSON()),this.scaleX===this.scaleY&&(delete t.scaleX,delete t.scaleY,t.scale=s.scaleX.toJSON()),t},resetCounters:function(t,e){var i=this.counters;i.fill(0),i[0]=t,e&&(i[5]=1)},startFollow:function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),this.follow=t,this.followOffset.set(e,i),this.trackVisible=n,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var t,e=this.frames,i=e.length;return 1===i?t=e[0]:this.randomFrame?t=c(e):(t=e[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===i&&(this.currentFrame=0))),this.texture.get(t)},setEmitterFrame:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomFrame=e,this.frameQuantity=i,this.currentFrame=0;var n=typeof t;if(this.frames.length=0,Array.isArray(t))this.frames=this.frames.concat(t);else if("string"===n||"number"===n)this.frames.push(t);else if("object"===n){var s=t;(t=u(s,"frames",null))&&(this.frames=this.frames.concat(t));var r=u(s,"cycle",!1);this.randomFrame=!r,this.frameQuantity=u(s,"quantity",i)}return 1===this.frames.length&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var t=this.anims,e=t.length;if(0===e)return null;if(1===e)return t[0];if(this.randomAnim)return c(t);var i=t[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=R(this.currentAnim+1,0,e)),i},setAnim:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomAnim=e,this.animQuantity=i,this.currentAnim=0;var n=typeof t;if(this.anims.length=0,Array.isArray(t))this.anims=this.anims.concat(t);else if("string"===n)this.anims.push(t);else if("object"===n){var s=t;(t=u(s,"anims",null))&&(this.anims=this.anims.concat(t));var r=u(s,"cycle",!1);this.randomAnim=!r,this.animQuantity=u(s,"quantity",i)}return 1===this.anims.length&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},addParticleBounds:function(t,e,i,n,s,r,a,o){if("object"==typeof t){var h=t;t=h.x,e=h.y,i=g(h,"w")?h.w:h.width,n=g(h,"h")?h.h:h.height}return this.addParticleProcessor(new b(t,e,i,n,s,r,a,o))},setParticleSpeed:function(t,e){return void 0===e&&(e=t),this.ops.speedX.onChange(t),t===e?this.ops.speedY.active=!1:this.ops.speedY.onChange(e),this.radial=!0,this},setParticleScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.ops.scaleX.onChange(t),this.ops.scaleY.onChange(e),this},setParticleGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setParticleAlpha:function(t){return this.ops.alpha.onChange(t),this},setParticleTint:function(t){return this.ops.tint.onChange(t),this},setEmitterAngle:function(t){return this.ops.angle.onChange(t),this},setParticleLifespan:function(t){return this.ops.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity=t,this},setFrequency:function(t,e){return this.frequency=t,this.flowCounter=t>0?t:0,e&&(this.quantity=e),this},addDeathZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof s)i.push(e);else if("function"==typeof e.contains)e=new s(e,!0),i.push(e);else{var r=u(e,"type","onEnter"),a=u(e,"source",null);if(a&&"function"==typeof a.contains)e=new s(a,"onEnter"===r),i.push(e)}return this.deathZones=this.deathZones.concat(i),i},removeDeathZone:function(t){return _(this.deathZones,t),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof T||e instanceof r)i.push(e);else{var s=u(e,"source",null);if(s){var a=u(e,"type","random");if("random"===a&&"function"==typeof s.getRandomPoint)e=new T(s),i.push(e);else if("edge"===a&&"function"==typeof s.getPoints){var o=u(e,"quantity",1),h=u(e,"stepRate",0),l=u(e,"yoyo",!1),c=u(e,"seamless",!0),d=u(e,"total",-1);e=new r(s,o,h,l,c,d),i.push(e)}}}return this.emitZones=this.emitZones.concat(i),i},removeEmitZone:function(t){return _(this.emitZones,t),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(t){var e=this.emitZones,i=e.length;if(0!==i){var n=e[this.zoneIndex];n.getPoint(t),n.total>-1&&(this.zoneTotal++,this.zoneTotal===n.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===i&&(this.zoneIndex=0)))}},getDeathZone:function(t){for(var e=this.deathZones,i=0;i<e.length;i++){var n=e[i];if(n.willKill(t))return this.emit(h.DEATH_ZONE,this,t,n),!0}return!1},setEmitZone:function(t){var e;return(e=isFinite(t)?t:this.emitZones.indexOf(t))>=0&&(this.zoneIndex=e),this},addParticleProcessor:function(t){return this.processors.exists(t)||(t.emitter&&t.emitter.removeParticleProcessor(t),this.processors.add(t),t.emitter=this),t},removeParticleProcessor:function(t){return this.processors.exists(t)&&(this.processors.remove(t,!0),t.emitter=null),t},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(t){return this.addParticleProcessor(new d(t))},reserve:function(t){var e=this.dead;if(this.maxParticles>0){var i=this.getParticleCount();i+t>this.maxParticles&&(t=this.maxParticles-(i+t))}for(var n=0;n<t;n++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles||this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var i=this.alive,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},forEachDead:function(t,e){for(var i=this.dead,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},start:function(t,e){return void 0===t&&(t=0),this.emitting||(t>0&&this.fastForward(t),this.emitting=!0,this.resetCounters(this.frequency,!0),void 0!==e&&(this.duration=Math.abs(e)),this.emit(h.START,this)),this},stop:function(t){return void 0===t&&(t=!1),this.emitting&&(this.emitting=!1,t&&this.killAll(),this.emit(h.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(t,e){return void 0===t&&(t=""),void 0===e&&(e=this.true),this.sortProperty=t,this.sortOrderAsc=e,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(t){return t=""!==this.sortProperty?this.depthSortCallback:null,this.sortCallback=t,this},depthSort:function(){return A(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(t,e){var i=this.sortProperty;return this.sortOrderAsc?t[i]-e[i]:e[i]-t[i]},flow:function(t,e,i){return void 0===e&&(e=1),this.emitting=!1,this.frequency=t,this.quantity=e,void 0!==i&&(this.stopAfter=i),this.start()},explode:function(t,e,i){this.frequency=-1,this.resetCounters(-1,!0);var n=this.emitParticle(t,e,i);return this.emit(h.EXPLODE,this,n),n},emitParticleAt:function(t,e,i){return this.emitParticle(i,t,e)},emitParticle:function(t,e,i){if(!this.atLimit()){void 0===t&&(t=this.ops.quantity.onEmit());for(var n=this.dead,s=this.stopAfter,r=this.follow?this.follow.x+this.followOffset.x:e,a=this.follow?this.follow.y+this.followOffset.y:i,o=0;o<t;o++){var h=n.pop();if(h||(h=new this.particleClass(this)),h.fire(r,a)?(this.particleBringToTop?this.alive.push(h):this.alive.unshift(h),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,h,this)):this.dead.push(h),s>0&&(this.stopCounter++,this.stopCounter>=s))break;if(this.atLimit())break}return h}},fastForward:function(t,e){void 0===e&&(e=1e3/60);var i=0;for(this.skipping=!0;i<Math.abs(t);)this.preUpdate(0,e),i+=e;return this.skipping=!1,this},preUpdate:function(t,e){var i=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var n=this.getProcessors(),s=this.alive,r=this.dead,a=0,o=[],l=s.length;for(a=0;a<l;a++){var u=s[a];u.update(e,i,n)&&o.push({index:a,particle:u})}if((l=o.length)>0){var c=this.deathCallback,d=this.deathCallbackScope;for(a=l-1;a>=0;a--){var f=o[a];s.splice(f.index,1),r.push(f.particle),c&&c.call(d,f.particle),f.particle.setPosition()}}if(this.emitting||this.skipping){if(0===this.frequency)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=e;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())}else 1===this.completeFlag&&0===s.length&&(this.completeFlag=0,this.emit(h.COMPLETE,this))},overlap:function(t){for(var e=this.getWorldTransformMatrix(),i=this.alive,n=i.length,s=[],r=0;r<n;r++){var a=i[r];E(t,a.getBounds(e))&&s.push(a)}return s},getBounds:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1e3/60),void 0===s&&(s=new S);var r,a,o=this.getWorldTransformMatrix(),h=this.alive,l=!1;if(s.setTo(0,0,0,0),e>0){var u=0;for(this.skipping=!0;u<Math.abs(e);){for(this.preUpdate(0,i),r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));u+=i}this.skipping=!1}else for(r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));return t>0&&v(s,t,t),s},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(t){this.ops.x.onChange(t)}},particleY:{get:function(){return this.ops.y.current},set:function(t){this.ops.y.onChange(t)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(t){this.ops.accelerationX.onChange(t)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(t){this.ops.accelerationY.onChange(t)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(t){this.ops.maxVelocityX.onChange(t)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(t){this.ops.maxVelocityY.onChange(t)}},speed:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t),this.ops.speedY.onChange(t)}},speedX:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t)}},speedY:{get:function(){return this.ops.speedY.current},set:function(t){this.ops.speedY.onChange(t)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(t){this.ops.moveToX.onChange(t)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(t){this.ops.moveToY.onChange(t)}},bounce:{get:function(){return this.ops.bounce.current},set:function(t){this.ops.bounce.onChange(t)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(t){this.ops.scaleX.onChange(t)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(t){this.ops.scaleY.onChange(t)}},particleColor:{get:function(){return this.ops.color.current},set:function(t){this.ops.color.onChange(t)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(t){this.ops.color.setEase(t)}},particleTint:{get:function(){return this.ops.tint.current},set:function(t){this.ops.tint.onChange(t)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(t){this.ops.alpha.onChange(t)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(t){this.ops.lifespan.onChange(t)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(t){this.ops.angle.onChange(t)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(t){this.ops.rotate.onChange(t)}},quantity:{get:function(){return this.ops.quantity.current},set:function(t){this.ops.quantity.onChange(t)}},delay:{get:function(){return this.ops.delay.current},set:function(t){this.ops.delay.onChange(t)}},hold:{get:function(){return this.ops.hold.current},set:function(t){this.ops.hold.onChange(t)}},flowCounter:{get:function(){return this.counters[0]},set:function(t){this.counters[0]=t}},frameCounter:{get:function(){return this.counters[1]},set:function(t){this.counters[1]=t}},animCounter:{get:function(){return this.counters[2]},set:function(t){this.counters[2]=t}},elapsed:{get:function(){return this.counters[3]},set:function(t){this.counters[3]=t}},stopCounter:{get:function(){return this.counters[4]},set:function(t){this.counters[4]=t}},completeFlag:{get:function(){return this.counters[5]},set:function(t){this.counters[5]=t}},zoneIndex:{get:function(){return this.counters[6]},set:function(t){this.counters[6]=t}},zoneTotal:{get:function(){return this.counters[7]},set:function(t){this.counters[7]=t}},currentFrame:{get:function(){return this.counters[8]},set:function(t){this.counters[8]=t}},currentAnim:{get:function(){return this.counters[9]},set:function(t){this.counters[9]=t}},preDestroy:function(){var t;this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var e=this.ops;for(t=0;t<O.length;t++){e[O[t]].destroy()}for(t=0;t<this.alive.length;t++)this.alive[t].destroy();for(t=0;t<this.dead.length;t++)this.dead[t].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});return ik=F}function Eq(){if(lk)return hk;lk=1;var t=Kh(),e=_c(),i=tq(),n=new t({Extends:i,Mixins:[e.PathFollower],initialize:function(t,e,n,s,r,a){i.call(this,t,n,s,r,a),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});return hk=n}function _q(){if(ck)return uk;ck=1;var t=Kh(),e=JV(),i=QV(),n=new t({Extends:i,initialize:function(t,n,s,r,a,o){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=32),void 0===a&&(a=32),void 0===o&&(o=!0);var h=new e(t.sys.textures,"",r,a,o);i.call(this,t,n,s,h),this.type="RenderTexture",this.camera=this.texture.camera,this._saved=!1},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},resize:function(t,e,i){return this.texture.setSize(t,e,i),this.setSize(this.texture.width,this.texture.height),this},saveTexture:function(t){var e=this.texture;return e.key=t,e.manager.addDynamicTexture(e)&&(this._saved=!0),e},fill:function(t,e,i,n,s,r){return this.texture.fill(t,e,i,n,s,r),this},clear:function(){return this.texture.clear(),this},stamp:function(t,e,i,n,s){return this.texture.stamp(t,e,i,n,s),this},erase:function(t,e,i){return this.texture.erase(t,e,i),this},draw:function(t,e,i,n,s){return this.texture.draw(t,e,i,n,s),this},drawFrame:function(t,e,i,n,s,r){return this.texture.drawFrame(t,e,i,n,s,r),this},repeat:function(t,e,i,n,s,r,a,o,h){return this.texture.repeat(t,e,i,n,s,r,a,o,h),this},beginDraw:function(){return this.texture.beginDraw(),this},batchDraw:function(t,e,i,n,s){return this.texture.batchDraw(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){return this.texture.batchDrawFrame(t,e,i,n,s,r),this},endDraw:function(t){return this.texture.endDraw(t),this},snapshotArea:function(t,e,i,n,s,r,a){return this.texture.snapshotArea(t,e,i,n,s,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},preDestroy:function(){this.camera=null,this._saved||this.texture.destroy()}});return uk=n}function Cq(){if(gk)return pk;gk=1;var t=Vl();return pk=function(e,i){var n=i.width,s=i.height,r=Math.floor(n/2),a=Math.floor(s/2),o=t(i,"chars","");if(""!==o){var h=t(i,"image",""),l=e.sys.textures.getFrame(h),u=l.cutX,c=l.cutY,d=l.source.width,f=l.source.height,p=t(i,"offset.x",0),g=t(i,"offset.y",0),v=t(i,"spacing.x",0),m=t(i,"spacing.y",0),y=t(i,"lineSpacing",0),x=t(i,"charsPerRow",null);null===x&&(x=d/n)>o.length&&(x=o.length);for(var w=p,b=g,T={retroFont:!0,font:h,size:n,lineHeight:s+y,chars:{}},S=0,E=0;E<o.length;E++){var _=o.charCodeAt(E),C=(u+w)/d,A=(c+b)/f,P=(u+w+n)/d,M=(c+b+s)/f;T.chars[_]={x:w,y:b,width:n,height:s,centerX:r,centerY:a,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{},u0:C,v0:A,u1:P,v1:M},++S===x?(S=0,w=p,b+=s+m):w+=n+v}return{data:T,frame:null,texture:h}}},pk}function Aq(){if(mk)return vk;mk=1;var t=fk?dk:(fk=1,dk={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}),e=nh(),i={Parse:Cq()};return i=e(!1,i,t),vk=i}function Pq(){if(Sk)return Tk;Sk=1;var t=qh(),e=t,i=t;return e=function(){if(xk)return yk;xk=1;var t=yj(),e=_W();return yk=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline,n),o=t(n,s,r).calc,h=n.vertices,l=n.uv,u=n.colors,c=n.alphas,d=n.alpha,f=e.getTintAppendFloatAlpha,p=s.roundPixels,g=h.length,v=Math.floor(.5*g);a.flush(),i.pipelines.preBatch(n);var m=a.setGameObject(n),y=a.vertexViewF32,x=a.vertexViewU32,w=a.vertexCount*a.currentShader.vertexComponentCount-1,b=0,T=n.tintFill;n.dirty&&n.updateVertices();for(var S=n.debugCallback,E=[],_=0;_<g;_+=2){var C=h[_+0],A=h[_+1],P=C*o.a+A*o.c+o.e,M=C*o.b+A*o.d+o.f;p&&(P=Math.round(P),M=Math.round(M)),y[++w]=P,y[++w]=M,y[++w]=l[_+0],y[++w]=l[_+1],y[++w]=m,y[++w]=T,x[++w]=f(u[b],s.alpha*(c[b]*d)),b++,S&&(E[_+0]=P,E[_+1]=M)}S&&S.call(n,n,g,E),a.vertexCount+=v,a.currentBatch.count=a.vertexCount-a.currentBatch.start,i.pipelines.postBatch(n)},yk}(),i=bk?wk:(bk=1,wk=function(){}),Tk={renderWebGL:e,renderCanvas:i}}function Mq(){if(_k)return Ek;_k=1;var t=mX(),e=Kh(),i=_c(),n=fU(),s=dW(),r=Pq(),a=qu(),o=new e({Extends:n,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Flip,i.Mask,i.Pipeline,i.PostPipeline,i.Size,i.Texture,i.Transform,i.Visible,i.ScrollFactor,r],initialize:function(e,i,r,o,h,l,u,c,d){void 0===o&&(o="__DEFAULT"),void 0===l&&(l=2),void 0===u&&(u=!0),n.call(this,e,"Rope"),this.anims=new t(this),this.points=l,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===o,this.dirty=!1,this.horizontal=u,this._flipX=!1,this._flipY=!1,this._perp=new a,this.debugCallback=null,this.debugGraphic=null,this.setTexture(o,h),this.setPosition(i,r),this.setSizeToFrame(),this.initPipeline(s.ROPE_PIPELINE),this.initPostPipeline(),Array.isArray(l)&&this.resizeArrays(l.length),this.setPoints(l,c,d),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){var i=this.anims.currentFrame;this.anims.update(t,e),this.anims.currentFrame!==i&&(this.updateUVs(),this.updateVertices())},play:function(t,e,i){return this.anims.play(t,e,i),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(t,e,i))},setVertical:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(t,e,i)):this},setTintFill:function(t){return void 0===t&&(t=!1),this.tintFill=t,this},setAlphas:function(t,e){var i=this.points.length;if(i<1)return this;var n,s=this.alphas;void 0===t?t=[1]:Array.isArray(t)||void 0!==e||(t=[t]);var r=0;if(void 0!==e)for(n=0;n<i;n++)s[r=2*n]=t,s[r+1]=e;else if(t.length===i)for(n=0;n<i;n++)s[r=2*n]=t[n],s[r+1]=t[n];else{var a=t[0];for(n=0;n<i;n++)r=2*n,t.length>r&&(a=t[r]),s[r]=a,t.length>r+1&&(a=t[r+1]),s[r+1]=a}return this},setColors:function(t){var e=this.points.length;if(e<1)return this;var i,n=this.colors;void 0===t?t=[16777215]:Array.isArray(t)||(t=[t]);var s=0;if(t.length===e)for(i=0;i<e;i++)n[s=2*i]=t[i],n[s+1]=t[i];else{var r=t[0];for(i=0;i<e;i++)s=2*i,t.length>s&&(r=t[s]),n[s]=r,t.length>s+1&&(r=t[s+1]),n[s+1]=r}return this},setPoints:function(t,e,i){if(void 0===t&&(t=2),"number"==typeof t){var n,s,r,a=t;if(a<2&&(a=2),t=[],this.horizontal)for(r=-this.frame.halfWidth,s=this.frame.width/(a-1),n=0;n<a;n++)t.push({x:r+n*s,y:0});else for(r=-this.frame.halfHeight,s=this.frame.height/(a-1),n=0;n<a;n++)t.push({x:0,y:r+n*s})}var o=t.length,h=this.points.length;return o<1?(console.warn("Rope: Not enough points given"),this):(1===o&&(t.unshift({x:0,y:0}),o++),h!==o&&this.resizeArrays(o),this.dirty=!0,this.points=t,this.updateUVs(),null!=e&&this.setColors(e),null!=i&&this.setAlphas(i),this)},updateUVs:function(){for(var t=this.uv,e=this.points.length,i=this.frame.u0,n=this.frame.v0,s=this.frame.u1,r=this.frame.v1,a=(s-i)/(e-1),o=(r-n)/(e-1),h=0;h<e;h++){var l,u,c,d,f=4*h;this.horizontal?(this._flipX?(l=s-h*a,c=s-h*a):(l=i+h*a,c=i+h*a),this._flipY?(u=r,d=n):(u=n,d=r)):(this._flipX?(l=i,c=s):(l=s,c=i),this._flipY?(u=r-h*o,d=r-h*o):(u=n+h*o,d=n+h*o)),t[f+0]=l,t[f+1]=u,t[f+2]=c,t[f+3]=d}return this},resizeArrays:function(t){var e=this.colors,i=this.alphas;this.vertices=new Float32Array(4*t),this.uv=new Float32Array(4*t),e=new Uint32Array(2*t),i=new Float32Array(2*t);for(var n=0;n<2*t;n++)e[n]=16777215,i[n]=1;return this.colors=e,this.alphas=i,this.dirty=!0,this},updateVertices:function(){var t=this._perp,e=this.points,i=this.vertices,n=e.length;if(this.dirty=!1,!(n<1)){for(var s,r=e[0],a=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,o=0;o<n;o++){var h=e[o],l=4*o;s=o<n-1?e[o+1]:h,t.x=s.y-r.y,t.y=-(s.x-r.x);var u=t.length();t.x/=u,t.y/=u,t.x*=a,t.y*=a,i[l]=h.x+t.x,i[l+1]=h.y+t.y,i[l+2]=h.x-t.x,i[l+3]=h.y-t.y,r=h}return this}},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts:function(t,e,i){var n=t.debugGraphic,s=i[0],r=i[1],a=i[2],o=i[3];n.lineBetween(s,r,a,o);for(var h=4;h<e;h+=4){var l=i[h+0],u=i[h+1],c=i[h+2],d=i[h+3];n.lineBetween(s,r,l,u),n.lineBetween(a,o,c,d),n.lineBetween(a,o,l,u),n.lineBetween(l,u,c,d),s=l,r=u,a=c,o=d}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(t){return this._flipX=t,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(t){return this._flipY=t,this.updateUVs()}}});return Ek=o}function Rq(){if(Ak)return Ck;Ak=1;return Ck=function(t,e,i){var n=t.canvas,s=t.context,r=t.style,a=[],o=0,h=i.length;r.maxLines>0&&r.maxLines<i.length&&(h=r.maxLines),r.syncFont(n,s);for(var l=t.letterSpacing,u=0;u<h;u++){var c=r.strokeThickness;if(0===l)c+=s.measureText(i[u]).width;else{for(var d=i[u],f=0;f<d.length;f++)c+=s.measureText(d[f]).width;d.length>1&&(c+=l*(d.length-1))}r.wordWrap&&(c-=s.measureText(" ").width),a[u]=Math.ceil(c),o=Math.max(o,a[u])}var p=e.fontSize+r.strokeThickness,g=p*h,v=t.lineSpacing;return h>1&&(g+=v*(h-1)),{width:o,height:g,lines:h,lineWidths:a,lineSpacing:v,lineHeight:p}},Ck}function Lq(){if(Fk)return Ok;Fk=1;var t=qh(),e=t;return e=function(){if(Mk)return Pk;Mk=1;var t=_W();return Pk=function(e,i,n,s){if(0!==i.width&&0!==i.height){n.addToRenderList(i);var r=i.frame,a=r.width,o=r.height,h=t.getTintAppendFloatAlpha,l=e.pipelines.set(i.pipeline,i),u=l.setTexture2D(r.glTexture,i);l.batchTexture(i,r.glTexture,a,o,i.x,i.y,a/i.style.resolution,o/i.style.resolution,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.displayOriginX,i.displayOriginY,0,0,a,o,h(i.tintTopLeft,n.alpha*i._alphaTL),h(i.tintTopRight,n.alpha*i._alphaTR),h(i.tintBottomLeft,n.alpha*i._alphaBL),h(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,0,0,n,s,!1,u)}},Pk}(),Lk||(Lk=1,Rk=function(t,e,i,n){0!==e.width&&0!==e.height&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),Ok={renderWebGL:e,renderCanvas:Rk}}function Oq(){if(Ik)return Dk;Ik=1;var t=ou();return Dk=function(e){var i=t.create(this),n=i.getContext("2d",{willReadFrequently:!0});e.syncFont(i,n);var s=n.measureText(e.testString);if("actualBoundingBoxAscent"in s){var r=s.actualBoundingBoxAscent,a=s.actualBoundingBoxDescent;return t.remove(i),{ascent:r,descent:a,fontSize:r+a}}var o=Math.ceil(s.width*e.baselineX),h=o,l=2*h;h=h*e.baselineY|0,i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(e.testString,0,h);var u={ascent:0,descent:0,fontSize:0},c=n.getImageData(0,0,o,l);if(!c)return u.ascent=h,u.descent=h+6,u.fontSize=u.ascent+u.descent,t.remove(i),u;var d,f,p=c.data,g=p.length,v=4*o,m=0,y=!1;for(d=0;d<h;d++){for(f=0;f<v;f+=4)if(255!==p[m+f]){y=!0;break}if(y)break;m+=v}for(u.ascent=h-d,m=g-v,y=!1,d=l;d>h;d--){for(f=0;f<v;f+=4)if(255!==p[m+f]){y=!0;break}if(y)break;m-=v}return u.descent=d-h,u.fontSize=u.ascent+u.descent,t.remove(i),u},Dk}function Fq(){if(Bk)return kk;Bk=1;var t=Kh(),e=xj(),i=Vl(),n=Oq(),s={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|MÃâ°qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},r=new t({initialize:function(t,e){this.parent=t,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(e,!1,!0)},setStyle:function(t,r,a){for(var o in void 0===r&&(r=!0),void 0===a&&(a=!1),s){var h=a?s[o][1]:this[o];"wordWrapCallback"===o||"wordWrapCallbackScope"===o?this[o]=i(t,s[o][0],h):t&&"fontSize"===o&&"number"==typeof t.fontSize?this[o]=t.fontSize.toString()+"px":this[o]=e(t,s[o][0],h)}var l=i(t,"font",null);null!==l&&this.setFont(l,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var u=i(t,"fill",null);null!==u&&(this.color=u);var c=i(t,"metrics",!1);return c?this.metrics={ascent:i(c,"ascent",0),descent:i(c,"descent",0),fontSize:i(c,"fontSize",0)}:!r&&this.metrics||(this.metrics=n(this)),r?this.parent.updateText():this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=n(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,s="",r="";if("string"!=typeof t)n=i(t,"fontFamily","Courier"),s=i(t,"fontSize","16px"),r=i(t,"fontStyle","");else{var a=t.split(" "),o=0;r=a.length>2?a[o++]:"",s=a[o++]||"16px",n=a[o++]||"Courier"}return n===this.fontFamily&&s===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=s,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=n,this.shadowStroke=s,this.shadowFill=r,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in s)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});return kk=r}function Dq(){if(zk)return Nk;zk=1;return Nk=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}}function Iq(){if(Yk)return Uk;Yk=1;var t=cV(),e=ou(),i=Kh(),n=_c(),s=fU(),r=Rq(),a=Vl(),o=TV(),h=Lq(),l=Fq(),u=Dq(),c=new i({Extends:s,Mixins:[n.Alpha,n.BlendMode,n.ComputedSize,n.Crop,n.Depth,n.Flip,n.GetBounds,n.Mask,n.Origin,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Tint,n.Transform,n.Visible,h],initialize:function(t,i,n,r,a){void 0===i&&(i=0),void 0===n&&(n=0),s.call(this,t,"Text"),this.renderer=t.sys.renderer,this.setPosition(i,n),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=e.create(this),this.context,this.style=new l(this,a),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=u(),this.texture=t.sys.textures.addCanvas(this._textureKey,this.canvas),this.context=this.texture.context,this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(r),a&&a.padding&&this.setPadding(a.padding),a&&a.lineSpacing&&this.setLineSpacing(a.lineSpacing),a&&a.letterSpacing&&this.setLetterSpacing(a.letterSpacing)},initRTL:function(){if(!this.style.rtl)return this.canvas.dir="ltr",void(this.context.direction="ltr");this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas),this.originX=1},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var i=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(i)&&(i=i.join("\n")),i}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,i){for(var n="",s=t.replace(/ +/gi," ").split(this.splitRegExp),r=s.length,a=0;a<r;a++){var o=s[a],h="",l=(o=o.replace(/^ *|\s*$/gi,"")).length*this.letterSpacing;if(e.measureText(o).width+l<i)n+=o+"\n";else{for(var u=i,c=o.split(" "),d=0;d<c.length;d++){var f=c[d],p=f+" ",g=p.length*this.letterSpacing,v=e.measureText(p).width+g;if(v>u){if(0===d){for(var m=p;m.length;){var y=(m=m.slice(0,-1)).length*this.letterSpacing;if((v=e.measureText(m).width+y)<=u)break}if(!m.length)throw new Error("wordWrapWidth < a single character");var x=f.substr(m.length);c[d]=x,h+=m}var w=c[d].length?d:d+1,b=c.slice(w).join(" ").replace(/[ \n]*$/gi,"");s.splice(a+1,0,b),r=s.length;break}h+=p,u-=v}n+=h.replace(/[ \n]*$/gi,"")+"\n"}}return n=n.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,i){for(var n="",s=t.split(this.splitRegExp),r=s.length-1,a=e.measureText(" ").width,o=0;o<=r;o++){for(var h=i,l=s[o].split(" "),u=l.length-1,c=0;c<=u;c++){var d=l[c],f=d.length*this.letterSpacing,p=e.measureText(d).width+f,g=p;c<u&&(g+=a),g>h&&c>0&&(n+="\n",h=i),n+=d,c<u?(n+=" ",h-=g):h-=p}o<r&&(n+="\n")}return n},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},appendText:function(t,e){void 0===e&&(e=!0),t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t=t.toString();var i=this._text.concat(e?"\n"+t:t);return i!==this._text&&(this._text=i,this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,i,n,s,r){return this.style.setShadow(t,e,i,n,s,r)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setLetterSpacing:function(t){return this.letterSpacing=t,this.updateText()},setPadding:function(t,e,i,n){if("object"==typeof t){var s=t,r=a(s,"x",null);null!==r?(t=r,i=r):(t=a(s,"left",0),i=a(s,"right",t));var o=a(s,"y",null);null!==o?(e=o,n=o):(e=a(s,"top",0),n=a(s,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=n,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},setRTL:function(e){void 0===e&&(e=!0);var i=this.style;return i.rtl===e||(i.rtl=e,e?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),"left"===i.align?i.align="right":"right"===i.align&&(i.align="left")),this},updateText:function(){var t=this.canvas,e=this.context,i=this.style,n=i.resolution,s=i.metrics;i.syncFont(t,e);var a=this._text;(i.wordWrapWidth||i.wordWrapCallback)&&(a=this.runWordWrap(this._text));var o,h=a.split(this.splitRegExp),l=r(this,s,h),u=this.padding;0===i.fixedWidth?(this.width=l.width+u.left+u.right,o=l.width):(this.width=i.fixedWidth,(o=this.width-u.left-u.right)<l.width&&(o=l.width)),0===i.fixedHeight?this.height=l.height+u.top+u.bottom:this.height=i.fixedHeight;var c,d,f=this.width,p=this.height;this.updateDisplayOrigin(),f*=n,p*=n,f=Math.max(f,1),p=Math.max(p,1),t.width!==f||t.height!==p?(t.width=f,t.height=p,this.frame.setSize(f,p),i.syncFont(t,e),i.rtl&&(e.direction="rtl")):e.clearRect(0,0,f,p),e.save(),e.scale(n,n),i.backgroundColor&&(e.fillStyle=i.backgroundColor,e.fillRect(0,0,f,p)),i.syncStyle(t,e),e.translate(u.left,u.top);for(var g=0;g<l.lines;g++){if(c=i.strokeThickness/2,d=i.strokeThickness/2+g*l.lineHeight+s.ascent,g>0&&(d+=l.lineSpacing*g),i.rtl)c=f-c-u.left-u.right;else if("right"===i.align)c+=o-l.lineWidths[g];else if("center"===i.align)c+=(o-l.lineWidths[g])/2;else if("justify"===i.align){if(l.lineWidths[g]/l.width>=.85){var v=l.width-l.lineWidths[g],m=e.measureText(" ").width,y=h[g].trim(),x=y.split(" ");v+=(h[g].length-y.length)*m;for(var w=Math.floor(v/m),b=0;w>0;)x[b]+=" ",b=(b+1)%(x.length-1||1),--w;h[g]=x.join(" ")}}this.autoRound&&(c=Math.round(c),d=Math.round(d));var T=this.letterSpacing;if(i.strokeThickness&&0===T&&(i.syncShadow(e,i.shadowStroke),e.strokeText(h[g],c,d)),i.color)if(i.syncShadow(e,i.shadowFill),0!==T)for(var S=0,E=h[g].split(""),_=0;_<E.length;_++)i.strokeThickness&&(i.syncShadow(e,i.shadowStroke),e.strokeText(E[_],c+S,d),i.syncShadow(e,i.shadowFill)),e.fillText(E[_],c+S,d),S+=e.measureText(E[_]).width+T;else e.fillText(h[g],c,d)}e.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture.spectorMetadata={textureKey:"Text Game Object"});var C=this.input;return C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=n.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){o(this.canvas),e.remove(this.canvas);var t=this.texture;t&&t.destroy()}});return Uk=c}function kq(){if(jk)return Vk;jk=1;var t=qh(),e=t;return e=function(){if(Gk)return Xk;Gk=1;var t=_W();return Xk=function(e,i,n,s){i.updateCanvas();var r=i.width,a=i.height;if(0!==r&&0!==a){n.addToRenderList(i);var o=t.getTintAppendFloatAlpha,h=e.pipelines.set(i.pipeline,i),l=h.setTexture2D(i.fillPattern,i);h.batchTexture(i,i.fillPattern,i.displayFrame.width*i.tileScaleX,i.displayFrame.height*i.tileScaleY,i.x,i.y,r,a,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.originX*r,i.originY*a,0,0,r,a,o(i.tintTopLeft,n.alpha*i._alphaTL),o(i.tintTopRight,n.alpha*i._alphaTR),o(i.tintBottomLeft,n.alpha*i._alphaBL),o(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,i.tilePositionX%i.displayFrame.width/i.displayFrame.width,i.tilePositionY%i.displayFrame.height/i.displayFrame.height,n,s,!1,l)}},Xk}(),Hk||(Hk=1,Wk=function(t,e,i,n){e.updateCanvas(),i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),Vk={renderWebGL:e,renderCanvas:Wk}}function Bq(){if(Kk)return qk;Kk=1;var t=ou(),e=Kh(),i=_c(),n=fU(),s=MG(),r=au(),a=kq(),o=Dq(),h=qu(),l=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Crop,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Tint,i.Transform,i.Visible,a],initialize:function(e,i,r,a,l,u,c){var d=e.sys.renderer;n.call(this,e,"TileSprite");var f=e.sys.textures.get(u),p=f.get(c);p.source.compressionAlgorithm&&(console.warn("TileSprite cannot use compressed texture"),p=(f=e.sys.textures.get("__MISSING")).get()),"DynamicTexture"===f.type&&(console.warn("TileSprite cannot use Dynamic Texture"),p=(f=e.sys.textures.get("__MISSING")).get()),a&&l?(a=Math.floor(a),l=Math.floor(l)):(a=a||p.width,l=l||p.height),this._tilePosition=new h,this._tileScale=new h(1,1),this.dirty=!1,this.renderer=d,this.canvas=t.create(this,a,l),this.context=this.canvas.getContext("2d",{willReadFrequently:!1}),this.displayTexture=f,this.displayFrame=p,this._crop=this.resetCropObject(),this._textureKey=o(),this.texture=e.sys.textures.addCanvas(this._textureKey,this.canvas),this.frame=this.texture.get(),this.potWidth=s(p.width),this.potHeight=s(p.height),this.fillCanvas=t.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d",{willReadFrequently:!1}),this.fillPattern=null,this.setPosition(i,r),this.setSize(a,l),this.setFrame(c),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){var e=this.displayTexture.get(t);return this.potWidth=s(e.width),this.potHeight=s(e.height),this.canvas.width=0,e.cutWidth&&e.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=e,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,i=this.fillCanvas,n=this.potWidth,s=this.potHeight;this.renderer&&this.renderer.gl||(n=t.cutWidth,s=t.cutHeight),e.clearRect(0,0,n,s),i.width=n,i.height=s,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,n,s),this.renderer&&this.renderer.gl?(this.fillPattern=this.renderer.canvasToTexture(i,this.fillPattern),this.fillPattern.spectorMetadata={textureKey:"TileSprite Game Object"}):this.fillPattern=e.createPattern(i,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||r.disable(e);var i=this._tileScale.x,n=this._tileScale.y,s=this._tilePosition.x,a=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(i,n),e.translate(-s,-a),e.fillStyle=this.fillPattern,e.fillRect(s,a,this.width/i,this.height/n),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),t.remove(this.canvas),t.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null;var e=this.texture;e&&e.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});return qk=l}function Nq(){if(JB)return ZB;JB=1;qh();return jB||(jB=1,VB=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),e.pipeline.batchSprite(e,i,n))}),KB||(KB=1,qB=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),ZB={renderWebGL:VB,renderCanvas:qB}}function zq(){if(QB)return $B;QB=1;var t=tl(),e=Kh(),i=_c(),n=dU(),s=pX(),r=fU(),a=il(),o=HB?WB:(HB=1,WB={COMPLETE:Jk?Zk:(Jk=1,Zk="complete"),DECODED:Qk?$k:(Qk=1,$k="decoded"),DECODED_ALL:eB?tB:(eB=1,tB="decodedall"),DESTROY:nB?iB:(nB=1,iB="destroy"),DETUNE:rB?sB:(rB=1,sB="detune"),GLOBAL_DETUNE:oB?aB:(oB=1,aB="detune"),GLOBAL_MUTE:lB?hB:(lB=1,hB="mute"),GLOBAL_RATE:cB?uB:(cB=1,uB="rate"),GLOBAL_VOLUME:fB?dB:(fB=1,dB="volume"),LOOP:gB?pB:(gB=1,pB="loop"),LOOPED:mB?vB:(mB=1,vB="looped"),MUTE:xB?yB:(xB=1,yB="mute"),PAN:bB?wB:(bB=1,wB="pan"),PAUSE_ALL:SB?TB:(SB=1,TB="pauseall"),PAUSE:_B?EB:(_B=1,EB="pause"),PLAY:AB?CB:(AB=1,CB="play"),RATE:MB?PB:(MB=1,PB="rate"),RESUME_ALL:LB?RB:(LB=1,RB="resumeall"),RESUME:FB?OB:(FB=1,OB="resume"),SEEK:IB?DB:(IB=1,DB="seek"),STOP_ALL:BB?kB:(BB=1,kB="stopall"),STOP:zB?NB:(zB=1,NB="stop"),UNLOCKED:YB?UB:(YB=1,UB="unlocked"),VOLUME:GB?XB:(GB=1,XB="volume")}),h=Dq(),l=Nq(),u=new e({Extends:r,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.TextureCrop,i.Tint,i.Transform,i.Visible,l],initialize:function(t,e,i,n){r.call(this,t,"Video"),this.video,this.videoTexture,this.videoTextureSource,this.snapshotTexture,this.flipY=!1,this._key=h(),this.touchLocked=!1,this.playWhenUnlocked=!1,this.frameReady=!1,this.isStalled=!1,this.failedPlayAttempts=0,this.metadata,this.retry=0,this.retryInterval=500,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={ended:this.completeHandler.bind(this),legacy:this.legacyPlayHandler.bind(this),playing:this.playingHandler.bind(this),seeked:this.seekedHandler.bind(this),seeking:this.seekingHandler.bind(this),stalled:this.stalledHandler.bind(this),suspend:this.stalledHandler.bind(this),waiting:this.stalledHandler.bind(this)},this._loadCallbackHandler=this.loadErrorHandler.bind(this),this._metadataCallbackHandler=this.metadataHandler.bind(this),this._crop=this.resetCropObject(),this.markers={},this._markerIn=0,this._markerOut=0,this._playingMarker=!1,this._lastUpdate=0,this.cacheKey="",this.isSeeking=!1,this._playCalled=!1,this._getFrame=!1,this._rfvCallbackId=0;var a=t.sys.game;this._device=a.device.video,this.setPosition(e,i),this.setSize(256,256),this.initPipeline(),this.initPostPipeline(!0),a.events.on(s.PAUSE,this.globalPause,this),a.events.on(s.RESUME,this.globalResume,this);var l=t.sys.sound;l&&l.on(o.GLOBAL_MUTE,this.globalMute,this),n&&this.load(n)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},load:function(t){var e=this.scene.sys.cache.video.get(t);return e?(this.cacheKey=t,this.loadHandler(e.url,e.noAudio,e.crossOrigin)):console.warn("No video in cache for key: "+t),this},changeSource:function(t,e,i,n,s){void 0===e&&(e=!0),void 0===i&&(i=!1),this.cacheKey!==t&&(this.load(t),e&&this.play(i,n,s))},getVideoKey:function(){return this.cacheKey},loadURL:function(t,e,i){void 0===e&&(e=!1);var n=this._device.getVideoURL(t);return n?(this.cacheKey="",this.loadHandler(n.url,e,i)):console.warn("No supported video format found for "+t),this},loadMediaStream:function(t,e,i){return this.loadHandler(null,e,i,t)},loadHandler:function(t,e,i,n){e||(e=!1);var s=this.video;if(s?(this.removeLoadEventHandlers(),this.stop()):((s=document.createElement("video")).controls=!1,s.setAttribute("playsinline","playsinline"),s.setAttribute("preload","auto"),s.setAttribute("disablePictureInPicture","true")),e?(s.muted=!0,s.defaultMuted=!0,s.setAttribute("autoplay","autoplay")):(s.muted=!1,s.defaultMuted=!1,s.removeAttribute("autoplay")),i?s.setAttribute("crossorigin",i):s.removeAttribute("crossorigin"),n)if("srcObject"in s)try{s.srcObject=n}catch(t){if("TypeError"!==t.name)throw t;s.src=URL.createObjectURL(n)}else s.src=URL.createObjectURL(n);else s.src=t;this.retry=0,this.video=s,this._playCalled=!1,s.load(),this.addLoadEventHandlers();var r=this.scene.sys.textures.get(this._key);return this.setTexture(r),this},requestVideoFrame:function(t,e){var i=this.video;if(i){var s=e.width,r=e.height,a=this.videoTexture,o=this.videoTextureSource,h=!a||o.source!==i;h?(this._codePaused=i.paused,this._codeMuted=i.muted,a?(o.source=i,o.width=s,o.height=r,a.get().setSize(s,r)):((a=this.scene.sys.textures.create(this._key,i,s,r)).add("__BASE",0,0,0,s,r),this.setTexture(a),this.videoTexture=a,this.videoTextureSource=a.source[0],this.videoTextureSource.setFlipY(this.flipY),this.emit(n.VIDEO_TEXTURE,this,a)),this.setSizeToFrame(),this.updateDisplayOrigin()):o.update(),this.isStalled=!1,this.metadata=e;var l=e.mediaTime;h&&(this._lastUpdate=l,this.emit(n.VIDEO_CREATED,this,s,r),this.frameReady||(this.frameReady=!0,this.emit(n.VIDEO_PLAY,this))),this._playingMarker?l>=this._markerOut&&(i.loop?(i.currentTime=this._markerIn,this.emit(n.VIDEO_LOOP,this)):(this.stop(!1),this.emit(n.VIDEO_COMPLETE,this))):l<this._lastUpdate&&this.emit(n.VIDEO_LOOP,this),this._lastUpdate=l,this._getFrame?(this.removeEventHandlers(),i.pause(),this._getFrame=!1):this._rfvCallbackId=this.video.requestVideoFrameCallback(this.requestVideoFrame.bind(this))}},play:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=a.MAX_SAFE_INTEGER);var n=this.video;return!n||this.isPlaying()?(n||console.warn("Video not loaded"),this):(void 0===t&&(t=n.loop),n.loop=t,this._markerIn=e,this._markerOut=i,this._playingMarker=e>-1&&i>e&&i<a.MAX_SAFE_INTEGER,this._playCalled||(this._getFrame=!1,this._rfvCallbackId=n.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this._playCalled=!0,this.createPlayPromise()),this)},getFirstFrame:function(){var t=this.video;return!t||this.isPlaying()?(t||console.warn("Video not loaded"),this):(this._playCalled||(this._getFrame=!0,this._rfvCallbackId=t.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this.createPlayPromise()),this)},addLoadEventHandlers:function(){var t=this.video;t&&(t.addEventListener("error",this._loadCallbackHandler),t.addEventListener("abort",this._loadCallbackHandler),t.addEventListener("loadedmetadata",this._metadataCallbackHandler))},removeLoadEventHandlers:function(){var t=this.video;t&&(t.removeEventListener("error",this._loadCallbackHandler),t.removeEventListener("abort",this._loadCallbackHandler))},addEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.addEventListener(i,e[i])}},removeEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.removeEventListener(i,e[i])}},createPlayPromise:function(t){void 0===t&&(t=!0);var e=this.video,i=e.play();if(void 0!==i){var n=this.playSuccess.bind(this),s=this.playError.bind(this);if(!t){var r=this;s=function(){r.failedPlayAttempts++}}i.then(n).catch(s)}else e.addEventListener("playing",this._callbacks.legacy),t||this.failedPlayAttempts++},addMarker:function(t,e,i){return!isNaN(e)&&e>=0&&!isNaN(i)&&i>e&&(this.markers[t]=[e,i]),this},playMarker:function(t,e){var i=this.markers[t];return i&&this.play(e,i[0],i[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,i,n,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=i),void 0===r&&(r=n);var a=this.video,o=this.snapshotTexture;return o?(o.setSize(s,r),a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)):(o=this.scene.sys.textures.createCanvas(h(),s,r),this.snapshotTexture=o,a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)),o.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},playSuccess:function(){if(this._playCalled){this.addEventHandlers(),this._codePaused=!1,this.touchLocked&&(this.touchLocked=!1,this.emit(n.VIDEO_UNLOCKED,this));var t=this.scene.sys.sound;t&&t.mute&&this.setMute(!0),this._markerIn>-1&&(this.video.currentTime=this._markerIn)}},playError:function(t){var e=t.name;"NotAllowedError"===e?(this.touchLocked=!0,this.playWhenUnlocked=!0,this.failedPlayAttempts=1,this.emit(n.VIDEO_LOCKED,this)):"NotSupportedError"===e?(this.stop(!1),this.emit(n.VIDEO_UNSUPPORTED,this,t)):(this.stop(!1),this.emit(n.VIDEO_ERROR,this,t))},legacyPlayHandler:function(){var t=this.video;t&&(this.playSuccess(),t.removeEventListener("playing",this._callbacks.legacy))},playingHandler:function(){this.isStalled=!1,this.emit(n.VIDEO_PLAYING,this)},loadErrorHandler:function(t){this.stop(!1),this.emit(n.VIDEO_ERROR,this,t)},metadataHandler:function(t){this.emit(n.VIDEO_METADATA,this,t)},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,1!==this.scaleX&&(this.scaleX=this.displayWidth/this.width),1!==this.scaleY&&(this.scaleY=this.displayHeight/this.height);var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},stalledHandler:function(t){this.isStalled=!0,this.emit(n.VIDEO_STALLED,this,t)},completeHandler:function(){this._playCalled=!1,this.emit(n.VIDEO_COMPLETE,this)},preUpdate:function(t,e){this.video&&this._playCalled&&this.touchLocked&&this.playWhenUnlocked&&(this.retry+=e,this.retry>=this.retryInterval&&(this.createPlayPromise(!1),this.retry=0))},seekTo:function(t){var e=this.video;if(e){var i=e.duration;if(i!==1/0&&!isNaN(i)){var n=i*t;this.setCurrentTime(n)}}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"==typeof t){var i=t[0],n=parseFloat(t.substr(1));"+"===i?t=e.currentTime+n:"-"===i&&(t=e.currentTime-n)}e.currentTime=t}return this},seekingHandler:function(){this.isSeeking=!0,this.emit(n.VIDEO_SEEKING,this)},seekedHandler:function(){this.isSeeking=!1,this.emit(n.VIDEO_SEEKED,this)},getProgress:function(){var t=this.video;if(t){var e=t.duration;if(e!==1/0&&!isNaN(e))return t.currentTime/e}return-1},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var i=this.video;i&&(i.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&!this.video.ended&&(this.removeEventHandlers(),this.video.pause())},globalResume:function(){this._systemPaused=!1,!this.video||this._codePaused||this.video.ended||this.createPlayPromise()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&!e.ended&&(t?e.paused||(this.removeEventHandlers(),e.pause()):t||(this._playCalled?e.paused&&!this._systemPaused&&this.createPlayPromise():this.play())),this},pause:function(){return this.setPaused(!0)},resume:function(){return this.setPaused(!1)},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(e){return void 0===e&&(e=1),this.video&&(this.video.volume=t(e,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this._playCalled&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&(this.scene.sys.textures.renameTexture(this._key,t),this.videoTextureSource.setFlipY(e)),this._key=t,this.flipY=e,!!this.videoTexture},stop:function(t){void 0===t&&(t=!0);var e=this.video;return e&&(this.removeEventHandlers(),e.cancelVideoFrameCallback(this._rfvCallbackId),e.pause()),this.retry=0,this._playCalled=!1,t&&this.emit(n.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(!1),this.removeLoadEventHandlers(),this.removeVideoElement();var t=this.scene.sys.game.events;t.off(s.PAUSE,this.globalPause,this),t.off(s.RESUME,this.globalResume,this);var e=this.scene.sys.sound;e&&e.off(o.GLOBAL_MUTE,this.globalMute,this)}});return $B=u}function Uq(){if(eN)return tN;eN=1;var t=Kh(),e=_c(),i=fU(),n=Ku(),s=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible],initialize:function(t,e,s){void 0===e&&(e="Shape"),i.call(this,t,e),this.geom=s,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new n,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,i){return void 0===i&&(i=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=i,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});return tN=s}function Yq(){if(nN)return iN;nN=1;var t=_W();return iN=function(e,i,n,s,r,a){for(var o=t.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*s),h=n.pathData,l=n.pathIndexes,u=0;u<l.length;u+=3){var c=2*l[u],d=2*l[u+1],f=2*l[u+2],p=h[c+0]-r,g=h[c+1]-a,v=h[d+0]-r,m=h[d+1]-a,y=h[f+0]-r,x=h[f+1]-a,w=i.getX(p,g),b=i.getY(p,g),T=i.getX(v,m),S=i.getY(v,m),E=i.getX(y,x),_=i.getY(y,x);e.batchTri(n,w,b,T,S,E,_,0,0,1,1,o,o,o,2)}},iN}function Xq(){if(rN)return sN;rN=1;var t=_W();return sN=function(e,i,n,s,r){var a=e.strokeTint,o=t.getTintAppendFloatAlpha(i.strokeColor,i.strokeAlpha*n);a.TL=o,a.TR=o,a.BL=o,a.BR=o;var h=i.pathData,l=h.length-1,u=i.lineWidth,c=u/2,d=h[0]-s,f=h[1]-r;i.closePath||(l-=2);for(var p=2;p<l;p+=2){var g=h[p]-s,v=h[p+1]-r;e.batchLine(d,f,g,v,c,c,u,p-2,!!i.closePath&&p===l-1),d=g,f=v}},sN}function Gq(){if(lN)return hN;lN=1;return hN=function(t,e,i,n){var s=i||e.fillColor,r=n||e.fillAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.fillStyle="rgba("+a+","+o+","+h+","+r+")"},hN}function Wq(){if(cN)return uN;cN=1;return uN=function(t,e,i,n){var s=i||e.strokeColor,r=n||e.strokeAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.strokeStyle="rgba("+a+","+o+","+h+","+r+")",t.lineWidth=e.lineWidth},uN}function Hq(){if(gN)return pN;gN=1;var t=qh(),e=t,i=t;return e=function(){if(oN)return aN;oN=1;var t=yj(),e=Yq(),i=Xq();return aN=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&e(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},aN}(),i=function(){if(fN)return dN;fN=1;var t=ac(),e=Gq(),i=Wq(),n=Ej();return dN=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(n(s,h,r,a,o)){var l=r.radius;h.beginPath(),h.arc(l-r.originX*(2*l),l-r.originY*(2*l),l,t(r._startAngle),t(r._endAngle),r.anticlockwise),r.closePath&&h.closePath(),r.isFilled&&(e(h,r),h.fill()),r.isStroked&&(i(h,r),h.stroke()),h.restore()}},dN}(),pN={renderWebGL:e,renderCanvas:i}}function Vq(){if(mN)return vN;mN=1;var t=Hq(),e=Kh(),i=ac(),n=lH(),s=ol(),r=il(),a=Uq(),o=new e({Extends:a,Mixins:[t],initialize:function(t,e,i,n,r,o,h,l,u){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=128),void 0===r&&(r=0),void 0===o&&(o=360),void 0===h&&(h=!1),a.call(this,t,"Arc",new s(0,0,n)),this._startAngle=r,this._endAngle=o,this._anticlockwise=h,this._iterations=.01,this.setPosition(e,i);var c=2*this.geom.radius;this.setSize(c,c),void 0!==l&&this.setFillStyle(l,u),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,s=this.geom.radius,a=i(this._startAngle),o=i(this._endAngle),h=s,l=s;o-=a,this._anticlockwise?o<-r.PI2?o=-r.PI2:o>0&&(o=-r.PI2+o%r.PI2):o>r.PI2?o=r.PI2:o<0&&(o=r.PI2+o%r.PI2);for(var u,c=[h+Math.cos(a)*s,l+Math.sin(a)*s];e<1;)u=o*e+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),e+=t;return u=o+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),c.push(h+Math.cos(a)*s,l+Math.sin(a)*s),this.pathIndexes=n(c),this.pathData=c,this}});return vN=o}function jq(){if(SN)return TN;SN=1;var t=qh(),e=t,i=t;return e=function(){if(xN)return yN;xN=1;var t=Yq(),e=yj(),i=Xq();return yN=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX+s._curveBounds.x,c=s._displayOriginY+s._curveBounds.y,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},yN}(),i=function(){if(bN)return wN;bN=1;var t=Gq(),e=Wq(),i=Ej();return wN=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX+s._curveBounds.x,l=s._displayOriginY+s._curveBounds.y,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},wN}(),TN={renderWebGL:e,renderCanvas:i}}function qq(){if(_N)return EN;_N=1;var t=Kh(),e=jq(),i=lH(),n=Ju(),s=Uq(),r=new t({Extends:s,Mixins:[e],initialize:function(t,e,i,r,a,o){void 0===e&&(e=0),void 0===i&&(i=0),s.call(this,t,"Curve",r),this._smoothness=32,this._curveBounds=new n,this.closePath=!1,this.setPosition(e,i),void 0!==a&&this.setFillStyle(a,o),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],s=this.geom.getPoints(e),r=0;r<s.length;r++)n.push(s[r].x,s[r].y);return n.push(s[0].x,s[0].y),this.pathIndexes=i(n),this.pathData=n,this}});return EN=r}function Kq(){if(LN)return RN;LN=1;var t=qh(),e=t,i=t;return e=function(){if(AN)return CN;AN=1;var t=Yq(),e=yj(),i=Xq();return CN=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},CN}(),i=function(){if(MN)return PN;MN=1;var t=Gq(),e=Wq(),i=Ej();return PN=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},PN}(),RN={renderWebGL:e,renderCanvas:i}}function Zq(){if(FN)return ON;FN=1;var t=Kh(),e=lH(),i=Kq(),n=jj(),s=Uq(),r=new t({Extends:s,Mixins:[i],initialize:function(t,e,i,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===a&&(a=128),s.call(this,t,"Ellipse",new n(r/2,a/2,r,a)),this._smoothness=64,this.setPosition(e,i),this.width=r,this.height=a,void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setPosition(t/2,e/2),this.geom.setSize(t,e),this.updateDisplayOrigin(),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],i=this.geom.getPoints(this._smoothness),n=0;n<i.length;n++)t.push(i[n].x,i[n].y);return t.push(i[0].x,i[0].y),this.pathIndexes=e(t),this.pathData=t,this}});return ON=r}function Jq(){if(zN)return NN;zN=1;var t=qh(),e=t,i=t;return e=function(){if(IN)return DN;IN=1;var t=yj(),e=_W();return DN=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc).translate(-n._displayOriginX,-n._displayOriginY);var h,l,u=s.alpha*n.alpha,c=n.width,d=n.height,f=n.cellWidth,p=n.cellHeight,g=Math.ceil(c/f),v=Math.ceil(d/p),m=f,y=p,x=f-(g*f-c),w=p-(v*p-d),b=n.showCells,T=n.showAltCells,S=n.showOutline,E=0,_=0,C=0,A=0,P=0;if(S&&(m--,y--,x===f&&x--,w===p&&w--),i.pipelines.preBatch(n),b&&n.fillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<v;_++)for(T&&(C=_%2),E=0;E<g;E++)T&&C?C=0:(C++,A=E<g-1?m:x,P=_<v-1?y:w,a.batchFillRect(E*f,_*p,A,P));if(T&&n.altFillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.altFillColor,n.altFillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<v;_++)for(T&&(C=_%2),E=0;E<g;E++)!T||C?(C=0,A=E<g-1?m:x,P=_<v-1?y:w,a.batchFillRect(E*f,_*p,A,P)):C=1;if(S&&n.outlineFillAlpha>0){var M=a.strokeTint,R=e.getTintAppendFloatAlpha(n.outlineFillColor,n.outlineFillAlpha*u);for(M.TL=R,M.TR=R,M.BL=R,M.BR=R,E=1;E<g;E++){var L=E*f;a.batchLine(L,0,L,d,n.lineWidth,n.lineWidth,1,0,!1)}for(_=1;_<v;_++){var O=_*p;a.batchLine(0,O,c,O,n.lineWidth,n.lineWidth,1,0,!1)}}i.pipelines.postBatch(n)},DN}(),i=function(){if(BN)return kN;BN=1;var t=Gq(),e=Wq(),i=Ej();return kN=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=-s._displayOriginX,l=-s._displayOriginY,u=r.alpha*s.alpha,c=s.width,d=s.height,f=s.cellWidth,p=s.cellHeight,g=Math.ceil(c/f),v=Math.ceil(d/p),m=f,y=p,x=f-(g*f-c),w=p-(v*p-d),b=s.showCells,T=s.showAltCells,S=s.showOutline,E=0,_=0,C=0,A=0,P=0;if(S&&(m--,y--,x===f&&x--,w===p&&w--),b&&s.fillAlpha>0)for(t(o,s),_=0;_<v;_++)for(T&&(C=_%2),E=0;E<g;E++)T&&C?C=0:(C++,A=E<g-1?m:x,P=_<v-1?y:w,o.fillRect(h+E*f,l+_*p,A,P));if(T&&s.altFillAlpha>0)for(t(o,s,s.altFillColor,s.altFillAlpha*u),_=0;_<v;_++)for(T&&(C=_%2),E=0;E<g;E++)!T||C?(C=0,A=E<g-1?m:x,P=_<v-1?y:w,o.fillRect(h+E*f,l+_*p,A,P)):C=1;if(S&&s.outlineFillAlpha>0){for(e(o,s,s.outlineFillColor,s.outlineFillAlpha*u),E=1;E<g;E++){var M=E*f;o.beginPath(),o.moveTo(M+h,l),o.lineTo(M+h,d+l),o.stroke()}for(_=1;_<v;_++){var R=_*p;o.beginPath(),o.moveTo(h,R+l),o.lineTo(h+c,R+l),o.stroke()}}o.restore()}},kN}(),NN={renderWebGL:e,renderCanvas:i}}function $q(){if(YN)return UN;YN=1;var t=Kh(),e=Uq(),i=Jq(),n=new t({Extends:e,Mixins:[i],initialize:function(t,i,n,s,r,a,o,h,l,u,c){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=128),void 0===r&&(r=128),void 0===a&&(a=32),void 0===o&&(o=32),e.call(this,t,"Grid",null),this.cellWidth=a,this.cellHeight=o,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(i,n),this.setSize(s,r),this.setFillStyle(h,l),void 0!==u&&this.setOutlineStyle(u,c),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});return UN=n}function Qq(){if(jN)return VN;jN=1;var t=qh(),e=t,i=t;return e=function(){if(GN)return XN;GN=1;var t=yj(),e=_W();return XN=function(i,n,s,r){s.addToRenderList(n);var a,o,h,l,u,c,d,f,p,g=i.pipelines.set(n.pipeline),v=t(n,s,r),m=g.calcMatrix.copyFrom(v.calc),y=n.width,x=n.height,w=y/2,b=y/n.projection,T=s.alpha*n.alpha;n.isFilled&&(i.pipelines.preBatch(n),n.showTop&&(a=e.getTintAppendFloatAlpha(n.fillTop,T),o=m.getX(-w,-x),h=m.getY(-w,-x),l=m.getX(0,-b-x),u=m.getY(0,-b-x),c=m.getX(w,-x),d=m.getY(w,-x),f=m.getX(0,b-x),p=m.getY(0,b-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showLeft&&(a=e.getTintAppendFloatAlpha(n.fillLeft,T),o=m.getX(-w,0),h=m.getY(-w,0),l=m.getX(0,b),u=m.getY(0,b),c=m.getX(0,b-x),d=m.getY(0,b-x),f=m.getX(-w,-x),p=m.getY(-w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showRight&&(a=e.getTintAppendFloatAlpha(n.fillRight,T),o=m.getX(w,0),h=m.getY(w,0),l=m.getX(0,b),u=m.getY(0,b),c=m.getX(0,b-x),d=m.getY(0,b-x),f=m.getX(w,-x),p=m.getY(w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),i.pipelines.postBatch(n))},XN}(),i=function(){if(HN)return WN;HN=1;var t=Gq(),e=Ej();return WN=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection;n.showTop&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(l,-1),a.lineTo(0,u-1),a.lineTo(-l,-1),a.lineTo(-l,-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(-l,-h),a.lineTo(-l,0),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(l,-h),a.lineTo(l,0),a.fill()),a.restore()}},WN}(),VN={renderWebGL:e,renderCanvas:i}}function tK(){if(KN)return qN;KN=1;var t=Qq(),e=Kh(),i=Uq(),n=new e({Extends:i,Mixins:[t],initialize:function(t,e,n,s,r,a,o,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=15658734),void 0===o&&(o=10066329),void 0===h&&(h=13421772),i.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=a,this.fillLeft=o,this.fillRight=h,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return qN=n}function eK(){if(ez)return tz;ez=1;var t=qh(),e=t,i=t;return e=function(){if(JN)return ZN;JN=1;var t=yj(),e=_W();return ZN=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r),h=a.calcMatrix.copyFrom(o.calc),l=n.width,u=n.height,c=l/2,d=l/n.projection,f=n.isReversed,p=s.alpha*n.alpha;if(n.isFilled){var g,v,m,y,x,w,b;if(i.pipelines.preBatch(n),n.showTop&&f){g=e.getTintAppendFloatAlpha(n.fillTop,p),v=h.getX(-c,-u),m=h.getY(-c,-u),y=h.getX(0,-d-u),x=h.getY(0,-d-u),w=h.getX(c,-u),b=h.getY(c,-u);var T=h.getX(0,d-u),S=h.getY(0,d-u);a.batchQuad(n,v,m,y,x,w,b,T,S,0,0,1,1,g,g,g,g,2)}n.showLeft&&(g=e.getTintAppendFloatAlpha(n.fillLeft,p),f?(v=h.getX(-c,-u),m=h.getY(-c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)):(v=h.getX(-c,0),m=h.getY(-c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)),a.batchTri(n,v,m,y,x,w,b,0,0,1,1,g,g,g,2)),n.showRight&&(g=e.getTintAppendFloatAlpha(n.fillRight,p),f?(v=h.getX(c,-u),m=h.getY(c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)):(v=h.getX(c,0),m=h.getY(c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)),a.batchTri(n,v,m,y,x,w,b,0,0,1,1,g,g,g,2)),i.pipelines.postBatch(n)}},ZN}(),i=function(){if(QN)return $N;QN=1;var t=Gq(),e=Ej();return $N=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection,c=n.isReversed;n.showTop&&c&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(0,u-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),c?(a.moveTo(-l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),c?(a.moveTo(l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),a.restore()}},$N}(),tz={renderWebGL:e,renderCanvas:i}}function iK(){if(nz)return iz;nz=1;var t=Kh(),e=eK(),i=Uq(),n=new t({Extends:i,Mixins:[e],initialize:function(t,e,n,s,r,a,o,h,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=!1),void 0===o&&(o=15658734),void 0===h&&(h=10066329),void 0===l&&(l=13421772),i.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=o,this.fillLeft=h,this.fillRight=l,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=a,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return iz=n}function nK(){if(lz)return hz;lz=1;var t=qh(),e=t,i=t;return e=function(){if(rz)return sz;rz=1;var t=yj(),e=_W();return sz=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc);var h=n._displayOriginX,l=n._displayOriginY,u=s.alpha*n.alpha;if(i.pipelines.preBatch(n),n.isStroked){var c=a.strokeTint,d=e.getTintAppendFloatAlpha(n.strokeColor,n.strokeAlpha*u);c.TL=d,c.TR=d,c.BL=d,c.BR=d,a.batchLine(n.geom.x1-h,n.geom.y1-l,n.geom.x2-h,n.geom.y2-l,n._startWidth/2,n._endWidth/2,1,0,!1,o.sprite,o.camera)}i.pipelines.postBatch(n)},sz}(),i=function(){if(oz)return az;oz=1;var t=Wq(),e=Ej();return az=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)){var o=n._displayOriginX,h=n._displayOriginY;n.isStroked&&(t(a,n),a.beginPath(),a.moveTo(n.geom.x1-o,n.geom.y1-h),a.lineTo(n.geom.x2-o,n.geom.y2-h),a.stroke()),a.restore()}},az}(),hz={renderWebGL:e,renderCanvas:i}}function sK(){if(cz)return uz;cz=1;var t=Kh(),e=Uq(),i=Ku(),n=nK(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=128),void 0===h&&(h=0),e.call(this,t,"Line",new i(r,a,o,h));var c=Math.max(1,this.geom.right-this.geom.left),d=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(n,s),this.setSize(c,d),void 0!==l&&this.setStrokeStyle(1,l,u),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,i,n){return this.geom.setTo(t,e,i,n),this}});return uz=s}function rK(){if(mz)return vz;mz=1;var t=qh(),e=t,i=t;return e=function(){if(fz)return dz;fz=1;var t=Yq(),e=yj(),i=Xq();return dz=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},dz}(),i=function(){if(gz)return pz;gz=1;var t=Gq(),e=Wq(),i=Ej();return pz=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},pz}(),vz={renderWebGL:e,renderCanvas:i}}function aK(){if(xz)return yz;xz=1;var t=Ju();return yz=function(e,i){void 0===i&&(i=new t);for(var n,s=1/0,r=1/0,a=-s,o=-r,h=0;h<e.points.length;h++)n=e.points[h],s=Math.min(s,n.x),r=Math.min(r,n.y),a=Math.max(a,n.x),o=Math.max(o,n.y);return i.x=s,i.y=r,i.width=a-s,i.height=o-r,i},yz}function oK(){if(bz)return wz;bz=1;return wz=function(t,e,i){for(var n=!1,s=-1,r=t.points.length-1;++s<t.points.length;r=s){var a=t.points[s].x,o=t.points[s].y,h=t.points[r].x,l=t.points[r].y;(o<=i&&i<l||l<=i&&i<o)&&e<(h-a)*(i-o)/(l-o)+a&&(n=!n)}return n},wz}function hK(){if(Sz)return Tz;Sz=1;var t=Wu(),e=Ku();return Tz=function(i){for(var n=i.points,s=0,r=0;r<n.length;r++){var a=n[r],o=n[(r+1)%n.length],h=new e(a.x,a.y,o.x,o.y);s+=t(h)}return s},Tz}function lK(){if(_z)return Ez;_z=1;var t=Wu(),e=Ku(),i=hK();return Ez=function(n,s,r,a){void 0===a&&(a=[]);var o=n.points,h=i(n);!s&&r>0&&(s=h/r);for(var l=0;l<s;l++)for(var u=h*(l/s),c=0,d=0;d<o.length;d++){var f=o[d],p=o[(d+1)%o.length],g=new e(f.x,f.y,p.x,p.y),v=t(g);if(!(u<c||u>c+v)){var m=g.getPoint((u-c)/v);a.push(m);break}c+=v}return a},Ez}function uK(){if(Az)return Cz;Az=1;var t=Kh(),e=oK(),i=lK(),n=Jh(),s=new t({initialize:function(t){this.type=n.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,i){return e(this,t,i)},setTo:function(t){if(this.area=0,this.points=[],"string"==typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,i=0;i<t.length;i++)e={x:0,y:0},"number"==typeof t[i]||"string"==typeof t[i]?(e.x=parseFloat(t[i]),e.y=parseFloat(t[i+1]),i++):Array.isArray(t[i])?(e.x=t[i][0],e.y=t[i][1]):(e.x=t[i].x,e.y=t[i].y),this.points.push(e);return this.calculateArea(),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,i=0,n=0;n<this.points.length-1;n++)t=this.points[n],i+=((e=this.points[n+1]).x-t.x)*(t.y+e.y);return t=this.points[0],e=this.points[this.points.length-1],i+=(t.x-e.x)*(e.y+t.y),this.area=.5*-i,this.area},getPoints:function(t,e,n){return i(this,t,e,n)}});return Cz=s}function cK(){if(Mz)return Pz;Mz=1;var t=function(t,e){return t[0]=e[0],t[1]=e[1],t};return Pz=function(e){var i,n=[],s=e.points;for(i=0;i<s.length;i++)n.push([s[i].x,s[i].y]);var r=[];for(n.length>0&&r.push(t([0,0],n[0])),i=0;i<n.length-1;i++){var a=n[i],o=n[i+1],h=a[0],l=a[1],u=o[0],c=o[1];r.push([.85*h+.15*u,.85*l+.15*c]),r.push([.15*h+.85*u,.15*l+.85*c])}return n.length>1&&r.push(t([0,0],n[n.length-1])),e.setTo(r)},Pz}function dK(){if(Lz)return Rz;Lz=1;var t=rK(),e=Kh(),i=lH(),n=aK(),s=uK(),r=Uq(),a=cK(),o=new e({Extends:r,Mixins:[t],initialize:function(t,e,i,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),r.call(this,t,"Polygon",new s(a));var l=n(this.geom);this.setPosition(e,i),this.setSize(l.width,l.height),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)a(this.geom);return this.updateData()},setTo:function(t){this.geom.setTo(t);var e=n(this.geom);return this.setSize(e.width,e.height),this.updateDisplayOrigin(),this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=i(t),this.pathData=t,this}});return Rz=o}function fK(){if(Bz)return kz;Bz=1;var t=qh(),e=t,i=t;return e=function(){if(Fz)return Oz;Fz=1;var t=Yq(),e=yj(),i=Xq(),n=_W();return Oz=function(s,r,a,o){a.addToRenderList(r);var h=s.pipelines.set(r.pipeline),l=e(r,a,o);h.calcMatrix.copyFrom(l.calc);var u=r._displayOriginX,c=r._displayOriginY,d=a.alpha*r.alpha;if(s.pipelines.preBatch(r),r.isRounded&&r.isFilled)t(h,l.calc,r,d,u,c);else if(r.isFilled){var f=h.fillTint,p=n.getTintAppendFloatAlpha(r.fillColor,r.fillAlpha*d);f.TL=p,f.TR=p,f.BL=p,f.BR=p,h.batchFillRect(-u,-c,r.width,r.height)}r.isStroked&&i(h,r,d,u,c),s.pipelines.postBatch(r)},Oz}(),i=function(){if(Iz)return Dz;Iz=1;var t=Gq(),e=Wq(),i=Ej(),n=function(t,e,i,n,s,r){var a=Math.min(n/2,s/2),o=Math.min(r,a);0!==o?(t.moveTo(e+o,i),t.lineTo(e+n-o,i),t.arcTo(e+n,i,e+n,i+o,o),t.lineTo(e+n,i+s-o),t.arcTo(e+n,i+s,e+n-o,i+s,o),t.lineTo(e+o,i+s),t.arcTo(e,i+s,e,i+s-o,o),t.lineTo(e,i+o),t.arcTo(e,i,e+o,i,o),t.closePath()):t.rect(e,i,n,s)};return Dz=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(i(s,h,r,a,o)){var l=r._displayOriginX,u=r._displayOriginY;r.isFilled&&(t(h,r),r.isRounded?(h.beginPath(),n(h,-l,-u,r.width,r.height,r.radius),h.fill()):h.fillRect(-l,-u,r.width,r.height)),r.isStroked&&(e(h,r),h.beginPath(),r.isRounded?n(h,-l,-u,r.width,r.height,r.radius):h.rect(-l,-u,r.width,r.height),h.stroke()),h.restore()}},Dz}(),kz={renderWebGL:e,renderCanvas:i}}function pK(){if(zz)return Nz;zz=1;var t=Kh(),e=lH(),i=Ju(),n=Uq(),s=fK(),r=new t({Extends:n,Mixins:[s],initialize:function(t,e,s,r,a,o,h){void 0===e&&(e=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),n.call(this,t,"Rectangle",new i(0,0,r,a)),this.radius=20,this.isRounded=!1,this.setPosition(e,s),this.setSize(r,a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setRounded:function(t){return void 0===t&&(t=16),this.radius=t,this.isRounded=t>0,this.updateRoundedData()},setSize:function(t,e){this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},updateData:function(){if(this.isRounded)return this.updateRoundedData();var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),e.getLineD(i),t.push(i.x2,i.y2),this.pathData=t,this},updateRoundedData:function(){var t=[],i=this.width/2,n=this.height/2,s=Math.min(i,n),r=Math.min(this.radius,s),a=i,o=n,h=Math.max(1,Math.floor(r/5));return this.arcTo(t,a-i+r,o-n+r,r,Math.PI,1.5*Math.PI,h),t.push(a+i-r,o-n),this.arcTo(t,a+i-r,o-n+r,r,1.5*Math.PI,2*Math.PI,h),t.push(a+i,o+n-r),this.arcTo(t,a+i-r,o+n-r,r,0,.5*Math.PI,h),t.push(a-i+r,o+n),this.arcTo(t,a-i+r,o+n-r,r,.5*Math.PI,Math.PI,h),t.push(a-i,o-n+r),this.pathIndexes=e(t),this.pathData=t,this},arcTo:function(t,e,i,n,s,r,a){for(var o=(r-s)/a,h=0;h<=a;h++){var l=s+o*h;t.push(e+Math.cos(l)*n,i+Math.sin(l)*n)}}});return Nz=r}function gK(){if(Hz)return Wz;Hz=1;var t=qh(),e=t,i=t;return e=function(){if(Yz)return Uz;Yz=1;var t=Yq(),e=yj(),i=Xq();return Uz=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},Uz}(),i=function(){if(Gz)return Xz;Gz=1;var t=Gq(),e=Wq(),i=Ej();return Xz=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},Xz}(),Wz={renderWebGL:e,renderCanvas:i}}function vK(){if(jz)return Vz;jz=1;var t=gK(),e=Kh(),i=lH(),n=Uq(),s=new e({Extends:n,Mixins:[t],initialize:function(t,e,i,s,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=5),void 0===r&&(r=32),void 0===a&&(a=64),n.call(this,t,"Star",null),this._points=s,this._innerRadius=r,this._outerRadius=a,this.setPosition(e,i),this.setSize(2*a,2*a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,s=this._outerRadius,r=Math.PI/2*3,a=Math.PI/e,o=s,h=s;t.push(o,h+-s);for(var l=0;l<e;l++)t.push(o+Math.cos(r)*s,h+Math.sin(r)*s),r+=a,t.push(o+Math.cos(r)*n,h+Math.sin(r)*n),r+=a;return t.push(o,h+-s),this.pathIndexes=i(t),this.pathData=t,this}});return Vz=s}function mK(){if(Kz)return qz;Kz=1;return qz=function(t,e,i){var n=t.x3-t.x1,s=t.y3-t.y1,r=t.x2-t.x1,a=t.y2-t.y1,o=e-t.x1,h=i-t.y1,l=n*n+s*s,u=n*r+s*a,c=n*o+s*h,d=r*r+a*a,f=r*o+a*h,p=l*d-u*u,g=0===p?0:1/p,v=(d*c-u*f)*g,m=(l*f-u*c)*g;return v>=0&&m>=0&&v+m<1},qz}function yK(){if(Jz)return Zz;Jz=1;var t=$h(),e=Wu();return Zz=function(i,n,s){void 0===s&&(s=new t);var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();if(n<=0||n>=1)return s.x=r.x1,s.y=r.y1,s;var h=e(r),l=e(a),u=e(o),c=(h+l+u)*n,d=0;return c<h?(d=c/h,s.x=r.x1+(r.x2-r.x1)*d,s.y=r.y1+(r.y2-r.y1)*d):c>h+l?(d=(c-=h+l)/u,s.x=o.x1+(o.x2-o.x1)*d,s.y=o.y1+(o.y2-o.y1)*d):(d=(c-=h)/l,s.x=a.x1+(a.x2-a.x1)*d,s.y=a.y1+(a.y2-a.y1)*d),s},Zz}function xK(){if(Qz)return $z;Qz=1;var t=Wu(),e=$h();return $z=function(i,n,s,r){void 0===r&&(r=[]);var a=i.getLineA(),o=i.getLineB(),h=i.getLineC(),l=t(a),u=t(o),c=t(h),d=l+u+c;!n&&s>0&&(n=d/s);for(var f=0;f<n;f++){var p=d*(f/n),g=0,v=new e;p<l?(g=p/l,v.x=a.x1+(a.x2-a.x1)*g,v.y=a.y1+(a.y2-a.y1)*g):p>l+u?(g=(p-=l+u)/c,v.x=h.x1+(h.x2-h.x1)*g,v.y=h.y1+(h.y2-h.y1)*g):(g=(p-=l)/u,v.x=o.x1+(o.x2-o.x1)*g,v.y=o.y1+(o.y2-o.y1)*g),r.push(v)}return r},$z}function wK(){if(eU)return tU;eU=1;var t=Kh(),e=mK(),i=yK(),n=xK(),s=Jh(),r=Ku(),a=AY(),o=new t({initialize:function(t,e,i,n,r,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),this.type=s.TRIANGLE,this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=r,this.y3=a},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=s,this.y3=r,this},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e=0;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e=0;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}}});return tU=o}function bK(){if(oU)return aU;oU=1;var t=qh(),e=t,i=t;return e=function(){if(nU)return iU;nU=1;var t=yj(),e=Xq(),i=_W();return iU=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a);o.calcMatrix.copyFrom(h.calc);var l=s._displayOriginX,u=s._displayOriginY,c=r.alpha*s.alpha;if(n.pipelines.preBatch(s),s.isFilled){var d=o.fillTint,f=i.getTintAppendFloatAlpha(s.fillColor,s.fillAlpha*c);d.TL=f,d.TR=f,d.BL=f,d.BR=f;var p=s.geom.x1-l,g=s.geom.y1-u,v=s.geom.x2-l,m=s.geom.y2-u,y=s.geom.x3-l,x=s.geom.y3-u;o.batchFillTriangle(p,g,v,m,y,x,h.sprite,h.camera)}s.isStroked&&e(o,s,c,l,u),n.pipelines.postBatch(s)},iU}(),i=function(){if(rU)return sU;rU=1;var t=Gq(),e=Wq(),i=Ej();return sU=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.geom.x1-h,c=s.geom.y1-l,d=s.geom.x2-h,f=s.geom.y2-l,p=s.geom.x3-h,g=s.geom.y3-l;o.beginPath(),o.moveTo(u,c),o.lineTo(d,f),o.lineTo(p,g),o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},sU}(),aU={renderWebGL:e,renderCanvas:i}}function TK(){if(lU)return hU;lU=1;var t=Kh(),e=Uq(),i=wK(),n=bK(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u,c,d){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=128),void 0===o&&(o=64),void 0===h&&(h=0),void 0===l&&(l=128),void 0===u&&(u=128),e.call(this,t,"Triangle",new i(r,a,o,h,l,u));var f=this.geom.right-this.geom.left,p=this.geom.bottom-this.geom.top;this.setPosition(n,s),this.setSize(f,p),void 0!==c&&this.setFillStyle(c,d),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,i,n,s,r){return this.geom.setTo(t,e,i,n,s,r),this.updateData()},updateData:function(){var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),this.pathData=t,this}});return hU=s}var SK,EK={};function _K(){if(SK)return EK;SK=1;var t=Mj();return ic().register("blitter",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),EK}var CK,AK={};function PK(){if(CK)return AK;CK=1;var t=Oj();return ic().register("container",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),AK}var MK,RK={};function LK(){if(MK)return RK;MK=1;var t=kj();return ic().register("dom",function(e,i,n,s,r){var a=new t(this.scene,e,i,n,s,r);return this.displayList.add(a),a}),RK}var OK,FK={};function DK(){if(OK)return FK;OK=1;var t=Nj();return ic().register("dynamicBitmapText",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,s,r))}),FK}var IK,kK={};function BK(){if(IK)return kK;IK=1;var t=Uj();return ic().register("extern",function(){var e=new t(this.scene);return this.displayList.add(e),e}),kK}var NK,zK={};function UK(){if(NK)return zK;NK=1;var t=Zj();return ic().register("graphics",function(e){return this.displayList.add(new t(this.scene,e))}),zK}var YK,XK={};function GK(){if(YK)return XK;YK=1;var t=eq();return ic().register("group",function(e,i){return this.updateList.add(new t(this.scene,e,i))}),XK}var WK,HK={};function VK(){if(WK)return HK;WK=1;var t=QV();return ic().register("image",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),HK}var jK,qK={};function KK(){if(jK)return qK;jK=1;var t=nq();return ic().register("layer",function(e){return this.displayList.add(new t(this.scene,e))}),qK}var ZK,JK={};function $K(){if(ZK)return JK;ZK=1;var t=ic(),e=Sq();return t.register("particles",function(t,i,n,s){return void 0!==t&&"string"==typeof t&&console.warn("ParticleEmitterManager was removed."),this.displayList.add(new e(this.scene,t,i,n,s))}),JK}var QK,tZ={};function eZ(){if(QK)return tZ;QK=1;var t=ic(),e=Eq();return t.register("follower",function(t,i,n,s,r){var a=new e(this.scene,t,i,n,s,r);return this.displayList.add(a),this.updateList.add(a),a}),tZ}var iZ,nZ={};function sZ(){if(iZ)return nZ;iZ=1;var t=ic(),e=_q();return t.register("renderTexture",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),nZ}var rZ,aZ={};function oZ(){if(rZ)return aZ;rZ=1;var t=Mq();return ic().register("rope",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),aZ}var hZ,lZ={};function uZ(){if(hZ)return lZ;hZ=1;var t=ic(),e=tq();return t.register("sprite",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),lZ}var cZ,dZ={};function fZ(){if(cZ)return dZ;cZ=1;var t=Cj();return ic().register("bitmapText",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),dZ}var pZ,gZ={};function vZ(){if(pZ)return gZ;pZ=1;var t=Iq();return ic().register("text",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),gZ}var mZ,yZ={};function xZ(){if(mZ)return yZ;mZ=1;var t=Bq();return ic().register("tileSprite",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),yZ}var wZ,bZ={};function TZ(){if(wZ)return bZ;wZ=1;var t=pU();return ic().register("zone",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),bZ}var SZ,EZ={};function _Z(){if(SZ)return EZ;SZ=1;var t=zq();return ic().register("video",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),EZ}var CZ,AZ={};function PZ(){if(CZ)return AZ;CZ=1;var t=Vq(),e=ic();return e.register("arc",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),e.register("circle",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,0,360,!1,s,r))}),AZ}var MZ,RZ={};function LZ(){if(MZ)return RZ;MZ=1;var t=ic(),e=qq();return t.register("curve",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),RZ}var OZ,FZ={};function DZ(){if(OZ)return FZ;OZ=1;var t=Zq();return ic().register("ellipse",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),FZ}var IZ,kZ={};function BZ(){if(IZ)return kZ;IZ=1;var t=ic(),e=$q();return t.register("grid",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),kZ}var NZ,zZ={};function UZ(){if(NZ)return zZ;NZ=1;var t=ic(),e=tK();return t.register("isobox",function(t,i,n,s,r,a,o){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o))}),zZ}var YZ,XZ={};function GZ(){if(YZ)return XZ;YZ=1;var t=ic(),e=iK();return t.register("isotriangle",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),XZ}var WZ,HZ={};function VZ(){if(WZ)return HZ;WZ=1;var t=ic(),e=sK();return t.register("line",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),HZ}var jZ,qZ={};function KZ(){if(jZ)return qZ;jZ=1;var t=ic(),e=dK();return t.register("polygon",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),qZ}var ZZ,JZ={};function $Z(){if(ZZ)return JZ;ZZ=1;var t=ic(),e=pK();return t.register("rectangle",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),JZ}var QZ,tJ={};function eJ(){if(QZ)return tJ;QZ=1;var t=vK();return ic().register("star",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),tJ}var iJ,nJ={};function sJ(){if(iJ)return nJ;iJ=1;var t=ic(),e=TK();return t.register("triangle",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),nJ}var rJ,aJ={};function oJ(){if(rJ)return aJ;rJ=1;var t=Mj(),e=wj(),i=DV(),n=xj();return i.register("blitter",function(i,s){void 0===i&&(i={});var r=n(i,"key",null),a=n(i,"frame",null),o=new t(this.scene,0,0,r,a);return void 0!==s&&(i.add=s),e(this.scene,o,i),o}),aJ}var hJ,lJ={};function uJ(){if(hJ)return lJ;hJ=1;var t=wj(),e=Oj(),i=DV(),n=xj(),s=jh();return i.register("container",function(i,r){void 0===i&&(i={});var a=n(i,"x",0),o=n(i,"y",0),h=s(i,"children",null),l=new e(this.scene,a,o,h);return void 0!==r&&(i.add=r),t(this.scene,l,i),l}),lJ}var cJ,dJ={};function fJ(){if(cJ)return dJ;cJ=1;var t=Nj(),e=wj(),i=DV(),n=xj();return i.register("dynamicBitmapText",function(i,s){void 0===i&&(i={});var r=n(i,"font",""),a=n(i,"text",""),o=n(i,"size",!1),h=new t(this.scene,0,0,r,a,o);return void 0!==s&&(i.add=s),e(this.scene,h,i),h}),dJ}var pJ,gJ={};function vJ(){if(pJ)return gJ;pJ=1;var t=DV(),e=Zj();return t.register("graphics",function(t,i){void 0===t&&(t={}),void 0!==i&&(t.add=i);var n=new e(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n}),gJ}var mJ,yJ={};function xJ(){if(mJ)return yJ;mJ=1;var t=DV(),e=eq();return t.register("group",function(t){return new e(this.scene,null,t)}),yJ}var wJ,bJ={};function TJ(){if(wJ)return bJ;wJ=1;var t=wj(),e=DV(),i=xj(),n=QV();return e.register("image",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"frame",null),o=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,o,e),o}),bJ}var SJ,EJ={};function _J(){if(SJ)return EJ;SJ=1;var t=wj(),e=nq(),i=DV(),n=xj();return i.register("layer",function(i,s){void 0===i&&(i={});var r=n(i,"children",null),a=new e(this.scene,r);return void 0!==s&&(i.add=s),t(this.scene,a,i),a}),EJ}var CJ,AJ={};function PJ(){if(CJ)return AJ;CJ=1;var t=wj(),e=DV(),i=xj(),n=jh(),s=Sq();return e.register("particles",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=n(e,"config",null),h=new s(this.scene,0,0,a);return void 0!==r&&(e.add=r),t(this.scene,h,e),o&&h.setConfig(o),h}),AJ}var MJ,RJ={};function LJ(){if(MJ)return RJ;MJ=1;var t=wj(),e=DV(),i=xj(),n=_q();return e.register("renderTexture",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",32),h=i(e,"height",32),l=new n(this.scene,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),RJ}var OJ,FJ={};function DJ(){if(OJ)return FJ;OJ=1;var t=wj(),e=DV(),i=xj(),n=Vl(),s=Mq();return e.register("rope",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=i(e,"horizontal",!0),l=n(e,"points",void 0),u=n(e,"colors",void 0),c=n(e,"alphas",void 0),d=new s(this.scene,0,0,a,o,l,h,u,c);return void 0!==r&&(e.add=r),t(this.scene,d,e),d}),FJ}var IJ,kJ={};function BJ(){if(IJ)return kJ;IJ=1;var t=wj(),e=bj(),i=DV(),n=xj(),s=tq();return i.register("sprite",function(i,r){void 0===i&&(i={});var a=n(i,"key",null),o=n(i,"frame",null),h=new s(this.scene,0,0,a,o);return void 0!==r&&(i.add=r),t(this.scene,h,i),e(h,i),h}),kJ}var NJ,zJ={};function UJ(){if(NJ)return zJ;NJ=1;var t=Cj(),e=wj(),i=DV(),n=xj(),s=Vl();return i.register("bitmapText",function(i,r){void 0===i&&(i={});var a=s(i,"font",""),o=n(i,"text",""),h=n(i,"size",!1),l=s(i,"align",0),u=new t(this.scene,0,0,a,o,h,l);return void 0!==r&&(i.add=r),e(this.scene,u,i),u}),zJ}var YJ,XJ={};function GJ(){if(YJ)return XJ;YJ=1;var t=wj(),e=DV(),i=xj(),n=Iq();return e.register("text",function(e,s){void 0===e&&(e={});var r=i(e,"text",""),a=i(e,"style",null),o=i(e,"padding",null);null!==o&&(a.padding=o);var h=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,h,e),h.autoRound=i(e,"autoRound",!0),h.resolution=i(e,"resolution",1),h}),XJ}var WJ,HJ={};function VJ(){if(WJ)return HJ;WJ=1;var t=wj(),e=DV(),i=xj(),n=Bq();return e.register("tileSprite",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",512),h=i(e,"height",512),l=i(e,"key",""),u=i(e,"frame",""),c=new n(this.scene,r,a,o,h,l,u);return void 0!==s&&(e.add=s),t(this.scene,c,e),c}),HJ}var jJ,qJ={};function KJ(){if(jJ)return qJ;jJ=1;var t=DV(),e=xj(),i=pU();return t.register("zone",function(t){var n=e(t,"x",0),s=e(t,"y",0),r=e(t,"width",1),a=e(t,"height",r);return new i(this.scene,n,s,r,a)}),qJ}var ZJ,JJ,$J,QJ,t$,e$,i$,n$,s$,r$,a$,o$,h$,l$,u$,c$,d$,f$,p$,g$,v$,m$,y$,x$,w$,b$,T$,S$,E$,_$,C$,A$,P$,M$,R$,L$,O$,F$,D$,I$,k$,B$,N$,z$={};function U$(){if(ZJ)return z$;ZJ=1;var t=wj(),e=DV(),i=xj(),n=zq();return e.register("video",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=new n(this.scene,0,0,r);return void 0!==s&&(e.add=s),t(this.scene,a,e),a}),z$}function Y$(){if($J)return JJ;$J=1;return JJ=function(t,e,i){if(!t||"number"==typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=i,!0;if(-1!==e.indexOf(".")){for(var n=e.split("."),s=t,r=t,a=0;a<n.length;a++){if(!s.hasOwnProperty(n[a]))return!1;r=s,s=s[n[a]]}return r[n[n.length-1]]=i,!0}return!1}}function X$(){if(s$)return n$;s$=1;var t=qh(),e=t,i=t;return e=function(){if(t$)return QJ;t$=1;var t=yj();return QJ=function(e,i,n,s){if(i.shader){if(n.addToRenderList(i),e.pipelines.clear(),i.renderToTexture)i.load(),i.flush();else{var r=t(i,n,s).calc;e.width===i._rendererWidth&&e.height===i._rendererHeight||i.projOrtho(0,e.width,e.height,0),i.load(r.matrix),i.flush()}e.pipelines.rebind()}},QJ}(),i=i$?e$:(i$=1,e$=function(){}),n$={renderWebGL:e,renderCanvas:i}}function G$(){if(a$)return r$;a$=1;var t=Kh(),e=_c(),i=fU(),n=jh(),s=nh(),r=Y$(),a=X$(),o=yc(),h=Rl(),l=vW(),u=new t({Extends:i,Mixins:[e.ComputedSize,e.Depth,e.GetBounds,e.Mask,e.Origin,e.ScrollFactor,e.Transform,e.Visible,a],initialize:function(t,e,n,s,r,a,h,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),i.call(this,t,"Shader"),this.blendMode=-1,this.shader;var c=t.sys.renderer;this.renderer=c,this.gl=c.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=c.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this._deferSetShader=null,this._deferProjOrtho=null,this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new o,this._tempMatrix2=new o,this._tempMatrix3=new o,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=c.width,this._rendererHeight=c.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,s),this.setSize(r,a),this.setOrigin(.5,.5),this.setShader(e,h,u),this.renderer.on(l.RESTORE_WEBGL,this.onContextRestored,this)},willRender:function(t){return!!this.renderToTexture||!(i.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(!this.renderToTexture){var i=this.width,n=this.height,s=this.renderer;this.glTexture=s.createTextureFromSource(null,i,n,0),this.framebuffer=s.createFramebuffer(i,n,this.glTexture,!1),this._rendererWidth=i,this._rendererHeight=n,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture))}return this.shader&&(s.pipelines.clear(),this.load(),this.flush(),s.pipelines.rebind()),this},setShader:function(t,e,i){if(this.renderer.contextLost)return this._deferSetShader={key:t,textures:e,textureData:i},this;if(void 0===e&&(e=[]),"string"==typeof t){var n=this.scene.sys.cache.shader;if(!n.has(t))return console.warn("Shader missing: "+t),this;this.shader=n.get(t)}else this.shader=t;var r=this.gl,a=this.renderer;this.program&&a.deleteProgram(this.program);var o=a.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uViewMatrix"),!1,this.viewMatrix),r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),r.uniform2f(r.getUniformLocation(o.webGLProgram,"uResolution"),this.width,this.height),this.program=o;var h=new Date,l={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[h.getFullYear(),h.getMonth(),h.getDate(),60*h.getHours()*60+60*h.getMinutes()+h.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=s(!0,{},this.shader.uniforms,l):this.uniforms=l;for(var u=0;u<4;u++)e[u]&&this.setSampler2D("iChannel"+u,e[u],u,i);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,i,n){if(this.renderer.contextLost)this._deferProjOrtho={left:t,right:e,bottom:i,top:n};else{var s=1/(t-e),r=1/(i-n),a=this.projectionMatrix;a[0]=-2*s,a[5]=-2*r,a[10]=-.001,a[12]=(t+e)*s,a[13]=(n+i)*r,a[14]=-0;var o=this.program,h=this.gl;this.renderer.setProgram(o),h.uniformMatrix4fv(h.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=i}},initUniforms:function(){var t=this.renderer.glFuncMap,e=this.program;for(var i in this._textureCount=0,this.uniforms){var n=this.uniforms[i],s=n.type,r=t[s];n.uniformLocation=this.renderer.createUniformLocation(e,i),"sampler2D"!==s&&(n.glMatrix=r.matrix,n.glValueLength=r.length,n.glFunc=r.func)}},setSampler2DBuffer:function(t,e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r={});var a=this.uniforms[t];return a.value=e,r.width=i,r.height=n,a.textureData=r,this._textureCount=s,this.initSampler2D(a),this},setSampler2D:function(t,e,i,n){void 0===i&&(i=0);var s=this.scene.sys.textures;if(s.exists(e)){var r=s.getFrame(e);if(r.glTexture&&r.glTexture.isRenderTexture)return this.setSampler2DBuffer(t,r.glTexture,r.width,r.height,i,n);var a=this.uniforms[t],o=r.source;a.textureKey=e,a.source=o.image,a.value=r.glTexture,o.isGLTexture&&(n||(n={}),n.width=o.width,n.height=o.height),n&&(a.textureData=n),this._textureCount=i,this.initSampler2D(a)}return this},setUniform:function(t,e){return r(this.uniforms,t,e),this},getUniform:function(t){return n(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=t.textureData;if(e&&!t.value.isRenderTexture){var i=this.gl,s=t.value,r=i[n(e,"magFilter","linear").toUpperCase()],a=i[n(e,"minFilter","linear").toUpperCase()],o=i[n(e,"wrapS","repeat").toUpperCase()],h=i[n(e,"wrapT","repeat").toUpperCase()],l=i[n(e,"format","rgba").toUpperCase()],u=n(e,"flipY",!1),c=n(e,"width",s.width),d=n(e,"height",s.height),f=n(e,"source",s.pixels);e.repeat&&(o=i.REPEAT,h=i.REPEAT),e.width&&(f=null),s.update(f,c,d,u,o,h,a,r,l)}this.renderer.setProgram(this.program),this._textureCount++}},syncUniforms:function(){var t,e,i,n,s,r=this.gl,a=this.uniforms,o=0;for(var h in a)i=(t=a[h]).glFunc,e=t.glValueLength,n=t.uniformLocation,null!==(s=t.value)&&(1===e?t.glMatrix?i.call(r,n.webGLUniformLocation,t.transpose,s):i.call(r,n.webGLUniformLocation,s):2===e?i.call(r,n.webGLUniformLocation,s.x,s.y):3===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z):4===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z,s.w):"sampler2D"===t.type&&(r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,s.webGLTexture),r.uniform1i(n.webGLUniformLocation,o),o++))},load:function(t){var e=this.gl,i=this.width,n=this.height,s=this.renderer,r=this.program,a=this.viewMatrix;if(!this.renderToTexture){var o=-this._displayOriginX,h=-this._displayOriginY;a[0]=t[0],a[1]=t[1],a[4]=t[2],a[5]=t[3],a[8]=t[4],a[9]=t[5],a[12]=a[0]*o+a[4]*h,a[13]=a[1]*o+a[5]*h}e.useProgram(r.webGLProgram),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uViewMatrix"),!1,a),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),e.uniform2f(e.getUniformLocation(r.webGLProgram,"uResolution"),this.width,this.height);var l=this.uniforms,u=l.resolution;u.value.x=i,u.value.y=n,l.time.value=s.game.loop.getDuration();var c=this.pointer;if(c){var d=l.mouse,f=c.x/i,p=1-c.y/n;d.value.x=f.toFixed(2),d.value.y=p.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,i=this.program,n=this.gl,s=this.vertexBuffer,r=this.renderer,a=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(r.setFramebuffer(this.framebuffer),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),n.bindBuffer(n.ARRAY_BUFFER,s.webGLBuffer);var o=n.getAttribLocation(i.webGLProgram,"inPosition");-1!==o&&(n.enableVertexAttribArray(o),n.vertexAttribPointer(o,2,n.FLOAT,!1,a,0));var h=this.vertexViewF32;h[3]=e,h[4]=t,h[5]=e,h[8]=t,h[9]=e,h[10]=t;n.bufferSubData(n.ARRAY_BUFFER,0,this.bytes.subarray(0,6*a)),n.drawArrays(n.TRIANGLES,0,6),this.renderToTexture&&r.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},onContextRestored:function(){if(null!==this._deferSetShader){var t=this._deferSetShader.key,e=this._deferSetShader.textures,i=this._deferSetShader.textureData;this._deferSetShader=null,this.setShader(t,e,i)}if(null!==this._deferProjOrtho){var n=this._deferProjOrtho.left,s=this._deferProjOrtho.right,r=this._deferProjOrtho.bottom,a=this._deferProjOrtho.top;this._deferProjOrtho=null,this.projOrtho(n,s,r,a)}},preDestroy:function(){var t=this.renderer;t.off(l.RESTORE_WEBGL,this.onContextRestored,this),t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(t.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null),h(this.uniforms,function(e){t.deleteUniformLocation(e.uniformLocation),e.uniformLocation=null})}});return r$=u}function W$(){if(h$)return o$;h$=1;var t=Kh(),e=Ju(),i=qu();function n(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}var s=new t({initialize:function(t,n,s){this.vertex1=t,this.vertex2=n,this.vertex3=s,this.bounds=new e,this._inCenter=new i},getInCenter:function(t){void 0===t&&(t=!0);var e,i,s,r,a,o,h=this.vertex1,l=this.vertex2,u=this.vertex3;t?(e=h.x,i=h.y,s=l.x,r=l.y,a=u.x,o=u.y):(e=h.vx,i=h.vy,s=l.vx,r=l.vy,a=u.vx,o=u.vy);var c=n(a,o,s,r),d=n(e,i,a,o),f=n(s,r,e,i),p=c+d+f;return this._inCenter.set((e*c+s*d+a*f)/p,(i*c+r*d+o*f)/p)},contains:function(t,e,i){var n=this.vertex1,s=this.vertex2,r=this.vertex3,a=n.vx,o=n.vy,h=s.vx,l=s.vy,u=r.vx,c=r.vy;if(i){var d=i.a,f=i.b,p=i.c,g=i.d,v=i.e,m=i.f;a=n.vx*d+n.vy*p+v,o=n.vx*f+n.vy*g+m,h=s.vx*d+s.vy*p+v,l=s.vx*f+s.vy*g+m,u=r.vx*d+r.vy*p+v,c=r.vx*f+r.vy*g+m}var y=u-a,x=c-o,w=h-a,b=l-o,T=t-a,S=e-o,E=y*y+x*x,_=y*w+x*b,C=y*T+x*S,A=w*w+b*b,P=w*T+b*S,M=E*A-_*_,R=0===M?0:1/M,L=(A*C-_*P)*R,O=(E*P-_*C)*R;return L>=0&&O>=0&&L+O<1},isCounterClockwise:function(t){var e=this.vertex1,i=this.vertex2,n=this.vertex3,s=(i.vx-e.vx)*(n.vy-e.vy)-(i.vy-e.vy)*(n.vx-e.vx);return t<=0?s>=0:s<0},load:function(t,e,i,n,s){return i=this.vertex1.load(t,e,i,n,s),i=this.vertex2.load(t,e,i,n,s),i=this.vertex3.load(t,e,i,n,s)},transformCoordinatesLocal:function(t,e,i,n){return this.vertex1.transformCoordinatesLocal(t,e,i,n),this.vertex2.transformCoordinatesLocal(t,e,i,n),this.vertex3.transformCoordinatesLocal(t,e,i,n),this},updateBounds:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3,n=this.bounds;return n.x=Math.min(t.vx,e.vx,i.vx),n.y=Math.min(t.vy,e.vy,i.vy),n.width=Math.max(t.vx,e.vx,i.vx)-n.x,n.height=Math.max(t.vy,e.vy,i.vy)-n.y,this},isInView:function(t,e,i,n,s,r,a,o,h,l,u){this.update(n,s,r,a,o,h,l,u);var c=this.vertex1,d=this.vertex2,f=this.vertex3;if(c.ta<=0&&d.ta<=0&&f.ta<=0)return!1;if(e&&!this.isCounterClockwise(i))return!1;var p=this.bounds;p.x=Math.min(c.tx,d.tx,f.tx),p.y=Math.min(c.ty,d.ty,f.ty),p.width=Math.max(c.tx,d.tx,f.tx)-p.x,p.height=Math.max(c.ty,d.ty,f.ty)-p.y;var g=t.x+t.width,v=t.y+t.height;return!(p.width<=0||p.height<=0||t.width<=0||t.height<=0)&&!(p.right<t.x||p.bottom<t.y||p.x>g||p.y>v)},scrollUV:function(t,e){return this.vertex1.scrollUV(t,e),this.vertex2.scrollUV(t,e),this.vertex3.scrollUV(t,e),this},scaleUV:function(t,e){return this.vertex1.scaleUV(t,e),this.vertex2.scaleUV(t,e),this.vertex3.scaleUV(t,e),this},setColor:function(t){return this.vertex1.color=t,this.vertex2.color=t,this.vertex3.color=t,this},update:function(t,e,i,n,s,r,a,o){return this.vertex1.update(e,i,n,s,r,a,o,t),this.vertex2.update(e,i,n,s,r,a,o,t),this.vertex3.update(e,i,n,s,r,a,o,t),this},translate:function(t,e){void 0===e&&(e=0);var i=this.vertex1,n=this.vertex2,s=this.vertex3;return i.x+=t,i.y+=e,n.x+=t,n.y+=e,s.x+=t,s.y+=e,this},x:{get:function(){return this.getInCenter().x},set:function(t){var e=this.getInCenter();this.translate(t-e.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(t){var e=this.getInCenter();this.translate(0,t-e.y)}},alpha:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.alpha+e.alpha+i.alpha)/3},set:function(t){this.vertex1.alpha=t,this.vertex2.alpha=t,this.vertex3.alpha=t}},depth:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.vz+e.vz+i.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}});return o$=s}function H$(){if(u$)return l$;u$=1;var t=Kh(),e=_W(),i=zG(),n=new t({Extends:i,initialize:function(t,e,n,s,r,a,o,h,l,u){void 0===a&&(a=16777215),void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),i.call(this,t,e,n),this.vx=0,this.vy=0,this.vz=0,this.nx=h,this.ny=l,this.nz=u,this.u=s,this.v=r,this.color=a,this.alpha=o,this.tx=0,this.ty=0,this.ta=0,this.tu=s,this.tv=r},setUVs:function(t,e){return this.u=t,this.v=e,this.tu=t,this.tv=e,this},scrollUV:function(t,e){return this.tu+=t,this.tv+=e,this},scaleUV:function(t,e){return this.tu=this.u*t,this.tv=this.v*e,this},transformCoordinatesLocal:function(t,e,i,n){var s=this.x,r=this.y,a=this.z,o=t.val,h=s*o[0]+r*o[4]+a*o[8]+o[12],l=s*o[1]+r*o[5]+a*o[9]+o[13],u=s*o[2]+r*o[6]+a*o[10]+o[14],c=s*o[3]+r*o[7]+a*o[11]+o[15];this.vx=h/c*e,this.vy=-l/c*i,this.vz=n<=0?u/c:-u/c},resize:function(t,e,i,n,s,r){return this.x=t,this.y=e,this.vx=this.x*i,this.vy=-this.y*n,this.vz=0,s<.5?this.vx+=i*(.5-s):s>.5&&(this.vx-=i*(s-.5)),r<.5?this.vy+=n*(.5-r):r>.5&&(this.vy-=n*(r-.5)),this},update:function(t,e,i,n,s,r,a,o){var h=this.vx*t+this.vy*i+s,l=this.vx*e+this.vy*n+r;return a&&(h=Math.round(h),l=Math.round(l)),this.tx=h,this.ty=l,this.ta=this.alpha*o,this},load:function(t,i,n,s,r){return t[++n]=this.tx,t[++n]=this.ty,t[++n]=this.tu,t[++n]=this.tv,t[++n]=s,t[++n]=r,i[++n]=e.getTintAppendFloatAlpha(this.color,this.ta),n}});return l$=n}function V$(){if(d$)return c$;d$=1;var t=W$(),e=UG(),i=zG(),n=H$(),s=new i,r=new i,a=new e;return c$=function(e,i,o,h,l,u,c,d,f,p){void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),void 0===p&&(p=!0);var g={faces:[],verts:[]},v=e.materials;s.set(h,l,u),r.set(c,d,f),a.fromRotationXYTranslation(r,s,p);for(var m=0;m<e.models.length;m++)for(var y=e.models[m],x=y.vertices,w=y.textureCoords,b=y.faces,T=0;T<b.length;T++){var S=b[T],E=S.vertices[0],_=S.vertices[1],C=S.vertices[2],A=x[E.vertexIndex],P=x[_.vertexIndex],M=x[C.vertexIndex],R=E.textureCoordsIndex,L=_.textureCoordsIndex,O=C.textureCoordsIndex,F=-1===R?{u:0,v:1}:w[R],D=-1===L?{u:0,v:0}:w[L],I=-1===O?{u:1,v:1}:w[O],k=16777215;""!==S.material&&v[S.material]&&(k=v[S.material]);var B=new n(A.x*o,A.y*o,A.z*o,F.u,F.v,k).transformMat4(a),N=new n(P.x*o,P.y*o,P.z*o,D.u,D.v,k).transformMat4(a),z=new n(M.x*o,M.y*o,M.z*o,I.u,I.v,k).transformMat4(a);g.verts.push(B,N,z),g.faces.push(new t(B,N,z))}return i&&(i.faces=i.faces.concat(g.faces),i.vertices=i.vertices.concat(g.verts)),g},c$}function j$(){if(p$)return f$;p$=1;var t=W$(),e=H$();return f$=function(i,n,s,r,a,o,h,l){if(void 0===r&&(r=!1),void 0===o&&(o=16777215),void 0===h&&(h=1),void 0===l&&(l=!1),i.length===n.length||r){var u,c,d,f,p,g,v,m,y,x,w,b={faces:[],vertices:[]},T=r?3:2,S=Array.isArray(o),E=Array.isArray(h);if(Array.isArray(s)&&s.length>0)for(u=0;u<s.length;u++){var _=s[u],C=2*s[u],A=s[u]*T;c=i[A],d=i[A+1],f=r?i[A+2]:0,p=n[C],g=n[C+1],l&&(g=1-g),v=S?o[_]:o,m=E?h[_]:h,y=0,x=0,w=0,a&&(y=a[A],x=a[A+1],w=r?a[A+2]:0),b.vertices.push(new e(c,d,f,p,g,v,m,y,x,w))}else{var P=0,M=0;for(u=0;u<i.length;u+=T)c=i[u],d=i[u+1],f=r?i[u+2]:0,p=n[P],g=n[P+1],v=S?o[M]:o,m=E?h[M]:h,y=0,x=0,w=0,a&&(y=a[u],x=a[u+1],w=r?a[u+2]:0),b.vertices.push(new e(c,d,f,p,g,v,m,y,x,w)),P+=2,M++}for(u=0;u<b.vertices.length;u+=3){var R=b.vertices[u],L=b.vertices[u+1],O=b.vertices[u+2];b.faces.push(new t(R,L,O))}return b}console.warn("GenerateVerts: vertices and uvs count not equal")},f$}function q$(){if(w$)return x$;w$=1;var t=qh(),e=t,i=t;return e=function(){if(v$)return g$;v$=1;var t=yj();return g$=function(e,i,n,s){var r=i.faces,a=r.length;if(0!==a){n.addToRenderList(i);var o=e.pipelines.set(i.pipeline,i),h=t(i,n,s).calc;e.pipelines.preBatch(i);for(var l=o.setGameObject(i),u=o.vertexViewF32,c=o.vertexViewU32,d=o.vertexCount*o.currentShader.vertexComponentCount-1,f=i.tintFill,p=[],g=i.debugCallback,v=h.a,m=h.b,y=h.c,x=h.d,w=h.e,b=h.f,T=i.viewPosition.z,S=i.hideCCW,E=n.roundPixels,_=n.alpha*i.alpha,C=0,A=0;A<a;A++){var P=r[A];P.isInView(n,S,T,_,v,m,y,x,w,b,E)&&(o.shouldFlush(3)&&(o.flush(),l=o.setGameObject(i),d=o.vertexCount*o.currentShader.vertexComponentCount-1),d=P.load(u,c,d,l,f),C++,o.vertexCount+=3,o.currentBatch.count=o.vertexCount-o.currentBatch.start,g&&p.push(P))}i.totalFrame+=C,g&&g.call(i,i,p),e.pipelines.postBatch(i)}},g$}(),i=y$?m$:(y$=1,m$=function(){}),x$={renderWebGL:e,renderCanvas:i}}function K$(){if(T$)return b$;T$=1;var t=Kh(),e=_c(),i=ac(),n=W$(),s=fU(),r=V$(),a=j$(),o=yj(),h=UG(),l=q$(),u=JG(),c=gu(),d=zG(),f=H$(),p=new t({Extends:s,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.Texture,e.Transform,e.Visible,l],initialize:function(t,e,i,n,r,a,o,l,u,c,f,p){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="__WHITE"),s.call(this,t,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new d,this.modelScale=new d(1,1,1),this.modelRotation=new d,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new h,this.viewPosition=new d,this.viewMatrix=new h,this.projectionMatrix=new h,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1,this.fov,this.displayOriginX=0,this.displayOriginY=0;var g=t.sys.renderer;this.setPosition(e,i),this.setTexture(n,r),this.setSize(g.width,g.height),this.initPipeline(),this.initPostPipeline(),this.setPerspective(g.width,g.height),a&&this.addVertices(a,o,l,u,c,f,p)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(t){return this.viewPosition.addScale(d.LEFT,t),this.dirtyCache[10]=1,this},panY:function(t){return this.viewPosition.y+=d.DOWN.y*t,this.dirtyCache[10]=1,this},panZ:function(t){return this.viewPosition.z+=t,this.dirtyCache[10]=1,this},setPerspective:function(t,e,n,s,r){return void 0===n&&(n=45),void 0===s&&(s=.01),void 0===r&&(r=1e3),this.fov=n,this.projectionMatrix.perspective(i(n),t/e,s,r),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(t,e,i,n){return void 0===t&&(t=this.scene.sys.renderer.getAspectRatio()),void 0===e&&(e=1),void 0===i&&(i=-1e3),void 0===n&&(n=1e3),this.fov=0,this.projectionMatrix.ortho(-t,t,-e,e,i,n),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach(function(t){t.destroy()}),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(t,e,i,n,s,a,o,h,l){var u,c=this.scene.sys.cache.obj.get(t);return c&&(u=r(c,this,e,i,n,s,a,o,h,l)),u&&0!==u.verts.length||console.warn("Mesh.addVerticesFromObj data empty:",t),this},sortByDepth:function(t,e){return t.depth-e.depth},depthSort:function(){return c(this.faces,this.sortByDepth),this},addVertex:function(t,e,i,n,s,r,a){var o=new f(t,e,i,n,s,r,a);return this.vertices.push(o),o},addFace:function(t,e,i){var s=new n(t,e,i);return this.faces.push(s),this.dirtyCache[9]=-1,s},addVertices:function(t,e,i,n,s,r,o){var h=a(t,e,i,n,s,r,o);return h?(this.faces=this.faces.concat(h.faces),this.vertices=this.vertices.concat(h.vertices)):console.warn("Mesh.addVertices data empty or invalid"),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(t){return this.faces[t]},hasFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=0;r<s.length;r++){if(s[r].contains(t,e,n))return!0}return!1},getFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=[],a=0;a<s.length;a++){var h=s[a];h.contains(t,e,n)&&r.push(h)}return c(r,this.sortByDepth)},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebug:null,this},isDirty:function(){var t=this.modelPosition,e=this.modelRotation,i=this.modelScale,n=this.dirtyCache,s=t.x,r=t.y,a=t.z,o=e.x,h=e.y,l=e.z,u=i.x,c=i.y,d=i.z,f=this.getFaceCount(),p=n[0],g=n[1],v=n[2],m=n[3],y=n[4],x=n[5],w=n[6],b=n[7],T=n[8],S=n[9];return n[0]=s,n[1]=r,n[2]=a,n[3]=o,n[4]=h,n[5]=l,n[6]=u,n[7]=c,n[8]=d,n[9]=f,p!==s||g!==r||v!==a||m!==o||y!==h||x!==l||w!==u||b!==c||T!==d||S!==f},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var t=this.dirtyCache;if(this.ignoreDirtyCache||t[10]||this.isDirty()){var e=this.width,i=this.height,n=this.viewMatrix,s=this.viewPosition;t[10]&&(n.identity(),n.translate(s),n.invert(),t[10]=0);var r=this.transformMatrix;r.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var a=s.z,o=this.faces,h=0;h<o.length;h++)o[h].transformCoordinatesLocal(r,e,i,a);this.depthSort()}},renderDebug:function(t,e){for(var i=t.debugGraphic,n=0;n<e.length;n++){var s=e[n],r=s.vertex1.tx,a=s.vertex1.ty,o=s.vertex2.tx,h=s.vertex2.ty,l=s.vertex3.tx,u=s.vertex3.ty;i.strokeTriangle(r,a,o,h,l,u)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null},clearTint:function(){return this.setTint()},setInteractive:function(t){void 0===t&&(t={});var e=function(t,e,i){for(var n=this.faces,s=0;s<n.length;s++){if(n[s].contains(e,i))return!0}return!1}.bind(this);return this.scene.sys.input.enable(this,t,e),this},setTint:function(t){void 0===t&&(t=16777215);for(var e=this.vertices,i=0;i<e.length;i++)e[i].color=t;return this},uvScroll:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scrollUV(t,e);return this},uvScale:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scaleUV(t,e);return this},tint:{set:function(t){this.setTint(t)}},rotateX:{get:function(){return u(this.modelRotation.x)},set:function(t){this.modelRotation.x=i(t)}},rotateY:{get:function(){return u(this.modelRotation.y)},set:function(t){this.modelRotation.y=i(t)}},rotateZ:{get:function(){return u(this.modelRotation.z)},set:function(t){this.modelRotation.z=i(t)}}});return b$=p}function Z$(){if(C$)return _$;C$=1;var t=qh(),e=t,i=t;return e=function(){if(E$)return S$;E$=1;var t=yj(),e=_W();return S$=function(i,n,s,r){var a=n.vertices,o=a.length;if(0!==o){s.addToRenderList(n);var h=i.pipelines.set(n.pipeline,n),l=t(n,s,r,!1).calc;i.pipelines.preBatch(n);var u=h.setGameObject(n),c=h.vertexViewF32,d=h.vertexViewU32,f=h.vertexCount*h.currentShader.vertexComponentCount-1,p=s.roundPixels,g=n.tintFill,v=s.alpha*n.alpha,m=e.getTintAppendFloatAlpha(n.tint,v),y=h.vertexAvailable(),x=-1;y<o&&(x=y);for(var w=0;w<o;w++){var b=a[w];w===x&&(h.flush(),u=h.setGameObject(n),f=0),c[++f]=l.getXRound(b.vx,b.vy,p),c[++f]=l.getYRound(b.vx,b.vy,p),c[++f]=b.u,c[++f]=b.v,c[++f]=u,c[++f]=g,d[++f]=m,h.vertexCount++,h.currentBatch.count=h.vertexCount-h.currentBatch.start}i.pipelines.postBatch(n)}},S$}(),_$={renderWebGL:e,renderCanvas:i}}function J$(){if(P$)return A$;P$=1;var t=Kh(),e=_c(),i=fU(),n=Z$(),s=H$(),r=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,n],initialize:function(t,e,n,r,a,o,h,l,u,c,d){i.call(this,t,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var f=t.textures.getFrame(r,a);this.is3Slice=!c&&!d,f&&f.scale9&&(this.is3Slice=f.is3Slice);for(var p=this.is3Slice?18:54,g=0;g<p;g++)this.vertices.push(new s);this.setPosition(e,n),this.setTexture(r,a),this.setSlices(o,h,l,u,c,d,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(t,e,i,n,s,r,a){void 0===i&&(i=10),void 0===n&&(n=10),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1);var o=this.frame,h=!1;if(this.is3Slice&&a&&0!==s&&0!==r&&(h=!0),h)console.warn("Cannot change 9 slice to 3 slice");else{if(o&&o.scale9&&!a){var l=o.data.scale9Borders,u=l.x,c=l.y;i=u,n=o.width-l.w-u,s=c,r=o.height-l.h-c,void 0===t&&(t=o.width),void 0===e&&(e=o.height)}else void 0===t&&(t=256),void 0===e&&(e=256);this._width=t,this._height=e,this.leftWidth=i,this.rightWidth=n,this.topHeight=s,this.bottomHeight=r,this.is3Slice&&(e=o.height,this._height=e,this.topHeight=e,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.frame.width,r=this.frame.height;this.updateQuadUVs(0,0,0,t/s,i/r),this.updateQuadUVs(6,t/s,0,1-e/s,i/r),this.updateQuadUVs(12,1-e/s,0,1,i/r),this.is3Slice||(this.updateQuadUVs(18,0,i/r,t/s,1-n/r),this.updateQuadUVs(24,t/s,i/r,1-e/s,1-n/r),this.updateQuadUVs(30,1-e/s,i/r,1,1-n/r),this.updateQuadUVs(36,0,1-n/r,t/s,1),this.updateQuadUVs(42,t/s,1-n/r,1-e/s,1),this.updateQuadUVs(48,1-e/s,1-n/r,1,1))},updateVertices:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.width,r=this.height;this.updateQuad(0,-.5,.5,t/s-.5,.5-i/r),this.updateQuad(6,t/s-.5,.5,.5-e/s,.5-i/r),this.updateQuad(12,.5-e/s,.5,.5,.5-i/r),this.is3Slice||(this.updateQuad(18,-.5,.5-i/r,t/s-.5,n/r-.5),this.updateQuad(24,t/s-.5,.5-i/r,.5-e/s,n/r-.5),this.updateQuad(30,.5-e/s,.5-i/r,.5,n/r-.5),this.updateQuad(36,-.5,n/r-.5,t/s-.5,-.5),this.updateQuad(42,t/s-.5,n/r-.5,.5-e/s,-.5),this.updateQuad(48,.5-e/s,n/r-.5,.5,-.5))},updateQuad:function(t,e,i,n,s){var r=this.width,a=this.height,o=this.originX,h=this.originY,l=this.vertices;l[t+0].resize(e,i,r,a,o,h),l[t+1].resize(e,s,r,a,o,h),l[t+2].resize(n,i,r,a,o,h),l[t+3].resize(e,s,r,a,o,h),l[t+4].resize(n,s,r,a,o,h),l[t+5].resize(n,i,r,a,o,h)},updateQuadUVs:function(t,e,i,n,s){var r=this.vertices,a=this.frame,o=a.u0,h=a.v0,l=a.u1,u=a.v1;if(0!==o||1!==l){var c=l-o;e=o+e*c,n=o+n*c}if(0!==h||1!==u){var d=u-h;i=h+i*d,s=h+s*d}r[t+0].setUVs(e,i),r[t+1].setUVs(e,s),r[t+2].setUVs(n,i),r[t+3].setUVs(e,s),r[t+4].setUVs(n,s),r[t+5].setUVs(n,i)},clearTint:function(){return this.setTint(16777215),this},setTint:function(t){return void 0===t&&(t=16777215),this.tint=t,this.tintFill=!1,this},setTintFill:function(t){return this.setTint(t),this.tintFill=!0,this},isTinted:{get:function(){return 16777215!==this.tint}},width:{get:function(){return this._width},set:function(t){this._width=Math.max(t,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(t){this.is3Slice||(this._height=Math.max(t,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},originX:{get:function(){return this._originX},set:function(t){this._originX=t,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(t){this._originY=t,this.updateVertices()}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this._originX=t,this._originY=e,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var t=this.frame.height;this._height=t,this.topHeight=t,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});return A$=r}function $$(){if(O$)return L$;O$=1;var t=qh(),e=t,i=t;return e=function(){if(R$)return M$;R$=1;var t=yj();return M$=function(e,i,n,s){n.addToRenderList(i);var r=e.pipelines.set(i.pipeline),a=t(i,n,s).calc,o=i.width,h=i.height,l=-i._radius,u=-i._radius,c=l+o,d=u+h,f=a.getX(0,0),p=a.getY(0,0),g=a.getX(l,u),v=a.getY(l,u),m=a.getX(l,d),y=a.getY(l,d),x=a.getX(c,d),w=a.getY(c,d),b=a.getX(c,u),T=a.getY(c,u);e.pipelines.preBatch(i),r.batchPointLight(i,n,g,v,m,y,x,w,b,T,f,p),e.pipelines.postBatch(i)},M$}(),L$={renderWebGL:e,renderCanvas:i}}function Q$(){if(D$)return F$;D$=1;var t=Kh(),e=_c(),i=fU(),n=LX(),s=dW(),r=$$(),a=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible,r],initialize:function(t,e,r,a,o,h,l){void 0===a&&(a=16777215),void 0===o&&(o=128),void 0===h&&(h=1),void 0===l&&(l=.1),i.call(this,t,"PointLight"),this.initPipeline(s.POINTLIGHT_PIPELINE),this.initPostPipeline(),this.setPosition(e,r),this.color=n(a),this.intensity=h,this.attenuation=l,this.width=2*o,this.height=2*o,this._radius=o},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*t,this.height=2*t}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}});return F$=a}function tQ(){if(k$)return I$;k$=1;var t=W$(),e=jh(),i=UG(),n=zG(),s=H$(),r=new n,a=new n,o=new i;return I$=function(i){var n,h=e(i,"mesh"),l=e(i,"texture",null),u=e(i,"frame"),c=e(i,"width",1),d=e(i,"height",c),f=e(i,"widthSegments",1),p=e(i,"heightSegments",f),g=e(i,"x",0),v=e(i,"y",0),m=e(i,"z",0),y=e(i,"rotateX",0),x=e(i,"rotateY",0),w=e(i,"rotateZ",0),b=e(i,"zIsUp",!0),T=e(i,"isOrtho",!!h&&h.dirtyCache[11]),S=e(i,"colors",[16777215]),E=e(i,"alphas",[1]),_=e(i,"tile",!1),C=e(i,"flipY",!1),A=e(i,"width",null),P={faces:[],verts:[]};if(r.set(g,v,m),a.set(y,x,w),o.fromRotationXYTranslation(a,r,b),!l&&h)l=h.texture,u||(n=h.frame);else if(h&&"string"==typeof l)l=h.scene.sys.textures.get(l);else if(!l)return P;n||(n=l.get(u)),!A&&T&&l&&h&&(c=n.width/h.height,d=n.height/h.height);var M,R,L=c/2,O=d/2,F=Math.floor(f),D=Math.floor(p),I=F+1,k=D+1,B=c/F,N=d/D,z=[],U=[],Y=0,X=1,G=0,W=1;n&&(Y=n.u0,X=n.u1,C?(G=n.v1,W=n.v0):(G=n.v0,W=n.v1));var H=X-Y,V=W-G;for(R=0;R<k;R++){var j=R*N-O;for(M=0;M<I;M++){var q=M*B-L;U.push(q,-j);var K=Y+H*(M/F),Z=G+V*(R/D);z.push(K,Z)}}Array.isArray(S)||(S=[S]),Array.isArray(E)||(E=[E]);var J=0,$=0;for(R=0;R<D;R++)for(M=0;M<F;M++){var Q=2*(M+I*R),tt=2*(M+I*(R+1)),et=2*(M+1+I*(R+1)),it=2*(M+1+I*R),nt=S[$],st=E[J],rt=new s(U[Q],U[Q+1],0,z[Q],z[Q+1],nt,st).transformMat4(o),at=new s(U[tt],U[tt+1],0,z[tt],z[tt+1],nt,st).transformMat4(o),ot=new s(U[it],U[it+1],0,z[it],z[it+1],nt,st).transformMat4(o),ht=new s(U[tt],U[tt+1],0,z[tt],z[tt+1],nt,st).transformMat4(o),lt=new s(U[et],U[et+1],0,z[et],z[et+1],nt,st).transformMat4(o),ut=new s(U[it],U[it+1],0,z[it],z[it+1],nt,st).transformMat4(o);_&&(rt.setUVs(Y,W),at.setUVs(Y,G),ot.setUVs(X,W),ht.setUVs(Y,G),lt.setUVs(X,G),ut.setUVs(X,W)),++$===S.length&&($=0),++J===E.length&&(J=0),P.verts.push(rt,at,ot,ht,lt,ut),P.faces.push(new t(rt,at,ot),new t(ht,lt,ut))}return h&&(h.faces=h.faces.concat(P.faces),h.vertices=h.vertices.concat(P.verts)),P},I$}function eQ(){if(N$)return B$;N$=1;var t=mX(),e=Kh(),i=tQ(),n=RX(),s=K$(),r=Dq(),a=new e({Extends:s,initialize:function(e,i,n,r,a,o,h,l){r||(r="__DEFAULT"),s.call(this,e,i,n,r,a),this.type="Plane",this.anims=new t(this),this.gridWidth,this.gridHeight,this.isTiled,this._checkerboard=null,this.hideCCW=!1,this.setGridSize(o,h,l),this.setSizeToFrame(!1),this.setViewHeight()},originX:{get:function(){return.5}},originY:{get:function(){return.5}},setGridSize:function(t,e,n){void 0===t&&(t=8),void 0===e&&(e=8),void 0===n&&(n=!1);var s=!1;return n&&(s=!0),this.gridWidth=t,this.gridHeight=e,this.isTiled=n,this.clear(),i({mesh:this,widthSegments:t,heightSegments:e,isOrtho:!1,tile:n,flipY:s}),this},setSizeToFrame:function(t){void 0===t&&(t=!0);var e=this.frame;if(this.setPerspective(this.width/e.width,this.height/e.height),this._checkerboard&&this._checkerboard!==this.texture&&this.removeCheckerboard(),!t)return this;var i,n,s=this.gridWidth,r=this.gridHeight,a=this.vertices,o=e.u0,h=e.u1,l=e.v0,u=e.v1,c=0;if(this.isTiled)for(l=e.v1,u=e.v0,n=0;n<r;n++)for(i=0;i<s;i++)a[c++].setUVs(o,u),a[c++].setUVs(o,l),a[c++].setUVs(h,u),a[c++].setUVs(o,l),a[c++].setUVs(h,l),a[c++].setUVs(h,u);else{var d=s+1,f=r+1,p=h-o,g=u-l,v=[];for(n=0;n<f;n++)for(i=0;i<d;i++){var m=o+p*(i/s),y=l+g*(n/r);v.push(m,y)}for(n=0;n<r;n++)for(i=0;i<s;i++){var x=2*(i+d*n),w=2*(i+d*(n+1)),b=2*(i+1+d*(n+1)),T=2*(i+1+d*n);a[c++].setUVs(v[x],v[x+1]),a[c++].setUVs(v[w],v[w+1]),a[c++].setUVs(v[T],v[T+1]),a[c++].setUVs(v[w],v[w+1]),a[c++].setUVs(v[b],v[b+1]),a[c++].setUVs(v[T],v[T+1])}}return this},setViewHeight:function(t){void 0===t&&(t=this.frame.height);var e=this.fov*(Math.PI/180);this.viewPosition.z=this.height/t/Math.tan(e/2),this.dirtyCache[10]=1},createCheckerboard:function(t,e,i,s,a){void 0===t&&(t=16777215),void 0===e&&(e=255),void 0===i&&(i=255),void 0===s&&(s=255),void 0===a&&(a=128);for(var o=n(t),h=n(e),l=[],u=0;u<16;u++)for(var c=0;c<16;c++)u<8&&c<8||u>7&&c>7?l.push(o.r,o.g,o.b,i):l.push(h.r,h.g,h.b,s);var d=this.scene.sys.textures.addUint8Array(r(),new Uint8Array(l),16,16);return this.removeCheckerboard(),this.setTexture(d),this.setSizeToFrame(),this.setViewHeight(a),this},removeCheckerboard:function(){this._checkerboard&&(this._checkerboard.destroy(),this._checkerboard=null)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},preUpdate:function(t,e){s.prototype.preUpdate.call(this,t,e),this.anims.update(t,e)},preDestroy:function(){this.clear(),this.removeCheckerboard(),this.anims.destroy(),this.anims=void 0,this.debugCallback=null,this.debugGraphic=null}});return B$=a}var iQ,nQ={};var sQ,rQ={};var aQ,oQ={};var hQ,lQ={};var uQ,cQ={};var dQ,fQ={};var pQ,gQ={};var vQ,mQ={};var yQ,xQ={};var wQ,bQ,TQ,SQ,EQ,_Q,CQ,AQ,PQ,MQ,RQ,LQ,OQ,FQ,DQ,IQ,kQ,BQ,NQ,zQ,UQ,YQ,XQ,GQ,WQ,HQ,VQ,jQ,qQ,KQ,ZQ,JQ,$Q,QQ,t0,e0,i0,n0,s0,r0,a0,o0,h0,l0,u0,c0,d0,f0,p0,g0,v0,m0,y0,x0,w0,b0,T0,S0,E0,_0,C0,A0,P0,M0,R0,L0,O0,F0,D0,I0,k0,B0,N0,z0,U0,Y0,X0,G0,W0,H0,V0,j0,q0,K0,Z0,J0,$0,Q0,t1,e1,i1,n1,s1,r1,a1,o1,h1,l1,u1,c1,d1,f1,p1,g1,v1,m1,y1,x1,w1,b1,T1,S1,E1,_1,C1,A1,P1,M1,R1,L1,O1,F1,D1,I1,k1,B1,N1,z1,U1,Y1,X1,G1,W1,H1,V1,j1,q1,K1,Z1,J1,$1,Q1,t2,e2,i2,n2,s2,r2,a2,o2,h2,l2,u2,c2,d2,f2,p2,g2,v2,m2,y2,x2,w2,b2,T2,S2,E2,_2,C2,A2,P2,M2,R2,L2,O2,F2,D2,I2,k2,B2,N2,z2,U2,Y2,X2,G2,W2,H2,V2,j2,q2,K2,Z2,J2,$2,Q2,t3,e3,i3,n3,s3,r3,a3,o3,h3,l3,u3,c3,d3,f3,p3,g3,v3,m3,y3,x3,w3,b3,T3,S3,E3,_3,C3,A3,P3,M3,R3,L3,O3,F3,D3,I3,k3,B3,N3,z3,U3,Y3,X3,G3,W3,H3,V3,j3,q3,K3,Z3,J3,$3,Q3,t5,e5,i5,n5,s5,r5,a5,o5,h5,l5,u5,c5,d5,f5,p5,g5,v5,m5,y5,x5,w5,b5,T5,S5,E5,_5,C5,A5,P5,M5,R5,L5,O5,F5,D5,I5,k5,B5,N5,z5,U5,Y5,X5,G5,W5,H5,V5,j5,q5,K5,Z5,J5,$5,Q5,t4,e4,i4,n4,s4,r4,a4,o4,h4,l4,u4,c4,d4,f4,p4,g4,v4,m4,y4,x4,w4,b4,T4,S4,E4,_4,C4,A4,P4,M4,R4,L4,O4,F4,D4,I4,k4,B4,N4,z4,U4,Y4,X4,G4,W4,H4,V4,j4,q4,K4,Z4,J4,$4,Q4,t6,e6,i6,n6,s6,r6,a6,o6,h6,l6,u6,c6,d6,f6,p6,g6,v6,m6,y6,x6,w6,b6,T6,S6,E6,_6,C6,A6,P6,M6,R6,L6,O6,F6,D6,I6,k6,B6,N6,z6,U6,Y6,X6,G6,W6,H6,V6,j6,q6,K6,Z6,J6,$6,Q6,t8,e8,i8,n8,s8,r8,a8,o8,h8,l8={};function u8(){if(TQ)return bQ;TQ=1;var t=ol(),e=Kh(),i=_c(),n=uV(),s=_W(),r=new e({Extends:t,Mixins:[i.Origin,i.ScrollFactor,i.Visible],initialize:function(e,i,s,r,a,o,h){t.call(this,e,i,s),this.color=new n(r,a,o),this.intensity=h,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1),this.setOrigin(),this.setDisplayOrigin(s)},displayWidth:{get:function(){return this.diameter},set:function(t){this.diameter=t}},displayHeight:{get:function(){return this.diameter},set:function(t){this.diameter=t}},width:{get:function(){return this.diameter},set:function(t){this.diameter=t}},height:{get:function(){return this.diameter},set:function(t){this.diameter=t}},willRender:function(t){return!(r.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setColor:function(t){var e=s.getFloatsFromUintRGB(t);return this.color.set(e[0],e[1],e[2]),this},setIntensity:function(t){return this.intensity=t,this},setRadius:function(t){return this.radius=t,this}});return r.RENDER_MASK=15,bQ=r}function c8(){if(EQ)return SQ;EQ=1;return SQ=function(t,e){var i=e.width/2,n=e.height/2,s=Math.abs(t.x-e.x-i),r=Math.abs(t.y-e.y-n),a=i+t.radius,o=n+t.radius;if(s>a||r>o)return!1;if(s<=i||r<=n)return!0;var h=s-i,l=r-n;return h*h+l*l<=t.radius*t.radius},SQ}function d8(){if(CQ)return _Q;CQ=1;var t=c8(),e=Kh(),i=LY(),n=u8(),s=Q$(),r=uV(),a=Kl(),o=gu(),h=_W(),l=new e({initialize:function(){this.lights=[],this.ambientColor=new r(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(t,e,i,n,r,a){return this.systems.displayList.add(new s(this.scene,t,e,i,n,r,a))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(e){for(var n=this.lights,s=e.worldView,r=[],a=0;a<n.length;a++){var h=n[a];h.willRender(e)&&t(h,s)&&r.push({light:h,distance:i(h.x,h.y,s.centerX,s.centerY)})}return r.length>this.maxLights&&(o(r,this.sortByDistance),r=r.slice(0,this.maxLights)),this.visibleLights=r.length,r},sortByDistance:function(t,e){return t.distance>=e.distance},setAmbientColor:function(t){var e=h.getFloatsFromUintRGB(t);return this.ambientColor.set(e[0],e[1],e[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(t,e,i,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=128),void 0===s&&(s=16777215),void 0===r&&(r=1);var a=h.getFloatsFromUintRGB(s),o=new n(t,e,i,a[0],a[1],a[2],r);return this.lights.push(o),o},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&a(this.lights,e),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}});return _Q=l}function f8(){if(RQ)return MQ;RQ=1;var t={Events:dU(),DisplayList:pj(),GameObjectCreator:DV(),GameObjectFactory:ic(),UpdateList:mj(),Components:_c(),GetCalcMatrix:yj(),BuildGameObject:wj(),BuildGameObjectAnimation:bj(),GameObject:fU(),BitmapText:Cj(),Blitter:Mj(),Bob:Pj(),Container:Oj(),DOMElement:kj(),DynamicBitmapText:Nj(),Extern:Uj(),Graphics:Zj(),Group:eq(),Image:QV(),Layer:nq(),Particles:ok?ak:(ok=1,ak={EmitterColorOp:aq(),EmitterOp:rq(),Events:oq(),GravityWell:lq(),Particle:uq(),ParticleBounds:cq(),ParticleEmitter:Sq(),ParticleProcessor:hq(),Zones:rk?sk:(rk=1,sk={DeathZone:fq(),EdgeZone:pq(),RandomZone:wq()})}),PathFollower:Eq(),RenderTexture:_q(),RetroFont:Aq(),Rope:Mq(),Sprite:tq(),Text:Iq(),GetTextSize:Rq(),MeasureText:Oq(),TextStyle:Fq(),TileSprite:Bq(),Zone:pU(),Video:zq(),Shape:Uq(),Arc:Vq(),Curve:qq(),Ellipse:Zq(),Grid:$q(),IsoBox:tK(),IsoTriangle:iK(),Line:sK(),Polygon:dK(),Rectangle:pK(),Star:vK(),Triangle:TK(),Factories:{Blitter:_K(),Container:PK(),DOMElement:LK(),DynamicBitmapText:DK(),Extern:BK(),Graphics:UK(),Group:GK(),Image:VK(),Layer:KK(),Particles:$K(),PathFollower:eZ(),RenderTexture:sZ(),Rope:oZ(),Sprite:uZ(),StaticBitmapText:fZ(),Text:vZ(),TileSprite:xZ(),Zone:TZ(),Video:_Z(),Arc:PZ(),Curve:LZ(),Ellipse:DZ(),Grid:BZ(),IsoBox:UZ(),IsoTriangle:GZ(),Line:VZ(),Polygon:KZ(),Rectangle:$Z(),Star:eJ(),Triangle:sJ()},Creators:{Blitter:oJ(),Container:uJ(),DynamicBitmapText:fJ(),Graphics:vJ(),Group:xJ(),Image:TJ(),Layer:_J(),Particles:PJ(),RenderTexture:LJ(),Rope:DJ(),Sprite:BJ(),StaticBitmapText:UJ(),Text:GJ(),TileSprite:VJ(),Zone:KJ(),Video:U$()}};return t.Shader=G$(),t.Mesh=K$(),t.NineSlice=J$(),t.PointLight=Q$(),t.Plane=eQ(),t.Factories.Shader=function(){if(iQ)return nQ;iQ=1;var t=G$();return ic().register("shader",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),nQ}(),t.Factories.Mesh=function(){if(sQ)return rQ;sQ=1;var t=K$();return ic().register("mesh",function(e,i,n,s,r,a,o,h,l,u,c){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u,c))}),rQ}(),t.Factories.NineSlice=function(){if(aQ)return oQ;aQ=1;var t=J$();return ic().register("nineslice",function(e,i,n,s,r,a,o,h,l,u){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u))}),oQ}(),t.Factories.PointLight=function(){if(hQ)return lQ;hQ=1;var t=ic(),e=Q$();return t.register("pointlight",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),lQ}(),t.Factories.Plane=function(){if(uQ)return cQ;uQ=1;var t=eQ();return ic().register("plane",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),cQ}(),t.Creators.Shader=function(){if(dQ)return fQ;dQ=1;var t=wj(),e=DV(),i=xj(),n=G$();return e.register("shader",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"x",0),o=i(e,"y",0),h=i(e,"width",128),l=i(e,"height",128),u=new n(this.scene,r,a,o,h,l);return void 0!==s&&(e.add=s),t(this.scene,u,e),u}),fQ}(),t.Creators.Mesh=function(){if(pQ)return gQ;pQ=1;var t=wj(),e=DV(),i=xj(),n=Vl(),s=K$();return e.register("mesh",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"vertices",[]),l=n(e,"uvs",[]),u=n(e,"indicies",[]),c=n(e,"containsZ",!1),d=n(e,"normals",[]),f=n(e,"colors",16777215),p=n(e,"alphas",1),g=new s(this.scene,0,0,a,o,h,l,u,c,d,f,p);return void 0!==r&&(e.add=r),t(this.scene,g,e),g}),gQ}(),t.Creators.NineSlice=function(){if(vQ)return mQ;vQ=1;var t=wj(),e=DV(),i=xj(),n=Vl(),s=J$();return e.register("nineslice",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"width",256),l=n(e,"height",256),u=n(e,"leftWidth",10),c=n(e,"rightWidth",10),d=n(e,"topHeight",0),f=n(e,"bottomHeight",0),p=new s(this.scene,0,0,a,o,h,l,u,c,d,f);return void 0!==r&&(e.add=r),t(this.scene,p,e),p}),mQ}(),t.Creators.PointLight=function(){if(yQ)return xQ;yQ=1;var t=wj(),e=DV(),i=xj(),n=Q$();return e.register("pointlight",function(e,s){void 0===e&&(e={});var r=i(e,"color",16777215),a=i(e,"radius",128),o=i(e,"intensity",1),h=i(e,"attenuation",.1),l=new n(this.scene,0,0,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),xQ}(),t.Creators.Plane=function(){if(wQ)return l8;wQ=1;var t=wj(),e=bj(),i=DV(),n=xj(),s=Vl(),r=eQ();return i.register("plane",function(i,a){void 0===i&&(i={});var o=n(i,"key",null),h=n(i,"frame",null),l=s(i,"width",8),u=s(i,"height",8),c=s(i,"tile",!1),d=new r(this.scene,0,0,o,h,l,u,c);void 0!==a&&(i.add=a);var f=s(i,"checkerboard",null);if(f){var p=s(f,"color1",16777215),g=s(f,"color2",255),v=s(f,"alpha1",255),m=s(f,"alpha2",255),y=s(f,"height",128);d.createCheckerboard(p,g,v,m,y)}return t(this.scene,d,i),e(d,i),d}),l8}(),t.Light=u8(),t.LightsManager=d8(),t.LightsPlugin=function(){if(PQ)return AQ;PQ=1;var t=Kh(),e=d8(),i=tc(),n=ec(),s=new t({Extends:e,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(n.BOOT,this.boot,this),e.call(this)},boot:function(){var t=this.systems.events;t.on(n.SHUTDOWN,this.shutdown,this),t.on(n.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});return i.register("LightsPlugin",s,"lights"),AQ=s}(),MQ=t}function p8(){if(ZQ)return KQ;ZQ=1;var t=ol();return t.Area=(OQ||(OQ=1,LQ=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}),LQ),t.Circumference=sl(),t.CircumferencePoint=Qh(),t.Clone=function(){if(DQ)return FQ;DQ=1;var t=ol();return FQ=function(e){return new t(e.x,e.y,e.radius)}}(),t.Contains=Zh(),t.ContainsPoint=function(){if(kQ)return IQ;kQ=1;var t=Zh();return IQ=function(e,i){return t(e,i.x,i.y)},IQ}(),t.ContainsRect=function(){if(NQ)return BQ;NQ=1;var t=Zh();return BQ=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},BQ}(),t.CopyFrom=UQ?zQ:(UQ=1,zQ=function(t,e){return e.setTo(t.x,t.y,t.radius)}),t.Equals=(XQ||(XQ=1,YQ=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}),YQ),t.GetBounds=function(){if(WQ)return GQ;WQ=1;var t=Ju();return GQ=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.diameter,i.height=e.diameter,i},GQ}(),t.GetPoint=nl(),t.GetPoints=rl(),t.Offset=(VQ||(VQ=1,HQ=function(t,e,i){return t.x+=e,t.y+=i,t}),HQ),t.OffsetPoint=(qQ||(qQ=1,jQ=function(t,e){return t.x+=e.x,t.y+=e.y,t}),jQ),t.Random=al(),KQ=t}function g8(){if(v0)return g0;v0=1;var t=jj();return t.Area=($Q||($Q=1,JQ=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}),JQ),t.Circumference=Hj(),t.CircumferencePoint=Gj(),t.Clone=function(){if(t0)return QQ;t0=1;var t=jj();return QQ=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=Xj(),t.ContainsPoint=function(){if(i0)return e0;i0=1;var t=Xj();return e0=function(e,i){return t(e,i.x,i.y)},e0}(),t.ContainsRect=function(){if(s0)return n0;s0=1;var t=Xj();return n0=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},n0}(),t.CopyFrom=a0?r0:(a0=1,r0=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}),t.Equals=(h0||(h0=1,o0=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),o0),t.GetBounds=function(){if(u0)return l0;u0=1;var t=Ju();return l0=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.width,i.height=e.height,i},l0}(),t.GetPoint=Wj(),t.GetPoints=Vj(),t.Offset=(d0||(d0=1,c0=function(t,e,i){return t.x+=e,t.y+=i,t}),c0),t.OffsetPoint=(p0||(p0=1,f0=function(t,e){return t.x+=e.x,t.y+=e.y,t}),f0),t.Random=SY(),g0=t}function v8(){if(y0)return m0;y0=1;var t=LY();return m0=function(e,i){return t(e.x,e.y,i.x,i.y)<=e.radius+i.radius}}function m8(){if(w0)return x0;w0=1;var t=$h(),e=v8();return x0=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o,h,l=i.x,u=i.y,c=i.radius,d=n.x,f=n.y,p=n.radius;if(u===f)0===(o=(a=-2*f)*a-4*(r=1)*(d*d+(h=(p*p-c*c-d*d+l*l)/(2*(l-d)))*h-2*d*h+f*f-p*p))?s.push(new t(h,-a/(2*r))):o>0&&(s.push(new t(h,(-a+Math.sqrt(o))/(2*r))),s.push(new t(h,(-a-Math.sqrt(o))/(2*r))));else{var g=(l-d)/(u-f),v=(p*p-c*c-d*d+l*l-f*f+u*u)/(2*(u-f));0===(o=(a=2*u*g-2*v*g-2*l)*a-4*(r=g*g+1)*(l*l+u*u+v*v-c*c-2*u*v))?(h=-a/(2*r),s.push(new t(h,v-h*g))):o>0&&(h=(-a+Math.sqrt(o))/(2*r),s.push(new t(h,v-h*g)),h=(-a-Math.sqrt(o))/(2*r),s.push(new t(h,v-h*g)))}}return s}}function y8(){if(T0)return b0;T0=1;var t=Zh(),e=new($h());return b0=function(i,n,s){if(void 0===s&&(s=e),t(n,i.x1,i.y1))return s.x=i.x1,s.y=i.y1,!0;if(t(n,i.x2,i.y2))return s.x=i.x2,s.y=i.y2,!0;var r=i.x2-i.x1,a=i.y2-i.y1,o=n.x-i.x1,h=n.y-i.y1,l=r*r+a*a,u=r,c=a;if(l>0){var d=(o*r+h*a)/l;u*=d,c*=d}return s.x=i.x1+u,s.y=i.y1+c,u*u+c*c<=l&&u*r+c*a>=0&&t(n,s.x,s.y)},b0}function x8(){if(E0)return S0;E0=1;var t=$h(),e=y8();return S0=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o=i.x1,h=i.y1,l=i.x2,u=i.y2,c=n.x,d=n.y,f=n.radius,p=l-o,g=u-h,v=o-c,m=h-d,y=p*p+g*g,x=2*(p*v+g*m),w=x*x-4*y*(v*v+m*m-f*f);if(0===w){var b=-x/(2*y);r=o+b*p,a=h+b*g,b>=0&&b<=1&&s.push(new t(r,a))}else if(w>0){var T=(-x-Math.sqrt(w))/(2*y);r=o+T*p,a=h+T*g,T>=0&&T<=1&&s.push(new t(r,a));var S=(-x+Math.sqrt(w))/(2*y);r=o+S*p,a=h+S*g,S>=0&&S<=1&&s.push(new t(r,a))}}return s},S0}function w8(){if(C0)return _0;C0=1;var t=x8(),e=c8();return _0=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=n.getLineD();t(r,i,s),t(a,i,s),t(o,i,s),t(h,i,s)}return s},_0}function b8(){if(P0)return A0;P0=1;var t=zG();return A0=function(e,i,n,s){void 0===n&&(n=!1);var r,a,o,h=e.x1,l=e.y1,u=e.x2,c=e.y2,d=i.x1,f=i.y1,p=u-h,g=c-l,v=i.x2-d,m=i.y2-f,y=p*m-g*v;if(0===y)return null;if(n){if(r=(p*(f-l)+g*(h-d))/(v*g-m*p),0!==p)a=(d+v*r-h)/p;else{if(0===g)return null;a=(f+m*r-l)/g}if(a<0||r<0||r>1)return null;o=a}else{if(a=((l-f)*p-(h-d)*g)/y,(r=((d-h)*m-(f-l)*v)/y)<0||r>1||a<0||a>1)return null;o=r}return void 0===s&&(s=new t),s.set(h+p*o,l+g*o,o)}}function T8(){if(R0)return M0;R0=1;var t=b8(),e=Ku(),i=zG(),n=new e,s=new i;return M0=function(e,r,a,o){void 0===a&&(a=!1),void 0===o&&(o=new i);var h=!1;o.set(),s.set();for(var l=r[r.length-1],u=0;u<r.length;u++){var c=r[u];n.setTo(l.x,l.y,c.x,c.y),l=c,t(e,n,a,s)&&(!h||s.z<o.z)&&(o.copy(s),h=!0)}return h?o:null},M0}function S8(){if(O0)return L0;O0=1;var t=zG(),e=oW(),i=T8(),n=new t;return L0=function(t,s,r,a){void 0===a&&(a=new e),Array.isArray(s)||(s=[s]);var o=!1;a.set(),n.set();for(var h=0;h<s.length;h++)i(t,s[h].points,r,n)&&(!o||n.z<a.z)&&(a.set(n.x,n.y,n.z,h),o=!0);return o?a:null},L0}function E8(){if(D0)return F0;D0=1;return F0=function(t,e,i){var n=t.x1,s=t.y1,r=t.x2,a=t.y2,o=e.x1,h=e.y1,l=e.x2,u=e.y2;if(n===r&&s===a||o===l&&h===u)return!1;var c=(u-h)*(r-n)-(l-o)*(a-s);if(0===c)return!1;var d=((l-o)*(s-h)-(u-h)*(n-o))/c,f=((r-n)*(s-h)-(a-s)*(n-o))/c;return!(d<0||d>1||f<0||f>1)&&(i&&(i.x=n+d*(r-n),i.y=s+d*(a-s)),!0)}}function _8(){if(k0)return I0;k0=1;return I0=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=e.x,o=e.y,h=e.right,l=e.bottom,u=0;if(i>=a&&i<=h&&n>=o&&n<=l||s>=a&&s<=h&&r>=o&&r<=l)return!0;if(i<a&&s>=a){if((u=n+(r-n)*(a-i)/(s-i))>o&&u<=l)return!0}else if(i>h&&s<=h&&(u=n+(r-n)*(h-i)/(s-i))>=o&&u<=l)return!0;if(n<o&&r>=o){if((u=i+(s-i)*(o-n)/(r-n))>=a&&u<=h)return!0}else if(n>l&&r<=l&&(u=i+(s-i)*(l-n)/(r-n))>=a&&u<=h)return!0;return!1},I0}function C8(){if(N0)return B0;N0=1;var t=$h(),e=E8(),i=_8();return B0=function(n,s,r){if(void 0===r&&(r=[]),i(n,s))for(var a=s.getLineA(),o=s.getLineB(),h=s.getLineC(),l=s.getLineD(),u=[new t,new t,new t,new t],c=[e(a,n,u[0]),e(o,n,u[1]),e(h,n,u[2]),e(l,n,u[3])],d=0;d<4;d++)c[d]&&r.push(u[d]);return r},B0}function A8(){if(U0)return z0;U0=1;var t=oW(),e=S8(),i=new(Ku());function n(n,s,r,a,o){var h=Math.cos(n),l=Math.sin(n);i.setTo(s,r,s+h,r+l);var u=e(i,a,!0);u&&o.push(new t(u.x,u.y,n,u.w))}function s(t,e){return t.z-e.z}return z0=function(t,e,i){Array.isArray(i)||(i=[i]);for(var r=[],a=[],o=0;o<i.length;o++)for(var h=i[o].points,l=0;l<h.length;l++){var u=Math.atan2(h[l].y-e,h[l].x-t);-1===a.indexOf(u)&&(n(u,t,e,i,r),n(u-1e-5,t,e,i,r),n(u+1e-5,t,e,i,r),a.push(u))}return r.sort(s)},z0}function P8(){if(X0)return Y0;X0=1;var t=Ju(),e=bq();return Y0=function(i,n,s){return void 0===s&&(s=new t),e(i,n)&&(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y),s}}function M8(){if(W0)return G0;W0=1;var t=C8(),e=bq();return G0=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC(),h=i.getLineD();t(r,n,s),t(a,n,s),t(o,n,s),t(h,n,s)}return s}}function R8(){if(V0)return H0;V0=1;return H0=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=[]);for(var s,r,a,o,h,l,u=t.x3-t.x1,c=t.y3-t.y1,d=t.x2-t.x1,f=t.y2-t.y1,p=u*u+c*c,g=u*d+c*f,v=d*d+f*f,m=p*v-g*g,y=0===m?0:1/m,x=t.x1,w=t.y1,b=0;b<e.length&&(r=(p*(l=d*(a=e[b].x-x)+f*(o=e[b].y-w))-g*(h=u*a+c*o))*y,!((s=(v*h-g*l)*y)>=0&&r>=0&&s+r<1&&(n.push({x:e[b].x,y:e[b].y}),i)));b++);return n},H0}function L8(){if(q0)return j0;q0=1;return j0=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e}}function O8(){if(Z0)return K0;Z0=1;var t=E8(),e=zu(),i=R8(),n=L8();return K0=function(s,r){if(r.left>s.right||r.right<s.left||r.top>s.bottom||r.bottom<s.top)return!1;var a=r.getLineA(),o=r.getLineB(),h=r.getLineC();if(e(s,a.x1,a.y1)||e(s,a.x2,a.y2))return!0;if(e(s,o.x1,o.y1)||e(s,o.x2,o.y2))return!0;if(e(s,h.x1,h.y1)||e(s,h.x2,h.y2))return!0;var l=s.getLineA(),u=s.getLineB(),c=s.getLineC(),d=s.getLineD();if(t(a,l)||t(a,u)||t(a,c)||t(a,d))return!0;if(t(o,l)||t(o,u)||t(o,c)||t(o,d))return!0;if(t(h,l)||t(h,u)||t(h,c)||t(h,d))return!0;var f=n(s);return i(r,f,!0).length>0},K0}function F8(){if($0)return J0;$0=1;var t=O8(),e=C8();return J0=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(r,i,s),e(a,i,s),e(o,i,s)}return s},J0}function D8(){if(t1)return Q0;t1=1;var t=y8(),e=mK();return Q0=function(i,n){return!(i.left>n.right||i.right<n.left||i.top>n.bottom||i.bottom<n.top)&&(!!e(i,n.x,n.y)||(!!t(i.getLineA(),n)||(!!t(i.getLineB(),n)||!!t(i.getLineC(),n))))},Q0}function I8(){if(i1)return e1;i1=1;var t=x8(),e=D8();return e1=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();t(r,n,s),t(a,n,s),t(o,n,s)}return s},e1}function k8(){if(s1)return n1;s1=1;var t=E8();return n1=function(e,i){return!(!e.contains(i.x1,i.y1)&&!e.contains(i.x2,i.y2))||(!!t(e.getLineA(),i)||(!!t(e.getLineB(),i)||!!t(e.getLineC(),i)))},n1}function B8(){if(a1)return r1;a1=1;var t=$h(),e=k8(),i=E8();return r1=function(n,s,r){if(void 0===r&&(r=[]),e(n,s))for(var a=n.getLineA(),o=n.getLineB(),h=n.getLineC(),l=[new t,new t,new t],u=[i(a,s,l[0]),i(o,s,l[1]),i(h,s,l[2])],c=0;c<3;c++)u[c]&&r.push(l[c]);return r},r1}function N8(){if(h1)return o1;h1=1;return o1=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e},o1}function z8(){if(u1)return l1;u1=1;var t=R8(),e=N8(),i=E8();return l1=function(n,s){if(n.left>s.right||n.right<s.left||n.top>s.bottom||n.bottom<s.top)return!1;var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=s.getLineA(),l=s.getLineB(),u=s.getLineC();if(i(r,h)||i(r,l)||i(r,u))return!0;if(i(a,h)||i(a,l)||i(a,u))return!0;if(i(o,h)||i(o,l)||i(o,u))return!0;var c=e(n),d=t(s,c,!0);return d.length>0||(c=e(s),(d=t(n,c,!0)).length>0)}}function U8(){if(d1)return c1;d1=1;var t=z8(),e=B8();return c1=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(i,r,s),e(i,a,s),e(i,o,s)}return s}}function Y8(){if(p1)return f1;p1=1;return f1=function(t,e,i){void 0===i&&(i=1);var n=e.x1,s=e.y1,r=e.x2,a=e.y2,o=t.x,h=t.y,l=(r-n)*(r-n)+(a-s)*(a-s);if(0===l)return!1;var u=((o-n)*(r-n)+(h-s)*(a-s))/l;if(u<0)return Math.sqrt((n-o)*(n-o)+(s-h)*(s-h))<=i;if(u>=0&&u<=1){var c=((s-h)*(r-n)-(n-o)*(a-s))/l;return Math.abs(c)*Math.sqrt(l)<=i}return Math.sqrt((r-o)*(r-o)+(a-h)*(a-h))<=i},f1}function X8(){if(v1)return g1;v1=1;var t=Y8();return g1=function(e,i){if(!t(e,i))return!1;var n=Math.min(i.x1,i.x2),s=Math.max(i.x1,i.x2),r=Math.min(i.y1,i.y2),a=Math.max(i.y1,i.y2);return e.x>=n&&e.x<=s&&e.y>=r&&e.y<=a},g1}function G8(){if(y1)return m1;y1=1;return m1=function(t,e,i,n,s,r){return void 0===r&&(r=0),!(e>t.right+r||i<t.left-r||n>t.bottom+r||s<t.top-r)}}function W8(){return w1?x1:(w1=1,x1={CircleToCircle:v8(),CircleToRectangle:c8(),GetCircleToCircle:m8(),GetCircleToRectangle:w8(),GetLineToCircle:x8(),GetLineToLine:b8(),GetLineToPoints:T8(),GetLineToPolygon:S8(),GetLineToRectangle:C8(),GetRaysFromPointToPolygon:A8(),GetRectangleIntersection:P8(),GetRectangleToRectangle:M8(),GetRectangleToTriangle:F8(),GetTriangleToCircle:I8(),GetTriangleToLine:B8(),GetTriangleToTriangle:U8(),LineToCircle:y8(),LineToLine:E8(),LineToRectangle:_8(),PointToLine:Y8(),PointToLineSegment:X8(),RectangleToRectangle:bq(),RectangleToTriangle:O8(),RectangleToValues:G8(),TriangleToCircle:D8(),TriangleToLine:k8(),TriangleToTriangle:z8()})}function H8(){if(T1)return b1;T1=1;return b1=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)},b1}function V8(){if(W1)return G1;W1=1;var t=il(),e=wc(),i=H8();return G1=function(n){var s=i(n)-t.TAU;return e(s,-Math.PI,Math.PI)},G1}function j8(){if(i2)return e2;i2=1;return e2=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,t},e2}function q8(){if(p2)return f2;p2=1;var t=Ku();return t.Angle=H8(),t.BresenhamPoints=yY(),t.CenterOn=(E1||(E1=1,S1=function(t,e,i){var n=e-(t.x1+t.x2)/2,s=i-(t.y1+t.y2)/2;return t.x1+=n,t.y1+=s,t.x2+=n,t.y2+=s,t}),S1),t.Clone=function(){if(C1)return _1;C1=1;var t=Ku();return _1=function(e){return new t(e.x1,e.y1,e.x2,e.y2)}}(),t.CopyFrom=P1?A1:(P1=1,A1=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}),t.Equals=(R1||(R1=1,M1=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}),M1),t.Extend=function(){if(O1)return L1;O1=1;var t=Wu();return L1=function(e,i,n){void 0===n&&(n=i);var s=t(e),r=e.x2-e.x1,a=e.y2-e.y1;return i&&(e.x1=e.x1-r/s*i,e.y1=e.y1-a/s*i),n&&(e.x2=e.x2+r/s*n,e.y2=e.y2+a/s*n),e},L1}(),t.GetEasedPoints=pY(),t.GetMidPoint=function(){if(D1)return F1;D1=1;var t=$h();return F1=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2)/2,i.y=(e.y1+e.y2)/2,i},F1}(),t.GetNearestPoint=function(){if(k1)return I1;k1=1;var t=$h();return I1=function(e,i,n){void 0===n&&(n=new t);var s=e.x1,r=e.y1,a=e.x2,o=e.y2,h=(a-s)*(a-s)+(o-r)*(o-r);if(0===h)return n;var l=((i.x-s)*(a-s)+(i.y-r)*(o-r))/h;return n.x=s+l*(a-s),n.y=r+l*(o-r),n},I1}(),t.GetNormal=function(){if(N1)return B1;N1=1;var t=il(),e=H8(),i=$h();return B1=function(n,s){void 0===s&&(s=new i);var r=e(n)-t.TAU;return s.x=Math.cos(r),s.y=Math.sin(r),s},B1}(),t.GetPoint=Gu(),t.GetPoints=Hu(),t.GetShortestDistance=(U1||(U1=1,z1=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=(s-i)*(s-i)+(r-n)*(r-n);if(0===a)return!1;var o=((n-e.y)*(s-i)-(i-e.x)*(r-n))/a;return Math.abs(o)*Math.sqrt(a)}),z1),t.Height=(X1||(X1=1,Y1=function(t){return Math.abs(t.y1-t.y2)}),Y1),t.Length=Wu(),t.NormalAngle=V8(),t.NormalX=function(){if(V1)return H1;V1=1;var t=il(),e=H8();return H1=function(i){return Math.cos(e(i)-t.TAU)},H1}(),t.NormalY=function(){if(q1)return j1;q1=1;var t=il(),e=H8();return j1=function(i){return Math.sin(e(i)-t.TAU)},j1}(),t.Offset=(Z1||(Z1=1,K1=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t}),K1),t.PerpSlope=($1||($1=1,J1=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}),J1),t.Random=Vu(),t.ReflectAngle=function(){if(t2)return Q1;t2=1;var t=H8(),e=V8();return Q1=function(i,n){return 2*e(n)-Math.PI-t(i)}}(),t.Rotate=function(){if(s2)return n2;s2=1;var t=j8();return n2=function(e,i){var n=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2;return t(e,n,s,i)},n2}(),t.RotateAroundPoint=function(){if(a2)return r2;a2=1;var t=j8();return r2=function(e,i,n){return t(e,i.x,i.y,n)},r2}(),t.RotateAroundXY=j8(),t.SetToAngle=(h2||(h2=1,o2=function(t,e,i,n,s){return t.x1=e,t.y1=i,t.x2=e+Math.cos(n)*s,t.y2=i+Math.sin(n)*s,t}),o2),t.Slope=(u2||(u2=1,l2=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}),l2),t.Width=(d2||(d2=1,c2=function(t){return Math.abs(t.x1-t.x2)}),c2),f2=t}function K8(){if(v2)return g2;v2=1;var t=!0,e="untitled",i="",n="";function s(t){var e=t.indexOf("#");return e>-1?t.substring(0,e):t}function r(t){return 0===t.models.length&&t.models.push({faces:[],name:e,textureCoords:[],vertexNormals:[],vertices:[]}),i="",t.models[t.models.length-1]}function a(t,n){var s=t.length>=2?t[1]:e;n.models.push({faces:[],name:s,textureCoords:[],vertexNormals:[],vertices:[]}),i=""}function o(t){2===t.length&&(i=t[1])}function h(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertices.push({x:n,y:s,z:a})}function l(e,i){var n=e.length,s=n>=2?parseFloat(e[1]):0,a=n>=3?parseFloat(e[2]):0,o=n>=4?parseFloat(e[3]):0;isNaN(s)&&(s=0),isNaN(a)&&(a=0),isNaN(o)&&(o=0),t&&(a=1-a),r(i).textureCoords.push({u:s,v:a,w:o})}function u(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertexNormals.push({x:n,y:s,z:a})}function c(t,e){var s=t.length-1;if(!(s<3)){for(var a={group:i,material:n,vertices:[]},o=0;o<s;o++){var h=t[o+1].split("/"),l=h.length;if(!(l<1||l>3)){var u=0,c=0,d=0;u=parseInt(h[0],10),l>1&&""!==h[1]&&(c=parseInt(h[1],10)),l>2&&(d=parseInt(h[2],10)),0!==u&&(u<0&&(u=r(e).vertices.length+1+u),c-=1,u-=1,d-=1,a.vertices.push({textureCoordsIndex:c,vertexIndex:u,vertexNormalIndex:d}))}}r(e).faces.push(a)}}function d(t,e){t.length>=2&&e.materialLibraries.push(t[1])}function f(t){t.length>=2&&(n=t[1])}return g2=function(e,r){void 0===r&&(r=!0),t=r;var p={materials:{},materialLibraries:[],models:[]};i="",n="";for(var g=e.split("\n"),v=0;v<g.length;v++){var m=s(g[v]).replace(/\s\s+/g," ").trim().split(" ");switch(m[0].toLowerCase()){case"o":a(m,p);break;case"g":o(m);break;case"v":h(m,p);break;case"vt":l(m,p);break;case"vn":u(m,p);break;case"f":c(m,p);break;case"mtllib":d(m,p);break;case"usemtl":f(m)}}return p},g2}function Z8(){if(y2)return m2;y2=1;var t=EX();return m2=function(e){for(var i={},n=e.split("\n"),s="",r=0;r<n.length;r++){var a=n[r].trim();if(0!==a.indexOf("#")&&""!==a){var o=a.replace(/\s\s+/g," ").trim().split(" ");switch(o[0].toLowerCase()){case"newmtl":s=o[1];break;case"kd":var h=Math.floor(255*o[1]),l=o.length>=2?Math.floor(255*o[2]):h,u=o.length>=3?Math.floor(255*o[3]):h;i[s]=t(h,l,u)}}}return i},m2}function J8(){if(w2)return x2;w2=1;return x2=function(t,e,i,n){var s,r;if(void 0===i&&void 0===n){var a=t.getInCenter();s=a.x,r=a.y}var o=Math.cos(e),h=Math.sin(e),l=t.vertex1,u=t.vertex2,c=t.vertex3,d=l.x-s,f=l.y-r;l.set(d*o-f*h+s,d*h+f*o+r),d=u.x-s,f=u.y-r,u.set(d*o-f*h+s,d*h+f*o+r),d=c.x-s,f=c.y-r,c.set(d*o-f*h+s,d*h+f*o+r)},x2}function $8(){if(T2)return b2;T2=1;var t={Face:W$(),GenerateGridVerts:tQ(),GenerateObjVerts:V$(),GenerateVerts:j$(),ParseObj:K8(),ParseObjMaterial:Z8(),RotateFace:J8(),Vertex:H$()};return b2=t}function Q8(){if(k2)return I2;k2=1;return I2=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},I2}function t7(){if(N2)return B2;N2=1;return B2=function(t){return t.x*t.x+t.y*t.y},B2}function e7(){if(t3)return Q2;t3=1;var t=$h();return t.Ceil=(E2||(E2=1,S2=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}),S2),t.Clone=function(){if(C2)return _2;C2=1;var t=$h();return _2=function(e){return new t(e.x,e.y)}}(),t.CopyFrom=P2?A2:(P2=1,A2=function(t,e){return e.setTo(t.x,t.y)}),t.Equals=(R2||(R2=1,M2=function(t,e){return t.x===e.x&&t.y===e.y}),M2),t.Floor=(O2||(O2=1,L2=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}),L2),t.GetCentroid=function(){if(D2)return F2;D2=1;var t=$h();return F2=function(e,i){if(void 0===i&&(i=new t),!Array.isArray(e))throw new Error("GetCentroid points argument must be an array");var n=e.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)i.x=e[0].x,i.y=e[0].y;else{for(var s=0;s<n;s++)i.x+=e[s].x,i.y+=e[s].y;i.x/=n,i.y/=n}return i}}(),t.GetMagnitude=Q8(),t.GetMagnitudeSq=t7(),t.GetRectangleFromPoints=function(){if(U2)return z2;U2=1;var t=Ju();return z2=function(e,i){void 0===i&&(i=new t);for(var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=0;o<e.length;o++){var h=e[o];h.x>n&&(n=h.x),h.x<s&&(s=h.x),h.y>r&&(r=h.y),h.y<a&&(a=h.y)}return i.x=s,i.y=a,i.width=n-s,i.height=r-a,i},z2}(),t.Interpolate=function(){if(X2)return Y2;X2=1;var t=$h();return Y2=function(e,i,n,s){return void 0===n&&(n=0),void 0===s&&(s=new t),s.x=e.x+(i.x-e.x)*n,s.y=e.y+(i.y-e.y)*n,s}}(),t.Invert=(W2||(W2=1,G2=function(t){return t.setTo(t.y,t.x)}),G2),t.Negative=function(){if(V2)return H2;V2=1;var t=$h();return H2=function(e,i){return void 0===i&&(i=new t),i.setTo(-e.x,-e.y)},H2}(),t.Project=function(){if(q2)return j2;q2=1;var t=$h(),e=t7();return j2=function(i,n,s){void 0===s&&(s=new t);var r=(i.x*n.x+i.y*n.y)/e(n);return 0!==r&&(s.x=r*n.x,s.y=r*n.y),s}}(),t.ProjectUnit=function(){if(Z2)return K2;Z2=1;var t=$h();return K2=function(e,i,n){void 0===n&&(n=new t);var s=e.x*i.x+e.y*i.y;return 0!==s&&(n.x=s*i.x,n.y=s*i.y),n}}(),t.SetMagnitude=function(){if($2)return J2;$2=1;var t=Q8();return J2=function(e,i){if(0!==e.x||0!==e.y){var n=t(e);e.x/=n,e.y/=n}return e.x*=i,e.y*=i,e},J2}(),Q2=t}function i7(){if(u3)return l3;function t(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}function e(t,e,i){var n=e.x,s=e.y,r=i.x-n,a=i.y-s;if(0!==r||0!==a){var o=((t.x-n)*r+(t.y-s)*a)/(r*r+a*a);o>1?(n=i.x,s=i.y):o>0&&(n+=r*o,s+=a*o)}return(r=t.x-n)*r+(a=t.y-s)*a}function i(t,n,s,r,a){for(var o,h=r,l=n+1;l<s;l++){var u=e(t[l],t[n],t[s]);u>h&&(o=l,h=u)}h>r&&(o-n>1&&i(t,n,o,r,a),a.push(t[o]),s-o>1&&i(t,o,s,r,a))}function n(t,e){var n=t.length-1,s=[t[0]];return i(t,0,n,e,s),s.push(t[n]),s}u3=1;return l3=function(e,i,s){void 0===i&&(i=1),void 0===s&&(s=!1);var r=e.points;if(r.length>2){var a=i*i;s||(r=function(e,i){for(var n,s=e[0],r=[s],a=1,o=e.length;a<o;a++)t(n=e[a],s)>i&&(r.push(n),s=n);return s!==n&&r.push(n),r}(r,a)),e.setTo(n(r,a))}return e},l3}function n7(){if(p3)return f3;p3=1;var t=uK();return t.Clone=function(){if(i3)return e3;i3=1;var t=uK();return e3=function(e){return new t(e.points)},e3}(),t.Contains=oK(),t.ContainsPoint=function(){if(s3)return n3;s3=1;var t=oK();return n3=function(e,i){return t(e,i.x,i.y)},n3}(),t.Earcut=lH(),t.GetAABB=aK(),t.GetNumberArray=(a3||(a3=1,r3=function(t,e){void 0===e&&(e=[]);for(var i=0;i<t.points.length;i++)e.push(t.points[i].x),e.push(t.points[i].y);return e}),r3),t.GetPoints=lK(),t.Perimeter=hK(),t.Reverse=(h3||(h3=1,o3=function(t){return t.points.reverse(),t}),o3),t.Simplify=i7(),t.Smooth=cK(),t.Translate=(d3||(d3=1,c3=function(t,e,i){for(var n=t.points,s=0;s<n.length;s++)n[s].x+=e,n[s].y+=i;return t}),c3),f3=t}function s7(){if(C3)return _3;C3=1;return _3=function(t,e){return!(e.width*e.height>t.width*t.height)&&(e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom)}}function r7(){if(R3)return M3;R3=1;return M3=function(t){return 0===t.height?NaN:t.width/t.height}}function a7(){if(d5)return c5;d5=1;var t=Ju();return t.Area=v3?g3:(v3=1,g3=function(t){return t.width*t.height}),t.Ceil=y3?m3:(y3=1,m3=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}),t.CeilAll=w3?x3:(w3=1,x3=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}),t.CenterOn=kX(),t.Clone=function(){if(T3)return b3;T3=1;var t=Ju();return b3=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=zu(),t.ContainsPoint=function(){if(E3)return S3;E3=1;var t=zu();return S3=function(e,i){return t(e,i.x,i.y)},S3}(),t.ContainsRect=s7(),t.CopyFrom=dq(),t.Decompose=L8(),t.Equals=P3?A3:(P3=1,A3=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),t.FitInside=function(){if(O3)return L3;O3=1;var t=r7();return L3=function(e,i){var n=t(e);return n<t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)},L3}(),t.FitOutside=function(){if(D3)return F3;D3=1;var t=r7();return F3=function(e,i){var n=t(e);return n>t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)},F3}(),t.Floor=k3?I3:(k3=1,I3=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}),t.FloorAll=N3?B3:(N3=1,B3=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}),t.FromPoints=WH(),t.FromXY=function(){if(U3)return z3;U3=1;var t=Ju();return z3=function(e,i,n,s,r){return void 0===r&&(r=new t),r.setTo(Math.min(e,n),Math.min(i,s),Math.abs(e-n),Math.abs(i-s))}}(),t.GetAspectRatio=r7(),t.GetCenter=function(){if(X3)return Y3;X3=1;var t=$h();return Y3=function(e,i){return void 0===i&&(i=new t),i.x=e.centerX,i.y=e.centerY,i}}(),t.GetPoint=Yu(),t.GetPoints=Xu(),t.GetSize=function(){if(W3)return G3;W3=1;var t=$h();return G3=function(e,i){return void 0===i&&(i=new t),i.x=e.width,i.y=e.height,i}}(),t.Inflate=mq(),t.Intersection=function(){if(V3)return H3;V3=1;var t=Ju(),e=bq();return H3=function(i,n,s){return void 0===s&&(s=new t),e(i,n)?(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y):s.setEmpty(),s}}(),t.MarchingAnts=vY(),t.MergePoints=(q3||(q3=1,j3=function(t,e){for(var i=t.x,n=t.right,s=t.y,r=t.bottom,a=0;a<e.length;a++)i=Math.min(i,e[a].x),n=Math.max(n,e[a].x),s=Math.min(s,e[a].y),r=Math.max(r,e[a].y);return t.x=i,t.y=s,t.width=n-i,t.height=r-s,t}),j3),t.MergeRect=yq(),t.MergeXY=(Z3||(Z3=1,K3=function(t,e,i){var n=Math.min(t.x,e),s=Math.max(t.right,e);t.x=n,t.width=s-n;var r=Math.min(t.y,i),a=Math.max(t.bottom,i);return t.y=r,t.height=a-r,t}),K3),t.Offset=$3?J3:($3=1,J3=function(t,e,i){return t.x+=e,t.y+=i,t}),t.OffsetPoint=(t5||(t5=1,Q3=function(t,e){return t.x+=e.x,t.y+=e.y,t}),Q3),t.Overlaps=i5?e5:(i5=1,e5=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}),t.Perimeter=Uu(),t.PerimeterPoint=function(){if(s5)return n5;s5=1;var t=$h(),e=ac();return n5=function(i,n,s){void 0===s&&(s=new t),n=e(n);var r=Math.sin(n),a=Math.cos(n),o=a>0?i.width/2:i.width/-2,h=r>0?i.height/2:i.height/-2;return Math.abs(o*r)<Math.abs(h*a)?h=o*r/a:o=h*a/r,s.x=o+i.centerX,s.y=h+i.centerY,s},n5}(),t.Random=Zu(),t.RandomOutside=function(){if(a5)return r5;a5=1;var t=vX(),e=s7(),i=$h();return r5=function(n,s,r){if(void 0===r&&(r=new i),e(n,s))switch(t(0,3)){case 0:r.x=n.x+Math.random()*(s.right-n.x),r.y=n.y+Math.random()*(s.top-n.y);break;case 1:r.x=s.x+Math.random()*(n.right-s.x),r.y=s.bottom+Math.random()*(n.bottom-s.bottom);break;case 2:r.x=n.x+Math.random()*(s.x-n.x),r.y=s.y+Math.random()*(n.bottom-s.y);break;case 3:r.x=s.right+Math.random()*(n.right-s.right),r.y=n.y+Math.random()*(s.bottom-n.y)}return r}}(),t.SameDimensions=h5?o5:(h5=1,o5=function(t,e){return t.width===e.width&&t.height===e.height}),t.Scale=u5?l5:(u5=1,l5=function(t,e,i){return void 0===i&&(i=e),t.width*=e,t.height*=i,t}),t.Union=Lj(),c5=t}function o7(){if(T5)return b5;T5=1;var t=$h();return b5=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2+e.x3)/3,i.y=(e.y1+e.y2+e.y3)/3,i},b5}function h7(){if(E5)return S5;E5=1;return S5=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t.x3+=e,t.y3+=i,t},S5}function l7(){if(U5)return z5;U5=1;var t=$h();function e(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}return z5=function(i,n){void 0===n&&(n=new t);var s=i.x1,r=i.y1,a=i.x2,o=i.y2,h=i.x3,l=i.y3,u=e(h,l,a,o),c=e(s,r,h,l),d=e(a,o,s,r),f=u+c+d;return n.x=(s*u+a*c+h*d)/f,n.y=(r*u+o*c+l*d)/f,n},z5}function u7(){if(W5)return G5;W5=1;return G5=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,a=t.x3-e,o=t.y3-i,t.x3=a*s-o*r+e,t.y3=a*r+o*s+i,t},G5}function c7(){if(Z5)return K5;Z5=1;var t=wK();return t.Area=(p5||(p5=1,f5=function(t){var e=t.x1,i=t.y1,n=t.x2,s=t.y2,r=t.x3,a=t.y3;return Math.abs(((r-e)*(s-i)-(n-e)*(a-i))/2)}),f5),t.BuildEquilateral=function(){if(v5)return g5;v5=1;var t=wK();return g5=function(e,i,n){var s=n*(Math.sqrt(3)/2);return new t(e,i,e+n/2,i+s,e-n/2,i+s)}}(),t.BuildFromPolygon=function(){if(y5)return m5;y5=1;var t=lH(),e=wK();return m5=function(i,n,s,r,a){void 0===n&&(n=null),void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=[]);for(var o,h,l,u,c,d,f,p,g,v=t(i,n),m=0;m<v.length;m+=3)o=v[m],h=v[m+1],l=v[m+2],u=i[2*o]*s,c=i[2*o+1]*r,d=i[2*h]*s,f=i[2*h+1]*r,p=i[2*l]*s,g=i[2*l+1]*r,a.push(new e(u,c,d,f,p,g));return a},m5}(),t.BuildRight=function(){if(w5)return x5;w5=1;var t=wK();return x5=function(e,i,n,s){return void 0===s&&(s=n),new t(e,i,e,i-s,e+n,i)}}(),t.CenterOn=function(){if(C5)return _5;C5=1;var t=o7(),e=h7();return _5=function(i,n,s,r){void 0===r&&(r=t);var a=r(i),o=n-a.x,h=s-a.y;return e(i,o,h)},_5}(),t.Centroid=o7(),t.CircumCenter=function(){if(P5)return A5;P5=1;var t=qu();function e(t,e,i,n){return t*n-e*i}return A5=function(i,n){void 0===n&&(n=new t);var s=i.x3,r=i.y3,a=i.x1-s,o=i.y1-r,h=i.x2-s,l=i.y2-r,u=2*e(a,o,h,l),c=e(o,a*a+o*o,l,h*h+l*l),d=e(a,a*a+o*o,h,h*h+l*l);return n.x=s-c/u,n.y=r+d/u,n},A5}(),t.CircumCircle=function(){if(R5)return M5;R5=1;var t=ol();return M5=function(e,i){void 0===i&&(i=new t);var n,s,r=e.x1,a=e.y1,o=e.x2,h=e.y2,l=e.x3,u=e.y3,c=o-r,d=h-a,f=l-r,p=u-a,g=c*(r+o)+d*(a+h),v=f*(r+l)+p*(a+u),m=2*(c*(u-h)-d*(l-o));if(Math.abs(m)<1e-6){var y=Math.min(r,o,l),x=Math.min(a,h,u);n=.5*(Math.max(r,o,l)-y),s=.5*(Math.max(a,h,u)-x),i.x=y+n,i.y=x+s,i.radius=Math.sqrt(n*n+s*s)}else i.x=(p*g-d*v)/m,i.y=(c*v-f*g)/m,n=i.x-r,s=i.y-a,i.radius=Math.sqrt(n*n+s*s);return i},M5}(),t.Clone=function(){if(O5)return L5;O5=1;var t=wK();return L5=function(e){return new t(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3)}}(),t.Contains=mK(),t.ContainsArray=R8(),t.ContainsPoint=function(){if(D5)return F5;D5=1;var t=mK();return F5=function(e,i){return t(e,i.x,i.y)},F5}(),t.CopyFrom=k5?I5:(k5=1,I5=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}),t.Decompose=N8(),t.Equals=(N5||(N5=1,B5=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}),B5),t.GetPoint=yK(),t.GetPoints=xK(),t.InCenter=l7(),t.Perimeter=function(){if(X5)return Y5;X5=1;var t=Wu();return Y5=function(e){var i=e.getLineA(),n=e.getLineB(),s=e.getLineC();return t(i)+t(n)+t(s)},Y5}(),t.Offset=h7(),t.Random=AY(),t.Rotate=function(){if(V5)return H5;V5=1;var t=u7(),e=l7();return H5=function(i,n){var s=e(i);return t(i,s.x,s.y,n)},H5}(),t.RotateAroundPoint=function(){if(q5)return j5;q5=1;var t=u7();return j5=function(e,i,n){return t(e,i.x,i.y,n)},j5}(),t.RotateAroundXY=u7(),K5=t}function d7(){if($5)return J5;$5=1;var t=Jh(),e=nh(),i={Circle:p8(),Ellipse:g8(),Intersects:W8(),Line:q8(),Mesh:$8(),Point:e7(),Polygon:n7(),Rectangle:a7(),Triangle:c7()};return i=e(!1,i,t),J5=i}function f7(){if(t4)return Q5;t4=1;return Q5=function(t,e){return function(i,n,s,r){var a=t.getPixelAlpha(n,s,r.texture.key,r.frame.name);return a&&a>=e}}}function p7(){if(i4)return e4;i4=1;return e4=function(t,e,i){return{gameObject:t,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:i,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}}}function g7(){if(s4)return n4;s4=1;var t=new(Kh())({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});return n4=t}function v7(){return y4?m4:(y4=1,m4={BUTTON_DOWN:a4?r4:(a4=1,r4="down"),BUTTON_UP:h4?o4:(h4=1,o4="up"),CONNECTED:u4?l4:(u4=1,l4="connected"),DISCONNECTED:d4?c4:(d4=1,c4="disconnected"),GAMEPAD_BUTTON_DOWN:p4?f4:(p4=1,f4="down"),GAMEPAD_BUTTON_UP:v4?g4:(v4=1,g4="up")})}function m7(){if(w4)return x4;w4=1;var t=Kh(),e=v7(),i=new t({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var i=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(e.BUTTON_DOWN,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(e.BUTTON_UP,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});return x4=i}function y7(){if(T4)return b4;T4=1;var t=g7(),e=m7(),i=Kh(),n=cU(),s=qu(),r=new i({Extends:n,initialize:function(i,r){n.call(this),this.manager=i,this.pad=r,this.id=r.id,this.index=r.index;for(var a=[],o=0;o<r.buttons.length;o++)a.push(new e(this,o));this.buttons=a;var h=[];for(o=0;o<r.axes.length;o++)h.push(new t(this,o));this.axes=h,this.vibration=r.vibrationActuator;var l={value:0,pressed:!1};this._LCLeft=a[14]?a[14]:l,this._LCRight=a[15]?a[15]:l,this._LCTop=a[12]?a[12]:l,this._LCBottom=a[13]?a[13]:l,this._RCLeft=a[2]?a[2]:l,this._RCRight=a[1]?a[1]:l,this._RCTop=a[3]?a[3]:l,this._RCBottom=a[0]?a[0]:l,this._FBLeftTop=a[4]?a[4]:l,this._FBLeftBottom=a[6]?a[6]:l,this._FBRightTop=a[5]?a[5]:l,this._FBRightBottom=a[7]?a[7]:l;var u={value:0};this._HAxisLeft=h[0]?h[0]:u,this._VAxisLeft=h[1]?h[1]:u,this._HAxisRight=h[2]?h[2]:u,this._VAxisRight=h[3]?h[3]:u,this.leftStick=new s,this.rightStick=new s,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){if(!(t.timestamp<this._created)){var e,i=this.buttons,n=t.buttons,s=i.length;for(e=0;e<s;e++)i[e].update(n[e].value);var r=this.axes,a=t.axes;for(s=r.length,e=0;e<s;e++)r[e].update(a[e]);s>=2&&(this.leftStick.set(r[0].getValue(),r[1].getValue()),s>=4&&this.rightStick.set(r[2].getValue(),r[3].getValue()))}},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});return b4=r}function x7(){if(E4)return S4;E4=1;var t=Vl(),e={},i={register:function(t,i,n,s,r){e[t]={plugin:i,mapping:n,settingsKey:s,configKey:r}},getPlugin:function(t){return e[t]},install:function(i){var n=i.scene.sys,s=n.settings.input,r=n.game.config;for(var a in e){var o=e[a].plugin,h=e[a].mapping,l=e[a].settingsKey,u=e[a].configKey;t(s,l,r[u])&&(i[h]=new o(i))}},remove:function(t){e.hasOwnProperty(t)&&delete e[t]}};return S4=i}function w7(){if(C4)return _4;C4=1;var t=Kh(),e=cU(),i=v7(),n=y7(),s=Vl(),r=x7(),a=CV(),o=new t({Extends:e,initialize:function(t){e.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,t.pluginEvents.once(a.BOOT,this.boot,this),t.pluginEvents.on(a.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,i=t.config;this.enabled=s(e,"gamepad",i.inputGamepad)&&t.device.input.gamepads,this.target=s(e,"gamepad.target",i.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(a.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(a.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,i=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=i,e.addEventListener("gamepadconnected",i,!1),e.addEventListener("gamepaddisconnected",i,!1),this.sceneInputPlugin.pluginEvents.on(a.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(a.UPDATE,this.update);for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].removeAllListeners()},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].pad.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,i=0;i<t.length;i++){var s=t[i];if(s){var r=s.id,a=s.index,o=e[a];if(o)o.id!==r?(o.destroy(),e[a]=new n(this,s)):o.update(s);else{var h=new n(this,s);e[a]=h,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=h):this._pad3=h:this._pad2=h:this._pad1=h}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,i=0;i<e.length;i++)e[i]&&t.push(e[i]);return t},getPad:function(t){for(var e=this.gamepads,i=0;i<e.length;i++)if(e[i]&&e[i].index===t)return e[i]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var s=e[n],r=this.getPad(s.gamepad.index);"gamepadconnected"===s.type?this.emit(i.CONNECTED,r,s):"gamepaddisconnected"===s.type&&this.emit(i.DISCONNECTED,r,s)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});return r.register("GamepadPlugin",o,"gamepad","gamepad","inputGamepad"),_4=o}function b7(){if(N4)return B4;N4=1;var t=ol(),e=Zh(),i=Kh(),n=_V(),s=p7(),r=f7(),a=LY(),o=jj(),h=Xj(),l=CV(),u=cU(),c=jh(),d=Jh(),f=x7(),p=ih(),g=tc(),v=Ju(),m=zu(),y=ec(),x=wK(),w=mK(),b=new i({Extends:u,initialize:function(t){u.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new u,this.enabled=!0,this.displayList,this.cameras,f.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(y.BOOT,this.boot,this),t.sys.events.on(y.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(y.DESTROY,this.destroy,this),this.pluginEvents.emit(l.BOOT)},start:function(){var t=this.systems.events;t.on(y.TRANSITION_START,this.transitionIn,this),t.on(y.TRANSITION_OUT,this.transitionOut,this),t.on(y.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(y.PRE_UPDATE,this.preUpdate,this),t.once(y.SHUTDOWN,this.shutdown,this),this.manager.events.on(l.GAME_OUT,this.onGameOut,this),this.manager.events.on(l.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(l.START)},onGameOver:function(t){this.isActive()&&this.emit(l.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(l.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(l.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,i=t.length,n=e.length;if(0!==i||0!==n){for(var s=this._list,r=0;r<i;r++){var a=t[r],o=s.indexOf(a);o>-1&&(s.splice(o,1),this.clear(a,!0))}this._pendingRemoval.length=0,this._list=s.concat(e.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(t){this.manager&&this.manager.setCursor(t)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(l.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var i,n=this.manager.pointers;for(i=0;i<n.length;i++)n[i].updateMotion();if(0===this._list.length)return!1;var s=this.pollRate;if(-1===s)return!1;if(s>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var r=!1;for(i=0;i<n.length;i++){var a=0,o=n[i];this._tempZones=[],this._temp=this.hitTestPointer(o),this.sortGameObjects(this._temp,o),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),a+=this.processOverOutEvents(o),2===this.getDragState(o)&&this.processDragThresholdEvent(o,t),a>0&&(r=!0)}return r},update:function(t,e){if(!this.isActive())return!1;for(var i=!1,s=0;s<e.length;s++){var r=0,a=e[s];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp,a),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case n.MOUSE_DOWN:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_UP:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOverOutEvents(a);break;case n.TOUCH_START:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverEvents(a);break;case n.TOUCH_END:case n.TOUCH_CANCEL:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOutEvents(a);break;case n.MOUSE_MOVE:case n.TOUCH_MOVE:r+=this.processDragMoveEvent(a),r+=this.processMoveEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_WHEEL:r+=this.processWheelEvent(a)}r>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1),this.disable(t);var i=t.input;i&&(this.removeDebug(t),this.manager.resetCursor(i),i.gameObject=void 0,i.target=void 0,i.hitArea=void 0,i.hitAreaCallback=void 0,i.callbackContext=void 0,t.input=null),e||this.queueForRemoval(t);var n=this._draggable.indexOf(t);return n>-1&&this._draggable.splice(n,1),t},disable:function(t,e){void 0===e&&(e=!1);var i=t.input;i&&(i.enabled=!1,i.dragState=0);for(var n,s=this._drag,r=this._over,a=this.manager,o=0;o<a.pointers.length;o++)(n=s[o].indexOf(t))>-1&&s[o].splice(n,1),(n=r[o].indexOf(t))>-1&&r[o].splice(n,1);return e&&this.resetCursor(),this},enable:function(t,e,i,n){return void 0===n&&(n=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,i),t.input&&n&&!t.input.dropZone&&(t.input.dropZone=n),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),i=0;i<e.length;i++){for(var n=e[i],s=this.manager.hitTest(t,this._list,n),r=0;r<s.length;r++){var a=s[r];a.input.dropZone&&this._tempZones.push(a)}if(s.length>0)return t.camera=n,s}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled&&(this.emit(l.GAMEOBJECT_DOWN,t,a,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&(t.downElement===this.manager.game.canvas?this.emit(l.POINTER_DOWN,t,i):this.emit(l.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var i=!1,n=this.dragTimeThreshold,s=this.dragDistanceThreshold;if((s>0&&a(t.x,t.y,t.downX,t.downY)>=s||n>0&&e>=t.downTime+n)&&(i=!0),i)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;s.dragState=2,s.dragStartX=n.x,s.dragStartY=n.y,s.dragStartXGlobal=t.worldX,s.dragStartYGlobal=t.worldY,s.dragStartCamera=t.camera,s.dragX=s.dragStartXGlobal-s.dragStartX,s.dragY=s.dragStartYGlobal-s.dragStartY,n.emit(l.GAMEOBJECT_DRAG_START,t,s.dragX,s.dragY),this.emit(l.DRAG_START,t,n)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var i=[],n=0;n<e.length;n++){var s=e[n];s.input.draggable&&0===s.input.dragState&&i.push(s)}return 0===i.length?(this.setDragState(t,0),0):(i.length>1&&(this.sortGameObjects(i,t),this.topOnly&&i.splice(1)),this._drag[t.id]=i,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(2===this.getDragState(t)&&this.processDragThresholdEvent(t,this.manager.game.loop.now),4!==this.getDragState(t))return 0;var e=this._tempZones,i=this._drag[t.id];i.length>1&&(i=i.slice(0));for(var n=0;n<i.length;n++){var s,r,a=i[n],o=a.input,h=o.target;if(h){var u=e.indexOf(h);0===u?(a.emit(l.GAMEOBJECT_DRAG_OVER,t,h),this.emit(l.DRAG_OVER,t,a,h)):u>0?(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),e[0]?(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):o.target=null)}else!h&&e[0]&&(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h));var c=t.positionToCamera(o.dragStartCamera);if(a.parentContainer){var d=c.x-o.dragStartXGlobal,f=c.y-o.dragStartYGlobal,p=a.getParentRotation(),g=d*Math.cos(p)+f*Math.sin(p),v=f*Math.cos(p)-d*Math.sin(p);g*=1/a.parentContainer.scaleX,v*=1/a.parentContainer.scaleY,s=g+o.dragStartX,r=v+o.dragStartY}else s=c.x-o.dragX,r=c.y-o.dragY;a.emit(l.GAMEOBJECT_DRAG,t,s,r),this.emit(l.DRAG,t,a,s,r)}return i.length},processDragUpEvent:function(t){var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;if(s&&2===s.dragState){s.dragState=0,s.dragX=s.localX-n.displayOriginX,s.dragY=s.localY-n.displayOriginY,s.dragStartCamera=null;var r=!1,a=s.target;a&&(n.emit(l.GAMEOBJECT_DROP,t,a),this.emit(l.DROP,t,n,a),s.target=null,r=!0),n.input&&n.input.enabled&&(n.emit(l.GAMEOBJECT_DRAG_END,t,s.dragX,s.dragY,r),this.emit(l.DRAG_END,t,n,r))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled){if(this.emit(l.GAMEOBJECT_MOVE,t,a,s),n.cancelled||!this.isActive())break;if(this.topOnly)break}}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_MOVE,t,i),e},processWheelEvent:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=t.deltaX,a=t.deltaY,o=t.deltaZ,h=0;h<i.length;h++){var u=i[h];if(u.input&&u.input.enabled){if(e++,u.emit(l.GAMEOBJECT_POINTER_WHEEL,t,r,a,o,s),n.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_WHEEL,t,u,r,a,o,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_WHEEL,t,i,r,a,o),e},processOverEvents:function(t){var e=this._temp,i=0,n=e.length,s=[];if(n>0){var r=this.manager,a=this._eventData,o=this._eventContainer;a.cancelled=!1;for(var h=0;h<n;h++){var u=e[h];if(u.input&&u.input.enabled){if(s.push(u),r.setCursor(u.input),u.emit(l.GAMEOBJECT_POINTER_OVER,t,u.input.localX,u.input.localY,o),i++,a.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,u,o),a.cancelled||!this.isActive()))break}}!a.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,s)}return this._over[t.id]=s,i},processOutEvents:function(t){var e=this._over[t.id],i=0,n=e.length;if(n>0){var s=this.manager,r=this._eventData,a=this._eventContainer;r.cancelled=!1,this.sortGameObjects(e,t);for(var o=0;o<n;o++){var h=e[o];if((h=e[o]).input&&h.input.enabled){if(s.resetCursor(h.input),h.emit(l.GAMEOBJECT_POINTER_OUT,t,a),i++,r.cancelled||!this.isActive())break;if(h.input&&h.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,h,a),r.cancelled||!this.isActive()))break}}!r.cancelled&&this.isActive()&&this.emit(l.POINTER_OUT,t,e),this._over[t.id]=[]}return i},processOverOutEvents:function(t){var e,i,n=this._temp,s=[],r=[],a=[],o=this._over[t.id],h=this._drag[t.id],u=this.manager;for(e=0;e<o.length;e++)i=o[e],-1===n.indexOf(i)&&-1===h.indexOf(i)?s.push(i):a.push(i);for(e=0;e<n.length;e++)i=n[e],-1===o.indexOf(i)&&r.push(i);var c=s.length,d=0,f=this._eventData,p=this._eventContainer;if(f.cancelled=!1,c>0){for(this.sortGameObjects(s,t),e=0;e<c;e++)if((i=s[e]).input&&i.input.enabled){if(u.resetCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OUT,t,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,i,p),f.cancelled||!this.isActive()))break}f.cancelled&&!this.isActive()||this.emit(l.POINTER_OUT,t,s)}if(c=r.length,f.cancelled=!1,c>0){for(this.sortGameObjects(r,t),e=0;e<c;e++)if((i=r[e]).input&&i.input.enabled){if(u.setCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OVER,t,i.input.localX,i.input.localY,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,i,p),f.cancelled||!this.isActive()))break}!f.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,r)}return o=a.concat(r),this._over[t.id]=this.sortGameObjects(o,t),d},processUpEvents:function(t){var e=this._temp,i=this._eventData,n=this._eventContainer;i.cancelled=!1;for(var s=0;s<e.length;s++){var r=e[s];if(r.input&&r.input.enabled){if(r.emit(l.GAMEOBJECT_POINTER_UP,t,r.input.localX,r.input.localY,n),i.cancelled||!this.isActive())break;if(r.input&&r.input.enabled&&(this.emit(l.GAMEOBJECT_UP,t,r,n),i.cancelled||!this.isActive()))break}}return!i.cancelled&&this.isActive()&&(t.upElement===this.manager.game.canvas?this.emit(l.POINTER_UP,t,e):this.emit(l.POINTER_UP_OUTSIDE,t)),e.length},forceDownState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_DOWN,l.GAMEOBJECT_DOWN,!1)},forceUpState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_UP,l.GAMEOBJECT_UP,!1)},forceOverState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OVER,l.GAMEOBJECT_OVER,!0)},forceOutState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OUT,l.GAMEOBJECT_OUT,!1)},forceState:function(t,e,i,n,s){var r=this._eventData,a=this._eventContainer;r.cancelled=!1,e.input&&e.input.enabled&&(e.emit(i,t,e.input.localX,e.input.localY,a),s&&this.setCursor(e.input),!r.cancelled&&this.isActive()&&e.input&&e.input.enabled&&this.emit(n,t,e,a))},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];n.input.draggable=e;var s=this._draggable.indexOf(n);e&&-1===s?this._draggable.push(n):!e&&s>-1&&this._draggable.splice(s,1)}return this},makePixelPerfect:function(t){void 0===t&&(t=1);var e=this.systems.textures;return r(e,t)},setHitArea:function(t,e,i){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var n=!1,r=!1,a=!1,o=!1,h=!1,l=!0;if(p(e)&&Object.keys(e).length){var u=e,d=t.some(function(t){return t.hasOwnProperty("faces")});if(!d){e=c(u,"hitArea",null),i=c(u,"hitAreaCallback",null),h=c(u,"pixelPerfect",!1);var f=c(u,"alphaTolerance",1);h&&(e={},i=this.makePixelPerfect(f))}n=c(u,"draggable",!1),r=c(u,"dropZone",!1),a=c(u,"cursor",!1),o=c(u,"useHandCursor",!1),e&&i||(this.setHitAreaFromTexture(t),l=!1)}else"function"!=typeof e||i||(i=e,e={});for(var g=0;g<t.length;g++){var v=t[g];if(h&&"Container"===v.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var m=v.input?v.input:s(v,e,i);m.customHitArea=l,m.dropZone=r,m.cursor=o?"pointer":a,v.input=m,n&&this.setDraggable(v),this.queueForInsertion(v)}}return this},setHitAreaCircle:function(i,n,s,r,a){void 0===a&&(a=e);var o=new t(n,s,r);return this.setHitArea(i,o,a)},setHitAreaEllipse:function(t,e,i,n,s,r){void 0===r&&(r=h);var a=new o(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=m),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i],r=n.frame,a=0,o=0;n.width?(a=n.width,o=n.height):r&&(a=r.realWidth,o=r.realHeight),"Container"!==n.type||0!==a&&0!==o?0!==a&&0!==o&&(n.input=s(n,new v(0,0,a,o),e),this.queueForInsertion(n)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,i,n,s,r){void 0===r&&(r=m);var a=new v(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaTriangle:function(t,e,i,n,s,r,a,o){void 0===o&&(o=w);var h=new x(e,i,n,s,r,a);return this.setHitArea(t,h,o)},enableDebug:function(t,e){void 0===e&&(e=65280);var i=t.input;if(!i||!i.hitArea)return this;var n=i.hitArea,s=n.type,r=i.hitAreaDebug,a=this.systems.add,o=this.systems.updateList;r&&(o.remove(r),r.destroy(),r=null);var h=0,l=0;switch(s){case d.CIRCLE:r=a.arc(0,0,n.radius),h=n.x-n.radius,l=n.y-n.radius;break;case d.ELLIPSE:r=a.ellipse(0,0,n.width,n.height),h=n.x-n.width/2,l=n.y-n.height/2;break;case d.LINE:r=a.line(0,0,n.x1,n.y1,n.x2,n.y2);break;case d.POLYGON:r=a.polygon(0,0,n.points);break;case d.RECTANGLE:r=a.rectangle(0,0,n.width,n.height),h=n.x,l=n.y;break;case d.TRIANGLE:r=a.triangle(0,0,n.x1,n.y1,n.x2,n.y2,n.x3,n.y3)}return r&&(r.isFilled=!1,r.strokeColor=e,r.preUpdate=function(){r.setVisible(t.visible),r.setStrokeStyle(1/t.scale,r.strokeColor),r.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var e=t.x,i=t.y,n=t.rotation,s=t.scaleX,a=t.scaleY;if(t.parentContainer){var o=t.getWorldTransformMatrix();e=o.tx,i=o.ty,n=o.rotation,s=o.scaleX,a=o.scaleY}r.setRotation(n),r.setScale(s,a),r.setPosition(e+h*s,i+l*a),r.setScrollFactor(t.scrollFactorX,t.scrollFactorY),r.setDepth(t.depth)},o.add(r),i.hitAreaDebug=r),this},removeDebug:function(t){var e=t.input;e&&e.hitAreaDebug&&(e.hitAreaDebug.destroy(),e.hitAreaDebug=null);return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2||!e.camera)return t;var i=e.camera.renderList;return t.sort(function(t,e){var n=Math.max(i.indexOf(t),0);return Math.max(i.indexOf(e),0)-n})},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(t.parentContainer||e.parentContainer){if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var i=t.getIndexList(),n=e.getIndexList(),s=Math.min(i.length,n.length),r=0;r<s;r++){var a=i[r],o=n[r];if(a!==o)return o-a}return n.length-i.length}return this.displayList.getIndex(e)-this.displayList.getIndex(t)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(l.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var i=this.systems.events;i.off(y.TRANSITION_START,this.transitionIn,this),i.off(y.TRANSITION_OUT,this.transitionOut,this),i.off(y.TRANSITION_COMPLETE,this.transitionComplete,this),i.off(y.PRE_UPDATE,this.preUpdate,this),e.events.off(l.GAME_OUT,this.onGameOut,this),e.events.off(l.GAME_OVER,this.onGameOver,this),i.off(y.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var t=this.manager.pointers,e=0;e<t.length;e++)t[e].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(l.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(y.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});return g.register("InputPlugin",b,"input"),B4=b}function T7(){return t6?Q4:(t6=1,Q4={ANY_KEY_DOWN:U4?z4:(U4=1,z4="keydown"),ANY_KEY_UP:X4?Y4:(X4=1,Y4="keyup"),COMBO_MATCH:W4?G4:(W4=1,G4="keycombomatch"),DOWN:V4?H4:(V4=1,H4="down"),KEY_DOWN:q4?j4:(q4=1,j4="keydown-"),KEY_UP:Z4?K4:(Z4=1,K4="keyup-"),UP:$4?J4:($4=1,J4="up")})}function S7(){if(i6)return e6;i6=1;var t=Kh(),e=cU(),i=T7(),n=new t({Extends:e,initialize:function(t,i){e.call(this),this.plugin=t,this.keyCode=i,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(i.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(i.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(i.UP,this,t))},reset:function(){return this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});return e6=n}function E7(){if(s6)return n6;s6=1;return n6=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)}}function _7(){if(a6)return r6;a6=1;var t=E7();return r6=function(e,i){if(i.matched)return!0;var n=!1,s=!1;if(e.keyCode===i.current)if(i.index>0&&i.maxKeyDelay>0){var r=i.timeLastMatched+i.maxKeyDelay;e.timeStamp<=r&&(s=!0,n=t(e,i))}else s=!0,n=t(e,i);return!s&&i.resetOnWrongKey&&(i.index=0,i.current=i.keyCodes[0]),n&&(i.timeLastMatched=e.timeStamp,i.matched=!0,i.timeMatched=e.timeStamp),n}}function C7(){if(h6)return o6;h6=1;return o6=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t}}function A7(){if(u6)return l6;u6=1;var t=Kh(),e=T7(),i=jh(),n=_7(),s=C7(),r=new t({initialize:function(t,r,a){if(void 0===a&&(a={}),r.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var o=0;o<r.length;o++){var h=r[o];"string"==typeof h?this.keyCodes.push(h.toUpperCase().charCodeAt(0)):"number"==typeof h?this.keyCodes.push(h):h.hasOwnProperty("keyCode")&&this.keyCodes.push(h.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=i(a,"resetOnWrongKey",!0),this.maxKeyDelay=i(a,"maxKeyDelay",0),this.resetOnMatch=i(a,"resetOnMatch",!1),this.deleteOnMatch=i(a,"deleteOnMatch",!1);var l=this;this.onKeyDown=function(t){!l.matched&&l.enabled&&(n(t,l)&&(l.manager.emit(e.COMBO_MATCH,l,t),l.resetOnMatch?s(l):l.deleteOnMatch&&l.destroy()))},this.manager.on(e.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(e.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});return l6=r}function P7(){if(p6)return f6;p6=1;var t=Kh(),e=cU(),i=T7(),n=pX(),s=Vl(),r=CV(),a=x7(),o=S7(),h=AV(),l=A7(),u=function(){if(d6)return c6;d6=1;var t=AV(),e={};for(var i in t)e[t[i]]=i;return c6=e}(),c=ec(),d=FG(),f=new t({Extends:e,initialize:function(t){e.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,t.pluginEvents.once(r.BOOT,this.boot,this),t.pluginEvents.on(r.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=s(t,"keyboard",!0);var e=s(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(r.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(r.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(r.SHUTDOWN,this.shutdown,this),this.game.events.on(n.BLUR,this.resetKeys,this),this.scene.sys.events.on(c.PAUSE,this.resetKeys,this),this.scene.sys.events.on(c.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.canInput()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:h.UP,down:h.DOWN,left:h.LEFT,right:h.RIGHT,space:h.SPACE,shift:h.SHIFT})},addKeys:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n={};if("string"==typeof t){t=t.split(",");for(var s=0;s<t.length;s++){var r=t[s].trim();r&&(n[r]=this.addKey(r,e,i))}}else for(var a in t)n[a]=this.addKey(t[a],e,i);return n},addKey:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n=this.keys;if(t instanceof o){var s=n.indexOf(t);return s>-1?n[s]=t:n[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(i),t}return"string"==typeof t&&(t=h[t.toUpperCase()]),n[t]||(n[t]=new o(this,t),e&&this.addCapture(t),n[t].setEmitOnRepeat(i)),n[t]},removeKey:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n,s=this.keys;if(t instanceof o){var r=s.indexOf(t);r>-1&&(n=this.keys[r],this.keys[r]=void 0)}else"string"==typeof t&&(t=h[t.toUpperCase()]);return s[t]&&(n=s[t],s[t]=void 0),n&&(n.plugin=null,i&&this.removeCapture(n.keyCode),e&&n.destroy()),this},removeAllKeys:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var i=this.keys,n=0;n<i.length;n++){var s=i[n];s&&(i[n]=void 0,e&&this.removeCapture(s.keyCode),t&&s.destroy())}return this},createCombo:function(t,e){return new l(this,t,e)},checkDown:function(t,e){if(void 0===e&&(e=0),this.enabled&&t.isDown){var i=d(this.time-t.timeDown,e);if(i>t._tick)return t._tick=i,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,s=0;s<e;s++){var r=t[s],a=r.keyCode,o=n[a],h=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&(a===this.prevCode&&r.timeStamp===this.prevTime&&r.type===this.prevType||(this.prevCode=a,this.prevTime=r.timeStamp,this.prevType=r.type,"keydown"===r.type?(o&&(h=o.isDown,o.onDown(r)),r.cancelled||o&&h||(u[a]&&this.emit(i.KEY_DOWN+u[a],r),r.cancelled||this.emit(i.ANY_KEY_DOWN,r))):(o&&o.onUp(r),r.cancelled||(u[a]&&this.emit(i.KEY_UP+u[a],r),r.cancelled||this.emit(i.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0)))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(r.MANAGER_PROCESS,this.update,this),this.game.events.off(n.BLUR,this.resetKeys),this.scene.sys.events.off(c.PAUSE,this.resetKeys,this),this.scene.sys.events.off(c.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});return a.register("KeyboardPlugin",f,"keyboard","keyboard","inputKeyboard"),f6=f}function M7(){if(v6)return g6;v6=1;return g6=function(t){return!!t._justDown&&(t._justDown=!1,!0)}}function R7(){if(y6)return m6;y6=1;return m6=function(t){return!!t._justUp&&(t._justUp=!1,!0)}}function L7(){if(w6)return x6;w6=1;return x6=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeDown;return t.isDown&&i<e}}function O7(){if(T6)return b6;T6=1;return b6=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeUp;return t.isUp&&i<e}}function F7(){if(R6)return M6;R6=1;var t=_V(),e=nh(),i={CreatePixelPerfectHandler:f7(),CreateInteractiveObject:p7(),Events:CV(),Gamepad:k4?I4:(k4=1,I4={Axis:g7(),Button:m7(),Events:v7(),Gamepad:y7(),GamepadPlugin:w7(),Configs:D4?F4:(D4=1,F4={DUALSHOCK_4:P4?A4:(P4=1,A4={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}),SNES_USB:R4?M4:(R4=1,M4={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}),XBOX_360:O4?L4:(O4=1,L4={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3})})}),InputManager:OV(),InputPlugin:b7(),InputPluginCache:x7(),Keyboard:E6?S6:(E6=1,S6={Events:T7(),KeyboardManager:PV(),KeyboardPlugin:P7(),Key:S7(),KeyCodes:AV(),KeyCombo:A7(),AdvanceKeyCombo:E7(),ProcessKeyCombo:_7(),ResetKeyCombo:C7(),JustDown:M7(),JustUp:R7(),DownDuration:L7(),UpDuration:O7()}),Mouse:C6?_6:(C6=1,_6={MouseManager:MV()}),Pointer:RV(),Touch:P6?A6:(P6=1,A6={TouchManager:LV()})};return i=e(!1,i,t),M6=i}function D7(){if(O6)return L6;O6=1;return L6={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20}}function I7(){if(D6)return F6;D6=1;return F6=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}}function k7(){if(k6)return I6;k6=1;return I6=function(t,e,i,n,s,r){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===i&&(i=""),void 0===n&&(n=""),void 0===s&&(s=0),void 0===r&&(r=!1),{responseType:t,async:e,user:i,password:n,timeout:s,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:r}}}function B7(){if(N6)return B6;N6=1;var t=nh(),e=k7();return B6=function(i,n){var s=void 0===i?e():t({},i);if(n)for(var r in n)void 0!==n[r]&&(s[r]=n[r]);return s}}function N7(){if(U6)return z6;U6=1;var t=B7();return z6=function(e,i){var n=t(i,e.xhrSettings);if(e.base64){var s,r=e.url.split(";base64,").pop()||e.url.split(",").pop();return s="arraybuffer"===e.xhrSettings.responseType?{response:Uint8Array.from(atob(r),function(t){return t.charCodeAt(0)}).buffer}:{responseText:atob(r)},void e.onBase64Load(s)}var a=new XMLHttpRequest;if(a.open("GET",e.src,n.async,n.user,n.password),a.responseType=e.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var o in n.headers)a.setRequestHeader(o,n.headers[o]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=e.onLoad.bind(e,a),a.onerror=e.onError.bind(e,a),a.onprogress=e.onProgress.bind(e),a.ontimeout=e.onError.bind(e,a),a.send(),a}}function z7(){if(X6)return Y6;X6=1;var t=Kh(),e=D7(),i=zV(),n=jh(),s=I7(),r=B7(),a=N7(),o=k7(),h=new t({initialize:function(t,i){if(this.loader=t,this.cache=n(i,"cache",!1),this.type=n(i,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=n(i,"key",!1);var s=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+s),!this.key)throw new Error("Invalid File key: "+this.key);var a=n(i,"url");void 0===a?a=t.path+s+"."+n(i,"extension",""):"string"!=typeof a||a.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)||(a=t.path+a),this.url=a,this.src="",this.xhrSettings=o(n(i,"responseType",void 0)),n(i,"xhrSettings",!1)&&(this.xhrSettings=r(this.xhrSettings,n(i,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?e.FILE_POPULATED:e.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=n(i,"config",{}),this.multiFile,this.linkFile,this.base64="string"==typeof a&&0===a.indexOf("data:"),this.retryAttempts=n(i,"maxRetries",t.maxRetries)},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===e.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=e.FILE_LOADING,this.src=s(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);0===this.src.indexOf("data:")&&(this.base64=!0),this.xhrLoader=a(this,this.loader.xhr)}},onLoad:function(t,i){var n=t.responseURL&&this.loader.localSchemes.some(function(e){return 0===t.responseURL.indexOf(e)})&&0===i.target.status,s=!(i.target&&200!==i.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(s=!1),this.state=e.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,s)},onBase64Load:function(t){this.xhrLoader=t,this.state=e.FILE_LOADED,this.percentComplete=1,this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=e.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=e.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){console.error('Failed to process file: %s "%s"',this.type,this.key),this.state=e.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(t){if(this.state!==e.FILE_PENDING_DESTROY){void 0===t&&(t=this.data);var n=this.key,s=this.type;this.loader.emit(i.FILE_COMPLETE,n,s,t),this.loader.emit(i.FILE_KEY_COMPLETE+s+"-"+n,n,s,t),this.loader.flagForRemoval(this),this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});return h.createObjectURL=function(t,e,i){if("function"==typeof URL)t.src=URL.createObjectURL(e);else{var n=new FileReader;n.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||i)+";base64,"+n.result.split(",")[1]},n.onerror=t.onerror,n.readAsDataURL(e)}},h.revokeObjectURL=function(t){"function"==typeof URL&&URL.revokeObjectURL(t.src)},Y6=h}function U7(){if(W6)return G6;W6=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=Vl(),a=ih(),o=new t({Extends:i,initialize:function(t,n,o,h,l){var u="json";if(a(n)){var c=n;n=s(c,"key"),o=s(c,"url"),h=s(c,"xhrSettings"),u=s(c,"extension",u),l=s(c,"dataKey",l)}var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:n,url:o,xhrSettings:h,config:l};i.call(this,t,d),a(o)&&(this.data=l?r(o,l):o,this.state=e.FILE_POPULATED)},onProcess:function(){if(this.state!==e.FILE_POPULATED){this.state=e.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw this.onProcessError(),t}var i=this.config;this.data="string"==typeof i?r(t,i,t):t}this.onProcessComplete()}});return n.register("json",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,n,i));return this}),G6=o}function Y7(){if(V6)return H6;V6=1;var t=Kh(),e=FV(),i=U7(),n=zV(),s=new t({Extends:i,initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.type="animationJSON"},onProcess:function(){this.loader.once(n.POST_PROCESS,this.onLoadComplete,this),i.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});return e.register("animation",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),H6=s}function X7(){if(q6)return j6;q6=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=I7(),o=new t({Extends:i,initialize:function t(e,n,a,o,h){var l,u="png";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"normalMap"),o=s(c,"xhrSettings"),u=s(c,"extension",u),h=s(c,"frameConfig")}Array.isArray(a)&&(l=a[1],a=a[0]);var d={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:a,xhrSettings:o,config:h};if(i.call(this,e,d),l){var f=new t(e,this.key,l,o,h);f.type="normalMap",this.setLink(f),e.addFile(f)}this.useImageElementLoad="HTMLImageElement"===e.imageLoadType||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){i.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(t.data),t.onProcessError()},i.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var t=this.state;this.state=e.FILE_PROCESSING,t===e.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=e.FILE_LOADING,this.src=a(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){t.state=e.FILE_LOADED,t.loader.nextFile(t,!0)},this.data.onerror=function(){t.loader.nextFile(t,!1)},this.data.src=this.src},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("spritesheet"===t.type?t.addToCache():"normalMap"===this.type?this.cache.addImage(this.key,t.data,this.data):this.cache.addImage(this.key,this.data,t.data)):this.cache.addImage(this.key,this.data)}});return n.register("image",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),j6=o}function G7(){if(Z6)return K6;Z6=1;var t=Kh(),e=D7(),i=zV(),n=new t({initialize:function(t,i,n,s){var r=[];s.forEach(function(t){t&&r.push(t)}),this.loader=t,this.type=i,this.key=n;var a=this.key;t.prefix&&""!==t.prefix&&(this.key=t.prefix+a),this.multiKeyIndex=t.multiKeyIndex++,this.files=r,this.state=e.FILE_PENDING,this.complete=!1,this.pending=r.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var o=0;o<r.length;o++)r[o].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&(this.failed++,console.error('File failed: %s "%s" (via %s "%s")',this.type,this.key,t.type,t.key))},pendingDestroy:function(){if(this.state!==e.FILE_PENDING_DESTROY){var t=this.key,n=this.type;this.loader.emit(i.FILE_COMPLETE,t,n),this.loader.emit(i.FILE_KEY_COMPLETE+n+"-"+t,t,n),this.loader.flagForRemoval(this);for(var s=0;s<this.files.length;s++)this.files[s].pendingDestroy();this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});return K6=n}function W7(){if($6)return J6;$6=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=U7(),a=G7(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),e.addToCache(),this.complete=!0}}});return e.register("aseprite",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),J6=o}function H7(){if(t8)return Q6;t8=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=U7(),a=G7(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),Q6=o}function V7(){if(i8)return e8;i8=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=bV(),o=new t({Extends:i,initialize:function(t,e,n,a){var o="xml";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"xml",cache:t.cacheManager.xml,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=a(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});return n.register("xml",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),e8=o}function j7(){if(s8)return n8;s8=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=G7(),a=V7(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","xml"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"atlasxml",e,[c,d,c.linkFile]):r.call(this,t,"atlasxml",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlasXML",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),n8=o}function q7(){if(a8)return r8;a8=1;var t=Kh(),e=zV(),i=z7(),n=jh(),s=I7(),r=ih(),a=new t({Extends:i,initialize:function(t,e,s,a){if(r(e)){var o=e;e=n(o,"key"),a=n(o,"config",a)}var h={type:"audio",cache:t.cacheManager.audio,extension:s.type,key:e,url:s.url,config:a};i.call(this,t,h),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var i=t.target;i.oncanplaythrough=null,i.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(e.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var i=new Audio;i.dataset||(i.dataset={}),i.dataset.name=this.key+("0"+e).slice(-2),i.dataset.used="false",this.locked?i.dataset.locked="true":(i.dataset.locked="false",i.preload="auto",i.oncanplaythrough=this.onProgress.bind(this),i.onerror=this.onError.bind(this)),this.data.push(i)}for(e=0;e<this.data.length;e++)(i=this.data[e]).src=s(this,this.loader.baseURL),this.locked||i.load();this.locked&&setTimeout(this.onLoad.bind(this))}});return r8=a}function K7(){if(h8)return o8;h8=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=q7(),a=ih(),o=new t({Extends:i,initialize:function(t,e,n,r,o){if(a(e)){var h=e;e=s(h,"key"),r=s(h,"xhrSettings"),o=s(h,"context",o)}var l={type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:r,config:{context:o}};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(e){t.data=e,t.onProcessComplete()},function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()}),this.config.context=null}});return o.create=function(t,e,i,n,h){var l=t.systems.game,u=l.config.audio,c=l.device.audio;a(e)&&(i=s(e,"url",[]),n=s(e,"config",{}));var d=o.getAudioURL(l,i);return d?c.webAudio&&!u.disableWebAudio?new o(t,e,d,h,l.sound.context):new r(t,e,d,n):(console.warn('No audio URLs for "%s" can play on this device',e),null)},o.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var n=s(e[i],"url",e[i]);if(0===n.indexOf("blob:")||0===n.indexOf("data:"))return{url:n,type:""};var r=n.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=s(e[i],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:n,type:r}}return null},n.register("audio",function(t,e,i,n){var s,r=this.systems.game,a=r.config.audio,h=r.device.audio;if(a.noAudio||!h.webAudio&&!h.audioData)return this;if(Array.isArray(t))for(var l=0;l<t.length;l++)(s=o.create(this,t[l]))&&this.addFile(s);else(s=o.create(this,t,e,i,n))&&this.addFile(s);return this}),o8=o}var Z7,J7,$7,Q7,t9,e9,i9,n9,s9,r9,a9,o9,h9,l9,u9,c9,d9,f9,p9,g9,v9,m9,y9,x9,w9,b9,T9,S9,E9,_9,C9,A9,P9,M9,R9,L9,O9,F9,D9,I9,k9,B9,N9,z9,U9,Y9,X9,G9,W9,H9,V9,j9,q9,K9,Z9,J9,$9,Q9,ttt,ett,itt,ntt,stt,rtt,att,ott,htt,ltt,utt,ctt,dtt,ftt,ptt,gtt,vtt,mtt,ytt,xtt,wtt,btt,Ttt,Stt,Ett,_tt,Ctt,Att,Ptt,Mtt,Rtt,Ltt,Ott,Ftt,Dtt,Itt,ktt,Btt,Ntt,ztt,Utt,Ytt,Xtt,Gtt,Wtt,Htt,Vtt,jtt,qtt,Ktt,Ztt,Jtt,$tt,Qtt,tet,eet,iet,net,set,ret,aet,oet,het,uet,cet,det,fet,pet,get,vet,met,yet,xet,wet,bet,Tet,Eet,_et,Cet,Aet,Pet,Met,Ret,Let,Oet,Fet,Det,Iet,ket,Bet,Net,zet,Uet,Yet,Xet,Get,Wet,Het,Vet,jet,qet,Ket,Zet,Jet,$et,Qet,tit,eit,iit,nit,sit,rit,ait,oit,hit,lit,uit,cit,dit,fit,pit,git,vit,mit={};function yit(){if(Z7)return mit;Z7=1;var t=K7(),e=Kh(),i=FV(),n=jh(),s=ih(),r=U7(),a=G7(),o=new e({Extends:a,initialize:function(e,i,o,h,l,u,c){if(s(i)){var d=i;i=n(d,"key"),o=n(d,"jsonURL"),h=n(d,"audioURL"),l=n(d,"audioConfig"),u=n(d,"audioXhrSettings"),c=n(d,"jsonXhrSettings")}var f;if(h){var p=t.create(e,i,h,l,u);p&&(f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[p,f]),this.config.resourceLoad=!1)}else f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[f]),this.config.resourceLoad=!0,this.config.audioConfig=l,this.config.audioXhrSettings=u},onFileComplete:function(e){if(-1!==this.files.indexOf(e)&&(this.pending--,this.config.resourceLoad&&"json"===e.type&&e.data.hasOwnProperty("resources"))){var i=e.data.resources,s=n(this.config,"audioConfig"),r=n(this.config,"audioXhrSettings"),a=t.create(this.loader,e.key,i,s,r);a&&(this.addToMultiFile(a),this.loader.addFile(a))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.complete=!0}}});return i.register("audioSprite",function(t,e,i,n,s,r){var a,h=this.systems.game,l=h.config.audio,u=h.device.audio;if(l&&l.noAudio||!u.webAudio&&!u.audioData)return this;if(Array.isArray(t))for(var c=0;c<t.length;c++)(a=new o(this,t[c])).files&&this.addFile(a.files);else(a=new o(this,t,e,i,n,s,r)).files&&this.addFile(a.files);return this}),mit}function xit(){if($7)return J7;$7=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="bin";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"xhrSettings"),h=s(l,"extension",h),o=s(l,"dataType",o)}var u={type:"binary",cache:t.cacheManager.binary,extension:h,responseType:"arraybuffer",key:e,url:n,xhrSettings:a,config:{dataType:o}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});return n.register("binary",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,n,i));return this}),J7=a}function wit(){if(t9)return Q7;t9=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=G7(),a=Tj(),o=V7(),h=new t({Extends:r,initialize:function(t,e,a,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new o(t,{key:e,url:i(f,"fontDataURL"),extension:i(f,"fontDataExtension","xml"),xhrSettings:i(f,"fontDataXhrSettings")})}else c=new n(t,e,a,l),d=new o(t,e,h,u);c.linkFile?r.call(this,t,"bitmapfont",e,[c,d,c.linkFile]):r.call(this,t,"bitmapfont",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache();var i=t.cache.get(t.key),n=a(e.data,t.cache.getFrame(t.key),0,0,i);this.loader.cacheManager.bitmapFont.add(t.key,{data:n,texture:t.key,frame:null}),this.complete=!0}}});return e.register("bitmapFont",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),Q7=h}function bit(){if(i9)return e9;i9=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=U7(),a=G7(),o=new t({Extends:a,initialize:function(t,e,n,o,h,l,u){if(s(e)){var c=e;e=i(c,"key"),n=i(c,"url",!1)?i(c,"url"):i(c,"atlasURL"),l=i(c,"xhrSettings"),o=i(c,"path"),h=i(c,"baseURL"),u=i(c,"textureXhrSettings")}var d=new r(t,e,n,l);a.call(this,t,"multiatlas",e,[d]),this.config.path=o,this.config.baseURL=h,this.config.textureXhrSettings=u},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,s=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=i(s,"baseURL",this.baseURL),u=i(s,"path",this.path),c=i(s,"prefix",this.prefix),d=i(s,"textureXhrSettings");r.setBaseURL(l),r.setPath(u),r.setPrefix(c);for(var f=0;f<e.length;f++){var p=e[f].image,g="MA"+this.multiKeyIndex+"_"+p,v=new n(r,g,p,d);if(this.addToMultiFile(v),r.addFile(v),e[f].normalMap){var m=new n(r,g,e[f].normalMap,d);m.type="normalMap",v.setLink(m),this.addToMultiFile(m),r.addFile(m)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],i=[],n=[],s=1;s<this.files.length;s++){var r=this.files[s];if("normalMap"!==r.type)for(var a=r.key.indexOf("_"),o=r.key.substr(a+1),h=r.data,l=0;l<t.data.textures.length;l++){var u=t.data.textures[l];if(u.image===o){i.push(h),e.push(u),r.linkFile&&n.push(r.linkFile.data);break}}}0===n.length&&(n=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,i,e,n),this.complete=!0}}});return e.register("multiatlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),e9=o}function Tit(){if(a9)return r9;a9=1;var t=H7(),e=xit(),i=Kh(),n=FV(),s=jh(),r=X7(),a=ih(),o=U7(),h=rj(),l=GV(),u=bit(),c=G7(),d=aj(),f=function(){if(s9)return n9;s9=1;var t=RG();function e(t){for(var e=t.mipmaps,i=0;i<e.length;i++){var n=e[i].width,s=e[i].height;if((n<<i)%4!=0||(s<<i)%4!=0)return console.warn("BPTC, RGTC, and S3TC dimensions must be a multiple of 4 pixels, and each successive mip level must be half the size of the previous level, rounded down. Mip level "+i+" is "+n+"x"+s),!1}return!0}function i(){return!0}function n(e){var i=e.mipmaps[0];return!!t(i.width,i.height)||(console.warn("PVRTC base dimensions must be power of two. Base level is "+i.width+"x"+i.height),!1)}function s(t){var e=t.mipmaps[0];return e.width%4==0&&e.height%4==0||(console.warn("S3TC SRGB base dimensions must be a multiple of 4 pixels. Base level is "+e.width+"x"+e.height+" pixels"),!1)}var r={37488:i,37489:i,37490:i,37491:i,37492:i,37493:i,37494:i,37495:i,37496:i,37497:i,36196:i,37808:i,37809:i,37810:i,37811:i,37812:i,37813:i,37814:i,37815:i,37816:i,37817:i,37818:i,37819:i,37820:i,37821:i,37840:i,37841:i,37842:i,37843:i,37844:i,37845:i,37846:i,37847:i,37848:i,37849:i,37850:i,37851:i,37852:i,37853:i,36492:e,36493:e,36494:e,36495:e,36283:e,36284:e,36285:e,36286:e,35840:n,35841:n,35842:n,35843:n,33776:e,33777:e,33778:e,33779:e,35916:s,35917:s,35918:s,35919:s};return n9=function(e){for(var i=e.mipmaps,n=1;n<i.length;n++){var s=i[n].width,a=i[n].height;if(!t(s,a))return console.warn("Mip level "+n+" is not a power-of-two size: "+s+"x"+a),!1}var o=r[e.internalFormat];return o?o(e):(console.warn("No format checker found for internal format "+e.internalFormat+". Assuming valid."),!0)},n9}(),p=new i({Extends:c,initialize:function(t,i,n,s){if(n.multiAtlasURL){var r=new o(t,{key:i,url:n.multiAtlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[r])}else{var a=n.textureURL.substr(n.textureURL.length-3);n.type||(n.type="ktx"===a.toLowerCase()?"KTX":"PVR");var h=new e(t,{key:i,url:n.textureURL,extension:a,xhrSettings:s,config:n});if(n.atlasURL){var l=new o(t,{key:i,url:n.atlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[h,l])}else c.call(this,t,"texture",i,[h])}this.config=n},onFileComplete:function(t){if(-1!==this.files.indexOf(t)){if(this.pending--,!this.config.multiAtlasURL)return;if("json"===t.type&&t.data.hasOwnProperty("textures")){var i=t.data.textures,n=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=s(n,"multiBaseURL",this.baseURL),u=s(n,"multiPath",this.path),c=s(n,"prefix",this.prefix),d=s(n,"textureXhrSettings");l&&r.setBaseURL(l),u&&r.setPath(u),c&&r.setPrefix(c);for(var f=0;f<i.length;f++){var p=i[f].image,g="CMA"+this.multiKeyIndex+"_"+p,v=new e(r,g,p,d);if(this.addToMultiFile(v),r.addFile(v),i[f].normalMap){var m=new e(r,g,i[f].normalMap,d);m.type="normalMap",v.setLink(m),this.addToMultiFile(m),r.addFile(m)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}}},addToCache:function(){function t(t){console.warn('Compressed Texture Invalid: "'+r.key+'". '+t)}if(this.isReadyToProcess()){var e=this.config;if(e.multiAtlasURL)this.addMultiToCache();else{var i,n=this.loader.systems.renderer,s=this.loader.textureManager,r=this.files[0],a=this.files[1];if("PVR"===e.type?i=d(r.data):"KTX"===e.type&&((i=h(r.data))||t("KTX file contains unsupported format.")),i&&!f(i)&&(t("Texture dimensions failed verification. Check the texture format specifications for "+e.format+" 0x"+i.internalFormat.toString(16)+"."),i=null),i&&!n.supportsCompressedTexture(e.format,i.internalFormat)&&(t("Texture format "+e.format+" with internal format "+i.internalFormat+" not supported by the GPU. Texture invalid. This is often due to the texture using sRGB instead of linear RGB."),i=null),i){i.format=n.getCompressedTextureName(e.format,i.internalFormat);var o=a&&a.data?a.data:null;s.addCompressedTexture(r.key,i,o)}}this.complete=!0}},addMultiToCache:function(){for(var t,e=this.config,i=this.files[0],n=[],s=[],r=[],a=this.loader.systems.renderer,o=this.loader.textureManager,l=1;l<this.files.length;l++){var u=this.files[l];if("normalMap"!==u.type)for(var c=u.key.indexOf("_"),f=u.key.substr(c+1),p=u.data,g=0;g<i.data.textures.length;g++){var v=i.data.textures[g];if(v.image===f){"PVR"===e.type?t=d(p):"KTX"===e.type&&(t=h(p)),t&&a.supportsCompressedTexture(e.format,t.internalFormat)&&(t.format=a.getCompressedTextureName(e.format,t.internalFormat),s.push(t),n.push(v),u.linkFile&&r.push(u.linkFile.data));break}}}0===r.length&&(r=void 0),o.addAtlasJSONArray(this.key,s,n,r),this.complete=!0}});return n.register("texture",function(e,i,n){var o=this.systems.renderer,h=function(e,i,n,h){var c={format:null,type:null,textureURL:void 0,atlasURL:void 0,multiAtlasURL:void 0,multiPath:void 0,multiBaseURL:void 0};if(a(i)){var d=i;i=s(d,"key"),n=s(d,"url"),h=s(d,"xhrSettings")}var f=!1;for(var g in n)if(o.supportsCompressedTexture(g)){var v=n[g];"string"==typeof v?c.textureURL=v:c=l(v,c),c.format=g.toUpperCase(),f=!0;break}if(f)if("IMG"===c.format){var m;m=c.multiAtlasURL?new u(e,i,c.multiAtlasURL,c.multiPath,c.multiBaseURL,h).files:c.atlasURL?new t(e,i,c.textureURL,c.atlasURL,h).files:new r(e,i,c.textureURL,h),e.addFile(m)}else{var y=new p(e,i,c,h);e.addFile(y.files)}else console.warn("No supported compressed texture format or IMG fallback",i)};if(Array.isArray(e))for(var c=0;c<e.length;c++)h(this,e[c]);else h(this,e,i,n);return this}),r9=p}function Sit(){if(h9)return o9;h9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="css";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"script",cache:!1,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("css",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),o9=a}function Eit(){if(u9)return l9;u9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=I7(),a=ih(),o=new t({Extends:i,initialize:function(t,n,r,o,h,l){var u="ttf";if(a(n)){var c=n;n=s(c,"key"),r=s(c,"url"),o=s(c,"format","truetype"),h=s(c,"descriptors",null),l=s(c,"xhrSettings"),u=s(c,"extension",u)}else void 0===o&&(o="truetype");var d={type:"font",cache:!1,extension:u,responseType:"text",key:n,url:r,xhrSettings:l};i.call(this,t,d),this.data={format:o,descriptors:h},this.state=e.FILE_POPULATED},onProcess:function(){var t;this.state=e.FILE_PROCESSING,this.src=r(this,this.loader.baseURL);var i=this.key,n="url("+this.src+') format("'+this.data.format+'")';t=this.data.descriptors?new FontFace(i,n,this.data.descriptors):new FontFace(i,n);var s=this;t.load().then(function(){document.fonts.add(t),document.body.classList.add("fonts-loaded"),s.onProcessComplete()}).catch(function(){console.warn("Font failed to load",n),s.onProcessComplete()})}});return n.register("font",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new o(this,t[r]));else this.addFile(new o(this,t,e,i,n,s));return this}),l9=o}function _it(){if(d9)return c9;d9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=eV(),o=new t({Extends:i,initialize:function(t,e,n,a,o){var h="glsl";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"shaderType","fragment"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="fragment");var u={type:"glsl",cache:t.cacheManager.shader,extension:h,responseType:"text",key:e,url:n,config:{shaderType:a},xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var i=this.getShaderName(e.header),n=this.getShaderType(e.header),s=this.getShaderUniforms(e.header),r=e.shader;if(this.cache.has(i)){var o=this.cache.get(i);"fragment"===n?o.fragmentSrc=r:o.vertexSrc=r,o.uniforms||(o.uniforms=s)}else"fragment"===n?this.cache.add(i,new a(i,r,"",s)):this.cache.add(i,new a(i,"",r,s));e=this.extractBlock(t,e.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new a(this.key,this.data)):this.cache.add(this.key,new a(this.key,"",this.data))},getShaderName:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("name:"===i.substring(0,5))return i.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("type:"===i.substring(0,5))return i.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},i=0;i<t.length;i++){var n=t[i].trim();if("uniform."===n.substring(0,8)){var s=n.indexOf(":");if(s){var r=n.substring(8,s);try{e[r]=JSON.parse(n.substring(s+1))}catch(t){console.warn("Invalid uniform JSON: "+r)}}}}return e},extractBlock:function(t,e){for(var i=-1,n=-1,s=-1,r=!1,a=!1,o=[],h=[],l=e;l<t.length;l++){var u=t[l].trim();if("---"===u)if(-1===i)i=l,r=!0;else{if(!r){a=!1;break}n=l,r=!1,a=!0}else r?o.push(u):a&&(h.push(u),s=l)}return r||-1===n?null:{header:o,shader:h.join("\n"),offset:s}}});return n.register("glsl",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,i,n));return this}),c9=o}function Cit(){if(p9)return f9;p9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="html";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",cache:t.cacheManager.html,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("html",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),f9=a}function Ait(){if(v9)return g9;v9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o,h){void 0===a&&(a=512),void 0===o&&(o=512);var l="html";if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),h=s(u,"xhrSettings"),l=s(u,"extension",l),a=s(u,"width",a),o=s(u,"height",o)}var c={type:"html",cache:t.textureManager,extension:l,responseType:"text",key:e,url:n,xhrSettings:h,config:{width:a,height:o}};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.width,n=this.config.height,s=[];s.push('<svg width="'+t+'px" height="'+n+'px" viewBox="0 0 '+t+" "+n+'" xmlns="http://www.w3.org/2000/svg">'),s.push('<foreignObject width="100%" height="100%">'),s.push('<body xmlns="http://www.w3.org/1999/xhtml">'),s.push(this.xhrLoader.responseText),s.push("</body>"),s.push("</foreignObject>"),s.push("</svg>");var r=[s.join("\n")],a=this;try{var o=new window.Blob(r,{type:"image/svg+xml;charset=utf-8"})}catch(t){return a.state=e.FILE_ERRORED,void a.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){i.revokeObjectURL(a.data),a.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(a.data),a.onProcessError()},i.createObjectURL(this.data,o,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("htmlTexture",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),g9=a}function Pit(){if(y9)return m9;y9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="js";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"type","script"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="script");var u={type:a,cache:!1,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("script",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),m9=a}function Mit(){if(w9)return x9;w9=1;var t=Kh(),e=FV(),i=jh(),n=ih(),s=G7(),r=Pit(),a=new t({Extends:s,initialize:function(t,e,a,o){var h="js",l=[];if(n(e)){var u=e;e=i(u,"key"),a=i(u,"url"),o=i(u,"xhrSettings"),h=i(u,"extension",h)}Array.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=new r(t,{key:e+"_"+c.toString(),url:a[c],extension:h,xhrSettings:o});d.onProcess=function(){this.onProcessComplete()},l.push(d)}s.call(this,t,"scripts",e,l)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});return e.register("scripts",function(t,e,i){var n;if(Array.isArray(t))for(var s=0;s<t.length;s++)n=new a(this,t[s]),this.addFile(n.files);else n=new a(this,t,e,i),this.addFile(n.files);return this}),x9=a}function Rit(){if(T9)return b9;T9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="text",h="txt",l=t.cacheManager.text;if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),a=s(u,"xhrSettings"),h=s(u,"extension",h),o=s(u,"type",o),l=s(u,"cache",l)}var c={type:o,cache:l,extension:h,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("text",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),b9=a}function Lit(){if(E9)return S9;E9=1;var t=Kh(),e=FV(),i=jh(),n=ih(),s=G7(),r=K8(),a=Z8(),o=Rit(),h=new t({Extends:s,initialize:function(t,e,r,a,h,l){var u,c,d=t.cacheManager.obj;if(n(e)){var f=e;e=i(f,"key"),u=new o(t,{key:e,type:"obj",cache:d,url:i(f,"url"),extension:i(f,"extension","obj"),xhrSettings:i(f,"xhrSettings"),config:{flipUV:i(f,"flipUV",h)}}),(a=i(f,"matURL"))&&(c=new o(t,{key:e,type:"mat",cache:d,url:a,extension:i(f,"matExtension","mat"),xhrSettings:i(f,"xhrSettings")}))}else u=new o(t,{key:e,url:r,type:"obj",cache:d,extension:"obj",xhrSettings:l,config:{flipUV:h}}),a&&(c=new o(t,{key:e,url:a,type:"mat",cache:d,extension:"mat",xhrSettings:l}));s.call(this,t,"obj",e,[u,c])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=r(t.data,t.config.flipUV);e&&(i.materials=a(e.data)),t.cache.add(t.key,i),this.complete=!0}}});return e.register("obj",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),S9=h}function Oit(){if(C9)return _9;C9=1;var t=Kh(),e=D7(),i=FV(),n=U7(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,s,r),this.type="packfile"},onProcess:function(){if(this.state!==e.FILE_POPULATED&&(this.state=e.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.data.hasOwnProperty("files")&&this.config){var t={};t[this.config]=this.data,this.data=t}this.loader.addPack(this.data,this.config),this.onProcessComplete()}});return i.register("pack",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),_9=s}function Fit(){if(P9)return A9;P9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"start"),h=s(c,"mapping")}var d={type:"plugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{start:o,mapping:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=s(i,"start",!1),r=s(i,"mapping",null);if(this.state===e.FILE_POPULATED)t.install(this.key,this.data,n,r);else{this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var a=t.install(this.key,window[this.key],n,r);(n||r)&&(this.loader.systems[r]=a,this.loader.scene[r]=a)}this.onProcessComplete()}});return n.register("plugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),A9=a}function Dit(){if(R9)return M9;R9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="js";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),e=eval;this.loader.sceneManager.add(this.key,e(t)),this.complete=!0}});return n.register("sceneFile",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),M9=a}function Iit(){if(O9)return L9;O9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"systemKey"),h=s(c,"sceneKey")}var d={type:"scenePlugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{systemKey:o,sceneKey:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=this.key,r=s(i,"systemKey",n),a=s(i,"sceneKey",n);this.state===e.FILE_POPULATED?t.installScenePlugin(r,this.data,a,this.loader.scene,!0):(this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(r,window[this.key],a,this.loader.scene,!0)),this.onProcessComplete()}});return n.register("scenePlugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),L9=a}function kit(){if(D9)return F9;D9=1;var t=Kh(),e=D7(),i=FV(),n=X7(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,r,s),this.type="spritesheet"},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("normalMap"===this.type?this.cache.addSpriteSheet(this.key,t.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,t.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});return i.register("spritesheet",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,i,n));return this}),F9=s}function Bit(){if(k9)return I9;k9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="svg";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"svgConfig",{}),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"svg",cache:t.textureManager,extension:h,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:s(a,"width"),height:s(a,"height"),scale:s(a,"scale")}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.xhrLoader.responseText,n=[t],s=this.config.width,r=this.config.height,a=this.config.scale;t:if(s&&r||a){var o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],h=o.hasAttribute("viewBox"),l=parseFloat(o.getAttribute("width")),u=parseFloat(o.getAttribute("height"));if(!h&&l&&u)o.setAttribute("viewBox","0  0 "+l+" "+u);else if(h&&!l&&!u){var c=o.getAttribute("viewBox").split(/\s+|,/);l=c[2],u=c[3]}if(a){if(!l||!u)break t;s=l*a,r=u*a}o.setAttribute("width",s.toString()+"px"),o.setAttribute("height",r.toString()+"px"),n=[(new XMLSerializer).serializeToString(o)]}try{var d=new window.Blob(n,{type:"image/svg+xml;charset=utf-8"})}catch(t){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var f=this,p=!1;this.data.onload=function(){p||i.revokeObjectURL(f.data),f.onProcessComplete()},this.data.onerror=function(){p?f.onProcessError():(p=!0,i.revokeObjectURL(f.data),f.data.src="data:image/svg+xml,"+encodeURIComponent(n.join("")))},i.createObjectURL(this.data,d,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("svg",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),I9=a}function Nit(){return N9?B9:(N9=1,B9={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3})}function zit(){if(U9)return z9;U9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=jh(),r=ih(),a=Nit(),o=new t({Extends:i,initialize:function(t,e,n,o){var h="csv";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u),this.tilemapFormat=a.CSV},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t)}});return n.register("tilemapCSV",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),z9=o}function Uit(){if(X9)return Y9;X9=1;var t=Kh(),e=FV(),i=U7(),n=Nit(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.WELTMEISTER,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapImpact",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),Y9=s}function Yit(){if(W9)return G9;W9=1;var t=Kh(),e=FV(),i=U7(),n=Nit(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.TILED_JSON,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapTiledJSON",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),G9=s}function Xit(){if(V9)return H9;V9=1;var t=Kh(),e=FV(),i=jh(),n=X7(),s=ih(),r=G7(),a=Rit(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","txt"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"unityatlas",e,[c,d,c.linkFile]):r.call(this,t,"unityatlas",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("unityAtlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),H9=o}function Git(){if(q9)return j9;q9=1;var t=Kh(),e=D7(),i=z7(),n=FV(),s=I7(),r=jh(),a=ih(),o=new t({Extends:i,initialize:function(t,e,n,s){if(void 0===s&&(s=!1),a(e)){var o=e;e=r(o,"key"),n=r(o,"url",[]),s=r(o,"noAudio",!1)}var h=t.systems.game.device.video.getVideoURL(n);h||console.warn("VideoFile: No supported format for "+e);var l={type:"video",cache:t.cacheManager.video,extension:h.type,key:e,url:h.url,config:{noAudio:s}};i.call(this,t,l)},onProcess:function(){this.data={url:this.src,noAudio:this.config.noAudio,crossOrigin:this.crossOrigin},this.onProcessComplete()},load:function(){this.src=s(this,this.loader.baseURL),this.state=e.FILE_LOADED,this.loader.nextFile(this,!0)}});return n.register("video",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),j9=o}function Wit(){if($9)return J9;$9=1;var t=Kh(),e=D7(),i=$j(),n=cU(),s=zV(),r=FV(),a=jh(),o=Vl(),h=ih(),l=tc(),u=ec(),c=k7(),d=new t({Extends:n,initialize:function(t){n.call(this);var s=t.sys.game.config,o=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,r.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(a(o,"baseURL",s.loaderBaseURL)),this.setPath(a(o,"path",s.loaderPath)),this.setPrefix(a(o,"prefix",s.loaderPrefix)),this.maxParallelDownloads=a(o,"maxParallelDownloads",s.loaderMaxParallelDownloads),this.xhr=c(a(o,"responseType",s.loaderResponseType),a(o,"async",s.loaderAsync),a(o,"user",s.loaderUser),a(o,"password",s.loaderPassword),a(o,"timeout",s.loaderTimeout),a(o,"withCredentials",s.loaderWithCredentials)),this.crossOrigin=a(o,"crossOrigin",s.loaderCrossOrigin),this.imageLoadType=a(o,"imageLoadType",s.loaderImageLoadType),this.localSchemes=a(o,"localScheme",s.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new i,this.inflight=new i,this.queue=new i,this._deleteQueue=new i,this.totalFailed=0,this.totalComplete=0,this.state=e.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=a(o,"maxRetries",s.loaderMaxRetries),t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.pluginStart,this)},boot:function(){this.systems.events.once(u.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(u.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];this.keyExists(i)||(this.list.set(i),this.emit(s.ADD,i.key,i.type,this,i),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),!e&&this.isLoading()&&(this.inflight.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),this.queue.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1})),e},addPack:function(t,e){if("string"==typeof e){var i=o(t,e);i&&(t={packKey:i})}var n=0,s=this.baseURL,r=this.path,h=this.prefix;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=t[l],c=a(u,"baseURL",s),d=a(u,"path",r),f=a(u,"prefix",h),p=a(u,"files",null),g=a(u,"defaultType","void");if(Array.isArray(p)){this.setBaseURL(c),this.setPath(d),this.setPrefix(f);for(var v=0;v<p.length;v++){var m=p[v],y=m.hasOwnProperty("type")?m.type:g;this[y]&&(this[y](m),n++)}}}return this.setBaseURL(s),this.setPath(r),this.setPrefix(h),n>0},removePack:function(t,e){var i,n=this.systems.anims,s=this.cacheManager,r=this.textureManager,o={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"};if(h(t))i=t;else if(!(i=s.json.get(t)))return void console.warn("Asset Pack not found in JSON cache:",t);for(var l in e&&(i={_:i[e]}),i){var u=i[l],c=a(u,"prefix",""),d=a(u,"files"),f=a(u,"defaultType");if(Array.isArray(d))for(var p=0;p<d.length;p++){var g=d[p],v=g.hasOwnProperty("type")?g.type:f;if(v){var m=c+g.key;if("animation"===v&&n.remove(m),"aseprite"!==v&&"atlas"!==v&&"atlasXML"!==v&&"htmlTexture"!==v&&"image"!==v&&"multiatlas"!==v&&"spritesheet"!==v&&"svg"!==v&&"texture"!==v&&"unityAtlas"!==v||(r.remove(m),o[v]))if("pack"!==v){if("spine"===v){var y=s.custom.spine.get(m);if(!y)continue;var x=void 0===y.prefix?"":y.prefix;s.custom.spine.remove(m);var w=s.custom.spineTextures.get(m);if(!w)continue;s.custom.spineTextures.remove(m);for(var b=0;b<w.pages.length;b++){var T=x+w.pages[b].name,S=m+":"+T;r.exists(S)?r.remove(S):r.remove(T)}}var E=o[v];if(null!==E)if(E)s[E].remove(m);else console.warn("Unknown type:",v)}else this.removePack(m,g.dataKey)}else console.warn("No type:",g)}}},isLoading:function(){return this.state===e.LOADER_LOADING||this.state===e.LOADER_PROCESSING},isReady:function(){return this.state===e.LOADER_IDLE||this.state===e.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(s.START,this),0===this.list.size?this.loadComplete():(this.state=e.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(u.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(s.PROGRESS,this.progress)},update:function(){this.state===e.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(t){if((t.state===e.FILE_POPULATED||t.state===e.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(s.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(s.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===e.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===e.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&(t.multiFile.addToCache(),t.multiFile.pendingDestroy()):(t.addToCache(),t.pendingDestroy())),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(s.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=e.LOADER_COMPLETE,this.systems.events.off(u.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(s.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,i){void 0===e&&(e="file.json"),void 0===i&&(i="application/json");var n=new Blob([t],{type:i}),s=URL.createObjectURL(n),r=document.createElement("a");return r.download=e,r.textContent="Download "+e,r.href=s,r.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,i=this.systems.settings.loader;this.setBaseURL(a(i,"baseURL",t.loaderBaseURL)),this.setPath(a(i,"path",t.loaderPath)),this.setPrefix(a(i,"prefix",t.loaderPrefix)),this.state=e.LOADER_IDLE},shutdown:function(){this.reset(),this.state=e.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=e.LOADER_DESTROYED,this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});return l.register("Loader",d,"load"),J9=d}function Hit(){if(ttt)return Q9;ttt=1;var t=D7(),e=nh(),i={Events:zV(),FileTypes:Z9?K9:(Z9=1,K9={AnimationJSONFile:Y7(),AsepriteFile:W7(),AtlasJSONFile:H7(),AtlasXMLFile:j7(),AudioFile:K7(),AudioSpriteFile:yit(),BinaryFile:xit(),BitmapFontFile:wit(),CompressedTextureFile:Tit(),CSSFile:Sit(),FontFile:Eit(),GLSLFile:_it(),HTML5AudioFile:q7(),HTMLFile:Cit(),HTMLTextureFile:Ait(),ImageFile:X7(),JSONFile:U7(),MultiAtlasFile:bit(),MultiScriptFile:Mit(),OBJFile:Lit(),PackFile:Oit(),PluginFile:Fit(),SceneFile:Dit(),ScenePluginFile:Iit(),ScriptFile:Pit(),SpriteSheetFile:kit(),SVGFile:Bit(),TextFile:Rit(),TilemapCSVFile:zit(),TilemapImpactFile:Uit(),TilemapJSONFile:Yit(),UnityAtlasFile:Xit(),VideoFile:Git(),XMLFile:V7()}),File:z7(),FileTypesManager:FV(),GetURL:I7(),LoaderPlugin:Wit(),MergeXHRSettings:B7(),MultiFile:G7(),XHRLoader:N7(),XHRSettings:k7()};return i=e(!1,i,t),Q9=i}function Vit(){if(itt)return ett;itt=1;return ett={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14}}function jit(){if(stt)return ntt;stt=1;return ntt={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}}function qit(){if(att)return rtt;att=1;return rtt={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}}function Kit(){if(htt)return ott;htt=1;return ott={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,i,n){return this.body.setCollideWorldBounds(t,e,i,n),this}}}function Zit(){if(utt)return ltt;utt=1;return ltt=function(t){var e=0;if(Array.isArray(t))for(var i=0;i<t.length;i++)e|=t[i];else e=t;return e}}function Jit(){if(dtt)return ctt;dtt=1;var t=Zit(),e={setCollisionCategory:function(t){return(this.body?this.body:this).collisionCategory=t,this},willCollideWith:function(t){return 0!==((this.body?this.body:this).collisionMask&t)},addCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask|t,this},removeCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask&~t,this},setCollidesWith:function(e){return(this.body?this.body:this).collisionMask=t(e),this},resetCollisionCategory:function(){var t=this.body?this.body:this;return t.collisionCategory=1,t.collisionMask=2147483647,this}};return ctt=e}function $it(){if(ptt)return ftt;ptt=1;return ftt={setDebug:function(t,e,i){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=i,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}}function Qit(){if(vtt)return gtt;vtt=1;return gtt={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}}function tnt(){if(wtt)return xtt;wtt=1;return xtt={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}}function ent(){if(Ttt)return btt;Ttt=1;return btt={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}}function int(){if(Ctt)return _tt;Ctt=1;return _tt={setMass:function(t){return this.body.mass=t,this}}}function nnt(){if(Ptt)return Att;Ptt=1;return Att=function(t,e,i,n,s,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1);var o=[],h=[],l=t.treeMinMax;if(l.minX=e,l.minY=i,l.maxX=e+n,l.maxY=i+s,a&&(h=t.staticTree.search(l)),r&&t.useTree)o=t.tree.search(l);else if(r){var u=t.bodies,c={position:{x:e,y:i},left:e,top:i,right:e+n,bottom:i+s,isCircle:!1},d=t.intersects;u.iterate(function(t){d(t,c)&&o.push(t)})}return h.concat(o)},Att}function snt(){if(Rtt)return Mtt;Rtt=1;var t=nnt(),e=ol(),i=v8(),n=c8();return Mtt=function(s,r,a,o,h,l){var u=t(s,r-o,a-o,2*o,2*o,h,l);if(0===u.length)return u;for(var c=new e(r,a,o),d=new e,f=[],p=0;p<u.length;p++){var g=u[p];g.isCircle?(d.setTo(g.center.x,g.center.y,g.halfWidth),i(c,d)&&f.push(g)):n(c,g)&&f.push(g)}return f}}function rnt(){if(Dtt)return Ftt;Dtt=1;return Ftt={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,i){return this.body.setSize(t,e,i),this},setBodySize:function(t,e,i){return this.body.setSize(t,e,i),this},setCircle:function(t,e,i){return this.body.setCircle(t,e,i),this}}}function ant(){if(ktt)return Itt;ktt=1;return Itt={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}}}function ont(){return Ntt?Btt:(Ntt=1,Btt={Acceleration:jit(),Angular:qit(),Bounce:Kit(),Collision:Jit(),Debug:$it(),Drag:Qit(),Enable:ytt?mtt:(ytt=1,mtt={setDirectControl:function(t){return this.body.setDirectControl(t),this},enableBody:function(t,e,i,n,s){return t&&this.body.reset(e,i),n&&(this.body.gameObject.active=!0),s&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}}),Friction:tnt(),Gravity:ent(),Immovable:Ett?Stt:(Ett=1,Stt={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}}),Mass:int(),OverlapCirc:snt(),OverlapRect:nnt(),Pushable:Ott?Ltt:(Ott=1,Ltt={setPushable:function(t){return void 0===t&&(t=!0),this.body.pushable=t,this}}),Size:rnt(),Velocity:ant()})}function hnt(){if(Utt)return ztt;Utt=1;var t=Kh(),e=ont(),i=QV(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return ztt=n}function lnt(){if(Xtt)return Ytt;Xtt=1;var t=Kh(),e=ont(),i=tq(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return Ytt=n}function unt(){return aet?ret:(aet=1,ret={COLLIDE:Wtt?Gtt:(Wtt=1,Gtt="collide"),OVERLAP:Vtt?Htt:(Vtt=1,Htt="overlap"),PAUSE:qtt?jtt:(qtt=1,jtt="pause"),RESUME:Ztt?Ktt:(Ztt=1,Ktt="resume"),TILE_COLLIDE:$tt?Jtt:($tt=1,Jtt="tilecollide"),TILE_OVERLAP:tet?Qtt:(tet=1,Qtt="tileoverlap"),WORLD_BOUNDS:iet?eet:(iet=1,eet="worldbounds"),WORLD_STEP:set?net:(set=1,net="worldstep")})}function cnt(){if(het)return oet;het=1;return oet=function(t,e){return void 0===e&&(e={}),e.none=t,e.up=!1,e.down=!1,e.left=!1,e.right=!1,t||(e.up=!0,e.down=!0,e.left=!0,e.right=!0),e},oet}function dnt(){if(cet)return uet;cet=1;var t=Kh(),e=Jit(),i=Vit(),n=unt(),s=JG(),r=Ju(),a=zu(),o=cnt(),h=qu(),l=new t({Mixins:[e],initialize:function(t,e){var n=64,s=64,a=void 0!==e;a&&e.displayWidth&&(n=e.displayWidth,s=e.displayHeight),a||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=a?e:void 0,this.isBody=!0,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new h,this.position=new h(e.x-e.scaleX*e.displayOriginX,e.y-e.scaleY*e.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=s,this.sourceWidth=n,this.sourceHeight=s,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(s/2),this.center=new h(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new h,this.newVelocity=new h,this.deltaMax=new h,this.acceleration=new h,this.allowDrag=!0,this.drag=new h,this.allowGravity=!0,this.gravity=new h,this.bounce=new h,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new h(1e4,1e4),this.maxSpeed=-1,this.friction=new h(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=i.FACING_NONE,this.immovable=!1,this.pushable=!0,this.slideFactor=new h(1,1),this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=o(!1),this.touching=o(!0),this.wasTouching=o(!0),this.blocked=o(!0),this.syncBounds=!1,this.physicsType=i.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new r,this.directControl=!1,this.autoFrame=this.position.clone()},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var i=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=i.tx,e.y=i.ty,e.rotation=s(i.rotation),e.scaleX=i.scaleX,e.scaleY=i.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var n=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,n=!0}else{var a=Math.abs(e.scaleX),o=Math.abs(e.scaleY);this._sx===a&&this._sy===o||(this.width=this.sourceWidth*a,this.height=this.sourceHeight*o,this._sx=a,this._sy=o,n=!0)}n&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var t=this.transform;this.position.x=t.x+t.scaleX*(this.offset.x-t.displayOriginX),this.position.y=t.y+t.scaleY*(this.offset.y-t.displayOriginY),this.updateCenter()},resetFlags:function(t){void 0===t&&(t=!1);var e=this.wasTouching,i=this.touching,n=this.blocked;t?o(!0,e):(e.none=i.none,e.up=i.up,e.down=i.down,e.left=i.left,e.right=i.right),o(!0,i),o(!0,n),this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){if(t&&this.resetFlags(),this.gameObject&&this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves){var i=this.position;this.prev.x=i.x,this.prev.y=i.y,this.prevFrame.x=i.x,this.prevFrame.y=i.y}t&&this.update(e)},update:function(t){var e=this.prev,i=this.position,s=this.velocity;if(e.set(i.x,i.y),!this.moves)return this._dx=i.x-e.x,void(this._dy=i.y-e.y);if(this.directControl){var r=this.autoFrame;s.set((i.x-r.x)/t,(i.y-r.y)/t),this.world.updateMotion(this,t),this._dx=i.x-r.x,this._dy=i.y-r.y}else this.world.updateMotion(this,t),this.newVelocity.set(s.x*t,s.y*t),i.add(this.newVelocity),this._dx=i.x-e.x,this._dy=i.y-e.y;var a=s.x,o=s.y;if(this.updateCenter(),this.angle=Math.atan2(o,a),this.speed=Math.sqrt(a*a+o*o),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds){var h=this.blocked;this.world.emit(n.WORLD_BOUNDS,this,h.up,h.down,h.left,h.right)}},postUpdate:function(){var t=this.position,e=t.x-this.prevFrame.x,n=t.y-this.prevFrame.y,s=this.gameObject;if(this.moves){var r=this.deltaMax.x,a=this.deltaMax.y;0!==r&&0!==e&&(e<0&&e<-r?e=-r:e>0&&e>r&&(e=r)),0!==a&&0!==n&&(n<0&&n<-a?n=-a:n>0&&n>a&&(n=a)),s&&(s.x+=e,s.y+=n)}e<0?this.facing=i.FACING_LEFT:e>0&&(this.facing=i.FACING_RIGHT),n<0?this.facing=i.FACING_UP:n>0&&(this.facing=i.FACING_DOWN),this.allowRotation&&s&&(s.angle+=this.deltaZ()),this._tx=e,this._ty=n,this.autoFrame.set(t.x,t.y)},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.velocity,i=this.blocked,n=this.customBoundsRectangle,s=this.world.checkCollision,r=this.worldBounce?-this.worldBounce.x:-this.bounce.x,a=this.worldBounce?-this.worldBounce.y:-this.bounce.y,o=!1;return t.x<n.x&&s.left?(t.x=n.x,e.x*=r,i.left=!0,o=!0):this.right>n.right&&s.right&&(t.x=n.right-this.width,e.x*=r,i.right=!0,o=!0),t.y<n.y&&s.up?(t.y=n.y,e.y*=a,i.up=!0,o=!0):this.bottom>n.bottom&&s.down&&(t.y=n.bottom-this.height,e.y*=a,i.down=!0,o=!0),o&&(this.blocked.none=!1,this.updateCenter()),o},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this},setGameObject:function(t,e){if(void 0===e&&(e=!0),!t||!t.hasTransformComponent)return this;var i=this.world;return this.gameObject&&this.gameObject.body&&(i.disable(this.gameObject),this.gameObject.body=null),t.body&&i.disable(t),this.gameObject=t,t.body=this,this.setSize(),this.enable=e,this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&(!t&&n.frame&&(t=n.frame.realWidth),!e&&n.frame&&(e=n.frame.realHeight)),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),i&&n&&n.getCenter){var s=(n.width-t)/2,r=(n.height-e)/2;this.offset.set(s,r)}return this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var i=this.gameObject;i&&(i.setPosition(t,e),this.rotation=i.angle,this.preRotation=i.angle);var n=this.position;i&&i.getTopLeft?i.getTopLeft(n):n.set(t,e),this.prev.copy(n),this.prevFrame.copy(n),this.autoFrame.copy(n),i&&this.updateBounds(),this.updateCenter(),this.collideWorldBounds&&this.checkWorldBounds(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:a(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(i,n,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(i,n,i+this.velocity.x/2,n+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setDirectControl:function(t){return void 0===t&&(t=!0),this.directControl=t,this},setCollideWorldBounds:function(t,e,i,n){void 0===t&&(t=!0),this.collideWorldBounds=t;var s=void 0!==e,r=void 0!==i;return(s||r)&&(this.worldBounce||(this.worldBounce=new h),s&&(this.worldBounce.x=e),r&&(this.worldBounce.y=i)),void 0!==n&&(this.onWorldBounds=n),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){return this.setVelocity(t,this.velocity.y)},setVelocityY:function(t){return this.setVelocity(this.velocity.x,t)},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxVelocityX:function(t){return this.maxVelocity.x=t,this},setMaxVelocityY:function(t){return this.maxVelocity.y=t,this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setSlideFactor:function(t,e){return this.slideFactor.set(t,e),this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDamping:function(t){return this.useDamping=t,this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},processX:function(t,e,i,n){this.x+=t,this.updateCenter(),null!==e&&(this.velocity.x=e*this.slideFactor.x);var s=this.blocked;i&&(s.left=!0,s.none=!1),n&&(s.right=!0,s.none=!1)},processY:function(t,e,i,n){this.y+=t,this.updateCenter(),null!==e&&(this.velocity.y=e*this.slideFactor.y);var s=this.blocked;i&&(s.up=!0,s.none=!1),n&&(s.down=!0,s.none=!1)},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return uet=l}function fnt(){if(fet)return det;fet=1;var t=lnt(),e=Kh(),i=Jit(),n=Vit(),s=jh(),r=eq(),a=ih(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){if(o||h)if(a(o))h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler;else if(Array.isArray(o)&&a(o[0])){var l=this;o.forEach(function(e){e.internalCreateCallback=l.createCallbackHandler,e.internalRemoveCallback=l.removeCallbackHandler,e.classType=s(e,"classType",t)}),h=null}else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};this.world=e,h&&(h.classType=s(h,"classType",t)),this.physicsType=n.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=2147483647,this.defaults={setCollideWorldBounds:s(h,"collideWorldBounds",!1),setBoundsRectangle:s(h,"customBoundsRectangle",null),setAccelerationX:s(h,"accelerationX",0),setAccelerationY:s(h,"accelerationY",0),setAllowDrag:s(h,"allowDrag",!0),setAllowGravity:s(h,"allowGravity",!0),setAllowRotation:s(h,"allowRotation",!0),setDamping:s(h,"useDamping",!1),setBounceX:s(h,"bounceX",0),setBounceY:s(h,"bounceY",0),setDragX:s(h,"dragX",0),setDragY:s(h,"dragY",0),setEnable:s(h,"enable",!0),setGravityX:s(h,"gravityX",0),setGravityY:s(h,"gravityY",0),setFrictionX:s(h,"frictionX",0),setFrictionY:s(h,"frictionY",0),setMaxSpeed:s(h,"maxSpeed",-1),setMaxVelocityX:s(h,"maxVelocityX",1e4),setMaxVelocityY:s(h,"maxVelocityY",1e4),setVelocityX:s(h,"velocityX",0),setVelocityY:s(h,"velocityY",0),setAngularVelocity:s(h,"angularVelocity",0),setAngularAcceleration:s(h,"angularAcceleration",0),setAngularDrag:s(h,"angularDrag",0),setMass:s(h,"mass",1),setImmovable:s(h,"immovable",!1)},r.call(this,i,o,h),this.type="PhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.DYNAMIC_BODY);var e=t.body;for(var i in this.defaults)e[i](this.defaults[i])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,i){void 0===i&&(i=0);for(var n=this.getChildren(),s=0;s<n.length;s++)n[s].body.velocity.set(t+s*i,e+s*i);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.x=t+n*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.y=t+n*e;return this}});return det=o}function pnt(){if(get)return pet;get=1;var t=Zh(),e=Kh(),i=Jit(),n=Vit(),s=zu(),r=cnt(),a=qu(),o=new e({Mixins:[i],initialize:function(t,e){var i=64,s=64,o=void 0!==e;o&&e.displayWidth&&(i=e.displayWidth,s=e.displayHeight),o||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=o?e:void 0,this.isBody=!0,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new a,this.position=new a(e.x-i*e.originX,e.y-s*e.originY),this.width=i,this.height=s,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new a(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=a.ZERO,this.allowGravity=!1,this.gravity=a.ZERO,this.bounce=a.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=r(!1),this.touching=r(!0),this.wasTouching=r(!0),this.blocked=r(!0),this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._dx=0,this._dy=0},setGameObject:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),!t||!t.hasTransformComponent)return this;var n=this.world;return this.gameObject&&this.gameObject.body&&(n.disable(this.gameObject),this.gameObject.body=null),t.body&&n.disable(t),this.gameObject=t,t.body=this,this.setSize(),e&&this.updateFromGameObject(),this.enable=i,this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&n.frame&&(t||(t=n.frame.realWidth),e||(e=n.frame.realHeight)),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),i&&n&&n.getCenter){var s=n.displayWidth/2,r=n.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(s-this.halfWidth,r-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var i=this.gameObject;void 0===t&&(t=i.x),void 0===e&&(e=i.y),this.world.staticTree.remove(this),i.setPosition(t,e),i.getTopLeft(this.position),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(e,i){return this.isCircle?t(this,e,i):s(this,e,i)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(i,n,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return pet=o}function gnt(){if(met)return vet;met=1;var t=lnt(),e=Kh(),i=Jit(),n=Vit(),s=jh(),r=eq(),a=ih(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){o||h?a(o)?(h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler,h.createMultipleCallback=this.createMultipleCallbackHandler,h.classType=s(h,"classType",t)):Array.isArray(o)&&a(o[0])?(h=o,o=null,h.forEach(function(e){e.internalCreateCallback=this.createCallbackHandler,e.internalRemoveCallback=this.removeCallbackHandler,e.createMultipleCallback=this.createMultipleCallbackHandler,e.classType=s(e,"classType",t)})):h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:t},this.world=e,this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,r.call(this,i,o,h),this.type="StaticPhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});return vet=o}function vnt(){if(xet)return yet;xet=1;var t=hnt(),e=lnt(),i=dnt(),n=Kh(),s=Vit(),r=fnt(),a=pnt(),o=gnt(),h=new n({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,i,n,s){return this.world.addCollider(t,e,i,n,s)},overlap:function(t,e,i,n,s){return this.world.addOverlap(t,e,i,n,s)},existing:function(t,e){var i=e?s.STATIC_BODY:s.DYNAMIC_BODY;return this.world.enableBody(t,i),t},staticImage:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},image:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticSprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},sprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticGroup:function(t,e){return this.sys.updateList.add(new o(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new r(this.world,this.world.scene,t,e))},body:function(t,e,n,r){var a=new i(this.world);return a.position.set(t,e),n&&r&&a.setSize(n,r),this.world.add(a,s.DYNAMIC_BODY),a},staticBody:function(t,e,i,n){var r=new a(this.world);return r.position.set(t,e),i&&n&&r.setSize(i,n),this.world.add(r,s.STATIC_BODY),r},destroy:function(){this.world=null,this.scene=null,this.sys=null}});return yet=h}function mnt(){if(bet)return wet;bet=1;var t=new(Kh())({initialize:function(t,e,i,n,s,r,a){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=i,this.object2=n,this.collideCallback=s,this.processCallback=r,this.callbackContext=a},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});return wet=t}function ynt(){if(Eet)return Tet;Eet=1;var t=Vit();return Tet=function(e,i,n,s){var r=0,a=e.deltaAbsX()+i.deltaAbsX()+s;return 0===e._dx&&0===i._dx?(e.embedded=!0,i.embedded=!0):e._dx>i._dx?(r=e.right-i.x)>a&&!n||!1===e.checkCollision.right||!1===i.checkCollision.left?r=0:(e.touching.none=!1,e.touching.right=!0,i.touching.none=!1,i.touching.left=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.right=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.left=!0)):e._dx<i._dx&&(-(r=e.x-i.width-i.x)>a&&!n||!1===e.checkCollision.left||!1===i.checkCollision.right?r=0:(e.touching.none=!1,e.touching.left=!0,i.touching.none=!1,i.touching.right=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.left=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.right=!0))),e.overlapX=r,i.overlapX=r,r}}function xnt(){if(Cet)return _et;Cet=1;var t=Vit();return _et=function(e,i,n,s){var r=0,a=e.deltaAbsY()+i.deltaAbsY()+s;return 0===e._dy&&0===i._dy?(e.embedded=!0,i.embedded=!0):e._dy>i._dy?(r=e.bottom-i.y)>a&&!n||!1===e.checkCollision.down||!1===i.checkCollision.up?r=0:(e.touching.none=!1,e.touching.down=!0,i.touching.none=!1,i.touching.up=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.down=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.up=!0)):e._dy<i._dy&&(-(r=e.y-i.bottom)>a&&!n||!1===e.checkCollision.up||!1===i.checkCollision.down?r=0:(e.touching.none=!1,e.touching.up=!0,i.touching.none=!1,i.touching.down=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.up=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.down=!0))),e.overlapY=r,i.overlapY=r,r}}function wnt(){if(Pet)return Aet;Pet=1;var t=jh();return Aet=function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=a.width),void 0===s&&(s=a.height),r||(r={});var o=t(r,"isNotEmpty",!1),h=t(r,"isColliding",!1),l=t(r,"hasInterestingFace",!1);e<0&&(n+=e,e=0),i<0&&(s+=i,i=0),e+n>a.width&&(n=Math.max(a.width-e,0)),i+s>a.height&&(s=Math.max(a.height-i,0));for(var u=[],c=i;c<i+s;c++)for(var d=e;d<e+n;d++){var f=a.data[c][d];if(null!==f){if(o&&-1===f.index)continue;if(h&&!f.collides)continue;if(l&&!f.hasInterestingFace)continue;u.push(f)}}return u}}function bnt(){if(Ret)return Met;Ret=1;var t=wnt(),e=qu(),i=new e,n=new e;return Met=function(e,s,r,a,o,h,l){var u=l.tilemapLayer.tilemap._convert.WorldToTileXY;u(e,s,!0,i,h,l);var c=i.x,d=i.y;u(e+r,s+a,!1,n,h,l);var f=Math.ceil(n.x),p=Math.ceil(n.y);return t(c,d,f-c,p-d,o,l)}}function Tnt(){if(Oet)return Let;Oet=1;return Let=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)}}function Snt(){if(Det)return Fet;Det=1;var t=Hl();function e(t){if(!(this instanceof e))return new e(t);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function n(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,s){s||(s=p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var a,o=e;o<i;o++)a=t.children[o],r(s,t.leaf?n(a):a);return s}function r(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,s,r){for(var a,o=[i,n];o.length;)(n=o.pop())-(i=o.pop())<=s||(a=i+Math.ceil((n-i)/s/2)*s,t(e,a,i,n,r),o.push(i,a,a,n))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!f(t,e))return i;for(var s,r,a,o,h=[];e;){for(s=0,r=e.children.length;s<r;s++)a=e.children[s],f(t,o=e.leaf?n(a):a)&&(e.leaf?i.push(a):d(t,o)?this._all(a,i):h.push(a));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!f(t,e))return!1;for(var n,s,r,a,o=[];e;){for(n=0,s=e.children.length;n<s;n++)if(r=e.children[n],f(t,a=e.leaf?i(r):r)){if(e.leaf||d(t,a))return!0;o.push(r)}e=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,s,r,a,o=this.data,h=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],n=u.pop(),a=!0),o.leaf&&-1!==(r=i(t,o.children,e)))return o.children.splice(r,1),l.push(o),this._condense(l),this;a||o.leaf||!d(o,h)?s?(n++,o=s.children[n],a=!1):o=null:(l.push(o),u.push(n),n=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:a,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var r,a=i-e+1,o=this._maxEntries;if(a<=o)return n(r=p(t.slice(e,i+1)),this.toBBox),r;s||(s=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,s-1))),(r=p([])).leaf=!1,r.height=s;var h,l,u,c,d=Math.ceil(a/o),f=d*Math.ceil(Math.sqrt(o));for(g(t,e,i,f,this.compareMinX),h=e;h<=i;h+=f)for(g(t,h,u=Math.min(h+f-1,i),d,this.compareMinY),l=h;l<=u;l+=d)c=Math.min(l+d-1,u),r.children.push(this._build(t,l,c,s-1));return n(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var s,r,a,o,l,c,d,f;n.push(e),!e.leaf&&n.length-1!==i;){for(d=f=1/0,s=0,r=e.children.length;s<r;s++)l=h(a=e.children[s]),(c=u(t,a)-l)<f?(f=c,d=l<d?l:d,o=a):c===f&&l<d&&(d=l,o=a);e=o||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,s=i?t:n(t),a=[],o=this._chooseSubtree(s,this.data,e,a);for(o.children.push(t),r(o,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)},_split:function(t,e){var i=t[e],s=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,s);var a=this._chooseSplitIndex(i,r,s),o=p(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,n(i,this.toBBox),n(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,a,o,l,u,d,f;for(u=d=1/0,n=e;n<=i-e;n++)o=c(r=s(t,0,n,this.toBBox),a=s(t,n,i,this.toBBox)),l=h(r)+h(a),o<u?(u=o,f=n,d=l<d?l:d):o===u&&l<d&&(d=l,f=n);return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:a,s=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var a,o,h=this.toBBox,u=s(t,0,e,h),c=s(t,i-e,i,h),d=l(u)+l(c);for(a=e;a<i-e;a++)o=t.children[a],r(u,t.leaf?h(o):o),d+=l(u);for(a=i-e-1;a>=e;a--)o=t.children[a],r(c,t.leaf?h(o):o),d+=l(c);return d},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)r(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():n(t[i],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},Fet=e}function Ent(){if(ket)return Iet;ket=1;return Iet=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,t.updateCenter(),0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x}}function _nt(){if(Net)return Bet;Net=1;var t=Ent();return Bet=function(e,i,n,s,r,a){var o=0,h=i.faceLeft,l=i.faceRight,u=i.collideLeft,c=i.collideRight;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaX()<0&&c&&e.checkCollision.left?l&&e.x<s&&(o=e.x-s)<-r&&(o=0):e.deltaX()>0&&u&&e.checkCollision.right&&h&&e.right>n&&(o=e.right-n)>r&&(o=0),0!==o&&(e.customSeparateX?e.overlapX=o:t(e,o)),o}}function Cnt(){if(Uet)return zet;Uet=1;return zet=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,t.updateCenter(),0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y}}function Ant(){if(Xet)return Yet;Xet=1;var t=Cnt();return Yet=function(e,i,n,s,r,a){var o=0,h=i.faceTop,l=i.faceBottom,u=i.collideUp,c=i.collideDown;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaY()<0&&c&&e.checkCollision.up?l&&e.y<s&&(o=e.y-s)<-r&&(o=0):e.deltaY()>0&&u&&e.checkCollision.down&&h&&e.bottom>n&&(o=e.bottom-n)>r&&(o=0),0!==o&&(e.customSeparateY?e.overlapY=o:t(e,o)),o}}function Pnt(){if(Wet)return Get;Wet=1;return Get=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)}}function Mnt(){if(Vet)return Het;Vet=1;var t=_nt(),e=Ant(),i=Pnt();return Het=function(n,s,r,a,o,h,l){var u=a.left,c=a.top,d=a.right,f=a.bottom,p=r.faceLeft||r.faceRight,g=r.faceTop||r.faceBottom;if(l||(p=!0,g=!0),!p&&!g)return!1;var v=0,m=0,y=0,x=1;if(s.deltaAbsX()>s.deltaAbsY()?y=-1:s.deltaAbsX()<s.deltaAbsY()&&(x=-1),0!==s.deltaX()&&0!==s.deltaY()&&p&&g&&(y=Math.min(Math.abs(s.position.x-d),Math.abs(s.right-u)),x=Math.min(Math.abs(s.position.y-f),Math.abs(s.bottom-c))),y<x){if(p&&0!==(v=t(s,r,u,d,h,l))&&!i(a,s))return!0;g&&(m=e(s,r,c,f,h,l))}else{if(g&&0!==(m=e(s,r,c,f,h,l))&&!i(a,s))return!0;p&&(v=t(s,r,u,d,h,l))}return 0!==v||0!==m}}function Rnt(){if(qet)return jet;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v;qet=1;var m=function(){return l&&p&&e.blocked.right?(t.processX(-v,a,!1,!0),1):h&&g&&e.blocked.left?(t.processX(v,a,!0),1):d&&g&&t.blocked.right?(e.processX(-v,o,!1,!0),2):c&&p&&t.blocked.left?(e.processX(v,o,!0),2):0},y=function(p){if(i&&n)v*=.5,0===p||3===p?(t.processX(v,s),e.processX(-v,r)):(t.processX(-v,s),e.processX(v,r));else if(i&&!n)0===p||3===p?t.processX(v,a,!0):t.processX(-v,a,!1,!0);else if(!i&&n)0===p||3===p?e.processX(-v,o,!1,!0):e.processX(v,o,!0);else{var g=.5*v;0===p?f?(t.processX(v,0,!0),e.processX(0,null,!1,!0)):d?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.x,!0),e.processX(-g,null,!1,!0)):1===p?u?(t.processX(0,null,!1,!0),e.processX(v,0,!0)):l?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,null,!1,!0),e.processX(g,t.velocity.x,!0)):2===p?f?(t.processX(-v,0,!1,!0),e.processX(0,null,!0)):c?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,e.velocity.x,!1,!0),e.processX(g,null,!0)):3===p&&(u?(t.processX(0,null,!0),e.processX(-v,0,!1,!0)):h?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.y,!0),e.processX(-g,null,!1,!0)))}return!0};return jet={BlockCheck:m,Check:function(){var i=t.velocity.x,n=e.velocity.x,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.x,r=u+o*e.bounce.x,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.x,w=e.velocity.x;return i=t.pushable,h=t._dx<0,l=t._dx>0,u=0===t._dx,p=Math.abs(t.right-e.x)<=Math.abs(e.right-t.x),a=w-x*t.bounce.x,n=e.pushable,c=e._dx<0,d=e._dx>0,f=0===e._dx,g=!p,o=x-w*e.bounce.x,v=Math.abs(y),m()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.x=0:p?e.processX(v,o,!0):e.processX(-v,o,!1,!0),t.moves){var n=t.directControl?t.y-t.autoFrame.y:t.y-t.prev.y;e.y+=n*t.friction.y,e._dy=e.y-e.prev.y}},RunImmovableBody2:function(i){if(2===i?t.velocity.x=0:g?t.processX(v,a,!0):t.processX(-v,a,!1,!0),e.moves){var n=e.directControl?e.y-e.autoFrame.y:e.y-e.prev.y;t.y+=n*e.friction.y,t._dy=t.y-t.prev.y}}}}function Lnt(){if(Zet)return Ket;Zet=1;var t=ynt(),e=Rnt();return Ket=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateX||n.customSeparateX)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function Ont(){if($et)return Jet;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v;$et=1;var m=function(){return l&&p&&e.blocked.down?(t.processY(-v,a,!1,!0),1):h&&g&&e.blocked.up?(t.processY(v,a,!0),1):d&&g&&t.blocked.down?(e.processY(-v,o,!1,!0),2):c&&p&&t.blocked.up?(e.processY(v,o,!0),2):0},y=function(p){if(i&&n)v*=.5,0===p||3===p?(t.processY(v,s),e.processY(-v,r)):(t.processY(-v,s),e.processY(v,r));else if(i&&!n)0===p||3===p?t.processY(v,a,!0):t.processY(-v,a,!1,!0);else if(!i&&n)0===p||3===p?e.processY(-v,o,!1,!0):e.processY(v,o,!0);else{var g=.5*v;0===p?f?(t.processY(v,0,!0),e.processY(0,null,!1,!0)):d?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)):1===p?u?(t.processY(0,null,!1,!0),e.processY(v,0,!0)):l?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,null,!1,!0),e.processY(g,t.velocity.y,!0)):2===p?f?(t.processY(-v,0,!1,!0),e.processY(0,null,!0)):c?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,e.velocity.y,!1,!0),e.processY(g,null,!0)):3===p&&(u?(t.processY(0,null,!0),e.processY(-v,0,!1,!0)):h?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)))}return!0};return Jet={BlockCheck:m,Check:function(){var i=t.velocity.y,n=e.velocity.y,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.y,r=u+o*e.bounce.y,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.y,w=e.velocity.y;return i=t.pushable,h=t._dy<0,l=t._dy>0,u=0===t._dy,p=Math.abs(t.bottom-e.y)<=Math.abs(e.bottom-t.y),a=w-x*t.bounce.y,n=e.pushable,c=e._dy<0,d=e._dy>0,f=0===e._dy,g=!p,o=x-w*e.bounce.y,v=Math.abs(y),m()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.y=0:p?e.processY(v,o,!0):e.processY(-v,o,!1,!0),t.moves){var n=t.directControl?t.x-t.autoFrame.x:t.x-t.prev.x;e.x+=n*t.friction.x,e._dx=e.x-e.prev.x}},RunImmovableBody2:function(i){if(2===i?t.velocity.y=0:g?t.processY(v,a,!0):t.processY(-v,a,!1,!0),e.moves){var n=e.directControl?e.x-e.autoFrame.x:e.x-e.prev.x;t.x+=n*e.friction.x,t._dx=t.x-t.prev.x}}}}function Fnt(){if(tit)return Qet;tit=1;var t=xnt(),e=Ont();return Qet=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateY||n.customSeparateY)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function Dnt(){if(iit)return eit;iit=1;var t=ZX(),e=dnt(),i=tl(),n=Kh(),s=mnt(),r=Vit(),a=LY(),o=TU(),h=cU(),l=unt(),u=ju(),c=mG(),d=yG(),f=ynt(),p=xnt(),g=bnt(),v=Vl(),m=il(),y=vj(),x=Tnt(),w=Ju(),b=Snt(),T=Mnt(),S=Lnt(),E=Fnt(),_=$j(),C=pnt(),A=Pnt(),P=yc(),M=qu(),R=wc(),L=new n({Extends:h,initialize:function(t,e){h.call(this),this.scene=t,this.bodies=new _,this.staticBodies=new _,this.pendingDestroy=new _,this.colliders=new y,this.gravity=new M(v(e,"gravity.x",0),v(e,"gravity.y",0)),this.bounds=new w(v(e,"x",0),v(e,"y",0),v(e,"width",t.sys.scale.width),v(e,"height",t.sys.scale.height)),this.checkCollision={up:v(e,"checkCollision.up",!0),down:v(e,"checkCollision.down",!0),left:v(e,"checkCollision.left",!0),right:v(e,"checkCollision.right",!0)},this.fps=v(e,"fps",60),this.fixedStep=v(e,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=v(e,"timeScale",1),this.OVERLAP_BIAS=v(e,"overlapBias",4),this.TILE_BIAS=v(e,"tileBias",16),this.forceX=v(e,"forceX",!1),this.isPaused=v(e,"isPaused",!1),this._total=0,this.drawDebug=v(e,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:v(e,"debugShowBody",!0),debugShowStaticBody:v(e,"debugShowStaticBody",!0),debugShowVelocity:v(e,"debugShowVelocity",!0),bodyDebugColor:v(e,"debugBodyColor",16711935),staticBodyDebugColor:v(e,"debugStaticBodyColor",255),velocityDebugColor:v(e,"debugVelocityColor",65280)},this.maxEntries=v(e,"maxEntries",16),this.useTree=v(e,"useTree",!0),this.tree=new b(this.maxEntries),this.staticTree=new b(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new P,this._tempMatrix2=new P,this.tileFilterOptions={isColliding:!0,isNotEmpty:!0,hasInterestingFace:!0},this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=r.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];if(n.isParent)for(var s=n.getChildren(),a=0;a<s.length;a++){var o=s[a];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(n,e)}},enableBody:function(t,i){return void 0===i&&(i=r.DYNAMIC_BODY),t.hasTransformComponent&&(t.body||(i===r.DYNAMIC_BODY?t.body=new e(this,t):i===r.STATIC_BODY&&(t.body=new C(this,t))),this.add(t.body)),t},add:function(t){return t.physicsType===r.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===r.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];if(i.isParent)for(var n=i.getChildren(),s=0;s<n.length;s++){var r=n[s];r.isParent?this.disable(r):this.disableBody(r.body)}else this.disableBody(i.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===r.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===r.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,i,n,s,r,a,o){return this.bounds.setTo(t,e,i,n),void 0!==s&&this.setBoundsCollision(s,r,a,o),this},setBoundsCollision:function(t,e,i,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=i,this.checkCollision.down=n,this},pause:function(){return this.isPaused=!0,this.emit(l.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(l.RESUME),this},addCollider:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!1,t,e,i,n,r);return this.colliders.add(a),a},addOverlap:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!0,t,e,i,n,r);return this.colliders.add(a),a},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var i,n,s=this._frameTime,r=this._frameTimeMS*this.timeScale;this._elapsed+=e;var a=this.bodies.entries,o=this._elapsed>=r;for(this.fixedStep||(s=.001*e,o=!0,this._elapsed=0),i=0;i<a.length;i++)(n=a[i]).enable&&n.preUpdate(o,s);if(o){this._elapsed-=r,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(a));var h=this.colliders.update();for(i=0;i<h.length;i++){var u=h[i];u.active&&u.update()}this.emit(l.WORLD_STEP,s)}for(;this._elapsed>=r;)this._elapsed-=r,this.step(s)}},step:function(t){var e,i,n=this.bodies.entries,s=n.length;for(e=0;e<s;e++)(i=n[e]).enable&&i.update(t);this.useTree&&(this.tree.clear(),this.tree.load(n));var r=this.colliders.update();for(e=0;e<r.length;e++){var a=r[e];a.active&&a.update()}this.emit(l.WORLD_STEP,t),this.stepsLastFrame++},singleStep:function(){this.update(0,this._frameTimeMS),this.postUpdate()},postUpdate:function(){var t,e,i=this.bodies.entries,n=i.length,s=this.bodies,a=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<n;t++)(e=i[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o);for(n=(i=a.entries).length,t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o)}var h=this.pendingDestroy;if(h.size>0){var l=this.tree,u=this.staticTree;for(n=(i=h.entries).length,t=0;t<n;t++)(e=i[t]).physicsType===r.DYNAMIC_BODY?(l.remove(e),s.delete(e)):e.physicsType===r.STATIC_BODY&&(u.remove(e),a.delete(e)),e.world=void 0,e.gameObject=void 0;h.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,s=t.angularAcceleration,r=t.angularDrag,a=t.maxAngular;s?n+=s*e:t.allowDrag&&r&&(c(n-(r*=e),0,.1)?n-=r:d(n+r,0,.1)?n+=r:n=0);var o=(n=i(n,-a,a))-t.angularVelocity;t.angularVelocity+=o,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,s=t.acceleration.x,r=t.drag.x,a=t.maxVelocity.x,o=t.velocity.y,h=t.acceleration.y,l=t.drag.y,f=t.maxVelocity.y,p=t.speed,g=t.maxSpeed,v=t.allowDrag,m=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,o+=(this.gravity.y+t.gravity.y)*e),s?n+=s*e:v&&r&&(m?(n*=r=Math.pow(r,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(n=0)):c(n-(r*=e),0,.01)?n-=r:d(n+r,0,.01)?n+=r:n=0),h?o+=h*e:v&&l&&(m?(o*=l=Math.pow(l,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(o=0)):c(o-(l*=e),0,.01)?o-=l:d(o+l,0,.01)?o+=l:o=0),n=i(n,-a,a),o=i(o,-f,f),t.velocity.set(n,o),g>-1&&t.velocity.length()>g&&(t.velocity.normalize().scale(g),p=g),t.speed=p},separate:function(t,e,i,n,s){var r,a,o=!1,h=!0;if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e)||0===(t.collisionMask&e.collisionCategory)||0===(e.collisionMask&t.collisionCategory))return o;if(i&&!1===i.call(n,t.gameObject||t,e.gameObject||e))return o;if(t.isCircle||e.isCircle){var u=this.separateCircle(t,e,s);u.result?(o=!0,h=!1):(r=u.x,a=u.y,h=!0)}if(h){var c=!1,d=!1,f=this.OVERLAP_BIAS;s?(c=S(t,e,s,f,r),d=E(t,e,s,f,a)):this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(c=S(t,e,s,f,r),this.intersects(t,e)&&(d=E(t,e,s,f,a))):(d=E(t,e,s,f,a),this.intersects(t,e)&&(c=S(t,e,s,f,r))),o=c||d}return o&&(s?(t.onOverlap||e.onOverlap)&&this.emit(l.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(l.COLLIDE,t.gameObject,e.gameObject,t,e)),o},separateCircle:function(e,i,n){f(e,i,!1,0),p(e,i,!1,0);var s=e.isCircle,r=i.isCircle,h=e.center,l=i.center,u=e.immovable,c=i.immovable,d=e.velocity,g=i.velocity,v=0,y=!0;if(s!==r){y=!1;var x=h.x,w=h.y,b=e.halfWidth,T=i.position.x,S=i.position.y,E=i.right,_=i.bottom;r&&(x=l.x,w=l.y,b=i.halfWidth,T=e.position.x,S=e.position.y,E=e.right,_=e.bottom),w<S?x<T?v=a(x,w,T,S)-b:x>E&&(v=a(x,w,E,S)-b):w>_&&(x<T?v=a(x,w,T,_)-b:x>E&&(v=a(x,w,E,_)-b)),v*=-1}else v=e.halfWidth+i.halfWidth-o(h,l);e.overlapR=v,i.overlapR=v;var C=t(h,l),A=(v+m.EPSILON)*Math.cos(C),P=(v+m.EPSILON)*Math.sin(C),M={overlap:v,result:!1,x:A,y:P};if(n&&(!y||y&&0!==v))return M.result=!0,M;if(!y&&0===v||u&&c||e.customSeparateX||i.customSeparateX)return M.x=void 0,M.y=void 0,M;var R=!e.pushable&&!i.pushable;if(y){var L=h.x-l.x,O=h.y-l.y,F=Math.sqrt(Math.pow(L,2)+Math.pow(O,2)),D=(l.x-h.x)/F||0,I=(l.y-h.y)/F||0,k=2*(d.x*D+d.y*I-g.x*D-g.y*I)/(e.mass+i.mass);!u&&!c&&e.pushable&&i.pushable||(k*=2),!u&&e.pushable&&(d.x=d.x-k/e.mass*D,d.y=d.y-k/e.mass*I,d.multiply(e.bounce)),!c&&i.pushable&&(g.x=g.x+k/i.mass*D,g.y=g.y+k/i.mass*I,g.multiply(i.bounce)),u||c||(A*=.5,P*=.5),(!u||e.pushable||R)&&(e.x-=A,e.y-=P,e.updateCenter()),(!c||i.pushable||R)&&(i.x+=A,i.y+=P,i.updateCenter()),M.result=!0}else u||!e.pushable&&!R||(e.x-=A,e.y-=P,e.updateCenter()),c||!i.pushable&&!R||(i.x+=A,i.y+=P,i.updateCenter()),M.x=void 0,M.y=void 0;return M},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?o(t.center,e.center)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.left||t.bottom<=e.top||t.left>=e.right||t.top>=e.bottom))},circleBodyIntersects:function(t,e){var n=i(t.center.x,e.left,e.right),s=i(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-s)*(t.center.y-s)<=t.halfWidth*t.halfWidth},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!1)},collideObjects:function(t,e,i,n,s,r){var a,o;!t.isParent||void 0!==t.physicsType&&void 0!==e&&t!==e||(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var h=Array.isArray(t),l=Array.isArray(e);if(this._total=0,h||l)if(!h&&l)for(a=0;a<e.length;a++)this.collideHandler(t,e[a],i,n,s,r);else if(h&&!l)if(e)for(a=0;a<t.length;a++)this.collideHandler(t[a],e,i,n,s,r);else for(a=0;a<t.length;a++){var u=t[a];for(o=a+1;o<t.length;o++)a!==o&&this.collideHandler(u,t[o],i,n,s,r)}else for(a=0;a<t.length;a++)for(o=0;o<e.length;o++)this.collideHandler(t[a],e[o],i,n,s,r);else this.collideHandler(t,e,i,n,s,r);return this._total>0},collideHandler:function(t,e,i,n,s,r){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,i,n,s,r);if(!t||!e)return!1;if(t.body||t.isBody){if(e.body||e.isBody)return this.collideSpriteVsSprite(t,e,i,n,s,r);if(e.isParent)return this.collideSpriteVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,i,n,s,r)}else if(t.isParent){if(e.body||e.isBody)return this.collideSpriteVsGroup(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,i,n,s,r)}else if(t.isTilemap){if(e.body||e.isBody)return this.collideSpriteVsTilemapLayer(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,i,n,s,r)}},canCollide:function(t,e){return t&&e&&0!==(t.collisionMask&e.collisionCategory)&&0!==(e.collisionMask&t.collisionCategory)},collideSpriteVsSprite:function(t,e,i,n,s,r){var a=t.isBody?t:t.body,o=e.isBody?e:e.body;return!!this.canCollide(a,o)&&(this.separate(a,o,n,s,r)&&(i&&i.call(s,t,e),this._total++),!0)},collideSpriteVsGroup:function(t,e,i,n,s,a){var o,h,l,u=t.isBody?t:t.body;if(0!==e.getLength()&&u&&u.enable&&!u.checkCollision.none&&this.canCollide(u,e))if(this.useTree||e.physicsType===r.STATIC_BODY){var c=this.treeMinMax;c.minX=u.left,c.minY=u.top,c.maxX=u.right,c.maxY=u.bottom;var d=e.physicsType===r.DYNAMIC_BODY?this.tree.search(c):this.staticTree.search(c);for(h=d.length,o=0;o<h;o++)u!==(l=d[o])&&l.enable&&!l.checkCollision.none&&e.contains(l.gameObject)&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}else{var f=e.getChildren(),p=e.children.entries.indexOf(t);for(h=f.length,o=0;o<h;o++)(l=f[o].body)&&o!==p&&l.enable&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,i,n,s,r){if(!this.canCollide(t,e))return!1;var a=t.getChildren();if(0===a.length)return!1;for(var o=!1,h=0;h<a.length;h++)(a[h].body||a[h].isBody)&&this.collideSpriteVsTilemapLayer(a[h],e,i,n,s,r)&&(o=!0);return o},collideTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!1,!1)},overlapTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,i,n,s,r){var a=t.isBody?t:t.body;if(!a.enable||a.checkCollision.none||!this.canCollide(a,e))return!1;var o=e.layer,h=a.x-o.tileWidth*e.scaleX,l=a.y-o.tileHeight*e.scaleY,u=a.width+o.tileWidth*e.scaleX,c=a.height+o.tileHeight*e.scaleY,d=r?null:this.tileFilterOptions,f=g(h,l,u,c,d,e.scene.cameras.main,e.layer);return 0!==f.length&&this.collideSpriteVsTilesHandler(t,f,i,n,s,r,!0)},collideSpriteVsTilesHandler:function(t,e,i,n,s,r,a){for(var o,h,u=t.isBody?t:t.body,c={left:0,right:0,top:0,bottom:0},d=!1,f=0;f<e.length;f++){var p=(h=(o=e[f]).tilemapLayer).tileToWorldXY(o.x,o.y);c.left=p.x,c.top=p.y,c.right=c.left+o.width*h.scaleX,c.bottom=c.top+o.height*h.scaleY,A(c,u)&&(!n||n.call(s,t,o))&&x(o,t)&&(r||T(f,u,o,c,h,this.TILE_BIAS,a))&&(this._total++,d=!0,i&&i.call(s,t,o),r&&u.onOverlap?this.emit(l.TILE_OVERLAP,t,o,u):u.onCollide&&this.emit(l.TILE_COLLIDE,t,o,u))}return d},collideGroupVsGroup:function(t,e,i,n,s,r){if(0!==t.getLength()&&0!==e.getLength()&&this.canCollide(t,e))for(var a=t.getChildren(),o=0;o<a.length;o++)this.collideSpriteVsGroup(a[o],e,i,n,s,r)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var i=0;i<t.length;i++)this.wrapObject(t[i],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=R(t.x,this.bounds.left-e,this.bounds.right+e),t.y=R(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null,this.debugGraphic&&(this.debugGraphic.destroy(),this.debugGraphic=null)}});return eit=L}function Int(){if(sit)return nit;sit=1;var t=Kh(),e=ac(),i=LY(),n=pG(),s=vnt(),r=jh(),a=GV(),o=snt(),h=nnt(),l=tc(),u=ec(),c=qu(),d=Dnt(),f=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this._category=1,t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.start,this)},boot:function(){this.world=new d(this.scene,this.config),this.add=new s(this.world),this.systems.events.once(u.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new d(this.scene,this.config),this.add=new s(this.world));var t=this.systems.events;r(this.config,"customUpdate",!1)||t.on(u.UPDATE,this.world.update,this.world),t.on(u.POST_UPDATE,this.world.postUpdate,this.world),t.once(u.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(u.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(u.UPDATE,this.world.update,this.world)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return a(r(e,"arcade",{}),r(t,"arcade",{}))},nextCategory:function(){return this._category=this._category<<1,this._category},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!1)},collideTiles:function(t,e,i,n,s){return this.world.collideTiles(t,e,i,n,s)},overlapTiles:function(t,e,i,n,s){return this.world.overlapTiles(t,e,i,n,s)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,i,n,s,r){void 0===n&&(n=60);var a=Math.atan2(i-t.y,e-t.x);return t.body.acceleration.setToPolar(a,n),void 0!==s&&void 0!==r&&t.body.maxVelocity.set(s,r),a},accelerateToObject:function(t,e,i,n,s){return this.accelerateTo(t,e.x,e.y,i,n,s)},closest:function(t,e){e||(e=this.world.bodies.entries);for(var i=Number.MAX_VALUE,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c<i&&(s=l,i=c)}}return s},furthest:function(t,e){e||(e=this.world.bodies.entries);for(var i=-1,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c>i&&(s=l,i=c)}}return s},moveTo:function(t,e,n,s,r){void 0===s&&(s=60),void 0===r&&(r=0);var a=Math.atan2(n-t.y,e-t.x);return r>0&&(s=i(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(a,s),a},moveToObject:function(t,e,i,n){return this.moveTo(t,e.x,e.y,i,n)},velocityFromAngle:function(t,i,n){return void 0===i&&(i=60),void 0===n&&(n=new c),n.setToPolar(e(t),i)},velocityFromRotation:function(t,e,i){return void 0===e&&(e=60),void 0===i&&(i=new c),i.setToPolar(t,e)},overlapRect:function(t,e,i,n,s,r){return h(this.world,t,e,i,n,s,r)},overlapCirc:function(t,e,i,n,s){return o(this.world,t,e,i,n,s)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(u.UPDATE,this.world.update,this.world),t.off(u.POST_UPDATE,this.world.postUpdate,this.world),t.off(u.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null,this._category=1}},destroy:function(){this.shutdown(),this.scene.sys.events.off(u.START,this.start,this),this.scene=null,this.systems=null}});return l.register("ArcadePhysics",f,"arcadePhysics"),nit=f}function knt(){if(ait)return rit;ait=1;var t={ProcessTileCallbacks:Tnt(),ProcessTileSeparationX:Ent(),ProcessTileSeparationY:Cnt(),SeparateTile:Mnt(),TileCheckX:_nt(),TileCheckY:Ant(),TileIntersectsBody:Pnt()};return rit=t}function Bnt(){if(hit)return oit;hit=1;var t=Vit(),e=nh(),i={ArcadePhysics:Int(),Body:dnt(),Collider:mnt(),Components:ont(),Events:unt(),Factory:vnt(),GetCollidesWith:Zit(),GetOverlapX:ynt(),GetOverlapY:xnt(),SeparateX:Lnt(),SeparateY:Fnt(),Group:fnt(),Image:hnt(),Sprite:lnt(),StaticBody:pnt(),StaticGroup:gnt(),Tilemap:knt(),World:Dnt()};return i=e(!1,i,t),oit=i}function Nnt(){if(dit)return cit;dit=1;var t=new(Kh())({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return cit=t}function znt(){if(pit)return fit;pit=1;var t=Nnt(),e=Kh(),i=ec(),n=new e({Extends:t,initialize:function(e,n,s){t.call(this,n),this.scene=e,this.systems=e.sys,this.pluginKey=s,e.sys.events.once(i.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return fit=n}var Unt,Ynt,Xnt,Gnt,Wnt,Hnt,Vnt,jnt,qnt,Knt,Znt,Jnt,$nt,Qnt,tst,est,ist,nst,sst,rst,ast,ost,hst,lst,ust,cst,dst,fst,pst,gst,vst,mst,yst,xst,wst,bst,Tst,Sst,Est,_st,Cst,Ast,Pst,Mst,Rst,Lst,Ost,Fst,Dst,Ist,kst,Bst,Nst,zst,Ust,Yst,Xst,Gst,Wst,Hst,Vst,jst,qst,Kst,Zst,Jst,$st,Qst,trt,ert,irt,nrt,srt,rrt,art,ort,hrt,lrt,urt,crt,drt,frt,prt,grt,vrt,mrt,yrt,xrt,wrt,brt,Trt,Srt,Ert,_rt,Crt,Art,Prt,Mrt,Rrt,Lrt,Ort,Frt,Drt,Irt,krt,Brt,Nrt,zrt,Urt,Yrt,Xrt,Grt,Wrt,Hrt,Vrt,jrt,qrt,Krt,Zrt,Jrt,$rt,Qrt,tat,eat,iat,nat,sat,rat,aat,oat,hat,lat,uat,cat,dat,fat,pat,gat,vat,mat,yat,xat,wat,bat,Tat,Sat,Eat,_at,Cat,Aat,Pat,Mat,Rat,Lat,Oat,Fat,Dat,Iat,kat,Bat,Nat,zat,Uat,Yat,Xat,Gat,Wat,Hat,Vat,jat,qat,Kat,Zat,Jat,$at,Qat,tot,eot,iot,not,sot,rot,aot,oot,hot,lot,uot,cot,dot,fot,pot,got,vot,mot,yot,xot,wot,bot,Tot,Sot,Eot,_ot,Cot,Aot,Pot,Mot,Rot,Lot,Oot,Fot,Dot,Iot,kot,Bot,Not,zot,Uot,Yot,Xot,Got,Wot,Hot,Vot,jot,qot,Kot,Zot,Jot,$ot,Qot,tht,eht,iht,nht,sht,rht,aht,oht,hht,lht={exports:{}};function uht(){if(Hnt)return Wnt;Hnt=1;var t=dW(),e=nh(),i={FX:oH(),BitmapMaskPipeline:PW(),Events:EW(),FXPipeline:TH(),LightPipeline:SH(),MobilePipeline:EH(),MultiPipeline:dH(),PointLightPipeline:_H(),PostFXPipeline:OW(),PreFXPipeline:gH(),RopePipeline:CH(),SinglePipeline:AH(),UtilityPipeline:PH()};return i=e(!1,i,t),Wnt=i}function cht(){if(jnt)return Vnt;jnt=1;var t={WebGLAttribLocationWrapper:IH(),WebGLBufferWrapper:LH(),WebGLProgramWrapper:OH(),WebGLTextureWrapper:FH(),WebGLFramebufferWrapper:DH(),WebGLUniformLocationWrapper:kH()};return Vnt=t}function dht(){return Znt||(Znt=1,lht.exports={Events:vW(),Snapshot:Ynt?Unt:(Ynt=1,Unt={Canvas:gW(),WebGL:RH()})},lht.exports.Canvas=Gnt?Xnt:(Gnt=1,Xnt={CanvasRenderer:xW(),GetBlendModes:mW(),SetTransform:Ej()}),lht.exports.WebGL=function(){if(Knt)return qnt;Knt=1;var t=SW(),e=nh(),i={PipelineManager:MH(),Pipelines:uht(),RenderTarget:wW(),Utils:_W(),WebGLPipeline:AW(),WebGLRenderer:BH(),WebGLShader:CW(),Wrappers:cht()};return i=e(!1,i,t),qnt=i}()),lht.exports}function fht(){if($nt)return Jnt;$nt=1;var t=nh(),e=yV(),i={Center:pV(),Events:VX(),Orientation:gV(),ScaleManager:BV(),ScaleModes:vV(),Zoom:mV()};return i=t(!1,i,e.CENTER),i=t(!1,i,e.ORIENTATION),i=t(!1,i,e.SCALE_MODE),i=t(!1,i,e.ZOOM),Jnt=i}function pht(){if(tst)return Qnt;tst=1;var t=tl(),e=Kh(),i=ec(),n=jh(),s=tc(),r=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.pluginStart,this)},boot:function(){this.systems.events.once(i.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(i.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=n(t,"target",!1),s=this.manager.getScene(e);if(!e||!this.checkValidTransition(s))return!1;var r=n(t,"duration",1e3);this._elapsed=0,this._target=s,this._duration=r,this._willSleep=n(t,"sleep",!1),this._willRemove=n(t,"remove",!1);var a=n(t,"onUpdate",null);a&&(this._onUpdate=a,this._onUpdateScope=n(t,"onUpdateScope",this.scene));var o=n(t,"allowInput",!1);this.settings.transitionAllowInput=o;var h=s.sys.settings;h.isTransition=!0,h.transitionFrom=this.scene,h.transitionDuration=r,h.transitionAllowInput=o,n(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):n(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),s.sys.isSleeping()?s.sys.wake(n(t,"data")):this.manager.start(e,n(t,"data"));var l=n(t,"onStart",null),u=n(t,"onStartScope",this.scene);return l&&l.call(u,this.scene,s,r),this.systems.events.emit(i.TRANSITION_OUT,s,r),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(e,i){this._elapsed+=i,this.transitionProgress=t(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;t.events.emit(i.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,i,n){return this.manager.add(t,e,i,n)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t,e){return t!==this.key&&this.manager.queueOp("switch",this.key,t,e),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,i){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setActive(t,i),this},setVisible:function(t,e){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getStatus:function(t){var e=this.manager.getScene(t);if(e)return e.sys.getStatus()},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(i.SHUTDOWN,this.shutdown,this),t.off(i.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});return s.register("ScenePlugin",r,"scenePlugin"),Qnt=r}function ght(){if(ist)return est;ist=1;var t=NV(),e=nh(),i={Events:ec(),GetPhysicsPlugins:UV(),GetScenePlugins:YV(),SceneManager:jV(),ScenePlugin:pht(),Settings:WV(),Systems:HV()};return i=e(!1,i,t),est=i}function vht(){if(hst)return ost;hst=1;var t=nh(),e=ast?rst:(ast=1,rst={LINEAR:0,NEAREST:1}),i={CanvasTexture:ZV(),DynamicTexture:JV(),Events:yW(),FilterMode:e,Frame:pc(),Parsers:uj(),Texture:KV(),TextureManager:cj(),TextureSource:qV()};return i=t(!1,i,e),ost=i}function mht(){return ust?lst:(ust=1,lst={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3})}function yht(){if(pst)return fst;pst=1;return fst=function(t,e,i){return t>=0&&t<i.width&&e>=0&&e<i.height}}function xht(){if(vst)return gst;vst=1;var t=yht();return gst=function(e,i,n,s){if(t(e,i,s)){var r=s.data[i][e]||null;return r?-1===r.index?n?r:null:r:null}return null}}function wht(){if(yst)return mst;yst=1;var t=xht();return mst=function(e,i,n){var s=t(e,i,!0,n),r=t(e,i-1,!0,n),a=t(e,i+1,!0,n),o=t(e-1,i,!0,n),h=t(e+1,i,!0,n),l=s&&s.collides;return l&&(s.faceTop=!0,s.faceBottom=!0,s.faceLeft=!0,s.faceRight=!0),r&&r.collides&&(l&&(s.faceTop=!1),r.faceBottom=!l),a&&a.collides&&(l&&(s.faceBottom=!1),a.faceTop=!l),o&&o.collides&&(l&&(s.faceLeft=!1),o.faceRight=!l),h&&h.collides&&(l&&(s.faceRight=!1),h.faceLeft=!l),s&&!s.collides&&s.resetFaces(),s}}function bht(){if(wst)return xst;wst=1;var t=xht(),e=wnt();return xst=function(i,n,s,r,a){for(var o=null,h=null,l=null,u=null,c=e(i,n,s,r,null,a),d=0;d<c.length;d++){var f=c[d];f&&(f.collides?(o=t(f.x,f.y-1,!0,a),h=t(f.x,f.y+1,!0,a),l=t(f.x-1,f.y,!0,a),u=t(f.x+1,f.y,!0,a),f.faceTop=!o||!o.collides,f.faceBottom=!h||!h.collides,f.faceLeft=!l||!l.collides,f.faceRight=!u||!u.collides):f.resetFaces())}}}function Tht(){if(Tst)return bst;Tst=1;var t=new(qu());return bst=function(e,i,n,s){var r=n.tilemapLayer,a=r.cullPaddingX,o=r.cullPaddingY,h=r.tilemap.tileToWorldXY(e,i,t,s,r);return h.x>s.worldView.x+r.scaleX*n.tileWidth*(-a-.5)&&h.x<s.worldView.right+r.scaleX*n.tileWidth*(a-.5)&&h.y>s.worldView.y+r.scaleY*n.tileHeight*(-o-1)&&h.y<s.worldView.bottom+r.scaleY*n.tileHeight*(o-.5)}}function Sht(){if(Est)return Sst;Est=1;var t=Kh(),e=_c(),i=mht(),n=uc(),s=a7(),r=new t({Mixins:[e.AlphaSingle,e.Flip,e.Visible],initialize:function(t,e,i,n,s,r,a,o){this.layer=t,this.index=e,this.x=i,this.y=n,this.width=s,this.height=r,this.right,this.bottom,this.baseWidth=void 0!==a?a:s,this.baseHeight=void 0!==o?o:r,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,this.collisionCallbackContext=this,this.tint=16777215,this.tintFill=!1,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=n(t.properties),this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).x:this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).y:this.y*this.baseWidth-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new s),e.x=this.getLeft(t),e.y=this.getTop(t),e.width=this.getRight(t)-e.x,e.height=this.getBottom(t)-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},intersects:function(t,e,i,n){return!(i<=this.pixelX||n<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){(void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t)&&(this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y));return this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,i,n,s){(void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=t),void 0===s&&(s=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n,this.faceLeft=t,this.faceRight=e,this.faceTop=i,this.faceBottom=n,s)&&(this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y));return this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,i,n){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==i&&(this.baseWidth=i),void 0!==n&&(this.baseHeight=n),this.updatePixelXY(),this},updatePixelXY:function(){var t=this.layer.orientation;if(t===i.ORTHOGONAL)this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight;else if(t===i.ISOMETRIC)this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5;else if(t===i.STAGGERED)this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2);else if(t===i.HEXAGONAL){var e,n,s=this.layer.staggerAxis,r=this.layer.staggerIndex,a=this.layer.hexSideLength;"y"===s?(n=(this.baseHeight-a)/2+a,this.pixelX="odd"===r?this.x*this.baseWidth+this.y%2*(this.baseWidth/2):this.x*this.baseWidth-this.y%2*(this.baseWidth/2),this.pixelY=this.y*n):"x"===s&&(e=(this.baseWidth-a)/2+a,this.pixelX=this.x*e,this.pixelY="odd"===r?this.y*this.baseHeight+this.x%2*(this.baseHeight/2):this.y*this.baseHeight-this.x%2*(this.baseHeight/2))}return this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});return Sst=r}function Eht(){if(Cst)return _st;Cst=1;var t=bht(),e=wnt(),i=yht(),n=Sht();return _st=function(s,r,a,o,h,l,u,c){void 0===u&&(u=!0);var d=e(s,r,a,o,null,c),f=[];d.forEach(function(t){var e=new n(t.layer,t.index,t.x,t.y,t.width,t.height,t.baseWidth,t.baseHeight);e.copy(t),f.push(e)});for(var p=h-s,g=l-r,v=0;v<f.length;v++){var m=f[v],y=m.x+p,x=m.y+g;i(y,x,c)&&c.data[x][y]&&(m.x=y,m.y=x,m.updatePixelXY(),c.data[x][y]=m)}u&&t(h-1,l-1,a+2,o+2,c),d.length=0,f.length=0}}function _ht(){if(Pst)return Ast;Pst=1;var t=wnt();return Ast=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&h[l].index===e&&(h[l].index=i)}}function Cht(){if(Rst)return Mst;Rst=1;var t=uc(),e=wnt(),i=_ht();return Mst=function(n,s,r,a,o,h){r||(r={}),Array.isArray(n)||(n=[n]);var l=h.tilemapLayer;a||(a=l.scene),o||(o=a.cameras.main);var u,c=h.width,d=h.height,f=e(0,0,c,d,null,h),p=[],g=function(t,e,i){for(var n=0;n<i.length;n++){var s=i[n];t.hasOwnProperty(s)||(t[s]=e[s])}};for(u=0;u<f.length;u++){var v=f[u],m=t(r);if(-1!==n.indexOf(v.index)){var y=l.tileToWorldXY(v.x,v.y,void 0,o,h);m.x=y.x,m.y=y.y,g(m,v,["rotation","flipX","flipY","alpha","visible","tint"]),m.hasOwnProperty("origin")||(m.x+=.5*v.width,m.y+=.5*v.height),m.hasOwnProperty("useSpriteSheet")&&(m.key=v.tileset.image,m.frame=v.index-v.tileset.firstgid),p.push(a.make.sprite(m))}}if(Array.isArray(s))for(u=0;u<n.length;u++)i(n[u],s[u],0,0,c,d,h);else if(null!==s)for(u=0;u<n.length;u++)i(n[u],s,0,0,c,d,h);return p},Mst}function Aht(){if(Ost)return Lst;Ost=1;var t=Ju(),e=OG(),i=FG(),n=new t;return Lst=function(t,s){var r=t.tilemapLayer.tilemap,a=t.tilemapLayer,o=Math.floor(r.tileWidth*a.scaleX),h=Math.floor(r.tileHeight*a.scaleY),l=i(s.worldView.x-a.x,o,0,!0)-a.cullPaddingX,u=e(s.worldView.right-a.x,o,0,!0)+a.cullPaddingX,c=i(s.worldView.y-a.y,h,0,!0)-a.cullPaddingY,d=e(s.worldView.bottom-a.y,h,0,!0)+a.cullPaddingY;return n.setTo(l,c,u-l,d-c)},Lst}function Pht(){if(Dst)return Fst;Dst=1;return Fst=function(t,e,i,n){var s,r,a,o=t.data,h=t.width,l=t.height,u=t.tilemapLayer,c=Math.max(0,e.left),d=Math.min(h,e.right),f=Math.max(0,e.top),p=Math.min(l,e.bottom);if(0===i)for(r=f;r<p;r++)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(1===i)for(r=f;r<p;r++)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(2===i)for(r=p;r>=f;r--)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(3===i)for(r=p;r>=f;r--)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);return u.tilesDrawn=n.length,u.tilesTotal=h*l,n},Fst}function Mht(){if(kst)return Ist;kst=1;var t=Aht(),e=Pht();return Ist=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return(a.skipCull||1!==a.scrollFactorX||1!==a.scrollFactorY)&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},Ist}function Rht(){if(Nst)return Bst;Nst=1;return Bst=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)}}function Lht(){if(Ust)return zst;Ust=1;var t=wnt(),e=bht(),i=Rht();return zst=function(n,s,r,a,o,h,l){for(var u=-1!==l.collideIndexes.indexOf(n),c=t(s,r,a,o,null,l),d=0;d<c.length;d++)c[d].index=n,i(c[d],u);h&&e(s-1,r-1,a+2,o+2,l)}}function Oht(){if(Xst)return Yst;Xst=1;var t=wnt();return Yst=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).filter(e,i)}}function Fht(){if(Wst)return Gst;Wst=1;return Gst=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=!1);var s,r,a,o=0;if(i){for(r=n.height-1;r>=0;r--)for(s=n.width-1;s>=0;s--)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}}else for(r=0;r<n.height;r++)for(s=0;s<n.width;s++)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}return null}}function Dht(){if(Vst)return Hst;Vst=1;var t=wnt();return Hst=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).find(e,i)||null}}function Iht(){if(qst)return jst;qst=1;var t=wnt();return jst=function(e,i,n,s,r,a,o,h){t(n,s,r,a,o,h).forEach(e,i)}}function kht(){if(Zst)return Kst;Zst=1;var t=OG(),e=FG();return Kst=function(i,n){var s,r,a,o,h=i.tilemapLayer.tilemap,l=i.tilemapLayer,u=Math.floor(h.tileWidth*l.scaleX),c=Math.floor(h.tileHeight*l.scaleY),d=i.hexSideLength;if("y"===i.staggerAxis){var f=(c-d)/2+d;s=e(n.worldView.x-l.x,u,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,u,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,f,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,f,0,!0)+l.cullPaddingY}else{var p=(u-d)/2+d;s=e(n.worldView.x-l.x,p,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,p,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,c,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,c,0,!0)+l.cullPaddingY}return{left:s,right:r,top:a,bottom:o}},Kst}function Bht(){if($st)return Jst;$st=1;var t=kht(),e=Pht();return Jst=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},Jst}function Nht(){if(trt)return Qst;trt=1;var t=Tht();return Qst=function(e,i,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var r,a,o,h=e.tilemapLayer,l=e.data,u=e.width,c=e.height,d=h.skipCull,f=u,p=c;if(0===s)for(a=0;a<p;a++)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(1===s)for(a=0;a<p;a++)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(2===s)for(a=p;a>=0;a--)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(3===s)for(a=p;a>=0;a--)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);return h.tilesDrawn=n.length,h.tilesTotal=u*c,n}}function zht(){if(irt)return ert;irt=1;var t=OG(),e=FG();return ert=function(i,n){var s=i.tilemapLayer.tilemap,r=i.tilemapLayer,a=Math.floor(s.tileWidth*r.scaleX),o=Math.floor(s.tileHeight*r.scaleY);return{left:e(n.worldView.x-r.x,a,0,!0)-r.cullPaddingX,right:t(n.worldView.right-r.x,a,0,!0)+r.cullPaddingX,top:e(n.worldView.y-r.y,o/2,0,!0)-r.cullPaddingY,bottom:t(n.worldView.bottom-r.y,o/2,0,!0)+r.cullPaddingY}},ert}function Uht(){if(srt)return nrt;srt=1;var t=zht(),e=Pht();return nrt=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},nrt}function Yht(){if(art)return rrt;art=1;var t=mht(),e=Mht(),i=Bht(),n=Nht(),s=qh(),r=Uht();return rrt=function(a){return a===t.ORTHOGONAL?e:a===t.HEXAGONAL?i:a===t.STAGGERED?r:a===t.ISOMETRIC?n:s}}function Xht(){if(hrt)return ort;hrt=1;var t=xht(),e=new(qu());return ort=function(i,n,s,r,a){return a.tilemapLayer.worldToTileXY(i,n,!0,e,r),t(e.x,e.y,s,a)}}function Ght(){if(urt)return lrt;urt=1;var t=qu();return lrt=function(e,i,n,s){var r=s.baseTileWidth,a=s.baseTileHeight,o=s.tilemapLayer,h=0,l=0;o&&(n||(n=o.scene.cameras.main),h=o.x+n.scrollX*(1-o.scrollFactorX),l=o.y+n.scrollY*(1-o.scrollFactorY),r*=o.scaleX,a*=o.scaleY);var u=h+e*r,c=l+i*a;return[new t(u,c),new t(u+r,c),new t(u+r,c+a),new t(u,c+a)]}}function Wht(){if(drt)return crt;drt=1;var t=qu();return crt=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),u=h.y+s.scrollY*(1-h.scrollFactorY),a*=h.scaleX,o*=h.scaleY);var c,d,f=a/2,p=o/2,g=r.staggerAxis,v=r.staggerIndex;return"y"===g?(c=l+a*e+a,d=u+1.5*i*p+p,i%2==0&&("odd"===v?c-=f:c+=f)):"x"===g&&"odd"===v&&(c=l+1.5*e*f+f,d=u+o*e+o,e%2==0&&("odd"===v?d-=p:d+=p)),n.set(c,d)},crt}function Hht(){if(prt)return frt;prt=1;var t=Wht(),e=qu(),i=new e;return frt=function(n,s,r,a){var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(o*=l.scaleX,h*=l.scaleY);var u,c,d=t(n,s,i,r,a),f=[],p=.5773502691896257;"y"===a.staggerAxis?(u=p*o,c=h/2):(u=o/2,c=p*h);for(var g=0;g<6;g++){var v=2*Math.PI*(.5-g)/6;f.push(new e(d.x+u*Math.cos(v),d.y+c*Math.sin(v)))}return f},frt}function Vht(){if(vrt)return grt;vrt=1;var t=mht(),e=Hht(),i=qh(),n=Ght();return grt=function(s){return s===t.ORTHOGONAL?n:s===t.ISOMETRIC?i:s===t.HEXAGONAL?e:(t.STAGGERED,i)}}function jht(){if(yrt)return mrt;yrt=1;var t=d7(),e=wnt(),i=W8(),n=qh(),s=qu(),r=mht(),a=function(t,e){return i.RectangleToTriangle(e,t)},o=new s,h=new s,l=new s;return mrt=function(s,u,c,d){if(d.orientation!==r.ORTHOGONAL)return console.warn("GetTilesWithinShape only works with orthogonal tilemaps"),[];if(void 0===s)return[];var f=n;s instanceof t.Circle?f=i.CircleToRectangle:s instanceof t.Rectangle?f=i.RectangleToRectangle:s instanceof t.Triangle?f=a:s instanceof t.Line&&(f=i.LineToRectangle),d.tilemapLayer.worldToTileXY(s.left,s.top,!0,h,c);var p=h.x,g=h.y;d.tilemapLayer.worldToTileXY(s.right,s.bottom,!1,l,c);var v=Math.ceil(l.x),m=Math.ceil(l.y),y=Math.max(v-p,1),x=Math.max(m-g,1),w=e(p,g,y,x,u,d),b=d.tileWidth,T=d.tileHeight;d.tilemapLayer&&(b*=d.tilemapLayer.scaleX,T*=d.tilemapLayer.scaleY);for(var S=[],E=new t.Rectangle(0,0,b,T),_=0;_<w.length;_++){var C=w[_];d.tilemapLayer.tileToWorldXY(C.x,C.y,o,c),E.x=o.x,E.y=o.y,f(s,E)&&S.push(C)}return S}}function qht(){if(wrt)return xrt;wrt=1;return xrt=function(t,e,i){var n=i.baseTileWidth,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.x+e.scrollX*(1-s.scrollFactorX),n*=s.scaleX),r+t*n}}function Kht(){if(Trt)return brt;Trt=1;var t=mht(),e=qh(),i=qht();return brt=function(n){return n===t.ORTHOGONAL?i:e}}function Zht(){if(Ert)return Srt;Ert=1;var t=qu();return Srt=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+a/2*(e-i),d=u+(e+i)*(o/2);return n.set(c,d)},Srt}function Jht(){if(Crt)return _rt;Crt=1;var t=qu();return _rt=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+e*a+i%2*(a/2),d=u+i*(o/2);return n.set(c,d)},_rt}function $ht(){if(Prt)return Art;Prt=1;return Art=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*n}}function Qht(){if(Rrt)return Mrt;Rrt=1;var t=qht(),e=$ht(),i=qu();return Mrt=function(n,s,r,a,o){return r||(r=new i(0,0)),r.x=t(n,a,o),r.y=e(s,a,o),r},Mrt}function tlt(){if(Ort)return Lrt;Ort=1;var t=mht(),e=Wht(),i=Zht(),n=qh(),s=Jht(),r=Qht();return Lrt=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function elt(){if(Drt)return Frt;Drt=1;return Frt=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(void 0===e&&(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*(n/2)+n}}function ilt(){if(krt)return Irt;krt=1;var t=mht(),e=qh(),i=elt(),n=$ht();return Irt=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function nlt(){if(Nrt)return Brt;Nrt=1;return Brt=function(){return null}}function slt(){if(Urt)return zrt;Urt=1;var t=qu();return zrt=function(e,i,n,s,r,a){void 0===n&&(n=!0),s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u=e/o,c=i/h;return n&&(u=Math.floor(u),c=Math.floor(c)),s.set(u,c)},zrt}function rlt(){if(Xrt)return Yrt;Xrt=1;var t=slt(),e=new(qu());return Yrt=function(i,n,s,r){return t(i,0,n,e,s,r),e.x}}function alt(){if(Wrt)return Grt;Wrt=1;var t=mht(),e=nlt(),i=rlt();return Grt=function(n){return n===t.ORTHOGONAL?i:e}}function olt(){if(Vrt)return Hrt;Vrt=1;var t=qu();return Hrt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u,c,d,f,p,g=.5773502691896257,v=-.3333333333333333,m=.6666666666666666,y=o/2,x=h/2;"y"===a.staggerAxis?(d=g*(u=(e-y)/(g*o))+v*(c=(i-x)/x),f=0*u+m*c):(d=v*(u=(e-y)/y)+g*(c=(i-x)/(g*h)),f=m*u+0*c),p=-d-f;var w,b=Math.round(d),T=Math.round(f),S=Math.round(p),E=Math.abs(b-d),_=Math.abs(T-f),C=Math.abs(S-p);E>_&&E>C?b=-T-S:_>C&&(T=-b-S);var A=T;return w="odd"===a.staggerIndex?A%2==0?T/2+b:T/2+b-.5:A%2==0?T/2+b:T/2+b+.5,s.set(w,A)},Hrt}function hlt(){if(qrt)return jrt;qrt=1;var t=qu();return jrt=function(e,i,n,s,r,a,o){s||(s=new t);var h=a.baseTileWidth,l=a.baseTileHeight,u=a.tilemapLayer;u&&(r||(r=u.scene.cameras.main),i-=u.y+r.scrollY*(1-u.scrollFactorY),l*=u.scaleY,e-=u.x+r.scrollX*(1-u.scrollFactorX),h*=u.scaleX);var c=h/2,d=l/2;o||(i-=l);var f=.5*((e-=c)/c+i/d),p=.5*(-e/c+i/d);return n&&(f=Math.floor(f),p=Math.floor(p)),s.set(f,p)},jrt}function llt(){if(Zrt)return Krt;Zrt=1;var t=qu();return Krt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),i-=l.y+r.scrollY*(1-l.scrollFactorY),h*=l.scaleY,e-=l.x+r.scrollX*(1-l.scrollFactorX),o*=l.scaleX);var u=n?Math.floor(i/(h/2)):i/(h/2),c=n?Math.floor((e+u%2*.5*o)/o):(e+u%2*.5*o)/o;return s.set(c,u)},Krt}function ult(){if($rt)return Jrt;$rt=1;var t=mht(),e=olt(),i=hlt(),n=qh(),s=llt(),r=slt();return Jrt=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function clt(){if(tat)return Qrt;tat=1;return Qrt=function(t,e,i,n){var s=n.baseTileHeight,r=n.tilemapLayer;return r&&(i||(i=r.scene.cameras.main),t-=r.y+i.scrollY*(1-r.scrollFactorY),s*=r.scaleY),e?Math.floor(t/(s/2)):t/(s/2)}}function dlt(){if(iat)return eat;iat=1;var t=slt(),e=new(qu());return eat=function(i,n,s,r){return t(0,i,n,e,s,r),e.y}}function flt(){if(sat)return nat;sat=1;var t=mht(),e=nlt(),i=clt(),n=dlt();return nat=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function plt(){if(aat)return rat;aat=1;var t=yht();return rat=function(e,i,n){if(t(e,i,n)){var s=n.data[i][e];return null!==s&&s.index>-1}return!1}}function glt(){if(hat)return oat;hat=1;var t=plt(),e=new(qu());return oat=function(i,n,s,r){r.tilemapLayer.worldToTileXY(i,n,!0,e,s);var a=e.x,o=e.y;return t(a,o,r)}}function vlt(){if(uat)return lat;uat=1;var t=Sht(),e=yht(),i=wht(),n=Rht();return lat=function(s,r,a,o,h){if(void 0===o&&(o=!0),!e(r,a,h))return null;var l,u=h.data[a][r],c=u&&u.collides;s instanceof t?(null===h.data[a][r]&&(h.data[a][r]=new t(h,s.index,r,a,h.tileWidth,h.tileHeight)),h.data[a][r].copy(s)):(l=s,null===h.data[a][r]?h.data[a][r]=new t(h,l,r,a,h.tileWidth,h.tileHeight):h.data[a][r].index=l);var d=h.data[a][r],f=-1!==h.collideIndexes.indexOf(d.index);if(-1===(l=s instanceof t?s.index:s))d.width=h.tileWidth,d.height=h.tileHeight;else{var p=h.tilemapLayer.tilemap,g=p.tiles[l][2],v=p.tilesets[g];d.width=v.tileWidth,d.height=v.tileHeight}return n(d,f),o&&c!==d.collides&&i(r,a,h),d},lat}function mlt(){if(dat)return cat;dat=1;var t=vlt(),e=new(qu());return cat=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(n,s,!0,e,a,o),t(i,e.x,e.y,r,o)}}function ylt(){if(pat)return fat;pat=1;var t=bht(),e=vlt();return fat=function(i,n,s,r,a){if(void 0===r&&(r=!0),!Array.isArray(i))return null;Array.isArray(i[0])||(i=[i]);for(var o=i.length,h=i[0].length,l=0;l<o;l++)for(var u=0;u<h;u++){var c=i[l][u];e(c,n+u,s+l,!1,a)}r&&t(n-1,s-1,h+2,o+2,a)}}function xlt(){if(vat)return gat;vat=1;var t=wnt(),e=kl();return gat=function(i,n,s,r,a,o){var h,l=t(i,n,s,r,{},o);if(!a)for(a=[],h=0;h<l.length;h++)-1===a.indexOf(l[h].index)&&a.push(l[h].index);for(h=0;h<l.length;h++)l[h].index=e(a)}}function wlt(){if(yat)return mat;yat=1;var t=Sht(),e=yht(),i=wht();return mat=function(n,s,r,a,o){if(void 0===r&&(r=!0),void 0===a&&(a=!0),!e(n,s,o))return null;var h=o.data[s][n];return h?(o.data[s][n]=r?null:new t(o,-1,n,s,o.tileWidth,o.tileHeight),a&&h&&h.collides&&i(n,s,o),h):null}}function blt(){if(wat)return xat;wat=1;var t=wlt(),e=new(qu());return xat=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(i,n,!0,e,a,o),t(e.x,e.y,s,r,o)}}function Tlt(){if(Tat)return bat;Tat=1;var t=wnt(),e=lV(),i=new e(105,210,231,150),n=new e(243,134,48,200),s=new e(40,39,37,150);return bat=function(e,r,a){void 0===r&&(r={});var o=void 0!==r.tileColor?r.tileColor:i,h=void 0!==r.collidingTileColor?r.collidingTileColor:n,l=void 0!==r.faceColor?r.faceColor:s,u=t(0,0,a.width,a.height,null,a);e.translateCanvas(a.tilemapLayer.x,a.tilemapLayer.y),e.scaleCanvas(a.tilemapLayer.scaleX,a.tilemapLayer.scaleY);for(var c=0;c<u.length;c++){var d=u[c],f=d.tileset?d.tileset.tileOffset:{x:0,y:0},p=d.width,g=d.height,v=d.pixelX-f.x,m=d.pixelY-f.y,y=d.collides?h:o;null!==y&&(e.fillStyle(y.color,y.alpha/255),e.fillRect(v,m,p,g)),v+=1,m+=1,p-=2,g-=2,null!==l&&(e.lineStyle(1,l.color,l.alpha/255),d.faceTop&&e.lineBetween(v,m,v+p,m),d.faceRight&&e.lineBetween(v+p,m,v+p,m+g),d.faceBottom&&e.lineBetween(v,m+g,v+p,m+g),d.faceLeft&&e.lineBetween(v,m,v,m+g))}},bat}function Slt(){if(Eat)return Sat;Eat=1;return Sat=function(t,e,i){var n=i.collideIndexes.indexOf(t);e&&-1===n?i.collideIndexes.push(t):e||-1===n||i.collideIndexes.splice(n,1)}}function Elt(){if(Cat)return _at;Cat=1;var t=Rht(),e=bht(),i=Slt();return _at=function(n,s,r,a,o){void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),Array.isArray(n)||(n=[n]);for(var h=0;h<n.length;h++)i(n[h],s,a);if(o)for(var l=0;l<a.height;l++)for(var u=0;u<a.width;u++){var c=a.data[l][u];c&&-1!==n.indexOf(c.index)&&t(c,s)}r&&e(0,0,a.width,a.height,a)}}function _lt(){if(Pat)return Aat;Pat=1;var t=Rht(),e=bht(),i=Slt();return Aat=function(n,s,r,a,o,h){if(void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===h&&(h=!0),!(n>s)){for(var l=n;l<=s;l++)i(l,r,o);if(h)for(var u=0;u<o.height;u++)for(var c=0;c<o.width;c++){var d=o.data[u][c];d&&d.index>=n&&d.index<=s&&t(d,r)}a&&e(0,0,o.width,o.height,o)}}}function Clt(){if(Rat)return Mat;Rat=1;var t=Rht(),e=bht(),i=Slt();return Mat=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0),Array.isArray(n)||(n=[n]);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];l&&-1===n.indexOf(l.index)&&(t(l,s),i(l.index,s,a))}r&&e(0,0,a.width,a.height,a)}}function Alt(){if(Oat)return Lat;Oat=1;var t=Rht(),e=bht(),i=Jj();return Lat=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];if(l)for(var u in n)if(i(l.properties,u)){var c=n[u];Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;d++)l.properties[u]===c[d]&&t(l,s)}}r&&e(0,0,a.width,a.height,a)}}function Plt(){if(Dat)return Fat;Dat=1;var t=Rht(),e=bht();return Fat=function(i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);for(var r=0;r<s.height;r++)for(var a=0;a<s.width;a++){var o=s.data[r][a];if(o){var h=o.getCollisionGroup();h&&h.objects&&h.objects.length>0&&t(o,i)}}n&&e(0,0,s.width,s.height,s)}}function Mlt(){if(kat)return Iat;kat=1;return Iat=function(t,e,i,n){if("number"==typeof t)n.callbacks[t]=null!==e?{callback:e,callbackContext:i}:void 0;else for(var s=0,r=t.length;s<r;s++)n.callbacks[t[s]]=null!==e?{callback:e,callbackContext:i}:void 0}}function Rlt(){if(Nat)return Bat;Nat=1;var t=wnt();return Bat=function(e,i,n,s,r,a,o){for(var h=t(e,i,n,s,null,o),l=0;l<h.length;l++)h[l].setCollisionCallback(r,a)}}function Llt(){if(Uat)return zat;Uat=1;var t=wnt(),e=jl();return zat=function(i,n,s,r,a){var o=t(i,n,s,r,null,a),h=o.map(function(t){return t.index});e(h);for(var l=0;l<o.length;l++)o[l].index=h[l]}}function Olt(){if(Xat)return Yat;Xat=1;var t=wnt();return Yat=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&(h[l].index===e?h[l].index=i:h[l].index===i&&(h[l].index=e))}}function Flt(){if(Wat)return Gat;Wat=1;var t=wnt(),e=cW();return Gat=function(i,n,s,r,a,o){if(a){var h,l=t(i,n,s,r,null,o),u=0;for(h=0;h<a.length;h++)u+=a[h].weight;if(!(u<=0))for(h=0;h<l.length;h++){for(var c=e.RND.frac()*u,d=0,f=-1,p=0;p<a.length;p++)if(c<=(d+=a[p].weight)){var g=a[p].index;f=Array.isArray(g)?g[Math.floor(e.RND.frac()*g.length)]:g;break}l[h].index=f}}}}function Dlt(){return Vat?Hat:(Vat=1,Hat={CalculateFacesAt:wht(),CalculateFacesWithin:bht(),CheckIsoBounds:Tht(),Copy:Eht(),CreateFromTiles:Cht(),CullBounds:Aht(),CullTiles:Mht(),Fill:Lht(),FilterTiles:Oht(),FindByIndex:Fht(),FindTile:Dht(),ForEachTile:Iht(),GetCullTilesFunction:Yht(),GetTileAt:xht(),GetTileAtWorldXY:Xht(),GetTileCorners:Ght(),GetTileCornersFunction:Vht(),GetTilesWithin:wnt(),GetTilesWithinShape:jht(),GetTilesWithinWorldXY:bnt(),GetTileToWorldXFunction:Kht(),GetTileToWorldXYFunction:tlt(),GetTileToWorldYFunction:ilt(),GetWorldToTileXFunction:alt(),GetWorldToTileXYFunction:ult(),GetWorldToTileYFunction:flt(),HasTileAt:plt(),HasTileAtWorldXY:glt(),HexagonalCullBounds:kht(),HexagonalCullTiles:Bht(),HexagonalGetTileCorners:Hht(),HexagonalTileToWorldXY:Wht(),HexagonalWorldToTileXY:olt(),IsInLayerBounds:yht(),IsometricCullTiles:Nht(),IsometricTileToWorldXY:Zht(),IsometricWorldToTileXY:hlt(),PutTileAt:vlt(),PutTileAtWorldXY:mlt(),PutTilesAt:ylt(),Randomize:xlt(),RemoveTileAt:wlt(),RemoveTileAtWorldXY:blt(),RenderDebug:Tlt(),ReplaceByIndex:_ht(),RunCull:Pht(),SetCollision:Elt(),SetCollisionBetween:_lt(),SetCollisionByExclusion:Clt(),SetCollisionByProperty:Alt(),SetCollisionFromCollisionGroup:Plt(),SetLayerCollisionIndex:Slt(),SetTileCollision:Rht(),SetTileIndexCallback:Mlt(),SetTileLocationCallback:Rlt(),Shuffle:Llt(),StaggeredCullBounds:zht(),StaggeredCullTiles:Uht(),StaggeredTileToWorldXY:Jht(),StaggeredTileToWorldY:elt(),StaggeredWorldToTileXY:llt(),StaggeredWorldToTileY:clt(),SwapByIndex:Olt(),TileToWorldX:qht(),TileToWorldXY:Qht(),TileToWorldY:$ht(),WeightedRandomize:Flt(),WorldToTileX:rlt(),WorldToTileXY:slt(),WorldToTileY:dlt()})}function Ilt(){if(qat)return jat;qat=1;var t=mht();return jat=function(e){return"isometric"===(e=e.toLowerCase())?t.ISOMETRIC:"staggered"===e?t.STAGGERED:"hexagonal"===e?t.HEXAGONAL:t.ORTHOGONAL}}function klt(){if(Zat)return Kat;Zat=1;var t=Kh(),e=mht(),i=jh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","layer"),this.id=i(t,"id",0),this.x=i(t,"x",0),this.y=i(t,"y",0),this.width=i(t,"width",0),this.height=i(t,"height",0),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.baseTileWidth=i(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=i(t,"baseTileHeight",this.tileHeight),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.widthInPixels=i(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=i(t,"alpha",1),this.visible=i(t,"visible",!0),this.properties=i(t,"properties",[]),this.indexes=i(t,"indexes",[]),this.collideIndexes=i(t,"collideIndexes",[]),this.callbacks=i(t,"callbacks",[]),this.bodies=i(t,"bodies",[]),this.data=i(t,"data",[]),this.tilemapLayer=i(t,"tilemapLayer",null),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return Kat=n}function Blt(){if($at)return Jat;$at=1;var t=Kh(),e=mht(),i=jh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","map"),this.width=i(t,"width",0),this.height=i(t,"height",0),this.infinite=i(t,"infinite",!1),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.widthInPixels=i(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.tileHeight),this.format=i(t,"format",null),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.renderOrder=i(t,"renderOrder","right-down"),this.version=i(t,"version","1"),this.properties=i(t,"properties",{}),this.layers=i(t,"layers",[]),this.images=i(t,"images",[]),this.objects=i(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[]),this.collision=i(t,"collision",{}),this.tilesets=i(t,"tilesets",[]),this.imageCollections=i(t,"imageCollections",[]),this.tiles=i(t,"tiles",[]),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return Jat=n}function Nlt(){if(tot)return Qat;tot=1;var t=Nit(),e=klt(),i=Blt(),n=Sht();return Qat=function(s,r,a,o,h){for(var l=new e({tileWidth:a,tileHeight:o}),u=new i({name:s,tileWidth:a,tileHeight:o,format:t.ARRAY_2D,layers:[l]}),c=[],d=r.length,f=0,p=0;p<r.length;p++){c[p]=[];for(var g=r[p],v=0;v<g.length;v++){var m=parseInt(g[v],10);isNaN(m)||-1===m?c[p][v]=h?null:new n(l,-1,v,p,a,o):c[p][v]=new n(l,m,v,p,a,o)}0===f&&(f=g.length)}return u.width=l.width=f,u.height=l.height=d,u.widthInPixels=l.widthInPixels=f*a,u.heightInPixels=l.heightInPixels=d*o,l.data=c,u},Qat}function zlt(){if(iot)return eot;iot=1;var t=Nit(),e=Nlt();return eot=function(i,n,s,r,a){var o=n.trim().split("\n").map(function(t){return t.split(",")}),h=e(i,o,s,r,a);return h.format=t.CSV,h},eot}function Ult(){if(sot)return not;sot=1;var t=nh();return not=function(e){for(var i,n,s,r,a,o=0;o<e.layers.length;o++){i=e.layers[o],r=null;for(var h=0;h<i.data.length;h++){a=i.data[h];for(var l=0;l<a.length;l++)null===(n=a[l])||n.index<0||(s=e.tiles[n.index][2],r=e.tilesets[s],n.width=r.tileWidth,n.height=r.tileHeight,r.tileProperties&&r.tileProperties[n.index-r.firstgid]&&(n.properties=t(n.properties,r.tileProperties[n.index-r.firstgid])))}}}}function Ylt(){if(aot)return rot;aot=1;var t=Kh(),e=qu(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){(void 0===n||n<=0)&&(n=32),(void 0===s||s<=0)&&(s=32),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o={}),void 0===h&&(h={}),this.name=t,this.firstgid=i,this.tileWidth=n,this.tileHeight=s,this.tileMargin=r,this.tileSpacing=a,this.tileProperties=o,this.tileData=h,this.tileOffset=new e,void 0!==l&&this.tileOffset.set(l.x,l.y),this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){this.image=t;var e=t.get(),i=t.getFrameBounds();return this.glTexture=e.source.glTexture,e.width>i.width||e.height>i.height?this.updateTileData(e.width,e.height):this.updateTileData(i.width,i.height,i.x,i.y),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var s=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),r=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);s%1==0&&r%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),s=Math.floor(s),r=Math.floor(r),this.rows=s,this.columns=r,this.total=s*r,this.texCoordinates.length=0;for(var a=this.tileMargin+i,o=this.tileMargin+n,h=0;h<this.rows;h++){for(var l=0;l<this.columns;l++)this.texCoordinates.push({x:a,y:o}),a+=this.tileWidth+this.tileSpacing;a=this.tileMargin+i,o+=this.tileHeight+this.tileSpacing}return this}});return rot=i}function Xlt(){if(hot)return oot;hot=1;var t=Ylt();return oot=function(e){var i,n,s=[];for(i=0;i<e.imageCollections.length;i++)for(var r=e.imageCollections[i].images,a=0;a<r.length;a++){var o=r[a],h={x:0,y:o.height-e.tileHeight};(n=new t(o.image,o.gid,o.width,o.height,0,0,void 0,void 0,h)).updateTileData(o.width,o.height),e.tilesets.push(n)}for(i=0;i<e.tilesets.length;i++)for(var l=(n=e.tilesets[i]).tileMargin,u=n.tileMargin,c=0,d=0,f=0,p=n.firstgid;p<n.firstgid+n.total&&(s[p]=[l,u,i],l+=n.tileWidth+n.tileSpacing,++c!==n.total)&&(++d!==n.columns||(l=n.tileMargin,u+=n.tileHeight+n.tileSpacing,d=0,++f!==n.rows));p++);return s}}function Glt(){if(uot)return lot;uot=1;var t=jh();return lot=function(e,i,n){if(!i)return{i:0,layers:e.layers,name:"",opacity:1,visible:!0,x:0,y:0};var s=i.x+t(i,"startx",0)*e.tilewidth+t(i,"offsetx",0),r=i.y+t(i,"starty",0)*e.tileheight+t(i,"offsety",0);return{i:0,layers:i.layers,name:n.name+i.name+"/",opacity:n.opacity*i.opacity,visible:n.visible&&i.visible,x:n.x+s,y:n.y+r}}}function Wlt(){if(dot)return cot;dot=1;var t=jh(),e=Glt();return cot=function(i){for(var n=[],s=[],r=e(i);r.i<r.layers.length||s.length>0;)if(r.i>=r.layers.length){if(s.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}r=s.pop()}else{var a=r.layers[r.i];if(r.i++,"imagelayer"===a.type){var o=t(a,"offsetx",0)+t(a,"startx",0),h=t(a,"offsety",0)+t(a,"starty",0);n.push({name:r.name+a.name,image:a.image,x:r.x+o+a.x,y:r.y+h+a.y,alpha:r.opacity*a.opacity,visible:r.visible&&a.visible,properties:t(a,"properties",{})})}else if("group"===a.type){var l=e(i,a,r);s.push(r),r=l}}return n}}function Hlt(){if(pot)return fot;pot=1;var t=Jj();return fot=function(e,i){for(var n={},s=0;s<i.length;s++){var r=i[s];t(e,r)&&(n[r]=e[r])}return n},fot}function Vlt(){if(vot)return got;vot=1;var t=2147483648,e=1073741824,i=536870912;return got=function(n){var s=Boolean(n&t),r=Boolean(n&e),a=Boolean(n&i);n&=536870911;var o=0,h=!1;return s&&r&&a?(o=Math.PI/2,h=!0):s&&r&&!a?(o=Math.PI,h=!1):s&&!r&&a?(o=Math.PI/2,h=!1):!s||r||a?!s&&r&&a?(o=3*Math.PI/2,h=!1):s||!r||a?s||r||!a?s||r||a||(o=0,h=!1):(o=3*Math.PI/2,h=!0):(o=Math.PI,h=!0):(o=0,h=!0),{gid:n,flippedHorizontal:s,flippedVertical:r,flippedAntiDiagonal:a,rotation:o,flipped:h}}}function jlt(){if(yot)return mot;yot=1;var t=Hlt(),e=Vlt(),i=function(t){return{x:t.x,y:t.y}},n=["id","name","type","rotation","properties","visible","x","y","width","height"];return mot=function(s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o=t(s,n);if(o.x+=r,o.y+=a,s.gid){var h=e(s.gid);o.gid=h.gid,o.flippedHorizontal=h.flippedHorizontal,o.flippedVertical=h.flippedVertical,o.flippedAntiDiagonal=h.flippedAntiDiagonal}else s.polyline?o.polyline=s.polyline.map(i):s.polygon?o.polygon=s.polygon.map(i):s.ellipse?o.ellipse=s.ellipse:s.text?o.text=s.text:s.point?o.point=!0:o.rectangle=!0;return o}}function qlt(){if(wot)return xot;wot=1;var t=Kh(),e=jh(),i=new t({initialize:function(t){void 0===t&&(t={}),this.name=e(t,"name","object layer"),this.id=e(t,"id",0),this.opacity=e(t,"opacity",1),this.properties=e(t,"properties",{}),this.propertyTypes=e(t,"propertytypes",{}),this.type=e(t,"type","objectgroup"),this.visible=e(t,"visible",!0),this.objects=e(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[])}});return xot=i}function Klt(){if(Tot)return bot;Tot=1;var t=jh(),e=jlt(),i=qlt(),n=Glt();return bot=function(s){for(var r=[],a=[],o=n(s);o.i<o.layers.length||a.length>0;)if(o.i>=o.layers.length){if(a.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}o=a.pop()}else{var h=o.layers[o.i];if(o.i++,h.opacity*=o.opacity,h.visible=o.visible&&h.visible,"objectgroup"===h.type){h.name=o.name+h.name;for(var l=o.x+t(h,"startx",0)+t(h,"offsetx",0),u=o.y+t(h,"starty",0)+t(h,"offsety",0),c=[],d=0;d<h.objects.length;d++){var f=e(h.objects[d],l,u);c.push(f)}var p=new i(h);p.objects=c,r.push(p)}else if("group"===h.type){var g=n(s,h,o);a.push(o),o=g}}return r}}function Zlt(){if(Eot)return Sot;Eot=1;return Sot=function(t){for(var e=window.atob(t),i=e.length,n=new Array(i/4),s=0;s<i;s+=4)n[s/4]=(e.charCodeAt(s)|e.charCodeAt(s+1)<<8|e.charCodeAt(s+2)<<16|e.charCodeAt(s+3)<<24)>>>0;return n},Sot}function Jlt(){if(Cot)return _ot;Cot=1;var t=Zlt(),e=mht(),i=Glt(),n=Ilt(),s=jh(),r=klt(),a=Vlt(),o=Sht();return _ot=function(h,l){for(var u=s(h,"infinite",!1),c=[],d=[],f=i(h);f.i<f.layers.length||d.length>0;)if(f.i>=f.layers.length){if(d.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}f=d.pop()}else{var p=f.layers[f.i];if(f.i++,"tilelayer"===p.type)if(p.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+p.name+"'");else{if(p.encoding&&"base64"===p.encoding){if(p.chunks)for(var g=0;g<p.chunks.length;g++)p.chunks[g].data=t(p.chunks[g].data);p.data&&(p.data=t(p.data)),delete p.encoding}var v,m,y,x,w,b,T=[],S=0;if(u){var E=s(p,"startx",0)+p.x,_=s(p,"starty",0)+p.y;(v=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+E*h.tilewidth,y:f.y+s(p,"offsety",0)+_*h.tileheight,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(v.hexSideLength=h.hexsidelength,v.staggerAxis=h.staggeraxis,v.staggerIndex=h.staggerindex,"y"===v.staggerAxis?(w=(v.tileHeight-v.hexSideLength)/2,v.widthInPixels=v.tileWidth*(v.width+.5),v.heightInPixels=v.height*(v.hexSideLength+w)+w):(b=(v.tileWidth-v.hexSideLength)/2,v.widthInPixels=v.width*(v.hexSideLength+b)+b,v.heightInPixels=v.tileHeight*(v.height+.5)));for(var C=0;C<p.height;C++){T[C]=[null];for(var A=0;A<p.width;A++)T[C][A]=null}for(C=0,N=p.chunks.length;C<N;C++)for(var P=p.chunks[C],M=P.x-E,R=P.y-_,L=0,O=0,F=P.data.length;O<F;O++){var D=S+M,I=L+R;(m=a(P.data[O])).gid>0?((y=new o(v,m.gid,D,I,h.tilewidth,h.tileheight)).rotation=m.rotation,y.flipX=m.flipped,T[I][D]=y):(x=l?null:new o(v,-1,D,I,h.tilewidth,h.tileheight),T[I][D]=x),++S===P.width&&(L++,S=0)}}else{(v=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+p.x,y:f.y+s(p,"offsety",0)+p.y,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(v.hexSideLength=h.hexsidelength,v.staggerAxis=h.staggeraxis,v.staggerIndex=h.staggerindex,"y"===v.staggerAxis?(w=(v.tileHeight-v.hexSideLength)/2,v.widthInPixels=v.tileWidth*(v.width+.5),v.heightInPixels=v.height*(v.hexSideLength+w)+w):(b=(v.tileWidth-v.hexSideLength)/2,v.widthInPixels=v.width*(v.hexSideLength+b)+b,v.heightInPixels=v.tileHeight*(v.height+.5)));for(var k=[],B=0,N=p.data.length;B<N;B++)(m=a(p.data[B])).gid>0?((y=new o(v,m.gid,S,T.length,h.tilewidth,h.tileheight)).rotation=m.rotation,y.flipX=m.flipped,k.push(y)):(x=l?null:new o(v,-1,S,T.length,h.tilewidth,h.tileheight),k.push(x)),++S===p.width&&(T.push(k),S=0,k=[])}v.data=T,c.push(v)}else if("group"===p.type){var z=i(h,p,f);d.push(f),f=z}}return c}}function $lt(){if(Pot)return Aot;Pot=1;var t=new(Kh())({initialize:function(t,e,i,n,s,r,a){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===s&&(s=0),void 0===r&&(r=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|i,this.imageHeight=0|n,this.imageMargin=0|s,this.imageSpacing=0|r,this.properties=a||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e,i,n){return this.images.push({gid:t,image:e,width:i,height:n}),this.total++,this}});return Aot=t}function Qlt(){if(Oot)return Lot;Oot=1;var t=Ylt(),e=$lt(),i=jlt(),n=(Rot||(Rot=1,Mot=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],s=i;if(n.name&&""!==n.name&&(s=n.name),Array.isArray(n.wangtiles)&&n.wangtiles.length>0){var r,a,o,h={},l={};if(Array.isArray(n.edgecolors))for(r=0;r<n.edgecolors.length;r++)o=1+r,""!==(a=n.edgecolors[r]).name&&(h[o]=a.name);if(Array.isArray(n.cornercolors))for(r=0;r<n.cornercolors.length;r++)o=1+r,""!==(a=n.cornercolors[r]).name&&(l[o]=a.name);if(Array.isArray(n.colors))for(r=0;r<n.colors.length;r++)o=1+r,""!==(a=n.colors[r]).name&&(h[o]=l[o]=a.name);for(var u=[h,l,h,l,h,l,h,l],c=0;c<n.wangtiles.length;c++){var d=n.wangtiles[c],f=e[d.tileid]||(e[d.tileid]={});f=f.wangid||(f.wangid={});for(var p=[],g=0;g<Math.min(u.length,d.wangid.length);g++)if(0!==(a=d.wangid[g])){var v=u[g][a];void 0===v?p.push(a):p.push(v)}else p.push(void 0);f[s]=p}}}}),Mot);return Lot=function(s){for(var r,a=[],o=[],h=null,l=0;l<s.tilesets.length;l++){var u=s.tilesets[l];if(u.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(u.image){var c=new t(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,void 0,void 0,u.tileoffset);if(s.version>1){var d=void 0,f=void 0;if(Array.isArray(u.tiles)){d=d||{},f=f||{};for(var p=0;p<u.tiles.length;p++){var g=u.tiles[p];if(g.properties){var v={};g.properties.forEach(function(t){v[t.name]=t.value}),f[g.id]=v}if(g.objectgroup&&((d[g.id]||(d[g.id]={})).objectgroup=g.objectgroup,g.objectgroup.objects)){var m=g.objectgroup.objects.map(function(t){return i(t)});d[g.id].objectgroup.objects=m}g.animation&&((d[g.id]||(d[g.id]={})).animation=g.animation),g.type&&((d[g.id]||(d[g.id]={})).type=g.type)}}Array.isArray(u.wangsets)&&(d=d||{},f=f||{},n(u.wangsets,d)),d&&(c.tileData=d,c.tileProperties=f)}else if(u.tileproperties&&(c.tileProperties=u.tileproperties),u.tiles)for(r in c.tileData=u.tiles,c.tileData){var y=c.tileData[r].objectgroup;if(y&&y.objects){var x=y.objects.map(function(t){return i(t)});c.tileData[r].objectgroup.objects=x}}c.updateTileData(u.imagewidth,u.imageheight),a.push(c)}else{var w=new e(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,u.properties),b=0;for(p=0;p<u.tiles.length;p++){var T=(g=u.tiles[p]).image,S=parseInt(g.id,10),E=u.firstgid+S,_=g.imagewidth,C=g.imageheight;w.addImage(E,T,_,C),b=Math.max(S,b)}w.maxId=b,o.push(w)}h&&(h.lastgid=u.firstgid-1),h=u}return{tilesets:a,imageCollections:o}}}function tut(){if(Dot)return Fot;Dot=1;var t=Ult(),e=Xlt(),i=mht(),n=uc(),s=Nit(),r=Ilt(),a=Blt(),o=Wlt(),h=Klt(),l=Jlt(),u=Qlt();return Fot=function(c,d,f){var p=n(d),g=new a({width:p.width,height:p.height,name:c,tileWidth:p.tilewidth,tileHeight:p.tileheight,orientation:r(p.orientation),format:s.TILED_JSON,version:p.version,properties:p.properties,renderOrder:p.renderorder,infinite:p.infinite});if(g.orientation===i.HEXAGONAL)if(g.hexSideLength=p.hexsidelength,g.staggerAxis=p.staggeraxis,g.staggerIndex=p.staggerindex,"y"===g.staggerAxis){var v=(g.tileHeight-g.hexSideLength)/2;g.widthInPixels=g.tileWidth*(g.width+.5),g.heightInPixels=g.height*(g.hexSideLength+v)+v}else{var m=(g.tileWidth-g.hexSideLength)/2;g.widthInPixels=g.width*(g.hexSideLength+m)+m,g.heightInPixels=g.tileHeight*(g.height+.5)}g.layers=l(p,f),g.images=o(p);var y=u(p);return g.tilesets=y.tilesets,g.imageCollections=y.imageCollections,g.objects=h(p),g.tiles=e(g),t(g),g},Fot}function eut(){if(kot)return Iot;kot=1;var t=klt(),e=Sht();return Iot=function(i,n){for(var s=[],r=0;r<i.layer.length;r++){for(var a=i.layer[r],o=new t({name:a.name,width:a.width,height:a.height,tileWidth:a.tilesize,tileHeight:a.tilesize,visible:1===a.visible}),h=[],l=[],u=0;u<a.data.length;u++){for(var c=0;c<a.data[u].length;c++){var d,f=a.data[u][c]-1;d=f>-1?new e(o,f,c,u,a.tilesize,a.tilesize):n?null:new e(o,-1,c,u,a.tilesize,a.tilesize),h.push(d)}l.push(h),h=[]}o.data=l,s.push(o)}return s}}function iut(){if(Not)return Bot;Not=1;var t=Ylt();return Bot=function(e){for(var i=[],n=[],s=0;s<e.layer.length;s++){var r=e.layer[s],a=r.tilesetName;""!==a&&-1===n.indexOf(a)&&(n.push(a),i.push(new t(a,0,r.tilesize,r.tilesize,0,0)))}return i}}function nut(){if(Uot)return zot;Uot=1;var t=Nit(),e=Blt(),i=eut(),n=iut();return zot=function(s,r,a){if(0===r.layer.length)return console.warn("No layers found in the Weltmeister map: "+s),null;for(var o=0,h=0,l=0;l<r.layer.length;l++)r.layer[l].width>o&&(o=r.layer[l].width),r.layer[l].height>h&&(h=r.layer[l].height);var u=new e({width:o,height:h,name:s,tileWidth:r.layer[0].tilesize,tileHeight:r.layer[0].tilesize,format:t.WELTMEISTER});return u.layers=i(r,a),u.tilesets=n(r),u},zot}function sut(){if(Xot)return Yot;Xot=1;var t=Nit(),e=Nlt(),i=zlt(),n=tut(),s=nut();return Yot=function(r,a,o,h,l,u){var c;switch(a){case t.ARRAY_2D:c=e(r,o,h,l,u);break;case t.CSV:c=i(r,o,h,l,u);break;case t.TILED_JSON:c=n(r,o,u);break;case t.WELTMEISTER:c=s(r,o,u);break;default:console.warn("Unrecognized tilemap data format: "+a),c=null}return c},Yot}function rut(){if(iht)return eht;iht=1;var t=qh(),e=t,i=t;return e=function(){if($ot)return Jot;$ot=1;var t=_W();return Jot=function(e,i,n){var s=i.cull(n),r=s.length,a=n.alpha*i.alpha;if(!(0===r||a<=0)){var o=i.gidMap,h=e.pipelines.set(i.pipeline,i),l=t.getTintAppendFloatAlpha,u=i.scrollFactorX,c=i.scrollFactorY,d=i.x,f=i.y,p=i.scaleX,g=i.scaleY;e.pipelines.preBatch(i);for(var v=0;v<r;v++){var m=s[v],y=o[m.index];if(y){var x=y.getTileTextureCoordinates(m.index),w=y.tileWidth,b=y.tileHeight;if(x&&0!==w&&0!==b){var T=.5*w,S=.5*b,E=y.glTexture,_=h.setTexture2D(E,i),C=w,A=b,P=x.x,M=x.y,R=y.tileOffset.x,L=y.tileOffset.y,O=l(m.tint,a*m.alpha);h.batchTexture(i,E,E.width,E.height,d+m.pixelX*p+(T*p-R),f+m.pixelY*g+(S*g-L),w,b,p,g,m.rotation,m.flipX,m.flipY,u,c,T,S,P,M,C,A,O,O,O,O,m.tintFill,0,0,n,null,!0,_,!0)}}}e.pipelines.postBatch(i)}},Jot}(),i=function(){if(tht)return Qot;tht=1;var t=yc(),e=new t,i=new t,n=new t;return Qot=function(t,s,r,a){var o=s.cull(r),h=o.length,l=r.alpha*s.alpha;if(!(0===h||l<=0)){var u=e,c=i,d=n;c.applyITRS(s.x,s.y,s.rotation,s.scaleX,s.scaleY),u.copyFrom(r.matrix);var f=t.currentContext,p=s.gidMap;f.save(),a?(u.multiplyWithOffset(a,-r.scrollX*s.scrollFactorX,-r.scrollY*s.scrollFactorY),c.e=s.x,c.f=s.y,u.multiply(c,d),d.copyToContext(f)):(c.e-=r.scrollX*s.scrollFactorX,c.f-=r.scrollY*s.scrollFactorY,c.copyToContext(f)),(!t.antialias||s.scaleX>1||s.scaleY>1)&&(f.imageSmoothingEnabled=!1);for(var g=0;g<h;g++){var v=o[g],m=p[v.index];if(m){var y=m.image.getSourceImage(),x=m.getTileTextureCoordinates(v.index),w=m.tileWidth,b=m.tileHeight;if(null!==x&&0!==w&&0!==b){var T=.5*w,S=.5*b;x.x+=m.tileOffset.x,x.y+=m.tileOffset.y,f.save(),f.translate(v.pixelX+T,v.pixelY+S),0!==v.rotation&&f.rotate(v.rotation),(v.flipX||v.flipY)&&f.scale(v.flipX?-1:1,v.flipY?-1:1),f.globalAlpha=l*v.alpha,f.drawImage(y,x.x,x.y,w,b,-T,-S,w,b),f.restore()}}}f.restore()}},Qot}(),eht={renderWebGL:e,renderCanvas:i}}function aut(){if(sht)return nht;sht=1;var t=Kh(),e=Jit(),i=_c(),n=fU(),s=Dlt(),r=rut(),a=qu(),o=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.Transform,i.Visible,i.ScrollFactor,e,r],initialize:function(t,e,i,r,o,h){n.call(this,t,"TilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=i,this.layer=e.layers[i],this.layer.tilemapLayer=this,this.tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=s.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.tempVec=new a,this.collisionCategory=1,this.collisionMask=1,this.setTilesets(r),this.setAlpha(this.layer.alpha),this.setPosition(o,h),this.setOrigin(0,0),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline(),this.initPostPipeline(!1)},setTilesets:function(t){var e=[],i=[],n=this.tilemap;Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];if("string"==typeof r&&(r=n.getTileset(r)),r){i.push(r);for(var a=r.firstgid,o=0;o<r.total;o++)e[a+o]=r}}this.gidMap=e,this.tileset=i},setRenderOrder:function(t){return"string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return s.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,i,n){return s.CalculateFacesWithin(t,e,i,n,this.layer),this},createFromTiles:function(t,e,i,n,r){return s.CreateFromTiles(t,e,i,n,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,i,n,r,a,o){return s.Copy(t,e,i,n,r,a,o,this.layer),this},fill:function(t,e,i,n,r,a){return s.Fill(t,e,i,n,r,a,this.layer),this},filterTiles:function(t,e,i,n,r,a,o){return s.FilterTiles(t,e,i,n,r,a,o,this.layer)},findByIndex:function(t,e,i){return s.FindByIndex(t,e,i,this.layer)},findTile:function(t,e,i,n,r,a,o){return s.FindTile(t,e,i,n,r,a,o,this.layer)},forEachTile:function(t,e,i,n,r,a,o){return s.ForEachTile(t,e,i,n,r,a,o,this.layer),this},setTint:function(t,e,i,n,s,r){void 0===t&&(t=16777215);return this.forEachTile(function(e){e.tint=t,e.tintFill=!1},this,e,i,n,s,r)},setTintFill:function(t,e,i,n,s,r){void 0===t&&(t=16777215);return this.forEachTile(function(e){e.tint=t,e.tintFill=!0},this,e,i,n,s,r)},getTileAt:function(t,e,i){return s.GetTileAt(t,e,i,this.layer)},getTileAtWorldXY:function(t,e,i,n){return s.GetTileAtWorldXY(t,e,i,n,this.layer)},getIsoTileAtWorldXY:function(t,e,i,n,r){void 0===i&&(i=!0);var a=this.tempVec;return s.IsometricWorldToTileXY(t,e,!0,a,r,this.layer,i),this.getTileAt(a.x,a.y,n)},getTilesWithin:function(t,e,i,n,r){return s.GetTilesWithin(t,e,i,n,r,this.layer)},getTilesWithinShape:function(t,e,i){return s.GetTilesWithinShape(t,e,i,this.layer)},getTilesWithinWorldXY:function(t,e,i,n,r,a){return s.GetTilesWithinWorldXY(t,e,i,n,r,a,this.layer)},hasTileAt:function(t,e){return s.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,i){return s.HasTileAtWorldXY(t,e,i,this.layer)},putTileAt:function(t,e,i,n){return s.PutTileAt(t,e,i,n,this.layer)},putTileAtWorldXY:function(t,e,i,n,r){return s.PutTileAtWorldXY(t,e,i,n,r,this.layer)},putTilesAt:function(t,e,i,n){return s.PutTilesAt(t,e,i,n,this.layer),this},randomize:function(t,e,i,n,r){return s.Randomize(t,e,i,n,r,this.layer),this},removeTileAt:function(t,e,i,n){return s.RemoveTileAt(t,e,i,n,this.layer)},removeTileAtWorldXY:function(t,e,i,n,r){return s.RemoveTileAtWorldXY(t,e,i,n,r,this.layer)},renderDebug:function(t,e){return s.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,i,n,r,a){return s.ReplaceByIndex(t,e,i,n,r,a,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,i,n){return s.SetCollision(t,e,i,this.layer,n),this},setCollisionBetween:function(t,e,i,n){return s.SetCollisionBetween(t,e,i,n,this.layer),this},setCollisionByProperty:function(t,e,i){return s.SetCollisionByProperty(t,e,i,this.layer),this},setCollisionByExclusion:function(t,e,i){return s.SetCollisionByExclusion(t,e,i,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return s.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,i){return s.SetTileIndexCallback(t,e,i,this.layer),this},setTileLocationCallback:function(t,e,i,n,r,a){return s.SetTileLocationCallback(t,e,i,n,r,a,this.layer),this},shuffle:function(t,e,i,n){return s.Shuffle(t,e,i,n,this.layer),this},swapByIndex:function(t,e,i,n,r,a){return s.SwapByIndex(t,e,i,n,r,a,this.layer),this},tileToWorldX:function(t,e){return this.tilemap.tileToWorldX(t,e,this)},tileToWorldY:function(t,e){return this.tilemap.tileToWorldY(t,e,this)},tileToWorldXY:function(t,e,i,n){return this.tilemap.tileToWorldXY(t,e,i,n,this)},getTileCorners:function(t,e,i){return this.tilemap.getTileCorners(t,e,i,this)},weightedRandomize:function(t,e,i,n,r){return s.WeightedRandomize(e,i,n,r,t,this.layer),this},worldToTileX:function(t,e,i){return this.tilemap.worldToTileX(t,e,i,this)},worldToTileY:function(t,e,i){return this.tilemap.worldToTileY(t,e,i,this)},worldToTileXY:function(t,e,i,n,s){return this.tilemap.worldToTileXY(t,e,i,n,s,this)},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],n.prototype.destroy.call(this))}});return nht=o}function out(){if(aht)return rht;aht=1;var t=Xlt(),e=Kh(),i=ac(),n=Nit(),s=jh(),r=klt(),a=function(){if(Zot)return Kot;Zot=1;var t=new(Kh())({initialize:function(t){if(this.gids=[],void 0!==t)for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.total;++n)this.gids[i.firstgid+n]=i;this._gids=this.gids},enabled:{get:function(){return!!this.gids},set:function(t){this.gids=t?this._gids:void 0}},getTypeIncludingTile:function(t){if(void 0!==t.type&&""!==t.type)return t.type;if(this.gids&&void 0!==t.gid){var e=this.gids[t.gid];if(e){var i=e.getTileData(t.gid);if(i)return i.type}}},setTextureAndFrame:function(t,e,i,n){if(null===e&&this.gids&&void 0!==n.gid){var s=this.gids[n.gid];s&&(null===e&&void 0!==s.image&&(e=s.image.key),null===i&&(i=n.gid-s.firstgid),t.scene.textures.getFrame(e,i)||(e=null,i=null))}t.setTexture(e,i)},setPropertiesFromTiledObject:function(t,e){if(void 0!==this.gids&&void 0!==e.gid){var i=this.gids[e.gid];void 0!==i&&this.setFromJSON(t,i.getTileProperties(e.gid))}this.setFromJSON(t,e.properties)},setFromJSON:function(t,e){if(e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];void 0!==t[n.name]?t[n.name]=n.value:t.setData(n.name,n.value)}else for(var s in e)void 0!==t[s]?t[s]=e[s]:t.setData(s,e[s])}});return Kot=t}(),o=mht(),h=eW(),l=Kl(),u=tq(),c=Sht(),d=Dlt(),f=aut(),p=Ylt(),g=new e({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tiles=e.tiles,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0,this.hexSideLength=e.hexSideLength;var i=this.orientation;this._convert={WorldToTileXY:d.GetWorldToTileXYFunction(i),WorldToTileX:d.GetWorldToTileXFunction(i),WorldToTileY:d.GetWorldToTileYFunction(i),TileToWorldXY:d.GetTileToWorldXYFunction(i),TileToWorldX:d.GetTileToWorldXFunction(i),TileToWorldY:d.GetTileToWorldYFunction(i),GetTileCorners:d.GetTileCornersFunction(i)}},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"==typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(e,i,s,r,a,o,h,l){if(void 0===e)return null;null==i&&(i=e);var u=this.scene.sys.textures;if(!u.exists(i))return console.warn('Texture key "%s" not found',i),null;var c=u.get(i),d=this.getTilesetIndex(e);if(null===d&&this.format===n.TILED_JSON)return console.warn('Tilemap has no tileset "%s". Its tilesets are %o',e,this.tilesets),null;var f=this.tilesets[d];return f?((s||r)&&f.setTileSize(s,r),(a||o)&&f.setSpacing(a,o),f.setImage(c),f):(void 0===s&&(s=this.tileWidth),void 0===r&&(r=this.tileHeight),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l={x:0,y:0}),(f=new p(e,h,s,r,a,o,void 0,void 0,l)).setImage(c),this.tilesets.push(f),this.tiles=t(this),f)},copy:function(t,e,i,n,s,r,a,o){return null!==(o=this.getLayer(o))?(d.Copy(t,e,i,n,s,r,a,o),this):null},createBlankLayer:function(t,e,i,n,s,a,o,h){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=this.tileWidth),void 0===h&&(h=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var l,u=new r({name:t,tileWidth:o,tileHeight:h,width:s,height:a,orientation:this.orientation,hexSideLength:this.hexSideLength}),d=0;d<a;d++){l=[];for(var p=0;p<s;p++)l.push(new c(u,-1,p,d,o,h,this.tileWidth,this.tileHeight));u.data.push(l)}this.layers.push(u),this.currentLayerIndex=this.layers.length-1;var g=new f(this.scene,this,this.currentLayerIndex,e,i,n);return g.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(g),g},createLayer:function(t,e,i,n){var s=this.getLayerIndex(t);if(null===s)return console.warn("Invalid Tilemap Layer ID: "+t),"string"==typeof t&&console.warn("Valid tilelayer names: %o",this.getTileLayerNames()),null;var r=this.layers[s];if(r.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=s,void 0===i&&(i=r.x),void 0===n&&(n=r.y);var a=new f(this.scene,this,s,e,i,n);return a.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(a),a},createFromObjects:function(t,e,n){void 0===n&&(n=!0);var r=[],l=this.getObjectLayer(t);if(!l)return console.warn("createFromObjects: Invalid objectLayerName given: "+t),r;var c=new a(n?this.tilesets:void 0);Array.isArray(e)||(e=[e]);for(var d=l.objects,f=0;f<e.length;f++){var p,g=e[f],v=s(g,"id",null),m=s(g,"gid",null),y=s(g,"name",null),x=s(g,"type",null);c.enabled=!s(g,"ignoreTileset",null);for(var w=[],b=0;b<d.length;b++)p=d[b],(null===v&&null===m&&null===y&&null===x||null!==v&&p.id===v||null!==m&&p.gid===m||null!==y&&p.name===y||null!==x&&c.getTypeIncludingTile(p)===x)&&w.push(p);for(var T=s(g,"classType",u),S=s(g,"scene",this.scene),E=s(g,"container",null),_=s(g,"key",null),C=s(g,"frame",null),A=0;A<w.length;A++){p=w[A];var P=new T(S);if(P.setName(p.name),P.setPosition(p.x,p.y),c.setTextureAndFrame(P,_,C,p),p.width&&(P.displayWidth=p.width),p.height&&(P.displayHeight=p.height),this.orientation===o.ISOMETRIC){var M=this.tileWidth/this.tileHeight,R={x:P.x-P.y,y:(P.x+P.y)/M};P.x=R.x,P.y=R.y}var L={x:P.originX*p.width,y:(P.originY-(p.gid?1:0))*p.height};if(p.rotation){var O=i(p.rotation);h(L,O),P.rotation=O}P.x+=L.x,P.y+=L.y,void 0===p.flippedHorizontal&&void 0===p.flippedVertical||P.setFlip(p.flippedHorizontal,p.flippedVertical),p.visible||(P.visible=!1),c.setPropertiesFromTiledObject(P,p),E?E.add(P):S.add.existing(P),r.push(P)}}return r},createFromTiles:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.CreateFromTiles(t,e,i,n,s,r)},fill:function(t,e,i,n,s,r,a){return void 0===r&&(r=!0),null===(a=this.getLayer(a))?null:(d.Fill(t,e,i,n,s,r,a),this)},filterObjects:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.filter(e,i)},filterTiles:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FilterTiles(t,e,i,n,s,r,a,o)},findByIndex:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.FindByIndex(t,e,i,n)},findObject:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.find(e,i)||null},findTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FindTile(t,e,i,n,s,r,a,o)},forEachTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:(d.ForEachTile(t,e,i,n,s,r,a,o),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map(function(t){return t.name}):[]},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map(function(t){return t.name}):[]},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"==typeof t?this.getLayerIndexByName(t):"number"==typeof t&&t<this.layers.length?t:t instanceof f&&t.tilemap===this?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTileAt(t,e,i,n)},getTileAtWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:d.GetTileAtWorldXY(t,e,i,n,s)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map(function(t){return t.name}):[]},getTilesWithin:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.GetTilesWithin(t,e,i,n,s,r)},getTilesWithinShape:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTilesWithinShape(t,e,i,n)},getTilesWithinWorldXY:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:d.GetTilesWithinWorldXY(t,e,i,n,s,r,a)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,i){return null===(i=this.getLayer(i))?null:d.HasTileAt(t,e,i)},hasTileAtWorldXY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.HasTileAtWorldXY(t,e,i,n)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.PutTileAt(t,e,i,n,s)},putTileAtWorldXY:function(t,e,i,n,s,r){return void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.PutTileAtWorldXY(t,e,i,n,s,r)},putTilesAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.PutTilesAt(t,e,i,n,s),this)},randomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.Randomize(t,e,i,n,s,r),this)},calculateFacesAt:function(t,e,i){return null===(i=this.getLayer(i))?null:(d.CalculateFacesAt(t,e,i),this)},calculateFacesWithin:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.CalculateFacesWithin(t,e,i,n,s),this)},removeLayer:function(t){var e=this.getLayerIndex(t);if(null!==e){l(this.layers,e);for(var i=e;i<this.layers.length;i++)this.layers[i].tilemapLayer&&this.layers[i].tilemapLayer.layerIndex--;return this.currentLayerIndex===e&&(this.currentLayerIndex=0),this}return null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).tilemapLayer.destroy(),l(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=!0);var n=[];Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];n.push(this.removeTileAt(r.x,r.y,!0,i,r.tilemapLayer)),e>-1&&this.putTileAt(e,r.x,r.y,i,r.tilemapLayer)}return n},removeTileAt:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.RemoveTileAt(t,e,i,n,s)},removeTileAtWorldXY:function(t,e,i,n,s,r){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.RemoveTileAtWorldXY(t,e,i,n,s,r)},renderDebug:function(t,e,i){return null===(i=this.getLayer(i))?null:(this.orientation===o.ORTHOGONAL&&d.RenderDebug(t,e,i),this)},renderDebugFull:function(t,e){for(var i=this.layers,n=0;n<i.length;n++)d.RenderDebug(t,e,i[n]);return this},replaceByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.ReplaceByIndex(t,e,i,n,s,r,a),this)},setCollision:function(t,e,i,n,s){return void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===s&&(s=!0),null===(n=this.getLayer(n))?null:(d.SetCollision(t,e,i,n,s),this)},setCollisionBetween:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.SetCollisionBetween(t,e,i,n,s),this)},setCollisionByProperty:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByProperty(t,e,i,n),this)},setCollisionByExclusion:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByExclusion(t,e,i,n),this)},setCollisionFromCollisionGroup:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),null===(i=this.getLayer(i))?null:(d.SetCollisionFromCollisionGroup(t,e,i),this)},setTileIndexCallback:function(t,e,i,n){return null===(n=this.getLayer(n))?null:(d.SetTileIndexCallback(t,e,i,n),this)},setTileLocationCallback:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SetTileLocationCallback(t,e,i,n,s,r,a),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var i=0;i<this.layers.length;i++){this.layers[i].baseTileWidth=t,this.layers[i].baseTileHeight=e;for(var n=this.layers[i].data,s=this.layers[i].width,r=this.layers[i].height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,i){if(null===(i=this.getLayer(i)))return this;i.tileWidth=t,i.tileHeight=e;for(var n=i.data,s=i.width,r=i.height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(t,e)}return this},shuffle:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.Shuffle(t,e,i,n,s),this)},swapByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SwapByIndex(t,e,i,n,s,r,a),this)},tileToWorldX:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldX(t,e,i)},tileToWorldY:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldY(t,e,i)},tileToWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:this._convert.TileToWorldXY(t,e,i,n,s)},getTileCorners:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.GetTileCorners(t,e,i,n)},weightedRandomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.WeightedRandomize(e,i,n,s,t,r),this)},worldToTileX:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileX(t,e,i,n)},worldToTileY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileY(t,e,i,n)},worldToTileXY:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:this._convert.WorldToTileXY(t,e,i,n,s,r)},destroy:function(){this.removeAllLayers(),this.tiles.length=0,this.tilesets.length=0,this.objects.length=0,this.scene=null}});return rht=g}function hut(){if(hht)return oht;hht=1;var t=Nit(),e=Blt(),i=sut(),n=out();return oht=function(s,r,a,o,h,l,u,c){void 0===a&&(a=32),void 0===o&&(o=32),void 0===h&&(h=10),void 0===l&&(l=10),void 0===c&&(c=!1);var d=null;if(Array.isArray(u))d=i(void 0!==r?r:"map",t.ARRAY_2D,u,a,o,c);else if(void 0!==r){var f=s.cache.tilemap.get(r);f?d=i(r,f.format,f.data,a,o,c):console.warn("No map data found for key "+r)}return null===d&&(d=new e({tileWidth:a,tileHeight:o,width:h,height:l})),new n(s,d)},oht}var lut,uut={};function cut(){if(lut)return uut;lut=1;var t=DV(),e=hut();return t.register("tilemap",function(t){var i=void 0!==t?t:{};return e(this.scene,i.key,i.tileWidth,i.tileHeight,i.width,i.height,i.data,i.insertNull)}),uut}var dut,fut,put,gut,vut,mut,yut,xut,wut,but,Tut,Sut,Eut,_ut,Cut,Aut,Put,Mut,Rut,Lut,Out,Fut,Dut,Iut,kut,But,Nut,zut,Uut,Yut,Xut,Gut,Wut,Hut,Vut,jut,qut,Kut,Zut,Jut,$ut,Qut,tct,ect,ict,nct,sct,rct,act,oct,hct,lct,uct,cct,dct,fct,pct,gct,vct,mct,yct,xct,wct,bct,Tct,Sct,Ect,_ct,Cct,Act,Pct,Mct,Rct,Lct,Oct,Fct,Dct,Ict,kct,Bct,Nct,zct,Uct,Yct,Xct,Gct,Wct,Hct,Vct,jct,qct,Kct,Zct,Jct,$ct,Qct,tdt,edt={};function idt(){if(dut)return edt;dut=1;var t=ic(),e=hut();return t.register("tilemap",function(t,i,n,s,r,a,o){return null===t&&(t=void 0),null===i&&(i=void 0),null===n&&(n=void 0),null===s&&(s=void 0),null===r&&(r=void 0),e(this.scene,t,i,n,s,r,a,o)}),edt}function ndt(){if(put)return fut;put=1;var t=nh(),e=function(){if(dst)return cst;dst=1;var t={ORIENTATION:mht()};return cst=t}(),i={Components:Dlt(),Parsers:qot?jot:(qot=1,jot={FromOrientationString:Ilt(),Parse:sut(),Parse2DArray:Nlt(),ParseCSV:zlt(),Impact:Wot?Got:(Wot=1,Got={ParseTileLayers:eut(),ParseTilesets:iut(),ParseWeltmeister:nut()}),Tiled:Vot?Hot:(Vot=1,Hot={AssignTileProperties:Ult(),Base64Decode:Zlt(),BuildTilesetIndex:Xlt(),CreateGroupLayer:Glt(),ParseGID:Vlt(),ParseImageLayers:Wlt(),ParseJSONTiled:tut(),ParseObject:jlt(),ParseObjectLayers:Klt(),ParseTileLayers:Jlt(),ParseTilesets:Qlt()})}),Formats:Nit(),ImageCollection:$lt(),ParseToTilemap:hut(),Tile:Sht(),Tilemap:out(),TilemapCreator:cut(),TilemapFactory:idt(),Tileset:Ylt(),TilemapLayer:aut(),Orientation:mht(),LayerData:klt(),MapData:Blt(),ObjectLayer:qlt()};return i=t(!1,i,e.ORIENTATION),fut=i}function sdt(){if(vut)return gut;vut=1;var t=Kh(),e=jh(),i=new t({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){if(this.delay=e(t,"delay",0),this.repeat=e(t,"repeat",0),this.loop=e(t,"loop",!1),this.callback=e(t,"callback",void 0),this.callbackScope=e(t,"callbackScope",this),this.args=e(t,"args",[]),this.timeScale=e(t,"timeScale",1),this.startAt=e(t,"startAt",0),this.paused=e(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/t}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});return gut=i}function rdt(){if(yut)return mut;yut=1;var t=Kh(),e=tc(),i=ec(),n=sdt(),s=Zl(),r=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(i.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var t=this.systems.events;t.on(i.PRE_UPDATE,this.preUpdate,this),t.on(i.UPDATE,this.update,this),t.once(i.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;if(t instanceof n){if(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=-1===e.repeat||e.loop?999999999999:e.repeat,e.delay<=0&&e.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else e=new n(t);return this._pendingInsertion.push(e),e},delayedCall:function(t,e,i,n){return this.addEvent({delay:t,callback:e,args:i,callbackScope:n})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];s(this._pendingRemoval,i),s(this._pendingInsertion,i),s(this._active,i)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var i,n;for(i=0;i<t;i++){n=this._pendingRemoval[i];var s=this._active.indexOf(n);s>-1&&this._active.splice(s,1),n.destroy()}for(i=0;i<e;i++)n=this._pendingInsertion[i],this._active.push(n);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var i=0;i<this._active.length;i++){var n=this._active[i];if(!n.paused&&(n.elapsed+=e*n.timeScale,n.elapsed>=n.delay)){var s=n.elapsed-n.delay;if(n.elapsed=n.delay,!n.hasDispatched&&n.callback&&(n.hasDispatched=!0,n.callback.apply(n.callbackScope,n.args)),n.repeatCount>0){if(n.repeatCount--,s>=n.delay)for(;s>=n.delay&&n.repeatCount>0;)n.callback&&n.callback.apply(n.callbackScope,n.args),s-=n.delay,n.repeatCount--;n.elapsed=s,n.hasDispatched=!1}else n.hasDispatched&&this._pendingRemoval.push(n)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(i.PRE_UPDATE,this.preUpdate,this),e.off(i.UPDATE,this.update,this),e.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null}});return e.register("Clock",r,"time"),mut=r}function adt(){return Tut?but:(Tut=1,but={COMPLETE:wut?xut:(wut=1,xut="complete")})}function odt(){if(Eut)return Sut;Eut=1;var t=Kh(),e=cU(),i=ic(),n=jh(),s=ec(),r=adt(),a=new t({Extends:e,initialize:function(t,i){e.call(this),this.scene=t,this.systems=t.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var n=this.systems.events;n.on(s.PRE_UPDATE,this.preUpdate,this),n.on(s.UPDATE,this.update,this),n.once(s.SHUTDOWN,this.destroy,this),i&&this.add(i)},preUpdate:function(t,e){this.paused||(this.elapsed+=e*this.timeScale)},update:function(){if(!this.paused&&!this.complete){var t,e,i=this.events,n=!1,s=this.systems;for(t=0;t<i.length;t++){var a=i[t];if(!a.complete&&a.time<=this.elapsed){if(a.complete=!0,this.totalComplete++,e=a.target?a.target:this,a.if&&!a.if.call(e,a))continue;if(a.once&&(n=!0),a.set&&a.target)for(var o in a.set)a.target[o]=a.set[o];this.iteration&&a.repeat++,a.loop&&a.repeat&&a.loop.call(e),a.tween&&(a.tweenInstance=s.tweens.add(a.tween)),a.sound&&("string"==typeof a.sound?s.sound.play(a.sound):s.sound.play(a.sound.key,a.sound.config)),a.event&&this.emit(a.event,e),a.run&&a.run.call(e),a.stop&&this.stop()}}if(n)for(t=0;t<i.length;t++)i[t].complete&&i[t].once&&(i.splice(t,1),t--);this.totalComplete>=i.length&&(0!==this.loop&&(-1===this.loop||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(r.COMPLETE,this)}},play:function(t){return void 0===t&&(t=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,t&&this.reset(),this},pause:function(){this.paused=!0;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!0)}return this},repeat:function(t){return void 0!==t&&!0!==t||(t=-1),!1===t&&(t=0),this.loop=t,this},resume:function(){this.paused=!1;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(t){void 0===t&&(t=!1),this.elapsed=0,t||(this.iteration=0);for(var e=this.events,i=0;i<e.length;i++){var n=e[i];n.complete=!1,t||(n.repeat=0),n.tweenInstance&&n.tweenInstance.stop()}return this.play(!1)},add:function(t){Array.isArray(t)||(t=[t]);var e=this.events,i=0;e.length>0&&(i=e[e.length-1].time);for(var s=0;s<t.length;s++){var r=t[s],a=n(r,"at",0),o=n(r,"in",null);null!==o&&(a=this.elapsed+o);var h=n(r,"from",null);null!==h&&(a=i+h),e.push({complete:!1,time:a,repeat:0,if:n(r,"if",null),run:n(r,"run",null),loop:n(r,"loop",null),event:n(r,"event",null),target:n(r,"target",null),set:n(r,"set",null),tween:n(r,"tween",null),sound:n(r,"sound",null),once:n(r,"once",!1),stop:n(r,"stop",!1)}),i=a}return this.complete=!1,this},clear:function(){for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&i.tweenInstance.stop()}return t=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){return Math.min(this.totalComplete,this.events.length)/this.events.length},destroy:function(){var t=this.systems.events;t.off(s.PRE_UPDATE,this.preUpdate,this),t.off(s.UPDATE,this.update,this),t.off(s.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});return i.register("timeline",function(t){return new a(this.scene,t)}),Sut=a}function hdt(){if(Put)return Aut;Put=1;return Aut=function(t,e,i){var n;t.hasOwnProperty(e)?n="function"===typeof t[e]?function(i,n,s,r,a,o){return t[e](i,n,s,r,a,o)}:function(){return t[e]}:n="function"==typeof i?i:function(){return i};return n},Aut}function ldt(){if(Out)return Lut;Out=1;var t=Rut?Mut:(Rut=1,Mut=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]);return Lut=function(e){var i,n=[];if(e.hasOwnProperty("props"))for(i in e.props)"_"!==i.substring(0,1)&&n.push({key:i,value:e.props[i]});else for(i in e)-1===t.indexOf(i)&&"_"!==i.substring(0,1)&&n.push({key:i,value:e[i]});return n}}function udt(){if(Dut)return Fut;Dut=1;var t=Vl();return Fut=function(e){var i=t(e,"targets",null);return null===i||("function"==typeof i&&(i=i.call()),Array.isArray(i)||(i=[i])),i}}function cdt(){if(kut)return Iut;kut=1;var t=vX(),e=sG();function i(t){return!!t.getActive&&"function"==typeof t.getActive}function n(t){return!!t.getStart&&"function"==typeof t.getStart}function s(t){return!!t.getEnd&&"function"==typeof t.getEnd}var r=function(a,o){var h,l,u=function(t,e,i){return i},c=function(t,e,i){return i},d=null,f=typeof o;if("number"===f)u=function(){return o};else if(Array.isArray(o))c=function(){return o[0]},u=function(){return o[o.length-1]};else if("string"===f){var p=o.toLowerCase(),g="random"===p.substring(0,6),v="int"===p.substring(0,3);if(g||v){var m=p.indexOf("("),y=p.indexOf(")"),x=p.indexOf(",");if(!(m&&y&&x))throw new Error("invalid random() format");var w=parseFloat(p.substring(m+1,x)),b=parseFloat(p.substring(x+1,y));u=g?function(){return e(w,b)}:function(){return t(w,b)}}else{p=p[0];var T=parseFloat(o.substr(2));switch(p){case"+":u=function(t,e,i){return i+T};break;case"-":u=function(t,e,i){return i-T};break;case"*":u=function(t,e,i){return i*T};break;case"/":u=function(t,e,i){return i/T};break;default:u=function(){return parseFloat(o)}}}}else if("function"===f)u=o;else if("object"===f)if(n(l=o)||s(l)||i(l))i(o)&&(d=o.getActive),s(o)&&(u=o.getEnd),n(o)&&(c=o.getStart);else if(o.hasOwnProperty("value"))h=r(a,o.value);else{var S=o.hasOwnProperty("to"),E=o.hasOwnProperty("from"),_=o.hasOwnProperty("start");if(S&&(E||_)){if(h=r(a,o.to),_){var C=r(a,o.start);h.getActive=C.getEnd}if(E){var A=r(a,o.from);h.getStart=A.getEnd}}}return h||(h={getActive:d,getEnd:u,getStart:c}),h};return Iut=r}function ddt(){return sct?nct:(sct=1,nct={TWEEN_ACTIVE:Nut?But:(Nut=1,But="active"),TWEEN_COMPLETE:Uut?zut:(Uut=1,zut="complete"),TWEEN_LOOP:Xut?Yut:(Xut=1,Yut="loop"),TWEEN_PAUSE:Wut?Gut:(Wut=1,Gut="pause"),TWEEN_RESUME:Vut?Hut:(Vut=1,Hut="resume"),TWEEN_REPEAT:qut?jut:(qut=1,jut="repeat"),TWEEN_START:Zut?Kut:(Zut=1,Kut="start"),TWEEN_STOP:$ut?Jut:($ut=1,Jut="stop"),TWEEN_UPDATE:tct?Qut:(tct=1,Qut="update"),TWEEN_YOYO:ict?ect:(ict=1,ect="yoyo")})}function fdt(){if(act)return rct;act=1;var t=Kh(),e=cU(),i=ddt(),n=hc(),s=new t({Extends:e,initialize:function(t){e.call(this),this.parent=t,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=n.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(i.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(i.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(i.TWEEN_COMPLETE,"onComplete")},complete:function(t){return void 0===t&&(t=0),t?(this.setCompleteDelayState(),this.countdown=t):this.onCompleteHandler(),this},completeAfterLoop:function(t){return void 0===t&&(t=0),this.loopCounter>t&&(this.loopCounter=t),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return!this.parent||this.isRemoved()||this.isPendingRemove()||this.isDestroyed()||(this.dispatchEvent(i.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(t){this.countdown-=t,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(t){return this.countdown-=t,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(i.TWEEN_START,"onStart"),t=0),t},updateCompleteDelay:function(t){this.countdown-=t,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(t,e,i){return void 0===i&&(i=[]),this.callbacks.hasOwnProperty(t)&&(this.callbacks[t]={func:e,params:i}),this},setPendingState:function(){this.state=n.PENDING},setActiveState:function(){this.state=n.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=n.LOOP_DELAY},setCompleteDelayState:function(){this.state=n.COMPLETE_DELAY},setStartDelayState:function(){this.state=n.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=n.PENDING_REMOVE},setRemovedState:function(){this.state=n.REMOVED},setFinishedState:function(){this.state=n.FINISHED},setDestroyedState:function(){this.state=n.DESTROYED},isPending:function(){return this.state===n.PENDING},isActive:function(){return this.state===n.ACTIVE},isLoopDelayed:function(){return this.state===n.LOOP_DELAY},isCompleteDelayed:function(){return this.state===n.COMPLETE_DELAY},isStartDelayed:function(){return this.state===n.START_DELAY},isPendingRemove:function(){return this.state===n.PENDING_REMOVE},isRemoved:function(){return this.state===n.REMOVED},isFinished:function(){return this.state===n.FINISHED},isDestroyed:function(){return this.state===n.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(t){t.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});return s.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],rct=s}function pdt(){if(hct)return oct;hct=1;return oct={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null}}function gdt(){if(uct)return lct;uct=1;var t=Kh(),e=ddt(),i=hc(),n=new t({initialize:function(t,e,i,n,s,r,a,o,h,l){this.tween=t,this.targetIndex=e,this.duration=n<=0?.01:n,this.totalDuration=0,this.delay=0,this.getDelay=i,this.yoyo=s,this.hold=r,this.repeat=a,this.repeatDelay=o,this.repeatCounter=0,this.flipX=h,this.flipY=l,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(t){void 0===t&&(t=this.current),this.tween.targets[this.targetIndex][this.key]=t},setCreatedState:function(){this.state=i.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=i.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=i.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=i.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=i.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=i.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=i.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=i.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===i.CREATED},isDelayed:function(){return this.state===i.DELAY},isPendingRender:function(){return this.state===i.PENDING_RENDER},isPlayingForward:function(){return this.state===i.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===i.PLAYING_BACKWARD},isHolding:function(){return this.state===i.HOLD_DELAY},isRepeating:function(){return this.state===i.REPEAT_DELAY},isComplete:function(){return this.state===i.COMPLETE},setStateFromEnd:function(t){this.yoyo?this.onRepeat(t,!0,!0):this.repeatCounter>0?this.onRepeat(t,!0,!1):this.setCompleteState()},setStateFromStart:function(t){this.repeatCounter>0?this.onRepeat(t,!1):this.setCompleteState()},reset:function(){var t=this.tween,e=t.totalTargets,n=this.targetIndex,s=t.targets[n],r=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(s,r,0,n,e,t),this.repeatCounter=-1===this.repeat?i.MAX:this.repeat,this.setPendingRenderState();var a=this.duration+this.hold;this.yoyo&&(a+=this.duration);var o=a+this.repeatDelay;this.totalDuration=this.delay+a,-1===this.repeat?(this.totalDuration+=o*i.MAX,t.isInfinite=!0):this.repeat>0&&(this.totalDuration+=o*this.repeat),this.totalDuration>t.duration&&(t.duration=this.totalDuration),this.delay<t.startDelay&&(t.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(t,i,n){var s=this.tween,r=s.totalTargets,a=this.targetIndex,o=s.targets[a],h=this.key,l="texture"!==h;if(this.elapsed=t,this.progress=t/this.duration,this.flipX&&o.toggleFlipX(),this.flipY&&o.toggleFlipY(),l&&(i||n)&&(this.start=this.getStartValue(o,h,this.start,a,r,s)),n)return this.setPlayingBackwardState(),void this.dispatchEvent(e.TWEEN_YOYO,"onYoyo");this.repeatCounter--,l&&(this.end=this.getEndValue(o,h,this.start,a,r,s)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-t,l&&(this.current=this.start,o[h]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(e.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});return lct=n}function vdt(){if(dct)return cct;dct=1;var t=gdt(),e=tl(),i=Kh(),n=ddt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m){t.call(this,e,i,h,l,u,c,d,f,p,g),this.key=n,this.getActiveValue=a,this.getEndValue=s,this.getStartValue=r,this.ease=o,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=v,this.interpolationData=m},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex],n=this.key;e&&(i[n]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(i[n]=this.getActiveValue(i,n,0))},update:function(t){var i=this.tween,s=i.totalTargets,r=this.targetIndex,a=i.targets[r],o=this.key;if(!a)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(a,o,a[o],r,s,i),this.end=this.getEndValue(a,o,this.start,r,s,i),this.current=this.start,a[o]=this.start,this.setPlayingForwardState(),!0;var h=this.isPlayingForward(),l=this.isPlayingBackward();if(h||l){var u=this.elapsed,c=this.duration,d=0,f=!1;(u+=t)>=c?(d=u-c,u=c,f=!0):u<0&&(u=0);var p=e(u/c,0,1);this.elapsed=u,this.progress=p,this.previous=this.current,h||(p=1-p);var g=this.ease(p);this.interpolation?this.current=this.interpolation(this.interpolationData,g):this.current=this.start+(this.end-this.start)*g,a[o]=this.current,f&&(h?(i.isNumberTween&&(this.current=this.end,a[o]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(d)):(i.isNumberTween&&(this.current=this.start,a[o]=this.current),this.setStateFromStart(d))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key,r=this.current,a=this.previous;i.emit(t,i,s,n,r,a);var o=i.callbacks[e];o&&o.func.apply(i.callbackScope,[i,n,s,r,a].concat(o.params))}},destroy:function(){t.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});return cct=s}function mdt(){if(pct)return fct;pct=1;var t=gdt(),e=tl(),i=Kh(),n=ddt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c){t.call(this,e,i,r,a,!1,o,h,l,u,c),this.key="texture",this.startTexture=null,this.endTexture=n,this.startFrame=null,this.endFrame=s,this.yoyo=0!==h},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=i.texture.key,this.startFrame=i.frame.name),e&&i.setTexture(this.startTexture,this.startFrame)},update:function(t){var i=this.tween,s=this.targetIndex,r=i.targets[s];if(!r)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&r.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var a=this.isPlayingForward(),o=this.isPlayingBackward();if(a||o){var h=this.elapsed,l=this.duration,u=0,c=!1;(h+=t)>=l?(u=h-l,h=l,c=!0):h<0&&(h=0);var d=e(h/l,0,1);this.elapsed=h,this.progress=d,c&&(a?(r.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(u)):(r.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(u))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key;i.emit(t,i,s,n);var r=i.callbacks[e];r&&r.func.apply(i.callbackScope,[i,n,s].concat(r.params))}},destroy:function(){t.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});return fct=s}function ydt(){if(vct)return gct;vct=1;var t=fdt(),e=Kh(),i=ddt(),n=DV(),s=ic(),r=il(),a=hc(),o=vdt(),h=mdt(),l=new e({Extends:t,initialize:function(e,i){t.call(this,e),this.targets=i,this.totalTargets=i.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,v){var m=new o(this,t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,v);return this.totalData=this.data.push(m),m},addFrame:function(t,e,i,n,s,r,a,o,l,u){var c=new h(this,t,e,i,n,s,r,a,o,l,u);return this.totalData=this.data.push(c),c},getValue:function(t){void 0===t&&(t=0);var e=null;return this.data&&(e=this.data[t].current),e},hasTarget:function(t){return this.targets&&-1!==this.targets.indexOf(t)},updateTo:function(t,e,i){if(void 0===i&&(i=!1),"texture"!==t)for(var n=0;n<this.totalData;n++){var s=this.data[n];s.key===t&&(s.isPlayingForward()||s.isPlayingBackward())&&(s.end=e,i&&(s.start=s.current))}return this},restart:function(){switch(this.state){case a.REMOVED:case a.FINISHED:this.seek(),this.parent.makeActive(this);break;case a.PENDING:case a.PENDING_REMOVE:this.parent.reset(this);break;case a.DESTROYED:console.warn("Cannot restart destroyed Tween",this);break;default:this.seek()}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,t.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed Tween",this),this):((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=16.6),void 0===n&&(n=!1),this.isDestroyed())return console.warn("Cannot seek destroyed Tween",this),this;n||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive");var s=this.paused;if(this.paused=!1,t>0){for(var r=Math.floor(t/e),a=t-r*e,o=0;o<r;o++)this.update(e);a>0&&this.update(a)}return this.paused=s,this.isSeeking=!1,this},initTweenData:function(t){void 0===t&&(t=!1),this.duration=0,this.startDelay=r.MAX_SAFE_INTEGER;for(var e=this.data,i=0;i<this.totalData;i++)e[i].reset(t);this.duration=Math.max(this.duration,.01);var n=this.duration,s=this.completeDelay,a=this.loopCounter,o=this.loopDelay;this.totalDuration=a>0?n+s+(n+o)*a:n+s},reset:function(t){return void 0===t&&(t=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,-1===this.loop&&(this.isInfinite=!0,this.loopCounter=a.MAX),t||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")),this},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.paused||this.isFinished())return!1;if(t*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(i.TWEEN_START,"onStart"),t=0));var e=!1;if(this.isActive())for(var n=this.data,s=0;s<this.totalData;s++)n[s].update(t)&&(e=!0);this.elapsed+=t,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=t,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),e||this.nextState();var r=this.isPendingRemove();return r&&this.persist&&(this.setFinishedState(),r=!1),r},forward:function(t){return this.update(t),this},rewind:function(t){return this.update(-t),this},dispatchEvent:function(t,e){if(!this.isSeeking){if(this.emit(t,this,this.targets),!this.callbacks)return;var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this,this.targets].concat(i.params))}},destroy:function(){t.prototype.destroy.call(this),this.targets=null}});return s.register("tween",function(t){return this.scene.sys.tweens.add(t)}),n.register("tween",function(t){return this.scene.sys.tweens.create(t)}),gct=l}function xdt(){if(yct)return mct;yct=1;var t=fdt(),e=pdt(),i=xj(),n=oc(),s=fY(),r=jh(),a=hdt(),o=Vl(),h=cdt(),l=xq(),u=ydt();return mct=function(c,d,f){if(d instanceof u)return d.parent=c,d;f=void 0===f?e:l(e,f);var p=r(d,"from",0),g=r(d,"to",1),v=[{value:p}],m=r(d,"delay",f.delay),y=r(d,"easeParams",f.easeParams),x=r(d,"ease",f.ease),w=h("value",g),b=new u(c,v),T=b.add(0,"value",w.getEnd,w.getStart,w.getActive,s(r(d,"ease",x),r(d,"easeParams",y)),a(d,"delay",m),r(d,"duration",f.duration),n(d,"yoyo",f.yoyo),r(d,"hold",f.hold),r(d,"repeat",f.repeat),r(d,"repeatDelay",f.repeatDelay),!1,!1);T.start=p,T.current=p,b.completeDelay=i(d,"completeDelay",0),b.loop=Math.round(i(d,"loop",0)),b.loopDelay=Math.round(i(d,"loopDelay",0)),b.paused=n(d,"paused",!1),b.persist=n(d,"persist",!1),b.isNumberTween=!0,b.callbackScope=o(d,"callbackScope",b);for(var S=t.TYPES,E=0;E<S.length;E++){var _=S[E],C=o(d,_,!1);if(C){var A=o(d,_+"Params",[]);b.setCallback(_,C,A)}}return b},mct}function wdt(){if(wct)return xct;wct=1;var t=fY(),e=Vl(),i=il();return xct=function(n,s){var r;void 0===s&&(s={});var a=e(s,"start",0),o=e(s,"ease",null),h=e(s,"grid",null),l=e(s,"from",0),u="first"===l,c="center"===l,d="last"===l,f="number"==typeof l,p=Array.isArray(n),g=p?parseFloat(n[0]):parseFloat(n),v=p?parseFloat(n[1]):0,m=Math.max(g,v);if(p&&(a+=g),h){var y=h[0],x=h[1],w=0,b=0,T=0,S=0,E=[];d?(w=y-1,b=x-1):f?(w=l%y,b=Math.floor(l/y)):c&&(w=(y-1)/2,b=(x-1)/2);for(var _=i.MIN_SAFE_INTEGER,C=0;C<x;C++){E[C]=[];for(var A=0;A<y;A++){T=w-A,S=b-C;var P=Math.sqrt(T*T+S*S);P>_&&(_=P),E[C][A]=P}}}var M=o?t(o):null;return r=h?function(t,e,i,n){var s,r=0,o=n%y,h=Math.floor(n/y);if(o>=0&&o<y&&h>=0&&h<x&&(r=E[h][o]),p){var l=v-g;s=M?r/_*l*M(r/_):r/_*l}else s=M?r*g*M(r/_):r*g;return s+a}:function(t,e,i,n,s){var r,o,h;(s--,u?r=n:c?r=Math.abs(s/2-n):d?r=s-n:f&&(r=Math.abs(l-n)),p)?(h=c?(v-g)/s*(2*r):(v-g)/s*r,o=M?h*M(r/s):h):o=M?s*m*M(r/s):r*g;return o+a},r}}function bdt(){if(Tct)return bct;Tct=1;var t=fdt(),e=pdt(),i=xj(),n=oc(),s=fY(),r=jh(),a=sq(),o=hdt(),h=ldt(),l=udt(),u=Vl(),c=cdt(),d=xq(),f=ydt();return bct=function(p,g,v){if(g instanceof f)return g.parent=p,g;v=void 0===v?e:d(e,v);var m=l(g);!m&&v.targets&&(m=v.targets);for(var y=h(g),x=r(g,"delay",v.delay),w=r(g,"duration",v.duration),b=r(g,"easeParams",v.easeParams),T=r(g,"ease",v.ease),S=r(g,"hold",v.hold),E=r(g,"repeat",v.repeat),_=r(g,"repeatDelay",v.repeatDelay),C=n(g,"yoyo",v.yoyo),A=n(g,"flipX",v.flipX),P=n(g,"flipY",v.flipY),M=r(g,"interpolation",v.interpolation),R=function(t,e,i,h){if("texture"===i){var l=h,u=void 0;Array.isArray(h)?(l=h[0],u=h[1]):h.hasOwnProperty("value")?(l=h.value,Array.isArray(h.value)?(l=h.value[0],u=h.value[1]):"string"==typeof h.value&&(l=h.value)):"string"==typeof h&&(l=h),t.addFrame(e,l,u,o(h,"delay",x),r(h,"duration",w),r(h,"hold",S),r(h,"repeat",E),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",P))}else{var d=c(i,h),f=a(r(h,"interpolation",M));t.add(e,i,d.getEnd,d.getStart,d.getActive,s(r(h,"ease",T),r(h,"easeParams",b)),o(h,"delay",x),r(h,"duration",w),n(h,"yoyo",C),r(h,"hold",S),r(h,"repeat",E),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",P),f,f?h:null)}},L=new f(p,m),O=0;O<y.length;O++)for(var F=y[O].key,D=y[O].value,I=0;I<m.length;I++)"scale"!==F||m[I].hasOwnProperty("scale")?R(L,I,F,D):(R(L,I,"scaleX",D),R(L,I,"scaleY",D));L.completeDelay=i(g,"completeDelay",0),L.loop=Math.round(i(g,"loop",0)),L.loopDelay=Math.round(i(g,"loopDelay",0)),L.paused=n(g,"paused",!1),L.persist=n(g,"persist",!1),L.callbackScope=r(g,"callbackScope",L);for(var k=t.TYPES,B=0;B<k.length;B++){var N=k[B],z=u(g,N,!1);if(z){var U=u(g,N+"Params",[]);L.setCallback(N,z,U)}}return L},bct}function Tdt(){if(Cct)return _ct;Cct=1;var t=Zl(),e=fdt(),i=Kh(),n=ddt(),s=DV(),r=ic(),a=hc(),o=new i({Extends:e,initialize:function(t){e.call(this,t),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=-1===this.loop?a.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(t){var e=this.parent.create(t);Array.isArray(e)||(e=[e]);for(var i=this.data,n=0;n<e.length;n++){var s=e[n];s.parent=this,i.push(s.reset())}return this.totalData=i.length,this},remove:function(e){return t(this.data,e),e.setRemovedState(),e===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(t){for(var e=this.data,i=0;i<this.totalData;i++)if(e[i].hasTarget(t))return!0;return!1},restart:function(){return this.isDestroyed()?(console.warn("Cannot restart destroyed TweenChain",this),this):(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(t){return t.seek(),t.setActiveState(),this},makeActive:function(t){return t.reset(),t.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed TweenChain",this),this):((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var t=this.data,e=this.totalData,i=0;i<e;i++)t[i].reset(!1);this.setCurrentTween(0)},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.isFinished()||this.paused)return!1;if(t*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(n.TWEEN_START,"onStart"),t=0));var e=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(t)&&this.nextTween()&&this.nextState(),(e=this.isPendingRemove())&&this.persist&&(this.setFinishedState(),e=!1)),e},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData||(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(t){this.currentIndex=t,this.currentTween=this.data[t],this.currentTween.setActiveState()},dispatchEvent:function(t,e){this.emit(t,this);var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this].concat(i.params))},destroy:function(){e.prototype.destroy.call(this),this.currentTween=null}});return r.register("tweenchain",function(t){return this.scene.sys.tweens.chain(t)}),s.register("tweenchain",function(t){return this.scene.sys.tweens.create(t)}),_ct=o}function Sdt(){if(Rct)return Mct;Rct=1;var t=Zl(),e=Kh(),i=Fl(),n=xdt(),s=tc(),r=ec(),a=wdt(),o=ydt(),h=bdt(),l=Tdt(),u=function(){if(Pct)return Act;Pct=1;var t=fdt(),e=xj(),i=oc(),n=udt(),s=Vl(),r=bdt(),a=Tdt();return Act=function(o,h){if(h instanceof a)return h.parent=o,h;var l,u=new a(o);u.startDelay=s(h,"delay",0),u.completeDelay=e(h,"completeDelay",0),u.loop=Math.round(e(h,"loop",s(h,"repeat",0))),u.loopDelay=Math.round(e(h,"loopDelay",s(h,"repeatDelay",0))),u.paused=i(h,"paused",!1),u.persist=i(h,"persist",!1),u.callbackScope=s(h,"callbackScope",u);var c=t.TYPES;for(l=0;l<c.length;l++){var d=c[l],f=s(h,d,!1);if(f){var p=s(h,d+"Params",[]);u.setCallback(d,f,p)}}var g=s(h,"tweens",null);if(Array.isArray(g)){var v=[],m=n(h),y=void 0;for(m&&(y={targets:m}),l=0;l<g.length;l++)v.push(r(u,g[l],y));u.add(v)}return u},Act}(),c=new e({initialize:function(t){this.scene=t,this.events=t.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(r.BOOT,this.boot,this),this.events.on(r.START,this.start,this)},boot:function(){this.events.once(r.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(r.UPDATE,this.update,this),this.events.once(r.SHUTDOWN,this.shutdown,this)},create:function(t){Array.isArray(t)||(t=[t]);for(var e=[],i=0;i<t.length;i++){var n=t[i];n instanceof o||n instanceof l?e.push(n):Array.isArray(n.tweens)?e.push(u(this,n)):e.push(h(this,n))}return 1===e.length?e[0]:e},add:function(t){var e=t,i=this.tweens;return e instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),i.push(e.reset()),e},addMultiple:function(t){for(var e,i=[],n=this.tweens,s=0;s<t.length;s++)(e=t[s])instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),n.push(e.reset()),i.push(e);return i},chain:function(t){var e=u(this,t);return this.tweens.push(e.init()),e},getChainedTweens:function(t){return t.getChainedTweens()},has:function(t){return this.tweens.indexOf(t)>-1},existing:function(t){return this.has(t)||this.tweens.push(t.reset()),this},addCounter:function(t){var e=n(this,t);return this.tweens.push(e.reset()),e},stagger:function(t,e){return a(t,e)},setLagSmooth:function(t,e){return void 0===t&&(t=1/1e-8),void 0===e&&(e=0),this.maxLag=t,this.lagSkip=Math.min(e,this.maxLag),this},setFps:function(t){return void 0===t&&(t=240),this.gap=1e3/t,this.nextTime=1e3*this.time+this.gap,this},getDelta:function(t){var e=Date.now()-this.prevTime;e>this.maxLag&&(this.startTime+=e-this.lagSkip),this.prevTime+=e;var i=this.prevTime-this.startTime,n=i-this.nextTime,s=i-1e3*this.time;return n>0||t?(i/=1e3,this.time=i,this.nextTime+=n+(n>=this.gap?4:this.gap-n)):s=0,s},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(t){void 0===t&&(t=!1);var e=this.getDelta(t);if(!(e<=0)){var i,n;this.processing=!0;var s=[],r=this.tweens;for(i=0;i<r.length;i++)(n=r[i]).update(e)&&s.push(n);var a=s.length;if(a&&r.length>0){for(i=0;i<a;i++){n=s[i];var o=r.indexOf(n);o>-1&&(n.isPendingRemove()||n.isDestroyed())&&(r.splice(o,1),n.destroy())}s.length=0}this.processing=!1}},remove:function(e){return this.processing?e.setPendingRemoveState():(t(this.tweens,e),e.setRemovedState()),this},reset:function(t){return this.existing(t),t.seek(),t.setActiveState(),this},makeActive:function(t){return this.existing(t),t.setActiveState(),this},each:function(t,e){var i,n=[null];for(i=1;i<arguments.length;i++)n.push(arguments[i]);return this.tweens.forEach(function(i){n[0]=i,t.apply(e,n)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(t){for(var e=[],n=this.tweens,s=(t=Array.isArray(t)?i(t):[t]).length,r=0;r<n.length;r++)for(var a=n[r],o=0;o<s;o++)!a.isDestroyed()&&a.hasTarget(t[o])&&e.push(a);return e},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(t){return this.timeScale=t,this},isTweening:function(t){for(var e,i=this.tweens,n=0;n<i.length;n++)if((e=i[n]).isPlaying()&&e.hasTarget(t))return!0;return!1},killAll:function(){for(var t=this.processing?this.getTweens():this.tweens,e=0;e<t.length;e++)t[e].destroy();return this.processing||(t.length=0),this},killTweensOf:function(t){for(var e=this.getTweensOf(t),i=0;i<e.length;i++)e[i].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(r.UPDATE,this.update,this),this.events.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(r.START,this.start,this),this.scene=null,this.events=null}});return s.register("TweenManager",c,"tweens"),Mct=c}function Edt(){if(Oct)return Lct;Oct=1;var t={States:hc(),Builders:Ect?Sct:(Ect=1,Sct={GetBoolean:oc(),GetEaseFunction:fY(),GetInterpolationFunction:sq(),GetNewValue:hdt(),GetProps:ldt(),GetTargets:udt(),GetValueOp:cdt(),NumberTweenBuilder:xdt(),StaggerBuilder:wdt(),TweenBuilder:bdt()}),Events:ddt(),TweenManager:Sdt(),Tween:ydt(),TweenData:vdt(),TweenFrameData:mdt(),BaseTween:fdt(),TweenChain:Tdt()};return Lct=t}function _dt(){if(Dct)return Fct;Dct=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return Fct=function(e,i){for(var n=new Uint8Array(e),s=n.length,r=i?"data:"+i+";base64,":"",a=0;a<s;a+=3)r+=t[n[a]>>2],r+=t[(3&n[a])<<4|n[a+1]>>4],r+=t[(15&n[a+1])<<2|n[a+2]>>6],r+=t[63&n[a+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},Fct}function Cdt(){if(kct)return Ict;kct=1;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),i=0;i<64;i++)e[t.charCodeAt(i)]=i;return Ict=function(t){var i,n,s,r,a=(t=t.substr(t.indexOf(",")+1)).length,o=.75*a,h=0;"="===t[a-1]&&(o--,"="===t[a-2]&&o--);for(var l=new ArrayBuffer(o),u=new Uint8Array(l),c=0;c<a;c+=4)i=e[t.charCodeAt(c)],n=e[t.charCodeAt(c+1)],s=e[t.charCodeAt(c+2)],r=e[t.charCodeAt(c+3)],u[h++]=i<<2|n>>4,u[h++]=(15&n)<<4|s>>2,u[h++]=(3&s)<<6|63&r;return l},Ict}function Adt(){if(Uct)return zct;Uct=1;var t=Vl(),e=tl();return zct=function(i,n,s,r,a){void 0===a&&(a=s);var o=t(i,n,a);return e(o,s,r)}}function Pdt(){if(Wct)return Gct;Wct=1;return Gct=function(t,e){return t.replace(/%([0-9]+)/g,function(t,i){return e[Number(i)-1]})},Gct}function Mdt(){if(Vct)return Hct;Vct=1;return Hct=function(t,e){return 0===e?t.slice(1):t.slice(0,e)+t.slice(e+1)},Hct}function Rdt(){if(qct)return jct;qct=1;return jct=function(t){return t.split("").reverse().join("")},jct}var Ldt=I(function(){if(tdt)return Qct;tdt=1,k||(k=1,"undefined"!=typeof HTMLVideoElement&&!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(t){const e=performance.now(),i=this.getVideoPlaybackQuality(),n=this.mozPresentedFrames||this.mozPaintedFrames||i.totalVideoFrames-i.droppedVideoFrames,s=(r,a)=>{const o=this.getVideoPlaybackQuality(),h=this.mozPresentedFrames||this.mozPaintedFrames||o.totalVideoFrames-o.droppedVideoFrames;if(h>n){const n=this.mozFrameDelay||o.totalFrameDelay-i.totalFrameDelay||0,s=a-r;t(a,{presentationTime:a+1e3*n,expectedDisplayTime:a+s,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+s/1e3,presentedFrames:h,processingDuration:n}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(a,t))};return this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(e,t)),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(t){cancelAnimationFrame(this._rvfcpolyfillmap[t]),delete this._rvfcpolyfillmap[t]}));var t=eh(),e=nh(),i={Actions:lX(),Animations:Mm?Pm:(Mm=1,Pm={Animation:dX(),AnimationFrame:cX(),AnimationManager:gX(),AnimationState:mX(),Events:uX()}),BlendModes:Qo(),Cache:Ym?Um:(Ym=1,Um={BaseCache:xX(),CacheManager:wX(),Events:yX()}),Cameras:Yx?Ux:(Yx=1,Ux={Controls:jm?Vm:(jm=1,Vm={FixedKeyControl:bX(),SmoothedKeyControl:TX()}),Scene2D:zx?Nx:(zx=1,Nx={Camera:HX(),BaseCamera:IX(),CameraManager:jX(),Effects:GX(),Events:SX()})}),Core:YC?UC:(YC=1,UC={Config:fW(),CreateRenderer:NH(),Events:pX(),TimeStep:UH(),VisibilityHandler:YH()}),Class:Kh(),Create:nA?iA:(nA=1,iA={GenerateTexture:GH(),Palettes:eA?tA:(eA=1,tA={ARNE16:XH(),C64:jC?VC:(jC=1,VC={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}),CGA:KC?qC:(KC=1,qC={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}),JMP:JC?ZC:(JC=1,ZC={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}),MSX:QC?$C:(QC=1,$C={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"})})}),Curves:SA?TA:(SA=1,TA={Path:$H(),MoveTo:KH(),CubicBezier:VH(),Curve:HH(),Ellipse:jH(),Line:qH(),QuadraticBezier:ZH(),Spline:JH()}),Data:AA?CA:(AA=1,CA={DataManager:Ac(),DataManagerPlugin:QH(),Events:Cc()}),Display:bP?wP:(bP=1,wP={Align:tV(),BaseShader:eV(),Bounds:GA?XA:(GA=1,XA={CenterOn:zh(),GetBottom:rh(),GetBounds:iV(),GetCenterX:ah(),GetCenterY:yh(),GetLeft:uh(),GetOffsetX:nV(),GetOffsetY:sV(),GetRight:fh(),GetTop:bh(),SetBottom:vh(),SetCenterX:oh(),SetCenterY:xh(),SetLeft:ch(),SetRight:ph(),SetTop:hh()}),Canvas:KA?qA:(KA=1,qA={CanvasInterpolation:pW(),CanvasPool:ou(),Smoothing:au(),TouchAction:rV(),UserSelect:aV()}),Color:lV(),ColorMatrix:Au(),Masks:mP?vP:(mP=1,vP={BitmapMask:nc(),GeometryMask:sc()}),RGB:uV()}),DOM:SV(),Events:JP?ZP:(JP=1,ZP={EventEmitter:EV()}),FX:Bu(),Game:dj(),GameObjects:f8(),Geom:d7(),Input:F7(),Loader:Hit(),Math:cW(),Physics:uit?lit:(uit=1,lit={Arcade:Bnt()}),Plugins:vit?git:(vit=1,git={BasePlugin:Nnt(),DefaultPlugins:qX(),PluginCache:tc(),PluginManager:IV(),ScenePlugin:znt()}),Renderer:dht(),Scale:fht(),ScaleModes:th(),Scene:VV(),Scenes:ght(),Structs:sst?nst:(sst=1,nst={Events:gj(),List:fj(),Map:fX(),ProcessQueue:vj(),RTree:Snt(),Set:$j(),Size:kV()}),Textures:vht(),Tilemaps:ndt(),Time:Cut?_ut:(Cut=1,_ut={Clock:rdt(),Events:adt(),Timeline:odt(),TimerEvent:sdt()}),Tweens:Edt(),Utils:$ct?Jct:($ct=1,Jct={Array:mu(),Base64:Nct?Bct:(Nct=1,Bct={ArrayBufferToBase64:_dt(),Base64ToArrayBuffer:Cdt()}),Objects:Xct?Yct:(Xct=1,Yct={Clone:XV(),DeepCopy:uc(),Extend:nh(),GetAdvancedValue:xj(),GetFastValue:jh(),GetMinMaxValue:Adt(),GetValue:Vl(),HasAll:gq(),HasAny:vq(),HasValue:Jj(),IsPlainObject:ih(),Merge:GV(),MergeRight:xq(),Pick:Hlt(),SetValue:Y$()}),String:Zct?Kct:(Zct=1,Kct={Format:Pdt(),Pad:fl(),RemoveAt:Mdt(),Reverse:Rdt(),UppercaseFirst:dY(),UUID:Dq()}),NOOP:qh(),NULL:nlt()})};return i=e(!1,i,t),Qct=i,D.HawkEngine=i,Qct}());const Odt=(t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},Fdt=t=>t*(Math.PI/180),Ddt=t=>t*(180/Math.PI),Idt=new Map,kdt=t=>{Idt.has(t)&&clearTimeout(Idt.get(t)),Idt.set(t,setTimeout(t,100))},Bdt=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent&&t.attachEvent(s,i)},Ndt=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.removeEventListener?t.removeEventListener(s,i):t.detachEvent&&t.detachEvent(s,i)},zdt=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),Udt=()=>({x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}),Ydt=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},Xdt=(t,e,i)=>{const n=Gdt(t);for(let t in n)if(n.hasOwnProperty(t))if("string"==typeof e)n[t]=e+" "+i;else{let s="";for(let t=0,n=e.length;t<n;t+=1)s+=e[t]+" "+i+", ";n[t]=s.slice(0,-2)}return n},Gdt=t=>{const e={};e[t]="";return["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},Wdt=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},Hdt=(t,e)=>{if(t.length)for(let i=0,n=t.length;i<n;i+=1)e(t[i]);else e(t)};var Vdt,jdt=!!("ontouchstart"in window),qdt=!!window.PointerEvent,Kdt=!!window.MSPointerEvent,Zdt={start:"mousedown",move:"mousemove",end:"mouseup"},Jdt={};function $dt(){}function Qdt(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=Qdt.id,Qdt.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function tft(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=tft.id,tft.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),"static"!==i.options.mode&&"semi"!==i.options.mode||(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);const n=getComputedStyle(i.options.zone.parentElement);return n&&"flex"===n.display&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}function eft(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=Udt(),e.config(t),e.prepareCollections();var i=function(){var t;e.collections.forEach(function(i){i.forEach(function(i){t=i.el.getBoundingClientRect(),i.position={x:e.scroll.x+t.left,y:e.scroll.y+t.top}})})};Bdt(window,"resize",function(){kdt(i)});var n=function(){e.scroll=Udt()};return Bdt(window,"scroll",function(){kdt(n)}),e.collections}qdt?Vdt={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Kdt?Vdt={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:jdt?(Vdt={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},Jdt=Zdt):Vdt=Zdt,$dt.prototype.on=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]=n._handlers_[i]||[],n._handlers_[i].push(e);return n},$dt.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},void 0===t?i._handlers_={}:void 0===e?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i},$dt.prototype.trigger=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]&&n._handlers_[i].length&&n._handlers_[i].forEach(function(t){t.call(n,{type:i,target:n},e)})},$dt.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=((t,e)=>{const i={};for(let n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:t.hasOwnProperty(n)&&(i[n]=t[n]);return i})(e.options,t))},$dt.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){"function"==typeof i["on"+e]?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},Bdt(t,Vdt[e],i._domHandlers_[e]),Jdt[e]&&Bdt(t,Jdt[e],i._domHandlers_[e]),i},$dt.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},Ndt(t,Vdt[e],i._domHandlers_[e]),Jdt[e]&&Ndt(t,Jdt[e],i._domHandlers_[e]),delete i._domHandlers_[e],this},Qdt.prototype=new $dt,Qdt.constructor=Qdt,Qdt.id=0,Qdt.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},Qdt.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=((t,e)=>{const i=Gdt(t);for(let t in i)i.hasOwnProperty(t)&&(i[t]=e);return i})("borderRadius","50%"),i=Xdt("transition","opacity",t),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:100},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},Wdt(n.el,i),"circle"===this.options.shape&&Wdt(n.back,e),Wdt(n.front,e),this.applyStyles(n),this},Qdt.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this},Qdt.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},Qdt.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},Qdt.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},Qdt.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),"function"==typeof t&&t.call(this)},e.options.fadeTime)),e},Qdt.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i="dynamic"===e.options.mode?"none":"block";e.ui.el.style.display=i,"function"==typeof t&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const i=e.options.restJoystick,n={};n.x=!0===i||!1!==i.x?0:e.instance.frontPosition.x,n.y=!0===i||!1!==i.y?0:e.instance.frontPosition.y,e.setPosition(t,n)}return e},Qdt.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",s={};s.front=Xdt("transition",["transform"],n);var r={front:{}};r.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(s),i.applyStyles(r),i.restTimeout=setTimeout(function(){"function"==typeof t&&t.call(i),i.restCallback()},i.options.fadeTime)},Qdt.prototype.restCallback=function(){var t=this,e={};e.front=Xdt("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)},Qdt.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},Qdt.prototype.computeDirection=function(t){var e,i,n,s=t.angle.radian,r=Math.PI/4,a=Math.PI/2;if(s>r&&s<3*r&&!t.lockX?e="up":s>-r&&s<=r&&!t.lockY?e="left":s>3*-r&&s<=-r&&!t.lockX?e="down":t.lockY||(e="right"),t.lockY||(i=s>-a&&s<a?"left":"right"),t.lockX||(n=s>0?"up":"down"),t.force>this.options.threshold){var o,h={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(h[o]=this.direction[o]);var l={};for(o in this.direction={x:i,y:n,angle:e},t.direction=this.direction,h)h[o]===this.direction[o]&&(l[o]=!0);if(l.x&&l.y&&l.angle)return t;l.x&&l.y||this.trigger("plain",t),l.x||this.trigger("plain:"+i,t),l.y||this.trigger("plain:"+n,t),l.angle||this.trigger("dir dir:"+e,t)}else this.resetDirection();return t},tft.prototype=new $dt,tft.constructor=tft,tft.id=0,tft.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(t){if(void 0===t)return e[0];for(var i=0,n=e.length;i<n;i+=1)if(e[i].identifier===t)return e[i];return!1}},tft.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"},tft.prototype.begin=function(){var t=this,e=t.options;if("static"===e.mode){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}},tft.prototype.createNipple=function(t,e){var i=this,n=i.manager.scroll,s={},r=i.options,a=i.parentIsFlex?n.x:n.x+i.box.left,o=i.parentIsFlex?n.y:n.y+i.box.top;if(t.x&&t.y)s={x:t.x-a,y:t.y-o};else if(t.top||t.right||t.bottom||t.left){var h=document.createElement("DIV");h.style.display="hidden",h.style.top=t.top,h.style.right=t.right,h.style.bottom=t.bottom,h.style.left=t.left,h.style.position="absolute",r.zone.appendChild(h);var l=h.getBoundingClientRect();r.zone.removeChild(h),s=t,t={x:l.left+n.x,y:l.top+n.y}}var u=new Qdt(i,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:e,position:t,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(Ydt(u.ui.el,s),Ydt(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u},tft.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},tft.prototype.bindNipple=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},tft.prototype.pressureFn=function(t,e,i){var n=this,s=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var i=t.force||t.pressure||t.webkitForce||0;i!==s&&(e.trigger("pressure",i),n.trigger("pressure "+e.identifier+":pressure",i),s=i)}.bind(n),100)},tft.prototype.onstart=function(t){var e=this,i=e.options,n=t;t=zdt(t),e.updateBox();return Hdt(t,function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(i){if(Object.values(n.touches).findIndex(function(t){return t.identifier===i})<0){var s=[t[0]];s.identifier=i,e.processOnEnd(s)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))}),e.manager.bindDocument(),!1},tft.prototype.processOnStart=function(t){var e,i=this,n=i.options,s=i.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,a={x:t.pageX,y:t.pageY},o=i.getOrCreate(s,a);o.identifier!==s&&i.manager.removeIdentifier(o.identifier),o.identifier=s;var h=function(e){e.trigger("start",e),i.trigger("start "+e.id+":start",e),e.show(),r>0&&i.pressureFn(t,e,e.identifier),i.processOnMove(t)};if((e=i.idles.indexOf(o))>=0&&i.idles.splice(e,1),i.actives.push(o),i.ids.push(o.identifier),"semi"!==n.mode)h(o);else{if(!(Odt(a,o.position)<=n.catchDistance))return o.destroy(),void i.processOnStart(t);h(o)}return o},tft.prototype.getOrCreate=function(t,e){var i,n=this,s=n.options;return/(semi|static)/.test(s.mode)?(i=n.idles[0])?(n.idles.splice(0,1),i):"semi"===s.mode?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1):i=n.createNipple(e,t)},tft.prototype.processOnMove=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.scroll;if((t=>isNaN(t.buttons)?0!==t.pressure:0!==t.buttons)(t)){if(!s)return console.error("Found zombie joystick with ID "+n),void e.manager.removeIdentifier(n);if(i.dynamicPage){var a=s.el.getBoundingClientRect();s.position={x:r.x+a.left,y:r.y+a.top}}s.identifier=n;var o=s.options.size/2,h={x:t.pageX,y:t.pageY};i.lockX&&(h.y=s.position.y),i.lockY&&(h.x=s.position.x);var l,u,c=Odt(h,s.position),d=((t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Ddt(Math.atan2(n,i))})(h,s.position),f=Fdt(d),p=c/o,g={distance:c,position:h};if("circle"===s.options.shape?(l=Math.min(c,o),u=((t,e,i)=>{const n={x:0,y:0};return i=Fdt(i),n.x=t.x-e*Math.cos(i),n.y=t.y-e*Math.sin(i),n})(s.position,l,d)):(u=((t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)}))(h,s.position,o),l=Odt(u,s.position)),i.follow){if(c>o){let t=h.x-u.x,i=h.y-u.y;s.position.x+=t,s.position.y+=i,s.el.style.top=s.position.y-(e.box.top+r.y)+"px",s.el.style.left=s.position.x-(e.box.left+r.x)+"px",c=Odt(h,s.position)}}else h=u,c=l;var v=h.x-s.position.x,m=h.y-s.position.y;s.frontPosition={x:v,y:m},i.dataOnly||(s.ui.front.style.transform="translate("+v+"px,"+m+"px)");var y={identifier:s.identifier,position:h,force:p,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:f,degree:d},vector:{x:v/o,y:-m/o},raw:g,instance:s,lockX:i.lockX,lockY:i.lockY};(y=s.computeDirection(y)).angle={radian:Fdt(180-d),degree:180-d},s.trigger("move",y),e.trigger("move "+s.id+":move",y)}else this.processOnEnd(t)},tft.prototype.processOnEnd=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.removeIdentifier(s.identifier);s&&(i.dataOnly||s.hide(function(){"dynamic"===i.mode&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(i.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[r.id]=r.identifier))},tft.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()},tft.prototype.destroy=function(){var t=this;for(var e in t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(t){t.destroy()}),t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()},eft.prototype=new $dt,eft.constructor=eft,eft.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(t){return!(i=t.get(e))}),i}},eft.prototype.create=function(t){return this.createCollection(t)},eft.prototype.createCollection=function(t){var e=this,i=new tft(e,t);return e.bindCollection(i),e.collections.push(i),i},eft.prototype.bindCollection=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},eft.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)},eft.prototype.unbindDocument=function(t){var e=this;Object.keys(e.ids).length&&!0!==t||(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)},eft.prototype.getIdentifier=function(t){var e;return t?void 0===(e=void 0===t.identifier?t.pointerId:t.identifier)&&(e=this.latest||0):e=this.index,void 0===this.ids[e]&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},eft.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e},eft.prototype.onmove=function(t){return this.onAny("move",t),!1},eft.prototype.onend=function(t){return this.onAny("end",t),!1},eft.prototype.oncancel=function(t){return this.onAny("end",t),!1},eft.prototype.onAny=function(t,e){var i,n=this,s="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=zdt(e);var r=function(t,e,i){i.ids.indexOf(e)>=0&&(i[s](t),t._found_=!0)};return Hdt(e,function(t){i=n.getIdentifier(t),Hdt(n.collections,r.bind(null,t,i)),t._found_||n.removeIdentifier(i)}),!1},eft.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(t){t.destroy()}),t.off()},eft.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};const ift=new eft;var nft=function(t){return ift.create(t)};class sft{constructor(t){this.name=t,this.el=null}render(t){}toggle(){if(!this.el)return;const t="none"===this.el.style.display;this.el.style.display=t?"":"none"}close(){this.el.style.display=""}}class rft{constructor(t){this.container=t,this.messages=[],this.maxMessages=10,this.displayTime=5e3}add(t){const e=document.createElement("div");if(e.className="live-chat-message",e.innerHTML=t,this.container.appendChild(e),this.messages.push(e),this.messages.length>this.maxMessages){const t=this.messages.shift();this._removeMessage(t)}setTimeout(()=>{this._removeMessage(e),this.messages=this.messages.filter(t=>t!==e)},this.displayTime)}_removeMessage(t){this.container.contains(t)&&this.container.removeChild(t)}}class aft{static schema={topleftchatlog:{default:!1,name:"Top left Chat Log",type:"boolean",desc:"Enable or disable top-left chat log",category:"general"},use12hFormat:{default:!1,name:"12h time format",type:"boolean",desc:"Use 12h time format (AM/PM)",category:"general"},editorOneTimeClick:{default:!1,name:"One time click",type:"boolean",desc:"Click one time instead of clicking 2 times when editing a element",category:"development"},debug:{default:!1,name:"Debug mode",type:"boolean",desc:"Requires restart",category:"development"}};static store=Object.fromEntries(Object.entries(aft.schema).map(([t,e])=>[t,e.default]));static loadFromLocalStorage(){const t=JSON.parse(localStorage.getItem("options"));if(t)for(const e in t)e in aft.store&&(aft.store[e]=t[e])}static saveToLocalStorage(){localStorage.setItem("options",JSON.stringify(aft.store))}static get(t){if(!(t in aft.store))throw new Error(`Option "${t}" is not defined.`);return aft.store[t]}static put(t,e){const i=aft.schema[t];if(!i)throw new Error(`Option "${t}" does not exist.`);switch(i.type){case"string":if("string"!=typeof e)throw new Error(`"${t}" must be a string.`);if(e.length<i.minLength||e.length>i.maxLength)throw new Error(`"${t}" length must be between ${i.minLength} and ${i.maxLength}.`);break;case"number":if("number"!=typeof e)throw new Error(`"${t}" must be a number.`);if(e<i.min||e>i.max)throw new Error(`"${t}" must be between ${i.min} and ${i.max}.`);break;case"boolean":if("boolean"!=typeof e)throw new Error(`"${t}" must be a boolean.`);break;case"array":if(!Array.isArray(e))throw new Error(`"${t}" must be an array.`);break;case"object":if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(`"${t}" must be an object.`);break;case"select":if(!i.options.includes(e))throw new Error(`"${t}" must be one of: ${i.options.join(", ")}.`);break;default:throw new Error(`Unsupported type for "${t}".`)}aft.store[t]=e,aft.saveToLocalStorage()}static resetAll(){aft.store=Object.fromEntries(Object.entries(aft.schema).map(([t,e])=>[t,e.default])),aft.saveToLocalStorage()}}aft.loadFromLocalStorage();class oft{static commands=[{name:"rand",id:"/rand",description:"Random integer between two numbers: /rand min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /rand min max",!0);const n=Number(i[0]),s=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(s))return void e.send("Both min and max must be valid numbers.",!0);let r=Math.ceil(Math.min(n,s)),a=Math.floor(Math.max(n,s));const o=Math.floor(Math.random()*(a-r+1))+r;e.send("Random number between "+String(r)+" and "+String(a)+": "+String(o),!0)}},{name:"randf",id:"/randf",description:"Random float between two numbers: /randf min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /randf min max",!0);const n=Number(i[0]),s=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(s))return void e.send("Both min and max must be valid numbers.",!0);const r=Math.min(n,s),a=Math.max(n,s),o=Math.random()*(a-r)+r;e.send("Random float between "+String(r)+" and "+String(a)+": "+String(o),!0)}},{name:"choose",id:"/choose",description:"Choose one item from a list: /choose option1 option2 ...",execute:(t,e,i)=>{if(!i||0===i.length)return void e.send("Usage: /choose option1 option2 ...",!0);const n=i[Math.floor(Math.random()*i.length)];e.send('Choosed "'+n+'"',!0)}},{name:"time",id:"/time",description:"Show current time",execute:(t,e,i)=>{e.send("Time: "+t.lightManager.getTimeF(),!0)}}];static parseArgs(t){if(!t||"string"!=typeof t)return[];const e=t.trim().split(" ").slice(1).join(" "),i=[],n=/"([^"\\]*(\\.[^"\\]*)*)"|'([^'\\]*(\\.[^'\\]*)*)'|(\S+)/g;let s;for(;null!==(s=n.exec(e));)void 0!==s[1]?i.push(s[1].replace(/\\(["'\\])/g,"$1")):void 0!==s[3]?i.push(s[3].replace(/\\(["'\\])/g,"$1")):void 0!==s[5]&&i.push(s[5]);return i}static isCommand(t){if(!t||"string"!=typeof t)return!1;const e=t.trim();if(!e.startsWith("/"))return!1;const i=e.split(" ")[0];return oft.commands.some(t=>t.id===i)}static handleCommand(t,e,i){if(!oft.isCommand(t))return!1;const n=t.split(" ")[0],s=oft.commands.find(t=>t.id===n);if(!s)return!1;const r=oft.parseArgs(t);try{return s.execute(e,i,r),!0}catch(t){return console.error("Command error:",t),i.send("Command execution error.",!0),!1}}}class hft extends sft{constructor({scene:t,network:e,minChars:i=1,maxChars:n=75}){super("chatbox"),this.minChars=i,this.maxChars=n,this.visible=!1,this.logVisible=!1,this.scene=t,this.network=e,this.suggestIndex=-1,this.isTyping=!1,this.typingTimeout=null,this.TYPING_DELAY=5e3}render(t){this.el=document.createElement("div"),this.el.className="chatbox-container";const i=document.createElement("button");i.className="chatbox-button",i.innerHTML='<img src="'+e.getBlob("assets/icons/message.png").dataUrl+'" alt="Chat">',i.addEventListener("click",()=>this.toggleBox()),this.el.appendChild(i);const n=document.createElement("button");n.className="chatbox-log-button",n.innerHTML='<img src="'+e.getBlob("assets/icons/list.png").dataUrl+'" alt="Chat List">',n.addEventListener("click",()=>this.toggleLogBox()),this.el.appendChild(n),this.chatBox=document.createElement("div"),this.chatBox.className="chatbox-box",this.chatBox.style.display="none",this.chatBoxLog=document.createElement("div"),this.chatBoxLog.className="chatbox-log-box",this.chatBoxLog.style.display="none",this.textarea=document.createElement("input"),this.textarea.className="chatbox-input",this.textarea.setAttribute("placeholder","Write your message..."),this.textarea.setAttribute("maxlength",this.maxChars),this.chatBox.appendChild(this.textarea),this.suggestBox=document.createElement("div"),this.suggestBox.className="chatbox-suggest",this.suggestBox.style.display="none",this.suggestBox.setAttribute("role","listbox"),this.chatBox.appendChild(this.suggestBox),this.charCounter=document.createElement("div"),this.charCounter.className="chatbox-counter",this.updateCounter(),this.chatBox.appendChild(this.charCounter);const s=document.createElement("button");s.className="chatbox-send",s.innerHTML='<img src="'+e.getBlob("assets/icons/rightarrow.png").dataUrl+'">',s.disabled=!0,s.addEventListener("click",()=>this.handleSend()),this.chatBox.appendChild(s),this.textarea.addEventListener("input",()=>{const t=this.textarea.value.trim().length;s.disabled=t<this.minChars,this.updateCounter(),this.updateSuggestions(),this._onUserTyping()}),this.textarea.addEventListener("keydown",t=>{"Enter"===t.key&&this.handleSend()}),document.getElementById("chat-log"),this.lchatlog=new rft(t),this.el.appendChild(this.chatBox),this.el.appendChild(this.chatBoxLog),t.appendChild(this.el)}_emitTyping(t){this.scene.networkManager.emitTyping(t)}_onUserTyping(){this.isTyping||(this.isTyping=!0,this._emitTyping(!0)),this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(()=>{this.isTyping=!1,this._emitTyping(!1),this.typingTimeout=null},this.TYPING_DELAY)}_stopTypingImmediate(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null),this.isTyping&&(this.isTyping=!1,this._emitTyping(!1))}toggleBox(){this.visible=!this.visible,this.chatBox.style.display=this.visible?"flex":"none",this.visible?this.textarea.focus():(this._stopTypingImmediate(),this.textarea.value=""),this.scene.inputManager.setKeysStatus(!this.visible)}toggleLogBox(){this.logVisible=!this.logVisible,this.chatBoxLog.style.display=this.logVisible?"flex":"none"}updateCounter(){const t=this.textarea.value.length;this.charCounter.textContent=`${t}/${this.maxChars}`}handleSend(){const t=this.textarea.value.trim();t.length>=this.minChars&&t.length<=this.maxChars&&(this.send(t),this.textarea.value="",this.updateCounter(),this.chatBox.style.display="none",this.visible=!1,this.hideSuggestions(),this._stopTypingImmediate())}send(t,e=!1){oft.isCommand(t)?oft.handleCommand(t,this.scene,this):this.scene.networkManager.emitChatMessage(t,e)}addMessage(t,e,i){const n=document.createElement("span");n.className="chatbox-log-message";const s=document.createElement("span");s.textContent=this.scene.lightManager.getTimeF(),s.className="timestamp";const r=document.createElement("span");r.textContent=t,r.className="name";const a=document.createElement("span");a.textContent=e,a.className="message",i&&(a.style.color="yellow"),n.appendChild(s),n.appendChild(r),n.appendChild(a),aft.get("topleftchatlog")&&this.lchatlog.add(n.innerHTML),this.chatBoxLog.appendChild(n)}updateSuggestions(){const t=this.textarea.value;if(!t.startsWith("/"))return void this.hideSuggestions();const e=t.slice(1).toLowerCase(),i=(oft.commands||[]).filter(t=>{const i=(t.name||"").toLowerCase(),n=(t.id||"").toLowerCase();return i.includes(e)||n.includes(e)});i.length?(this.suggestBox.innerHTML="",i.slice(0,8).forEach((t,e)=>{const i=document.createElement("div");i.className="chatbox-suggest-item",i.setAttribute("role","option"),i.textContent=`/${t.name} â ${t.description||""}`,i.addEventListener("click",e=>{e.preventDefault(),this.applySuggestion(t)}),this.suggestBox.appendChild(i)}),this.suggestIndex=-1,this.updateSuggestHighlight(),this.suggestBox.style.display="block"):this.hideSuggestions()}applySuggestion(t){this.textarea.value=`/${t.name} `,this.updateCounter(),this.hideSuggestions(),this.textarea.focus(),this._onUserTyping()}hideSuggestions(){this.suggestBox&&(this.suggestBox.style.display="none",this.suggestBox.innerHTML="",this.suggestIndex=-1)}updateSuggestHighlight(){Array.from(this.suggestBox.querySelectorAll(".chatbox-suggest-item")).forEach((t,e)=>{e===this.suggestIndex?(t.classList.add("active"),t.scrollIntoView({block:"nearest"})):t.classList.remove("active")})}}class lft extends sft{constructor({scene:t}){super("options"),this.options=[{execute:()=>{t.inputManager.optionsModal.toggle()},html:"<img src='"+e.getBlob("assets/icons/control.png").dataUrl+"'>Settings",name:"options"},{execute:()=>{window.location.reload()},html:"<img src='"+e.getBlob("assets/icons/leave.png").dataUrl+"'>Leave",name:"leave"}],t.dev&&this.options.push({execute:()=>{t.inputManager.editorModal.toggle()},html:"<img src='"+e.getBlob("assets/icons/box.png").dataUrl+"'>Map editor",name:"open_editor"}),this.scene=t,this.headerTime=null,this.scene.lightManager.onTimeChange(t=>{this.headerTime&&(this.headerTime.textContent=t.getTimeF())})}render(t){const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/settings.png").dataUrl+'">',i.className="options-button",i.onclick=()=>this.toggle(),this.el=document.createElement("ul"),this.el.className="options-list",this.el.style.display="none";const n=document.createElement("div");n.innerHTML="<div class=\"header-brand\"><img src='/logo.png'>Hawk</div>",n.className="options-header",this.headerTime=document.createElement("div"),n.appendChild(this.headerTime),this.el.appendChild(n),this.options.forEach(t=>{const e=document.createElement("li");e.innerHTML=t.html,e.addEventListener("click",()=>{t.execute()}),this.el.appendChild(e)}),t.appendChild(i),t.appendChild(this.el)}}class uft extends sft{constructor({onZoomIn:t,onZoomOut:e}){super("zoom"),this.onZoomIn=t,this.onZoomOut=e}render(t){this.el=document.createElement("div"),this.el.className="zoom-container";const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/plus.png").dataUrl+'">',i.className="zoom-button",i.onclick=this.onZoomIn;const n=document.createElement("button");n.innerHTML='<img src="'+e.getBlob("assets/icons/hyphen.png").dataUrl+'">',n.className="zoom-button",n.onclick=this.onZoomOut,this.el.appendChild(i),this.el.appendChild(n),t.appendChild(this.el)}}class cft extends sft{constructor({scene:t,onClickMe:e,onClickPeople:i}){super("acc"),this.onClickMe=e,this.onClickPeople=i,this.scene=t,this.peopleVisible=!1}render(t){this.el=document.createElement("div"),this.el.className="acc-container";const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/Person.png").dataUrl+'">',i.className="acc-button",i.onclick=this.onClickMe;const n=document.createElement("button");n.innerHTML='<img src="'+e.getBlob("assets/icons/people.png").dataUrl+'">',n.className="acc-button",n.onclick=()=>this.togglePeople(),this.peopleContainer=document.createElement("div"),this.peopleContainer.className="people-container",this.peopleContainer.style.display="none";const s=document.createElement("div");s.innerHTML='<div class="header-brand"><img src=\''+e.getBlob("assets/icons/people.png").dataUrl+"'>People</div><button class=\"header-button\"><img src='"+e.getBlob("assets/icons/friends.png").dataUrl+"'></button>",s.className="people-header",s.querySelector("button").addEventListener("click",()=>{this.scene.inputManager.peopleModal.toggle()}),this.peopleList=document.createElement("ul"),this.peopleList.className="people-list",this.peopleContainer.appendChild(s),this.peopleContainer.appendChild(this.peopleList),this.el.appendChild(i),this.el.appendChild(n),t.appendChild(this.el),t.appendChild(this.peopleContainer)}togglePeople(){if(this.peopleVisible=!this.peopleVisible,this.peopleContainer.style.display=this.peopleVisible?"block":"none",this.peopleVisible){const t=this.scene.networkManager.players;t!={}?(this.peopleList.innerHTML="",Object.values(t).forEach(t=>{const e=document.createElement("li"),i=document.createElement("div");i.className="people-user-header";const n=document.createElement("img");n.src=t.avatar||"logo.png";const s=document.createElement("p");s.innerText=t.display_name+(t.id==this.scene.player.id?" (you)":"");const r=document.createElement("p");r.className="accent",r.innerText="@"+t.username,i.appendChild(n),i.appendChild(s),e.appendChild(i),e.appendChild(r),this.peopleList.appendChild(e)})):this.peopleList.innerHTML="<small class='accent'>There are no people nearby.</small>"}}}class dft{constructor(t,{components:e=[]}){this.container=document.createElement("div"),this.container.id="game-hud",this.container.style.display="none",Object.assign(this.container.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"});const i=document.createElement("p");i.innerText="FPS: 0",i.id="fps-text",this.container.appendChild(i);"static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(this.container),this.components=e.map(t=>{const e=new(0,t.type)(t.options||{});return e.render(this.container),e})}getComponent(t){return this.components.find(e=>e.name===t)}}class fft{constructor(t,e,i=null,n={showHeader:!0}){this.scene=i,this.overlay=document.createElement("div"),this.overlay.className="modal-overlay",this.modal=document.createElement("div"),this.modal.className="modal-container";const s=document.createElement("div");s.className="modal-header";const r=document.createElement("p");r.textContent=e,s.appendChild(r),this.closeBtn=document.createElement("button"),this.closeBtn.className="modal-close",this.closeBtn.innerHTML="&times;",this.closeBtn.addEventListener("click",()=>this.toggle()),s.appendChild(this.closeBtn),this.body=document.createElement("div"),this.body.className="modal-body",n.showHeader?this.modal.append(s,this.body):this.modal.append(this.body),this.overlay.appendChild(this.modal),t.appendChild(this.overlay),this.isOpen=!1}toggle(){this.isOpen=!this.isOpen,this.overlay.style.display=this.isOpen?"flex":"none",this.scene&&this.scene.inputManager.joystickModalEnable(this.isOpen)}}class pft extends fft{constructor(t,e){super(t,"Options",e,{showHeader:!1}),this.categories=this._groupByCategory(),this._categoriesInfo={general:{icon:"assets/icons/generalinfo.png",name:"General"},development:{icon:"assets/icons/control.png",name:"Development"}},this._originalValues={},this._buildTabs(),this._buildForms(),this._bindEvents(),this.scene=e}_groupByCategory(){const t={};for(const[e,i]of Object.entries(aft.schema)){if("development"==i.category&&!this.scene.dev)continue;const n=i.category||"general";t[n]||(t[n]=[]),t[n].push({name:e,cfg:i})}return t}_buildTabs(){this.tabNav=document.createElement("ul"),this.tabNav.className="options-tabs",Object.keys(this.categories).forEach((t,e)=>{const i=document.createElement("li");i.innerHTML="<img src='"+this._categoriesInfo[t]?.icon+"'>",i.dataset.tab=t,0===e&&i.classList.add("active"),this.tabNav.append(i)}),this.body.append(this.tabNav)}_buildForms(){this.forms={},Object.entries(this.categories).forEach(([t,e],i)=>{const n=document.createElement("form");n.className="options-form",0!==i&&(n.style.display="none"),n.dataset.cat=t,e.forEach(({name:t,cfg:e})=>{const i=document.createElement("div");i.className="option-item";const s=document.createElement("label");let r;s.htmlFor=t,s.innerHTML=`${e.name}<br><span>${e.desc}</span>`,s.className="option-label",i.append(s);const a=aft.get(t);switch(e.type){case"string":case"number":r=document.createElement("input"),r.type="string"===e.type?"text":"number",void 0!==e.min&&(r.min=e.min),void 0!==e.max&&(r.max=e.max),void 0!==e.minLength&&(r.minLength=e.minLength),void 0!==e.maxLength&&(r.maxLength=e.maxLength),r.value=a;break;case"boolean":r=document.createElement("div");const t=document.createElement("input");t.type="checkbox",t.className="ikxBAC",t.checked=a,r.appendChild(t),i.className="option-item-checkbox";break;case"select":r=document.createElement("select"),e.options.forEach(t=>{const e=document.createElement("option");e.value=t,e.innerText=t,t===a&&(e.selected=!0),r.append(e)});break;case"array":r=document.createElement("textarea"),r.value=JSON.stringify(a);break;case"object":r=document.createElement("textarea"),r.value=JSON.stringify(a,null,2)}r.id=t,i.append(r),n.append(i)}),this.forms[t]=n,this.body.append(n)});const t=document.createElement("div");t.className="options-footer";const e=document.createElement("button");e.type="button",e.textContent="Save",e.className="button-save button-green",e.disabled=!0;const i=document.createElement("button");i.type="button",i.textContent="Cancel",i.className="button-cancel button-gray",t.appendChild(e),t.appendChild(i),this.body.append(t),this._btnSave=e,this._btnCancel=i}toggle(){super.toggle(),this.visible&&(this._captureOriginalValues(),this._setSaveDisabled(!0))}_captureOriginalValues(){this._originalValues={};for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=aft.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;if("object"===i.type||"array"===i.type)try{this._originalValues[t]=JSON.parse(JSON.stringify(n))}catch{this._originalValues[t]=n}else this._originalValues[t]=n}}_setSaveDisabled(t){this._btnSave.disabled=t}_bindEvents(){this.tabNav.addEventListener("click",t=>{if("LI"!==t.target.tagName)return;const e=t.target.dataset.tab;[...this.tabNav.children].forEach(t=>t.classList.toggle("active",t.dataset.tab===e)),Object.values(this.forms).forEach(t=>{t.style.display=t.dataset.cat===e?"":"none"})}),this._btnCancel.addEventListener("click",()=>{this._restoreOriginalValues(),this.toggle()}),this._btnSave.addEventListener("click",()=>{try{for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=aft.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else n="number"===i.type?""===e.value?null:Number(e.value):"array"===i.type||"object"===i.type?JSON.parse(e.value||("array"===i.type?"[]":"{}")):e.value;aft.put(t,n)}this._captureOriginalValues(),this._setSaveDisabled(!0),this.toggle()}catch(t){console.error(t),alert(t.message)}});for(const t of Object.values(this.forms))t.addEventListener("input",()=>this._checkForModifications()),t.addEventListener("change",()=>this._checkForModifications())}_checkForModifications(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=aft.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;if(!((t,e)=>{try{return JSON.stringify(t)===JSON.stringify(e)}catch{return t===e}})(n,this._originalValues[t]))return void this._setSaveDisabled(!1)}this._setSaveDisabled(!0)}_restoreOriginalValues(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=aft.schema[t],n=this._originalValues[t];if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");t&&(t.checked=!!n)}else if("number"===i.type)e.value=null==n?"":String(n);else if("array"===i.type||"object"===i.type)try{e.value=JSON.stringify(n,null,"object"===i.type?2:0)}catch{e.value=n}else e.value=void 0===n?"":String(n)}this._setSaveDisabled(!0)}}function gft(t,a=!1,o=!1){(t||document.getElementById("app")).innerHTML=`\n  <div class="auth" ${o?'style="margin: 0 0;"':""}>\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/people.png").dataUrl}"></canv-icon>People</h3>\n    <span class="description">Send, recieve, accept friend requests.</span>\n            <div class="friends-actions">\n              <button id="refreshBtn" class="friends-ghost">Refresh</button>\n              ${o?'<button id="closeBtn" class="friends-ghost">Close</button>':""}\n            </div>\n  </div>\n  <hr>\n      <aside class="friends-sidebar mini">\n        <div class="friends-card" style="padding-bottom:10px">\n          <div style="margin-top:10px">\n            <div class="small" style="color:rgba(255,255,255,0.7)">Send friend request by username</div>\n            <div class="friends-send-row">\n              <input id="sendUserId" class="friends-input" placeholder="Username, ex cheese72" />\n              <button id="sendByIdBtn" class="friends-primary">Send</button>\n            </div>\n            <div id="sendResult" class="friends-empty" style="margin-top:8px"></div>\n          </div>\n        </div>\n\n        <div class="friends-card">\n          <div id="accountInfo" style="margin-top:8px;color:rgba(255,255,255,0.8)"></div>\n        </div>\n      </aside>\n\n      <section>\n        <div style="margin-bottom:8px">\n          <div class="friends-tabs" id="tabs">\n            <button class="friends-tab active" data-tab="friends">Friends</button>\n            <button class="friends-tab" data-tab="incoming">Incoming</button>\n            <button class="friends-tab" data-tab="sent">Sent</button>\n          </div>\n        </div>\n\n        <div id="panelArea">\n          <div id="friendsPanel" class="friends-list friends-card"></div>\n          <div id="incomingPanel" class="friends-list friends-card" style="display:none"></div>\n          <div id="sentPanel" class="friends-list friends-card" style="display:none"></div>\n        </div>\n      </section>\n      </div>\n  `;const h=n(),l=document.getElementById("accountInfo");async function u(){if(document.getElementById("friendsPanel").innerHTML='<div class="friends-empty">Loading friends...</div>',document.getElementById("incomingPanel").innerHTML='<div class="friends-empty">Loading incoming...</div>',document.getElementById("sentPanel").innerHTML='<div class="friends-empty">Loading sent...</div>',!h.username||!h.password)return t="Not authenticated. Please log in.",document.getElementById("friendsPanel").innerHTML=`<div class="friends-empty">${i(t)}</div>`,document.getElementById("incomingPanel").innerHTML=`<div class="friends-empty">${i(t)}</div>`,void(document.getElementById("sentPanel").innerHTML=`<div class="friends-empty">${i(t)}</div>`);var t;const[e,n,r]=await Promise.allSettled([s(y,h),s(x,h),s(w,h)]),a="fulfilled"===e.status&&e.value&&e.value.friends?e.value.friends:[],o="fulfilled"===n.status&&n.value?n.value:null,l="fulfilled"===r.status&&r.value?r.value:null;let p=[],g=[];l&&(Array.isArray(l.incoming)?p=l.incoming:Array.isArray(l.pending)&&(p=l.pending)),o&&(Array.isArray(o.sent)?g=o.sent:Array.isArray(o.requests)&&(g=o.requests)),function(t){const e=document.getElementById("friendsPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No friends yet."));t.forEach(t=>e.append(function(t){const e=document.createElement("div");e.className="friends-row";const n=document.createElement("div");n.innerHTML=`<div class="friends-name">${i(t.display_name||t.username||"Unnamed")}</div><div class="friends-meta">@${i(t.username)} Â· ID ${i(String(t.id))}</div>`;const r=document.createElement("div");r.className="friends-controls";const a=document.createElement("button");return a.className="friends-ghost",a.textContent="Remove",a.addEventListener("click",async()=>{await async function(t){if(!t)return;await s(_,{...h,friendUsername:t}),await u()}(t.username)}),r.appendChild(a),e.appendChild(n),e.appendChild(r),e}(t)))}(a),async function(t){const e=document.getElementById("incomingPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No incoming requests."));for(const i of t)e.append(await d(i))}(p),async function(t){const e=document.getElementById("sentPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No sent requests."));for(const i of t)e.append(await f(i))}(g)}function c(t){const e=document.createElement("div");return e.className="friends-empty",e.textContent=t,e}async function d(t){const e=document.createElement("div");e.className="friends-row";const n=document.createElement("div"),r=t.requesterId,a=(await s("/api/auth/profile",{id:r})).username||"Unknown";n.innerHTML=`<div class="friends-name">From ${i(String(a))}</div><div class="friends-meta">Request ID: ${i(String(t.id||""))}</div>`;const o=document.createElement("div");o.className="friends-controls";const l=document.createElement("button");l.className="friends-primary",l.textContent="Accept";const c=document.createElement("button");return c.className="friends-ghost",c.textContent="Deny",l.addEventListener("click",async()=>{await async function(t){if(!t)return;await s(S,{...h,requestId:t}),await u()}(t.id)}),c.addEventListener("click",async()=>{await async function(t){if(!t)return;await s(E,{...h,requestId:t}),await u()}(t.id)}),o.appendChild(l),o.appendChild(c),e.appendChild(n),e.appendChild(o),e}async function f(t){const e=document.createElement("div");e.className="friends-row";const n=document.createElement("div"),r=t.requestedId,a=(await s("/api/auth/profile",{id:r})).username||"Unknown";n.innerHTML=`<div class="friends-name">To ${i(String(a))}</div><div class="friends-meta">Request ID: ${i(String(t.id||""))}</div>`;const o=document.createElement("div");o.className="friends-controls";const l=document.createElement("button");return l.className="friends-ghost",l.textContent="Cancel",l.addEventListener("click",async()=>{await async function(t){if(!t)return;await s(T,{...h,requestId:t}),await u()}(t.id)}),o.appendChild(l),e.appendChild(n),e.appendChild(o),e}h.username&&h.password?l.innerHTML=`<div><strong>@${i(h.username)}</strong></div><div class="accent small">Your username</div>`:l.innerText="Not authenticated. Please log in.",r("#tabs .friends-tab").forEach(t=>{t.addEventListener("click",()=>{r("#tabs .friends-tab").forEach(t=>t.classList.remove("active")),t.classList.add("active");const e=t.dataset.tab;["friends","incoming","sent"].forEach(t=>{const i=document.getElementById(t+"Panel");i&&(i.style.display=t===e?"":"none")})})}),document.getElementById("sendByIdBtn").addEventListener("click",async()=>{const t=document.getElementById("sendUserId").value.trim();t&&await async function(t){if(!t)return alert("Enter a username.");const e={...h,targetUsername:t},i=await s(b,e),n=i&&(i.error||i.message||JSON.stringify(i));document.getElementById("sendResult").innerText=n||"Sent",await u()}(t)}),document.getElementById("refreshBtn").addEventListener("click",u),u()}class vft extends fft{constructor(t,e){super(t,"People",e,{showHeader:!1}),this.scene=e,gft(this.body,!0,!0),this.body.querySelector("#closeBtn").addEventListener("click",t=>{this.toggle()})}toggle(){super.toggle()}}class mft{static clickDelay=300;static states=new WeakMap;static current=null;static tooltip=null;static setEditable(t,e){const i=t.image;mft.states.set(i,{editMode:!1,mode:"move",lastClickTime:0,raw:t,dragOffset:{x:0,y:0}}),i.setInteractive({draggable:!0}),mft.tooltip||mft._createTooltip(e),i.on("pointerdown",n=>{const s=mft.states.get(i),r=e.time.now,a=r-s.lastClickTime,o="number"==typeof i.originX?i.originX:.5,h="number"==typeof i.originY?i.originY:.5,l=i.x-i.displayWidth*o,u=i.y-i.displayHeight*h;s.dragOffset.x=n.worldX-l,s.dragOffset.y=n.worldY-u,(aft.get("editorOneTimeClick")||a<mft.clickDelay)&&(mft.current&&mft.current!==i&&mft._disableEdit(mft.current,e),s.editMode?mft._disableEdit(i,e,t):mft._enableEdit(i,e,t)),s.lastClickTime=r}),i.on("drag",e=>{const n=mft.states.get(i);if(!n.editMode||"move"!==n.mode)return;const s=e.worldX-n.dragOffset.x,r=e.worldY-n.dragOffset.y,a="number"==typeof i.originX?i.originX:.5,o="number"==typeof i.originY?i.originY:.5,h=s+i.displayWidth*a,l=r+i.displayHeight*o;t.setPosition(Math.floor(h),Math.floor(l)),mft._updateTooltipPosition(i)})}static _createTooltip(t){const e=t.add.container(0,0),i=t.add.rectangle(0,0,102,20,0,.7).setOrigin(0),n=t.add.text(5,5,"Move",{fontSize:"12px",color:"#fff"}).setInteractive(),s=t.add.text(55,5,"Delete",{fontSize:"12px",color:"#f55"}).setInteractive();n.on("pointerdown",()=>{if(!mft.current)return;mft.states.get(mft.current).mode="move",n.setStyle({backgroundColor:"#555"}),s.setStyle({backgroundColor:null})}),s.on("pointerdown",()=>{if(!mft.current)return;const e=mft.current,i=mft.states.get(e).raw;mft.tooltip.setVisible(!1),mft.states.delete(e),t.networkManager.emitDeleteElement(i),t.mapObjects.destroy(i),mft.current=null,t.inputManager.joystickSetEnabled(!0)}),e.add([i,n,s]),e.setDepth(1e8).setVisible(!1),mft.tooltip=e}static _enableEdit(t,e,i){const n=mft.states.get(t);n.editMode=!0,n.mode="move",t.setAlpha(.5),mft.current=t,e.inputManager.joystickSetEnabled(!1),mft.tooltip.setVisible(!0),mft.tooltip.list[1].setStyle({backgroundColor:"#555"}),mft.tooltip.list[2].setStyle({backgroundColor:null}),mft._updateTooltipPosition(t)}static _disableEdit(t,e,i){const n=mft.states.get(t);"delete"===n.mode&&t.emit("editableDelete",t),n.editMode=!1,t.setAlpha(1),mft.current=null,e.inputManager.joystickSetEnabled(!0),mft.tooltip.setVisible(!1),e.networkManager.emitMoveElement(i)}static _updateTooltipPosition(t){mft.tooltip.x=t.x+0,mft.tooltip.y=t.y+0-mft.tooltip.list[0].height}}class yft{static _nextId=1;static textureCache=new Map;constructor(t,e,i,n,s,r,a,o=0){this.id=yft._nextId++,this.scene=t,this.width=r,this.height=a,this.zoffset=o,this.x=e,this.y=i;const h=yft.textureCache,l=`${n}|${s.u},${s.v}|${r}x${a}`;let u=h.get(l);if(u)u.refCount++;else{const e=t.textures.get(n).getSourceImage(),i=`crop-${n}-${s.u}-${s.v}-${r}x${a}`;if(!t.textures.exists(i)){t.textures.createCanvas(i,r,a);const n=t.textures.get(i);n.getSourceImage().getContext("2d").drawImage(e,s.u,s.v,r,a,0,0,r,a),n.refresh()}u={key:i,refCount:1},h.set(l,u)}this._cacheKey=l,this._textureKey=u.key,this.image=t.add.image(e,i,this._textureKey).setOrigin(0,0).setDepth(i),t.physics.add.existing(this.image),this.image.body.setSize(0,0).setBounce(1,1).setCollideWorldBounds(!0).setImmovable(!0),this.image.setData("id",this.id),t.dev&&mft.setEditable(this,this.scene)}update(t,e){this.image.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){this.x=t,this.y=e,this.image.setPosition(t,e),this.image.setDepth(this.image.y+this.height-this.zoffset)}destroy(){this.image.body&&this.scene.physics.world.disableBody(this.image.body),this.image.destroy()}}class xft extends yft{static texture="plants";static types=[{name:"1",uvStartPx:{u:19,v:76},widthPx:65,heightPx:108,zoffset:8,collision:{startx:25,starty:97,width:6,height:11}},{name:"2",uvStartPx:{u:104,v:59},widthPx:87,heightPx:124,zoffset:7,collision:{startx:35,starty:115,width:8,height:9}},{name:"3",uvStartPx:{u:196,v:42},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"4",uvStartPx:{u:319,v:21},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"5",uvStartPx:{u:445,v:5},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}},{name:"6",uvStartPx:{u:19,v:271},widthPx:65,heightPx:108,zoffset:10,collision:{startx:25,starty:97,width:6,height:11}},{name:"7",uvStartPx:{u:104,v:254},widthPx:87,heightPx:124,zoffset:8,collision:{startx:35,starty:115,width:8,height:9}},{name:"8",uvStartPx:{u:196,v:237},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"9",uvStartPx:{u:319,v:216},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"10",uvStartPx:{u:445,v:200},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(xft.types.length),r=xft.types[s];super(t,e,i,xft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class wft extends yft{static texture="props";static types=[{name:"1",uvStartPx:{u:683,v:1994},widthPx:14,heightPx:13,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"2",uvStartPx:{u:681,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"3",uvStartPx:{u:715,v:1994},widthPx:14,heightPx:13,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"4",uvStartPx:{u:713,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"5",uvStartPx:{u:740,v:1991},widthPx:22,heightPx:19,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"6",uvStartPx:{u:739,v:2028},widthPx:22,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"7",uvStartPx:{u:770,v:1990},widthPx:25,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"8",uvStartPx:{u:771,v:2021},widthPx:27,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"9",uvStartPx:{u:801,v:1991},widthPx:28,heightPx:19,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"10",uvStartPx:{u:847,v:1954},widthPx:28,heightPx:28,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"11",uvStartPx:{u:845,v:1990},widthPx:35,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"12",uvStartPx:{u:848,v:2016},widthPx:33,heightPx:27,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"13",uvStartPx:{u:904,v:1953},widthPx:41,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"14",uvStartPx:{u:909,v:1985},widthPx:36,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"15",uvStartPx:{u:912,v:2016},widthPx:34,heightPx:24,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"16",uvStartPx:{u:969,v:1965},widthPx:46,heightPx:36,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}},{name:"17",uvStartPx:{u:965,v:2016},widthPx:55,heightPx:30,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(wft.types.length),r=wft.types[s];super(t,e,i,wft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class bft extends yft{static texture="props";static types=[{name:"1",uvStartPx:{u:96,v:18},widthPx:39,heightPx:46,zoffset:20,collision:{startx:0,starty:26,width:32,height:20}},{name:"2",uvStartPx:{u:163,v:22},widthPx:31,heightPx:39,zoffset:10,collision:{startx:0,starty:25,width:26,height:14}},{name:"3",uvStartPx:{u:95,v:81},widthPx:41,heightPx:47,zoffset:20,collision:{startx:0,starty:27,width:32,height:20}},{name:"4",uvStartPx:{u:162,v:85},widthPx:33,heightPx:40,zoffset:10,collision:{startx:0,starty:25,width:26,height:24}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(bft.types.length),r=bft.types[s];super(t,e,i,bft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Tft extends yft{static texture="props";static types=[{name:"normal",uvStartPx:{u:225,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"without_cap",uvStartPx:{u:289,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_water",uvStartPx:{u:225,v:1178},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_plant",uvStartPx:{u:353,v:1104},widthPx:36,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"with_props",uvStartPx:{u:289,v:1168},widthPx:35,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"sided",uvStartPx:{u:225,v:1242},widthPx:32,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"pile",uvStartPx:{u:290,v:1225},widthPx:62,heightPx:54,zoffset:10,collision:{startx:0,starty:34,width:60,height:20}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Tft.types.length),r=Tft.types[s];super(t,e,i,Tft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Sft extends yft{static texture="props";static type={name:"1",uvStartPx:{u:491,v:1640},widthPx:13,heightPx:17,zoffset:3,collision:{startx:0,starty:11,width:9,height:6}};constructor(t,e,i,n={used:!1}){if(super(t,e,i,Sft.texture,Sft.type.uvStartPx,Sft.type.widthPx,Sft.type.heightPx,Sft.type.zoffset),this.type=Sft.type.name,this.light=t.lightManager.addLight(this.x+this.width/2,this.y+this.height/2,150,16777215,.9),n.used){const{startx:t,starty:e,width:i,height:n}=Sft.type.collision;this.image.body.setSize(i,n),this.image.body.setOffset(t,e)}}destroy(){this.scene.lightManager.removeLightObj(this.light),super.destroy()}}class Eft extends yft{static texture="props";static types=[{name:"1",uvStartPx:{u:391,v:1676},widthPx:64,heightPx:84,zoffset:9,collision:{startx:0,starty:74,width:17,height:10}},{name:"2",uvStartPx:{u:461,v:1676},widthPx:57,heightPx:84,zoffset:9,collision:{startx:28,starty:74,width:17,height:10}}];constructor(t,e,i,n=-1){const s={u:491,v:1640},r=9,a=17,o=Eft.texture,h=-1!=n?n:t.random.getNextInt(Eft.types.length),l=Eft.types[h];super(t,e,i,o,l.uvStartPx,l.widthPx,l.heightPx,l.zoffset),this.type=l.name;const{startx:u,starty:c,width:d,height:f}=l.collision;this.image.body.setSize(d,f),this.image.body.setOffset(u,c);const p=yft.textureCache,g=`${o}|${s.u},${s.v}|${r}x${a}`;let v=p.get(g);if(v)v.refCount++;else{const e=t.textures.get(o).getSourceImage(),i=`crop-${o}-${s.u}-${s.v}-${r}x${a}`;if(!t.textures.exists(i)){t.textures.createCanvas(i,r,a);const n=t.textures.get(i);n.getSourceImage().getContext("2d").drawImage(e,s.u,s.v,r,a,0,0,r,a),n.refresh()}v={key:i,refCount:1},p.set(g,v)}this.__cacheKey=g,this.__textureKey=v.key,this.lightXOffset=0==n?35:1,this.lightYOffset=22,this.lampImage=t.add.image(e+this.lightXOffset,i+this.lightYOffset,this.__textureKey).setOrigin(0,0).setDepth(i-1),this.light=t.lightManager.addLight(e+this.lightXOffset,i+this.lightYOffset,150,16777215,.9)}update(t,e){super.update(t,e),this.lampImage.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){super.setPosition(t,e),this.lampImage.setPosition(t+this.lightXOffset,e+this.lightYOffset),this.lampImage.setDepth(e-1),this.light.x=t+this.lightXOffset+4,this.light.y=e+this.lightYOffset+8}destroy(){super.destroy(),this.lampImage.body&&this.scene.physics.world.disableBody(this.lampImage.body),this.lampImage.destroy(),this.scene.lightManager.removeLightObj(this.light)}}class _ft extends yft{static texture="plants";static types=[{name:"1",uvStartPx:{u:34,v:899},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"2",uvStartPx:{u:93,v:896},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"3",uvStartPx:{u:153,v:887},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"4",uvStartPx:{u:217,v:890},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"5",uvStartPx:{u:293,v:886},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"6",uvStartPx:{u:379,v:886},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"7",uvStartPx:{u:472,v:872},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}},{name:"8",uvStartPx:{u:34,v:963},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"9",uvStartPx:{u:93,v:960},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"10",uvStartPx:{u:153,v:951},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"11",uvStartPx:{u:217,v:954},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"12",uvStartPx:{u:293,v:950},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"13",uvStartPx:{u:379,v:950},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"14",uvStartPx:{u:472,v:936},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(_ft.types.length),r=_ft.types[s];super(t,e,i,_ft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Cft extends yft{static texture="plants";static types=[{name:"cabbage_1",uvStartPx:{u:867,v:646},widthPx:29,heightPx:22,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_2",uvStartPx:{u:931,v:648},widthPx:28,heightPx:19,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_3",uvStartPx:{u:999,v:652},widthPx:19,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_1",uvStartPx:{u:861,v:674},widthPx:38,heightPx:28,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_2",uvStartPx:{u:931,v:678},widthPx:31,heightPx:21,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_3",uvStartPx:{u:1e3,v:682},widthPx:18,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_1",uvStartPx:{u:869,v:707},widthPx:25,heightPx:24,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_2",uvStartPx:{u:935,v:711},widthPx:20,heightPx:18,zoffset:4,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_3",uvStartPx:{u:1e3,v:713},widthPx:16,heightPx:15,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Cft.types.length),r=Cft.types[s];super(t,e,i,Cft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Aft extends yft{static texture="building";static type={name:"1",uvStartPx:{u:569,v:425},widthPx:155,heightPx:279,zoffset:10,collision:{startx:0,starty:79,width:142,height:200}};constructor(t,e,i){super(t,e,i,Aft.texture,Aft.type.uvStartPx,Aft.type.widthPx,Aft.type.heightPx,Aft.type.zoffset),this.type=Aft.type.name;const{startx:n,starty:s,width:r,height:a}=Aft.type.collision;this.image.body.setSize(r,a),this.image.body.setOffset(n,s)}}class Pft extends yft{static texture="props";static types=[{name:"1",uvStartPx:{u:905,v:1728},widthPx:46,heightPx:32,zoffset:9,collision:{startx:0,starty:4,width:46,height:28}}];constructor(t,e,i){const n=Pft.types[0];super(t,e,i,Pft.texture,n.uvStartPx,n.widthPx,n.heightPx,n.zoffset),this.type=n.name;const{startx:s,starty:r,width:a,height:o}=n.collision;this.image.body.setSize(a,o),this.image.body.setOffset(s,r),this.lightXOffset=8,this.lightYOffset=-15,this.fireImage=t.add.image(e+this.lightXOffset,i+this.lightYOffset,"flame").setOrigin(0,0).setDepth(i-1),this.light=t.lightManager.addLight(e+this.lightXOffset+20,i+this.lightYOffset+20,150,16777215,.9),this.fireImage.tint=16742144,this.frame=0,this.frameTime=0}update(t,e){super.update(t,e),this.frameTime+=e,this.frameTime>=75&&(this.frameTime=0,this.frame=(this.frame+1)%25,this.fireImage.setFrame(this.frame)),this.fireImage.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){super.setPosition(t,e),this.fireImage.setPosition(t+this.lightXOffset,e+this.lightYOffset),this.fireImage.setDepth(e-1),this.light.x=t+this.lightXOffset+20,this.light.y=e+this.lightYOffset+20}destroy(){this.fireImage.body&&this.scene.physics.world.disableBody(this.fireImage.body),this.fireImage.destroy(),this.scene.lightManager.removeLightObj(this.light),super.destroy()}}class Mft extends yft{static texture="props";static types=[{name:"empty_h",uvStartPx:{u:224,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"empty_v",uvStartPx:{u:261,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"apple_h",uvStartPx:{u:224,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"apple_v",uvStartPx:{u:261,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"lemom_h",uvStartPx:{u:288,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"lemon_v",uvStartPx:{u:325,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"pear_h",uvStartPx:{u:288,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"pear_v",uvStartPx:{u:325,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"fish_h",uvStartPx:{u:352,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"fish_v",uvStartPx:{u:389,v:222},widthPx:25,heightPx:34,zoffset:10,collision:{startx:0,starty:11,width:23,height:23}},{name:"carrot_h",uvStartPx:{u:351,v:291},widthPx:36,heightPx:29,zoffset:4,collision:{startx:0,starty:19,width:33,height:10}},{name:"carrot_v",uvStartPx:{u:389,v:284},widthPx:25,heightPx:36,zoffset:10,collision:{startx:0,starty:13,width:23,height:23}},{name:"cabbage_h",uvStartPx:{u:415,v:290},widthPx:35,heightPx:30,zoffset:4,collision:{startx:0,starty:20,width:32,height:10}},{name:"cabbage_v",uvStartPx:{u:453,v:285},widthPx:25,heightPx:35,zoffset:10,collision:{startx:0,starty:12,width:23,height:23}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Mft.types.length),r=Mft.types[s];super(t,e,i,Mft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Rft extends yft{static texture="props";static types=[{name:"bench_1_h",uvStartPx:{u:537,v:920},widthPx:82,heightPx:40,zoffset:10,collision:{startx:0,starty:10,width:77,height:30}},{name:"bench_1_v_1",uvStartPx:{u:544,v:974},widthPx:34,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_1_v_2",uvStartPx:{u:608,v:974},widthPx:35,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_2_h_1",uvStartPx:{u:742,v:1030},widthPx:84,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:81,height:10}},{name:"bench_2_h_2",uvStartPx:{u:835,v:1030},widthPx:61,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:58,height:10}},{name:"bench_2_v_1",uvStartPx:{u:712,v:1053},widthPx:19,heightPx:67,zoffset:10,collision:{startx:0,starty:17,width:17,height:50}},{name:"bench_2_v_2",uvStartPx:{u:744,v:1070},widthPx:19,heightPx:50,zoffset:10,collision:{startx:0,starty:10,width:17,height:40}},{name:"table_1_h",uvStartPx:{u:551,v:1075},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_1_v",uvStartPx:{u:652,v:1045},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}},{name:"table_2_h",uvStartPx:{u:551,v:1139},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_2_v",uvStartPx:{u:652,v:1141},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Rft.types.length),r=Rft.types[s];super(t,e,i,Rft.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}const Lft=500;class Oft{static objects=[{name:"Campfire",category:"props",create:(t,e,i,n)=>new Pft(t,e,i),id:"campfire",getType:()=>Pft.types?.[0],getTexture:()=>Pft.texture},{name:"House 1",category:"building",create:(t,e,i,n)=>new Aft(t,e,i),id:"house_1",getType:()=>Aft.type,getTexture:()=>Aft.texture},{name:"Tree Birch 0",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,0),id:"tree_0",getType:()=>xft.types?.[0],getTexture:()=>xft.texture},{name:"Tree Birch 1",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,1),id:"tree_1",getType:()=>xft.types?.[1],getTexture:()=>xft.texture},{name:"Tree Birch 2",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,2),id:"tree_2",getType:()=>xft.types?.[2],getTexture:()=>xft.texture},{name:"Tree Birch 3",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,3),id:"tree_3",getType:()=>xft.types?.[3],getTexture:()=>xft.texture},{name:"Tree Birch 4",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,4),id:"tree_4",getType:()=>xft.types?.[4],getTexture:()=>xft.texture},{name:"Autumn Tree Birch 0",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,5),id:"tree_5",getType:()=>xft.types?.[5],getTexture:()=>xft.texture},{name:"Autumn Tree Birch 1",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,6),id:"tree_6",getType:()=>xft.types?.[6],getTexture:()=>xft.texture},{name:"Autumn Tree Birch 2",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,7),id:"tree_7",getType:()=>xft.types?.[7],getTexture:()=>xft.texture},{name:"Autumn Tree Birch 3",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,8),id:"tree_8",getType:()=>xft.types?.[8],getTexture:()=>xft.texture},{name:"Autumn Tree Birch 4",category:"plants",create:(t,e,i,n)=>new xft(t,e,i,9),id:"tree_9",getType:()=>xft.types?.[9],getTexture:()=>xft.texture},{name:"Rock 0",category:"props",create:(t,e,i,n)=>new wft(t,e,i,0),id:"rock_0",getType:()=>wft.types?.[0],getTexture:()=>wft.texture},{name:"Rock 1",category:"props",create:(t,e,i,n)=>new wft(t,e,i,1),id:"rock_1",getType:()=>wft.types?.[1],getTexture:()=>wft.texture},{name:"Rock 2",category:"props",create:(t,e,i,n)=>new wft(t,e,i,2),id:"rock_2",getType:()=>wft.types?.[2],getTexture:()=>wft.texture},{name:"Rock 3",category:"props",create:(t,e,i,n)=>new wft(t,e,i,3),id:"rock_3",getType:()=>wft.types?.[3],getTexture:()=>wft.texture},{name:"Rock 4",category:"props",create:(t,e,i,n)=>new wft(t,e,i,4),id:"rock_4",getType:()=>wft.types?.[4],getTexture:()=>wft.texture},{name:"Rock 5",category:"props",create:(t,e,i,n)=>new wft(t,e,i,5),id:"rock_5",getType:()=>wft.types?.[5],getTexture:()=>wft.texture},{name:"Rock 6",category:"props",create:(t,e,i,n)=>new wft(t,e,i,6),id:"rock_6",getType:()=>wft.types?.[6],getTexture:()=>wft.texture},{name:"Rock 7",category:"props",create:(t,e,i,n)=>new wft(t,e,i,7),id:"rock_7",getType:()=>wft.types?.[7],getTexture:()=>wft.texture},{name:"Rock 8",category:"props",create:(t,e,i,n)=>new wft(t,e,i,8),id:"rock_8",getType:()=>wft.types?.[8],getTexture:()=>wft.texture},{name:"Rock 9",category:"props",create:(t,e,i,n)=>new wft(t,e,i,9),id:"rock_9",getType:()=>wft.types?.[9],getTexture:()=>wft.texture},{name:"Rock 10",category:"props",create:(t,e,i,n)=>new wft(t,e,i,10),id:"rock_10",getType:()=>wft.types?.[10],getTexture:()=>wft.texture},{name:"Rock 11",category:"props",create:(t,e,i,n)=>new wft(t,e,i,11),id:"rock_11",getType:()=>wft.types?.[11],getTexture:()=>wft.texture},{name:"Rock 12",category:"props",create:(t,e,i,n)=>new wft(t,e,i,12),id:"rock_12",getType:()=>wft.types?.[12],getTexture:()=>wft.texture},{name:"Rock 13",category:"props",create:(t,e,i,n)=>new wft(t,e,i,13),id:"rock_13",getType:()=>wft.types?.[13],getTexture:()=>wft.texture},{name:"Rock 14",category:"props",create:(t,e,i,n)=>new wft(t,e,i,14),id:"rock_14",getType:()=>wft.types?.[14],getTexture:()=>wft.texture},{name:"Rock 15",category:"props",create:(t,e,i,n)=>new wft(t,e,i,15),id:"rock_15",getType:()=>wft.types?.[15],getTexture:()=>wft.texture},{name:"Rock 16",category:"props",create:(t,e,i,n)=>new wft(t,e,i,16),id:"rock_16",getType:()=>wft.types?.[16],getTexture:()=>wft.texture},{name:"WoodBox Large",category:"props",create:(t,e,i,n)=>new bft(t,e,i,0),id:"woodbox_0",getType:()=>bft.types?.[0],getTexture:()=>bft.texture},{name:"WoodBox Small",category:"props",create:(t,e,i,n)=>new bft(t,e,i,1),id:"woodbox_1",getType:()=>bft.types?.[1],getTexture:()=>bft.texture},{name:"Covered WoodBox Large",category:"props",create:(t,e,i,n)=>new bft(t,e,i,2),id:"woodbox_2",getType:()=>bft.types?.[2],getTexture:()=>bft.texture},{name:"Covered WoodBox Small",category:"props",create:(t,e,i,n)=>new bft(t,e,i,3),id:"woodbox_3",getType:()=>bft.types?.[3],getTexture:()=>bft.texture},{name:"Empty Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,0),id:"crate_0",getType:()=>Mft.types?.[0],getTexture:()=>Mft.texture},{name:"Empty Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,1),id:"crate_1",getType:()=>Mft.types?.[1],getTexture:()=>Mft.texture},{name:"Apple Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,2),id:"crate_2",getType:()=>Mft.types?.[2],getTexture:()=>Mft.texture},{name:"Apple Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,3),id:"crate_3",getType:()=>Mft.types?.[3],getTexture:()=>Mft.texture},{name:"Lemon Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,4),id:"crate_4",getType:()=>Mft.types?.[4],getTexture:()=>Mft.texture},{name:"Lemon Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,5),id:"crate_5",getType:()=>Mft.types?.[5],getTexture:()=>Mft.texture},{name:"Pear Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,6),id:"crate_6",getType:()=>Mft.types?.[6],getTexture:()=>Mft.texture},{name:"Pear Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,7),id:"crate_7",getType:()=>Mft.types?.[7],getTexture:()=>Mft.texture},{name:"Fish Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,8),id:"crate_8",getType:()=>Mft.types?.[8],getTexture:()=>Mft.texture},{name:"Fish Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,9),id:"crate_9",getType:()=>Mft.types?.[9],getTexture:()=>Mft.texture},{name:"Carrot Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,10),id:"crate_10",getType:()=>Mft.types?.[10],getTexture:()=>Mft.texture},{name:"Carrot Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,11),id:"crate_11",getType:()=>Mft.types?.[11],getTexture:()=>Mft.texture},{name:"Cabbage Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,12),id:"crate_12",getType:()=>Mft.types?.[12],getTexture:()=>Mft.texture},{name:"Cabbage Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new Mft(t,e,i,13),id:"crate_13",getType:()=>Mft.types?.[13],getTexture:()=>Mft.texture},{name:"Lamp",category:"props",create:(t,e,i,n)=>new Sft(t,e,i,n),id:"lamp",getType:()=>Sft.type,getTexture:()=>Sft.texture},{name:"Road Lamp Left",category:"props",create:(t,e,i,n)=>new Eft(t,e,i,0),id:"roadlamp_left",getType:()=>Eft.types?.[0],getTexture:()=>Eft.texture},{name:"Road Lamp Right",category:"props",create:(t,e,i,n)=>new Eft(t,e,i,1),id:"roadlamp_right",getType:()=>Eft.types?.[1],getTexture:()=>Eft.texture},{name:"Autumn Bush 0",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,0),id:"bush_0",getType:()=>_ft.types?.[0],getTexture:()=>_ft.texture},{name:"Autumn Bush 1",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,1),id:"bush_1",getType:()=>_ft.types?.[1],getTexture:()=>_ft.texture},{name:"Autumn Bush 2",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,2),id:"bush_2",getType:()=>_ft.types?.[2],getTexture:()=>_ft.texture},{name:"Autumn Bush 3",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,3),id:"bush_3",getType:()=>_ft.types?.[3],getTexture:()=>_ft.texture},{name:"Autumn Bush 4",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,4),id:"bush_4",getType:()=>_ft.types?.[4],getTexture:()=>_ft.texture},{name:"Autumn Bush 5",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,5),id:"bush_5",getType:()=>_ft.types?.[5],getTexture:()=>_ft.texture},{name:"Autumn Bush 6",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,6),id:"bush_6",getType:()=>_ft.types?.[6],getTexture:()=>_ft.texture},{name:"Bush 0",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,7),id:"bush_7",getType:()=>_ft.types?.[7],getTexture:()=>_ft.texture},{name:"Bush 1",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,8),id:"bush_8",getType:()=>_ft.types?.[8],getTexture:()=>_ft.texture},{name:"Bush 2",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,9),id:"bush_9",getType:()=>_ft.types?.[9],getTexture:()=>_ft.texture},{name:"Bush 3",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,10),id:"bush_10",getType:()=>_ft.types?.[10],getTexture:()=>_ft.texture},{name:"Bush 4",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,11),id:"bush_11",getType:()=>_ft.types?.[11],getTexture:()=>_ft.texture},{name:"Bush 5",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,12),id:"bush_12",getType:()=>_ft.types?.[12],getTexture:()=>_ft.texture},{name:"Bush 6",category:"plants",create:(t,e,i,n)=>new _ft(t,e,i,13),id:"bush_13",getType:()=>_ft.types?.[13],getTexture:()=>_ft.texture},{name:"Large Cabbage",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,0),id:"morenature_0",getType:()=>Cft.types?.[0],getTexture:()=>Cft.texture},{name:"Medium Cabbage",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,1),id:"morenature_1",getType:()=>Cft.types?.[1],getTexture:()=>Cft.texture},{name:"Small Cabbage",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,2),id:"morenature_2",getType:()=>Cft.types?.[2],getTexture:()=>Cft.texture},{name:"Large Pumpkin",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,3),id:"morenature_3",getType:()=>Cft.types?.[3],getTexture:()=>Cft.texture},{name:"Medium Pumpkin",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,4),id:"morenature_4",getType:()=>Cft.types?.[4],getTexture:()=>Cft.texture},{name:"Small Pumpkin",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,5),id:"morenature_5",getType:()=>Cft.types?.[5],getTexture:()=>Cft.texture},{name:"Large Carrot",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,6),id:"morenature_6",getType:()=>Cft.types?.[6],getTexture:()=>Cft.texture},{name:"Medium Carrot",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,7),id:"morenature_7",getType:()=>Cft.types?.[7],getTexture:()=>Cft.texture},{name:"Small Carrot",category:"plants",create:(t,e,i,n)=>new Cft(t,e,i,8),id:"morenature_8",getType:()=>Cft.types?.[8],getTexture:()=>Cft.texture},{name:"Barrel",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,0),id:"barrel_0",getType:()=>Tft.types?.[0],getTexture:()=>Tft.texture},{name:"Barrel Without Cap",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,1),id:"barrel_1",getType:()=>Tft.types?.[1],getTexture:()=>Tft.texture},{name:"Barrel With Water",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,2),id:"barrel_2",getType:()=>Tft.types?.[2],getTexture:()=>Tft.texture},{name:"Barrel With Plants",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,3),id:"barrel_3",getType:()=>Tft.types?.[3],getTexture:()=>Tft.texture},{name:"Barrel With Props",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,4),id:"barrel_4",getType:()=>Tft.types?.[4],getTexture:()=>Tft.texture},{name:"Barrel Sided",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,5),id:"barrel_5",getType:()=>Tft.types?.[5],getTexture:()=>Tft.texture},{name:"Barrel Pile",category:"props",create:(t,e,i,n)=>new Tft(t,e,i,6),id:"barrel_6",getType:()=>Tft.types?.[6],getTexture:()=>Tft.texture},{name:"Bench 1 Horizontal",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,0),id:"outdoor_0",getType:()=>Rft.types?.[0],getTexture:()=>Rft.texture},{name:"Bench 1 Vertical 1",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,1),id:"outdoor_1",getType:()=>Rft.types?.[1],getTexture:()=>Rft.texture},{name:"Bench 1 Vertical 2",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,2),id:"outdoor_2",getType:()=>Rft.types?.[2],getTexture:()=>Rft.texture},{name:"Bench 2 Horizontal Large",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,3),id:"outdoor_3",getType:()=>Rft.types?.[3],getTexture:()=>Rft.texture},{name:"Bench 2 Horizontal Small",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,4),id:"outdoor_4",getType:()=>Rft.types?.[4],getTexture:()=>Rft.texture},{name:"Bench 2 Vertical Large",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,5),id:"outdoor_5",getType:()=>Rft.types?.[5],getTexture:()=>Rft.texture},{name:"Bench 2 Vertical Small",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,6),id:"outdoor_6",getType:()=>Rft.types?.[6],getTexture:()=>Rft.texture},{name:"Table 1 Horizontal",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,7),id:"outdoor_7",getType:()=>Rft.types?.[7],getTexture:()=>Rft.texture},{name:"Table 1 Vertical",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,8),id:"outdoor_8",getType:()=>Rft.types?.[8],getTexture:()=>Rft.texture},{name:"Table 2 Horizontal",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,9),id:"outdoor_9",getType:()=>Rft.types?.[9],getTexture:()=>Rft.texture},{name:"Table 2 Vertical",category:"props",create:(t,e,i,n)=>new Rft(t,e,i,10),id:"outdoor_10",getType:()=>Rft.types?.[10],getTexture:()=>Rft.texture}];constructor(t,e=[]){this.scene=t,this.list=e,this.allElementsByChunk=new Map,this.loadedChunks=new Set,this.serverIdIndex=new Map,this.playerChunk=null}loadJsonMap(t=[]){this.allElementsByChunk.clear(),t.forEach(t=>{if("number"!=typeof t.x||"number"!=typeof t.y||!t.id)return;const e=`${Math.floor(t.x/Lft)}:${Math.floor(t.y/Lft)}`;this.allElementsByChunk.has(e)||this.allElementsByChunk.set(e,[]),this.allElementsByChunk.get(e).push(t)}),this.playerChunk=null}_chunkKey(t,e){return`${t}:${e}`}create(t,e,i,n,s={}){const r=Oft.objects.find(e=>e.id===t);if(!r)throw new Error(`Unknown object id: ${t}`);const a=r.create(e,i,n,s);return a.typeId=t,a.typeOptions=s,a.serverId=s.serverId,a.idBase||(a.idBase=`${t}_${Date.now()}_${Math.floor(1e4*Math.random())}`),this.list.push(a),a.serverId&&this.serverIdIndex.set(a.serverId,a),a}exportElements(){return this.list.map(t=>({x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId}}))}exportElement(t){return{x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId}}}destroy(t){try{const e=this.list.findIndex(e=>e.idBase===t.idBase);if(e>-1){const t=this.list[e];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(e,1),t.serverId&&this.serverIdIndex.delete(t.serverId)}}catch(t){}}destroyByServerId(t){try{const e=this.list.findIndex(e=>e.serverId==t);if(e>-1){const t=this.list[e];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(e,1),t.serverId&&this.serverIdIndex.delete(t.serverId)}}catch(t){}}moveByServerId(t,e,i){try{const n=this.list.findIndex(e=>e.serverId==t);if(n>-1){this.list[n].setPosition(e,i)}}catch(t){}}destroyAll(){if(0===this.list.length)return;[...this.list].forEach(t=>this.destroy(t))}loadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(this.loadedChunks.has(i))return 0;const n=this.allElementsByChunk.get(i)||[],s=[];return n.forEach(t=>{try{if(t.options&&t.options.serverId&&this.serverIdIndex.has(t.options.serverId))return;const e=this.create(t.id,this.scene,t.x,t.y,t.options||{});s.push(e)}catch(t){}}),this.loadedChunks.add(i),s.length}unloadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(!this.loadedChunks.has(i))return 0;const n=t*Lft,s=(t+1)*Lft,r=e*Lft,a=(e+1)*Lft,o=this.list.filter(t=>t.x>=n&&t.x<s&&t.y>=r&&t.y<a);return o.forEach(t=>this.destroy(t)),this.loadedChunks.delete(i),o.length}_updateChunks(){const t=this.scene?.player?.sprite;if(!t||"number"!=typeof t.x||"number"!=typeof t.y)return;const e=Math.floor(t.x/Lft),i=Math.floor(t.y/Lft),n=`${e}:${i}`;if(n===this.playerChunk)return;const s=new Set,r=Math.round(this.scene.getCameraInfo().maxSize/500);for(let t=-r;t<=r;t++)for(let n=-r;n<=r;n++)s.add(this._chunkKey(e+t,i+n));for(const t of s)if(!this.loadedChunks.has(t)){const[e,i]=t.split(":").map(Number);this.loadChunkByCoords(e,i)}for(const t of Array.from(this.loadedChunks))if(!s.has(t)){const[e,i]=t.split(":").map(Number);this.unloadChunkByCoords(e,i)}this.playerChunk=n}update(t,e,i){this._updateChunks();const n=this.scene.cameras.main.worldView,s=new Ldt.Geom.Rectangle(n.x-64,n.y-64,n.width+128,n.height+128);this.list.forEach(t=>{if(!t)return;const n=t.image||t.sprite||t;if(!n||!n.getBounds)return;const r=Ldt.Geom.Intersects.RectangleToRectangle(s,n.getBounds());if("function"==typeof n.setVisible&&n.setVisible(r),n.body&&void 0!==n.body.enable&&(n.body.enable=r),t.active=r,r&&"function"==typeof t.update)try{t.update(e,i)}catch(t){}})}loadChunk({cx:t,cy:e}){return this.loadChunkByCoords(t,e)}unloadChunk({cx:t,cy:e}){return this.unloadChunkByCoords(t,e)}getChunkElements(t,e){return this.allElementsByChunk.get(this._chunkKey(t,e))||[]}}class Fft{static getTexture(t,e,i,n,s,r){const a=t.textures.get(e);if(!a)throw new Error(`Texture not found with id ${e}`);const o=document.createElement("canvas");o.width=s,o.height=r;return o.getContext("2d").drawImage(a.source[0].image,i,n,s,r,0,0,s,r),o.toDataURL()}}class Dft{constructor(t){this.scene=t,this.keys=t.input.keyboard.addKeys("W,A,S,D"),this.inputVector={x:0,y:0},this.lastJoystickValue=!0,this.joystickOptions={zone:document.getElementById("game-container"),mode:"dynamic",size:100,color:"black",fadeTime:120},this.categoryConfig={plants:{icon:"assets/icons/plant.png",description:"Trees, flowers, and natural things."},props:{icon:"assets/icons/fire.png",description:"Barrels, boxes, and more props."},building:{icon:"assets/icons/generalinfo.png",description:"Buildings, houses, and moee."}},this.inputVector={x:0,y:0},this._createJoystick(),this.optionsModal=new pft(document.getElementById("game-container"),this.scene),this.editorModal=new fft(document.getElementById("game-container"),"Editor",this.scene),this.peopleModal=new vft(document.getElementById("game-container"),this.scene),this.setupEditorModal(this.editorModal),this.hud=new dft(document.getElementById("game-container"),{components:[{type:hft,options:{scene:t,network:t.networkManager}},{type:lft,options:{scene:t}},{type:uft,options:{onZoomIn:()=>t.zoomIn(),onZoomOut:()=>t.zoomOut()}},{type:cft,options:{scene:t}}]})}_createJoystick(){this.joystick=nft(this.joystickOptions),this.moveHandler=(t,e)=>{this.inputVector.x=e.vector.x,this.inputVector.y=-e.vector.y},this.endHandler=()=>{this.inputVector.x=0,this.inputVector.y=0},this.joystick.on("move",this.moveHandler),this.joystick.on("end",this.endHandler)}setKeysStatus(t){t?this.scene.input.keyboard.enableGlobalCapture():this.scene.input.keyboard.disableGlobalCapture();for(const e in this.keys)this.keys[e]&&(this.keys[e].enabled=t)}joystickSetEnabled(t,e=!0){e&&(this.lastJoystickValue=t),t?this.joystick||this._createJoystick():(this.joystick&&(this.joystick.destroy(),this.joystick=null,document.querySelectorAll(".nipple")[0]?.remove()),this.inputVector.x=0,this.inputVector.y=0)}joystickModalEnable(t){1==t?this.joystickSetEnabled(!1,!1):this.joystickSetEnabled(this.lastJoystickValue,!1)}setupEditorModal(t){const e=this;t.body.innerHTML="";const i=document.createElement("div");i.className="categories-container";const n={};Oft.objects.forEach(t=>{const i=t.getType(),s=t.category;if(!n[s]){const t=this.categoryConfig[s]||{icon:"",description:"",color:"#999"};n[s]={config:t,items:[]}}n[s].items.push({...t,icon:Fft.getTexture(e.scene,t.getTexture(),i.uvStartPx.u,i.uvStartPx.v,i.widthPx,i.heightPx)})}),Object.entries(n).forEach(([n,s])=>{const{icon:r,description:a,color:o}=s.config,h=s.items.length,l=document.createElement("div");l.className="category-card",l.style.borderColor=o,l.innerHTML=`\n        <div class="category-header">\n          <div class="title">\n            <img src="${r}" class="category-icon">\n            <h2>${n}</h2>\n          </div>\n        </div>\n        <p>${a}</p>\n        <p><b>Items:</b> ${h}</p>\n        <button class="open-category-btn">Open Category</button>\n      `,l.querySelector("button").addEventListener("click",()=>{!function(n,{config:s,items:r}){t.body.innerHTML="";const a=document.createElement("div");a.className="category-header",a.innerHTML=`\n        <div class="title">\n          <img src="${s.icon}" class="category-icon">\n          <h2>${n}</h2>\n        </div>\n      `,t.body.appendChild(a);const o=document.createElement("div");o.className="object-list",r.forEach(t=>{const i=document.createElement("div");i.className="object-card",i.innerHTML=`\n          <div class="object-header">\n            <img src="${t.icon}">\n          </div>\n          <div class="object-footer">\n            <h3>${t.name}</h3>\n            <button></button>\n          </div>\n        `;const n=i.querySelector("button");n.textContent="Create",n.addEventListener("click",i=>{const n=function(t){let e="";for(let i=0;i<t;i++)e+=Math.floor(10*Math.random()).toString();return e}(64);e.scene.mapObjects.create(t.id,e.scene,e.scene.player.sprite.x+100,e.scene.player.sprite.y,{serverId:n}),e.scene.networkManager.emitCreateElement(e.scene.mapObjects.list[e.scene.mapObjects.list.findIndex(t=>t.serverId==n)])}),o.appendChild(i)}),t.body.appendChild(o);const h=document.createElement("button");h.className="back-to-categories-btn",h.textContent="Back",h.addEventListener("click",()=>{t.body.innerHTML="",t.body.appendChild(i)}),a.appendChild(h)}(n,s)}),i.appendChild(l)}),t.body.appendChild(i)}getDirection(){let t=0,e=0;return this.keys.A.isDown&&(t=-1),this.keys.D.isDown&&(t=1),this.keys.W.isDown&&(e=-1),this.keys.S.isDown&&(e=1),t||e?{x:t,y:e}:this.inputVector}}class Ift{constructor(t,e,i,n={}){this.scene=t,this.getX=e,this.getY=i,this._bubbles=[],this._bubblePaddingX=n.bubblePaddingX??6,this._bubblePaddingY=n.bubblePaddingY??4,this._bubbleSeparation=n.bubbleSeparation??4,this._bubbleDuration=n.bubbleDuration??5e3,this._bubbleMaxWidth=n.bubbleMaxWidth??200,this._bubbleLimit=n.bubbleLimit??5,this.bubblePosFPlayer=n.bubblePosFPlayer??40,this._delayedCalls=new Set,this._typingBubble=null,this._typingTween=null,this._typingDelayedCall=null}say(t,e=!1,i=void 0){if(!t)return;const n="number"==typeof i&&i>=0?i:this._bubbleDuration;if(this._bubbles.length>=this._bubbleLimit){const t=this._bubbles.shift();if(t&&(t.container&&this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:150,onComplete:()=>{t.container.destroyed||t.container.destroy()}}),t._delayedCall&&!t._delayedCall.hasDispatched))try{t._delayedCall.remove(!1)}catch(t){}this._updateBubbleStack()}const s={fontFamily:"Hawk",fontSize:"16px",color:e?"yellow":"#aaaaaa"},r=this.scene.add.text(0,0,t,s).setDepth(10000001);r.setOrigin(0,0),r.setPadding(0),r.setWordWrapWidth(this._bubbleMaxWidth,!0);const a=r.getBounds(),o=Math.ceil(a.width),h=Math.ceil(a.height),l=o+2*this._bubblePaddingX,u=h+2*this._bubblePaddingY,c=this.scene.add.container(0,0).setDepth(10000002),d=this.scene.add.graphics();d.fillStyle(0,.6);d.fillRoundedRect(0,0,l,u,6);const f=this.scene.add.text(this._bubblePaddingX,this._bubblePaddingY,t,s).setDepth(10000003);f.setOrigin(0,0),f.setWordWrapWidth(this._bubbleMaxWidth,!0);const p=this.scene.add.graphics();p.fillStyle(0,.6),c.add([d,f,p]);const g=this._bubbles.length,v=Math.round(this.getX()),m=Math.round(this.getY()),y=Math.round(v-Math.floor(l/2)),x=Math.round(m-this.bubblePosFPlayer-(u+this._bubbleSeparation)*g-u);c.x=Math.floor(y),c.y=Math.floor(x);const w={container:c,bg:d,text:f,cloud:p,width:l,height:u,createdAt:Date.now(),_delayedCall:null};this._bubbles.push(w),this._updateBubbleStack(),r.destroy(),this._clampBubbleToCameraAndPoint(w);const b=this.scene.time.delayedCall(n,()=>{this._removeBubble(w),this._delayedCalls.delete(b)});return w._delayedCall=b,this._delayedCalls.add(b),w}setTyping(t,e=void 0){if(t){if(this._typingBubble){if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if("number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return}const t={fontFamily:"Hawk",fontSize:"16px",color:"#aaaaaa"},i="...",n=this.scene.add.text(0,0,i,t).setDepth(10000001);n.setOrigin(0,0),n.setPadding(0),n.setWordWrapWidth(this._bubbleMaxWidth,!0);const s=n.getBounds(),r=Math.ceil(s.width),a=Math.ceil(s.height);n.destroy();const o=r+2*this._bubblePaddingX,h=a+2*this._bubblePaddingY,l=this.scene.add.container(0,0).setDepth(10000010),u=this.scene.add.graphics();u.fillStyle(0,.6);const c=6;u.fillRoundedRect(0,0,o,h,c);const d=this._bubblePaddingX,f=this._bubblePaddingY,p=3,g=(o-2*this._bubblePaddingX)/(p+1),v=()=>{const t=Math.floor(170+86*Math.random()).toString(16).padStart(2,"0");return`#${t}${t}${t}`},m=[];for(let e=0;e<p;e++){const i=v(),n=this.scene.add.text(0,0,".",{fontFamily:"Hawk",fontSize:t.fontSize,color:i}).setDepth(10000011+e);n.setOrigin(.5,.5);const s=(d+g)*(e+1),r=f+Math.floor(a/2);n.x=s,n.y=r,n.setScale(1,1),n.setAlpha(1),l.add(n),m.push({text:n})}const y=this.scene.add.graphics();y.fillStyle(0,.6),l.add([u,y]),l.sendToBack(u);const x=Math.round(this.getX()),w=Math.round(this.getY()),b=Math.round(x-Math.floor(o/2)),T=Math.round(w-this.bubblePosFPlayer-h);l.x=Math.floor(b),l.y=Math.floor(T);const S={container:l,bg:u,dots:m,cloud:y,width:o,height:h};this._typingBubble=S,this._clampBubbleToCameraAndPoint(S);const E=[],_=500;for(let t=0;t<m.length;t++){const e=m[t],i=this.scene.tweens.add({targets:e.text,alpha:{from:.4,to:1},ease:"Sine.easeInOut",duration:_,yoyo:!0,repeat:-1,delay:t*(_/3)});E.push(i)}if(this._typingTween={tweens:E},"number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return void this._updateBubbleStack()}{if(!this._typingBubble)return;if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if(this._typingTween&&Array.isArray(this._typingTween.tweens)){for(const t of this._typingTween.tweens)try{t.remove(!1)}catch(t){}this._typingTween=null}const t=this._typingBubble;try{this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:120,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}})}catch(e){t.container&&!t.container.destroyed&&t.container.destroy()}return this._typingBubble=null,void this._updateBubbleStack()}}_clampBubbleToCameraAndPoint(t){if(!this.scene.cameras||!this.scene.cameras.main)return;const e=this.scene.cameras.main,i=e.worldView.x,n=e.worldView.y,s=e.worldView.x+e.worldView.width,r=e.worldView.y+e.worldView.height;let a=t.container.x;a<i+4&&(a=Math.floor(i+4)),a+t.width>s-4&&(a=Math.floor(s-t.width-4)),t.container.x=a;let o=t.container.y;o<n+4&&(o=Math.floor(n+4)),o+t.height>r-4&&(o=Math.floor(r-t.height-4)),t.container.y=o,this._drawCloudForBubble(t)}_drawCloudForBubble(t){if(!t.cloud)return;const e=t.cloud;e.clear(),e.fillStyle(0,.6);const i=t.container.x;let n=Math.round(this.getX())-i;n=Math.max(6,Math.min(t.width-6,n));const s=this._typingBubble===t,r=t.container.y+t.height<=this.getY()-8,a=r?t.height:-6,o=r?t.height+6:0,h=Math.floor(n-Math.floor(3)),l=Math.floor(n+Math.ceil(3));if(e.beginPath(),e.moveTo(h,a),e.lineTo(l,a),e.lineTo(n,o),e.closePath(),e.fillPath(),s)e.setVisible(!0);else{const e=this._bubbles.length?this._bubbles[this._bubbles.length-1]:null;e&&e.cloud&&e.cloud.setVisible(e===t)}}_repositionBubbles(){if(this._typingBubble){const t=this._typingBubble,e=Math.round(this.getX()),i=Math.round(this.getY()),n=Math.round(e-Math.floor(t.width/2)),s=Math.round(i-this.bubblePosFPlayer-t.height);t.container.x=Math.floor(n),t.container.y=Math.floor(s),this._clampBubbleToCameraAndPoint(t)}if(!this._bubbles.length)return;const t=Math.round(this.getX()),e=Math.round(this.getY());for(let i=0;i<this._bubbles.length;i++){const n=this._bubbles[i],s=n.width,r=n.height,a=i,o=this._typingBubble?1:0,h=Math.round(t-Math.floor(s/2)),l=Math.round(e-this.bubblePosFPlayer-(r+this._bubbleSeparation)*(this._bubbles.length-1-a+o)-r);n.container.x=Math.floor(h),n.container.y=Math.floor(l),this._clampBubbleToCameraAndPoint(n)}}_updateBubbleStack(){this._typingBubble&&(this._typingBubble.container.setDepth(10000020),this._typingBubble.cloud&&this._typingBubble.cloud.setVisible(!0));for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t],i=10000002;e.container.setDepth(i+t),e.cloud&&e.cloud.setVisible(!this._typingBubble&&t===this._bubbles.length-1)}this._repositionBubbles()}_removeBubble(t){const e=this._bubbles.indexOf(t);if(-1!==e){if(t._delayedCall){try{t._delayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(t._delayedCall),t._delayedCall=null}this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:200,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}}),this._bubbles.splice(e,1),this._updateBubbleStack()}}destroy(){for(const t of this._delayedCalls)try{t.remove(!1)}catch(t){}if(this._delayedCalls.clear(),this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._typingDelayedCall=null}if(this._typingTween){try{this._typingTween.remove(!1)}catch(t){}this._typingTween=null}if(this._typingBubble&&this._typingBubble.container&&!this._typingBubble.container.destroyed){try{this._typingBubble.container.destroy()}catch(t){}this._typingBubble=null}for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t];if(e&&e._delayedCall){try{e._delayedCall.remove(!1)}catch(t){}e._delayedCall=null}if(e&&e.container&&!e.container.destroyed)try{this.scene.tweens.add({targets:[e.container],alpha:{from:1,to:0},duration:100,onComplete:()=>{e.container&&!e.container.destroyed&&e.container.destroy()}})}catch(t){e.container&&!e.container.destroyed&&e.container.destroy()}}this._bubbles=[],this.scene=null,this.getX=null,this.getY=null}update(){this._repositionBubbles()}}class kft{constructor(t,e,i,n,s,r,a,o){this.id=e,this.scene=t,this.display_name=s,this.username=n,this.avatar=o,this.uuid=i;const h="avatar-"+i;if(this.sprite=t.add.image(r,a,"wah"),t.physics.add.existing(this.sprite),this.sprite.body.setCollideWorldBounds(!0),this.sprite.body.setSize(32,16).setOffset(0,16),this.sprite.body.debugShowBody=!1,this.sprite.body.roundPixels=!0,o){const t=new Image;t.onload=()=>{this.scene.textures.exists(h)&&this.scene.textures.remove(h),this.scene.textures.addImage(h,t),this.sprite.setTexture(h)},t.onerror=t=>{console.error("Error loading custom avatar",t)},t.src=o}this.nameText=t.add.text(Math.floor(r-16),Math.floor(a-32),s||"",{fontFamily:"Hawk",fontSize:"16px",color:"#ffffff"}).setDepth(10248),this._positionTween=null,this._smoothDuration=100,this.chat=new Ift(t,()=>this.sprite.x,()=>this.sprite.y,{bubblePaddingX:6,bubblePaddingY:4,bubbleSeparation:4,bubbleDuration:5e3,bubbleMaxWidth:200,bubbleLimit:5,bubblePosFPlayer:s&&""!=s?40:24})}update(){this.chat.update()}updateMovement(t){this.sprite.body.setVelocity(Math.floor(200*t.x),Math.floor(200*t.y)),this.nameText.setPosition(Math.floor(this.sprite.x-Math.floor(this.sprite.width/2)),Math.floor(this.sprite.y-30)),this.sprite.setDepth(this.sprite.y+16)}setPosition(t,e,i=!1){this._positionTween&&(this._positionTween.stop(),this._positionTween=null);const n=i?this._smoothDuration:0;if(!n)return this.sprite.setPosition(t,e),this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-25)),this.sprite.body&&this.sprite.body.reset(t,e),void this.chat.update();this._positionTween=this.scene.tweens.add({targets:[this.sprite,this.nameText],props:{x:{value:t,ease:"Linear"},y:{value:t=>t===this.nameText?e-20:e,ease:"Linear"}},duration:n,onUpdate:()=>{this.sprite.x=Math.round(this.sprite.x),this.sprite.y=Math.round(this.sprite.y),this.nameText.x=Math.round(this.nameText.x),this.nameText.y=Math.round(this.nameText.y),this.chat.update()},onComplete:()=>{this.sprite.setPosition(t,e),this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-20)),this.sprite.body&&this.sprite.body.reset(t,e),this._positionTween=null,this.chat.update()}})}setSmoothDuration(t){this._smoothDuration=Math.max(0,0|t)}say(t,e){return this.chat.say(t,e,function(t){const e=t.replace(/\s/g,"").length;return Math.min(12e4,Math.max(1e3,500*e))}(t))}destroy(){if(this._positionTween){try{this._positionTween.stop()}catch(t){}this._positionTween=null}if(this.chat){try{this.chat.destroy()}catch(t){}this.chat=null}if(this.sprite){try{this.sprite.destroy()}catch(t){}this.sprite=null}if(this.nameText){try{this.nameText.destroy()}catch(t){}this.nameText=null}this.scene=null}}var Bft,Nft,zft;try{Bft=new TextDecoder}catch(t){}var Uft,Yft,Xft,Gft,Wft,Hft=0,Vft={},jft=0,qft=0,Kft=[],Zft={useRecords:!1,mapsAsObjects:!0};class Jft{}const $ft=new Jft;$ft.name="MessagePack 0xC1";var Qft=!1,tpt=2;try{new Function("")}catch(t){tpt=1/0}class ept{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,e){if(Nft)return Rpt(()=>(Lpt(),this?this.unpack(t,e):ept.prototype.unpack.call(Zft,t,e)));t.buffer||t.constructor!==ArrayBuffer||(t="undefined"!=typeof Buffer?Buffer.from(t):new Uint8Array(t)),"object"==typeof e?(zft=e.end||t.length,Hft=e.start||0):(Hft=0,zft=e>-1?e:t.length),qft=0,Yft=null,Xft=null,Nft=t;try{Wft=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(Nft=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof ept){if(Vft=this,this.structures)return Uft=this.structures,ipt(e);(!Uft||Uft.length>0)&&(Uft=[])}else Vft=Zft,(!Uft||Uft.length>0)&&(Uft=[]);return ipt(e)}unpackMultiple(t,e){let i,n=0;try{Qft=!0;let s=t.length,r=this?this.unpack(t,s):Fpt.unpack(t,s);if(!e){for(i=[r];Hft<s;)n=Hft,i.push(ipt());return i}if(!1===e(r,n,Hft))return;for(;Hft<s;)if(n=Hft,!1===e(ipt(),n,Hft))return}catch(t){throw t.lastPosition=n,t.values=i,t}finally{Qft=!1,Lpt()}}_mergeStructures(t,e){t=t||[],Object.isFrozen(t)&&(t=t.map(t=>t.slice(0)));for(let e=0,i=t.length;e<i;e++){let i=t[e];i&&(i.isShared=!0,e>=32&&(i.highByte=e-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let n=t[i],s=e[i];s&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[i]=n),t[i]=s)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function ipt(t){try{if(!Vft.trusted&&!Qft){let t=Uft.sharedLength||0;t<Uft.length&&(Uft.length=t)}let t;if(Vft.randomAccessStructure&&Nft[Hft]<64&&Nft[Hft],t=spt(),Xft&&(Hft=Xft.postBundlePosition,Xft=null),Qft&&(Uft.restoreStructures=null),Hft==zft)Uft&&Uft.restoreStructures&&npt(),Uft=null,Nft=null,Gft&&(Gft=null);else{if(Hft>zft)throw new Error("Unexpected end of MessagePack data");if(!Qft){let e;try{e=JSON.stringify(t,(t,e)=>"bigint"==typeof e?`${e}n`:e).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(t){throw Uft&&Uft.restoreStructures&&npt(),Lpt(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||Hft>zft)&&(t.incomplete=!0),t}}function npt(){for(let t in Uft.restoreStructures)Uft[t]=Uft.restoreStructures[t];Uft.restoreStructures=null}function spt(){let t=Nft[Hft++];if(t<160){if(t<128){if(t<64)return t;{let e=Uft[63&t]||Vft.getStructures&&hpt()[63&t];return e?(e.read||(e.read=apt(e,63&t)),e.read()):t}}if(t<144){if(t-=128,Vft.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=Spt();"__proto__"===t&&(t="__proto_"),e[t]=spt()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(spt(),spt());return e}}{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=spt();return Vft.freezeData?Object.freeze(e):e}}if(t<192){let e=t-160;if(qft>=Hft)return Yft.slice(Hft-jft,(Hft+=e)-jft);if(0==qft&&zft<140){let t=e<16?ypt(e):mpt(e);if(null!=t)return t}return lpt(e)}{let e;switch(t){case 192:return null;case 193:return Xft?(e=spt(),e>0?Xft[1].slice(Xft.position1,Xft.position1+=e):Xft[0].slice(Xft.position0,Xft.position0-=e)):$ft;case 194:return!1;case 195:return!0;case 196:if(e=Nft[Hft++],void 0===e)throw new Error("Unexpected end of buffer");return wpt(e);case 197:return e=Wft.getUint16(Hft),Hft+=2,wpt(e);case 198:return e=Wft.getUint32(Hft),Hft+=4,wpt(e);case 199:return bpt(Nft[Hft++]);case 200:return e=Wft.getUint16(Hft),Hft+=2,bpt(e);case 201:return e=Wft.getUint32(Hft),Hft+=4,bpt(e);case 202:if(e=Wft.getFloat32(Hft),Vft.useFloat32>2){let t=Opt[(127&Nft[Hft])<<1|Nft[Hft+1]>>7];return Hft+=4,(t*e+(e>0?.5:-.5)|0)/t}return Hft+=4,e;case 203:return e=Wft.getFloat64(Hft),Hft+=8,e;case 204:return Nft[Hft++];case 205:return e=Wft.getUint16(Hft),Hft+=2,e;case 206:return e=Wft.getUint32(Hft),Hft+=4,e;case 207:return"number"===Vft.int64AsType?(e=4294967296*Wft.getUint32(Hft),e+=Wft.getUint32(Hft+4)):"string"===Vft.int64AsType?e=Wft.getBigUint64(Hft).toString():"auto"===Vft.int64AsType?(e=Wft.getBigUint64(Hft),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Wft.getBigUint64(Hft),Hft+=8,e;case 208:return Wft.getInt8(Hft++);case 209:return e=Wft.getInt16(Hft),Hft+=2,e;case 210:return e=Wft.getInt32(Hft),Hft+=4,e;case 211:return"number"===Vft.int64AsType?(e=4294967296*Wft.getInt32(Hft),e+=Wft.getUint32(Hft+4)):"string"===Vft.int64AsType?e=Wft.getBigInt64(Hft).toString():"auto"===Vft.int64AsType?(e=Wft.getBigInt64(Hft),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Wft.getBigInt64(Hft),Hft+=8,e;case 212:if(e=Nft[Hft++],114==e)return _pt(63&Nft[Hft++]);{let t=Kft[e];if(t)return t.read?(Hft++,t.read(spt())):t.noBuffer?(Hft++,t()):t(Nft.subarray(Hft,++Hft));throw new Error("Unknown extension "+e)}case 213:return e=Nft[Hft],114==e?(Hft++,_pt(63&Nft[Hft++],Nft[Hft++])):bpt(2);case 214:return bpt(4);case 215:return bpt(8);case 216:return bpt(16);case 217:return e=Nft[Hft++],qft>=Hft?Yft.slice(Hft-jft,(Hft+=e)-jft):upt(e);case 218:return e=Wft.getUint16(Hft),qft>=(Hft+=2)?Yft.slice(Hft-jft,(Hft+=e)-jft):cpt(e);case 219:return e=Wft.getUint32(Hft),qft>=(Hft+=4)?Yft.slice(Hft-jft,(Hft+=e)-jft):dpt(e);case 220:return e=Wft.getUint16(Hft),Hft+=2,ppt(e);case 221:return e=Wft.getUint32(Hft),Hft+=4,ppt(e);case 222:return e=Wft.getUint16(Hft),Hft+=2,gpt(e);case 223:return e=Wft.getUint32(Hft),Hft+=4,gpt(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const rpt=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function apt(t,e){function i(){if(i.count++>tpt){let i=t.read=new Function("r","return function(){return "+(Vft.freezeData?"Object.freeze":"")+"({"+t.map(t=>"__proto__"===t?"__proto_:r()":rpt.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()").join(",")+"})}")(spt);return 0===t.highByte&&(t.read=opt(e,t.read)),i()}let n={};for(let e=0,i=t.length;e<i;e++){let i=t[e];"__proto__"===i&&(i="__proto_"),n[i]=spt()}return Vft.freezeData?Object.freeze(n):n}return i.count=0,0===t.highByte?opt(e,i):i}const opt=(t,e)=>function(){let i=Nft[Hft++];if(0===i)return e();let n=t<32?-(t+(i<<5)):t+(i<<5),s=Uft[n]||hpt()[n];if(!s)throw new Error("Record id is not defined for "+n);return s.read||(s.read=apt(s,t)),s.read()};function hpt(){let t=Rpt(()=>(Nft=null,Vft.getStructures()));return Uft=Vft._mergeStructures(t,Uft)}var lpt=fpt,upt=fpt,cpt=fpt,dpt=fpt;function fpt(t){let e;if(t<16&&(e=ypt(t)))return e;if(t>64&&Bft)return Bft.decode(Nft.subarray(Hft,Hft+=t));const i=Hft+t,n=[];for(e="";Hft<i;){const t=Nft[Hft++];if(128&t)if(192==(224&t)){const e=63&Nft[Hft++];n.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&Nft[Hft++],i=63&Nft[Hft++];n.push((31&t)<<12|e<<6|i)}else if(240==(248&t)){let e=(7&t)<<18|(63&Nft[Hft++])<<12|(63&Nft[Hft++])<<6|63&Nft[Hft++];e>65535&&(e-=65536,n.push(e>>>10&1023|55296),e=56320|1023&e),n.push(e)}else n.push(t);else n.push(t);n.length>=4096&&(e+=vpt.apply(String,n),n.length=0)}return n.length>0&&(e+=vpt.apply(String,n)),e}function ppt(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=spt();return Vft.freezeData?Object.freeze(e):e}function gpt(t){if(Vft.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=Spt();"__proto__"===t&&(t="__proto_"),e[t]=spt()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(spt(),spt());return e}}var vpt=String.fromCharCode;function mpt(t){let e=Hft,i=new Array(t);for(let n=0;n<t;n++){const t=Nft[Hft++];if((128&t)>0)return void(Hft=e);i[n]=t}return vpt.apply(String,i)}function ypt(t){if(t<4){if(t<2){if(0===t)return"";{let t=Nft[Hft++];return(128&t)>1?void(Hft-=1):vpt(t)}}{let e=Nft[Hft++],i=Nft[Hft++];if((128&e)>0||(128&i)>0)return void(Hft-=2);if(t<3)return vpt(e,i);let n=Nft[Hft++];return(128&n)>0?void(Hft-=3):vpt(e,i,n)}}{let e=Nft[Hft++],i=Nft[Hft++],n=Nft[Hft++],s=Nft[Hft++];if((128&e)>0||(128&i)>0||(128&n)>0||(128&s)>0)return void(Hft-=4);if(t<6){if(4===t)return vpt(e,i,n,s);{let t=Nft[Hft++];return(128&t)>0?void(Hft-=5):vpt(e,i,n,s,t)}}if(t<8){let r=Nft[Hft++],a=Nft[Hft++];if((128&r)>0||(128&a)>0)return void(Hft-=6);if(t<7)return vpt(e,i,n,s,r,a);let o=Nft[Hft++];return(128&o)>0?void(Hft-=7):vpt(e,i,n,s,r,a,o)}{let r=Nft[Hft++],a=Nft[Hft++],o=Nft[Hft++],h=Nft[Hft++];if((128&r)>0||(128&a)>0||(128&o)>0||(128&h)>0)return void(Hft-=8);if(t<10){if(8===t)return vpt(e,i,n,s,r,a,o,h);{let t=Nft[Hft++];return(128&t)>0?void(Hft-=9):vpt(e,i,n,s,r,a,o,h,t)}}if(t<12){let l=Nft[Hft++],u=Nft[Hft++];if((128&l)>0||(128&u)>0)return void(Hft-=10);if(t<11)return vpt(e,i,n,s,r,a,o,h,l,u);let c=Nft[Hft++];return(128&c)>0?void(Hft-=11):vpt(e,i,n,s,r,a,o,h,l,u,c)}{let l=Nft[Hft++],u=Nft[Hft++],c=Nft[Hft++],d=Nft[Hft++];if((128&l)>0||(128&u)>0||(128&c)>0||(128&d)>0)return void(Hft-=12);if(t<14){if(12===t)return vpt(e,i,n,s,r,a,o,h,l,u,c,d);{let t=Nft[Hft++];return(128&t)>0?void(Hft-=13):vpt(e,i,n,s,r,a,o,h,l,u,c,d,t)}}{let f=Nft[Hft++],p=Nft[Hft++];if((128&f)>0||(128&p)>0)return void(Hft-=14);if(t<15)return vpt(e,i,n,s,r,a,o,h,l,u,c,d,f,p);let g=Nft[Hft++];return(128&g)>0?void(Hft-=15):vpt(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g)}}}}}function xpt(){let t,e=Nft[Hft++];if(e<192)t=e-160;else switch(e){case 217:t=Nft[Hft++];break;case 218:t=Wft.getUint16(Hft),Hft+=2;break;case 219:t=Wft.getUint32(Hft),Hft+=4;break;default:throw new Error("Expected string")}return fpt(t)}function wpt(t){return Vft.copyBuffers?Uint8Array.prototype.slice.call(Nft,Hft,Hft+=t):Nft.subarray(Hft,Hft+=t)}function bpt(t){let e=Nft[Hft++];if(Kft[e]){let i;return Kft[e](Nft.subarray(Hft,i=Hft+=t),t=>{Hft=t;try{return spt()}finally{Hft=i}})}throw new Error("Unknown extension type "+e)}var Tpt=new Array(4096);function Spt(){let t=Nft[Hft++];if(!(t>=160&&t<192))return Hft--,Ept(spt());if(t-=160,qft>=Hft)return Yft.slice(Hft-jft,(Hft+=t)-jft);if(!(0==qft&&zft<180))return lpt(t);let e,i=4095&(t<<5^(t>1?Wft.getUint16(Hft):t>0?Nft[Hft]:0)),n=Tpt[i],s=Hft,r=Hft+t-3,a=0;if(n&&n.bytes==t){for(;s<r;){if(e=Wft.getUint32(s),e!=n[a++]){s=1879048192;break}s+=4}for(r+=3;s<r;)if(e=Nft[s++],e!=n[a++]){s=1879048192;break}if(s===r)return Hft=s,n.string;r-=3,s=Hft}for(n=[],Tpt[i]=n,n.bytes=t;s<r;)e=Wft.getUint32(s),n.push(e),s+=4;for(r+=3;s<r;)e=Nft[s++],n.push(e);let o=t<16?ypt(t):mpt(t);return n.string=null!=o?o:lpt(t)}function Ept(t){if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t.toString();if(null==t)return t+"";if(Vft.allowArraysInMapKeys&&Array.isArray(t)&&t.flat().every(t=>["string","number","boolean","bigint"].includes(typeof t)))return t.flat().toString();throw new Error("Invalid property type for record: "+typeof t)}const _pt=(t,e)=>{let i=spt().map(Ept),n=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let s=Uft[t];return s&&(s.isShared||Qft)&&((Uft.restoreStructures||(Uft.restoreStructures=[]))[t]=s),Uft[t]=i,i.read=apt(i,n),i.read()};Kft[0]=()=>{},Kft[0].noBuffer=!0,Kft[66]=t=>{let e=t.byteLength%8||8,i=BigInt(128&t[0]?t[0]-256:t[0]);for(let n=1;n<e;n++)i<<=BigInt(8),i+=BigInt(t[n]);if(t.byteLength!==e){let n=new DataView(t.buffer,t.byteOffset,t.byteLength),s=(t,e)=>{let i=e-t;if(i<=40){let i=n.getBigUint64(t);for(let s=t+8;s<e;s+=8)i<<=BigInt(64n),i|=n.getBigUint64(s);return i}let r=t+(i>>4<<3),a=s(t,r),o=s(r,e);return a<<BigInt(8*(e-r))|o};i=i<<BigInt(8*(n.byteLength-e))|s(e,n.byteLength)}return i};let Cpt={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,AggregateError:"function"==typeof AggregateError?AggregateError:null};Kft[101]=()=>{let t=spt();if(!Cpt[t[0]]){let e=Error(t[1],{cause:t[2]});return e.name=t[0],e}return Cpt[t[0]](t[1],{cause:t[2]})},Kft[105]=t=>{if(!1===Vft.structuredClone)throw new Error("Structured clone extension is disabled");let e=Wft.getUint32(Hft-4);Gft||(Gft=new Map);let i,n=Nft[Hft];i=n>=144&&n<160||220==n||221==n?[]:n>=128&&n<144||222==n||223==n?new Map:(n>=199&&n<=201||n>=212&&n<=216)&&115===Nft[Hft+1]?new Set:{};let s={target:i};Gft.set(e,s);let r=spt();if(!s.used)return s.target=r;if(Object.assign(i,r),i instanceof Map)for(let[t,e]of r.entries())i.set(t,e);if(i instanceof Set)for(let t of Array.from(r))i.add(t);return i},Kft[112]=t=>{if(!1===Vft.structuredClone)throw new Error("Structured clone extension is disabled");let e=Wft.getUint32(Hft-4),i=Gft.get(e);return i.used=!0,i.target},Kft[115]=()=>new Set(spt());const Apt=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let Ppt="object"==typeof globalThis?globalThis:window;Kft[116]=t=>{let e=t[0],i=Uint8Array.prototype.slice.call(t,1).buffer,n=Apt[e];if(!n){if(16===e)return i;if(17===e)return new DataView(i);throw new Error("Could not find typed array for code "+e)}return new Ppt[n](i)},Kft[120]=()=>{let t=spt();return new RegExp(t[0],t[1])};const Mpt=[];function Rpt(t){let e=zft,i=Hft,n=jft,s=qft,r=Yft,a=Gft,o=Xft,h=new Uint8Array(Nft.slice(0,zft)),l=Uft,u=Uft.slice(0,Uft.length),c=Vft,d=Qft,f=t();return zft=e,Hft=i,jft=n,qft=s,Yft=r,Gft=a,Xft=o,Nft=h,Qft=d,(Uft=l).splice(0,Uft.length,...u),Vft=c,Wft=new DataView(Nft.buffer,Nft.byteOffset,Nft.byteLength),f}function Lpt(){Nft=null,Gft=null,Uft=null}Kft[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=Hft;return Hft+=e-t.length,Xft=Mpt,(Xft=[xpt(),xpt()]).position0=0,Xft.position1=0,Xft.postBundlePosition=Hft,Hft=i,spt()},Kft[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const Opt=new Array(147);for(let t=0;t<256;t++)Opt[t]=+("1e"+Math.floor(45.15-.30103*t));var Fpt=new ept({useRecords:!1});const Dpt=Fpt.unpack;Fpt.unpackMultiple,Fpt.unpack;let Ipt,kpt,Bpt,Npt=new Float32Array(1);new Uint8Array(Npt.buffer,0,4);try{Ipt=new TextEncoder}catch(t){}const zpt="undefined"!=typeof Buffer,Upt=zpt?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,Ypt=zpt?Buffer:Uint8Array,Xpt=zpt?4294967296:2144337920;let Gpt,Wpt,Hpt,Vpt,jpt=0,qpt=null;const Kpt=/[\u0080-\uFFFF]/,Zpt=Symbol("record-id");function Jpt(t,e,i,n){let s=t.byteLength;if(s+1<256){var{target:r,position:a}=i(4+s);r[a++]=199,r[a++]=s+1}else if(s+1<65536){var{target:r,position:a}=i(5+s);r[a++]=200,r[a++]=s+1>>8,r[a++]=s+1&255}else{var{target:r,position:a,targetView:o}=i(7+s);r[a++]=201,o.setUint32(a,s+1),a+=4}r[a++]=116,r[a++]=e,t.buffer||(t=new Uint8Array(t)),r.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function $pt(t,e){let i=t.byteLength;var n,s;if(i<256){var{target:n,position:s}=e(i+2);n[s++]=196,n[s++]=i}else if(i<65536){var{target:n,position:s}=e(i+3);n[s++]=197,n[s++]=i>>8,n[s++]=255&i}else{var{target:n,position:s,targetView:r}=e(i+5);n[s++]=198,r.setUint32(s,i),s+=4}n.set(t,s)}function Qpt(t,e,i,n){let s=t.length;switch(s){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:s<256?(e[i++]=199,e[i++]=s):s<65536?(e[i++]=200,e[i++]=s>>8,e[i++]=255&s):(e[i++]=201,e[i++]=s>>24,e[i++]=s>>16&255,e[i++]=s>>8&255,e[i++]=255&s)}return e[i++]=n,e.set(t,i),i+=s}function tgt(t,e,i){if(qpt.length>0){Hpt.setUint32(qpt.position+t,jpt+i-qpt.position-t),qpt.stringsPosition=jpt-t;let n=qpt;qpt=null,e(n[0]),e(n[1])}}Bpt=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,Jft],kpt=[{pack(t,e,i){let n=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296){let{target:t,targetView:i,position:s}=e(6);t[s++]=214,t[s++]=255,i.setUint32(s,n)}else if(n>0&&n<4294967296){let{target:i,targetView:s,position:r}=e(10);i[r++]=215,i[r++]=255,s.setUint32(r,4e6*t.getMilliseconds()+(n/1e3/4294967296|0)),s.setUint32(r+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:t,targetView:n,position:s}=e(3);t[s++]=212,t[s++]=255,t[s++]=255}else{let{target:i,targetView:s,position:r}=e(15);i[r++]=199,i[r++]=12,i[r++]=255,s.setUint32(r,1e6*t.getMilliseconds()),s.setBigInt64(r+4,BigInt(Math.floor(n)))}}},{pack(t,e,i){if(this.setAsEmptyObject)return e(0),i({});let n=Array.from(t),{target:s,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(s[r++]=212,s[r++]=115,s[r++]=0),i(n)}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=101,n[s++]=0),i([t.name,t.message,t.cause])}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=120,n[s++]=0),i([t.source,t.flags])}},{pack(t,e){this.moreTypes?Jpt(t,16,e):$pt(zpt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==Ypt&&this.moreTypes?Jpt(t,Apt.indexOf(i.name),e):$pt(t,e)}},{pack(t,e){this.moreTypes?Jpt(t,17,e):$pt(zpt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let{target:i,position:n}=e(1);i[n]=193}}];let egt=new class extends ept{constructor(t){let e,i,n,s;super(t),this.offset=0;let r=Ypt.prototype.utf8Write?function(t,e){return Gpt.utf8Write(t,e,Gpt.byteLength-e)}:!(!Ipt||!Ipt.encodeInto)&&function(t,e){return Ipt.encodeInto(t,Gpt.subarray(e)).written},a=this;t||(t={});let o=t&&t.sequential,h=t.structures||t.saveStructures,l=t.maxSharedStructures;if(null==l&&(l=h?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(this.moreTypes=!0);let u=t.maxOwnStructures;null==u&&(u=h?32:64),this.structures||0==t.useRecords||(this.structures=[]);let c=l>32||u+l>64,d=l+64,f=l+u+64;if(f>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let p=[],g=0,v=0;this.pack=this.encode=function(t,r){if(Gpt||(Gpt=new Upt(8192),Hpt=Gpt.dataView||(Gpt.dataView=new DataView(Gpt.buffer,0,8192)),jpt=0),Vpt=Gpt.length-10,Vpt-jpt<2048?(Gpt=new Upt(Gpt.length),Hpt=Gpt.dataView||(Gpt.dataView=new DataView(Gpt.buffer,0,Gpt.length)),Vpt=Gpt.length-10,jpt=0):jpt=jpt+7&2147483640,e=jpt,r&rgt&&(jpt+=255&r),s=a.structuredClone?new Map:null,a.bundleStrings&&"string"!=typeof t?(qpt=[],qpt.size=1/0):qpt=null,n=a.structures,n){n.uninitialized&&(n=a._mergeStructures(a.getStructures()));let t=n.sharedLength||0;if(t>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let e=0;e<t;e++){let t=n[e];if(!t)continue;let i,s=n.transitions;for(let e=0,n=t.length;e<n;e++){let n=t[e];i=s[n],i||(i=s[n]=Object.create(null)),s=i}s[Zpt]=e+64}this.lastNamedStructuresLength=t}o||(n.nextId=t+64)}let h;i&&(i=!1);try{a.randomAccessStructure&&t&&t.constructor&&t.constructor===Object?A(t):x(t);let i=qpt;if(qpt&&tgt(e,x,0),s&&s.idsToInsert){let t=s.idsToInsert.sort((t,e)=>t.offset>e.offset?1:-1),n=t.length,r=-1;for(;i&&n>0;){let s=t[--n].offset+e;s<i.stringsPosition+e&&-1===r&&(r=0),s>i.position+e?r>=0&&(r+=6):(r>=0&&(Hpt.setUint32(i.position+e,Hpt.getUint32(i.position+e)+r),r=-1),i=i.previous,n++)}r>=0&&i&&Hpt.setUint32(i.position+e,Hpt.getUint32(i.position+e)+r),jpt+=6*t.length,jpt>Vpt&&E(jpt),a.offset=jpt;let o=function(t,e){let i,n=6*e.length,s=t.length-n;for(;i=e.pop();){let e=i.offset,r=i.id;t.copyWithin(e+n,e,s),n-=6;let a=e+n;t[a++]=214,t[a++]=105,t[a++]=r>>24,t[a++]=r>>16&255,t[a++]=r>>8&255,t[a++]=255&r,s=e}return t}(Gpt.subarray(e,jpt),t);return s=null,o}return a.offset=jpt,r&ngt?(Gpt.start=e,Gpt.end=jpt,Gpt):Gpt.subarray(e,jpt)}catch(t){throw h=t,t}finally{if(n&&(m(),i&&a.saveStructures)){let i=n.sharedLength||0,s=Gpt.subarray(e,jpt),o=function(t,e){return t.isCompatible=t=>{let i=!t||(e.lastNamedStructuresLength||0)===t.length;return i||e._mergeStructures(t),i},t}(n,a);if(!h)return!1===a.saveStructures(o,o.isCompatible)?a.pack(t,r):(a.lastNamedStructuresLength=i,Gpt.length>1073741824&&(Gpt=null),s)}Gpt.length>1073741824&&(Gpt=null),r&sgt&&(jpt=e)}};const m=()=>{v<10&&v++;let t=n.sharedLength||0;if(n.length>t&&!o&&(n.length=t),g>1e4)n.transitions=null,v=0,g=0,p.length>0&&(p=[]);else if(p.length>0&&!o){for(let t=0,e=p.length;t<e;t++)p[t][Zpt]=0;p=[]}},y=t=>{var e=t.length;e<16?Gpt[jpt++]=144|e:e<65536?(Gpt[jpt++]=220,Gpt[jpt++]=e>>8,Gpt[jpt++]=255&e):(Gpt[jpt++]=221,Hpt.setUint32(jpt,e),jpt+=4);for(let i=0;i<e;i++)x(t[i])},x=t=>{jpt>Vpt&&(Gpt=E(jpt));var i,n=typeof t;if("string"===n){let n,s=t.length;if(qpt&&s>=4&&s<4096){if((qpt.size+=s)>21760){let t,i,n=(qpt[0]?3*qpt[0].length+qpt[1].length:0)+10;jpt+n>Vpt&&(Gpt=E(jpt+n)),qpt.position?(i=qpt,Gpt[jpt]=200,jpt+=3,Gpt[jpt++]=98,t=jpt-e,jpt+=4,tgt(e,x,0),Hpt.setUint16(t+e-3,jpt-e-t)):(Gpt[jpt++]=214,Gpt[jpt++]=98,t=jpt-e,jpt+=4),qpt=["",""],qpt.previous=i,qpt.size=0,qpt.position=t}let i=Kpt.test(t);return qpt[i?0:1]+=t,Gpt[jpt++]=193,void x(i?-s:s)}n=s<32?1:s<256?2:s<65536?3:5;let a=3*s;if(jpt+a>Vpt&&(Gpt=E(jpt+a)),s<64||!r){let e,r,a,o=jpt+n;for(e=0;e<s;e++)r=t.charCodeAt(e),r<128?Gpt[o++]=r:r<2048?(Gpt[o++]=r>>6|192,Gpt[o++]=63&r|128):55296==(64512&r)&&56320==(64512&(a=t.charCodeAt(e+1)))?(r=65536+((1023&r)<<10)+(1023&a),e++,Gpt[o++]=r>>18|240,Gpt[o++]=r>>12&63|128,Gpt[o++]=r>>6&63|128,Gpt[o++]=63&r|128):(Gpt[o++]=r>>12|224,Gpt[o++]=r>>6&63|128,Gpt[o++]=63&r|128);i=o-jpt-n}else i=r(t,jpt+n);i<32?Gpt[jpt++]=160|i:i<256?(n<2&&Gpt.copyWithin(jpt+2,jpt+1,jpt+1+i),Gpt[jpt++]=217,Gpt[jpt++]=i):i<65536?(n<3&&Gpt.copyWithin(jpt+3,jpt+2,jpt+2+i),Gpt[jpt++]=218,Gpt[jpt++]=i>>8,Gpt[jpt++]=255&i):(n<5&&Gpt.copyWithin(jpt+5,jpt+3,jpt+3+i),Gpt[jpt++]=219,Hpt.setUint32(jpt,i),jpt+=4),jpt+=i}else if("number"===n)if(t>>>0===t)t<32||t<128&&!1===this.useRecords||t<64&&!this.randomAccessStructure?Gpt[jpt++]=t:t<256?(Gpt[jpt++]=204,Gpt[jpt++]=t):t<65536?(Gpt[jpt++]=205,Gpt[jpt++]=t>>8,Gpt[jpt++]=255&t):(Gpt[jpt++]=206,Hpt.setUint32(jpt,t),jpt+=4);else if((t|0)===t)t>=-32?Gpt[jpt++]=256+t:t>=-128?(Gpt[jpt++]=208,Gpt[jpt++]=t+256):t>=-32768?(Gpt[jpt++]=209,Hpt.setInt16(jpt,t),jpt+=2):(Gpt[jpt++]=210,Hpt.setInt32(jpt,t),jpt+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let i;if(Gpt[jpt++]=202,Hpt.setFloat32(jpt,t),e<4||((i=t*Opt[(127&Gpt[jpt])<<1|Gpt[jpt+1]>>7])|0)===i)return void(jpt+=4);jpt--}Gpt[jpt++]=203,Hpt.setFloat64(jpt,t),jpt+=8}else if("object"===n||"function"===n)if(t){if(s){let i=s.get(t);if(i){if(!i.id){let t=s.idsToInsert||(s.idsToInsert=[]);i.id=t.push(i)}return Gpt[jpt++]=214,Gpt[jpt++]=112,Hpt.setUint32(jpt,i.id),void(jpt+=4)}s.set(t,{offset:jpt-e})}let r=t.constructor;if(r===Object)S(t);else if(r===Array)y(t);else if(r===Map)if(this.mapAsEmptyObject)Gpt[jpt++]=128;else{(i=t.size)<16?Gpt[jpt++]=128|i:i<65536?(Gpt[jpt++]=222,Gpt[jpt++]=i>>8,Gpt[jpt++]=255&i):(Gpt[jpt++]=223,Hpt.setUint32(jpt,i),jpt+=4);for(let[e,i]of t)x(e),x(i)}else{for(let e=0,i=kpt.length;e<i;e++){if(t instanceof Bpt[e]){let i=kpt[e];if(i.write){i.type&&(Gpt[jpt++]=212,Gpt[jpt++]=i.type,Gpt[jpt++]=0);let e=i.write.call(this,t);return void(e===t?Array.isArray(t)?y(t):S(t):x(e))}let n,s=Gpt,r=Hpt,a=jpt;Gpt=null;try{n=i.pack.call(this,t,t=>(Gpt=s,s=null,jpt+=t,jpt>Vpt&&E(jpt),{target:Gpt,targetView:Hpt,position:jpt-t}),x)}finally{s&&(Gpt=s,Hpt=r,jpt=a,Vpt=Gpt.length-10)}return void(n&&(n.length+jpt>Vpt&&E(n.length+jpt),jpt=Qpt(n,Gpt,jpt,i.type)))}}if(Array.isArray(t))y(t);else{if(t.toJSON){const e=t.toJSON();if(e!==t)return x(e)}if("function"===n)return x(this.writeFunction&&this.writeFunction(t));S(t)}}}else Gpt[jpt++]=192;else if("boolean"===n)Gpt[jpt++]=t?195:194;else if("bigint"===n){if(t<0x8000000000000000&&t>=-0x8000000000000000)Gpt[jpt++]=211,Hpt.setBigInt64(jpt,t);else if(t<0x10000000000000000&&t>0)Gpt[jpt++]=207,Hpt.setBigUint64(jpt,t);else{if(!this.largeBigIntToFloat){if(this.largeBigIntToString)return x(t.toString());if(this.useBigIntExtension||this.moreTypes){let e,i=t<0?BigInt(-1):BigInt(0);if(t>>BigInt(65536)===i){let n=BigInt(0x10000000000000000)-BigInt(1),s=[];for(;s.push(t&n),t>>BigInt(63)!==i;)t>>=BigInt(64);e=new Uint8Array(new BigUint64Array(s).buffer),e.reverse()}else{let i=t<0,n=(i?~t:t).toString(16);if(n.length%2?n="0"+n:parseInt(n.charAt(0),16)>=8&&(n="00"+n),zpt)e=Buffer.from(n,"hex");else{e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=parseInt(n.slice(2*t,2*t+2),16)}if(i)for(let t=0;t<e.length;t++)e[t]=~e[t]}return e.length+jpt>Vpt&&E(e.length+jpt),void(jpt=Qpt(e,Gpt,jpt,66))}throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}Gpt[jpt++]=203,Hpt.setFloat64(jpt,Number(t))}jpt+=8}else{if("undefined"!==n)throw new Error("Unknown type: "+n);this.encodeUndefinedAsNil?Gpt[jpt++]=192:(Gpt[jpt++]=212,Gpt[jpt++]=0,Gpt[jpt++]=0)}},w=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?t=>{let e;if(this.skipValues){e=[];for(let i in t)"function"==typeof t.hasOwnProperty&&!t.hasOwnProperty(i)||this.skipValues.includes(t[i])||e.push(i)}else e=Object.keys(t);let i,n=e.length;if(n<16?Gpt[jpt++]=128|n:n<65536?(Gpt[jpt++]=222,Gpt[jpt++]=n>>8,Gpt[jpt++]=255&n):(Gpt[jpt++]=223,Hpt.setUint32(jpt,n),jpt+=4),this.coercibleKeyAsNumber)for(let s=0;s<n;s++){i=e[s];let n=Number(i);x(isNaN(n)?i:n),x(t[i])}else for(let s=0;s<n;s++)x(i=e[s]),x(t[i])}:t=>{Gpt[jpt++]=222;let i=jpt-e;jpt+=2;let n=0;for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(x(e),x(t[e]),n++);if(n>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');Gpt[i+++e]=n>>8,Gpt[i+e]=255&n},b=!1===this.useRecords?w:t.progressiveRecords&&!c?t=>{let i,s,r=n.transitions||(n.transitions=Object.create(null)),a=jpt++-e;for(let o in t)if("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(o)){if(i=r[o],i)r=i;else{let h=Object.keys(t),l=r;r=n.transitions;let u=0;for(let t=0,e=h.length;t<e;t++){let e=h[t];i=r[e],i||(i=r[e]=Object.create(null),u++),r=i}a+e+1==jpt?(jpt--,_(r,h,u)):C(r,h,a,u),s=!0,r=l[o]}x(t[o])}if(!s){let i=r[Zpt];i?Gpt[a+e]=i:C(r,Object.keys(t),a,0)}}:t=>{let e,i=n.transitions||(n.transitions=Object.create(null)),s=0;for(let n in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(n))&&(e=i[n],e||(e=i[n]=Object.create(null),s++),i=e);let r=i[Zpt];r?r>=96&&c?(Gpt[jpt++]=96+(31&(r-=96)),Gpt[jpt++]=r>>5):Gpt[jpt++]=r:_(i,i.__keys__||Object.keys(t),s);for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&x(t[e])},T="function"==typeof this.useRecords&&this.useRecords,S=T?t=>{T(t)?b(t):w(t)}:b,E=t=>{let i;if(t>16777216){if(t-e>Xpt)throw new Error("Packed buffer would be larger than maximum buffer size");i=Math.min(Xpt,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else i=1+(Math.max(t-e<<2,Gpt.length-1)>>12)<<12;let n=new Upt(i);return Hpt=n.dataView||(n.dataView=new DataView(n.buffer,0,i)),t=Math.min(t,Gpt.length),Gpt.copy?Gpt.copy(n,0,e,t):n.set(Gpt.slice(e,t)),jpt-=e,e=0,Vpt=n.length-10,Gpt=n},_=(t,e,s)=>{let r=n.nextId;r||(r=64),r<d&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(r=n.nextOwnId,r<f||(r=d),n.nextOwnId=r+1):(r>=f&&(r=d),n.nextId=r+1);let a=e.highByte=r>=96&&c?r-96>>5:-1;t[Zpt]=r,t.__keys__=e,n[r-64]=e,r<d?(e.isShared=!0,n.sharedLength=r-63,i=!0,a>=0?(Gpt[jpt++]=96+(31&r),Gpt[jpt++]=a):Gpt[jpt++]=r):(a>=0?(Gpt[jpt++]=213,Gpt[jpt++]=114,Gpt[jpt++]=96+(31&r),Gpt[jpt++]=a):(Gpt[jpt++]=212,Gpt[jpt++]=114,Gpt[jpt++]=r),s&&(g+=v*s),p.length>=u&&(p.shift()[Zpt]=0),p.push(t),x(e))},C=(t,i,n,s)=>{let r=Gpt,a=jpt,o=Vpt,h=e;Gpt=Wpt,jpt=0,e=0,Gpt||(Wpt=Gpt=new Upt(8192)),Vpt=Gpt.length-10,_(t,i,s),Wpt=Gpt;let l=jpt;if(Gpt=r,jpt=a,Vpt=o,e=h,l>1){let t=jpt+l-1;t>Vpt&&E(t);let i=n+e;Gpt.copyWithin(i+l,i+1,jpt),Gpt.set(Wpt.slice(0,l),i),jpt=t}else Gpt[n+e]=Wpt[0]},A=t=>{let s=undefined(t,Gpt,e,jpt,n,E,(t,e,n)=>{if(n)return i=!0;jpt=e;let s=Gpt;return x(t),m(),s!==Gpt?{position:jpt,targetView:Hpt,target:Gpt}:jpt},this);if(0===s)return S(t);jpt=s}}useBuffer(t){Gpt=t,Gpt.dataView||(Gpt.dataView=new DataView(Gpt.buffer,Gpt.byteOffset,Gpt.byteLength)),Hpt=Gpt.dataView,jpt=0}set position(t){jpt=t}get position(){return jpt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}({useRecords:!1});const igt=egt.pack;egt.pack;const ngt=512,sgt=1024,rgt=2048;class agt{constructor(t){this.scene=t,this.players={},this.ws=null,this.connect(),this.last={type:null,data:null}}buildPath(t){return`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}${t}`}connect(){this.server=JSON.parse(localStorage.getItem("server")),this.ws=new WebSocket(this.server.path),this.ws.addEventListener("open",()=>{}),this.ws.addEventListener("message",async t=>{let e,i;try{i=await event.data.arrayBuffer(),e=Dpt(i)}catch(t){return}const{type:s,data:r}=e;switch(this.last={type:s,data:r},s){case"addPlayer":this.addPlayer(r);break;case"loggedIn":this.scene.connectingOverlay.remove(),this.scene.inputManager.hud.container.style.display="block",Object.values(r.players).forEach(t=>this.addPlayer(t)),this.scene.player=this.addPlayer(r.player),this.scene.physics.add.collider(this.scene.player.sprite,this.scene.collisionGroup),this.scene.cameras.main.startFollow(this.scene.player.sprite,!0,.1,.1,.5,.5),this.scene.cameras.main.roundPixels=!0;break;case"chatmessage":if(!this.players[r.id])return;this.players[r.id].say(r.message,r.isCommandResponse),this.scene.inputManager.hud.getComponent("chatbox").addMessage(r.user,r.message,r.isCommandResponse);break;case"localBubble":this.scene.player.say(r.message,r.isCommandResponse);break;case"playerMoved":if(!this.scene.player||r.id==this.scene.player.id)return;const t=this.players[r.id];t&&t.setPosition(r.x,r.y,!0);break;case"removePlayer":this.players[r]&&(this.players[r].destroy(),delete this.players[r]);break;case"time":this.scene.lightManager.timeSeconds=r.time;break;case"connected":this.send("login",{...n(),range:this.scene.getCameraInfo().maxSize});break;case"loginError":this.scene.errorModal.throwError(r.message);break;case"disconnect":this.scene.errorModal.throwError("Disconnected from server.");break;case"kick":this.scene.errorModal.throwError("You are kicked from this server.<br>"+r);break;case"typing":if(!this.players[r.id])return;this.players[r.id].chat.setTyping(r.status||!1);break;case"map":this.scene.mapObjects.loadJsonMap(r.map);break;case"createElement":this.scene.mapObjects.create(r.id,this.scene,r.x,r.y,r.options);break;case"deleteElement":this.scene.mapObjects.destroyByServerId(r.options?.serverId);break;case"moveElement":this.scene.mapObjects.moveByServerId(r.options?.serverId,r.x,r.y)}}),this.ws.addEventListener("close",()=>{this.scene.errorModal.throwError("Disconnected from server.")})}send(t,e){this.last={type:t,data:e};const i=igt({type:t,data:e});this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(i)}addPlayer({id:t,uuid:e,username:i,display_name:n,x:s,y:r,avatar:a}){return this.players[t]=new kft(this.scene,t,e,i,n,s,r,a)}emitChatMessage(t,e=!1){this.send("chat",{message:t,isCommandResponse:e})}emitExportElements(t){this.send("exportElements",t)}emitRange(t){this.send("camerarange",t)}emitMovement(t,e){this.send("playerMovement",{x:t,y:e})}emitCreateElement(t){this.send("createElement",this.scene.mapObjects.exportElement(t))}emitDeleteElement(t){this.send("deleteElement",this.scene.mapObjects.exportElement(t))}emitMoveElement(t){this.send("moveElement",this.scene.mapObjects.exportElement(t))}emitTyping(t){this.send("typing",{status:t})}}class ogt{constructor(t,e={}){this.scene=t,this.textString=e.text||"Connecting...",this.fontSize=e.fontSize||32,this.fontFamily=e.fontFamily||"Hawk",this.color=e.color||"#ffffff",this.depth="number"==typeof e.depth?e.depth:10248,this.container=null,this.visible=!1}_createElements(){if(this.container)return;const t=this.scene.scale.width,e=this.scene.scale.height,i=this.scene.add.rectangle(0,0,t,e,2236962).setOrigin(0,0),n={fontFamily:this.fontFamily,fontSize:`${this.fontSize}px`,color:this.color},s=Math.floor(t/2),r=Math.floor(e/2),a=this.scene.add.text(s,r,this.textString,n).setOrigin(.5,.5);this.container=this.scene.add.container(0,0,[i,a]).setDepth(this.depth).setVisible(!1),this._bg=i,this._text=a,this._tween=this.scene.tweens.add({targets:this._text,alpha:{from:1,to:.4},duration:700,yoyo:!0,repeat:-1,paused:!0}),this._resizeHandler=()=>{const t=this.scene.scale.width,e=this.scene.scale.height;this._bg.setSize(t,e),this._text.setPosition(Math.floor(t/2),Math.floor(e/2))},this.scene.scale&&this.scene.scale.on&&this.scene.scale.on("resize",this._resizeHandler)}show(){this._createElements(),this.container&&!this.visible&&(this.container.setVisible(!0),this._tween&&this._tween.play(),this.visible=!0)}remove(){this.container&&(this._tween&&(this._tween.stop(),this._tween=null),this.scene.scale&&this.scene.scale.off&&this._resizeHandler&&(this.scene.scale.off("resize",this._resizeHandler),this._resizeHandler=null),this.container.removeAll(!0),this.container.destroy(),this.container=null,this._bg=null,this._text=null,this.visible=!1)}}class hgt{constructor(t,e={}){this.scene=t,this.game=t.sys.game,this.totalMinutes=e.timeMinutes??24,this.totalSeconds=60*this.totalMinutes,this.running=e.startRunning??!0,this.timeSeconds=60*(e.startAtMinutes??12),this.nightColor=e.nightColor??132634,this.nightAlpha=e.nightAlpha??.7,this.totalMinutes,this.phasesMinutes=e.phasesMinutes??[{start:0,color:this.nightColor,alpha:this.nightAlpha},{start:4,color:this.nightColor,alpha:this.nightAlpha},{start:6,color:16777215,alpha:0},{start:16,color:16777215,alpha:0},{start:18,color:this.nightColor,alpha:this.nightAlpha},{start:20,color:this.nightColor,alpha:this.nightAlpha}],this.phases=this.phasesMinutes.slice().map((t,e)=>({start:Ldt.Math.Clamp(60*(t.start??0),0,this.totalSeconds),color:void 0!==t.color?t.color>>>0:void 0,alpha:void 0!==t.alpha?Ldt.Math.Clamp(t.alpha,0,1):void 0,index:e})).sort((t,e)=>t.start-e.start),this.lights=[],this._created=!1,this._rtKey="__light_manager_rt",this._rt=null,this._lightSprite=null,this._quad=null,this._camera=null,this._onResize=this._onResize.bind(this),this._lastPhase=null,this._phaseCallbacks=[],this._timeCallbacks=[],this.overlayEvaluator=e.overlayEvaluator??this._defaultOverlayEvaluator.bind(this)}create(t="lightRadial",e="imageMask"){if(this._created)return;const i=this.scene.cameras.main;this._camera=i;const n=i.width,s=i.height,r=`__light_manager_rt_${Date.now()}`;if(this.scene.textures.exists(this._rtKey))try{this.scene.textures.remove(this._rtKey)}catch(t){}this._rtKey=r,this._rt=this.scene.make.renderTexture({width:n,height:s,key:r}),this._quad=this.scene.add.image(0,0).setOrigin(0,0).setScrollFactor(0).setDepth(5e3),this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(r),this._quad.setDisplaySize(n,s),this.scene.textures.exists(t)||console.warn(`LightManager: radial texture "${t}" not found.`),this._lightSprite=this.scene.add.image(0,0,t).setVisible(!1).setOrigin(.5),this._maskKey=e,this.scene.scale.on("resize",this._onResize),this._created=!0}static _lerpColor(t,e,i){const n=Ldt.Display.Color.IntegerToColor(t>>>0),s=Ldt.Display.Color.IntegerToColor(e>>>0),r=Math.round(Ldt.Math.Linear(n.red,s.red,i)),a=Math.round(Ldt.Math.Linear(n.green,s.green,i)),o=Math.round(Ldt.Math.Linear(n.blue,s.blue,i));return Ldt.Display.Color.GetColor(r,a,o)}_defaultOverlayEvaluator(t){const e=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds;let i=-1;for(let t=this.phases.length-1;t>=0;t--)if(e>=this.phases[t].start){i=t;break}-1===i&&(i=this.phases.length-1);const n=this.phases[i],s=(i+1)%this.phases.length,r=this.phases[s];let a=r.start-n.start;a<=0&&(a+=this.totalSeconds);let o=e-n.start;o<0&&(o+=this.totalSeconds);const h=a>0?Ldt.Math.Clamp(o/a,0,1):0,l=void 0!==n.color?n.color>>>0:this.nightColor,u=void 0!==n.alpha?n.alpha:this.nightAlpha,c=void 0!==r.color?r.color>>>0:this.nightColor,d=void 0!==r.alpha?r.alpha:this.nightAlpha;return{color:hgt._lerpColor(l,c,h),alpha:Ldt.Math.Clamp(Ldt.Math.Linear(u,d,h),0,1),progress:h,phaseIndex:i}}update(t,e){if(!this._created)return;const i=(e??0)/1e3;this.running&&(this.timeSeconds+=i,this.timeSeconds>=this.totalSeconds&&(this.timeSeconds-=this.totalSeconds),this.timeSeconds<0&&(this.timeSeconds=(this.timeSeconds%this.totalSeconds+this.totalSeconds)%this.totalSeconds),this._timeCallbacks.forEach(t=>{try{t(this)}catch(t){}}));const n=this.overlayEvaluator(this.timeSeconds);n&&n.phaseIndex!==this._lastPhase&&(this._lastPhase=n.phaseIndex,this._phaseCallbacks.forEach(t=>{try{t(n,n.phaseIndex)}catch(t){}}));const s=this._camera||this.scene.cameras.main,r=s.width,a=s.height;if(!this._rt||!this._rt.texture)return void console.warn("LightManager.update: missing RenderTexture");if(!this._quad)return;this._rt.clear();const o=Ldt.Display.Color.IntegerToColor(n.color??this.nightColor),h=Ldt.Display.Color.GetColor(o.red,o.green,o.blue),l=Ldt.Math.Clamp(n.alpha??this.nightAlpha,0,1);this._rt.fill(h,l);let u=1;if(this._lightSprite&&this._lightSprite.texture)try{const t=this._lightSprite.texture,e=t.getSourceImage&&t.getSourceImage()||this.scene.textures.exists(t.key)&&this.scene.textures.get(t.key).getSourceImage();e&&e.width&&(u=e.width)}catch(t){u=1}const c=Math.min(this.lights.length,64),d=s.worldView&&"number"==typeof s.worldView.x?s.worldView.x:s.scrollX||0,f=s.worldView&&"number"==typeof s.worldView.y?s.worldView.y:s.scrollY||0,p="number"==typeof s.x?s.x:0,g="number"==typeof s.y?s.y:0;for(let t=0;t<c;t++){const e=this.lights[t];if(!e)continue;const i=e.x-d+p,n=e.y-f+g,s=Ldt.Math.Clamp(e.alpha*(e.intensity??1),0,1);this._lightSprite&&this._lightSprite.texture&&(this._lightSprite.setPosition(i,n).setAlpha(s).setTint(e.color),this._rt.draw(this._lightSprite))}this._rt&&this._rt.texture&&this._quad.texture!==this._rt.texture?(this._quad.setTexture(this._rt.texture),this._quad.setDisplaySize(r,a)):this._quad.setDisplaySize(r,a),this._quad.setBlendMode(Ldt.BlendModes.MULTIPLY)}addLight(t,e,i=128,n=16777215,s=1,r=1,a=null){if(this.lights.length>=64)return null;const o={x:t??0,y:e??0,radius:i??128,color:n>>>0,alpha:Ldt.Math.Clamp(s,0,1),intensity:r??1,mask:a??this._maskKey};return this.lights.push(o),o}removeLightObj(t){const e=this.lights.indexOf(t);-1!==e&&this.lights.splice(e,1)}clearLights(){this.lights.length=0}setNightAlpha(t){this.nightAlpha=Ldt.Math.Clamp(t,0,1)}setNightColor(t){this.nightColor=t>>>0}start(){this.running=!0}pause(){this.running=!1}reset(){this.timeSeconds=0}setTime(t){this.timeSeconds=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds}getTime(){return this.timeSeconds}getTimeF(){const t=aft.get("use12hFormat");let e=Math.floor(this.timeSeconds/60);const i=Math.floor(this.timeSeconds%60);if(t){const t=e>=12?"PM":"AM";return e%=12,0===e&&(e=12),e+":"+String(i).padStart(2,"0")+" "+t}return String(e).padStart(2,"0")+":"+String(i).padStart(2,"0")}setTimeMinutes(t){this.setTime(60*t)}getTimeMinutes(){return this.timeSeconds/60}onPhaseChange(t){"function"==typeof t&&this._phaseCallbacks.push(t)}onTimeChange(t){"function"==typeof t&&this._timeCallbacks.push(t)}_onResize(){const t=this.scene.cameras.main,e=t.width,i=t.height;this._rt&&(this._rt.destroy(),this._rt=this.scene.make.renderTexture({width:e,height:i,key:this._rtKey}),this._quad&&(this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(this._rtKey),this._quad.setDisplaySize(e,i)))}destroy(){this._quad&&(this._quad.destroy(),this._quad=null),this._lightSprite&&(this._lightSprite.destroy(),this._lightSprite=null),this._rt&&(this._rt.destroy(),this._rt=null),this.scene.scale.off("resize",this._onResize),this._created=!1}}class lgt extends Ldt.GameObjects.Container{constructor(t,{textureKey:e="floor_dynamic",mapPixelWidth:i=2048,mapPixelHeight:n=2048,cellSize:s=32,tilemapWidth:r=null,tilemapHeight:a=null,baseTilemap:o=null}={}){super(t,0,0),this.scene=t,this.cellSize=s,this.textureKey=e,this.widthPx=i,this.heightPx=n,this.cols=r||Math.ceil(this.widthPx/this.cellSize),this.rows=a||Math.ceil(this.heightPx/this.cellSize),this.canvas=document.createElement("canvas"),this.canvas.width=this.widthPx,this.canvas.height=this.heightPx,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0});const h=t.textures.get("dirt"),l=t.textures.get("grass2");if(!h||!l)throw new Error("Require textures 'dirt' and 'grass2' loaded in scene.");this.dirtImage=h.getSourceImage(),this.grassImage=l.getSourceImage(),this.tilemapNames=Array.from({length:this.cols},()=>new Array(this.rows)),this.tilemapIds=Array.from({length:this.cols},()=>new Array(this.rows)),this.cells=Array.from({length:this.cols},()=>new Array(this.rows).fill(!1)),this.rules=[{name:"air",test:t=>!t.self},{name:"grass_isolated",test:t=>t.self&&0===t.totalAdjacent},{name:"grass_horizontal_interior",test:t=>t.self&&t.w&&t.e&&!t.n&&!t.s,out:"grass"},{name:"grass_left",test:t=>t.self&&t.w&&!t.e&&!t.n&&!t.s,out:"grass_left"},{name:"grass_right",test:t=>t.self&&t.e&&!t.w&&!t.n&&!t.s,out:"grass_right"},{name:"grass_vertical_interior",test:t=>t.self&&t.n&&t.s&&!t.w&&!t.e,out:"grass"},{name:"grass_top",test:t=>t.self&&t.n&&!t.s&&!t.w&&!t.e,out:"grass_top"},{name:"grass_bottom",test:t=>t.self&&t.s&&!t.n&&!t.w&&!t.e,out:"grass_bottom"},{name:"grass_bottom_edges",test:t=>t.self&&t.s&&!t.n&&t.w&&t.e,out:"grass_bottom"},{name:"grass_bottom_left",test:t=>t.self&&t.s&&!t.n&&t.w&&!t.e,out:"grass_bottom_left"},{name:"grass_bottom_right",test:t=>t.self&&t.s&&!t.n&&t.e&&!t.w,out:"grass_bottom_right"},{name:"grass_top_edges",test:t=>t.self&&t.n&&!t.s&&t.w&&t.e,out:"grass_top"},{name:"grass_top_left",test:t=>t.self&&t.n&&!t.s&&t.w&&!t.e,out:"grass_top_left"},{name:"grass_top_right",test:t=>t.self&&t.n&&!t.s&&t.e&&!t.w,out:"grass_top_right"},{name:"grass_left_mixed",test:t=>t.self&&t.w&&!t.e&&(t.n||t.s),out:"grass_left"},{name:"grass_right_mixed",test:t=>t.self&&t.e&&!t.w&&(t.n||t.s),out:"grass_right"},{name:"grass_topleft_min",test:t=>t.self&&!t.se&&(t.s||t.e),out:"grass_top_left_min"},{name:"grass_topright_min",test:t=>t.self&&!t.sw&&(t.s||t.w),out:"grass_top_right_min"},{name:"grass_bottomleft_min",test:t=>t.self&&!t.ne&&(t.n||t.e),out:"grass_bottom_left_min"},{name:"grass_bottomright_min",test:t=>t.self&&!t.nw&&(t.n||t.w),out:"grass_bottom_right_min"},{name:"grass_fallback",test:t=>t.self,out:"grass"}],this.types={grass:{rand:[{x:13,y:0},{x:14,y:0},{x:15,y:0},{x:12,y:1},{x:13,y:1},{x:14,y:1},{x:15,y:1},{x:12,y:2},{x:13,y:2},{x:14,y:2},{x:15,y:2},{x:12,y:3},{x:13,y:3},{x:14,y:3},{x:15,y:3}]},air:{x:11,y:0},grass_top_left_min:{x:0,y:3},grass_bottom_left_min:{x:0,y:5},grass_bottom_right_min:{x:2,y:5},grass_top_right_min:{x:2,y:3},grass_top:{rand:[{x:1,y:3},{x:1,y:2}]},grass_bottom:{rand:[{x:1,y:5},{x:1,y:0}]},grass_left:{rand:[{x:0,y:4},{x:2,y:1}]},grass_right:{rand:[{x:2,y:4},{x:0,y:1}]},grass_bottom_left:{x:2,y:0},grass_bottom_right:{x:0,y:0},grass_top_right:{x:0,y:2},grass_top_left:{x:2,y:2}},this.getRandomFrom=t=>t[Math.floor(Math.random()*t.length)],this.bitblt=(t,e,i,n,s,r,a,o=!1)=>{o?(this.ctx.save(),this.ctx.translate(r+n,a),this.ctx.scale(-1,1),this.ctx.drawImage(t,e,i,n,s,0,0,n,s),this.ctx.restore()):this.ctx.drawImage(t,e,i,n,s,r,a,n,s)};const u=t.textures.get("tilemap");if(u&&u.source&&u.source[0]){const t=u.getSourceImage(),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d",{willReadFrequently:!0});i.drawImage(t,0,0);const n=i.getImageData(0,0,e.width,e.height);this.refWidth=e.width,this.refHeight=e.height,this.refData=n.data}else this.refWidth=0,this.refHeight=0,this.refData=null;this.getPixelGrass=(t,e)=>{if(!this.refData)return null;if(t<0||t>=this.refWidth||e<0||e>=this.refHeight)return null;const i=e*this.refWidth+t<<2,n=this.refData[i],s=this.refData[i+1],r=this.refData[i+2];if(0===this.refData[i+3])return!1;return(n+s+r)/3<128},this.isGrass=(t,e,i=t,n=e)=>{const s=this.getPixelGrass(t,e);if(null!==s)return s;if(!this.refData)return!1;const r=Math.max(0,Math.min(this.refWidth-1,i)),a=Math.max(0,Math.min(this.refHeight-1,n));return!0===this.getPixelGrass(r,a)},this.neighbors4=(t,e)=>({n:this.isGrass(t,e-1,t,e),s:this.isGrass(t,e+1,t,e),w:this.isGrass(t-1,e,t,e),e:this.isGrass(t+1,e,t,e)}),this.neighbors8=(t,e)=>({nw:this.isGrass(t-1,e-1,t,e),ne:this.isGrass(t+1,e-1,t,e),sw:this.isGrass(t-1,e+1,t,e),se:this.isGrass(t+1,e+1,t,e)}),this.classify=(t,e)=>{const i=this.isGrass(t,e),n=this.neighbors4(t,e),s=this.neighbors8(t,e),r=n.n,a=n.s,o=n.w,h=n.e,l=s.nw,u=s.ne,c=s.sw,d=s.se,f=[r,a,o,h,l,u,c,d].filter(Boolean).length,p={self:i,n:r,s:a,w:o,e:h,nw:l,ne:u,sw:c,se:d,totalAdjacent:f};for(const t of this.rules)if(t.test(p))return(t.out||t.name).toLowerCase();return"grass"};const c=32;for(let t=0;t<this.heightPx/c;t++)for(let e=0;e<this.widthPx/c;e++){const i=e*c,n=t*c,s=Math.floor(4*Math.random())*c,r=Math.floor(4*Math.random())*c;this.bitblt(this.dirtImage,s,r,c,c,i,n)}for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++){const i=this.classify(t,e);this.tilemapNames[t][e]=i;const n=this.types[i];if(this.tilemapIds[t][e]={...n.rand?{rand:n.rand.slice()}:n},this.tilemapIds[t][e].rand){const i=this.getRandomFrom(this.tilemapIds[t][e].rand);this.tilemapIds[t][e].x=i.x,this.tilemapIds[t][e].y=i.y}const s=this.tilemapIds[t][e].x*this.cellSize,r=this.tilemapIds[t][e].y*this.cellSize,a=t*this.cellSize,o=e*this.cellSize;this.bitblt(this.grassImage,s,r,this.cellSize,this.cellSize,a,o)}t.textures.exists(this.textureKey)&&t.textures.remove(this.textureKey),t.textures.addCanvas(this.textureKey,this.canvas),this.sprite=t.add.image(0,0,this.textureKey).setOrigin(0),this.add(this.sprite),t.add.existing(this)}destroy(t){this.scene.textures.exists(this.textureKey)&&this.scene.textures.remove(this.textureKey),super.destroy(t)}}class ugt{constructor(t=Date.now()){this._modulus=2**31,this._multiplier=1103515245,this._increment=12345,this._state=t%this._modulus}_nextState(){return this._state=(this._multiplier*this._state+this._increment)%this._modulus,this._state}getNextFloat(){return this._nextState()/this._modulus}getNextInt(t){if(t<=0)throw new Error("El parÃ¡metro max debe ser mayor que 0.");return Math.floor(this.getNextFloat()*t)}getNextIntRange(t,e){if(t>=e)throw new Error("min debe ser menor que max.");return t+this.getNextInt(e-t)}getNextBool(t=.5){if(t<0||t>1)throw new Error("p debe estar entre 0 y 1.");return this.getNextFloat()<t}}class cgt extends fft{constructor(t,e){super(t,"Error",e)}throwError(t,e=()=>window.location.reload()){this.body.innerHTML=t,this.closeBtn.addEventListener("click",e),this.toggle()}}class dgt extends Ldt.Scene{constructor(){super({key:"GameScene"}),this.zoom=1,this.minZoom=1,this.maxZoom=2,this.movementTimer=0,this.player=null,this.lastSentPos={x:null,y:null},this.errorModal=new cgt(document.getElementById("game-container"),this),this.dev=true,this.floor=null,this.mapSize={width:2048,height:2048}}preload(){o(this,a())}create(){this._configureWorld(this.mapSize.width,this.mapSize.height),this.connectingOverlay=new ogt(this),this.connectingOverlay.show(),this.floor=new lgt(this,{mapPixelWidth:this.mapSize.width,mapPixelHeight:this.mapSize.height}),this.lightManager=new hgt(this,{startAtMinutes:12}),this.inputManager=new Dft(this),this.networkManager=new agt(this),this.fpsElement=document.getElementById("fps-text"),this.lightManager.create(),this.random=new ugt(12344),this.mapObjects=new Oft(this),this.collisionGroup=this.physics.add.group({immovable:!0}),this.game.events.emit("gameLoad")}update(t,e){this.fpsElement.innerHTML="FPS - "+Math.floor(this.game.loop.actualFps)+"<br>"+this.game.renderer.constructor.name;const i=this.inputManager.getDirection();if(this.player){if(this.mapObjects.list.forEach(t=>{this.collisionGroup.contains(t.image)||this.collisionGroup.add(t.image),Ldt.Geom.Rectangle.Overlaps(this.player.sprite.getBounds(),t.image.getBounds())&&this.player.sprite.depth<t.image.depth?t.isOverlapping||(t.isOverlapping=!0,this.tweens.add({targets:t.image,alpha:.5,duration:150,ease:"Linear"})):t.isOverlapping&&(t.isOverlapping=!1,this.tweens.add({targets:t.image,alpha:1,duration:150,ease:"Linear"}))}),this.player.update(),this.player.updateMovement(i),this.movementTimer+=e,this.movementTimer>=100){const t=Math.floor(this.player.sprite.x),e=Math.floor(this.player.sprite.y),i=this.lastSentPos.x,n=this.lastSentPos.y;(i!==t||n!==e)&&(this.networkManager.emitMovement(t,e),this.lastSentPos.x=t,this.lastSentPos.y=e),this.movementTimer-=100}}else this.lastSentPos.x=null,this.lastSentPos.y=null;this.lightManager.update(t,e),this.mapObjects.update(t,e)}zoomIn(){const t=this.cameras.main,e=Ldt.Math.Clamp(this.zoom+1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}zoomOut(){const t=this.cameras.main,e=Ldt.Math.Clamp(this.zoom-1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}getCameraInfo(t=this.cameras.main){const e=t.worldView.x,i=t.worldView.y,n=t.worldView.width,s=t.worldView.height;return{x:e,y:i,width:n,height:s,maxSize:Math.max(n,s)}}_configureWorld(t,e){this.physics.world.setBounds(0,0,t,e),this.cameras.main.setBounds(0,0,t,e)}isVisible(t,e){const i=t.worldView,n=e.getBounds();return Ldt.Geom.Intersects.RectangleToRectangle(i,n)}}class fgt{constructor(t){t.style.overflow="hidden",document.fonts.load("48px Hawk");const e={banner:!1,parent:t,width:window.innerWidth,height:window.innerHeight,pixelArt:!0,physics:{default:"arcade",arcade:{debug:aft.get("debug")}},scene:[dgt]};this.game=new Ldt.Game(e),window.addEventListener("resize",()=>{this._onResize()})}_onResize(){const t=window.innerWidth*window.devicePixelRatio/2,e=window.innerHeight*window.devicePixelRatio/2;this.game.scale.resize(t,e),this.game.renderer.resize(t,e)}}class pgt extends Ldt.Scene{constructor(){super({key:"DashScene"}),this.player=null,this.timed=6e3,this.messages=["WE REALLY NEED","WS FOR SUBDOMAINS","REALYYYYYYYYYY"],this.msgIndex=this.messages.length-1}preload(){o(this,a())}create(){this.floor=new lgt(this,{mapPixelWidth:128,mapPixelHeight:128}),(async()=>{const t=await s(C,n()),e=t.id||"000_000000";this.player=new kft(this,e+"_b",e,t.username||"___","",64,82,t.game.avatar||""),this.player.sprite.setInteractive({draggable:!0}),this.player.sprite.on("drag",(t,e,i)=>{this.player.setPosition(e,i)})})()}update(t,e){this.player&&(this.timed+=e,this.timed>=6e3&&(this.timed=0,this.msgIndex=(this.msgIndex+1)%this.messages.length,this.player.say(this.messages[this.msgIndex],!1)),this.player.update({x:0,y:0}))}}class ggt{constructor(t){t.style.overflow="hidden",document.fonts.load("48px Hawk");const e={banner:!1,parent:t,pixelArt:!0,width:128,height:128,physics:{default:"arcade",arcade:{}},scene:[pgt]};this.game=new Ldt.Game(e)}}function vgt(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(String(n.result)),n.readAsDataURL(t)})}function mgt(t){return new Promise((e,i)=>{const n=new Image;n.onload=()=>e(n),n.onerror=()=>i(new Error("Could not load image")),n.src=t})}async function ygt(t,{maxBytes:e=5e6}={}){if(!t)throw new Error("No file provided");if("string"!=typeof t.type||!t.type.startsWith("image/"))throw new Error("File is not an image");if(t.size&&t.size>e)throw new Error(`File too large (max ${Math.round(e/1e6)} MB)`);const i=await vgt(t);return function(t){const e=32,i=document.createElement("canvas");i.width=e,i.height=e;const n=i.getContext("2d");n.clearRect(0,0,e,e);const s=t.width/t.height;let r=e,a=e;s>1?a=e/s:s<1&&(r=e*s);const o=Math.round((e-r)/2),h=Math.round((e-a)/2);return n.drawImage(t,o,h,r,a),i.toDataURL("image/png")}(await mgt(i))}const xgt={"/login":{...{auth:!1,title:"Login",description:"Sign in to your Hawk account."}||{},fn:function(){document.getElementById("app").innerHTML=`\n  <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Login</h3>\n    <span class="description">Log in into Hawk.</span>\n  </div>\n  <hr>\n  <form id="loginForm" class="gap">\n    <input type="text" id="username" placeholder="Username" required>\n    <input type="password" id="password" placeholder="Password" required>\n    <br>\n    <div id="turnstile-container"></div>\n    <br>\n    <button class="btn" type="submit">Login</button>\n    <br>\n    <small class="accent">By logging in you accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n  </form>\n  <hr>\n  <p>New here? <a href="/register">Register</a></p>\n  </div>\n  `,document.getElementById("loginForm").addEventListener("submit",async t=>{t.preventDefault();const e=t.target.username.value,i=t.target.password.value,n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:i,turnstile:window.turnstileToken})}),s=await n.json();n.ok?(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",s.username),localStorage.setItem("password",s.password),window.location="/dashboard"):F.add("Login error",s.error)})}},"/register":{...{auth:!1,title:"Register",description:"Create a Hawk account and join the community."}||{},fn:function(){function t(t,e){switch(t){case"display_name":return e.length>=d&&e.length<=f;case"username":{const t=e.length>=p&&e.length<=g,i=/^[A-Za-z0-9_]+$/.test(e);return t&&i}case"password":return e.length>=v&&e.length<=m;default:return!1}}function i(t){switch(t){case"display_name":return`Display name must be between ${d} and ${f} characters.`;case"username":return`Username must be between ${p} and ${g} characters and contain only letters, numbers and underscores (a-zA-Z0-9_).`;case"password":return`Password must be between ${v} and ${m} characters.`;default:return"Invalid field."}}document.getElementById("app").innerHTML=`\n  <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/unbanmember.png").dataUrl}"></canv-icon>Register</h3>\n    <span class="description">Create a new account.</span>\n  </div>\n  <hr>\n  <form id="regForm" class="gap">\n    <input type="text" id="display_name" placeholder="Display Name" required>\n    <input type="text" id="username" placeholder="Username" required>\n    <input type="password" id="password" placeholder="Password" required>\n    <br>\n    <div id="turnstile-container"></div>\n    <br>\n    <button class="btn" type="submit">Register</button>\n    <br>\n    <small class="accent">By creating a account your accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n  </form>\n  <hr>\n  <p>Already have a account? <a href="/login">Login</a></p>\n  </div>\n  `,document.getElementById("regForm").addEventListener("submit",async e=>{e.preventDefault();const n=e.target.display_name.value.trim(),s=e.target.username.value.trim(),r=e.target.password.value;if(window.turnstileToken,t("display_name",n))if(t("username",s))if(t("password",r))try{const t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:n,username:s,password:r,turnstile:window.turnstileToken})}),e=await t.json();t.ok?F.add("Registered",'Succesfully registered.<br>Login by clicking <a href="/login">here</a>.'):F.add("Register error",e.error||"Unknown error.<br>This maybe is a mistake, please contact an administrator.")}catch(t){F.add("Network error",t.message)}else F.add("Validation error",i("password"));else F.add("Validation error",i("username"));else F.add("Validation error",i("display_name"))})}},"/dashboard":{...{auth:!0,title:"Dashboard",description:"Sign in, and play on the community."}||{},fn:function(){document.getElementById("app").innerHTML=`\n  <div class="main-header">\n    <button class="btn" id="discord">\n      <span><canv-icon src="${e.getBlob("assets/icons/flag.png").dataUrl}"></canv-icon>Join our <strong>Discord</strong> server</span>\n    </button>\n    <button class="btn" id="support">\n      <span><canv-icon src="${e.getBlob("assets/icons/kofi.png").dataUrl}"></canv-icon>Become a <strong>supporter</strong>!</span>\n    </button>\n    <button class="btn" id="install">\n      <span><canv-icon src="${e.getBlob("assets/icons/createintegration.png").dataUrl}"></canv-icon>Install <strong>Hawk</strong> App</span>\n    </button>\n  </div>\n  <hr>\n  <div style="margin-bottom: 10px;" id="preview"></div>\n  <button class="btn" id="play">\n    <div id="title">\n      <div class="btn-text" style="display:none">Play on <strong id="server-name"></strong></div>\n      <div class="btn-spinner">Loading... <span class="loader"></span></div>\n    </div>\n    <div id="server-dropdown">\n      <div class="hamburger-menu">\n        <span class="bar bar1"></span>\n        <span class="bar bar2"></span>\n        <span class="bar bar3"></span>\n      </div>\n    </div>\n  </button>\n  <div id="server-dropdown-menu"></div>\n  <hr>\n  <div class="card" style="margin-top:14px">\n    <div style="display:flex;justify-content:space-between;align-items:center">\n      <div>\n        <div style="font-size:13px;color:var(--muted)">Server rules</div>\n      </div>\n      <div style="color:var(--muted);font-size:13px">#rules</div>\n    </div>\n\n    <ul id="ruleList" style="margin:12px 0 0 0;padding:0;list-style:none;display:grid;gap:8px"></ul>\n  </div>\n  `;const t=document.getElementById("preview"),n=new ggt(t),s=document.getElementById("discord"),r=document.getElementById("install"),a=document.getElementById("title"),o=a.querySelector(".btn-text"),h=a.querySelector(".btn-spinner"),l=document.querySelector("#ruleList"),u=document.querySelector("#server-dropdown"),c=document.querySelector("#server-dropdown-menu"),d=u.querySelector(".hamburger-menu"),f=document.querySelector("#server-name");let p=!0;function g(t){t?(a.classList.add("loading"),o.style.display="none",h.style.display="flex"):(a.classList.remove("loading"),o.style.display="flex",h.style.display="none")}function v(t){l.innerHTML="",t.forEach(t=>{l.innerHTML+=`<li style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)">\n        <div>\n          <div style="font-weight:600">${t.title}</div>\n          <div style="font-size:12px;color:var(--muted)">${t.description}</div>\n        </div>\n      </li>`})}var m;s.addEventListener("click",()=>{location.href=A}),r.style.display=window.deferredInstallPrompt?r.style.display:"none",r.addEventListener("click",()=>{!async function(){window.deferredInstallPrompt&&(window.deferredInstallPrompt.prompt(),await window.deferredInstallPrompt.userChoice)}()}),a.addEventListener("click",()=>{p||function(){p=!0,g(!0);const t=document.createElement("div");t.id="game-container",t.style.display="none",document.body.appendChild(t);const e=new fgt(t);e.game.events.on("gameLoad",()=>{t.style.display="block",n.game.destroy(),g(!1);for(let e=document.body.children.length-1;e>=0;e--){const i=document.body.children[e];i!==t&&document.body.removeChild(i)}e._onResize()})}()}),u.addEventListener("click",t=>{t.stopPropagation(),function(){const t="block"===c.style.display;c.style.display=t?"none":"block",d.className=t?"hamburger-menu":"hamburger-menu open"}()}),document.addEventListener("click",function(){c.style.display="none",d.className="hamburger-menu"}),(m="/api/game/servers",fetch(m,{method:"GET"}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})).then(t=>{if(!t||0===t.length)return p=!0,void g(!1);const e=t[0];f.innerHTML=i(e.name),localStorage.setItem("server",JSON.stringify(e)),v(e.rules),t.forEach(t=>{const e=document.createElement("div");e.className="item",e.innerHTML=`\n        <div class="header">\n          <span class="name">${i(t.name)}</span>\n          <span class="players">${t.players} players online</span>\n        </div>\n        <div class="content">\n          <span class="description">${i(t.description||"")}</span>\n        </div>\n      `,e.addEventListener("click",()=>{f.innerHTML=i(t.name),localStorage.setItem("server",JSON.stringify(t)),v(t.rules)}),c.appendChild(e)}),p=!1,g(!1)}).catch(()=>{p=!0,g(!1)})}},"/avatar":{...{auth:!0,title:"Avatar",description:"Customize your in-game avatar with a custom image."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/createemoji.png").dataUrl}"></canv-icon>In-Game avatar</h3>\n    <span class="description">Modify your in-game avatar.</span>\n  </div>\n<hr>\n      <section class="avatar-section">\n        <div class="header-row">\n          <div>\n            <p id="avatar-desc" class="lead">Upload an avatar for your character.</p>\n            <p class="small accent">Accepted: images. Max 5 MB.</p>\n          </div>\n        </div>\n\n        <label for="avatarInput" class="file-label">\n          <input id="avatarInput" type="file" accept="image/*" class="visually-hidden" />\n        </label>\n\n        <div class="preview-row" aria-live="polite">\n          <canvas id="avatarPreview" width="32" height="32" class="avatar-canvas"></canvas>\n          <div class="preview-text">Preview</div>\n        </div>\n\n        <div class="controls">\n          <button id="uploadAvatarBtn" class="uploadBtn">Upload avatar</button>\n          <div id="avatarMessage" class="message"></div>\n        </div>\n      </section>\n    </div>\n  `;const t=document.getElementById("avatarInput"),i=document.getElementById("avatarPreview").getContext("2d"),n=document.getElementById("avatarMessage"),s=document.getElementById("uploadAvatarBtn");t.addEventListener("change",async t=>{n.textContent="";const e=t.target.files&&t.target.files[0];if(e)try{const t=await vgt(e);(t=>{const e=32;i.clearRect(0,0,e,e);const n=t.width/t.height;let s=e,r=e;n>1?r=e/n:n<1&&(s=e*n);const a=Math.round((e-s)/2),o=Math.round((e-r)/2);i.drawImage(t,a,o,s,r)})(await mgt(t))}catch(t){n.textContent=t.message||"Error processing image",i.clearRect(0,0,32,32)}}),s.addEventListener("click",async()=>{n.textContent="",s.disabled=!0;try{const e=t.files&&t.files[0];if(!e)throw new Error("Please select an image first");const i=await ygt(e,{maxBytes:5e6});if(!i)throw new Error("Could not convert image");const s=localStorage.getItem("username"),r=localStorage.getItem("password");await async function(t,e=null,i=null,{timeoutMs:n=15e3}={}){if(!t)throw new Error("No image to upload");const s={image:t,username:e??null,password:i??null},r=new AbortController,a=setTimeout(()=>r.abort(),n);let o;try{o=await fetch("/api/avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),signal:r.signal})}catch(t){if("AbortError"===t.name)throw new Error("Upload timed out");throw new Error("Network error while uploading avatar")}finally{clearTimeout(a)}if(!o.ok){const t=await o.text().catch(()=>"");throw new Error(`Server error ${o.status}${t?`: ${t}`:""}`)}try{return await o.json()}catch{return null}}(i,s,r,{timeoutMs:15e3}),n.textContent="Avatar uploaded successfully"}catch(t){n.textContent=t.message||"Upload error"}finally{s.disabled=!1}})}},"/profile":{...{auth:!0,title:"Profile",description:"View and edit your public profile."}||{},fn:async function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Profile</h3>\n    <span class="description">Main profile.</span>\n  </div>\n  <hr>\n      <div class="profile-header" style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">\n        <img id="profileAvatar" src="/assets/generic-profile.png" width="64" height="64" style="border-radius:50%;object-fit:cover;background:#222;">\n        <div>\n          <div id="profileUsername" style="font-weight:700;font-size:18px"></div>\n          <div id="profileDisplayName" style="color:#666;margin-top:4px"></div>\n          <div id="profileId" style="color:#999;font-size:12px;margin-top:6px">ID: â</div>\n        </div>\n      </div>\n\n      <div>\n        <span id="profileFieldBio">No bio.</span>\n        <p id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n          <a class="btn mini" id="editProfileBtn" href="/profile-settings">Edit profile</a>\n          <a class="btn mini" id="editAvatarBtn" href="/avatar">Edit in-game avatar</a>\n        </p>\n      </div>\n    </div>\n  `;const t=document.getElementById("profileAvatar"),n=document.getElementById("profileUsername"),s=document.getElementById("profileDisplayName"),r=document.getElementById("profileId"),a=document.getElementById("profileFieldBio"),o=document.getElementById("profileActions");function h(t,e,o,h){n.textContent=i(t||"Username"),s.textContent=i(e||"Display name"),a.textContent=i(h||"No bio."),r.textContent=`ID: ${i(String(o||"â"))}`}function l(){o&&(o.style.display="none")}function u(){o&&(o.style.display="flex")}async function d(e){if(e)try{const i=await fetch(`/api/pavatar/${encodeURIComponent(e)}`);if(!i.ok)return void(t.src="");const n=await i.blob(),s=URL.createObjectURL(n);t.src=s,setTimeout(()=>URL.revokeObjectURL(s),6e4)}catch{t.src=""}else t.src=""}document.getElementById("editProfileBtn"),document.getElementById("editAvatarBtn"),(async()=>{const t=function(t){return new URLSearchParams(window.location.search).get(t)}("id"),e=await async function(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await c("/api/auth/check",{username:t,password:e})||null}catch{return null}}(),i=e&&e.id?String(e.id):null;if(t){const e=await async function(t){try{const e=await c("/api/auth/profile",{id:t});if(!e)return null;const i=e.username||"",n=e.displayName||e.display_name||"",s=e.bio||"";return h(i,n,e.id||t,s),(e.id||t)&&await d(e.id||t),e}catch(t){return null}}(t);if(e)return void(i&&String(e.id||t)===i?u():l())}if(e){h(e.username||localStorage.getItem("username")||"",e.displayName||localStorage.getItem("display_name")||"",e.id,e.bio),e.id&&await d(e.id),e.username&&localStorage.setItem("username",e.username),e.displayName&&localStorage.setItem("display_name",e.displayName),u()}else h("","","â",""),l()})()}},"/profile-settings":{...{auth:!0,title:"Profile Settings",description:"Manage data and security settings."}||{},fn:async function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/control.png").dataUrl}"></canv-icon>Profile Settings</h3>\n    <span class="description">Edit/Modify your profile with ease.</span>\n  </div>\n  <hr>\n\n      <div class="header-row" id="headerRow">\n        <div class="avatar-wrap"><canvas id="settingsAvatarPreview" width=128 height=128></canvas></div>\n        <div class="header-meta">\n          <div id="settingsUsername" class="username"></div>\n          <div id="settingsDisplayName" class="displayname"></div>\n          <div id="settingsId" class="id">ID: â</div>\n        </div>\n      </div>\n\n      <div class="profile-grid">\n        <div class="profile-section">\n          <label for="settingsDisplayNameInput">Display name</label>\n          <input id="settingsDisplayNameInput" type="text" />\n          <button id="settingsSaveDisplayName" class="btn mini">Save</button>\n          <div id="settingsDisplayNameMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsUsernameInput">Username</label>\n          <input id="settingsUsernameInput" type="text" />\n          <button id="settingsSaveUsername" class="btn mini">Save</button>\n          <div id="settingsUsernameMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsPasswordInput">Password</label>\n          <input id="settingsPasswordInput" type="password" />\n          <button id="settingsSavePassword" class="btn mini">Save</button>\n          <div id="settingsPasswordMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsBioInput">Bio</label>\n          <input id="settingsBioInput" type="bio" />\n          <button id="settingsSaveBio" class="btn mini">Save</button>\n          <div id="settingsBioMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="avatar-block">\n          <div class="avatar-row" style="margin-top:8px;">\n            <canvas id="settingsAvatarPreviewSmall" width="128" height="128"></canvas>\n            <div>\n              <input id="settingsAvatarInput" type="file" accept="image/*" />\n              <button id="settingsUploadAvatar" class="uploadBtn">Upload avatar</button>\n              <div id="settingsAvatarMsg" class="message" aria-live="polite"></div>\n            </div>\n          </div>\n        </div>\n\n        <div id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n          <a class="btn mini" href="/profile">Back to profile</a>\n        </div>\n      </div>\n    </div>\n  `;const t=t=>document.getElementById(t),n=t("settingsAvatarPreview"),s=t("settingsAvatarPreviewSmall"),r=t("settingsUsername"),a=t("settingsDisplayName"),o=t("settingsId"),d=t("settingsDisplayNameInput"),f=t("settingsSaveDisplayName"),p=t("settingsDisplayNameMsg"),g=t("settingsUsernameInput"),v=t("settingsSaveUsername"),m=t("settingsUsernameMsg"),y=t("settingsPasswordInput"),x=t("settingsSavePassword"),w=t("settingsPasswordMsg"),b=t("settingsBioInput"),T=t("settingsSaveBio"),S=t("settingsBioMsg"),E=t("settingsAvatarInput"),_=t("settingsUploadAvatar"),C=t("settingsAvatarMsg"),A=n.getContext("2d"),P=s.getContext("2d");function M(t,e,i=!1){t.textContent=e,t.style.color=i?"crimson":""}async function R(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await c("/api/auth/check",{username:t,password:e})||null}catch{return null}}async function L(t){if(!t)return;const e=t.id,h=t.username||localStorage.getItem("username")||"",l=t.displayName||localStorage.getItem("display_name")||"";if(r.textContent=i(h),a.textContent=i(l),o.textContent=`ID: ${i(String(e))}`,e)try{const t=await fetch(`/api/pavatar/${encodeURIComponent(e)}`);if(t.ok){const e=await t.blob(),i=URL.createObjectURL(e),r=new Image;r.src=i,r.onload=()=>{u(r,n,Math.min(n.width,n.height)),u(r,s,Math.min(s.width,s.height)),setTimeout(()=>URL.revokeObjectURL(i),6e4)}}else A.clearRect(0,0,n.width,n.height),P.clearRect(0,0,s.width,s.height)}catch{A.clearRect(0,0,n.width,n.height),P.clearRect(0,0,s.width,s.height)}}async function O({key:t,inputEl:e,msgEl:i,successLocalKey:n}){const s=localStorage.getItem("username"),r=localStorage.getItem("password"),a=e.value;if(s&&r)try{const e=await c("/api/user/edit",{username:s,password:r,key:t,value:a});M(i,e&&(e.message||e.success)||"Done"),n&&localStorage.setItem(n,a);const o=await R();o&&(o.displayName&&(d.value=o.displayName,localStorage.setItem("display_name",o.displayName)),o.username&&(g.value=o.username,localStorage.setItem("username",o.username)),await L(o))}catch(t){M(i,t.message||"Error",!0)}else M(i,"Credentials not stored locally.",!0)}A.clearRect(0,0,n.width,n.height),P.clearRect(0,0,s.width,s.height),f.addEventListener("click",()=>O({key:"displayName",inputEl:d,msgEl:p,successLocalKey:"display_name"})),v.addEventListener("click",()=>O({key:"username",inputEl:g,msgEl:m,successLocalKey:"username"})),x.addEventListener("click",()=>O({key:"password",inputEl:y,msgEl:w})),T.addEventListener("click",()=>O({key:"bio",inputEl:b,msgEl:S})),E.addEventListener("change",async t=>{C.textContent="";const e=t.target.files&&t.target.files[0];if(e)try{const t=await h(e),i=await l(t);u(i,n,Math.min(n.width,n.height)),u(i,s,Math.min(s.width,s.height))}catch(t){M(C,t.message||"Error processing image",!0)}}),_.addEventListener("click",async()=>{M(C,"Uploading..."),_.disabled=!0;try{const t=E.files&&E.files[0];if(!t)throw new Error("Please select an image first");const e=await async function(t){if(!t)throw new Error("No file provided");if(!t.type.startsWith("image/"))throw new Error("File is not an image");const e=await h(t),i=await l(e);if(128===i.width&&128===i.height)return e;const n=document.createElement("canvas");return n.width=128,n.height=128,u(i,n,128),n.toDataURL("image/png")}(t),i=localStorage.getItem("username"),n=localStorage.getItem("password"),s=await c("/api/pavatar",{image:e,username:i,password:n});M(C,s&&(s.message||"Avatar uploaded successfully")||"Avatar uploaded");const r=await R();r&&(r.displayName&&localStorage.setItem("display_name",r.displayName),r.username&&localStorage.setItem("username",r.username),await L(r))}catch(t){M(C,t.message||"Upload error",!0)}finally{_.disabled=!1}}),(async()=>{const t=await R();if(t)t.displayName&&(d.value=t.displayName,localStorage.setItem("display_name",t.displayName)),t.username&&(g.value=t.username,localStorage.setItem("username",t.username)),await L(t);else{const t=localStorage.getItem("display_name")||"",e=localStorage.getItem("username")||"";d.value=t,g.value=e,r.textContent=i(e||"Username"),a.textContent=i(t||"Display name")}})()}},"/people":{...{auth:!0,title:"People",description:"Manage friends, and send game invites."}||{},fn:gft},"/about":{...{auth:!1,title:"About",description:"Overview of Hawk, its mission, and team."}||{},fn:function(){let t="";P.forEach(e=>{t+=`<div class="contributor">\n      <span>${e.name} <span class="accent">@${e.username}</span></span>\n      <br>\n      <small>Role: <span class="accent">${e.role}</span></small>\n    </div><br>`}),document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>About</h3>\n    <span class="description">About Hawk.</span>\n  </div>\n  <hr>\n    <p>A game written in <strong>Javascript</strong> using Hawk engine, check <a href="/help">help page</a> for controls and more.</p>\n    \n    <h3>Contact</h3>\n    <p>You can contact us on <strong>Discord</strong> <a href="${A}">here</a>.</p>\n    \n    <h3>Team</h3>\n    <p>Our team has <strong>${P.length}</strong> contributor(s). You can be one by joining our Discord Server and contributing!</p>\n    ${t}\n    </div>\n  `}},"/help":{...{auth:!1,title:"Help",description:"Controls, and some help."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>Help</h3>\n    <span class="description">Help and controls of Hawk.</span>\n  </div>\n  <hr>\n    <p>Our help page, check <a href="/about">about page</a> for more info.</p>\n    \n    <h3>Contact</h3>\n    <p>You can contact us on <strong>Discord</strong> <a href="${A}">here</a>.</p>\n    \n    <h3>Controls</h3>\n    <p>\n      <strong>PC:</strong> Use the <span class="highlight">W</span><span class="highlight">A</span><span class="highlight">S</span><span class="highlight">D</span> keys for movement.\n    </p>\n    <p>\n      <strong>Mobile:</strong> Use the dynamic joystick on the screen for movement.\n    </p>\n\n    <h3>Commands</h3>\n    <p>You can use commands by typing <span class="highlight">/</span>.</p>\n    <p>List of commands will be automatically displayed when typing <span class="highlight">/</span></p>\n    </div>\n  `}},"/privacypolicy":{...{auth:!1,title:"Privacy Policy",description:"Details on how Hawk collects, uses, and protects data."}||{},fn:function(){document.getElementById("app").innerHTML=`\n<span>\n<strong>Privacy Policy (PRIVACY) - Hawk</strong>\n<br><br>\n1. <strong>Data collected</strong><br>\n- At registration we collect: <strong>username</strong>, <strong>password</strong>, and <strong>display name</strong>.\n<br><br>\n2. <strong>Purpose and use</strong><br>\n- <strong>username</strong> and <strong>password</strong>: validated and used exclusively for authentication and friend requests.<br>\n- <strong>display name</strong>: shown on the site to identify the user.\n<br><br>\n3. <strong>No cookies</strong><br>\n- <strong>We do not use cookies.</strong>\n<br><br>\n4. <strong>Sharing</strong><br>\n- We do not share personal data with third parties, except when required by law.\n<br><br>\n5. <strong>Retention</strong><br>\n- Account data is retained indefinitely and <strong>accounts cannot be deleted</strong>.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not intended for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update this Privacy Policy at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${A}">here</a>.\n</span>`}},"/termsofservice":{...{auth:!1,title:"Terms Of Service",description:"Rules and legal terms governing use of Hawk."}||{},fn:function(){document.getElementById("app").innerHTML=`\n<span>\n<strong>Terms of Service (TERMS) - Hawk</strong>\n<br><br>\n1. <strong>Acceptance</strong><br>\nBy using this site you accept these Terms. If you do not agree, do not use the service.\n<br><br>\n2. <strong>Registration and account</strong><br>\n- To create an account you must register with: <strong>username</strong>, <strong>password</strong> and <strong>display name</strong>.<br>\n- <strong>username</strong> and <strong>password</strong> are used to log in. <strong>display name</strong> is used only to identify you publicly within the site.<br>\n- You are responsible for keeping your <strong>username</strong> and <strong>password</strong> confidential and for all activities that occur under your account.\n<br><br>\n3. <strong>Permitted use</strong><br>\n- Do not use the service for illegal, fraudulent, defamatory activities, or to infringe the rights of others.<br>\n- We may suspend or delete accounts that violate these Terms.\n<br><br>\n4. <strong>User content</strong><br>\n- You retain ownership of content you publish.<br>\n- By posting content you agree the site may display it to other users according to the siteâs functionality.\n<br><br>\n5. <strong>Account status</strong><br>\n- Accounts remain on the system indefinitely.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.<br>\n- Use strong, unique passwords.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update these Terms at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${A}">here</a>.\n</span>`}},"/404":{...{auth:!1,title:"404",description:"This page has not found."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/endstage.png").dataUrl}"></canv-icon>404 - Not Found</h3>\n    <span class="description">Not found</span>\n  </div>\n  <hr>\n    <p>This page was not found.</p>\n    <p>If you think this is a mistake, You can contact us on <strong>Discord</strong> <a href="${A}">here</a>.</p>\n    \n    <a class="btn" href="/dashboard">Go to dashboard</a>\n    </div>\n  `}},"/ping":{...{auth:!1,title:"Ping",description:"Check the ping between you and Hawk servers."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n      <div class="header">\n        <h3><canv-icon src="${e.getBlob("assets/icons/pings.png").dataUrl}"></canv-icon>Ping</h3>\n        <span class="description">Ping check</span>\n      </div>\n      <hr>\n      <p>Check your ping between you and <strong>Hawk</strong> servers.</p>\n      <br>\n      <p id="ping-result"><i>Your result will appear here.</i></p>\n      <br>\n      <button class="btn" id="ping-button">Check your ping</button>\n      <small>The result can not be same as play ping. It also depends of device speed.</small>\n    </div>\n  `;const t=document.getElementById("ping-button"),i=document.getElementById("ping-result");t.addEventListener("click",async()=>{const t=(new Date).getTime();try{if((await fetch("/api/game/servers")).ok){const n=(new Date).getTime()-t;let s;s=n<100?`<canv-icon src="${e.getBlob("assets/icons/goodping.png").dataUrl}"></canv-icon>`:n<300?`<canv-icon src="${e.getBlob("assets/icons/idelping.png").dataUrl}"></canv-icon>`:`<canv-icon src="${e.getBlob("assets/icons/badping.png").dataUrl}"></canv-icon>`,i.innerHTML=`${s} Ping: ${n} ms`}else i.innerText="Error checking your ping"}catch(t){i.innerText="Error checking your ping"}})}},"/":{...{redirect:"/dashboard"}||{}}};let wgt=null,bgt=null,Tgt=!1;function Sgt(){if(!Tgt){document.body.innerHTML="",wgt=function(){const t=localStorage.getItem("loggedIn"),i=document.createElement("nav");i.className="main-nav",i.innerHTML=`\n    <div class="nav-icon">\n      <img src="${e.getBlob("logo.svg").dataUrl}" alt="Hawk" width="auto" height="25">\n    </div>\n    <p class="nav-title">Hawk</p>\n    <div class="nav-dropdown">\n      <button id="dropdownBtn">\n        ${t?'\n        <div id="user">\n          <img id="pavatar"></img>\n          <span class="accent" id="displayName"></span>\n        </div>\n        ':""}\n        <div class="hamburger-menu">\n          <span class="bar bar1"></span>\n          <span class="bar bar2"></span>\n          <span class="bar bar3"></span>\n        </div>\n      </button>\n      <div id="dropdownMenu" class="dropdown-menu">\n        ${t?'\n        <li><a href="/dashboard">Dashboard</a></li>\n        <hr>\n        <li><a href="/profile">Profile</a></li>\n        <li><a href="/people">People</a></li>\n        <hr>\n        <li><a id="logoutBtn">Logout</a></li>\n        ':'\n        <li><a href="/login">Login</a></li>\n        <li><a href="/register">Register</a></li>\n        '}\n        <hr>\n        <li><a href="/about">About</a></li>\n        <li><a href="/help">Help</a></li>\n      </div>\n    </div>\n  `;const r=i.querySelector("#dropdownBtn"),a=i.querySelector("#dropdownMenu"),o=r.querySelector(".hamburger-menu");return r.addEventListener("click",t=>{t.stopPropagation(),a.style.display="block"===a.style.display?"none":"block",o.className="block"===a.style.display?"hamburger-menu open":"hamburger-menu"}),document.addEventListener("click",()=>{a.style.display="none",o.className="block"===a.style.display?"hamburger-menu open":"hamburger-menu"}),t&&(i.querySelector("#logoutBtn").addEventListener("click",()=>{localStorage.removeItem("loggedIn"),localStorage.removeItem("username"),localStorage.removeItem("password"),window.location="/login"}),s(C,n()).then(t=>{const e=document.getElementById("displayName"),i=document.getElementById("pavatar");e.innerText=t.displayName,i.src="/api/pavatar/"+t.id})),i}(),document.body.appendChild(wgt);const t=document.createElement("main");t.id="app",document.body.appendChild(t),bgt=document.createElement("footer"),bgt.className="site-footer",bgt.innerHTML=`\n      <div class="footer-top">\n        <div class="brand">\n          <img src="${e.getBlob("logo.svg").dataUrl}" alt="Logo" class="footer-logo">\n          <span class="brand-name">Hawk</span>\n        </div>\n        <div class="right-side">\n        </div>\n      </div>\n      <div class="footer-bottom">\n        <div class="authors">\n          Â© ${(new Date).getFullYear()} â ${O}\n        </div>\n        <div class="extras">\n          <p>${R} Â· assets-${L}</p>\n          <a href="/termsofservice">Terms Of Service</a> Â· <a href="/privacypolicy">Privacy Policy</a> Â· <a href="${A}">Discord</a>\n        </div>\n      </div>\n    `,bgt.style.marginTop="170px",document.body.appendChild(bgt),document.body.addEventListener("click",Egt),Tgt=!0}}function Egt(t){if(t.defaultPrevented)return;if(0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;let e=t.target;for(;e&&"A"!==e.nodeName;)e=e.parentElement;if(!e)return;const i=e.getAttribute("href");!i||i.startsWith("http")||i.startsWith("mailto:")||i.startsWith("tel:")||(t.preventDefault(),function(t){if(!t.startsWith("/")){t=window.location.pathname.replace(/\/+$/,"")+"/"+t}window.history.pushState({},"",t),_gt()}(i))}function _gt(){const t=function(){const t=window.location.pathname.split("/").filter(Boolean);return"/"+(t.length?t[t.length-1]:"")}(),e=xgt[t]||{},i=!!localStorage.getItem("loggedIn");if("/"===t&&(i?window.history.replaceState({},"","/dashboard"):window.history.replaceState({},"","/login")),e.redirect)return window.history.replaceState({},"",e.redirect),_gt();if(e.auth&&!i)return window.history.replaceState({},"","/login"),_gt();if(!e.auth&&i&&("/login"===t||"/register"===t))return window.history.replaceState({},"","/dashboard"),_gt();if(!e.fn)return window.history.replaceState({},"","/404"),_gt();document.title="Hawk - "+e.title,localStorage.getItem("display_name");const n=document.getElementById("app");n&&n.classList.add("hidden"),setTimeout(()=>{Sgt(),function(){const t=document.getElementById("app");t&&(t.innerHTML="")}(),e.fn(),setTimeout(()=>{n&&n.classList.remove("hidden")},500)},500)}window.addEventListener("popstate",()=>{_gt()});var Cgt={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function Agt(){if("function"==typeof importScripts)return Cgt;var t=navigator.userAgent;/Windows/.test(t)?Cgt.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(Cgt.iOS=!0,Cgt.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),Cgt.iOSVersion=parseInt(RegExp.$1,10)):Cgt.macOS=!0:/Android/.test(t)?Cgt.android=!0:/Linux/.test(t)?Cgt.linux=!0:/iP[ao]d|iPhone/i.test(t)?(Cgt.iOS=!0,navigator.appVersion.match(/OS (\d+)/),Cgt.iOSVersion=parseInt(RegExp.$1,10),Cgt.iPhone=-1!==t.toLowerCase().indexOf("iphone"),Cgt.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?Cgt.kindle=!0:/CrOS/.test(t)&&(Cgt.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(Cgt.android=!1,Cgt.iOS=!1,Cgt.macOS=!1,Cgt.windows=!0,Cgt.windowsPhone=!0);var e=/Silk/.test(t);return(Cgt.windows||Cgt.macOS||Cgt.linux&&!e||Cgt.chromeOS)&&(Cgt.desktop=!0),(Cgt.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(Cgt.desktop=!1),navigator.standalone&&(Cgt.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(Cgt.cordova=!0),void 0!==window.ejecta&&(Cgt.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(Cgt.node=!0),Cgt.node&&"object"==typeof process.versions&&(Cgt.nodeWebkit=!!process.versions["node-webkit"],Cgt.electron=!!process.versions.electron),/Crosswalk/.test(t)&&(Cgt.crosswalk=!0),Cgt.pixelRatio=window.devicePixelRatio||1,Cgt}var Pgt={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function Mgt(){var t=navigator.userAgent;return/Edg\/\d+/.test(t)?(Pgt.edge=!0,Pgt.es2019=!0):/OPR/.test(t)?(Pgt.opera=!0,Pgt.es2019=!0):/Chrome\/(\d+)/.test(t)&&!Agt().windowsPhone?(Pgt.chrome=!0,Pgt.chromeVersion=parseInt(RegExp.$1,10),Pgt.es2019=Pgt.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(Pgt.firefox=!0,Pgt.firefoxVersion=parseInt(RegExp.$1,10),Pgt.es2019=Pgt.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&Agt().iOS?(Pgt.mobileSafari=!0,Pgt.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(Pgt.ie=!0,Pgt.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!Agt().windowsPhone?(Pgt.safari=!0,Pgt.safariVersion=parseInt(RegExp.$1,10),Pgt.es2019=Pgt.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(Pgt.ie=!0,Pgt.trident=!0,Pgt.tridentVersion=parseInt(RegExp.$1,10),Pgt.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(Pgt.silk=!0),Pgt}var Rgt={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};function Lgt(){if("function"==typeof importScripts)return Rgt;Rgt.canvas=!!window.CanvasRenderingContext2D;try{Rgt.localStorage=!!localStorage.getItem}catch(t){Rgt.localStorage=!1}Rgt.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),Rgt.fileSystem=!!window.requestFileSystem;var t,e,i,n=!1;return Rgt.webGL=function(){if(window.WebGLRenderingContext)try{var t=document.createElement("canvas"),e=t.getContext("webgl")||t.getContext("experimental-webgl"),i=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return n=i.data instanceof Uint8ClampedArray,!!e}catch(t){return!1}return!1}(),Rgt.worker=!!window.Worker,Rgt.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,Rgt.getUserMedia=Rgt.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,Mgt().firefox&&Mgt().firefoxVersion<21&&(Rgt.getUserMedia=!1),!Agt().iOS&&(Mgt().ie||Mgt().firefox||Mgt().chrome)&&(Rgt.canvasBitBltShift=!0),(Mgt().safari||Mgt().mobileSafari)&&(Rgt.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(Rgt.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(Rgt.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===i[0]||2712847316!==i[0]&&null)),Rgt.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==Rgt.littleEndian&&n,Rgt}const Ogt=["assets/icons/0.png","assets/icons/1.png","assets/icons/10.png","assets/icons/18.png","assets/icons/2.png","assets/icons/3.png","assets/icons/4.png","assets/icons/5.png","assets/icons/6.png","assets/icons/7.png","assets/icons/8.png","assets/icons/9.png","assets/icons/Bugs.png","assets/icons/Correct.png","assets/icons/DAC.png","assets/icons/Discord.png                               ./public/assets/icons/Download.png","assets/icons/Female.png","assets/icons/Guardian.png","assets/icons/HSbalance.png","assets/icons/HSbravery.png","assets/icons/HSbrilliance.png","assets/icons/MSvisualcode.png","assets/icons/Male.png","assets/icons/New.png","assets/icons/OAuth2.png","assets/icons/Person.png","assets/icons/Wrong.png","assets/icons/a.png","assets/icons/activedevbadge.png","assets/icons/activities.png","assets/icons/addreactions.png","assets/icons/aka.png","assets/icons/amogus.png","assets/icons/announce.png","assets/icons/archive.png","assets/icons/audiodisable.png","assets/icons/audioenable.png","assets/icons/award.png","assets/icons/awardcup.png","assets/icons/b.png","assets/icons/backforward.png","assets/icons/badping.png","assets/icons/ban.png","assets/icons/bank.png","assets/icons/banmembers.png","assets/icons/bday.png","assets/icons/behance.png","assets/icons/beta.png","assets/icons/beta1.png","assets/icons/beta1A.png","assets/icons/beta2.png","assets/icons/beta2A.png","assets/icons/bigender.png","assets/icons/birdman.png","assets/icons/book.png","assets/icons/bookmark.png","assets/icons/bots.png","assets/icons/box.png","assets/icons/bright.png","assets/icons/bulb.png","assets/icons/busy.png","assets/icons/c.png","assets/icons/calendar1.png","assets/icons/calender.png","assets/icons/calenderdate.png","assets/icons/callconnect.png","assets/icons/calldecline.png","assets/icons/calldisconnect.png","assets/icons/camera.png","assets/icons/channel.png","assets/icons/channelfollowed.png","assets/icons/clean.png","assets/icons/clock.png","assets/icons/clouddown.png","assets/icons/cmd.png","assets/icons/code.png","assets/icons/coin.png","assets/icons/colorboostnitro.png","assets/icons/colornitro.png","assets/icons/colorserverpartner.png","assets/icons/colorserververified.png","assets/icons/colorstaff.png","assets/icons/connect.png","assets/icons/control.png","assets/icons/createcategory.png","assets/icons/createchannel.png","assets/icons/createchannels.png","assets/icons/createemoji.png","assets/icons/createintegration.png","assets/icons/createrole.png","assets/icons/createsticker.png","assets/icons/createthread.png","assets/icons/createwebhook.png","assets/icons/creditcard.png","assets/icons/customstaff.png","assets/icons/d.png","assets/icons/dblurple.png","assets/icons/defaultperms.png","assets/icons/delete.png","assets/icons/deletechannel.png","assets/icons/deleteemoji.png","assets/icons/deleteevent.png","assets/icons/deleteintegration.png","assets/icons/deleterole.png","assets/icons/deletesticker.png","assets/icons/deletethread.png","assets/icons/deletewebhook.png","assets/icons/dfuchsia.png","assets/icons/dgreen.png","assets/icons/disable.png","assets/icons/discordbotdev.png","assets/icons/discordbughunter.png","assets/icons/discordhypesquard.png","assets/icons/discordjs.png","assets/icons/discordmod.png","assets/icons/discordnitro.png","assets/icons/discordpartner.png","assets/icons/discordstaff.png","assets/icons/discover.png","assets/icons/dislike.png","assets/icons/djoin.png","assets/icons/dleave.png","assets/icons/dollar.png","assets/icons/downarrow.png","assets/icons/downvote.png","assets/icons/dred.png","assets/icons/dwhite.png","assets/icons/dyellow.png","assets/icons/e.png","assets/icons/earlysupporter.png","assets/icons/edit.png","assets/icons/education.png","assets/icons/emojiguardian.png","assets/icons/enable.png","assets/icons/endstage.png","assets/icons/eventcolour.png","assets/icons/exclamation.png","assets/icons/f.png","assets/icons/fb.png","assets/icons/figma.png","assets/icons/file.png","assets/icons/files.png","assets/icons/fingerprint.png","assets/icons/fire.png","assets/icons/flag.png","assets/icons/folder.png","assets/icons/forum.png","assets/icons/forumNFSW.png","assets/icons/friends.png","assets/icons/frontforward.png","assets/icons/fword.png","assets/icons/g.png","assets/icons/games.png","assets/icons/gay.png","assets/icons/gender.png","assets/icons/generalinfo.png","assets/icons/gif.png","assets/icons/gift.png","assets/icons/gitbranch.png","assets/icons/gitcommit.png","assets/icons/github.png","assets/icons/gitmerge.png","assets/icons/gitpullrequest.png","assets/icons/globe.png","assets/icons/goodping.png","assets/icons/growth.png","assets/icons/h.png","assets/icons/hammer.png","assets/icons/he_him.png","assets/icons/headphone.png","assets/icons/headphonedeafen.png","assets/icons/heart.png","assets/icons/hetero.png","assets/icons/hi.png","assets/icons/hoursglass.png","assets/icons/hyphen.png","assets/icons/i.png","assets/icons/id.png","assets/icons/idelping.png","assets/icons/idle.png","assets/icons/illustrator.png","assets/icons/image.png","assets/icons/info.png","assets/icons/instagram.png","assets/icons/invite.png","assets/icons/j.png","assets/icons/join.png","assets/icons/jpg.png","assets/icons/js.png","assets/icons/k.png","assets/icons/kick.png","assets/icons/kicking.png","assets/icons/kofi.png","assets/icons/l.png","assets/icons/leave.png","assets/icons/leftarrow.png","assets/icons/lesbian.png","assets/icons/library.png","assets/icons/like.png","assets/icons/link.png","assets/icons/linkadd.png","assets/icons/linked.png","assets/icons/linkrevoke.png","assets/icons/linkupdate.png","assets/icons/list.png","assets/icons/live.png","assets/icons/loading.png","assets/icons/loadingerror.png","assets/icons/locked.png","assets/icons/loop.png","assets/icons/m.png","assets/icons/magicwand.png","assets/icons/markasread.png","assets/icons/mashroomman.png","assets/icons/mentalhealth.png","assets/icons/menu.png","assets/icons/message.png","assets/icons/mic.png","assets/icons/micmute.png","assets/icons/moderationhig.png","assets/icons/moderationhighest.png","assets/icons/moderationlow.png","assets/icons/moderationmedium.png","assets/icons/moderationnone.png","assets/icons/monitor.png","assets/icons/music.png","assets/icons/musicstop.png","assets/icons/n.png","assets/icons/new1.png","assets/icons/new1A.png","assets/icons/new2.png","assets/icons/new2A.png","assets/icons/newmembers.png","assets/icons/news1.png","assets/icons/news2.png","assets/icons/night.png","assets/icons/nitro.png","assets/icons/nitroboost.png","assets/icons/nodejs.png","assets/icons/notificationsettings.png","assets/icons/notify.png","assets/icons/o.png","assets/icons/off.png","assets/icons/offline.png","assets/icons/on.png","assets/icons/online.png","assets/icons/outage.png","assets/icons/owner.png","assets/icons/p.png","assets/icons/paintpadbrush.png","assets/icons/partner.png","assets/icons/patreon.png","assets/icons/pause.png","assets/icons/paypal.png","assets/icons/pen.png","assets/icons/people.png","assets/icons/photoshop.png","assets/icons/pin.png","assets/icons/ping.png","assets/icons/pings.png","assets/icons/plant.png","assets/icons/play.png","assets/icons/plus.png","assets/icons/png.png","assets/icons/podcast.png","assets/icons/premium.png","assets/icons/premiumchannel.png","assets/icons/q.png","assets/icons/question.png","assets/icons/queue.png","assets/icons/quotes.png","assets/icons/r.png","assets/icons/rVIP.png","assets/icons/radmins.png","assets/icons/rartists.png","assets/icons/rboosters.png","assets/icons/rbots.png","assets/icons/rcamera.png","assets/icons/rdevelopers.png","assets/icons/reddit.png","assets/icons/reminder.png","assets/icons/repeat.png","assets/icons/repeatonce.png","assets/icons/reply.png","assets/icons/revents.png","assets/icons/rfire.png","assets/icons/rguardians.png","assets/icons/rhelpers.png","assets/icons/richpresence.png","assets/icons/rightarrow.png","assets/icons/rmembers.png","assets/icons/rmods.png","assets/icons/roles.png","assets/icons/rowner.png","assets/icons/rpodcast.png","assets/icons/rsdonator.png","assets/icons/rspartner.png","assets/icons/rsstaffs.png","assets/icons/rstaff.png","assets/icons/rules.png","assets/icons/rverification.png","assets/icons/rverified.png","assets/icons/s.png","assets/icons/saturn.png","assets/icons/scheduleevent.png","assets/icons/screenshare.png","assets/icons/search.png","assets/icons/sentry.png","assets/icons/serverinsight.png","assets/icons/servermute.png","assets/icons/serverpartner.png","assets/icons/serververified.png","assets/icons/settings.png","assets/icons/share.png","assets/icons/she_her.png","assets/icons/shine1.png","assets/icons/shine2.png","assets/icons/shine3.png","assets/icons/shuffle.png","assets/icons/slashcmd.png","assets/icons/snapchat.png","assets/icons/snowflake.png","assets/icons/spark.png","assets/icons/speaker.png","assets/icons/speakerlock.png","assets/icons/speakerlow.png","assets/icons/speakermute.png","assets/icons/splash.png","assets/icons/spotify.png","assets/icons/stageleave.png","assets/icons/stagelocked.png","assets/icons/stagemoderator.png","assets/icons/stagemoveaudience.png","assets/icons/stagemovespeaker.png","assets/icons/stagerequesttospeak.png","assets/icons/stagerequesttospeaklist.png","assets/icons/star.png","assets/icons/startstage.png","assets/icons/statsdown.png","assets/icons/stickers.png","assets/icons/store.png","assets/icons/stream.png","assets/icons/supportscommandsbadge.png","assets/icons/supportteam.png","assets/icons/swardx.png","assets/icons/t.png","assets/icons/tada.png","assets/icons/text1.png","assets/icons/text2.png","assets/icons/text3.png","assets/icons/text4.png","assets/icons/text5.png","assets/icons/text6.png","assets/icons/they_them.png","assets/icons/threadchannel.png","assets/icons/ticket.png","assets/icons/tiktok.png","assets/icons/tilde.png","assets/icons/timeout.png","assets/icons/todolist.png","assets/icons/topgg.png","assets/icons/transferownership.png","assets/icons/transgender.png","assets/icons/translate.png","assets/icons/twitch.png","assets/icons/twitter.png","assets/icons/u.png","assets/icons/unbanmember.png","assets/icons/unlock.png","assets/icons/uparrow.png","assets/icons/update.png","assets/icons/update1.png","assets/icons/update2.png","assets/icons/updatechannel.png","assets/icons/updateemoji.png","assets/icons/updateevent.png","assets/icons/updateintegration.png","assets/icons/updatemember.png","assets/icons/updaterole.png","assets/icons/updateserver.png","assets/icons/updatestage.png","assets/icons/updatesticker.png","assets/icons/updatethread.png","assets/icons/updatewebhook.png","assets/icons/upvote.png","assets/icons/v.png","assets/icons/verified.png","assets/icons/video.png","assets/icons/view.png","assets/icons/vip.png","assets/icons/vklogo.png","assets/icons/vpn.png","assets/icons/w.png","assets/icons/warning.png","assets/icons/wave.png","assets/icons/webp.png","assets/icons/wumpus.png","assets/icons/x.png","assets/icons/xmarkwhite.png","assets/icons/y.png","assets/icons/youtube.png","assets/icons/z.png"],Fgt=document.createElement("canvas"),Dgt=Fgt.getContext("2d",{willReadFrequently:!0});class Igt extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const t=this.getAttribute("src"),e=this.getAttribute("color"),i=document.createElement("img");i.src=t,i.style.width="2em",i.style.height="2em",i.style.verticalAlign="middle",i.style.marginRight="5px",i.onload=()=>{Fgt.width=128,Fgt.height=128,Dgt.drawImage(i,0,0);const t=Dgt.getImageData(0,0,Fgt.width,Fgt.height);for(let e=0;e<t.data.length;e+=4){const i=(t.data[e]+t.data[e+1]+t.data[e+2])/3;t.data[e+3]=i<64?0:255}if(Dgt.putImageData(t,0,0),e){const[t,i,n]=function(t){const e=t.replace("#",""),i=parseInt(e,16);return[i>>16&255,i>>8&255,255&i]}(e),s=Dgt.getImageData(0,0,Fgt.width,Fgt.height);for(let e=0;e<s.data.length;e+=4)s.data[e+3]>0&&(s.data[e]=t,s.data[e+1]=i,s.data[e+2]=n);Dgt.putImageData(s,0,0)}const n=document.createElement("img");n.src=Fgt.toDataURL(),n.style.width="2em",n.style.height="2em",n.style.verticalAlign="middle",n.style.marginRight="5px",this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(n)}}}window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.deferredInstallPrompt=t}),window.addEventListener("DOMContentLoaded",async()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(t=>{console.log("Service worker registered sucessfully.")}).catch(t=>{console.error("Error registering service worker:",t)});const t=document.getElementById("loading");function i(){t.querySelector("#tip").innerHTML=function(t){return t[Math.floor(Math.random()*t.length)]}(M)}const n=setInterval(()=>i(),5e3);i(),customElements.define("canv-icon",Igt);let s=[];const r=Lgt();if(r.canvas||s.push("2D_CONTEXT_ERROR"),r.localStorage||s.push("LOCAL_STORAGE_NOT_FOUND"),r.webGL||s.push("WEBGL_CONTEXT_ERROR"),r.file||s.push("FILE_SYSTEM_ERROR"),s.length){const e=document.createElement("main");e.id="app",e.className="when-error",e.innerHTML=`\n      <main class="main">\n        <div class="header">\n          <h3>Aw man :(</h3>\n        </div>\n        <p>Your browser is not compatible with <span class="highlight">Hawk Engine</span>.</p>\n        <div class="try-footer">\n          <p>You can try:</p>                                                                        \n          <p>- <a href="/assets/wah.png">View a cute cat</a>.</p>\n        </div>\n        <br>\n        <small class="accent">${s.join(", ")}</small>\n      </main>\n    `,document.body.appendChild(e),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(n),t.remove()})}else await e.load(L,["assets/entities/bee.png","assets/fonts/at01.ttf","assets/game/props.png","assets/game/plants.png","assets/game/building.png","assets/game/terrain.png","assets/game/animated.png","assets/game/grass2.png","assets/game/dirt.png","assets/game/grass2_snow.png","assets/game/dirt_snow.png","assets/masks/lightMask.png","assets/masks/flame.png","assets/masks/candle_flame.png","assets/masks/water_foam.png","assets/masks/smoke.png","assets/masks/smoke_ramp.png","assets/masks/lightMask_o.png","assets/tilemap.png","assets/ui/main.png","assets/wah.png","styles/main.css","logo.png","logo.svg","banner.png",...Ogt],e=>{t.querySelector("#loading-bar div").style.width=e.percentage+"%"}),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(n),t.remove()}),_gt()});
