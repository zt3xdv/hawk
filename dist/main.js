function t(t){const e=t.split(","),i=e[0],n=e[1],s=-1!==i.indexOf(";base64"),r=i.match(/data:([^;]+)/),a=r?r[1]:"application/octet-stream";let o;if(s){const t=atob(n),e=t.length,i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.charCodeAt(n);o=i}else{const t=decodeURIComponent(e[1]),i=t.length,n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t.charCodeAt(e);o=n}return new Blob([o],{type:a})}function e(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(n.result),n.readAsDataURL(t)})}async function i(t){const e=new Image;return await new Promise((i,n)=>{e.onerror=()=>n(new Error("Could not load image")),e.onload=()=>i(e),e.src=t})}function n(t,e,i=128){const n=e.getContext("2d");n.clearRect(0,0,i,i);const s=t.width/t.height;let r=i,a=i;s>1?a=i/s:s<1&&(r=i*s);const o=Math.round((i-r)/2),h=Math.round((i-a)/2);n.drawImage(t,o,h,r,a)}async function s(t,e){const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await i.text().catch(()=>"");let s=null;try{s=n?JSON.parse(n):null}catch{}if(!i.ok){const t=s&&s.error||n||`HTTP ${i.status}`;throw new Error(t)}return s}function r(t){return String(t||"").replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[t]))}class a{static#t=null;static#e={};static#i=null;static#n=[];static#s=null;static#r="app-cache";static#a=1;static#o="files";static#h="meta";static#l={html:"text/html",htm:"text/html",js:"application/javascript",mjs:"application/javascript",css:"text/css",json:"application/json",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",txt:"text/plain",xml:"application/xml"};constructor(){if(a.#t)return a.#t;a.#t=this}static async#u(){return this.#s?this.#s:new Promise((t,e)=>{const i=indexedDB.open(this.#r,this.#a);i.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this.#o)||e.createObjectStore(this.#o,{keyPath:"path"}),e.objectStoreNames.contains(this.#h)||e.createObjectStore(this.#h,{keyPath:"key"})},i.onsuccess=()=>{this.#s=i.result,t(this.#s)},i.onerror=()=>e(i.error),i.onblocked=()=>{}})}static async#c(t,e,i={}){const n=await this.#u();return new Promise((s,r)=>{const a=n.transaction(this.#o,"readwrite").objectStore(this.#o),o={path:t,value:e,meta:i},h=a.put(o);h.onsuccess=()=>s(!0),h.onerror=()=>r(h.error)})}static async#d(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#o,"readonly").objectStore(this.#o).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#f(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction(this.#o,"readonly").objectStore(this.#o).getAll();n.onsuccess=()=>{const t=n.result||[],i={};for(const e of t)i[e.path]=e.value;e(i)},n.onerror=()=>i(n.error)})}static async#p(t,e){const i=await this.#u();return new Promise((n,s)=>{const r=i.transaction(this.#h,"readwrite").objectStore(this.#h).put({key:t,value:e});r.onsuccess=()=>n(!0),r.onerror=()=>s(r.error)})}static async#g(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#h,"readonly").objectStore(this.#h).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#v(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction([this.#o,this.#h],"readwrite");n.objectStore(this.#o).clear(),n.objectStore(this.#h).clear(),n.oncomplete=()=>e(!0),n.onerror=()=>i(n.error)})}static#m(t){const e=new Uint8Array(t);let i="";for(let t=0;t<e.length;t+=32768){const n=e.subarray(t,t+32768);i+=String.fromCharCode.apply(null,n)}return btoa(i)}static#y(t){if("string"!=typeof t)return!1;const e=t.replace(/\s+/g,"");return-1===e.indexOf("ï¿½")&&(e.length%4==0&&/^[A-Za-z0-9+/]+={0,2}$/.test(e))}static async load(t,e=[],i=null){if(this.#i===t)return;this.#e={},this.#n=[...e];try{await this.#u()}catch(n){return console.warn("IndexedDB unavailable, falling back to memory-only cache.",n),void await this.#x(t,e,!1,i)}if(await this.#g("version")===t)try{const n=await this.#f();let s=0;const r=e.length;for(const t of e)if(Object.prototype.hasOwnProperty.call(n,t)?this.#e[t]=n[t]:this.#e[t]=null,s++,i){i({percentage:Math.round(s/r*100),file:s,totalFiles:r})}return void(this.#i=t)}catch(n){return console.warn("Failed to read cache from DB, reloading from network.",n),void await this.#x(t,e,!0,i)}else await this.#x(t,e,!0,i)}static async#x(t,e,i=!0,n=null){let s=0;const r=e.length,a=e.map(async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const n=await e.arrayBuffer();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB:",t,e)}}catch(e){try{const e=await fetch(t);if(!e.ok)throw new Error("fallback failed");const n=await e.text();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB (text):",t,e)}}catch(e){this.#e[t]=null}}finally{if(s++,n){const t=Math.round(s/r*100);n({percentage:t,file:s,totalFiles:r})}}});if(await Promise.all(a),i)try{await this.#p("version",t)}catch(t){console.warn("Failed to write version meta to DB",t)}this.#i=t}static get(t){return t in this.#e?this.#e[t]:null}static getBlob(e,i={returnBlob:!1}){const n=this.#e[e];if(null==n)return{dataUrl:null,blob:null};const s=(e.split(".").pop()||"").toLowerCase(),r=this.#l[s]||"application/octet-stream";if("string"==typeof n&&n.startsWith("data:")){const e=n;return{dataUrl:e,blob:i.returnBlob?t(e):null}}if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)){const t=n instanceof ArrayBuffer?n:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);return{dataUrl:`data:${r};base64,${a.#m(t)}`,blob:i.returnBlob?new Blob([t],{type:r}):null}}if("string"==typeof n){const e=n.trim(),s=e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e;if(s.startsWith("data:")){const e=s;return{dataUrl:e,blob:i.returnBlob?t(e):null}}const o=s.replace(/\s+/g,"");if(this.#y(o)){const e=`data:${r};base64,${o}`;return{dataUrl:e,blob:i.returnBlob?t(e):null}}const h=(new TextEncoder).encode(s);return{dataUrl:`data:${r};base64,${a.#m(h.buffer)}`,blob:i.returnBlob?new Blob([h],{type:r+";charset=utf-8"}):null}}const o=JSON.stringify(n),h=(new TextEncoder).encode(o);return{dataUrl:`data:application/json;charset=utf-8;base64,${a.#m(h.buffer)}`,blob:i.returnBlob?new Blob([h],{type:"application/json;charset=utf-8"}):null}}static async clear(){this.#e={},this.#i=null,this.#n=[];try{await this.#v()}catch(t){console.warn("Failed to clear IndexedDB",t)}}static getVersion(){return this.#i}static getFileList(){return[...this.#n]}}function o(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function h(){return{username:localStorage.getItem("username"),password:localStorage.getItem("password")}}function l(t,e){return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})}function u(t){return Array.from(document.querySelectorAll(t))}function c(){return[{type:"image",key:"lightRadial",url:a.getBlob("assets/masks/lightMask.png").dataUrl},{type:"image",key:"wah",url:a.getBlob("assets/wah.png").dataUrl},{type:"image",key:"props",url:a.getBlob("assets/game/props.png").dataUrl},{type:"image",key:"plants",url:a.getBlob("assets/game/plants.png").dataUrl},{type:"image",key:"building",url:a.getBlob("assets/game/building.png").dataUrl},{type:"image",key:"animated",url:a.getBlob("assets/game/animated.png").dataUrl},{type:"image",key:"tilemap",url:a.getBlob("assets/tilemap.png").dataUrl},{type:"spritesheet",key:"grass2",url:a.getBlob("assets/game/grass2.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"grass",url:a.getBlob("assets/game/grass.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"dirt",url:a.getBlob("assets/game/dirt.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"flame",url:a.getBlob("assets/masks/flame.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}}]}function d(t,e){const i=t.load;for(const t of e){const{type:e,key:n,url:s}=t;"image"===e?i.image(n,s):"spritesheet"===e?i.spritesheet(n,s,t.frameConfig||{}):"audio"===e?i.audio(n,s):"json"===e?i.json(n,s):i.file(n,{type:e||"image",url:s})}}const f=3,p=32,g=3,v=16,m=8,y=16,x="/api/friends/list",w="/api/friends/requests",T="/api/friends/pending",b="/api/friends/send",S="/api/friends/cancel",E="/api/friends/accept",_="/api/friends/deny",C="/api/friends/remove",A="/api/auth/check",P="https://discord.gg/P8yrhaeCgy",M=[{name:"zt3xdv2",username:"tsumugi_dev",role:"Main Development"},{name:"Asura",username:"asurawhite_1",role:"Domain gifter :3"}],R=["You can go to <a href='/avatar'>Avatar Page</a><br>to change your game avatar, yes its customizable.","If u wanna change your username<br>go to /profile-settings and do it.","This game is written in javascript."];const L="0.0.1-beta",O="0.0.1-release",F="tsumugi_dev";class D{static queue=[];static isShowing=!1;static add(t,e,i){this.queue.push({title:t,html:e,callback:i}),this.showNext()}static showNext(){if(this.isShowing||0===this.queue.length)return;const t=this.queue.shift();this.isShowing=!0;const e=document.createElement("div");e.className="alert",e.innerHTML=`\n            <h3 class="title">${t.title}</h3>\n            <div class="content">${t.html}</div>\n            <button class="btn close-btn">Accept</button>\n        `,document.body.appendChild(e);e.querySelector(".close-btn").addEventListener("click",()=>{t.callback?t.callback():this.closeAlert(e)})}static closeAlert(t){t.classList.add("fade-out"),t.addEventListener("transitionend",()=>{t.remove(),this.isShowing=!1,this.showNext()})}}var I="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var k,B,N,U,z,Y,X,G,W,H,V,j,q,K,Z,J,$,Q,tt,et,it,nt,st,rt,at,ot,ht,lt,ut,ct,dt,ft,pt,gt,vt,mt,yt,xt,wt,Tt,bt,St,Et,_t,Ct,At,Pt,Mt,Rt,Lt,Ot,Ft,Dt,It,kt,Bt,Nt,Ut,zt,Yt,Xt,Gt,Wt,Ht,Vt,jt,qt,Kt,Zt,Jt,$t,Qt,te,ee,ie,ne,se,re,ae,oe,he,le,ue,ce,de,fe,pe,ge,ve,me,ye,xe,we,Te,be,Se,Ee,_e,Ce,Ae,Pe,Me,Re,Le,Oe,Fe,De,Ie,ke,Be,Ne,Ue,ze,Ye,Xe,Ge,We,He,Ve,je,qe,Ke,Ze,Je,$e,Qe,ti,ei,ii,ni,si,ri,ai,oi,hi,li,ui,ci,di,fi,pi,gi,vi,mi,yi,xi,wi,Ti,bi,Si,Ei,_i,Ci,Ai,Pi,Mi,Ri,Li,Oi,Fi,Di,Ii,ki,Bi,Ni,Ui,zi,Yi,Xi,Gi,Wi,Hi,Vi,ji,qi,Ki,Zi,Ji,$i,Qi,tn,en,nn,sn,rn,an,on,hn,ln,un,cn,dn,fn,pn,gn,vn,mn,yn,xn,wn,Tn,bn,Sn,En,_n,Cn,An,Pn,Mn,Rn,Ln,On,Fn,Dn,In,kn,Bn,Nn,Un,zn,Yn,Xn,Gn,Wn,Hn,Vn,jn,qn,Kn,Zn,Jn,$n,Qn,ts,es,is,ns,ss,rs,as,os,hs,ls,us,cs,ds,fs,ps,gs,vs,ms,ys,xs,ws,Ts,bs,Ss,Es,_s,Cs,As,Ps,Ms,Rs,Ls,Os,Fs,Ds,Is,ks,Bs,Ns,Us,zs,Ys,Xs,Gs,Ws,Hs,Vs,js,qs,Ks,Zs,Js,$s,Qs,tr,er,ir,nr,sr,rr,ar,or,hr,lr,ur,cr,dr,fr,pr,gr,vr,mr,yr,xr,wr,Tr,br,Sr,Er,_r,Cr,Ar,Pr,Mr,Rr,Lr,Or,Fr,Dr,Ir,kr,Br,Nr,Ur,zr,Yr,Xr,Gr,Wr,Hr,Vr,jr,qr,Kr,Zr,Jr,$r,Qr,ta,ea,ia,na,sa,ra,aa,oa,ha,la,ua,ca,da,fa,pa,ga,va,ma,ya,xa,wa,Ta,ba,Sa,Ea,_a,Ca,Aa,Pa,Ma,Ra,La,Oa,Fa,Da,Ia,ka,Ba,Na,Ua,za,Ya,Xa,Ga,Wa,Ha,Va,ja,qa,Ka,Za,Ja,$a,Qa,to,eo,io,no,so,ro,ao,oo,ho,lo,uo,co,fo,po,go,vo,mo,yo,xo,wo,To,bo,So,Eo,_o,Co,Ao,Po,Mo,Ro,Lo,Oo,Fo,Do,Io,ko,Bo,No,Uo,zo,Yo,Xo,Go,Wo,Ho,Vo,jo,qo,Ko,Zo,Jo,$o;function Qo(){return N?B:(N=1,B={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27})}function th(){return z?U:(z=1,U={DEFAULT:0,LINEAR:0,NEAREST:1})}function eh(){if(X)return Y;X=1;var t={VERSION:"3.90.0",LOG_VERSION:"v390",BlendModes:Qo(),ScaleModes:th(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};return Y=t}function ih(){return W?G:(W=1,G=function(t){if(!t||"object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0})}function nh(){if(V)return H;V=1;var t=ih(),e=function(){var i,n,s,r,a,o,h=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof h&&(c=h,h=arguments[1]||{},l=2),u===l&&(h=this,--l);l<u;l++)if(null!=(i=arguments[l]))for(n in i)s=h[n],h!==(r=i[n])&&(c&&r&&(t(r)||(a=Array.isArray(r)))?(a?(a=!1,o=s&&Array.isArray(s)?s:[]):o=s&&t(s)?s:{},h[n]=e(c,o,r)):void 0!==r&&(h[n]=r));return h};return H=e}function sh(){return q?j:(q=1,j={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12})}function rh(){return Z?K:(Z=1,K=function(t){return t.y+t.height-t.height*t.originY})}function ah(){return $?J:($=1,J=function(t){return t.x-t.width*t.originX+.5*t.width})}function oh(){return tt?Q:(tt=1,Q=function(t,e){var i=t.width*t.originX;return t.x=e+i-.5*t.width,t})}function hh(){return it?et:(it=1,et=function(t,e){return t.y=e+t.height*t.originY,t})}function lh(){if(st)return nt;st=1;var t=rh(),e=ah(),i=oh(),n=hh();return nt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function uh(){return at?rt:(at=1,rt=function(t){return t.x-t.width*t.originX})}function ch(){return ht?ot:(ht=1,ot=function(t,e){return t.x=e+t.width*t.originX,t})}function dh(){if(ut)return lt;ut=1;var t=rh(),e=uh(),i=ch(),n=hh();return lt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)-a),n(s,t(r)+o),s}}function fh(){return dt?ct:(dt=1,ct=function(t){return t.x+t.width-t.width*t.originX})}function ph(){return pt?ft:(pt=1,ft=function(t,e){return t.x=e-t.width+t.width*t.originX,t})}function gh(){if(vt)return gt;vt=1;var t=rh(),e=fh(),i=ph(),n=hh();return gt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function vh(){return yt?mt:(yt=1,mt=function(t,e){return t.y=e-t.height+t.height*t.originY,t})}function mh(){if(wt)return xt;wt=1;var t=rh(),e=uh(),i=vh(),n=ph();return xt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function yh(){return bt?Tt:(bt=1,Tt=function(t){return t.y-t.height*t.originY+.5*t.height})}function xh(){return Et?St:(Et=1,St=function(t,e){var i=t.height*t.originY;return t.y=e+i-.5*t.height,t})}function wh(){if(Ct)return _t;Ct=1;var t=yh(),e=uh(),i=xh(),n=ph();return _t=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Th(){return Pt?At:(Pt=1,At=function(t){return t.y-t.height*t.originY})}function bh(){if(Rt)return Mt;Rt=1;var t=uh(),e=Th(),i=ph(),n=hh();return Mt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function Sh(){if(Ot)return Lt;Ot=1;var t=rh(),e=fh(),i=vh(),n=ch();return Lt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Eh(){if(Dt)return Ft;Dt=1;var t=yh(),e=fh(),i=xh(),n=ch();return Ft=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function _h(){if(kt)return It;kt=1;var t=fh(),e=Th(),i=ch(),n=hh();return It=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Ch(){if(Nt)return Bt;Nt=1;var t=ah(),e=Th(),i=vh(),n=oh();return Bt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function Ah(){if(zt)return Ut;zt=1;var t=uh(),e=Th(),i=vh(),n=ch();return Ut=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)-a),i(s,e(r)-o),s}}function Ph(){if(Xt)return Yt;Xt=1;var t=fh(),e=Th(),i=vh(),n=ph();return Yt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function Mh(){if(Wt)return Gt;Wt=1;var t=sh(),e=[];return e[t.BOTTOM_CENTER]=lh(),e[t.BOTTOM_LEFT]=dh(),e[t.BOTTOM_RIGHT]=gh(),e[t.LEFT_BOTTOM]=mh(),e[t.LEFT_CENTER]=wh(),e[t.LEFT_TOP]=bh(),e[t.RIGHT_BOTTOM]=Sh(),e[t.RIGHT_CENTER]=Eh(),e[t.RIGHT_TOP]=_h(),e[t.TOP_CENTER]=Ch(),e[t.TOP_LEFT]=Ah(),e[t.TOP_RIGHT]=Ph(),Gt=function(t,i,n,s,r){return e[n](t,i,s,r)}}function Rh(){if(Vt)return Ht;Vt=1;var t=Mh();return Ht=function(e,i,n,s){for(var r=e[0],a=1;a<e.length;a++){var o=e[a];t(o,r,i,n,s),r=o}return e}}function Lh(){return qt?jt:(qt=1,jt=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]+=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]+=i+o*n,o++;return t})}function Oh(){if(Zt)return Kt;Zt=1;var t=Lh();return Kt=function(e,i,n,s,r){return t(e,"angle",i,n,s,r)}}function Fh(){if(se)return ne;se=1;var t=rh(),e=ah(),i=vh(),n=oh();return ne=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Dh(){if(ae)return re;ae=1;var t=rh(),e=uh(),i=vh(),n=ch();return re=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Ih(){if(he)return oe;he=1;var t=rh(),e=fh(),i=vh(),n=ph();return oe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function kh(){if(ue)return le;ue=1;var t=oh(),e=xh();return le=function(i,n,s){return t(i,n),e(i,s)}}function Bh(){if(de)return ce;de=1;var t=kh(),e=ah(),i=yh();return ce=function(n,s,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t(n,e(s)+r,i(s)+a),n}}function Nh(){if(pe)return fe;pe=1;var t=yh(),e=uh(),i=xh(),n=ch();return fe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Uh(){if(ve)return ge;ve=1;var t=yh(),e=fh(),i=xh(),n=ph();return ge=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function zh(){if(ye)return me;ye=1;var t=ah(),e=Th(),i=oh(),n=hh();return me=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Yh(){if(we)return xe;we=1;var t=uh(),e=Th(),i=ch(),n=hh();return xe=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function Xh(){if(be)return Te;be=1;var t=fh(),e=Th(),i=ph(),n=hh();return Te=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Gh(){if(Ee)return Se;Ee=1;var t=sh(),e=[];return e[t.BOTTOM_CENTER]=Fh(),e[t.BOTTOM_LEFT]=Dh(),e[t.BOTTOM_RIGHT]=Ih(),e[t.CENTER]=Bh(),e[t.LEFT_CENTER]=Nh(),e[t.RIGHT_CENTER]=Uh(),e[t.TOP_CENTER]=zh(),e[t.TOP_LEFT]=Yh(),e[t.TOP_RIGHT]=Xh(),e[t.LEFT_BOTTOM]=e[t.BOTTOM_LEFT],e[t.LEFT_TOP]=e[t.TOP_LEFT],e[t.RIGHT_BOTTOM]=e[t.BOTTOM_RIGHT],e[t.RIGHT_TOP]=e[t.TOP_RIGHT],Se=function(t,i,n,s,r){return e[n](t,i,s,r)}}function Wh(){return Ce?_e:(Ce=1,_e=function(t,e,i){var n=typeof t;return t&&"number"!==n&&"string"!==n&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:i})}function Hh(){return Pe?Ae:(Pe=1,Ae=function(){})}function Vh(){if(Re)return Me;function t(t,e,i){var n=i?t[e]:Object.getOwnPropertyDescriptor(t,e);return!i&&n.value&&"object"==typeof n.value&&(n=n.value),!(!n||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(n))&&(void 0===n.enumerable&&(n.enumerable=!0),void 0===n.configurable&&(n.configurable=!0),n)}function e(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!!i&&(i.value&&"object"==typeof i.value&&(i=i.value),!1===i.configurable)}function i(i,n,r,a){for(var o in n)if(n.hasOwnProperty(o)){var h=t(n,o,r);if(!1!==h){if(e((a||i).prototype,o)){if(s.ignoreFinals)continue;throw new Error("cannot override final property '"+o+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(i.prototype,o,h)}else i.prototype[o]=n[o]}}function n(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)i(t,e[n].prototype||e[n])}}function s(t){var e,s;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var r=t.Extends;e=function(){r.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,s=t.Extends,delete t.Extends):e.prototype.constructor=e;var a=null;return t.Mixins&&(a=t.Mixins,delete t.Mixins),n(e,a),i(e,t,!0,s),e}return Re=1,s.extend=i,s.mixin=n,s.ignoreFinals=!1,Me=s}function jh(){return Oe||(Oe=1,Le=function(t,e,i){return t.radius>0&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-i)*(t.y-i)<=t.radius*t.radius}),Le}function qh(){return De?Fe:(De=1,Fe={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6})}function Kh(){if(ke)return Ie;ke=1;var t=Vh(),e=qh(),i=new t({initialize:function(t,i){void 0===t&&(t=0),void 0===i&&(i=t),this.type=e.POINT,this.x=t,this.y=i},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});return Ie=i}function Zh(){if(Ne)return Be;Ne=1;var t=Kh();return Be=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x+e.radius*Math.cos(i),n.y=e.y+e.radius*Math.sin(i),n},Be}function Jh(){return ze?Ue:(ze=1,Ue=function(t,e,i){return Math.max(e,Math.min(i,t))})}function $h(){if(Xe)return Ye;Xe=1;var t=Jh();return Ye=function(e,i,n){return(n-i)*(e=t(e,0,1))+i}}function Qh(){if(We)return Ge;We=1;var t={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};return Ge=t}function tl(){if(Ve)return He;Ve=1;var t=Zh(),e=$h(),i=Qh(),n=Kh();return He=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},He}function el(){return qe||(qe=1,je=function(t){return Math.PI*t.radius*2}),je}function il(){if(Ze)return Ke;Ze=1;var t=el(),e=Zh(),i=$h(),n=Qh();return Ke=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},Ke}function nl(){if($e)return Je;$e=1;var t=Kh();return Je=function(e,i){void 0===i&&(i=new t);var n=2*Math.PI*Math.random(),s=Math.random()+Math.random(),r=s>1?2-s:s,a=r*Math.cos(n),o=r*Math.sin(n);return i.x=e.x+a*e.radius,i.y=e.y+o*e.radius,i},Je}function sl(){if(ti)return Qe;ti=1;var t=Vh(),e=jh(),i=tl(),n=il(),s=qh(),r=nl(),a=new t({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.type=s.CIRCLE,this.x=t,this.y=e,this._radius=i,this._diameter=2*i},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i){return this.x=t,this.y=e,this._radius=i,this._diameter=2*i,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});return Qe=a}function rl(){if(ii)return ei;ii=1;var t=Jh();return ei={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(e,i,n,s){return void 0===e&&(e=1),void 0===i?this.alpha=e:(this._alphaTL=t(e,0,1),this._alphaTR=t(i,0,1),this._alphaBL=t(n,0,1),this._alphaBR=t(s,0,1)),this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,this._alphaTL=i,this._alphaTR=i,this._alphaBL=i,this._alphaBR=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(e){var i=t(e,0,1);this._alphaTL=i,0!==i&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(e){var i=t(e,0,1);this._alphaTR=i,0!==i&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(e){var i=t(e,0,1);this._alphaBL=i,0!==i&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(e){var i=t(e,0,1);this._alphaBR=i,0!==i&&(this.renderFlags|=2)}}}}function al(){if(si)return ni;si=1;var t=Jh();return ni={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}}}}function ol(){if(ai)return ri;ai=1;var t=Qo(),e={_blendMode:t.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(e){"string"==typeof e&&(e=t[e]),(e|=0)>=-1&&(this._blendMode=e)}},setBlendMode:function(t){return this.blendMode=t,this}};return ri=e}function hl(){return di||(di=1,ci=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))return!1;for(var e=t[0].length,i=1;i<t.length;i++)if(t[i].length!==e)return!1;return!0}),ci}function ll(){return pi?fi:(pi=1,fi=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=" "),void 0===n&&(n=3);var s=0;if(e+1>=(t=t.toString()).length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var r=Math.ceil((s=e-t.length)/2);t=new Array(s-r+1).join(i)+t+new Array(r+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t})}function ul(){if(vi)return gi;vi=1;var t=ll(),e=hl();return gi=function(i){var n="";if(!e(i))return n;for(var s=0;s<i.length;s++){for(var r=0;r<i[s].length;r++){var a=i[s][r].toString();n+="undefined"!==a?t(a,2):"?",r<i[s].length-1&&(n+=" |")}if(s<i.length-1){n+="\n";for(var o=0;o<i[s].length;o++)n+="---",o<i[s].length-1&&(n+="+");n+="\n"}}return n},gi}function cl(){return bi||(bi=1,Ti=function(t){for(var e=t.length,i=t[0].length,n=new Array(i),s=0;s<i;s++){n[s]=new Array(e);for(var r=e-1;r>-1;r--)n[s][r]=t[r][s]}return n}),Ti}function dl(){if(Ei)return Si;Ei=1;var t=hl(),e=cl();return Si=function(i,n){if(void 0===n&&(n=90),!t(i))return null;if("string"!=typeof n&&(n=(n%360+360)%360),90===n||-270===n||"rotateLeft"===n)(i=e(i)).reverse();else if(-90===n||270===n||"rotateRight"===n)i.reverse(),i=e(i);else if(180===Math.abs(n)||"rotate180"===n){for(var s=0;s<i.length;s++)i[s].reverse();i.reverse()}return i},Si}function fl(){if(Ci)return _i;Ci=1;var t=dl();return _i=function(e){return t(e,180)},_i}function pl(){if(Pi)return Ai;Pi=1;var t=dl();return Ai=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,90);return e},Ai}function gl(){if(Ri)return Mi;Ri=1;var t=dl();return Mi=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,-90);return e},Mi}function vl(){return Oi||(Oi=1,Li=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.shift(),t.push(i);return i}),Li}function ml(){return Di||(Di=1,Fi=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.pop(),t.unshift(i);return i}),Fi}function yl(){if(ki)return Ii;ki=1;var t=vl(),e=ml();return Ii=function(i,n,s){if(void 0===n&&(n=0),void 0===s&&(s=0),0!==s&&(s<0?t(i,Math.abs(s)):e(i,s)),0!==n)for(var r=0;r<i.length;r++){var a=i[r];n<0?t(a,Math.abs(n)):e(a,n)}return i},Ii}function xl(){return Vi||(Vi=1,Hi=function(t,e,i,n){var s=t.length;if(e<0||e>=s||e>=i||i>s){if(n)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}),Hi}function wl(){if(qi)return ji;qi=1;var t=xl();return ji=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=0;if(t(e,s,r))for(var o=s;o<r;o++)e[o][i]===n&&a++;return a},ji}function Tl(){return Zi||(Zi=1,Ki=function(t,e,i){var n,s=[null];for(n=3;n<arguments.length;n++)s.push(arguments[n]);for(n=0;n<t.length;n++)s[0]=t[n],e.apply(i,s);return t}),Ki}function bl(){if($i)return Ji;$i=1;var t=xl();return Ji=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r)){var a,o=[null];for(a=5;a<arguments.length;a++)o.push(arguments[a]);for(a=s;a<r;a++)o[0]=e[a],i.apply(n,o)}return e},Ji}function Sl(){return tn||(tn=1,Qi=function(t,e,i){if(!e.length)return NaN;if(1===e.length)return e[0];var n,s,r=1;if(i){if(t<e[0][i])return e[0];for(;e[r][i]<t;)r++}else for(;e[r]<t;)r++;return r>e.length&&(r=e.length),i?(n=e[r-1][i],(s=e[r][i])-t<=t-n?e[r]:e[r-1]):(n=e[r-1],(s=e[r])-t<=t-n?s:n)}),Qi}function El(){if(nn)return en;nn=1;var t=function(e,i){void 0===i&&(i=[]);for(var n=0;n<e.length;n++)Array.isArray(e[n])?t(e[n],i):i.push(e[n]);return i};return en=t}function _l(){if(rn)return sn;rn=1;var t=xl();return sn=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=[];if(t(e,s,r))for(var o=s;o<r;o++){var h=e[o];(!i||i&&void 0===n&&h.hasOwnProperty(i)||i&&void 0!==n&&h[i]===n)&&a.push(h)}return a},sn}function Cl(){if(on)return an;on=1;var t=xl();return an=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),-1!==s){if(t(e,s,r))for(var a=s;a<r;a++){var o=e[a];if(!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o}}else if(t(e,0,r))for(a=r;a>=0;a--)if(o=e[a],!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o;return null},an}function Al(){return ln||(ln=1,hn=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length);var n=e+Math.floor(Math.random()*i);return void 0===t[n]?null:t[n]}),hn}function Pl(){return Tn?wn:(Tn=1,wn=function(t,e,i,n){var s,r=[],a=!1;if((i||n)&&(a=!0,i||(i=""),n||(n="")),e<t)for(s=t;s>=e;s--)a?r.push(i+s.toString()+n):r.push(s);else for(s=t;s<=e;s++)a?r.push(i+s.toString()+n):r.push(s);return r})}function Ml(){return Sn?bn:(Sn=1,bn=function(t){return t>0?Math.ceil(t):Math.floor(t)})}function Rl(){if(_n)return En;_n=1;var t=Ml();return En=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=1),null===i&&(i=e,e=0);for(var s=[],r=Math.max(t((i-e)/(n||1)),0),a=0;a<r;a++)s.push(e),e+=n;return s}}function Ll(){if(An)return Cn;function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}An=1;var i=function(n,s,r,a,o){for(void 0===r&&(r=0),void 0===a&&(a=n.length-1),void 0===o&&(o=e);a>r;){if(a-r>600){var h=a-r+1,l=s-r+1,u=Math.log(h),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(h-c)/h)*(l-h/2<0?-1:1),f=Math.max(r,Math.floor(s-l*c/h+d)),p=Math.min(a,Math.floor(s+(h-l)*c/h+d));i(n,s,f,p,o)}var g=n[s],v=r,m=a;for(t(n,r,s),o(n[a],g)>0&&t(n,r,a);v<m;){for(t(n,v,m),v++,m--;o(n[v],g)<0;)v++;for(;o(n[m],g)>0;)m--}0===o(n[r],g)?t(n,r,m):t(n,++m,a),m<=s&&(r=m+1),s<=m&&(a=m-1)}};return Cn=i}function Ol(){return Mn?Pn:(Mn=1,Pn=function(t,e,i,n){if(!t&&!n||"number"==typeof t)return i;if(t&&t.hasOwnProperty(e))return t[e];if(n&&n.hasOwnProperty(e))return n[e];if(-1!==e.indexOf(".")){for(var s=e.split("."),r=t,a=n,o=i,h=i,l=!0,u=!0,c=0;c<s.length;c++)r&&r.hasOwnProperty(s[c])?(o=r[s[c]],r=r[s[c]]):l=!1,a&&a.hasOwnProperty(s[c])?(h=a[s[c]],a=a[s[c]]):u=!1;return l?o:u?h:i}return i})}function Fl(){return Ln||(Ln=1,Rn=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t}),Rn}function Dl(){if(Fn)return On;Fn=1;var t=Ol(),e=Fl(),i=function(t,e,i){for(var n=[],s=0;s<t.length;s++)for(var r=0;r<e.length;r++)for(var a=0;a<i;a++)n.push({a:t[s],b:e[r]});return n};return On=function(n,s,r){var a=t(r,"max",0),o=t(r,"qty",1),h=t(r,"random",!1),l=t(r,"randomB",!1),u=t(r,"repeat",0),c=t(r,"yoyo",!1),d=[];if(l&&e(s),-1===u)if(0===a)u=0;else{var f=n.length*s.length*o;c&&(f*=2),u=Math.ceil(a/f)}for(var p=0;p<=u;p++){var g=i(n,s,o);h&&e(g),d=d.concat(g),c&&(g.reverse(),d=d.concat(g))}return a&&d.splice(a),d}}function Il(){return In||(In=1,Dn=function(t,e){if(!(e>=t.length)){for(var i=t.length-1,n=t[e],s=e;s<i;s++)t[s]=t[s+1];return t.length=i,n}}),Dn}function kl(){if(Bn)return kn;Bn=1;var t=Il();return kn=function(e,i,n,s){var r;if(void 0===s&&(s=e),!Array.isArray(i))return-1!==(r=e.indexOf(i))?(t(e,r),n&&n.call(s,i),i):null;for(var a=i.length-1,o=[];a>=0;){var h=i[a];-1!==(r=e.indexOf(h))&&(t(e,r),o.push(h),n&&n.call(s,h)),a--}return o},kn}function Bl(){if(Un)return Nn;Un=1;var t=Il();return Nn=function(e,i,n,s){if(void 0===s&&(s=e),i<0||i>e.length-1)throw new Error("Index out of bounds");var r=t(e,i);return n&&n.call(s,r),r},Nn}function Nl(){if(Yn)return zn;Yn=1;var t=xl();return zn=function(e,i,n,s,r){if(void 0===i&&(i=0),void 0===n&&(n=e.length),void 0===r&&(r=e),t(e,i,n)){var a=n-i,o=e.splice(i,a);if(s)for(var h=0;h<o.length;h++){var l=o[h];s.call(r,l)}return o}return[]},zn}function Ul(){if(Gn)return Xn;Gn=1;var t=Il();return Xn=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);var s=i+Math.floor(Math.random()*n);return t(e,s)},Xn}function zl(){if(Kn)return qn;Kn=1;var t=xl();return qn=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r))for(var a=s;a<r;a++){var o=e[a];o.hasOwnProperty(i)&&(o[i]=n)}return e},qn}function Yl(){return Jn||(Jn=1,Zn=function(t){var e=/\D/g;return t.sort(function(t,i){return parseInt(t.replace(e,""),10)-parseInt(i.replace(e,""),10)}),t}),Zn}function Xl(){if(Qn)return $n;Qn=1;var t={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};return $n=function(){if("function"==typeof importScripts)return t;var e=navigator.userAgent;/Windows/.test(e)?t.windows=!0:/Mac OS/.test(e)&&!/like Mac OS/.test(e)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(t.iOS=!0,t.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),t.iOSVersion=parseInt(RegExp.$1,10)):t.macOS=!0:/Android/.test(e)?t.android=!0:/Linux/.test(e)?t.linux=!0:/iP[ao]d|iPhone/i.test(e)?(t.iOS=!0,navigator.appVersion.match(/OS (\d+)/),t.iOSVersion=parseInt(RegExp.$1,10),t.iPhone=-1!==e.toLowerCase().indexOf("iphone"),t.iPad=-1!==e.toLowerCase().indexOf("ipad")):/Kindle/.test(e)||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)?t.kindle=!0:/CrOS/.test(e)&&(t.chromeOS=!0),(/Windows Phone/i.test(e)||/IEMobile/i.test(e))&&(t.android=!1,t.iOS=!1,t.macOS=!1,t.windows=!0,t.windowsPhone=!0);var i=/Silk/.test(e);return(t.windows||t.macOS||t.linux&&!i||t.chromeOS)&&(t.desktop=!0),(t.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(t.desktop=!1),navigator.standalone&&(t.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(t.cordova=!0),void 0!==window.ejecta&&(t.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(t.node=!0),t.node&&"object"==typeof process.versions&&(t.nodeWebkit=!!process.versions["node-webkit"],t.electron=!!process.versions.electron),/Crosswalk/.test(e)&&(t.crosswalk=!0),t.pixelRatio=window.devicePixelRatio||1,t}()}function Gl(){if(es)return ts;es=1;var t=Xl(),e={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};return ts=function(){var i=navigator.userAgent;return/Edg\/\d+/.test(i)?(e.edge=!0,e.es2019=!0):/OPR/.test(i)?(e.opera=!0,e.es2019=!0):/Chrome\/(\d+)/.test(i)&&!t.windowsPhone?(e.chrome=!0,e.chromeVersion=parseInt(RegExp.$1,10),e.es2019=e.chromeVersion>69):/Firefox\D+(\d+)/.test(i)?(e.firefox=!0,e.firefoxVersion=parseInt(RegExp.$1,10),e.es2019=e.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(i)&&t.iOS?(e.mobileSafari=!0,e.es2019=!0):/MSIE (\d+\.\d+);/.test(i)?(e.ie=!0,e.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(i)&&!t.windowsPhone?(e.safari=!0,e.safariVersion=parseInt(RegExp.$1,10),e.es2019=e.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(i)&&(e.ie=!0,e.trident=!0,e.tridentVersion=parseInt(RegExp.$1,10),e.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(i)&&(e.silk=!0),e}()}function Wl(){if(ns)return is;ns=1;var t,e="";return is={disable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!1),i},enable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!0),i},getPrefix:t=function(t){for(var e=["i","webkitI","msI","mozI","oI"],i=0;i<e.length;i++){var n=e[i]+"mageSmoothingEnabled";if(n in t)return n}return null},isEnabled:function(t){return null!==e?t[e]:null}}}function Hl(){if(rs)return ss;rs=1;var t,e,i,n=eh(),s=Wl(),r=[],a=!1;return t=function(t,i,o,h,l){var u;void 0===i&&(i=1),void 0===o&&(o=1),void 0===h&&(h=n.CANVAS),void 0===l&&(l=!1);var c=e(h);return null===c?(c={parent:t,canvas:document.createElement("canvas"),type:h},h===n.CANVAS&&r.push(c),u=c.canvas):(c.parent=t,u=c.canvas),l&&(c.parent=u),u.width=i,u.height=o,a&&h===n.CANVAS&&s.disable(u.getContext("2d",{willReadFrequently:!1})),u},e=function(t){if(void 0===t&&(t=n.CANVAS),t===n.WEBGL)return null;for(var e=0;e<r.length;e++){var i=r[e];if(!i.parent&&i.type===t)return i}return null},i=function(){var t=0;return r.forEach(function(e){e.parent&&t++}),t},ss={create2D:function(e,i,s){return t(e,i,s,n.CANVAS)},create:t,createWebGL:function(e,i,s){return t(e,i,s,n.WEBGL)},disableSmoothing:function(){a=!0},enableSmoothing:function(){a=!1},first:e,free:function(){return r.length-i()},pool:r,remove:function(t){var e=t instanceof HTMLCanvasElement;r.forEach(function(i){(e&&i.canvas===t||!e&&i.parent===t)&&(i.parent=null,i.canvas.width=1,i.canvas.height=1)})},total:i},ss}function Vl(){if(os)return as;os=1;var t=Xl(),e=Gl(),i=Hl(),n={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};return as=function(){if("function"==typeof importScripts)return n;n.canvas=!!window.CanvasRenderingContext2D;try{n.localStorage=!!localStorage.getItem}catch(t){n.localStorage=!1}n.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),n.fileSystem=!!window.requestFileSystem;var s=!1;return n.webGL=function(){if(window.WebGLRenderingContext)try{var t=i.createWebGL(this),e=t.getContext("webgl")||t.getContext("experimental-webgl"),n=i.create2D(this),r=n.getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return s=r.data instanceof Uint8ClampedArray,i.remove(t),i.remove(n),!!e}catch(t){return!1}return!1}(),n.worker=!!window.Worker,n.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,n.getUserMedia=n.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,e.firefox&&e.firefoxVersion<21&&(n.getUserMedia=!1),!t.iOS&&(e.ie||e.firefox||e.chrome)&&(n.canvasBitBltShift=!0),(e.safari||e.mobileSafari)&&(n.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(n.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(n.littleEndian=function(){var t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===i[0]||2712847316!==i[0]&&null}()),n.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==n.littleEndian&&s,n}(),as}function jl(){if(ls)return hs;ls=1;var t=Gl(),e={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};return"function"==typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(e.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(e.mspointer=!0),navigator.getGamepads&&(e.gamepads=!0),"onwheel"in window||t.ie&&"WheelEvent"in window?e.wheelEvent="wheel":"onmousewheel"in window?e.wheelEvent="mousewheel":t.firefox&&"MouseScrollEvent"in window&&(e.wheelEvent="DOMMouseScroll")),hs=e}function ql(){if(cs)return us;cs=1;var t=Gl(),e={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};return us=function(){if("function"==typeof importScripts)return e;e.audioData=!!window.Audio,e.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var i=document.createElement("audio"),n=!!i.canPlayType;try{if(n){var s=function(t,e){var n=i.canPlayType("audio/"+t).replace(/^no$/,"");return e?Boolean(n||i.canPlayType("audio/"+e).replace(/^no$/,"")):Boolean(n)};if(e.ogg=s('ogg; codecs="vorbis"'),e.opus=s('ogg; codecs="opus"',"opus"),e.mp3=s("mpeg"),e.wav=s("wav"),e.m4a=s("x-m4a"),e.aac=s("aac"),e.flac=s("flac","x-flac"),e.webm=s('webm; codecs="vorbis"'),""!==i.canPlayType('audio/mp4; codecs="ec-3"'))if(t.edge)e.dolby=!0;else if(t.safari&&t.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var r=parseInt(RegExp.$1,10),a=parseInt(RegExp.$2,10);(10===r&&a>=11||r>10)&&(e.dolby=!0)}}}catch(t){}return e}()}function Kl(){if(fs)return ds;fs=1;var t=Wh(),e={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};return ds=function(){if("function"==typeof importScripts)return e;var i=document.createElement("video"),n=!!i.canPlayType,s=/^no$/;try{n&&(i.canPlayType('video/ogg; codecs="theora"').replace(s,"")&&(e.ogg=!0),i.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(s,"")&&(e.h264=!0,e.mp4=!0),i.canPlayType("video/x-m4v").replace(s,"")&&(e.m4v=!0),i.canPlayType('video/webm; codecs="vp8, vorbis"').replace(s,"")&&(e.webm=!0),i.canPlayType('video/webm; codecs="vp9"').replace(s,"")&&(e.vp9=!0),i.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(s,"")&&(e.hls=!0))}catch(t){}return i.parentNode&&i.parentNode.removeChild(i),e.getVideoURL=function(i){Array.isArray(i)||(i=[i]);for(var n=0;n<i.length;n++){var s,r=t(i[n],"url",i[n]);if(0===r.indexOf("blob:"))return{url:r,type:""};if(s=0===r.indexOf("data:")?r.split(",")[0].match(/\/(.*?);/):r.match(/\.([a-zA-Z0-9]+)($|\?)/),s=t(i[n],"type",s?s[1]:"").toLowerCase(),e[s])return{url:r,type:s}}return null},e}()}function Zl(){if(gs)return ps;gs=1;var t={available:!1,cancel:"",keyboard:!1,request:""};return ps=function(){if("function"==typeof importScripts)return t;var e,i="Fullscreen",n="FullScreen",s=["request"+i,"request"+n,"webkitRequest"+i,"webkitRequest"+n,"msRequest"+i,"msRequest"+n,"mozRequest"+n,"mozRequest"+i];for(e=0;e<s.length;e++)if(document.documentElement[s[e]]){t.available=!0,t.request=s[e];break}var r=["cancel"+n,"exit"+i,"webkitCancel"+n,"webkitExit"+i,"msCancel"+n,"msExit"+i,"mozCancel"+n,"mozExit"+i];if(t.available)for(e=0;e<r.length;e++)if(document[r[e]]){t.cancel=r[e];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(t.keyboard=!0),Object.defineProperty(t,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),t}()}function Jl(){if(ms)return vs;ms=1;var t=Hl(),e={supportInverseAlpha:!1,supportNewBlendModes:!1};return"function"!=typeof importScripts&&void 0!==document&&(e.supportNewBlendModes=function(){var i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",n="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",s=new Image;return s.onload=function(){var r=new Image;r.onload=function(){var i=t.create2D(r,6).getContext("2d",{willReadFrequently:!0});if(i.globalCompositeOperation="multiply",i.drawImage(s,0,0),i.drawImage(r,2,0),!i.getImageData(2,0,1,1))return!1;var n=i.getImageData(2,0,1,1).data;t.remove(r),e.supportNewBlendModes=255===n[0]&&0===n[1]&&0===n[2]},r.src=i+"/wCKxvRF"+n},s.src=i+"AP804Oa6"+n,!1}(),e.supportInverseAlpha=function(){var e=t.create2D(this,2).getContext("2d",{willReadFrequently:!0});e.fillStyle="rgba(10, 20, 30, 0.5)",e.fillRect(0,0,1,1);var i=e.getImageData(0,0,1,1);if(null===i)return!1;e.putImageData(i,1,0);var n=e.getImageData(1,0,1,1),s=n.data[0]===i.data[0]&&n.data[1]===i.data[1]&&n.data[2]===i.data[2]&&n.data[3]===i.data[3];return t.remove(this),s}()),vs=e}function $l(){return xs?ys:(xs=1,ys={os:Xl(),browser:Gl(),features:Vl(),input:jl(),audio:ql(),video:Kl(),fullscreen:Zl(),canvasFeatures:Jl()})}function Ql(){if(Ts)return ws;Ts=1;var t=$l();function e(t,e){return String(t).localeCompare(e)}function i(t,e,i,n){var s,r,a,o,h,l=t.length,u=0,c=2*i;for(s=0;s<l;s+=c)for(a=(r=s+i)+i,r>l&&(r=l),a>l&&(a=l),o=s,h=r;;)if(o<r&&h<a)e(t[o],t[h])<=0?n[u++]=t[o++]:n[u++]=t[h++];else if(o<r)n[u++]=t[o++];else{if(!(h<a))break;n[u++]=t[h++]}}return ws=function(n,s){if(void 0===s&&(s=e),!n||n.length<2)return n;if(t.features.stableSort)return n.sort(s);var r=function(t,e){var n=t.length;if(n<=1)return t;for(var s=new Array(n),r=1;r<n;r*=2){i(t,e,r,s);var a=t;t=s,s=a}return t}(n,s);return r!==n&&i(r,null,n.length,n),n},ws}function tu(){return _s?Es:(_s=1,Es={Matrix:Ni?Bi:(Ni=1,Bi={CheckMatrix:hl(),MatrixToString:ul(),ReverseColumns:(yi||(yi=1,mi=function(t){return t.reverse()}),mi),ReverseRows:(wi||(wi=1,xi=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t}),xi),Rotate180:fl(),RotateLeft:pl(),RotateMatrix:dl(),RotateRight:gl(),Translate:yl(),TransposeMatrix:cl()}),Add:(zi||(zi=1,Ui=function(t,e,i,n,s){if(void 0===s&&(s=t),i>0){var r=i-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),n&&n.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.splice(a,1),a--;if(0===(a=e.length))return null;i>0&&a>r&&(e.splice(r),a=r);for(var o=0;o<a;o++){var h=e[o];t.push(h),n&&n.call(s,h)}return e}),Ui),AddAt:(Xi||(Xi=1,Yi=function(t,e,i,n,s,r){if(void 0===i&&(i=0),void 0===r&&(r=t),n>0){var a=n-t.length;if(a<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(i,0,e),s&&s.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.pop(),o--;if(0===(o=e.length))return null;n>0&&o>a&&(e.splice(a),o=a);for(var h=o-1;h>=0;h--){var l=e[h];t.splice(i,0,l),s&&s.call(r,l)}return e}),Yi),BringToTop:(Wi||(Wi=1,Gi=function(t,e){var i=t.indexOf(e);return-1!==i&&i<t.length&&(t.splice(i,1),t.push(e)),e}),Gi),CountAllMatching:wl(),Each:Tl(),EachInRange:bl(),FindClosestInSorted:Sl(),Flatten:El(),GetAll:_l(),GetFirst:Cl(),GetRandom:Al(),MoveDown:(cn||(cn=1,un=function(t,e){var i=t.indexOf(e);if(i>0){var n=t[i-1],s=t.indexOf(n);t[i]=n,t[s]=e}return t}),un),MoveTo:(fn||(fn=1,dn=function(t,e,i){var n=t.indexOf(e);if(-1===n||i<0||i>=t.length)throw new Error("Supplied index out of bounds");return n!==i&&(t.splice(n,1),t.splice(i,0,e)),e}),dn),MoveUp:(gn||(gn=1,pn=function(t,e){var i=t.indexOf(e);if(-1!==i&&i<t.length-1){var n=t[i+1],s=t.indexOf(n);t[i]=n,t[s]=e}return t}),pn),MoveAbove:(mn||(mn=1,vn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n>s||(t.splice(n,1),s=t.indexOf(i),t.splice(s+1,0,e)),t}),vn),MoveBelow:(xn||(xn=1,yn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n<s||(t.splice(n,1),0===s?t.unshift(e):t.splice(s,0,e)),t}),yn),NumberArray:Pl(),NumberArrayStep:Rl(),QuickSelect:Ll(),Range:Dl(),Remove:kl(),RemoveAt:Bl(),RemoveBetween:Nl(),RemoveRandomElement:Ul(),Replace:(Hn||(Hn=1,Wn=function(t,e,i){var n=t.indexOf(e),s=t.indexOf(i);return-1!==n&&-1===s&&(t[n]=i,!0)}),Wn),RotateLeft:vl(),RotateRight:ml(),SafeRange:xl(),SendToBack:(jn||(jn=1,Vn=function(t,e){var i=t.indexOf(e);return-1!==i&&i>0&&(t.splice(i,1),t.unshift(e)),e}),Vn),SetAll:zl(),Shuffle:Fl(),SortByDigits:Yl(),SpliceOne:Il(),StableSort:Ql(),Swap:(Ss||(Ss=1,bs=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return t[n]=i,t[s]=e,t}),bs)})}function eu(){if(As)return Cs;As=1;var t=tu();return Cs={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this},setToTop:function(){var e=this.getDisplayList();return e&&t.BringToTop(e,this),this},setToBack:function(){var e=this.getDisplayList();return e&&t.SendToBack(e,this),this},setAbove:function(e){var i=this.getDisplayList();return i&&e&&t.MoveAbove(i,this,e),this},setBelow:function(e){var i=this.getDisplayList();return i&&e&&t.MoveBelow(i,this,e),this}}}function iu(){return Ls?Rs:(Ls=1,Rs={GLOW:4,SHADOW:5,PIXELATE:6,VIGNETTE:7,SHINE:8,BLUR:9,GRADIENT:12,BLOOM:13,COLOR_MATRIX:14,CIRCLE:15,BARREL:16,DISPLACEMENT:17,WIPE:18,BOKEH:19})}function nu(){if(Fs)return Os;Fs=1;var t=new(Vh())({initialize:function(t,e){this.type=t,this.gameObject=e,this.active=!0},setActive:function(t){return this.active=t,this},destroy:function(){this.gameObject=null,this.active=!1}});return Os=t}function su(){if(Is)return Ds;Is=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.BARREL,t),this.amount=n}});return Ds=n}function ru(){if(Bs)return ks;Bs=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=1),void 0===o&&(o=1),void 0===h&&(h=4),e.call(this,i.BLOOM,t),this.steps=h,this.offsetX=s,this.offsetY=r,this.blurStrength=a,this.strength=o,this.glcolor=[1,1,1],null!=n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return ks=n}function au(){if(Us)return Ns;Us=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===n&&(n=0),void 0===s&&(s=2),void 0===r&&(r=2),void 0===a&&(a=1),void 0===h&&(h=4),e.call(this,i.BLUR,t),this.quality=n,this.x=s,this.y=r,this.steps=h,this.strength=a,this.glcolor=[1,1,1],null!=o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Ns=n}function ou(){if(Ys)return zs;Ys=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=.5),void 0===s&&(s=1),void 0===r&&(r=.2),void 0===a&&(a=!1),void 0===o&&(o=1),void 0===h&&(h=1),void 0===l&&(l=1),e.call(this,i.BOKEH,t),this.radius=n,this.amount=s,this.contrast=r,this.isTiltShift=a,this.strength=l,this.blurX=o,this.blurY=h}});return zs=n}function hu(){if(Gs)return Xs;Gs=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o){void 0===n&&(n=8),void 0===a&&(a=1),void 0===o&&(o=.005),e.call(this,i.CIRCLE,t),this.scale=a,this.feather=o,this.thickness=n,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],null!=s&&(this.color=s),null!=r&&(this.backgroundColor=r)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundColor:{get:function(){var t=this.glcolor2;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor2;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundAlpha:{get:function(){return this.glcolor2[3]},set:function(t){this.glcolor2[3]=t}}});return Xs=n}function lu(){if(Hs)return Ws;Hs=1;var t=Vh(),e=new Float32Array(20),i=new t({initialize:function(){this._matrix=new Float32Array(20),this.alpha=1,this._dirty=!0,this._data=new Float32Array(20),this.reset()},set:function(t){return this._matrix.set(t),this._dirty=!0,this},reset:function(){var t=this._matrix;return t.fill(0),t[0]=1,t[6]=1,t[12]=1,t[18]=1,this.alpha=1,this._dirty=!0,this},getData:function(){var t=this._data;return this._dirty&&(t.set(this._matrix),t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,this._dirty=!1),t},brightness:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t;return this.multiply([i,0,0,0,0,0,i,0,0,0,0,0,i,0,0,0,0,0,1,0],e)},saturate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=2*t/3+1,n=-.5*(i-1);return this.multiply([i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0],e)},desaturate:function(t){return void 0===t&&(t=!1),this.saturate(-1,t)},hue:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),t=t/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),s=.213,r=.715,a=.072;return this.multiply([s+.787*i+n*-s,r+i*-r+n*-r,a+i*-a+.928*n,0,0,s+i*-s+.143*n,r+i*(1-r)+.14*n,a+i*-a+-.283*n,0,0,s+i*-s+-.787*n,r+i*-r+n*r,a+.928*i+n*a,0,0,0,0,0,1,0],e)},grayscale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!1),this.saturate(-t,e)},blackWhite:function(t){return void 0===t&&(t=!1),this.multiply(i.BLACK_WHITE,t)},contrast:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t+1,n=-.5*(i-1);return this.multiply([i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0],e)},negative:function(t){return void 0===t&&(t=!1),this.multiply(i.NEGATIVE,t)},desaturateLuminance:function(t){return void 0===t&&(t=!1),this.multiply(i.DESATURATE_LUMINANCE,t)},sepia:function(t){return void 0===t&&(t=!1),this.multiply(i.SEPIA,t)},night:function(t,e){return void 0===t&&(t=.1),void 0===e&&(e=!1),this.multiply([-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},lsd:function(t){return void 0===t&&(t=!1),this.multiply(i.LSD,t)},brown:function(t){return void 0===t&&(t=!1),this.multiply(i.BROWN,t)},vintagePinhole:function(t){return void 0===t&&(t=!1),this.multiply(i.VINTAGE,t)},kodachrome:function(t){return void 0===t&&(t=!1),this.multiply(i.KODACHROME,t)},technicolor:function(t){return void 0===t&&(t=!1),this.multiply(i.TECHNICOLOR,t)},polaroid:function(t){return void 0===t&&(t=!1),this.multiply(i.POLAROID,t)},shiftToBGR:function(t){return void 0===t&&(t=!1),this.multiply(i.SHIFT_BGR,t)},multiply:function(t,i){void 0===i&&(i=!1),i||this.reset();var n=this._matrix,s=e;return s.set(n),n.set([s[0]*t[0]+s[1]*t[5]+s[2]*t[10]+s[3]*t[15],s[0]*t[1]+s[1]*t[6]+s[2]*t[11]+s[3]*t[16],s[0]*t[2]+s[1]*t[7]+s[2]*t[12]+s[3]*t[17],s[0]*t[3]+s[1]*t[8]+s[2]*t[13]+s[3]*t[18],s[0]*t[4]+s[1]*t[9]+s[2]*t[14]+s[3]*t[19]+s[4],s[5]*t[0]+s[6]*t[5]+s[7]*t[10]+s[8]*t[15],s[5]*t[1]+s[6]*t[6]+s[7]*t[11]+s[8]*t[16],s[5]*t[2]+s[6]*t[7]+s[7]*t[12]+s[8]*t[17],s[5]*t[3]+s[6]*t[8]+s[7]*t[13]+s[8]*t[18],s[5]*t[4]+s[6]*t[9]+s[7]*t[14]+s[8]*t[19]+s[9],s[10]*t[0]+s[11]*t[5]+s[12]*t[10]+s[13]*t[15],s[10]*t[1]+s[11]*t[6]+s[12]*t[11]+s[13]*t[16],s[10]*t[2]+s[11]*t[7]+s[12]*t[12]+s[13]*t[17],s[10]*t[3]+s[11]*t[8]+s[12]*t[13]+s[13]*t[18],s[10]*t[4]+s[11]*t[9]+s[12]*t[14]+s[13]*t[19]+s[14],s[15]*t[0]+s[16]*t[5]+s[17]*t[10]+s[18]*t[15],s[15]*t[1]+s[16]*t[6]+s[17]*t[11]+s[18]*t[16],s[15]*t[2]+s[16]*t[7]+s[17]*t[12]+s[18]*t[17],s[15]*t[3]+s[16]*t[8]+s[17]*t[13]+s[18]*t[18],s[15]*t[4]+s[16]*t[9]+s[17]*t[14]+s[18]*t[19]+s[19]]),this._dirty=!0,this}});return i.BLACK_WHITE=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],i.NEGATIVE=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],i.DESATURATE_LUMINANCE=[.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],i.SEPIA=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],i.LSD=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],i.BROWN=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],i.VINTAGE=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],i.KODACHROME=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],i.TECHNICOLOR=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],i.POLAROID=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],i.SHIFT_BGR=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],Ws=i}function uu(){if(js)return Vs;js=1;var t=Vh(),e=lu(),i=iu(),n=new t({Extends:e,initialize:function(t){e.call(this),this.type=i.COLOR_MATRIX,this.gameObject=t,this.active=!0},destroy:function(){this.gameObject=null,this._matrix=null,this._data=null}});return Vs=n}function cu(){if(Ks)return qs;Ks=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r){void 0===n&&(n="__WHITE"),void 0===s&&(s=.005),void 0===r&&(r=.005),e.call(this,i.DISPLACEMENT,t),this.x=s,this.y=r,this.glTexture,this.setTexture(n)},setTexture:function(t){var e=this.gameObject.scene.sys.textures.getFrame(t);return e&&(this.glTexture=e.glTexture),this}});return qs=n}function du(){if(Js)return Zs;Js=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===s&&(s=4),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.GLOW,t),this.outerStrength=s,this.innerStrength=r,this.knockout=a,this.glcolor=[1,1,1,1],void 0!==n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Zs=n}function fu(){if(Qs)return $s;Qs=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l,u){void 0===r&&(r=.2),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=1),void 0===u&&(u=0),e.call(this,i.GRADIENT,t),this.alpha=r,this.size=u,this.fromX=a,this.fromY=o,this.toX=h,this.toY=l,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],null!=n&&(this.color1=n),null!=s&&(this.color2=s)},color1:{get:function(){var t=this.glcolor1;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor1;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}},color2:{get:function(){var t=this.glcolor2;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor2;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}}});return $s=n}function pu(){if(er)return tr;er=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.PIXELATE,t),this.amount=n}});return tr=n}function gu(){if(nr)return ir;nr=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=.1),void 0===a&&(a=1),void 0===h&&(h=6),void 0===l&&(l=1),e.call(this,i.SHADOW,t),this.x=n,this.y=s,this.decay=r,this.power=a,this.glcolor=[0,0,0,1],this.samples=h,this.intensity=l,void 0!==o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return ir=n}function vu(){if(rr)return sr;rr=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=3),void 0===a&&(a=!1),e.call(this,i.SHINE,t),this.speed=n,this.lineWidth=s,this.gradient=r,this.reveal=a}});return sr=n}function mu(){if(or)return ar;or=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=.5),void 0===a&&(a=.5),e.call(this,i.VIGNETTE,t),this.x=n,this.y=s,this.radius=r,this.strength=a}});return ar=n}function yu(){if(lr)return hr;lr=1;var t=Vh(),e=nu(),i=iu(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.1),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.WIPE,t),this.progress=0,this.wipeWidth=n,this.direction=s,this.axis=r,this.reveal=a}});return hr=n}function xu(){if(cr)return ur;cr=1;var t=nh(),e=iu(),i={Barrel:su(),Controller:nu(),Bloom:ru(),Blur:au(),Bokeh:ou(),Circle:hu(),ColorMatrix:uu(),Displacement:cu(),Glow:du(),Gradient:fu(),Pixelate:pu(),Shadow:gu(),Shine:vu(),Vignette:mu(),Wipe:yu()};return i=t(!1,i,e),ur=i}function wu(){if(fr)return dr;fr=1;var t=Vh(),e=xu(),i=Il(),n=new t({initialize:function(t,e){this.gameObject=t,this.isPost=e,this.enabled=!1,this.list=[],this.padding=0},setPadding:function(t){return void 0===t&&(t=0),this.padding=t,this.gameObject},onFXCopy:function(){},onFX:function(){},enable:function(t){if(!this.isPost){var e=this.gameObject.scene.sys.renderer;e&&e.pipelines?(this.gameObject.pipeline=e.pipelines.FX_PIPELINE,void 0!==t&&(this.padding=t),this.enabled=!0):this.enabled=!1}},clear:function(){if(this.isPost)this.gameObject.resetPostPipeline(!0);else{for(var t=this.list,e=0;e<t.length;e++)t[e].destroy();this.list=[]}return this.enabled=!1,this.gameObject},remove:function(t){var e;if(this.isPost){var n=this.gameObject.getPostPipeline(String(t.type));for(Array.isArray(n)||(n=[n]),e=0;e<n.length;e++){var s=n[e];if(s.controller===t){this.gameObject.removePostPipeline(s),t.destroy();break}}}else{var r=this.list;for(e=0;e<r.length;e++)r[e]===t&&(i(r,e),t.destroy())}return this.gameObject},disable:function(t){return void 0===t&&(t=!1),this.isPost||this.gameObject.resetPipeline(),this.enabled=!1,t&&this.clear(),this.gameObject},add:function(t,e){if(!this.isPost)return this.enabled||this.enable(),this.list.push(t),t;var i=String(t.type);this.gameObject.setPostPipeline(i,e);var n=this.gameObject.getPostPipeline(i);return n?(Array.isArray(n)&&(n=n.pop()),n&&(n.controller=t),t):void 0},addGlow:function(t,i,n,s,r,a){return this.add(new e.Glow(this.gameObject,t,i,n,s),{quality:r,distance:a})},addShadow:function(t,i,n,s,r,a,o){return this.add(new e.Shadow(this.gameObject,t,i,n,s,r,a,o))},addPixelate:function(t){return this.add(new e.Pixelate(this.gameObject,t))},addVignette:function(t,i,n,s){return this.add(new e.Vignette(this.gameObject,t,i,n,s))},addShine:function(t,i,n,s){return this.add(new e.Shine(this.gameObject,t,i,n,s))},addBlur:function(t,i,n,s,r,a){return this.add(new e.Blur(this.gameObject,t,i,n,s,r,a))},addGradient:function(t,i,n,s,r,a,o,h){return this.add(new e.Gradient(this.gameObject,t,i,n,s,r,a,o,h))},addBloom:function(t,i,n,s,r,a){return this.add(new e.Bloom(this.gameObject,t,i,n,s,r,a))},addColorMatrix:function(){return this.add(new e.ColorMatrix(this.gameObject))},addCircle:function(t,i,n,s,r){return this.add(new e.Circle(this.gameObject,t,i,n,s,r))},addBarrel:function(t){return this.add(new e.Barrel(this.gameObject,t))},addDisplacement:function(t,i,n){return this.add(new e.Displacement(this.gameObject,t,i,n))},addWipe:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n))},addReveal:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n,!0))},addBokeh:function(t,i,n){return this.add(new e.Bokeh(this.gameObject,t,i,n))},addTiltShift:function(t,i,n,s,r,a){return this.add(new e.Bokeh(this.gameObject,t,i,n,!0,s,r,a))},destroy:function(){this.clear(),this.gameObject=null}});return dr=n}function Tu(){return gr?pr:(gr=1,pr=function(t,e,i){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=i&&t.y+t.height>=i})}function bu(){return mr?vr:(mr=1,vr=function(t){return 2*(t.width+t.height)})}function Su(){if(xr)return yr;xr=1;var t=bu(),e=Kh();return yr=function(i,n,s){if(void 0===s&&(s=new e),n<=0||n>=1)return s.x=i.x,s.y=i.y,s;var r=t(i)*n;return n>.5?(r-=i.width+i.height)<=i.width?(s.x=i.right-r,s.y=i.bottom):(s.x=i.x,s.y=i.bottom-(r-i.width)):r<=i.width?(s.x=i.x+r,s.y=i.y):(s.x=i.right,s.y=i.y+(r-i.width)),s},yr}function Eu(){if(Tr)return wr;Tr=1;var t=Su(),e=bu();return wr=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=e(i)/s);for(var a=0;a<n;a++){var o=a/n;r.push(t(i,o))}return r},wr}function _u(){if(Sr)return br;Sr=1;var t=Kh();return br=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x1+(e.x2-e.x1)*i,n.y=e.y1+(e.y2-e.y1)*i,n},br}function Cu(){return _r||(_r=1,Er=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}),Er}function Au(){if(Ar)return Cr;Ar=1;var t=Cu(),e=Kh();return Cr=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=t(i)/s);for(var a=i.x1,o=i.y1,h=i.x2,l=i.y2,u=0;u<n;u++){var c=u/n,d=a+(h-a)*c,f=o+(l-o)*c;r.push(new e(d,f))}return r},Cr}function Pu(){if(Mr)return Pr;Mr=1;var t=Kh();return Pr=function(e,i){void 0===i&&(i=new t);var n=Math.random();return i.x=e.x1+n*(e.x2-e.x1),i.y=e.y1+n*(e.y2-e.y1),i},Pr}function Mu(){return Lr?Rr:(Lr=1,Rr=function(t,e,i){return void 0===i&&(i=1e-4),Math.abs(t-e)<i})}function Ru(){if(Fr)return Or;Fr=1;var t=Vh(),e=Mu(),i=new t({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new i(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,i){return e(this.x,t.x,i)&&e(this.y,t.y,i)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,i=t*t+e*e;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this},transformMat3:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},transformMat4:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[4]*i+n[12],this.y=n[1]*e+n[5]*i+n[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e*this.x-i*this.y,i*this.x+e*this.y)},project:function(t){var e=this.dot(t)/t.dot(t);return this.copy(t).scale(e)}});return i.ZERO=new i,i.RIGHT=new i(1,0),i.LEFT=new i(-1,0),i.UP=new i(0,-1),i.DOWN=new i(0,1),i.ONE=new i(1,1),Or=i}function Lu(){if(Ir)return Dr;Ir=1;var t=Vh(),e=_u(),i=Au(),n=qh(),s=Pu(),r=Ru(),a=new t({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.type=n.LINE,this.x1=t,this.y1=e,this.x2=i,this.y2=s},getPoint:function(t,i){return e(this,t,i)},getPoints:function(t,e,n){return i(this,t,e,n)},getRandomPoint:function(t){return s(this,t)},setTo:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this},setFromObjects:function(t,e){return this.x1=t.x,this.y1=t.y,this.x2=e.x,this.y2=e.y,this},getPointA:function(t){return void 0===t&&(t=new r),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new r),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});return Dr=a}function Ou(){if(Br)return kr;Br=1;var t=Kh();return kr=function(e,i){return void 0===i&&(i=new t),i.x=e.x+Math.random()*e.width,i.y=e.y+Math.random()*e.height,i}}function Fu(){if(Ur)return Nr;Ur=1;var t=Vh(),e=Tu(),i=Su(),n=Eu(),s=qh(),r=Lu(),a=Ou(),o=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.RECTANGLE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return Nr=o}function Du(){return Yr||(Yr=1,zr=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x-e,o=t.y-i;return t.x=a*s-o*r+e,t.y=a*r+o*s+i,t}),zr}function Iu(){if(Gr)return Xr;Gr=1;var t=Fu(),e=Du(),i=Ru();return Xr={prepareBoundsOutput:function(t,i){return void 0===i&&(i=!1),0!==this.rotation&&e(t,this.x,this.y,this.rotation),i&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t,e){return void 0===t&&(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getTopLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(e){var i,n,s,r,a,o,h,l;if(void 0===e&&(e=new t),this.parentContainer){var u=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(e),u.transformPoint(e.x,e.y,e),i=e.x,n=e.y,this.getTopRight(e),u.transformPoint(e.x,e.y,e),s=e.x,r=e.y,this.getBottomLeft(e),u.transformPoint(e.x,e.y,e),a=e.x,o=e.y,this.getBottomRight(e),u.transformPoint(e.x,e.y,e),h=e.x,l=e.y}else this.getTopLeft(e),i=e.x,n=e.y,this.getTopRight(e),s=e.x,r=e.y,this.getBottomLeft(e),a=e.x,o=e.y,this.getBottomRight(e),h=e.x,l=e.y;return e.x=Math.min(i,s,a,h),e.y=Math.min(n,r,o,l),e.width=Math.max(i,s,a,h)-e.x,e.height=Math.max(n,r,o,l)-e.y,e}}}function ku(){if(Hr)return Wr;Hr=1;var t={},e={},i={register:function(e,i,n,s){void 0===s&&(s=!1),t[e]={plugin:i,mapping:n,custom:s}},registerCustom:function(t,i,n,s){e[t]={plugin:i,mapping:n,data:s}},hasCore:function(e){return t.hasOwnProperty(e)},hasCustom:function(t){return e.hasOwnProperty(t)},getCore:function(e){return t[e]},getCustom:function(t){return e[t]},getCustomClass:function(t){return e.hasOwnProperty(t)?e[t].plugin:null},remove:function(e){t.hasOwnProperty(e)&&delete t[e]},removeCustom:function(t){e.hasOwnProperty(t)&&delete e[t]},destroyCorePlugins:function(){for(var e in t)t.hasOwnProperty(e)&&delete t[e]},destroyCustomPlugins:function(){for(var t in e)e.hasOwnProperty(t)&&delete e[t]}};return Wr=i}function Bu(){return Ba?ka:(Ba=1,ka={ADDED_TO_SCENE:jr?Vr:(jr=1,Vr="addedtoscene"),BOOT:Kr?qr:(Kr=1,qr="boot"),CREATE:Jr?Zr:(Jr=1,Zr="create"),DESTROY:Qr?$r:(Qr=1,$r="destroy"),PAUSE:ea?ta:(ea=1,ta="pause"),POST_UPDATE:na?ia:(na=1,ia="postupdate"),PRE_RENDER:ra?sa:(ra=1,sa="prerender"),PRE_UPDATE:oa?aa:(oa=1,aa="preupdate"),READY:la?ha:(la=1,ha="ready"),REMOVED_FROM_SCENE:ca?ua:(ca=1,ua="removedfromscene"),RENDER:fa?da:(fa=1,da="render"),RESUME:ga?pa:(ga=1,pa="resume"),SHUTDOWN:ma?va:(ma=1,va="shutdown"),SLEEP:xa?ya:(xa=1,ya="sleep"),START:Ta?wa:(Ta=1,wa="start"),TRANSITION_COMPLETE:Sa?ba:(Sa=1,ba="transitioncomplete"),TRANSITION_INIT:_a?Ea:(_a=1,Ea="transitioninit"),TRANSITION_OUT:Aa?Ca:(Aa=1,Ca="transitionout"),TRANSITION_START:Ma?Pa:(Ma=1,Pa="transitionstart"),TRANSITION_WAKE:La?Ra:(La=1,Ra="transitionwake"),UPDATE:Fa?Oa:(Fa=1,Oa="update"),WAKE:Ia?Da:(Ia=1,Da="wake")})}function Nu(){if(Ua)return Na;Ua=1;var t=Vh(),e=ku(),i=Bu(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectFactory",n,"add"),Na=n}function Uu(){if(Ya)return za;Ya=1;var t=Vh(),e=Nu(),i=new t({initialize:function(t,e,i,n,s,r){e||(e=t.sys.make.image({x:i,y:n,key:s,frame:r,add:!1})),this.bitmapMask=e,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,i)},postRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e,i)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});return e.register("bitmapMask",function(t,e,n,s,r){return new i(this.scene,t,e,n,s,r)}),za=i}function zu(){if(Ga)return Xa;Ga=1;var t=new(Vh())({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,i){var n=t.gl;t.flush(),0===t.maskStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:i}),this.applyStencil(t,i,!0),t.maskCount++},applyStencil:function(t,e,i){var n=t.gl,s=this.geometryMask,r=t.maskCount,a=255;n.colorMask(!1,!1,!1,!1),i?(n.stencilFunc(n.EQUAL,r,a),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r++):(n.stencilFunc(n.EQUAL,r+1,a),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),this.level=r,s.renderWebGL(t,s,e),t.flush(),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.invertAlpha?n.stencilFunc(n.NOTEQUAL,r,a):n.stencilFunc(n.EQUAL,r,a)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var i=t.currentMask;if(0===t.maskStack.length)i.mask=null,e.disable(e.STENCIL_TEST);else{var n=t.maskStack[t.maskStack.length-1];n.mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null}},preRenderCanvas:function(t,e,i){var n=this.geometryMask;t.currentContext.save(),n.renderCanvas(t,n,i,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});return Xa=t}function Yu(){if(Ha)return Wa;Ha=1;var t=Uu(),e=zu(),i={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(e,i,n,s,r){return void 0===e&&(this.texture||this.shader||this.geom)&&(e=this),new t(this.scene,e,i,n,s,r)},createGeometryMask:function(t){return void 0!==t||"Graphics"!==this.type&&!this.geom||(t=this),new e(this.scene,t)}};return Wa=i}function Xu(){if(Ka)return qa;Ka=1;var t=Qh();return qa=function(e){return e*t.DEG_TO_RAD}}function Gu(){return Ja?Za:(Ja=1,Za=function(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i})}function Wu(){return Qa?$a:(Qa=1,$a={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999})}function Hu(){if(eo)return to;eo=1;var t=Xu(),e=Gu(),i=Ol(),n=Wu(),s=Ru(),r={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:n.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var i=this.pathTween;return i&&i.isPlaying()&&i.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(r,a){void 0===r&&(r={}),void 0===a&&(a=0);var o=this.pathTween;o&&o.isPlaying()&&o.stop(),"number"==typeof r&&(r={duration:r}),r.from=i(r,"from",0),r.to=i(r,"to",1);var h=e(r,"positionOnPath",!1);this.rotateToPath=e(r,"rotateToPath",!1),this.pathRotationOffset=i(r,"rotationOffset",0);var l=i(r,"startAt",a);if(l&&(r.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var i=e.ease(e.progress);e.current=e.start+(e.end-e.start)*i,e.setTargetValue()}),this.pathOffset||(this.pathOffset=new s(this.x,this.y)),this.pathVector||(this.pathVector=new s),this.pathDelta||(this.pathDelta=new s),this.pathDelta.reset(),r.persist=!0,this.pathTween=this.scene.sys.tweens.addCounter(r),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=n.PLAYING_FORWARD,this.rotateToPath){var u=this.path.getPoint(.1);this.rotation=Math.atan2(u.y-this.y,u.x-this.x)+t(this.pathRotationOffset)}return this.pathConfig=r,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var e=this.pathTween;if(e&&e.data){var i=e.data[0],s=this.pathDelta,r=this.pathVector;if(s.copy(r).negate(),i.state===n.COMPLETE)return this.path.getPoint(i.end,r),s.add(r),r.add(this.pathOffset),void this.setPosition(r.x,r.y);if(i.state!==n.PLAYING_FORWARD&&i.state!==n.PLAYING_BACKWARD)return;this.path.getPoint(e.getValue(),r),s.add(r),r.add(this.pathOffset);var a=this.x,o=this.y;this.setPosition(r.x,r.y);var h=this.x-a,l=this.y-o;if(0===h&&0===l)return;if(i.state!==this._prevDirection)return void(this._prevDirection=i.state);this.rotateToPath&&(this.rotation=Math.atan2(l,h)+t(this.pathRotationOffset))}}};return to=r}function Vu(){if(no)return io;no=1;var t=function(e){var i,n,s;if("object"!=typeof e||null===e)return e;for(s in i=Array.isArray(e)?[]:{},e)n=e[s],i[s]=t(n);return i};return io=t}function ju(){if(ro)return so;ro=1;var t=Vu(),e={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(t){this.pipelineData={};var e=this.scene.sys.renderer;if(!e)return!1;var i=e.pipelines;if(i){void 0===t&&(t=i.default);var n=i.get(t);if(n)return this.defaultPipeline=n,this.pipeline=n,!0}return!1},setPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){var a=r.get(e);a&&(this.pipeline=a),i&&(this.pipelineData=n?t(i):i)}return this},setPipelineData:function(t,e){var i=this.pipelineData;return void 0===e?delete i[t]:i[t]=e,this},resetPipeline:function(t){return void 0===t&&(t=!1),this.pipeline=this.defaultPipeline,t&&(this.pipelineData={}),null!==this.pipeline},getPipelineName:function(){return null===this.pipeline?null:this.pipeline.name}};return so=e}function qu(){if(oo)return ao;oo=1;var t=Vu(),e=wu(),i=Il(),n={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(t){this.postPipelines=[],this.postPipelineData={},this.postFX=new e(this,!0),t&&(this.preFX=new e(this,!1))},setPostPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){Array.isArray(e)||(e=[e]);for(var a=0;a<e.length;a++){var o=r.getPostPipeline(e[a],this,i);o&&this.postPipelines.push(o)}i&&(this.postPipelineData=n?t(i):i)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(t,e){var i=this.postPipelineData;return void 0===e?delete i[t]:i[t]=e,this},getPostPipeline:function(t){for(var e="string"==typeof t,i=this.postPipelines,n=[],s=0;s<i.length;s++){var r=i[s];(e&&r.name===t||!e&&r instanceof t)&&n.push(r)}return 1===n.length?n[0]:n},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,i=0;i<e.length;i++)e[i].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.postPipelineData={})},removePostPipeline:function(t){for(var e="string"==typeof t,n=this.postPipelines,s=n.length-1;s>=0;s--){var r=n[s];(e&&r.name===t||!e&&r===t)&&(r.destroy(),i(n,s))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};return ao=n}function Ku(){if(co)return uo;co=1;var t={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight;var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};return uo=t}function Zu(){if(po)return fo;po=1;var t=Vh(),e=Jh(),i=nh(),n=new t({initialize:function(t,e,i,n,s,r,a){this.texture=t,this.name=e,this.source=t.source[i],this.sourceIndex=i,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(r,a,n,s)},setCutPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.cutX=t,this.cutY=e,this.updateUVs()},setCutSize:function(t,e){return this.cutWidth=t,this.cutHeight=e,this.updateUVs()},setSize:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.setCutPosition(i,n),this.setCutSize(t,e),this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var s=this.data,r=s.cut;r.x=i,r.y=n,r.w=t,r.h=e,r.r=i+t,r.b=n+e,s.sourceSize.w=t,s.sourceSize.h=e,s.spriteSourceSize.w=t,s.spriteSourceSize.h=e,s.radius=.5*Math.sqrt(t*t+e*e);var a=s.drawImage;return a.x=i,a.y=n,a.width=t,a.height=e,this.updateUVs()},setTrim:function(t,e,i,n,s,r){var a=this.data,o=a.spriteSourceSize;return a.trim=!0,a.sourceSize.w=t,a.sourceSize.h=e,o.x=i,o.y=n,o.w=s,o.h=r,o.r=i+s,o.b=n+r,this.x=i,this.y=n,this.width=s,this.height=r,this.halfWidth=.5*s,this.halfHeight=.5*r,this.centerX=Math.floor(s/2),this.centerY=Math.floor(r/2),this.updateUVs()},setScale9:function(t,e,i,n){var s=this.data;return s.scale9=!0,s.is3Slice=0===e&&n===this.height,s.scale9Borders.x=t,s.scale9Borders.y=e,s.scale9Borders.w=i,s.scale9Borders.h=n,this},setCropUVs:function(t,i,n,s,r,a,o){var h=this.cutX,l=this.cutY,u=this.cutWidth,c=this.cutHeight,d=this.realWidth,f=this.realHeight,p=h+(i=e(i,0,d)),g=l+(n=e(n,0,f)),v=s=e(s,0,d-i),m=r=e(r,0,f-n),y=this.data;if(y.trim){var x=y.spriteSourceSize,w=i+(s=e(s,0,x.x+u-i)),T=n+(r=e(r,0,x.y+c-n));if(x.r<i||x.b<n||x.x>w||x.y>T)p=0,g=0,v=0,m=0;else{var b=Math.max(x.x,i),S=Math.max(x.y,n),E=Math.min(x.r,w)-b,_=Math.min(x.b,T)-S;v=E,m=_,p=a?h+(u-(b-x.x)-E):h+(b-x.x),g=o?l+(c-(S-x.y)-_):l+(S-x.y),i=b,n=S,s=E,r=_}}else a&&(p=h+(u-i-s)),o&&(g=l+(c-n-r));var C=this.source.width,A=this.source.height;return t.u0=Math.max(0,p/C),t.v0=Math.max(0,g/A),t.u1=Math.min(1,(p+v)/C),t.v1=Math.min(1,(g+m)/A),t.x=i,t.y=n,t.cx=p,t.cy=g,t.cw=v,t.ch=m,t.width=s,t.height=r,t.flipX=a,t.flipY=o,t},updateCropUVs:function(t,e,i){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,i)},setUVs:function(t,e,i,n,s,r){var a=this.data.drawImage;return a.width=t,a.height=e,this.u0=i,this.v0=n,this.u1=s,this.v1=r,this},updateUVs:function(){var t=this.cutX,e=this.cutY,i=this.cutWidth,n=this.cutHeight,s=this.data.drawImage;s.width=i,s.height=n;var r=this.source.width,a=this.source.height;return this.u0=t/r,this.v0=e/a,this.u1=(t+i)/r,this.v1=(e+n)/a,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new n(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=i(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});return fo=n}function Ju(){if(vo)return go;vo=1;var t=Zu();return go={texture:null,frame:null,isCropped:!1,setTexture:function(t,e,i,n){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e,i,n)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}}function $u(){if(yo)return mo;yo=1;var t=Zu();return mo={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}}function Qu(){return bo?To:(bo=1,To=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e})}function tc(){if(Eo)return So;Eo=1;var t=Vh(),e=Qh(),i=Ru(),n=new t({initialize:function(t,e,i,n,s,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),this.matrix=new Float32Array([t,e,i,n,s,r,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,i=t[0],n=t[1],s=t[2],r=t[3];return i||n?n>0?Math.acos(i/this.scaleX):-Math.acos(i/this.scaleX):s||r?e.TAU-(r>0?Math.acos(-s/this.scaleY):-Math.acos(s/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var i=this.matrix;return i[4]=i[0]*t+i[2]*e+i[4],i[5]=i[1]*t+i[3]*e+i[5],this},scale:function(t,e){var i=this.matrix;return i[0]*=t,i[1]*=t,i[2]*=e,i[3]*=e,this},rotate:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3];return n[0]=s*i+a*e,n[1]=r*i+o*e,n[2]=s*-e+a*i,n[3]=r*-e+o*i,this},multiply:function(t,e){var i=this.matrix,n=t.matrix,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=n[0],c=n[1],d=n[2],f=n[3],p=n[4],g=n[5],v=void 0===e?i:e.matrix;return v[0]=u*s+c*a,v[1]=u*r+c*o,v[2]=d*s+f*a,v[3]=d*r+f*o,v[4]=p*s+g*a+h,v[5]=p*r+g*o+l,v},multiplyWithOffset:function(t,e,i){var n=this.matrix,s=t.matrix,r=n[0],a=n[1],o=n[2],h=n[3],l=e*r+i*o+n[4],u=e*a+i*h+n[5],c=s[0],d=s[1],f=s[2],p=s[3],g=s[4],v=s[5];return n[0]=c*r+d*o,n[1]=c*a+d*h,n[2]=f*r+p*o,n[3]=f*a+p*h,n[4]=g*r+v*o+l,n[5]=g*a+v*h+u,this},transform:function(t,e,i,n,s,r){var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5];return a[0]=t*o+e*l,a[1]=t*h+e*u,a[2]=i*o+n*l,a[3]=i*h+n*u,a[4]=s*o+r*l+c,a[5]=s*h+r*u+d,this},transformPoint:function(t,e,i){void 0===i&&(i={x:0,y:0});var n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3],h=n[4],l=n[5];return i.x=t*s+e*a+h,i.y=t*r+e*o+l,i},invert:function(){var t=this.matrix,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=e*s-i*n;return t[0]=s/o,t[1]=-i/o,t[2]=-n/o,t[3]=e/o,t[4]=(n*a-s*r)/o,t[5]=-(e*a-i*r)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,i,n,s,r){var a=this.matrix;return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=s,a[5]=r,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(t.translateX=e[4],t.translateY=e[5],i||n){var o=Math.sqrt(i*i+n*n);t.rotation=n>0?Math.acos(i/o):-Math.acos(i/o),t.scaleX=o,t.scaleY=a/o}else if(s||r){var h=Math.sqrt(s*s+r*r);t.rotation=.5*Math.PI-(r>0?Math.acos(-s/h):-Math.acos(s/h)),t.scaleX=a/h,t.scaleY=h}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,i,n,s){var r=this.matrix,a=Math.sin(i),o=Math.cos(i);return r[4]=t,r[5]=e,r[0]=o*n,r[1]=a*n,r[2]=-a*s,r[3]=o*s,this},applyInverse:function(t,e,n){void 0===n&&(n=new i);var s=this.matrix,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=1/(r*h+o*-a);return n.x=h*c*t+-o*c*e+(u*o-l*h)*c,n.y=r*c*e+-a*c*t+(-u*r+l*a)*c,n},setQuad:function(t,e,i,n,s,r){void 0===s&&(s=!1),void 0===r&&(r=this.quad);var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5],f=t*o+e*l+c,p=t*h+e*u+d,g=t*o+n*l+c,v=t*h+n*u+d,m=i*o+n*l+c,y=i*h+n*u+d,x=i*o+e*l+c,w=i*h+e*u+d;if(s){var T=Math.floor(f+.5),b=Math.floor(p+.5),S=T-f,E=b-p;r[0]=T,r[1]=b,r[2]=g+S,r[3]=v+E,r[4]=m+S,r[5]=y+E,r[6]=x+S,r[7]=w+E}else r[0]=f,r[1]=p,r[2]=g,r[3]=v,r[4]=m,r[5]=y,r[6]=x,r[7]=w;return r},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,i){var n=this.getX(t,e);return i&&(n=Math.floor(n+.5)),n},getYRound:function(t,e,i){var n=this.getY(t,e);return i&&(n=Math.floor(n+.5)),n},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});return So=n}function ec(){if(Co)return _o;Co=1;var t=Ru();return _o=function(e,i,n,s,r,a,o,h){void 0===h&&(h=new t);var l=Math.sin(r),u=Math.cos(r),c=u*a,d=l*a,f=-l*o,p=u*o,g=1/(c*p+f*-d);return h.x=p*g*e+-f*g*i+(s*f-n*p)*g,h.y=c*g*i+-d*g*e+(-s*c+n*d)*g,h}}function ic(){return Po?Ao:(Po=1,Ao=function(t,e,i){var n=i-e;return e+((t-e)%n+n)%n})}function nc(){if(Ro)return Mo;Ro=1;var t=ic();return Mo=function(e){return t(e,-Math.PI,Math.PI)},Mo}function sc(){if(Oo)return Lo;Oo=1;var t=ic();return Lo=function(e){return t(e,-180,180)},Lo}function rc(){if(Do)return Fo;Do=1;var t=Qh(),e=tc(),i=ec(),n=nc(),s=sc(),r=Ru(),a={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:0!==this._scaleY&&(this.renderFlags|=4)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:0!==this._scaleX&&(this.renderFlags|=4)}},angle:{get:function(){return s(this._rotation*t.RAD_TO_DEG)},set:function(e){this.rotation=s(e)*t.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=n(t)}},setPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=i,this.w=n,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.scene.sys.scale.width),void 0===n&&(n=this.scene.sys.scale.height),this.x=t+Math.random()*i,this.y=e+Math.random()*n,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new e),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,i){void 0===t&&(t=new e);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);var s=!1;for(i||(i=new e,s=!0),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)i.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),i.multiply(t,t),n=n.parentContainer;return s&&i.destroy(),t},getLocalPoint:function(t,e,n,s){n||(n=new r),s||(s=this.scene.sys.cameras.main);var a=s.scrollX,o=s.scrollY,h=t+a*this.scrollFactorX-a,l=e+o*this.scrollFactorY-o;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(h,l,n):i(h,l,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getWorldPoint:function(t,e,i){if(void 0===t&&(t=new r),!this.parentContainer)return t.x=this.x,t.y=this.y,t;var n=this.getWorldTransformMatrix(e,i);return t.x=n.tx,t.y=n.ty,t},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};return Fo=a}function ac(){return No?Bo:(No=1,Bo={Alpha:rl(),AlphaSingle:al(),BlendMode:ol(),ComputedSize:hi?oi:(hi=1,oi={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}),Crop:ui?li:(ui=1,li={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}),Depth:eu(),Flip:Ms?Ps:(Ms=1,Ps={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}),FX:wu(),GetBounds:Iu(),Mask:Yu(),Origin:ja?Va:(ja=1,Va={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}),PathFollower:Hu(),Pipeline:ju(),PostPipeline:qu(),ScrollFactor:lo?ho:(lo=1,ho={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}),Size:Ku(),Texture:Ju(),TextureCrop:$u(),Tint:wo?xo:(wo=1,xo={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,i,n){return void 0===t&&(t=16777215),void 0===e&&(e=t,i=t,n=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=i,this.tintBottomRight=n,this.tintFill=!1,this},setTintFill:function(t,e,i,n){return this.setTint(t,e,i,n),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}),ToJSON:Qu(),Transform:rc(),TransformMatrix:tc(),Visible:ko?Io:(ko=1,Io={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}})})}function oc(){return Zo?Ko:(Zo=1,Ko={CHANGE_DATA:zo?Uo:(zo=1,Uo="changedata"),CHANGE_DATA_KEY:Xo?Yo:(Xo=1,Yo="changedata-"),DESTROY:Wo?Go:(Wo=1,Go="destroy"),REMOVE_DATA:Vo?Ho:(Vo=1,Ho="removedata"),SET_DATA:qo?jo:(qo=1,jo="setdata")})}function hc(){if($o)return Jo;$o=1;var t=Vh(),e=oc(),i=new t({initialize:function(t,i){this.parent=t,this.events=i,i||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(e.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var i=[],n=0;n<t.length;n++)i.push(e[t[n]]);return i}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var i in this.list)this.list.hasOwnProperty(i)&&i.match(t)&&(e[i]=this.list[i]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var i in t)this.setValue(i,t[i]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var i=this.get(t);return void 0===i&&(i=0),this.set(t,i+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,i){if(this._frozen)return this;if(this.has(t))this.values[t]=i;else{var n=this,s=this.list,r=this.events,a=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return s[t]},set:function(i){if(!n._frozen){var o=s[t];s[t]=i,r.emit(e.CHANGE_DATA,a,t,i,o),r.emit(e.CHANGE_DATA_KEY+t,a,i,o)}}}),s[t]=i,r.emit(e.SET_DATA,a,t,i)}return this},each:function(t,e){for(var i=[this.parent,null,void 0],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[1]=s,i[2]=this.list[s],t.apply(e,i);return this},merge:function(t,e){for(var i in void 0===e&&(e=!0),t)t.hasOwnProperty(i)&&(e||!e&&!this.has(i))&&this.setValue(i,t[i]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var i=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)}return this},pop:function(t){var i=void 0;return!this._frozen&&this.has(t)&&(i=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)),i},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(e.CHANGE_DATA),this.events.off(e.SET_DATA),this.events.off(e.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});return Jo=i}var lc,uc,cc,dc,fc,pc,gc,vc,mc,yc,xc,wc,Tc,bc,Sc,Ec,_c,Cc,Ac,Pc,Mc,Rc,Lc,Oc,Fc,Dc,Ic,kc,Bc,Nc,Uc,zc,Yc,Xc,Gc,Wc,Hc,Vc,jc,qc,Kc,Zc,Jc,$c,Qc,td,ed,id,nd,sd,rd,ad,od,hd,ld,ud,cd,dd,fd,pd,gd,vd,md,yd,xd,wd,Td,bd,Sd,Ed,_d,Cd,Ad,Pd,Md,Rd,Ld,Od,Fd,Dd,Id,kd,Bd,Nd,Ud,zd,Yd,Xd,Gd,Wd,Hd,Vd,jd,qd,Kd,Zd,Jd,$d,Qd,tf,ef,nf,sf,rf,af,of,hf,lf,uf,cf,df,ff,pf,gf,vf,mf,yf,xf,wf,Tf,bf,Sf,Ef,_f,Cf,Af,Pf,Mf,Rf,Lf,Of,Ff,Df,If,kf,Bf,Nf,Uf,zf,Yf,Xf,Gf,Wf,Hf,Vf,jf,qf,Kf,Zf,Jf,$f,Qf,tp,ep,ip,np,sp,rp,ap,op,hp,lp,up,cp,dp,fp,pp,gp,vp,mp,yp,xp,wp,Tp,bp,Sp,Ep,_p,Cp,Ap,Pp,Mp,Rp,Lp,Op,Fp,Dp,Ip,kp,Bp,Np,Up,zp,Yp,Xp,Gp,Wp,Hp,Vp,jp,qp,Kp,Zp,Jp,$p,Qp,tg,eg,ig,ng,sg,rg,ag,og,hg,lg,ug,cg,dg,fg,pg,gg,vg,mg,yg,xg,wg,Tg,bg,Sg,Eg,_g,Cg,Ag,Pg,Mg,Rg,Lg,Og,Fg,Dg,Ig,kg,Bg,Ng,Ug,zg,Yg,Xg,Gg,Wg,Hg,Vg,jg,qg,Kg,Zg,Jg,$g,Qg,tv,ev,iv,nv,sv,rv,av,ov,hv,lv,uv,cv,dv,fv,pv,gv,vv,mv,yv,xv,wv,Tv,bv,Sv,Ev,_v,Cv,Av,Pv,Mv,Rv,Lv,Ov,Fv,Dv,Iv,kv,Bv,Nv,Uv,zv,Yv,Xv,Gv,Wv,Hv,Vv,jv,qv,Kv,Zv,Jv,$v,Qv,tm,em,im,nm,sm,rm,am,om,hm,lm,um,cm,dm,fm,pm,gm,vm,mm,ym,xm,wm,Tm,bm,Sm,Em,_m,Cm,Am,Pm,Mm,Rm,Lm,Om,Fm,Dm,Im,km,Bm,Nm,Um,zm,Ym,Xm,Gm,Wm,Hm,Vm,jm,qm,Km,Zm,Jm,$m,Qm,ty,ey,iy,ny,sy,ry,ay,oy,hy,ly,uy,cy,dy,fy,py,gy,vy,my,yy,xy,wy,Ty,by,Sy,Ey,_y,Cy,Ay,Py,My,Ry,Ly,Oy,Fy,Dy,Iy,ky,By,Ny,Uy,zy,Yy,Xy,Gy,Wy,Hy,Vy,jy,qy,Ky,Zy,Jy,$y,Qy,tx,ex,ix,nx,sx,rx,ax,ox,hx,lx,ux,cx,dx,fx,px,gx,vx,mx,yx,xx,wx,Tx,bx,Sx,Ex,_x,Cx,Ax,Px,Mx,Rx,Lx,Ox,Fx,Dx,Ix,kx,Bx,Nx,Ux,zx,Yx,Xx,Gx,Wx,Hx,Vx,jx,qx,Kx,Zx,Jx,$x,Qx,tw,ew,iw,nw,sw,rw,aw,ow,hw,lw,uw,cw,dw,fw,pw,gw,vw,mw,yw,xw,ww,Tw,bw,Sw,Ew,_w,Cw,Aw,Pw,Mw,Rw,Lw,Ow,Fw,Dw,Iw,kw,Bw,Nw,Uw,zw,Yw,Xw,Gw,Ww,Hw,Vw,jw,qw,Kw,Zw,Jw,$w,Qw,tT,eT,iT,nT,sT,rT,aT,oT,hT,lT,uT,cT,dT,fT,pT,gT,vT,mT,yT,xT,wT,TT,bT,ST,ET,_T,CT,AT,PT,MT,RT,LT,OT,FT,DT,IT,kT,BT,NT,UT,zT,YT,XT,GT,WT,HT,VT,jT,qT,KT,ZT,JT,$T,QT,tb,eb,ib,nb,sb,rb,ab,ob,hb,lb,ub,cb,db,fb,pb,gb,vb,mb,yb,xb,wb,Tb,bb,Sb,Eb,_b,Cb,Ab,Pb,Mb,Rb,Lb,Ob,Fb,Db,Ib,kb,Bb,Nb,Ub,zb,Yb,Xb,Gb,Wb,Hb,Vb,jb,qb,Kb,Zb,Jb,$b,Qb,tS,eS,iS,nS,sS,rS,aS,oS,hS,lS,uS,cS,dS,fS,pS,gS,vS,mS,yS,xS,wS,TS,bS,SS,ES,_S,CS,AS,PS,MS,RS,LS,OS,FS,DS,IS,kS,BS,NS,US,zS,YS,XS,GS,WS,HS,VS,jS,qS,KS,ZS,JS,$S,QS,tE,eE,iE,nE,sE,rE,aE,oE,hE,lE,uE,cE,dE,fE,pE,gE,vE,mE,yE,xE,wE,TE,bE,SE,EE,_E,CE,AE,PE,ME,RE,LE,OE,FE,DE,IE,kE,BE,NE,UE,zE,YE,XE,GE,WE,HE,VE,jE,qE,KE,ZE,JE,$E,QE,t_,e_,i_,n_,s_,r_,a_,o_,h_,l_,u_,c_,d_,f_,p_,g_,v_,m_,y_,x_,w_,T_,b_,S_,E_,__,C_,A_,P_,M_,R_,L_,O_,F_,D_,I_,k_,B_,N_,U_,z_,Y_,X_,G_,W_,H_,V_,j_,q_,K_,Z_,J_,$_,Q_,tC,eC,iC,nC,sC,rC,aC,oC,hC,lC,uC,cC,dC,fC,pC,gC,vC,mC,yC,xC,wC,TC,bC,SC,EC,_C,CC,AC,PC,MC,RC,LC,OC,FC,DC,IC,kC,BC,NC,UC,zC,YC,XC,GC,WC,HC,VC,jC,qC,KC,ZC,JC,$C,QC,tA,eA,iA,nA,sA,rA,aA,oA,hA,lA,uA,cA,dA,fA,pA,gA,vA,mA,yA,xA,wA,TA,bA,SA,EA,_A,CA,AA,PA,MA,RA,LA,OA,FA,DA,IA,kA,BA,NA,UA,zA,YA,XA,GA,WA,HA,VA,jA,qA,KA,ZA,JA,$A,QA,tP,eP,iP,nP,sP,rP,aP,oP,hP,lP,uP,cP,dP,fP,pP,gP,vP,mP,yP,xP,wP,TP,bP,SP,EP,_P,CP,AP,PP,MP,RP,LP,OP,FP,DP,IP,kP,BP,NP,UP,zP,YP,XP,GP,WP,HP,VP,jP,qP,KP,ZP,JP,$P,QP,tM,eM,iM,nM,sM,rM,aM,oM,hM,lM,uM,cM,dM,fM,pM,gM,vM,mM,yM,xM,wM,TM,bM,SM,EM,_M,CM,AM,PM,MM,RM,LM,OM,FM,DM,IM,kM,BM,NM,UM,zM,YM,XM,GM,WM,HM,VM,jM,qM,KM,ZM,JM,$M,QM,tR,eR,iR,nR,sR,rR,aR,oR,hR,lR,uR,cR,dR,fR,pR,gR,vR,mR,yR,xR,wR,TR,bR,SR,ER,_R,CR,AR,PR,MR,RR,LR,OR,FR,DR,IR,kR,BR,NR,UR,zR,YR,XR,GR,WR,HR,VR,jR,qR,KR,ZR,JR,$R,QR,tL,eL,iL,nL,sL,rL,aL,oL,hL,lL,uL,cL,dL,fL,pL,gL,vL,mL,yL,xL,wL,TL,bL,SL,EL,_L,CL,AL,PL,ML,RL,LL,OL,FL,DL,IL,kL,BL,NL,UL,zL,YL,XL,GL,WL,HL,VL,jL,qL,KL,ZL,JL,$L,QL,tO,eO,iO,nO,sO,rO,aO,oO,hO,lO,uO,cO,dO,fO,pO,gO,vO,mO,yO,xO,wO,TO,bO,SO,EO,_O,CO,AO,PO,MO,RO,LO,OO,FO,DO,IO,kO,BO,NO,UO,zO,YO,XO,GO,WO,HO,VO,jO,qO,KO,ZO,JO,$O,QO,tF,eF,iF,nF,sF,rF,aF,oF,hF,lF,uF,cF,dF,fF,pF,gF,vF,mF,yF,xF,wF,TF,bF,SF,EF,_F,CF,AF,PF,MF,RF,LF,OF,FF,DF,IF,kF,BF,NF,UF,zF,YF,XF,GF,WF,HF,VF,jF={exports:{}};function qF(){return lc||(lc=1,function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(t,e,n,r,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new s(n,r||t,a),h=i?i+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],o]:t._events[h].push(o):(t._events[h]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,n,s=[];if(0===this._eventsCount)return s;for(n in t=this._events)e.call(t,n)&&s.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},o.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,r=n.length,a=new Array(r);s<r;s++)a[s]=n[s].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,s,r,a){var o=i?i+t:t;if(!this._events[o])return!1;var h,l,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,s),!0;case 5:return u.fn.call(u.context,e,n,s,r),!0;case 6:return u.fn.call(u.context,e,n,s,r,a),!0}for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,n);break;case 4:u[l].fn.call(u[l].context,e,n,s);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},o.prototype.on=function(t,e,i){return r(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return r(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,n,s){var r=i?i+t:t;if(!this._events[r])return this;if(!e)return a(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||s&&!o.once||n&&o.context!==n||a(this,r);else{for(var h=0,l=[],u=o.length;h<u;h++)(o[h].fn!==e||s&&!o[h].once||n&&o[h].context!==n)&&l.push(o[h]);l.length?this._events[r]=1===l.length?l[0]:l:a(this,r)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(jF)),jF.exports}function KF(){return jc?Vc:(jc=1,Vc={ADDED_TO_SCENE:cc?uc:(cc=1,uc="addedtoscene"),DESTROY:fc?dc:(fc=1,dc="destroy"),REMOVED_FROM_SCENE:gc?pc:(gc=1,pc="removedfromscene"),VIDEO_COMPLETE:mc?vc:(mc=1,vc="complete"),VIDEO_CREATED:xc?yc:(xc=1,yc="created"),VIDEO_ERROR:Tc?wc:(Tc=1,wc="error"),VIDEO_LOCKED:Sc?bc:(Sc=1,bc="locked"),VIDEO_LOOP:_c?Ec:(_c=1,Ec="loop"),VIDEO_METADATA:Ac?Cc:(Ac=1,Cc="metadata"),VIDEO_PLAY:Mc?Pc:(Mc=1,Pc="play"),VIDEO_PLAYING:Lc?Rc:(Lc=1,Rc="playing"),VIDEO_SEEKED:Fc?Oc:(Fc=1,Oc="seeked"),VIDEO_SEEKING:Ic?Dc:(Ic=1,Dc="seeking"),VIDEO_STALLED:Bc?kc:(Bc=1,kc="stalled"),VIDEO_STOP:Uc?Nc:(Uc=1,Nc="stop"),VIDEO_TEXTURE:Yc?zc:(Yc=1,zc="textureready"),VIDEO_UNLOCKED:Gc?Xc:(Gc=1,Xc="unlocked"),VIDEO_UNSUPPORTED:Hc?Wc:(Hc=1,Wc="unsupported")})}function ZF(){if(Kc)return qc;Kc=1;var t=Vh(),e=Qu(),i=hc(),n=qF(),s=KF(),r=Bu(),a=new t({Extends:n,initialize:function(t,e){n.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(s.ADDED_TO_SCENE,this.addedToScene,this),this.on(s.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new i(this)),this},setData:function(t,e){return this.data||(this.data=new i(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new i(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new i(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new i(this)),this.data.get(t)},setInteractive:function(t,e,i){return this.scene.sys.input.enable(this,t,e,i),this},disableInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.disable(this,t),this},removeInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.clear(this),t&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return e(this)},willRender:function(t){return!(this.displayList&&this.displayList.active&&!this.displayList.willRender(t)||a.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?i.unshift(this.displayList.getIndex(t)):i.unshift(this.scene.sys.displayList.getIndex(t)),i},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(s.ADDED_TO_SCENE,this,this.scene),t.events.emit(r.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t&&t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(s.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(r.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){this.scene&&!this.ignoreDestroy&&(void 0===t&&(t=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(s.DESTROY,this,t),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});return a.RENDER_MASK=15,qc=a}function JF(){if(Jc)return Zc;Jc=1;var t=Qo(),e=sl(),i=jh(),n=Vh(),s=ac(),r=ZF(),a=Fu(),o=Tu(),h=new n({Extends:r,Mixins:[s.Depth,s.GetBounds,s.Origin,s.Transform,s.ScrollFactor,s.Visible],initialize:function(e,i,n,s,a){void 0===s&&(s=1),void 0===a&&(a=s),r.call(this,e,"Zone"),this.setPosition(i,n),this.width=s,this.height=a,this.blendMode=t.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,i){void 0===i&&(i=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var n=this.input;return i&&n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new e(0,0,t),i)},setRectangleDropZone:function(t,e){return this.setDropZone(new a(0,0,t,e),o)},setDropZone:function(t,e){return this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,i){i.addToRenderList(e)},renderWebGL:function(t,e,i){i.addToRenderList(e)}});return Zc=h}function $F(){if(Qc)return $c;Qc=1;var t=Gh(),e=sh(),i=Wh(),n=Hh(),s=new(JF())({sys:{queueDepthSort:n,events:{once:n}}},0,0,1,1).setOrigin(0,0);return $c=function(n,r){void 0===r&&(r={});var a=r.hasOwnProperty("width"),o=r.hasOwnProperty("height"),h=i(r,"width",-1),l=i(r,"height",-1),u=i(r,"cellWidth",1),c=i(r,"cellHeight",u),d=i(r,"position",e.TOP_LEFT),f=i(r,"x",0),p=i(r,"y",0),g=0,v=0,m=h*u,y=l*c;s.setPosition(f,p),s.setSize(u,c);for(var x=0;x<n.length;x++)if(t(n[x],s,d),a&&-1===h)s.x+=u;else if(o&&-1===l)s.y+=c;else if(o&&!a){if(v+=c,s.y+=c,v===y&&(v=0,g+=u,s.y=p,s.x+=u,g===m))break}else if(g+=u,s.x+=u,g===m&&(g=0,v+=c,s.x=f,s.y+=c,v===y))break;return n}}function QF(){if(ed)return td;ed=1;var t=Lh();return td=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function tD(){if(nd)return id;nd=1;var t=Lh();return id=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function eD(){if(rd)return sd;rd=1;var t=Lh();return sd=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function iD(){if(od)return ad;od=1;var t=Lh();return ad=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function nD(){return fd?dd:(fd=1,dd=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)})}function sD(){return Td?wd:(Td=1,wd={In:gd?pd:(gd=1,pd=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}),Out:md?vd:(md=1,vd=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}),InOut:xd?yd:(xd=1,yd=function(t,e){void 0===e&&(e=1.70158);var i=1.525*e;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)})})}function rD(){return Md?Pd:(Md=1,Pd={In:Sd?bd:(Sd=1,bd=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),Out:_d?Ed:(_d=1,Ed=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),InOut:Ad?Cd:(Ad=1,Cd=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})})}function aD(){return Bd?kd:(Bd=1,kd={In:Ld?Rd:(Ld=1,Rd=function(t){return 1-Math.sqrt(1-t*t)}),Out:Fd?Od:(Fd=1,Od=function(t){return Math.sqrt(1- --t*t)}),InOut:Id?Dd:(Id=1,Dd=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})})}function oD(){return Hd?Wd:(Hd=1,Wd={In:Ud?Nd:(Ud=1,Nd=function(t){return t*t*t}),Out:Yd?zd:(Yd=1,zd=function(t){return--t*t*t+1}),InOut:Gd?Xd:(Gd=1,Xd=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)})})}function hD(){return Qd?$d:(Qd=1,$d={In:jd?Vd:(jd=1,Vd=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)}),Out:Kd?qd:(Kd=1,qd=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-n)*(2*Math.PI)/i)+1}),InOut:Jd?Zd:(Jd=1,Zd=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*.5+1})})}function lD(){return hf?of:(hf=1,of={In:ef?tf:(ef=1,tf=function(t){return Math.pow(2,10*(t-1))-.001}),Out:sf?nf:(sf=1,nf=function(t){return 1-Math.pow(2,-10*t)}),InOut:af?rf:(af=1,rf=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})})}function uD(){return df?cf:(df=1,cf=uf?lf:(uf=1,lf=function(t){return t}))}function cD(){return wf?xf:(wf=1,xf={In:pf?ff:(pf=1,ff=function(t){return t*t}),Out:vf?gf:(vf=1,gf=function(t){return t*(2-t)}),InOut:yf?mf:(yf=1,mf=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)})})}function dD(){return Pf?Af:(Pf=1,Af={In:bf?Tf:(bf=1,Tf=function(t){return t*t*t*t}),Out:Ef?Sf:(Ef=1,Sf=function(t){return 1- --t*t*t*t}),InOut:Cf?_f:(Cf=1,_f=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)})})}function fD(){return kf?If:(kf=1,If={In:Rf?Mf:(Rf=1,Mf=function(t){return t*t*t*t*t}),Out:Of?Lf:(Of=1,Lf=function(t){return--t*t*t*t*t+1}),InOut:Df?Ff:(Df=1,Ff=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)})})}function pD(){return Wf?Gf:(Wf=1,Gf={In:Nf?Bf:(Nf=1,Bf=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}),Out:zf?Uf:(zf=1,Uf=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}),InOut:Xf?Yf:(Xf=1,Yf=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))})})}function gD(){return qf?jf:(qf=1,jf=Vf?Hf:(Vf=1,Hf=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}))}function vD(){if(Zf)return Kf;Zf=1;var t=sD(),e=rD(),i=aD(),n=oD(),s=hD(),r=lD(),a=uD(),o=cD(),h=dD(),l=fD(),u=pD(),c=gD();return Kf={Power0:a,Power1:o.Out,Power2:n.Out,Power3:h.Out,Power4:l.Out,Linear:a,Quad:o.Out,Cubic:n.Out,Quart:h.Out,Quint:l.Out,Sine:u.Out,Expo:r.Out,Circ:i.Out,Elastic:s.Out,Back:t.Out,Bounce:e.Out,Stepped:c,"Quad.easeIn":o.In,"Cubic.easeIn":n.In,"Quart.easeIn":h.In,"Quint.easeIn":l.In,"Sine.easeIn":u.In,"Expo.easeIn":r.In,"Circ.easeIn":i.In,"Elastic.easeIn":s.In,"Back.easeIn":t.In,"Bounce.easeIn":e.In,"Quad.easeOut":o.Out,"Cubic.easeOut":n.Out,"Quart.easeOut":h.Out,"Quint.easeOut":l.Out,"Sine.easeOut":u.Out,"Expo.easeOut":r.Out,"Circ.easeOut":i.Out,"Elastic.easeOut":s.Out,"Back.easeOut":t.Out,"Bounce.easeOut":e.Out,"Quad.easeInOut":o.InOut,"Cubic.easeInOut":n.InOut,"Quart.easeInOut":h.InOut,"Quint.easeInOut":l.InOut,"Sine.easeInOut":u.InOut,"Expo.easeInOut":r.InOut,"Circ.easeInOut":i.InOut,"Elastic.easeInOut":s.InOut,"Back.easeInOut":t.InOut,"Bounce.easeInOut":e.InOut}}function mD(){return $f?Jf:($f=1,Jf=function(t){return t&&t[0].toUpperCase()+t.slice(1)})}function yD(){if(tp)return Qf;tp=1;var t=vD(),e=mD();return Qf=function(i,n){var s=t.Power0;if("string"==typeof i)if(t.hasOwnProperty(i))s=t[i];else{var r="";if(i.indexOf(".")){var a=(r=i.substring(i.indexOf(".")+1)).toLowerCase();"in"===a?r="easeIn":"out"===a?r="easeOut":"inout"===a&&(r="easeInOut")}i=e(i.substring(0,i.indexOf(".")+1)+r),t.hasOwnProperty(i)&&(s=t[i])}else"function"==typeof i&&(s=i);if(!n)return s;var o=n.slice(0);return o.unshift(0),function(t){return o[0]=t,s.apply(this,o)}}}function xD(){if(ip)return ep;ip=1;var t=nD(),e=yD(),i=Kh();return ep=function(n,s,r,a,o){void 0===a&&(a=0),void 0===o&&(o=[]);var h,l,u=[],c=n.x1,d=n.y1,f=n.x2-c,p=n.y2-d,g=e(s,o),v=r-1;for(h=0;h<v;h++)l=g(h/v),u.push(new i(c+f*l,d+p*l));if(l=g(1),u.push(new i(c+f*l,d+p*l)),a>0){var m=u[0],y=[m];for(h=1;h<u.length-1;h++){var x=u[h];t(m,x)>=a&&(y.push(x),m=x)}var w=u[u.length-1];return t(m,w)<a&&y.pop(),y.push(w),y}return u},ep}function wD(){if(sp)return np;sp=1;var t=Au(),e=xD();return np=function(i,n,s){var r;r=s?e(n,s,i.length):t(n,i.length);for(var a=0;a<i.length;a++){var o=i[a],h=r[a];o.x=h.x,o.y=h.y}return i},np}function TD(){if(ap)return rp;ap=1;var t=bu(),e=Kh();return rp=function(i,n,s,r){if(void 0===r&&(r=[]),!n&&!s)return r;n?s=Math.round(t(i)/n):n=t(i)/s;for(var a=i.x,o=i.y,h=0,l=0;l<s;l++)switch(r.push(new e(a,o)),h){case 0:(a+=n)>=i.right&&(h=1,o+=a-i.right,a=i.right);break;case 1:(o+=n)>=i.bottom&&(h=2,a-=o-i.bottom,o=i.bottom);break;case 2:(a-=n)<=i.left&&(h=3,o-=i.left-a,a=i.left);break;case 3:(o-=n)<=i.top&&(h=0,o=i.top)}return r}}function bD(){if(hp)return op;hp=1;var t=TD(),e=vl(),i=ml();return op=function(n,s,r){void 0===r&&(r=0);var a=t(s,!1,n.length);r>0?e(a,r):r<0&&i(a,Math.abs(r));for(var o=0;o<n.length;o++)n[o].x=a[o].x,n[o].y=a[o].y;return n}}function SD(){return up||(up=1,lp=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=[]);var n=Math.round(t.x1),s=Math.round(t.y1),r=Math.round(t.x2),a=Math.round(t.y2),o=Math.abs(r-n),h=Math.abs(a-s),l=n<r?1:-1,u=s<a?1:-1,c=o-h;i.push({x:n,y:s});for(var d=1;n!==r||s!==a;){var f=c<<1;f>-h&&(c-=h,n+=l),f<o&&(c+=o,s+=u),d%e===0&&i.push({x:n,y:s}),d++}return i}),lp}function ED(){if(dp)return cp;dp=1;var t=SD();return cp=function(e,i,n){var s=t({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n),r=t({x1:i.x2,y1:i.y2,x2:i.x3,y2:i.y3},n),a=t({x1:i.x3,y1:i.y3,x2:i.x1,y2:i.y1},n);s.pop(),r.pop(),a.pop();for(var o=(s=s.concat(r,a)).length/e.length,h=0,l=0;l<e.length;l++){var u=e[l],c=s[Math.floor(h)];u.x=c.x,u.y=c.y,h+=o}return e},cp}function _D(){return vp?gp:(vp=1,gp=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]=i+o*n,o++;return t})}function CD(){if(yp)return mp;yp=1;var t=nl();return mp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},mp}function AD(){if(wp)return xp;wp=1;var t=Kh();return xp=function(e,i){void 0===i&&(i=new t);var n=Math.random()*Math.PI*2,s=Math.sqrt(Math.random());return i.x=e.x+s*Math.cos(n)*e.width/2,i.y=e.y+s*Math.sin(n)*e.height/2,i},xp}function PD(){if(bp)return Tp;bp=1;var t=AD();return Tp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},Tp}function MD(){if(Ep)return Sp;Ep=1;var t=Pu();return Sp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},Sp}function RD(){if(Cp)return _p;Cp=1;var t=Ou();return _p=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e}}function LD(){if(Pp)return Ap;Pp=1;var t=Kh();return Ap=function(e,i){void 0===i&&(i=new t);var n=e.x2-e.x1,s=e.y2-e.y1,r=e.x3-e.x1,a=e.y3-e.y1,o=Math.random(),h=Math.random();return o+h>=1&&(o=1-o,h=1-h),i.x=e.x1+(n*o+r*h),i.y=e.y1+(s*o+a*h),i},Ap}function OD(){if(Rp)return Mp;Rp=1;var t=LD();return Mp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},Mp}function FD(){if(Op)return Lp;Op=1;var t=Lh();return Lp=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function DD(){return Dp||(Dp=1,Fp=function(t,e,i,n,s){var r=n+Math.atan2(t.y-i,t.x-e);return t.x=e+s*Math.cos(r),t.y=i+s*Math.sin(r),t}),Fp}function ID(){return kp?Ip:(kp=1,Ip=function(t,e,i,n){var s=t-i,r=e-n;return Math.sqrt(s*s+r*r)})}function kD(){if(Np)return Bp;Np=1;var t=DD(),e=ID();return Bp=function(i,n,s){for(var r=n.x,a=n.y,o=0;o<i.length;o++){var h=i[o];t(h,r,a,s,Math.max(1,e(h.x,h.y,r,a)))}return i},Bp}function BD(){if(zp)return Up;zp=1;var t=DD();return Up=function(e,i,n,s){var r=i.x,a=i.y;if(0===s)return e;for(var o=0;o<e.length;o++)t(e[o],r,a,n,s);return e},Up}function ND(){if(Xp)return Yp;Xp=1;var t=Lh();return Yp=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function UD(){if(Wp)return Gp;Wp=1;var t=Lh();return Gp=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function zD(){if(Vp)return Hp;Vp=1;var t=Lh();return Hp=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function YD(){if(qp)return jp;qp=1;var t=_D();return jp=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function XD(){if(Zp)return Kp;Zp=1;var t=_D();return Kp=function(e,i,n,s){return t(e,"blendMode",i,0,n,s)}}function GD(){if($p)return Jp;$p=1;var t=_D();return Jp=function(e,i,n,s,r){return t(e,"depth",i,n,s,r)}}function WD(){if(ig)return eg;ig=1;var t=_D();return eg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"originX",i,s,a,o),t(e,"originY",n,r,a,o),e.forEach(function(t){t.updateDisplayOrigin()}),e}}function HD(){if(sg)return ng;sg=1;var t=_D();return ng=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function VD(){if(ag)return rg;ag=1;var t=_D();return rg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function jD(){if(hg)return og;hg=1;var t=_D();return og=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function qD(){if(ug)return lg;ug=1;var t=_D();return lg=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function KD(){if(dg)return cg;dg=1;var t=_D();return cg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scrollFactorX",i,s,a,o),t(e,"scrollFactorY",n,r,a,o)}}function ZD(){if(pg)return fg;pg=1;var t=_D();return fg=function(e,i,n,s,r){return t(e,"scrollFactorX",i,n,s,r)}}function JD(){if(vg)return gg;vg=1;var t=_D();return gg=function(e,i,n,s,r){return t(e,"scrollFactorY",i,n,s,r)}}function $D(){if(wg)return xg;wg=1;var t=_D();return xg=function(e,i,n,s){return t(e,"visible",i,0,n,s)}}function QD(){if(bg)return Tg;bg=1;var t=_D();return Tg=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function tI(){if(Eg)return Sg;Eg=1;var t=_D();return Sg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function eI(){if(Cg)return _g;Cg=1;var t=_D();return _g=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function iI(){if(Pg)return Ag;Pg=1;var t=Ru();return Ag=function(e,i,n,s,r){var a,o;void 0===s&&(s=0),void 0===r&&(r=new t);var h=e.length;if(1===h)a=e[0].x,o=e[0].y,e[0].x=i,e[0].y=n;else{var l=1,u=0;0===s&&(u=h-1,l=h-2),a=e[u].x,o=e[u].y,e[u].x=i,e[u].y=n;for(var c=0;c<h;c++)if(!(l>=h||-1===l)){var d=e[l],f=d.x,p=d.y;d.x=a,d.y=o,a=f,o=p,0===s?l--:l++}}return r.x=a,r.y=o,r}}function nI(){if(Rg)return Mg;Rg=1;var t=Fl();return Mg=function(e){return t(e)}}function sI(){return Og?Lg:(Og=1,Lg=function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*t*(t*(6*t-15)+10)})}function rI(){if(Dg)return Fg;Dg=1;var t=sI();return Fg=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function aI(){return kg?Ig:(kg=1,Ig=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)})}function oI(){if(Ng)return Bg;Ng=1;var t=aI();return Bg=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function hI(){if(Wg)return Gg;Wg=1;var t=ic();return Gg=function(e,i,n){void 0===n&&(n=0);for(var s=0;s<e.length;s++){var r=e[s];r.x=t(r.x,i.left-n,i.right+n),r.y=t(r.y,i.top-n,i.bottom+n)}return e}}function lI(){return Vg?Hg:(Vg=1,Hg={AlignTo:Rh(),Angle:Oh(),Call:$t?Jt:($t=1,Jt=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];e.call(i,s)}return t}),GetFirst:te?Qt:(te=1,Qt=function(t,e,i){void 0===i&&(i=0);for(var n=i;n<t.length;n++){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}),GetLast:ie?ee:(ie=1,ee=function(t,e,i){void 0===i&&(i=0);for(var n=t.length-1;n>=i;n--){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}),GridAlign:$F(),IncAlpha:QF(),IncX:tD(),IncXY:eD(),IncY:iD(),PlaceOnCircle:(ld||(ld=1,hd=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.x,o=e.y,h=e.radius,l=0;l<t.length;l++)t[l].x=a+h*Math.cos(s),t[l].y=o+h*Math.sin(s),s+=r;return t}),hd),PlaceOnEllipse:(cd||(cd=1,ud=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.width/2,o=e.height/2,h=0;h<t.length;h++)t[h].x=e.x+a*Math.cos(s),t[h].y=e.y+o*Math.sin(s),s+=r;return t}),ud),PlaceOnLine:wD(),PlaceOnRectangle:bD(),PlaceOnTriangle:ED(),PlayAnimation:pp?fp:(pp=1,fp=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];s.anims&&s.anims.play(e,i)}return t}),PropertyValueInc:Lh(),PropertyValueSet:_D(),RandomCircle:CD(),RandomEllipse:PD(),RandomLine:MD(),RandomRectangle:RD(),RandomTriangle:OD(),Rotate:FD(),RotateAround:kD(),RotateAroundDistance:BD(),ScaleX:ND(),ScaleXY:UD(),ScaleY:zD(),SetAlpha:YD(),SetBlendMode:XD(),SetDepth:GD(),SetHitArea:tg?Qp:(tg=1,Qp=function(t,e,i){for(var n=0;n<t.length;n++)t[n].setInteractive(e,i);return t}),SetOrigin:WD(),SetRotation:HD(),SetScale:VD(),SetScaleX:jD(),SetScaleY:qD(),SetScrollFactor:KD(),SetScrollFactorX:ZD(),SetScrollFactorY:JD(),SetTint:yg?mg:(yg=1,mg=function(t,e,i,n,s){for(var r=0;r<t.length;r++)t[r].setTint(e,i,n,s);return t}),SetVisible:$D(),SetX:QD(),SetXY:tI(),SetY:eI(),ShiftPosition:iI(),Shuffle:nI(),SmootherStep:rI(),SmoothStep:oI(),Spread:zg?Ug:(zg=1,Ug=function(t,e,i,n,s){if(void 0===s&&(s=!1),0===t.length)return t;if(1===t.length)return s?t[0][e]+=(n+i)/2:t[0][e]=(n+i)/2,t;var r,a=Math.abs(n-i)/(t.length-1);if(s)for(r=0;r<t.length;r++)t[r][e]+=r*a+i;else for(r=0;r<t.length;r++)t[r][e]=r*a+i;return t}),ToggleVisible:Xg?Yg:(Xg=1,Yg=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}),WrapInRectangle:hI()})}function uI(){return vv?gv:(vv=1,gv={ADD_ANIMATION:qg?jg:(qg=1,jg="add"),ANIMATION_COMPLETE:Zg?Kg:(Zg=1,Kg="animationcomplete"),ANIMATION_COMPLETE_KEY:$g?Jg:($g=1,Jg="animationcomplete-"),ANIMATION_REPEAT:tv?Qg:(tv=1,Qg="animationrepeat"),ANIMATION_RESTART:iv?ev:(iv=1,ev="animationrestart"),ANIMATION_START:sv?nv:(sv=1,nv="animationstart"),ANIMATION_STOP:av?rv:(av=1,rv="animationstop"),ANIMATION_UPDATE:hv?ov:(hv=1,ov="animationupdate"),PAUSE_ALL:uv?lv:(uv=1,lv="pauseall"),REMOVE_ANIMATION:dv?cv:(dv=1,cv="remove"),RESUME_ALL:pv?fv:(pv=1,fv="resumeall")})}function cI(){if(yv)return mv;yv=1;var t=new(Vh())({initialize:function(t,e,i,n,s){void 0===s&&(s=!1),this.textureKey=t,this.textureFrame=e,this.index=i,this.frame=n,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=s},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});return mv=t}function dI(){if(wv)return xv;wv=1;var t=Jh(),e=Vh(),i=uI(),n=Sl(),s=cI(),r=Ol(),a=Yl(),o=new e({initialize:function(t,e,n){this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,r(n,"frames",[]),r(n,"defaultTextureKey",null),r(n,"sortFrames",!0)),this.frameRate=r(n,"frameRate",null),this.duration=r(n,"duration",null),this.msPerFrame,this.skipMissedFrames=r(n,"skipMissedFrames",!0),this.delay=r(n,"delay",0),this.repeat=r(n,"repeat",0),this.repeatDelay=r(n,"repeatDelay",0),this.yoyo=r(n,"yoyo",!1),this.showBeforeDelay=r(n,"showBeforeDelay",!1),this.showOnStart=r(n,"showOnStart",!1),this.hideOnComplete=r(n,"hideOnComplete",!1),this.randomFrame=r(n,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(i.PAUSE_ALL,this.pause,this),this.manager.on(i.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,i,n){null===i&&null===n?(t.frameRate=24,t.duration=24/e*1e3):i&&null===n?(t.duration=i,t.frameRate=e/(i/1e3)):(t.frameRate=n,t.duration=e/n*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var i=this.getFrames(this.manager.textureManager,e);if(i.length>0){if(0===t)this.frames=i.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(i);else{var n=this.frames.slice(0,t),s=this.frames.slice(t);this.frames=n.concat(i,s)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,i,n){void 0===n&&(n=!0);var o,h,l,u,c=[],d=1;if("string"==typeof e){if(u=e,!t.exists(u))return console.warn('Texture "%s" not found',u),c;var f=t.get(u).getFrameNames();n&&a(f),e=[],f.forEach(function(t){e.push({key:u,frame:t})})}if(!Array.isArray(e)||0===e.length)return c;for(l=0;l<e.length;l++){var p=e[l],g=r(p,"key",i);if(g){var v=r(p,"frame",0),m=t.getFrame(g,v);m?((h=new s(g,v,d,m)).duration=r(p,"duration",0),h.isFirst=!o,o&&(o.nextFrame=h,h.prevFrame=o),c.push(h),o=h,d++):console.warn('Texture "%s" not found',g)}}if(c.length>0){h.isLast=!0,h.nextFrame=c[0],c[0].prevFrame=h;var y=1/(c.length-1);for(l=0;l<c.length;l++)c[l].progress=l*y}return c},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameByProgress:function(e){return e=t(e,0,1),n(e,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0)return(0===t.repeatDelay||t.pendingRepeat)&&(t.forward=e),void this.repeatAnimation(t);if(t.inReverse===e||0!==t.repeatCounter){t.forward=e;var i=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,i)}else t.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?(t.inReverse&&!t.forward||(t.forward=!0),this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop){if(0===t._pendingStopValue)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(e){t.frames.push(e.toJSON())}),t},updateFrameSequence:function(){for(var t,e=this.frames.length,i=1/(e-1),n=0;n<e;n++)(t=this.frames[n]).index=n+1,t.isFirst=!1,t.isLast=!1,t.progress=n*i,0===n?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[n+1])):n===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[n-1],t.nextFrame=this.frames[n+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(i.PAUSE_ALL,this.pause,this),this.manager.off(i.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});return xv=o}function fI(){if(bv)return Tv;bv=1;var t=new(Vh())({initialize:function(t){this.entries={},this.size=0,this.setAll(t)},setAll:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1]);return this},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(t){delete this.entries[t]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var i in e)if(!1===t(i,e[i]))break;return this},contains:function(t){var e=this.entries;for(var i in e)if(e[i]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var i=this.entries,n=t.entries;for(var s in n)i.hasOwnProperty(s)&&e?i[s]=n[s]:this.set(s,n[s]);return this}});return Tv=t}function pI(){return im?em:(im=1,em={BLUR:Ev?Sv:(Ev=1,Sv="blur"),BOOT:Cv?_v:(Cv=1,_v="boot"),CONTEXT_LOST:Pv?Av:(Pv=1,Av="contextlost"),DESTROY:Rv?Mv:(Rv=1,Mv="destroy"),FOCUS:Ov?Lv:(Ov=1,Lv="focus"),HIDDEN:Dv?Fv:(Dv=1,Fv="hidden"),PAUSE:kv?Iv:(kv=1,Iv="pause"),POST_RENDER:Nv?Bv:(Nv=1,Bv="postrender"),POST_STEP:zv?Uv:(zv=1,Uv="poststep"),PRE_RENDER:Xv?Yv:(Xv=1,Yv="prerender"),PRE_STEP:Wv?Gv:(Wv=1,Gv="prestep"),READY:Vv?Hv:(Vv=1,Hv="ready"),RESUME:qv?jv:(qv=1,jv="resume"),STEP:Zv?Kv:(Zv=1,Kv="step"),SYSTEM_READY:$v?Jv:($v=1,Jv="systemready"),VISIBLE:tm?Qv:(tm=1,Qv="visible")})}function gI(){if(sm)return nm;sm=1;var t=dI(),e=Vh(),i=fI(),n=qF(),s=uI(),r=pI(),a=Wh(),o=Ol(),h=Qh(),l=Pl(),u=ll(),c=new e({Extends:n,initialize:function(t){n.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new i,this.mixes=new i,this.paused=!1,this.name="AnimationManager",t.events.once(r.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(r.DESTROY,this.destroy,this)},addMix:function(t,e,i){var n=this.anims,s=this.mixes,r="string"==typeof t?t:t.key,a="string"==typeof e?e:e.key;if(n.has(r)&&n.has(a)){var o=s.get(r);o||(o={}),o[a]=i,s.set(r,o)}return this},removeMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s=i.get(n);if(s)if(e){var r="string"==typeof e?e:e.key;s.hasOwnProperty(r)&&delete s[r]}else e||i.delete(n);return this},getMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s="string"==typeof e?e:e.key,r=i.get(n);return r&&r.hasOwnProperty(s)?r[s]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(s.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e,i){var n=[],s=this.game.cache.json.get(t);if(!s)return console.warn("No Aseprite data found for: "+t),n;var r=this,l=o(s,"meta",null),u=o(s,"frames",null);return l&&u&&o(l,"frameTags",[]).forEach(function(s){var o=[],l=a(s,"name",null),c=a(s,"from",0),d=a(s,"to",0),f=a(s,"direction","forward");if(l&&(!e||e&&e.indexOf(l)>-1)){for(var p=0,g=c;g<=d;g++){var v=g.toString(),m=u[v];if(m){var y=a(m,"duration",h.MAX_SAFE_INTEGER);o.push({key:t,frame:v,duration:y}),p+=y}}"reverse"===f&&(o=o.reverse());var x,w={key:l,frames:o,duration:p,yoyo:"pingpong"===f};i?i.anims&&(x=i.anims.create(w)):x=r.create(w),x&&n.push(x)}}),n},create:function(e){var i=e.key,n=!1;return i&&((n=this.get(i))?console.warn("AnimationManager key already exists: "+i):(n=new t(this,i,e),this.anims.set(i,n),this.emit(s.ADD_ANIMATION,i,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"==typeof t&&(t=JSON.parse(t));var i=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var n=0;n<t.anims.length;n++)i.push(this.create(t.anims[n]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&i.push(this.create(t));return i},generateFrameNames:function(t,e){var i=o(e,"prefix",""),n=o(e,"start",0),s=o(e,"end",0),r=o(e,"suffix",""),a=o(e,"zeroPad",0),h=o(e,"outputArray",[]),c=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),h;var d,f=this.textureManager.get(t);if(!f)return h;if(e)for(c||(c=l(n,s)),d=0;d<c.length;d++){var p=i+u(c[d],a,"0",1)+r;f.has(p)?h.push({key:t,frame:p}):console.warn('Frame "%s" not found in texture "%s"',p,t)}else for(c=f.getFrameNames(),d=0;d<c.length;d++)h.push({key:t,frame:c[d]});return h},generateFrameNumbers:function(t,e){var i=o(e,"start",0),n=o(e,"end",-1),s=o(e,"first",!1),r=o(e,"outputArray",[]),a=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),r;var h=this.textureManager.get(t);if(!h)return r;s&&h.has(s)&&r.push({key:t,frame:s}),a||(-1===n&&(n=h.frameTotal-2),a=l(i,n));for(var u=0;u<a.length;u++){var c=a[u];h.has(c)?r.push({key:t,frame:c}):console.warn('Frame "%s" not found in texture "%s"',c,t)}return r},get:function(t){return this.anims.get(t)},getAnimsFromTexture:function(t){for(var e=this.textureManager.get(t).key,i=this.anims.getArray(),n=[],s=0;s<i.length;s++)for(var r=i[s],a=r.frames,o=0;o<a.length;o++)if(a[o].textureKey===e){n.push(r.key);break}return n},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(s.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)e[i].anims.play(t);return this},staggerPlay:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var s=e.length;n||s--;for(var r=0;r<e.length;r++){var a=i<0?Math.abs(i)*(s-r):i*r;e[r].anims.playAfterDelay(t,a)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(s.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(s.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==t&&""!==t?e.anims.push(this.anims.get(t).toJSON()):this.anims.each(function(t,i){e.anims.push(i.toJSON())}),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});return nm=c}function vI(){return am?rm:(am=1,rm=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)})}function mI(){if(hm)return om;hm=1;var t=dI(),e=vI(),i=Vh(),n=fI(),s=uI(),r=Wh(),a=new i({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.on(s.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(void 0===t)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];this.nextAnim?this.nextAnimsQueue.push(n):this.nextAnim=n}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var i=this.animationManager,n="string"==typeof t?t:r(t,"key",null),s=this.exists(n)?this.get(n):i.get(n);if(s){this.currentAnim=s;var a=s.getTotalFrames(),o=r(t,"frameRate",s.frameRate),h=r(t,"duration",s.duration);s.calculateDuration(this,a,h,o),this.delay=r(t,"delay",s.delay),this.repeat=r(t,"repeat",s.repeat),this.repeatDelay=r(t,"repeatDelay",s.repeatDelay),this.yoyo=r(t,"yoyo",s.yoyo),this.showBeforeDelay=r(t,"showBeforeDelay",s.showBeforeDelay),this.showOnStart=r(t,"showOnStart",s.showOnStart),this.hideOnComplete=r(t,"hideOnComplete",s.hideOnComplete),this.skipMissedFrames=r(t,"skipMissedFrames",s.skipMissedFrames),this.randomFrame=r(t,"randomFrame",s.randomFrame),this.timeScale=r(t,"timeScale",this.timeScale);var l=r(t,"startFrame",0);l>a&&(l=0),this.randomFrame&&(l=e(0,a-1));var u=s.frames[l];0!==l||this.forward||(u=s.getLastFrame()),this.currentFrame=u}else console.warn("Missing animation: "+n);return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}else this.delayCounter=e,this.play(t,!0);return this.parent},playAfterRepeat:function(t,e){if(void 0===e&&(e=1),this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),-1!==this.repeatCounter&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}else this.play(t);return this.parent},play:function(t,e){void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent,s="string"==typeof t?t:t.key;if(e&&this.isPlaying&&i.key===s)return n;if(i&&this.isPlaying){var r=this.animationManager.getMix(i.key,t);if(r>0)return this.playAfterDelay(t,r)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){void 0===e&&(e=!1);var i="string"==typeof t?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===i?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,i=this.parent;return e?(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame),i):i},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(s.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(s.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(s.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(s.ANIMATION_COMPLETE,s.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var i=this.currentAnim;if(i){var n=this.currentFrame,s=this.parent,r=n.textureFrame;s.emit(t,i,n,s,r),e&&s.emit(e+i.key,i,n,s,r)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent;return i?(e&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),i.getFirstTick(this),this.emitEvents(s.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(i.frames[0]),this.parent):n},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return void 0===t&&(t=1),-1!==this.repeatCounter&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var i=this.currentAnim;if(this.isPlaying&&i&&!i.paused){if(this.accumulator+=e*this.timeScale*this.animationManager.globalTimeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?i.nextFrame(this):i.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var n=0;do{this.forward?i.nextFrame(this):i.previousFrame(this),n++}while(this.isPlaying&&this.accumulator>this.nextTick&&n<60)}}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(s.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return!!this.anims&&this.anims.has(t)},create:function(e){var i=e.key,s=!1;return i&&((s=this.get(i))?console.warn("Animation key already exists: "+i):(s=new t(this,i,e),this.anims||(this.anims=new n),this.anims.set(i,s))),s},createFromAseprite:function(t,e){return this.animationManager.createFromAseprite(t,e,this.parent)},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(s.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});return om=a}function yI(){return vm?gm:(vm=1,gm={ADD:dm?cm:(dm=1,cm="add"),REMOVE:pm?fm:(pm=1,fm="remove")})}function xI(){if(ym)return mm;ym=1;var t=Vh(),e=fI(),i=qF(),n=yI(),s=new t({initialize:function(){this.entries=new e,this.events=new i},add:function(t,e){return this.entries.set(t,e),this.events.emit(n.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(n.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});return mm=s}function wI(){if(wm)return xm;wm=1;var t=xI(),e=Vh(),i=pI(),n=new e({initialize:function(e){this.game=e,this.binary=new t,this.bitmapFont=new t,this.json=new t,this.physics=new t,this.shader=new t,this.audio=new t,this.video=new t,this.text=new t,this.html=new t,this.obj=new t,this.tilemap=new t,this.xml=new t,this.custom={},this.game.events.once(i.DESTROY,this.destroy,this)},addCustom:function(e){return this.custom.hasOwnProperty(e)||(this.custom[e]=new t),this.custom[e]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var i in this.custom)this.custom[i].destroy();this.custom=null,this.game=null}});return xm=n}function TI(){if(Em)return Sm;Em=1;var t=Vh(),e=Ol(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.speedX=0,this.speedY=0;var i=e(t,"speed",null);"number"==typeof i?(this.speedX=i,this.speedY=i):(this.speedX=e(t,"speed.x",0),this.speedY=e(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<this.minZoom&&(e.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed,e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return Sm=i}function bI(){if(Cm)return _m;Cm=1;var t=Vh(),e=Ol(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.accelX=0,this.accelY=0;var i=e(t,"acceleration",null);"number"==typeof i?(this.accelX=i,this.accelY=i):(this.accelX=e(t,"acceleration.x",0),this.accelY=e(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=e(t,"drag",null);"number"==typeof n?(this.dragX=n,this.dragY=n):(this.dragX=e(t,"drag.x",0),this.dragY=e(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var s=e(t,"maxSpeed",null);"number"==typeof s?(this.maxSpeedX=s,this.maxSpeedY=s):(this.maxSpeedX=e(t,"maxSpeed.x",0),this.maxSpeedY=e(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<this.minZoom?e.zoom=this.minZoom:e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return _m=i}function SI(){return dy?cy:(dy=1,cy={DESTROY:Rm?Mm:(Rm=1,Mm="cameradestroy"),FADE_IN_COMPLETE:Om?Lm:(Om=1,Lm="camerafadeincomplete"),FADE_IN_START:Dm?Fm:(Dm=1,Fm="camerafadeinstart"),FADE_OUT_COMPLETE:km?Im:(km=1,Im="camerafadeoutcomplete"),FADE_OUT_START:Nm?Bm:(Nm=1,Bm="camerafadeoutstart"),FLASH_COMPLETE:zm?Um:(zm=1,Um="cameraflashcomplete"),FLASH_START:Xm?Ym:(Xm=1,Ym="cameraflashstart"),FOLLOW_UPDATE:Wm?Gm:(Wm=1,Gm="followupdate"),PAN_COMPLETE:Vm?Hm:(Vm=1,Hm="camerapancomplete"),PAN_START:qm?jm:(qm=1,jm="camerapanstart"),POST_RENDER:Zm?Km:(Zm=1,Km="postrender"),PRE_RENDER:$m?Jm:($m=1,Jm="prerender"),ROTATE_COMPLETE:ty?Qm:(ty=1,Qm="camerarotatecomplete"),ROTATE_START:iy?ey:(iy=1,ey="camerarotatestart"),SHAKE_COMPLETE:sy?ny:(sy=1,ny="camerashakecomplete"),SHAKE_START:ay?ry:(ay=1,ry="camerashakestart"),ZOOM_COMPLETE:hy?oy:(hy=1,oy="camerazoomcomplete"),ZOOM_START:uy?ly:(uy=1,ly="camerazoomstart")})}function EI(){return py?fy:(py=1,fy=function(t,e,i){return t<<16|e<<8|i})}function _I(){return vy?gy:(vy=1,gy=function(t,e,i,n){return n<<24|t<<16|e<<8|i})}function CI(){if(yy)return my;yy=1;var t=EI();function e(t,e,i,n){var s=(t+6*e)%6,r=Math.min(s,4-s,1);return Math.round(255*(n-n*i*Math.max(0,r)))}return my=function(i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=1);var a=e(5,i,n,s),o=e(3,i,n,s),h=e(1,i,n,s);return r?r.setTo?r.setTo(a,o,h,r.alpha,!0):(r.r=a,r.g=o,r.b=h,r.color=t(a,o,h),r):{r:a,g:o,b:h,color:t(a,o,h)}}}function AI(){return wy?xy:(wy=1,xy=function(t,e,i,n){void 0===n&&(n={h:0,s:0,v:0}),t/=255,e/=255,i/=255;var s=Math.min(t,e,i),r=Math.max(t,e,i),a=r-s,o=0,h=0===r?0:a/r,l=r;return r!==s&&(r===t?o=(e-i)/a+(e<i?6:0):r===e?o=(i-t)/a+2:r===i&&(o=(t-e)/a+4),o/=6),n.hasOwnProperty("_h")?(n._h=o,n._s=h,n._v=l):(n.h=o,n.s=h,n.v=l),n})}function PI(){if(by)return Ty;by=1;var t=Vh(),e=EI(),i=_I(),n=CI(),s=AI(),r=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,i,n)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,i,n,s){return void 0===n&&(n=255),void 0===s&&(s=!0),this._locked=!0,this.red=t,this.green=e,this.blue=i,this.alpha=n,this._locked=!1,this.update(s)},setGLTo:function(t,e,i,n){return void 0===n&&(n=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=i,this.alphaGL=n,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,i){return n(t,e,i,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var n=this.r,r=this.g,a=this.b,o=this.a;return this._color=e(n,r,a),this._color32=i(n,r,a,o),this._rgba="rgba("+n+","+r+","+a+","+o/255+")",t&&s(n,r,a,this),this},updateHSV:function(){var t=this.r,e=this.g,i=this.b;return s(t,e,i,this),this},clone:function(){return new r(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t)),n=Math.floor(t+Math.random()*(e-t)),s=Math.floor(t+Math.random()*(e-t));return this.setTo(i,n,s)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t));return this.setTo(i,i,i)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,i=this.g,n=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),this.setTo(e,i,n)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,n(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,n(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,n(this._h,this._s,t,this)}}});return Ty=r}function MI(){if(Ey)return Sy;Ey=1;var t=PI();return Sy=function(e){var i=new t;e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(n){var s=parseInt(n[1],16),r=parseInt(n[2],16),a=parseInt(n[3],16);i.setTo(s,r,a)}return i},Sy}function RI(){return Cy||(Cy=1,_y=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}}),_y}function LI(){if(Py)return Ay;Py=1;var t=PI(),e=RI();return Ay=function(i){var n=e(i);return new t(n.r,n.g,n.b,n.a)},Ay}function OI(){if(Ry)return My;Ry=1;var t=PI();return My=function(e){return new t(e.r,e.g,e.b,e.a)},My}function FI(){if(Oy)return Ly;Oy=1;var t=PI();return Ly=function(e){var i=new t,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase());if(n){var s=parseInt(n[1],10),r=parseInt(n[2],10),a=parseInt(n[3],10),o=void 0!==n[4]?parseFloat(n[4]):1;i.setTo(s,r,a,255*o)}return i},Ly}function DI(){if(Dy)return Fy;Dy=1;var t=MI(),e=LI(),i=OI(),n=FI();return Fy=function(s){switch(typeof s){case"string":return"rgb"===s.substr(0,3).toLowerCase()?n(s):t(s);case"number":return e(s);case"object":return i(s)}},Fy}function II(){if(ky)return Iy;ky=1;var t=Vh(),e=ac(),i=Xu(),n=qF(),s=SI(),r=Fu(),a=tc(),o=DI(),h=Ru(),l=new t({Extends:n,Mixins:[e.AlphaSingle,e.Visible],initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),n.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new r,this.dirty=!0,this._x=t,this._y=e,this._width=i,this._height=s,this._bounds=new r,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new a,this.transparent=!0,this.backgroundColor=o("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new h(i/2,s/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,i){void 0===i&&(i=new h);var n=.5*this.width,s=.5*this.height;return i.x=t-n,i.y=e-s,this.useBounds&&(i.x=this.clampX(i.x),i.y=this.clampY(i.y)),i},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,i=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-i}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(!a)return t;var o=e[4],h=e[5],l=this.scrollX,u=this.scrollY,c=this.width,d=this.height,f=this.y,p=f+d,g=this.x,v=g+c,m=this.culledObjects,y=t.length;a=1/a,m.length=0;for(var x=0;x<y;++x){var w=t[x];if(w.hasOwnProperty("width")&&!w.parentContainer){var T=w.width,b=w.height,S=w.x-l*w.scrollFactorX-T*w.originX,E=w.y-u*w.scrollFactorY-b*w.originY;(S+T)*i+(E+b)*s+o>g&&S*i+E*s+o<v&&(S+T)*n+(E+b)*r+h>f&&S*n+E*r+h<p&&m.push(w)}else m.push(w)}return m},getWorldPoint:function(t,e,i){void 0===i&&(i=new h);var n=this.matrix.matrix,s=n[0],r=n[1],a=n[2],o=n[3],l=n[4],u=n[5],c=s*o-r*a;if(!c)return i.x=t,i.y=e,i;var d=o*(c=1/c),f=-r*c,p=-a*c,g=s*c,v=(a*u-o*l)*c,m=(r*l-s*u)*c,y=Math.cos(this.rotation),x=Math.sin(this.rotation),w=this.zoomX,T=this.zoomY,b=this.scrollX,S=this.scrollY,E=t+(b*y-S*x)*w,_=e+(b*x+S*y)*T;return i.x=E*d+_*p+v,i.y=E*f+_*g+m,i},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];Array.isArray(n)?this.ignore(n):n.isParent?this.ignore(n.getChildren()):n.cameraFilter|=e}return this},clampX:function(t){var e=this._bounds,i=this.displayWidth,n=e.x+(i-this.width)/2,s=Math.max(n,n+e.width-i);return t<n?t=n:t>s&&(t=s),t},clampY:function(t){var e=this._bounds,i=this.displayHeight,n=e.y+(i-this.height)/2,s=Math.max(n,n+e.height-i);return t<n?t=n:t>s&&(t=s),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=i(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=o(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,i,n,s){return void 0===s&&(s=!1),this._bounds.setTo(t,e,i,n),this.dirty=!0,this.useBounds=!0,s?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new r);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t,e){void 0===e&&(e=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t,this.isSceneCamera=e;var i=t.sys;return this.sceneManager=i.game.scene,this.scaleManager=i.scale,this.cameraManager=i.cameras,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setZoom:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),0===t&&(t=.001),0===e&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},setIsSceneCamera:function(t){return this.isSceneCamera=t,this},updateSystem:function(){if(this.scaleManager&&this.isSceneCamera){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(s.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){t!==this._scrollX&&(this._scrollX=t,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(t){t!==this._scrollY&&(this._scrollY=t,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});return Iy=l}function kI(){return Ny?By:(Ny=1,By=function(t,e,i){return t.x=e-t.width/2,t.y=i-t.height/2,t})}function BI(){if(zy)return Uy;zy=1;var t=Jh(),e=Vh(),i=SI(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o,h){if(void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),!a&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=s,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h;var l=t?i.FADE_OUT_START:i.FADE_IN_START;return this.camera.emit(l,this.camera,this,e,n,s,r),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?i.FADE_OUT_COMPLETE:i.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return Uy=n}function NI(){if(Xy)return Yy;Xy=1;var t=Jh(),e=Vh(),i=SI(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===s&&(s=255),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=s,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(i.FLASH_START,this.camera,this,t,e,n,s)),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return Yy=n}function UI(){if(Wy)return Gy;Wy=1;var t=Jh(),e=Vh(),i=vD(),n=SI(),s=Ru(),r=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new s,this.current=new s,this.destination=new s,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=i.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene);var l=this.camera;return!a&&this.isRunning||(this.isRunning=!0,this.duration=s,this.progress=0,this.source.set(l.scrollX,l.scrollY),this.destination.set(t,e),l.getScroll(t,e,this.current),"string"==typeof r&&i.hasOwnProperty(r)?this.ease=i[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.camera.emit(n.PAN_START,this.camera,this,s,t,e)),l},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);s.getScroll(this.destination.x,this.destination.y,this.current);var a=this.source.x+(this.current.x-this.source.x)*r,o=this.source.y+(this.current.y-this.source.y)*r;s.setScroll(a,o),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,a,o)}else s.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,s.scrollX,s.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return Gy=r}function zI(){if(Vy)return Hy;Vy=1;var t=Jh(),e=Vh(),i=SI(),n=Ru(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new n,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===s&&(s=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"==typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=s,this._onUpdateScope=r,this.camera.emit(i.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(e,i){if(this.isRunning)if(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,s=this.camera.width,r=this.camera.height,a=this.camera.zoom;this._offsetX=(Math.random()*n.x*s*2-n.x*s)*a,this._offsetY=(Math.random()*n.y*r*2-n.y*r)*a,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});return Hy=s}function YI(){if(qy)return jy;qy=1;var t=Jh(),e=Vh(),i=SI(),n=vD(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=n.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),void 0===e&&(e=!1),this.shortestPath=e;var l=t;t<0?(l=-1*t,this.clockwise=!1):this.clockwise=!0;var u=360*Math.PI/180;l-=Math.floor(l/u)*u;var c=this.camera;if(!a&&this.isRunning)return c;if(this.isRunning=!0,this.duration=s,this.progress=0,this.source=c.rotation,this.destination=l,"string"==typeof r&&n.hasOwnProperty(r)?this.ease=n[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.shortestPath){var d,f;(d=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+u)-this.source)<(f=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+u)-this.destination)?this.clockwise=!0:d>f&&(this.clockwise=!1)}return this.camera.emit(i.ROTATE_START,this.camera,this,s,l),c},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);this.current=s.rotation;var a,o=360*Math.PI/180,h=this.destination,l=this.current;!1===this.clockwise&&(h=this.current,l=this.destination),a=h>=l?Math.abs(h-l):Math.abs(h+o)-l;var u;u=this.clockwise?s.rotation+a*r:s.rotation-a*r,s.rotation=u,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,u)}else s.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return jy=s}function XI(){if(Zy)return Ky;Zy=1;var t=Jh(),e=Vh(),i=vD(),n=SI(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o){void 0===e&&(e=1e3),void 0===s&&(s=i.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene);var h=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=h.zoom,this.destination=t,"string"==typeof s&&i.hasOwnProperty(s)?this.ease=i[s]:"function"==typeof s&&(this.ease=s),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(n.ZOOM_START,this.camera,this,e,t)),h},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return Ky=s}function GI(){return $y?Jy:($y=1,Jy={Fade:BI(),Flash:NI(),Pan:UI(),Shake:zI(),RotateTo:YI(),Zoom:XI()})}function WI(){return tx?Qy:(tx=1,Qy=function(t,e,i){return(e-t)*i+t})}function HI(){if(ix)return ex;ix=1;var t=II(),e=kI(),i=Jh(),n=Vh(),s=ac(),r=GI(),a=SI(),o=WI(),h=Fu(),l=Ru(),u=new n({Extends:t,Mixins:[s.PostPipeline],initialize:function(e,i,n,s){t.call(this,e,i,n,s),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new r.Fade(this),this.flashEffect=new r.Flash(this),this.shakeEffect=new r.Shake(this),this.panEffect=new r.Pan(this),this.rotateToEffect=new r.RotateTo(this),this.zoomEffect=new r.Zoom(this),this.lerp=new l(1,1),this.followOffset=new l,this.deadzone=null,this._follow=null},setDeadzone:function(t,i){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=i):this.deadzone=new h(0,0,t,i),this._follow){var n=this.width/2,s=this.height/2,r=this._follow.x-this.followOffset.x,a=this._follow.y-this.followOffset.y;this.midPoint.set(r,a),this.scrollX=r-n,this.scrollY=a-s}e(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,i,n,s,r){return this.fadeEffect.start(!1,t,e,i,n,!0,s,r)},fadeOut:function(t,e,i,n,s,r){return this.fadeEffect.start(!0,t,e,i,n,!0,s,r)},fadeFrom:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!1,t,e,i,n,s,r,a)},fade:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!0,t,e,i,n,s,r,a)},flash:function(t,e,i,n,s,r,a){return this.flashEffect.start(t,e,i,n,s,r,a)},shake:function(t,e,i,n,s){return this.shakeEffect.start(t,e,i,n,s)},pan:function(t,e,i,n,s,r,a){return this.panEffect.start(t,e,i,n,s,r,a)},rotateTo:function(t,e,i,n,s,r,a){return this.rotateToEffect.start(t,e,i,n,s,r,a)},zoomTo:function(t,e,i,n,s,r){return this.zoomEffect.start(t,e,i,n,s,r)},preRender:function(){this.renderList.length=0;var t=this.width,i=this.height,n=.5*t,s=.5*i,r=this.zoomX,h=this.zoomY,l=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(r)&&Number.isInteger(h);var u=t*this.originX,c=i*this.originY,d=this._follow,f=this.deadzone,p=this.scrollX,g=this.scrollY;f&&e(f,this.midPoint.x,this.midPoint.y);var v=!1;if(d&&!this.panEffect.isRunning){var m=this.lerp,y=d.x-this.followOffset.x,x=d.y-this.followOffset.y;f?(y<f.x?p=o(p,p-(f.x-y),m.x):y>f.right&&(p=o(p,p+(y-f.right),m.x)),x<f.y?g=o(g,g-(f.y-x),m.y):x>f.bottom&&(g=o(g,g+(x-f.bottom),m.y))):(p=o(p,y-u,m.x),g=o(g,x-c,m.y)),v=!0}this.roundPixels&&(p=Math.floor(p),g=Math.floor(g)),this.useBounds&&(p=this.clampX(p),g=this.clampY(g)),this.scrollX=p,this.scrollY=g;var w=p+n,T=g+s;this.midPoint.set(w,T);var b=Math.floor(t/r+.5),S=Math.floor(i/h+.5),E=Math.floor(w-b/2+.5),_=Math.floor(T-S/2+.5);this.worldView.setTo(E,_,b,S),l.applyITRS(Math.floor(this.x+u+.5),Math.floor(this.y+c+.5),this.rotation,r,h),l.translate(-u,-c),this.shakeEffect.preRender(),v&&this.emit(a.FOLLOW_UPDATE,this,d)},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,s,r,a){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===s&&(s=n),void 0===r&&(r=0),void 0===a&&(a=r),this._follow=t,this.roundPixels=e,n=i(n,0,1),s=i(s,0,1),this.lerp.set(n,s),this.followOffset.set(r,a);var o=this.width/2,h=this.height/2,l=t.x-r,u=t.y-a;return this.midPoint.set(l,u),this.scrollX=l-o,this.scrollY=u-h,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.rotateToEffect.update(t,e),this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.resetFX(),t.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});return ex=u}function VI(){return vx?gx:(vx=1,gx={ENTER_FULLSCREEN:sx?nx:(sx=1,nx="enterfullscreen"),FULLSCREEN_FAILED:ax?rx:(ax=1,rx="fullscreenfailed"),FULLSCREEN_UNSUPPORTED:hx?ox:(hx=1,ox="fullscreenunsupported"),LEAVE_FULLSCREEN:ux?lx:(ux=1,lx="leavefullscreen"),ORIENTATION_CHANGE:dx?cx:(dx=1,cx="orientationchange"),RESIZE:px?fx:(px=1,fx="resize")})}function jI(){if(yx)return mx;yx=1;var t=HI(),e=Vh(),i=Wh(),n=ku(),s=Tu(),r=VI(),a=Bu(),o=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,t.sys.events.once(a.BOOT,this.boot,this),t.sys.events.on(a.START,this.start,this)},boot:function(){var e=this.systems;e.settings.cameras?this.fromJSON(e.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new t(0,0,e.scale.width,e.scale.height).setScene(this.scene),e.game.scale.on(r.RESIZE,this.onResize,this),this.systems.events.once(a.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(a.UPDATE,this.update,this),e.once(a.SHUTDOWN,this.shutdown,this)},add:function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===s&&(s=this.scene.sys.scale.height),void 0===r&&(r=!1),void 0===a&&(a="");var o=new t(e,i,n,s);return o.setName(a),o.setScene(this.scene),o.setRoundPixels(this.roundPixels),o.id=this.getNextID(),this.cameras.push(o),r&&(this.main=o),o},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,i=0;i<32;i++){for(var n=!1,s=0;s<t.length;s++){var r=t[s];r&&r.id===e&&(n=!0)}if(!n)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,i=this.cameras,n=0;n<i.length;n++){var s=i[n];(!t||t&&s.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,s=0;s<t.length;s++){var r=t[s],a=i(r,"x",0),o=i(r,"y",0),h=i(r,"width",e),l=i(r,"height",n),u=this.add(a,o,h,l);u.name=i(r,"name",""),u.zoom=i(r,"zoom",1),u.rotation=i(r,"rotation",0),u.scrollX=i(r,"scrollX",0),u.scrollY=i(r,"scrollY",0),u.roundPixels=i(r,"roundPixels",!1),u.visible=i(r,"visible",!0);var c=i(r,"backgroundColor",!1);c&&u.setBackgroundColor(c);var d=i(r,"bounds",null);if(d){var f=i(d,"x",0),p=i(d,"y",0),g=i(d,"width",e),v=i(d,"height",n);u.setBounds(f,p,g,v)}}return this},getCamera:function(t){for(var e=this.cameras,i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,i=t.x,n=t.y,r=[],a=0;a<e.length;a++){var o=e[a];o.visible&&o.inputEnabled&&s(o,i,n)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0,n=this.cameras,s=0;s<t.length;s++){var r=n.indexOf(t[s]);-1!==r&&(e?n[r].destroy():n[r].renderList=[],n.splice(r,1),i++)}return!this.main&&n[0]&&(this.main=n[0]),i},render:function(t,e){for(var i=this.scene,n=this.cameras,s=0;s<n.length;s++){var r=n[s];if(r.visible&&r.alpha>0){r.preRender();var a=this.getVisibleChildren(e.getChildren(),r);t.render(i,a,r)}}},getVisibleChildren:function(t,e){return t.filter(function(t){return t.willRender(e)})},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].update(t,e)},onResize:function(t,e,i,n,s){for(var r=0;r<this.cameras.length;r++){var a=this.cameras[r];0===a._x&&0===a._y&&a._width===n&&a._height===s&&a.setSize(e.width,e.height)}},resize:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(a.UPDATE,this.update,this),e.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(a.START,this.start,this),this.systems.events.off(a.DESTROY,this.destroy,this),this.systems.game.scale.off(r.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});return n.register("CameraManager",o,"cameras"),mx=o}function qI(){if(Ex)return Sx;Ex=1;var t={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};return t.DefaultScene.push("CameraManager3D"),t.Global.push("facebook"),Sx=t}function KI(){return Cx?_x:(Cx=1,_x=function(t,e,i,n){return Math.atan2(n-e,i-t)})}function ZI(){return Px?Ax:(Px=1,Ax=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)})}function JI(){if(Dx)return Fx;Dx=1;var t=Qh();return Fx=function(e){return e>Math.PI&&(e-=t.PI2),Math.abs(((e+t.TAU)%t.PI2-t.PI2)%t.PI2)},Fx}function $I(){return kx||(kx=1,Ix=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI}),Ix}function QI(){if(Nx)return Bx;Nx=1;var t=$I();return Bx=function(e,i){return t(i-e)}}function tk(){if(zx)return Ux;zx=1;var t=$I(),e=2*Math.PI;return Ux=function(i,n){var s=t(n-i);return s>0&&(s-=e),s},Ux}function ek(){if(Xx)return Yx;Xx=1;var t=nc();return Yx=function(e,i){return t(i-e)}}function ik(){return Wx?Gx:(Wx=1,Gx=function(t,e){return Math.random()*(e-t)+t})}function nk(){if(Vx)return Hx;Vx=1;var t=ik();return Hx=function(){return t(-Math.PI,Math.PI)}}function sk(){if(qx)return jx;qx=1;var t=ik();return jx=function(){return t(-180,180)}}function rk(){if(Zx)return Kx;Zx=1;var t=$I();return Kx=function(e){return t(e+Math.PI)},Kx}function ak(){if($x)return Jx;$x=1;var t=Qh();return Jx=function(e,i,n){return void 0===n&&(n=.05),e===i||(Math.abs(i-e)<=n||Math.abs(i-e)>=t.PI2-n?e=i:(Math.abs(i-e)>Math.PI&&(i<e?i+=t.PI2:i-=t.PI2),i>e?e+=n:i<e&&(e-=n))),e}}function ok(){return dw?cw:(dw=1,cw=function(t,e,i,n){var s=t-i,r=e-n;return s*s+r*r})}function hk(){return bw?Tw:(bw=1,Tw=function(t,e,i){return void 0===i&&(i=1e-4),t>e-i})}function lk(){return Ew?Sw:(Ew=1,Sw=function(t,e,i){return void 0===i&&(i=1e-4),t<e+i})}function uk(){return Pw?Aw:(Pw=1,Aw=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e})}function ck(){if(Rw)return Mw;Rw=1;var t=uk();return Mw=function(e,i){return t(e)/t(i)/t(e-i)}}function dk(){if(Ow)return Lw;Ow=1;var t=ck();return Lw=function(e,i){for(var n=0,s=e.length-1,r=0;r<=s;r++)n+=Math.pow(1-i,s-r)*Math.pow(i,r)*e[r]*t(s,r);return n}}function fk(){return Dw?Fw:(Dw=1,Fw=function(t,e,i,n,s){var r=.5*(n-e),a=.5*(s-i),o=t*t;return(2*i-2*n+r+a)*(t*o)+(-3*i+3*n-2*r-a)*o+r*t+i})}function pk(){if(kw)return Iw;kw=1;var t=fk();return Iw=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return e[0]===e[n]?(i<0&&(r=Math.floor(s=n*(1+i))),t(s-r,e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n])):i<0?e[0]-(t(-s,e[0],e[0],e[1],e[1])-e[0]):i>1?e[n]-(t(s-n,e[n],e[n],e[n-1],e[n-1])-e[n]):t(s-r,e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2])}}function gk(){return Nw?Bw:(Nw=1,Bw=function(t,e,i,n,s){return function(t,e){var i=1-t;return i*i*i*e}(t,e)+function(t,e){var i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,s)})}function vk(){if(zw)return Uw;zw=1;var t=WI();return Uw=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return i<0?t(e[0],e[1],s):i>1?t(e[n],e[n-1],n-s):t(e[r],e[r+1>n?n:r+1],s-r)}}function mk(){return Xw?Yw:(Xw=1,Yw=function(t,e,i,n){return function(t,e){var i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)})}function yk(){if(Ww)return Gw;Ww=1;var t=aI();return Gw=function(e,i,n){return i+(n-i)*t(e,0,1)}}function xk(){if(Vw)return Hw;Vw=1;var t=sI();return Hw=function(e,i,n){return i+(n-i)*t(e,0,1)}}function wk(){return Zw?Kw:(Zw=1,Kw=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)})}function Tk(){return $w?Jw:($w=1,Jw=function(t,e){return t>0&&!(t&t-1)&&e>0&&!(e&e-1)})}function bk(){return sT?nT:(sT=1,nT=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.ceil(t/e),n?(i+t)/e:i+t)})}function Sk(){return aT?rT:(aT=1,rT=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.floor(t/e),n?(i+t)/e:i+t)})}function Ek(){return hT?oT:(hT=1,oT=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.round(t/e),n?(i+t)/e:i+t)})}function _k(){if(dT)return cT;dT=1;var t=new(Vh())({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,i=this.n;t=t.toString();for(var n=0;n<t.length;n++)e=.02519603282416938*(i+=t.charCodeAt(n)),e-=i=e>>>0,i=(e*=i)>>>0,i+=4294967296*(e-=i);return this.n=i,2.3283064365386963e-10*(i>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-.5)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(this.frac()*(e+1)),n=t[i];t[i]=t[e],t[e]=n}return t}});return cT=t}function Ck(){if(wT)return xT;wT=1;var t=new(Vh())({initialize:function(t,e,i){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new t(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},crossVectors:function(t,e){var i=t.x,n=t.y,s=t.z,r=e.x,a=e.y,o=e.z;return this.x=n*o-s*a,this.y=s*r-i*o,this.z=i*a-n*r,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return Math.sqrt(e*e+i*i+n*n)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return e*e+i*i+n*n},length:function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},lengthSq:function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},normalize:function(){var t=this.x,e=this.y,i=this.z,n=t*t+e*e+i*i;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n,this.z=i*n),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z;return this.x=i*a-n*r,this.y=n*s-e*a,this.z=e*r-i*s,this},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this},transformMat3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=e*s[0]+i*s[3]+n*s[6],this.y=e*s[1]+i*s[4]+n*s[7],this.z=e*s[2]+i*s[5]+n*s[8],this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12],this.y=s[1]*e+s[5]*i+s[9]*n+s[13],this.z=s[2]*e+s[6]*i+s[10]*n+s[14],this},transformCoordinates:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=e*s[0]+i*s[4]+n*s[8]+s[12],a=e*s[1]+i*s[5]+n*s[9]+s[13],o=e*s[2]+i*s[6]+n*s[10]+s[14],h=e*s[3]+i*s[7]+n*s[11]+s[15];return this.x=r/h,this.y=a/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},project:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],d=s[7],f=s[8],p=s[9],g=s[10],v=s[11],m=s[12],y=s[13],x=s[14],w=1/(e*h+i*d+n*v+s[15]);return this.x=(e*r+i*l+n*f+m)*w,this.y=(e*a+i*u+n*p+y)*w,this.z=(e*o+i*c+n*g+x)*w,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=this.x-i,o=r-this.y-1-n,h=this.z;return this.x=2*a/s-1,this.y=2*o/r-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});return t.ZERO=new t,t.RIGHT=new t(1,0,0),t.LEFT=new t(-1,0,0),t.UP=new t(0,-1,0),t.DOWN=new t(0,1,0),t.FORWARD=new t(0,0,1),t.BACK=new t(0,0,-1),t.ONE=new t(1,1,1),xT=t}function Ak(){if(bT)return TT;bT=1;var t=Vh(),e=Ck(),i=1e-6,n=new t({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new n(this)},set:function(t){return this.copy(t)},setValues:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g){var v=this.val;return v[0]=t,v[1]=e,v[2]=i,v[3]=n,v[4]=s,v[5]=r,v[6]=a,v[7]=o,v[8]=h,v[9]=l,v[10]=u,v[11]=c,v[12]=d,v[13]=f,v[14]=p,v[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,i){var n=s.fromQuat(i).val,r=e.x,a=e.y,o=e.z;return this.setValues(n[0]*r,n[1]*r,n[2]*r,0,n[4]*a,n[5]*a,n[6]*a,0,n[8]*o,n[9]*o,n[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,i){this.identity();var n=this.val;return n[12]=t,n[13]=e,n[14]=i,this},scaling:function(t,e,i){this.zero();var n=this.val;return n[0]=t,n[5]=e,n[10]=i,n[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[3],s=t[6],r=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=s,t[11]=t[14],t[12]=n,t[13]=r,t[14]=a,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15],m=e*a-i*r,y=e*o-n*r,x=e*h-s*r,w=i*o-n*a,T=i*h-s*a,b=n*h-s*o,S=l*p-u*f,E=l*g-c*f,_=l*v-d*f,C=u*g-c*p,A=u*v-d*p,P=c*v-d*g,M=m*P-y*A+x*C+w*_-T*E+b*S;return M?(M=1/M,this.setValues((a*P-o*A+h*C)*M,(n*A-i*P-s*C)*M,(p*b-g*T+v*w)*M,(c*T-u*b-d*w)*M,(o*_-r*P-h*E)*M,(e*P-n*_+s*E)*M,(g*x-f*b-v*y)*M,(l*b-c*x+d*y)*M,(r*A-a*_+h*S)*M,(i*_-e*A-s*S)*M,(f*T-p*x+v*m)*M,(u*x-l*T-d*m)*M,(a*E-r*C-o*S)*M,(e*C-i*E+n*S)*M,(p*y-f*w-g*m)*M,(l*w-u*y+c*m)*M)):this},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return this.setValues(a*(c*v-d*g)-u*(o*v-h*g)+p*(o*d-h*c),-(i*(c*v-d*g)-u*(n*v-s*g)+p*(n*d-s*c)),i*(o*v-h*g)-a*(n*v-s*g)+p*(n*h-s*o),-(i*(o*d-h*c)-a*(n*d-s*c)+u*(n*h-s*o)),-(r*(c*v-d*g)-l*(o*v-h*g)+f*(o*d-h*c)),e*(c*v-d*g)-l*(n*v-s*g)+f*(n*d-s*c),-(e*(o*v-h*g)-r*(n*v-s*g)+f*(n*h-s*o)),e*(o*d-h*c)-r*(n*d-s*c)+l*(n*h-s*o),r*(u*v-d*p)-l*(a*v-h*p)+f*(a*d-h*u),-(e*(u*v-d*p)-l*(i*v-s*p)+f*(i*d-s*u)),e*(a*v-h*p)-r*(i*v-s*p)+f*(i*h-s*a),-(e*(a*d-h*u)-r*(i*d-s*u)+l*(i*h-s*a)),-(r*(u*g-c*p)-l*(a*g-o*p)+f*(a*c-o*u)),e*(u*g-c*p)-l*(i*g-n*p)+f*(i*c-n*u),-(e*(a*g-o*p)-r*(i*g-n*p)+f*(i*o-n*a)),e*(a*c-o*u)-r*(i*c-n*u)+l*(i*o-n*a))},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],v=t[15];return(e*a-i*r)*(c*v-d*g)-(e*o-n*r)*(u*v-d*p)+(e*h-s*r)*(u*g-c*p)+(i*o-n*a)*(l*v-d*f)-(i*h-s*a)*(l*g-c*f)+(n*h-s*o)*(l*p-u*f)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=e[9],d=e[10],f=e[11],p=e[12],g=e[13],v=e[14],m=e[15],y=t.val,x=y[0],w=y[1],T=y[2],b=y[3];return e[0]=x*i+w*a+T*u+b*p,e[1]=x*n+w*o+T*c+b*g,e[2]=x*s+w*h+T*d+b*v,e[3]=x*r+w*l+T*f+b*m,x=y[4],w=y[5],T=y[6],b=y[7],e[4]=x*i+w*a+T*u+b*p,e[5]=x*n+w*o+T*c+b*g,e[6]=x*s+w*h+T*d+b*v,e[7]=x*r+w*l+T*f+b*m,x=y[8],w=y[9],T=y[10],b=y[11],e[8]=x*i+w*a+T*u+b*p,e[9]=x*n+w*o+T*c+b*g,e[10]=x*s+w*h+T*d+b*v,e[11]=x*r+w*l+T*f+b*m,x=y[12],w=y[13],T=y[14],b=y[15],e[12]=x*i+w*a+T*u+b*p,e[13]=x*n+w*o+T*c+b*g,e[14]=x*s+w*h+T*d+b*v,e[15]=x*r+w*l+T*f+b*m,this},multiplyLocal:function(t){var e=this.val,i=t.val;return this.setValues(e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+e[3]*i[12],e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+e[3]*i[13],e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+e[3]*i[14],e[0]*i[3]+e[1]*i[7]+e[2]*i[11]+e[3]*i[15],e[4]*i[0]+e[5]*i[4]+e[6]*i[8]+e[7]*i[12],e[4]*i[1]+e[5]*i[5]+e[6]*i[9]+e[7]*i[13],e[4]*i[2]+e[5]*i[6]+e[6]*i[10]+e[7]*i[14],e[4]*i[3]+e[5]*i[7]+e[6]*i[11]+e[7]*i[15],e[8]*i[0]+e[9]*i[4]+e[10]*i[8]+e[11]*i[12],e[8]*i[1]+e[9]*i[5]+e[10]*i[9]+e[11]*i[13],e[8]*i[2]+e[9]*i[6]+e[10]*i[10]+e[11]*i[14],e[8]*i[3]+e[9]*i[7]+e[10]*i[11]+e[11]*i[15],e[12]*i[0]+e[13]*i[4]+e[14]*i[8]+e[15]*i[12],e[12]*i[1]+e[13]*i[5]+e[14]*i[9]+e[15]*i[13],e[12]*i[2]+e[13]*i[6]+e[14]*i[10]+e[15]*i[14],e[12]*i[3]+e[13]*i[7]+e[14]*i[11]+e[15]*i[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.val,n=e.val,s=i[0],r=i[4],a=i[8],o=i[12],h=i[1],l=i[5],u=i[9],c=i[13],d=i[2],f=i[6],p=i[10],g=i[14],v=i[3],m=i[7],y=i[11],x=i[15],w=n[0],T=n[4],b=n[8],S=n[12],E=n[1],_=n[5],C=n[9],A=n[13],P=n[2],M=n[6],R=n[10],L=n[14],O=n[3],F=n[7],D=n[11],I=n[15];return this.setValues(s*w+r*E+a*P+o*O,h*w+l*E+u*P+c*O,d*w+f*E+p*P+g*O,v*w+m*E+y*P+x*O,s*T+r*_+a*M+o*F,h*T+l*_+u*M+c*F,d*T+f*_+p*M+g*F,v*T+m*_+y*M+x*F,s*b+r*C+a*R+o*D,h*b+l*C+u*R+c*D,d*b+f*C+p*R+g*D,v*b+m*C+y*R+x*D,s*S+r*A+a*L+o*I,h*S+l*A+u*L+c*I,d*S+f*A+p*L+g*I,v*S+m*A+y*L+x*I)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,i){var n=this.val;return n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,i){var n=this.val;return n[0]=n[0]*t,n[1]=n[1]*t,n[2]=n[2]*t,n[3]=n[3]*t,n[4]=n[4]*e,n[5]=n[5]*e,n[6]=n[6]*e,n[7]=n[7]*e,n[8]=n[8]*i,n[9]=n[9]*i,n[10]=n[10]*i,n[11]=n[11]*i,this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,a=t.y,o=t.z,h=s*r,l=s*a;return this.setValues(h*r+i,h*a-n*o,h*o+n*a,0,h*a+n*o,l*a+i,l*o-n*r,0,h*o-n*a,l*o+n*r,s*o*o+i,0,0,0,0,1)},rotate:function(t,e){var n=this.val,s=e.x,r=e.y,a=e.z,o=Math.sqrt(s*s+r*r+a*a);if(Math.abs(o)<i)return this;s*=o=1/o,r*=o,a*=o;var h=Math.sin(t),l=Math.cos(t),u=1-l,c=n[0],d=n[1],f=n[2],p=n[3],g=n[4],v=n[5],m=n[6],y=n[7],x=n[8],w=n[9],T=n[10],b=n[11],S=n[12],E=n[13],_=n[14],C=n[15],A=s*s*u+l,P=r*s*u+a*h,M=a*s*u-r*h,R=s*r*u-a*h,L=r*r*u+l,O=a*r*u+s*h,F=s*a*u+r*h,D=r*a*u-s*h,I=a*a*u+l;return this.setValues(c*A+g*P+x*M,d*A+v*P+w*M,f*A+m*P+T*M,p*A+y*P+b*M,c*R+g*L+x*O,d*R+v*L+w*O,f*R+m*L+T*O,p*R+y*L+b*O,c*F+g*D+x*I,d*F+v*D+w*I,f*F+m*D+T*I,p*F+y*D+b*I,S,E,_,C)},rotateX:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[4],r=e[5],a=e[6],o=e[7],h=e[8],l=e[9],u=e[10],c=e[11];return e[4]=s*n+h*i,e[5]=r*n+l*i,e[6]=a*n+u*i,e[7]=o*n+c*i,e[8]=h*n-s*i,e[9]=l*n-r*i,e[10]=u*n-a*i,e[11]=c*n-o*i,this},rotateY:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[8],l=e[9],u=e[10],c=e[11];return e[0]=s*n-h*i,e[1]=r*n-l*i,e[2]=a*n-u*i,e[3]=o*n-c*i,e[8]=s*i+h*n,e[9]=r*i+l*n,e[10]=a*i+u*n,e[11]=o*i+c*n,this},rotateZ:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[4],l=e[5],u=e[6],c=e[7];return e[0]=s*n+h*i,e[1]=r*n+l*i,e[2]=a*n+u*i,e[3]=o*n+c*i,e[4]=h*n-s*i,e[5]=l*n-r*i,e[6]=u*n-a*i,e[7]=c*n-o*i,this},fromRotationTranslation:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=i+i,o=n+n,h=s+s,l=i*a,u=i*o,c=i*h,d=n*o,f=n*h,p=s*h,g=r*a,v=r*o,m=r*h;return this.setValues(1-(d+p),u+m,c-v,0,u-m,1-(l+p),f+g,0,c+v,f-g,1-(l+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,v=s*o;return this.setValues(1-(c+f),l+v,u-g,0,l-v,1-(h+f),d+p,0,u+g,d-p,1-(h+c),0,0,0,0,1)},frustum:function(t,e,i,n,s,r){var a=1/(e-t),o=1/(n-i),h=1/(s-r);return this.setValues(2*s*a,0,0,0,0,2*s*o,0,0,(e+t)*a,(n+i)*o,(r+s)*h,-1,0,0,r*s*2*h,0)},perspective:function(t,e,i,n){var s=1/Math.tan(t/2),r=1/(i-n);return this.setValues(s/e,0,0,0,0,s,0,0,0,0,(n+i)*r,-1,0,0,2*n*i*r,0)},perspectiveLH:function(t,e,i,n){return this.setValues(2*i/t,0,0,0,0,2*i/e,0,0,0,0,-n/(i-n),1,0,0,i*n/(i-n),0)},ortho:function(t,e,i,n,s,r){var a=t-e,o=i-n,h=s-r;return a=0===a?a:1/a,o=0===o?o:1/o,h=0===h?h:1/h,this.setValues(-2*a,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*a,(n+i)*o,(r+s)*h,1)},lookAtRH:function(t,e,i){var n=this.val;return h.subVectors(t,e),0===h.lengthSq()&&(h.z=1),h.normalize(),a.crossVectors(i,h),0===a.lengthSq()&&(1===Math.abs(i.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),a.crossVectors(i,h)),a.normalize(),o.crossVectors(h,a),n[0]=a.x,n[1]=a.y,n[2]=a.z,n[4]=o.x,n[5]=o.y,n[6]=o.z,n[8]=h.x,n[9]=h.y,n[10]=h.z,this},lookAt:function(t,e,n){var s=t.x,r=t.y,a=t.z,o=n.x,h=n.y,l=n.z,u=e.x,c=e.y,d=e.z;if(Math.abs(s-u)<i&&Math.abs(r-c)<i&&Math.abs(a-d)<i)return this.identity();var f=s-u,p=r-c,g=a-d,v=1/Math.sqrt(f*f+p*p+g*g),m=h*(g*=v)-l*(p*=v),y=l*(f*=v)-o*g,x=o*p-h*f;(v=Math.sqrt(m*m+y*y+x*x))?(m*=v=1/v,y*=v,x*=v):(m=0,y=0,x=0);var w=p*x-g*y,T=g*m-f*x,b=f*y-p*m;return(v=Math.sqrt(w*w+T*T+b*b))?(w*=v=1/v,T*=v,b*=v):(w=0,T=0,b=0),this.setValues(m,w,f,0,y,T,p,0,x,b,g,0,-(m*s+y*r+x*a),-(w*s+T*r+b*a),-(f*s+p*r+g*a),1)},yawPitchRoll:function(t,e,i){this.zero(),s.zero(),r.zero();var n=this.val,a=s.val,o=r.val,h=Math.sin(i),l=Math.cos(i);return n[10]=1,n[15]=1,n[0]=l,n[1]=h,n[4]=-h,n[5]=l,h=Math.sin(e),l=Math.cos(e),a[0]=1,a[15]=1,a[5]=l,a[10]=l,a[9]=-h,a[6]=h,h=Math.sin(t),l=Math.cos(t),o[5]=1,o[15]=1,o[0]=l,o[2]=-h,o[8]=h,o[10]=l,this.multiplyLocal(s),this.multiplyLocal(r),this},setWorldMatrix:function(t,e,i,n,a){return this.yawPitchRoll(t.y,t.x,t.z),s.scaling(i.x,i.y,i.z),r.xyz(e.x,e.y,e.z),this.multiplyLocal(s),this.multiplyLocal(r),n&&this.multiplyLocal(n),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var i=this.val,n=t.val,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=i[6],c=i[7],d=i[8],f=i[9],p=i[10],g=i[11],v=i[12],m=i[13],y=i[14],x=i[15],w=n[0],T=n[1],b=n[2],S=n[3],E=n[4],_=n[5],C=n[6],A=n[7],P=n[8],M=n[9],R=n[10],L=n[11],O=n[12],F=n[13],D=n[14],I=n[15];return e.setValues(w*s+T*h+b*d+S*v,T*r+T*l+b*f+S*m,b*a+T*u+b*p+S*y,S*o+T*c+b*g+S*x,E*s+_*h+C*d+A*v,E*r+_*l+C*f+A*m,E*a+_*u+C*p+A*y,E*o+_*c+C*g+A*x,P*s+M*h+R*d+L*v,P*r+M*l+R*f+L*m,P*a+M*u+R*p+L*y,P*o+M*c+R*g+L*x,O*s+F*h+D*d+I*v,O*r+F*l+D*f+I*m,O*a+F*u+D*p+I*y,O*o+F*c+D*g+I*x)},fromRotationXYTranslation:function(t,e,i){var n=e.x,s=e.y,r=e.z,a=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),l=Math.cos(t.y),u=n,c=s,d=r,f=-a,p=0-f*h,g=0-o*h,v=f*l,m=o*l;return i||(u=l*n+h*r,c=p*n+o*s+v*r,d=g*n+a*s+m*r),this.setValues(l,p,g,0,0,o,a,0,h,v,m,0,u,c,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}}),s=new n,r=new n,a=new e,o=new e,h=new e;return TT=n}function Pk(){if(ET)return ST;ET=1;var t=Jh(),e=Vh(),i=Ak(),n=Hh(),s=new i,r=new e({initialize:function t(e,i,s,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===r&&(r=t.DefaultOrder),this._x=e,this._y=i,this._z=s,this._order=r,this.onChangeCallback=n},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,i,n){return void 0===n&&(n=this._order),this._x=t,this._y=e,this._z=i,this._order=n,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,i){return void 0===e&&(e=this._order),void 0===i&&(i=!1),s.fromQuat(t),this.setFromRotationMatrix(s,e,i)},setFromRotationMatrix:function(e,i,n){void 0===i&&(i=this._order),void 0===n&&(n=!1);var s=e.val,r=s[0],a=s[4],o=s[8],h=s[1],l=s[5],u=s[9],c=s[2],d=s[6],f=s[10],p=0,g=0,v=0,m=.99999;switch(i){case"XYZ":g=Math.asin(t(o,-1,1)),Math.abs(o)<m?(p=Math.atan2(-u,f),v=Math.atan2(-a,r)):p=Math.atan2(d,l);break;case"YXZ":p=Math.asin(-t(u,-1,1)),Math.abs(u)<m?(g=Math.atan2(o,f),v=Math.atan2(h,l)):g=Math.atan2(-c,r);break;case"ZXY":p=Math.asin(t(d,-1,1)),Math.abs(d)<m?(g=Math.atan2(-c,f),v=Math.atan2(-a,l)):v=Math.atan2(h,r);break;case"ZYX":g=Math.asin(-t(c,-1,1)),Math.abs(c)<m?(p=Math.atan2(d,f),v=Math.atan2(h,r)):v=Math.atan2(-a,l);break;case"YZX":v=Math.asin(t(h,-1,1)),Math.abs(h)<m?(p=Math.atan2(-u,l),g=Math.atan2(-c,r)):g=Math.atan2(o,f);break;case"XZY":v=Math.asin(-t(a,-1,1)),Math.abs(a)<m?(p=Math.atan2(d,l),g=Math.atan2(o,r)):p=Math.atan2(-u,f)}return this._x=p,this._y=g,this._z=v,this._order=i,n&&this.onChangeCallback(this),this}});return r.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],r.DefaultOrder="XYZ",ST=r}function Mk(){if(WT)return GT;WT=1;var t=Qh();return GT=function(e){return e*t.RAD_TO_DEG}}function Rk(){return $T||($T=1,JT=function(t,e){var i=t.x,n=t.y;return t.x=i*Math.cos(e)-n*Math.sin(e),t.y=i*Math.sin(e)+n*Math.cos(e),t}),JT}function Lk(){if(ab)return rb;ab=1;var t=Ru();return rb=function(e,i,n,s){void 0===s&&(s=new t);var r=0,a=0;return e>0&&e<=i*n&&(r=e>i-1?e-(a=Math.floor(e/i))*i:e),s.set(r,a)}}function Ok(){if(ub)return lb;ub=1;var t=new(Vh())({initialize:function(t,e,i,n){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},clone:function(){return new t(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,i,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this.x=t*s,this.y=e*s,this.z=i*s,this.w=n*s),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this.w=r+e*(t.w-r),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return Math.sqrt(e*e+i*i+n*n+s*s)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return e*e+i*i+n*n+s*s},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.val;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*s,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*s,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*s,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*s,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});return t.prototype.sub=t.prototype.subtract,t.prototype.mul=t.prototype.multiply,t.prototype.div=t.prototype.divide,t.prototype.dist=t.prototype.distance,t.prototype.distSq=t.prototype.distanceSq,t.prototype.len=t.prototype.length,t.prototype.lenSq=t.prototype.lengthSq,lb=t}function Fk(){if(db)return cb;db=1;var t=new(Vh())({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new t(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},fromMat4:function(t){var e=t.val,i=this.val;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=i,t[7]=n,this},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=l*r-a*h,c=-l*s+a*o,d=h*s-r*o,f=e*u+i*c+n*d;return f?(f=1/f,t[0]=u*f,t[1]=(-l*i+n*h)*f,t[2]=(a*i-n*r)*f,t[3]=c*f,t[4]=(l*e-n*o)*f,t[5]=(-a*e+n*s)*f,t[6]=d*f,t[7]=(-h*e+i*o)*f,t[8]=(r*e-i*s)*f,this):null},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return t[0]=r*l-a*h,t[1]=n*h-i*l,t[2]=i*a-n*r,t[3]=a*o-s*l,t[4]=e*l-n*o,t[5]=n*s-e*a,t[6]=s*h-r*o,t[7]=i*o-e*h,t[8]=e*r-i*s,this},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return e*(l*r-a*h)+i*(-l*s+a*o)+n*(h*s-r*o)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=t.val,d=c[0],f=c[1],p=c[2],g=c[3],v=c[4],m=c[5],y=c[6],x=c[7],w=c[8];return e[0]=d*i+f*r+p*h,e[1]=d*n+f*a+p*l,e[2]=d*s+f*o+p*u,e[3]=g*i+v*r+m*h,e[4]=g*n+v*a+m*l,e[5]=g*s+v*o+m*u,e[6]=y*i+x*r+w*h,e[7]=y*n+x*a+w*l,e[8]=y*s+x*o+w*u,this},translate:function(t){var e=this.val,i=t.x,n=t.y;return e[6]=i*e[0]+n*e[3]+e[6],e[7]=i*e[1]+n*e[4]+e[7],e[8]=i*e[2]+n*e[5]+e[8],this},rotate:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=Math.sin(t),l=Math.cos(t);return e[0]=l*i+h*r,e[1]=l*n+h*a,e[2]=l*s+h*o,e[3]=l*r-h*i,e[4]=l*a-h*n,e[5]=l*o-h*s,this},scale:function(t){var e=this.val,i=t.x,n=t.y;return e[0]=i*e[0],e[1]=i*e[1],e[2]=i*e[2],e[3]=n*e[3],e[4]=n*e[4],e[5]=n*e[5],this},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,v=s*o,m=this.val;return m[0]=1-(c+f),m[3]=l+v,m[6]=u-g,m[1]=l-v,m[4]=1-(h+f),m[7]=d+p,m[2]=u+g,m[5]=d-p,m[8]=1-(h+c),this},normalFromMat4:function(t){var e=t.val,i=this.val,n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],d=e[9],f=e[10],p=e[11],g=e[12],v=e[13],m=e[14],y=e[15],x=n*h-s*o,w=n*l-r*o,T=n*u-a*o,b=s*l-r*h,S=s*u-a*h,E=r*u-a*l,_=c*v-d*g,C=c*m-f*g,A=c*y-p*g,P=d*m-f*v,M=d*y-p*v,R=f*y-p*m,L=x*R-w*M+T*P+b*A-S*C+E*_;return L?(L=1/L,i[0]=(h*R-l*M+u*P)*L,i[1]=(l*A-o*R-u*C)*L,i[2]=(o*M-h*A+u*_)*L,i[3]=(r*M-s*R-a*P)*L,i[4]=(n*R-r*A+a*C)*L,i[5]=(s*A-n*M-a*_)*L,i[6]=(v*E-m*S+y*b)*L,i[7]=(m*T-g*E-y*w)*L,i[8]=(g*S-v*T+y*x)*L,this):null}});return cb=t}function Dk(){if(pb)return fb;pb=1;var t=Vh(),e=Fk(),i=Hh(),n=Ck(),s=1e-6,r=new Int8Array([1,2,0]),a=new Float32Array([0,0,0]),o=new n(1,0,0),h=new n(0,1,0),l=new n,u=new e,c=new t({initialize:function(t,e,n,s){this.onChangeCallback=i,this.set(t,e,n,s)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,i,n,s){return void 0===s&&(s=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=i||0,this._w=n||0),s&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this._x=t*s,this._y=e*s,this._z=i*s,this._w=n*s),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.set(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s),r+e*(t.w-r))},rotationTo:function(t,e){var i=t.x*e.x+t.y*e.y+t.z*e.z;return i<-.999999?(l.copy(o).cross(t).length()<s&&l.copy(h).cross(t),l.normalize(),this.setAxisAngle(l,Math.PI)):i>.999999?this.set(0,0,0,1):(l.copy(t).cross(e),this._x=l.x,this._y=l.y,this._z=l.z,this._w=1+i,this.normalize())},setAxes:function(t,e,i){var n=u.val;return n[0]=e.x,n[3]=e.y,n[6]=e.z,n[1]=i.x,n[4]=i.y,n[7]=i.z,n[2]=-t.x,n[5]=-t.y,n[8]=-t.z,this.fromMat3(u).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var i=Math.sin(e);return this.set(i*t.x,i*t.y,i*t.z,Math.cos(e))},multiply:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.x,a=t.y,o=t.z,h=t.w;return this.set(e*h+s*r+i*o-n*a,i*h+s*a+n*r-e*o,n*h+s*o+e*a-i*r,s*h-e*r-i*a-n*o)},slerp:function(t,e){var i=this.x,n=this.y,r=this.z,a=this.w,o=t.x,h=t.y,l=t.z,u=t.w,c=i*o+n*h+r*l+a*u;c<0&&(c=-c,o=-o,h=-h,l=-l,u=-u);var d=1-e,f=e;if(1-c>s){var p=Math.acos(c),g=Math.sin(p);d=Math.sin((1-e)*p)/g,f=Math.sin(e*p)/g}return this.set(d*i+f*o,d*n+f*h,d*r+f*l,d*a+f*u)},invert:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n,r=s?1/s:0;return this.set(-t*r,-e*r,-i*r,n*r)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+s*r,i*a+n*r,n*a-i*r,s*a-e*r)},rotateY:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a-n*r,i*a+s*r,n*a+e*r,s*a-i*r)},rotateZ:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+i*r,i*a-e*r,n*a+s*r,s*a-n*r)},calculateW:function(){var t=this.x,e=this.y,i=this.z;return this.w=-Math.sqrt(1-t*t-e*e-i*i),this},setFromEuler:function(t,e){var i=t.x/2,n=t.y/2,s=t.z/2,r=Math.cos(i),a=Math.cos(n),o=Math.cos(s),h=Math.sin(i),l=Math.sin(n),u=Math.sin(s);switch(t.order){case"XYZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"YXZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"ZXY":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"ZYX":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"YZX":this.set(h*a*o+r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o-h*l*u,e);break;case"XZY":this.set(h*a*o-r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o+h*l*u,e)}return this},setFromRotationMatrix:function(t){var e,i=t.val,n=i[0],s=i[4],r=i[8],a=i[1],o=i[5],h=i[9],l=i[2],u=i[6],c=i[10],d=n+o+c;return d>0?(e=.5/Math.sqrt(d+1),this.set((u-h)*e,(r-l)*e,(a-s)*e,.25/e)):n>o&&n>c?(e=2*Math.sqrt(1+n-o-c),this.set(.25*e,(s+a)/e,(r+l)/e,(u-h)/e)):o>c?(e=2*Math.sqrt(1+o-n-c),this.set((s+a)/e,.25*e,(h+u)/e,(r-l)/e)):(e=2*Math.sqrt(1+c-n-o),this.set((r+l)/e,(h+u)/e,.25*e,(a-s)/e)),this},fromMat3:function(t){var e,i=t.val,n=i[0]+i[4]+i[8];if(n>0)e=Math.sqrt(n+1),this.w=.5*e,e=.5/e,this._x=(i[7]-i[5])*e,this._y=(i[2]-i[6])*e,this._z=(i[3]-i[1])*e;else{var s=0;i[4]>i[0]&&(s=1),i[8]>i[3*s+s]&&(s=2);var o=r[s],h=r[o];e=Math.sqrt(i[3*s+s]-i[3*o+o]-i[3*h+h]+1),a[s]=.5*e,e=.5/e,a[o]=(i[3*o+s]+i[3*s+o])*e,a[h]=(i[3*h+s]+i[3*s+h])*e,this._x=a[0],this._y=a[1],this._z=a[2],this._w=(i[3*h+o]-i[3*o+h])*e}return this.onChangeCallback(this),this}});return fb=c}function Ik(){if(vb)return gb;vb=1;var t=Ck(),e=Ak(),i=Dk(),n=new e,s=new i,r=new t;return gb=function(t,e,i){return s.setAxisAngle(e,i),n.fromRotationTranslation(s,r.set(0,0,0)),t.transformMat4(n)}}function kk(){if(yb)return mb;yb=1;var t=Qh(),e=nh(),i={Angle:iw?ew:(iw=1,ew={Between:KI(),BetweenPoints:ZI(),BetweenPointsY:Rx?Mx:(Rx=1,Mx=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}),BetweenY:Ox?Lx:(Ox=1,Lx=function(t,e,i,n){return Math.atan2(i-t,n-e)}),CounterClockwise:JI(),GetClockwiseDistance:QI(),GetCounterClockwiseDistance:tk(),GetShortestDistance:ek(),Normalize:$I(),Random:nk(),RandomDegrees:sk(),Reverse:rk(),RotateTo:ak(),ShortestBetween:tw?Qx:(tw=1,Qx=function(t,e){var i=e-t;return 0===i?0:i-360*Math.floor((i- -180)/360)}),Wrap:nc(),WrapDegrees:sc()}),Distance:pw?fw:(pw=1,fw={Between:ID(),BetweenPoints:nD(),BetweenPointsSquared:sw?nw:(sw=1,nw=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}),Chebyshev:aw?rw:(aw=1,rw=function(t,e,i,n){return Math.max(Math.abs(t-i),Math.abs(e-n))}),Power:hw?ow:(hw=1,ow=function(t,e,i,n,s){return void 0===s&&(s=2),Math.sqrt(Math.pow(i-t,s)+Math.pow(n-e,s))}),Snake:uw?lw:(uw=1,lw=function(t,e,i,n){return Math.abs(t-i)+Math.abs(e-n)}),Squared:ok()}),Easing:vw?gw:(vw=1,gw={Back:sD(),Bounce:rD(),Circular:aD(),Cubic:oD(),Elastic:hD(),Expo:lD(),Linear:uD(),Quadratic:cD(),Quartic:dD(),Quintic:fD(),Sine:pD(),Stepped:gD()}),Fuzzy:Cw?_w:(Cw=1,_w={Ceil:yw?mw:(yw=1,mw=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}),Equal:Mu(),Floor:ww?xw:(ww=1,xw=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}),GreaterThan:hk(),LessThan:lk()}),Interpolation:qw?jw:(qw=1,jw={Bezier:dk(),CatmullRom:pk(),CubicBezier:gk(),Linear:vk(),QuadraticBezier:mk(),SmoothStep:yk(),SmootherStep:xk()}),Pow2:iT?eT:(iT=1,eT={GetNext:wk(),IsSize:Tk(),IsValue:tT?Qw:(tT=1,Qw=function(t){return t>0&&!(t&t-1)})}),Snap:uT?lT:(uT=1,lT={Ceil:bk(),Floor:Sk(),To:Ek()}),RandomDataGenerator:_k(),Average:pT?fT:(pT=1,fT=function(t){for(var e=0,i=0;i<t.length;i++)e+=+t[i];return e/t.length}),Bernstein:ck(),Between:vI(),CatmullRom:fk(),CeilTo:vT?gT:(vT=1,gT=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.ceil(t*n)/n}),Clamp:Jh(),DegToRad:Xu(),Difference:yT?mT:(yT=1,mT=function(t,e){return Math.abs(t-e)}),Euler:Pk(),Factorial:uk(),FloatBetween:ik(),FloorTo:CT?_T:(CT=1,_T=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.floor(t*n)/n}),FromPercent:$h(),GetSpeed:(PT||(PT=1,AT=function(t,e){return t/e/1e3}),AT),IsEven:RT?MT:(RT=1,MT=function(t){return t==parseFloat(t)?!(t%2):void 0}),IsEvenStrict:OT?LT:(OT=1,LT=function(t){return t===parseFloat(t)?!(t%2):void 0}),Linear:WI(),LinearXY:DT?FT:(DT=1,FT=function(t,e,i){return void 0===i&&(i=0),t.clone().lerp(e,i)}),MaxAdd:kT?IT:(kT=1,IT=function(t,e,i){return Math.min(t+e,i)}),Median:NT?BT:(NT=1,BT=function(t){var e=t.length;if(0===e)return 0;t.sort(function(t,e){return t-e});var i=Math.floor(e/2);return e%2==0?(t[i]+t[i-1])/2:t[i]}),MinSub:zT?UT:(zT=1,UT=function(t,e,i){return Math.max(t-e,i)}),Percent:XT?YT:(XT=1,YT=function(t,e,i,n){void 0===i&&(i=e+1);var s=(t-e)/(i-e);return s>1?void 0!==n?(s=(n-t)/(n-i))<0&&(s=0):s=1:s<0&&(s=0),s}),RadToDeg:Mk(),RandomXY:(VT||(VT=1,HT=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI;return t.x=Math.cos(i)*e,t.y=Math.sin(i)*e,t}),HT),RandomXYZ:qT?jT:(qT=1,jT=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI,n=2*Math.random()-1,s=Math.sqrt(1-n*n)*e;return t.x=Math.cos(i)*s,t.y=Math.sin(i)*s,t.z=n*e,t}),RandomXYZW:(ZT||(ZT=1,KT=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}),KT),Rotate:Rk(),RotateAround:Du(),RotateAroundDistance:DD(),RotateTo:(tb||(tb=1,QT=function(t,e,i,n,s){return t.x=e+s*Math.cos(n),t.y=i+s*Math.sin(n),t}),QT),RoundAwayFromZero:Ml(),RoundTo:ib?eb:(ib=1,eb=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.round(t*n)/n}),SinCosTableGenerator:sb?nb:(sb=1,nb=function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),n*=Math.PI/t;for(var s=[],r=[],a=0;a<t;a++)e+=(i-=e*n)*n,s[a]=i,r[a]=e;return{sin:r,cos:s,length:t}}),SmootherStep:sI(),SmoothStep:aI(),ToXY:Lk(),TransformXY:ec(),Within:hb?ob:(hb=1,ob=function(t,e,i){return Math.abs(t-e)<=i}),Wrap:ic(),Vector2:Ru(),Vector3:Ck(),Vector4:Ok(),Matrix3:Fk(),Matrix4:Ak(),Quaternion:Dk(),RotateVec3:Ik()};return i=e(!1,i,t),mb=i}function Bk(){return wb?xb:(wb=1,xb={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"})}function Nk(){if(bb)return Tb;bb=1;var t=Vh(),e=eh(),i=qI(),n=$l(),s=Wh(),r=Ol(),a=ih(),o=Hh(),h=kk(),l=Bk(),u=DI(),c=new t({initialize:function(t){void 0===t&&(t={});var c=r(t,"scale",null);this.width=r(c,"width",1024,t),this.height=r(c,"height",768,t),this.zoom=r(c,"zoom",1,t),this.parent=r(c,"parent",void 0,t),this.scaleMode=r(c,c?"mode":"scaleMode",0,t),this.expandParent=r(c,"expandParent",!0,t),this.autoRound=r(c,"autoRound",!1,t),this.autoCenter=r(c,"autoCenter",0,t),this.resizeInterval=r(c,"resizeInterval",500,t),this.fullscreenTarget=r(c,"fullscreenTarget",null,t),this.minWidth=r(c,"min.width",0,t),this.maxWidth=r(c,"max.width",0,t),this.minHeight=r(c,"min.height",0,t),this.maxHeight=r(c,"max.height",0,t),this.snapWidth=r(c,"snap.width",0,t),this.snapHeight=r(c,"snap.height",0,t),this.renderType=r(t,"type",e.AUTO),this.canvas=r(t,"canvas",null),this.context=r(t,"context",null),this.canvasStyle=r(t,"canvasStyle",null),this.customEnvironment=r(t,"customEnvironment",!1),this.sceneConfig=r(t,"scene",null),this.seed=r(t,"seed",[(Date.now()*Math.random()).toString()]),h.RND=new h.RandomDataGenerator(this.seed),this.gameTitle=r(t,"title",""),this.gameURL=r(t,"url","https://phaser.io/"+e.LOG_VERSION),this.gameVersion=r(t,"version",""),this.autoFocus=r(t,"autoFocus",!0),this.stableSort=r(t,"stableSort",-1),-1===this.stableSort&&(this.stableSort=n.browser.es2019?1:0),n.features.stableSort=this.stableSort,this.domCreateContainer=r(t,"dom.createContainer",!1),this.domPointerEvents=r(t,"dom.pointerEvents","none"),this.inputKeyboard=r(t,"input.keyboard",!0),this.inputKeyboardEventTarget=r(t,"input.keyboard.target",window),this.inputKeyboardCapture=r(t,"input.keyboard.capture",[]),this.inputMouse=r(t,"input.mouse",!0),this.inputMouseEventTarget=r(t,"input.mouse.target",null),this.inputMousePreventDefaultDown=r(t,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=r(t,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=r(t,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=r(t,"input.mouse.preventDefaultWheel",!0),this.inputTouch=r(t,"input.touch",n.input.touch),this.inputTouchEventTarget=r(t,"input.touch.target",null),this.inputTouchCapture=r(t,"input.touch.capture",!0),this.inputActivePointers=r(t,"input.activePointers",1),this.inputSmoothFactor=r(t,"input.smoothFactor",0),this.inputWindowEvents=r(t,"input.windowEvents",!0),this.inputGamepad=r(t,"input.gamepad",!1),this.inputGamepadEventTarget=r(t,"input.gamepad.target",window),this.disableContextMenu=r(t,"disableContextMenu",!1),this.audio=r(t,"audio",{}),this.hideBanner=!1===r(t,"banner",null),this.hidePhaser=r(t,"banner.hidePhaser",!1),this.bannerTextColor=r(t,"banner.text","#ffffff"),this.bannerBackgroundColor=r(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),""===this.gameTitle&&this.hidePhaser&&(this.hideBanner=!0),this.fps=r(t,"fps",null),this.disablePreFX=r(t,"disablePreFX",!1),this.disablePostFX=r(t,"disablePostFX",!1);var d=r(t,"render",null);this.pipeline=r(d,"pipeline",null,t),this.autoMobilePipeline=r(d,"autoMobilePipeline",!0,t),this.defaultPipeline=r(d,"defaultPipeline",l.MULTI_PIPELINE,t),this.antialias=r(d,"antialias",!0,t),this.antialiasGL=r(d,"antialiasGL",!0,t),this.mipmapFilter=r(d,"mipmapFilter","",t),this.desynchronized=r(d,"desynchronized",!1,t),this.roundPixels=r(d,"roundPixels",!1,t),this.pixelArt=r(d,"pixelArt",1!==this.zoom,t),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=r(d,"transparent",!1,t),this.clearBeforeRender=r(d,"clearBeforeRender",!0,t),this.preserveDrawingBuffer=r(d,"preserveDrawingBuffer",!1,t),this.premultipliedAlpha=r(d,"premultipliedAlpha",!0,t),this.failIfMajorPerformanceCaveat=r(d,"failIfMajorPerformanceCaveat",!1,t),this.powerPreference=r(d,"powerPreference","default",t),this.batchSize=r(d,"batchSize",4096,t),this.maxTextures=r(d,"maxTextures",-1,t),this.maxLights=r(d,"maxLights",10,t);var f=r(t,"backgroundColor",0);this.backgroundColor=u(f),this.transparent&&(this.backgroundColor=u(0),this.backgroundColor.alpha=0),this.preBoot=r(t,"callbacks.preBoot",o),this.postBoot=r(t,"callbacks.postBoot",o),this.physics=r(t,"physics",{}),this.defaultPhysicsSystem=r(this.physics,"default",!1),this.loaderBaseURL=r(t,"loader.baseURL",""),this.loaderPath=r(t,"loader.path",""),this.loaderMaxParallelDownloads=r(t,"loader.maxParallelDownloads",n.os.android?6:32),this.loaderCrossOrigin=r(t,"loader.crossOrigin",void 0),this.loaderResponseType=r(t,"loader.responseType",""),this.loaderAsync=r(t,"loader.async",!0),this.loaderUser=r(t,"loader.user",""),this.loaderPassword=r(t,"loader.password",""),this.loaderTimeout=r(t,"loader.timeout",0),this.loaderMaxRetries=r(t,"loader.maxRetries",2),this.loaderWithCredentials=r(t,"loader.withCredentials",!1),this.loaderImageLoadType=r(t,"loader.imageLoadType","XHR"),this.loaderLocalScheme=r(t,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=r(t,"fx.glow.quality",.1),this.glowFXDistance=r(t,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var p=r(t,"plugins",null),g=i.DefaultScene;p&&(Array.isArray(p)?this.defaultPlugins=p:a(p)&&(this.installGlobalPlugins=s(p,"global",[]),this.installScenePlugins=s(p,"scene",[]),Array.isArray(p.default)?g=p.default:Array.isArray(p.defaultMerge)&&(g=g.concat(p.defaultMerge)))),this.defaultPlugins=g;var v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=r(t,"images.default",v+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=r(t,"images.missing",v+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=r(t,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC"),window&&(window.FORCE_WEBGL?this.renderType=e.WEBGL:window.FORCE_CANVAS&&(this.renderType=e.CANVAS))}});return Tb=c}function Uk(){return Eb||(Eb=1,Sb={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach(function(e){t.style["image-rendering"]=e}),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}}),Sb}function zk(){if(Cb)return _b;Cb=1;var t=Hl(),e=PI(),i=Wh();return _b=function(n,s){var r=i(s,"callback"),a=i(s,"type","image/png"),o=i(s,"encoder",.92),h=Math.abs(Math.round(i(s,"x",0))),l=Math.abs(Math.round(i(s,"y",0))),u=Math.floor(i(s,"width",n.width)),c=Math.floor(i(s,"height",n.height));if(i(s,"getPixel",!1)){var d=n.getContext("2d",{willReadFrequently:!1}).getImageData(h,l,1,1).data;r.call(null,new e(d[0],d[1],d[2],d[3]))}else if(0!==h||0!==l||u!==n.width||c!==n.height){var f=t.createWebGL(this,u,c),p=f.getContext("2d",{willReadFrequently:!0});u>0&&c>0&&p.drawImage(n,h,l,u,c,0,0,u,c);var g=new Image;g.onerror=function(){r.call(null),t.remove(f)},g.onload=function(){r.call(null,g),t.remove(f)},g.src=f.toDataURL(a,o)}else{var v=new Image;v.onerror=function(){r.call(null)},v.onload=function(){r.call(null,v)},v.src=n.toDataURL(a,o)}},_b}function Yk(){return zb?Ub:(zb=1,Ub={LOSE_WEBGL:Pb?Ab:(Pb=1,Ab="losewebgl"),POST_RENDER:Rb?Mb:(Rb=1,Mb="postrender"),PRE_RENDER:Ob?Lb:(Ob=1,Lb="prerender"),RENDER:Db?Fb:(Db=1,Fb="render"),RESIZE:kb?Ib:(kb=1,Ib="resize"),RESTORE_WEBGL:Nb?Bb:(Nb=1,Bb="restorewebgl")})}function Xk(){if(Xb)return Yb;Xb=1;var t=Qo(),e=Jl();return Yb=function(){var i=[],n=e.supportNewBlendModes,s="source-over";return i[t.NORMAL]=s,i[t.ADD]="lighter",i[t.MULTIPLY]=n?"multiply":s,i[t.SCREEN]=n?"screen":s,i[t.OVERLAY]=n?"overlay":s,i[t.DARKEN]=n?"darken":s,i[t.LIGHTEN]=n?"lighten":s,i[t.COLOR_DODGE]=n?"color-dodge":s,i[t.COLOR_BURN]=n?"color-burn":s,i[t.HARD_LIGHT]=n?"hard-light":s,i[t.SOFT_LIGHT]=n?"soft-light":s,i[t.DIFFERENCE]=n?"difference":s,i[t.EXCLUSION]=n?"exclusion":s,i[t.HUE]=n?"hue":s,i[t.SATURATION]=n?"saturation":s,i[t.COLOR]=n?"color":s,i[t.LUMINOSITY]=n?"luminosity":s,i[t.ERASE]="destination-out",i[t.SOURCE_IN]="source-in",i[t.SOURCE_OUT]="source-out",i[t.SOURCE_ATOP]="source-atop",i[t.DESTINATION_OVER]="destination-over",i[t.DESTINATION_IN]="destination-in",i[t.DESTINATION_OUT]="destination-out",i[t.DESTINATION_ATOP]="destination-atop",i[t.LIGHTER]="lighter",i[t.COPY]="copy",i[t.XOR]="xor",i}}function Gk(){return sS?nS:(sS=1,nS={ADD:Wb?Gb:(Wb=1,Gb="addtexture"),ADD_KEY:Vb?Hb:(Vb=1,Hb="addtexture-"),ERROR:qb?jb:(qb=1,jb="onerror"),LOAD:Zb?Kb:(Zb=1,Kb="onload"),READY:$b?Jb:($b=1,Jb="ready"),REMOVE:tS?Qb:(tS=1,Qb="removetexture"),REMOVE_KEY:iS?eS:(iS=1,eS="removetexture-")})}function Wk(){if(aS)return rS;aS=1;var t=SI(),e=zk(),i=Vh(),n=eh(),s=qF(),r=Yk(),a=Xk(),o=VI(),h=Gk(),l=pI(),u=tc(),c=new i({Extends:s,initialize:function(t){s.call(this);var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,backgroundColor:e.backgroundColor,antialias:e.antialias,roundPixels:e.roundPixels,transparent:e.transparent},this.game=t,this.type=n.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=t.canvas;var i={alpha:e.transparent,desynchronized:e.desynchronized,willReadFrequently:!1};this.gameContext=e.context?e.context:this.gameCanvas.getContext("2d",i),this.currentContext=this.gameContext,this.antialias=e.antialias,this.blendModes=a(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new u,this._tempMatrix2=new u,this._tempMatrix3=new u,this.isBooted=!1,this.init()},init:function(){var t=this.game;t.events.once(l.BOOT,function(){var t=this.config;if(!t.transparent){var e=this.gameContext,i=this.gameCanvas;e.fillStyle=t.backgroundColor.rgba,e.fillRect(0,0,i.width,i.height)}},this),t.textures.once(h.READY,this.boot,this)},boot:function(){var t=this.game,e=t.scale.baseSize;this.width=e.width,this.height=e.height,this.isBooted=!0,t.scale.on(o.RESIZE,this.onResize,this),this.resize(e.width,e.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e,this.emit(r.RESIZE,t,e)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,i=this.width,n=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),this.emit(r.PRE_RENDER_CLEAR),e.clearBeforeRender&&(t.clearRect(0,0,i,n),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,i,n))),t.save(),this.drawCount=0,this.emit(r.PRE_RENDER)},render:function(e,i,n){var s=i.length;this.emit(r.RENDER,e,n);var a=n.x,o=n.y,h=n.width,l=n.height,u=n.renderToTexture?n.context:e.sys.context;u.save(),this.game.scene.customViewports&&(u.beginPath(),u.rect(a,o,h,l),u.clip()),n.emit(t.PRE_RENDER,n),this.currentContext=u;var c=n.mask;c&&c.preRenderCanvas(this,null,n._maskCamera),n.transparent||(u.fillStyle=n.backgroundColor.rgba,u.fillRect(a,o,h,l)),u.globalAlpha=n.alpha,u.globalCompositeOperation="source-over",this.drawCount+=s,n.renderToTexture&&n.emit(t.PRE_RENDER,n),n.matrix.copyToContext(u);for(var d=0;d<s;d++){var f=i[d];f.mask&&f.mask.preRenderCanvas(this,f,n),f.renderCanvas(this,f,n),f.mask&&f.mask.postRenderCanvas(this,f,n)}u.setTransform(1,0,0,1,0,0),u.globalCompositeOperation="source-over",u.globalAlpha=1,n.flashEffect.postRenderCanvas(u),n.fadeEffect.postRenderCanvas(u),n.dirty=!1,c&&c.postRenderCanvas(this),u.restore(),n.renderToTexture&&(n.emit(t.POST_RENDER,n),n.renderToGame&&e.sys.context.drawImage(n.canvas,a,o)),n.emit(t.POST_RENDER,n)},postRender:function(){this.gameContext.restore(),this.emit(r.POST_RENDER);var t=this.snapshotState;t.callback&&(e(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,i,n,s,r,a,o,h,l){void 0===n&&(n=!1),this.snapshotArea(s,r,a,o,i,h,l);var u=this.snapshotState;return u.getPixel=n,e(t,u),u.callback=null,this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=Math.min(i,this.gameCanvas.width),o.height=Math.min(n,this.gameCanvas.height),this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,i,n){var s=i.alpha*t.alpha;if(0!==s){var r=this.currentContext,a=this._tempMatrix1,o=this._tempMatrix2,h=e.canvasData,l=h.x,u=h.y,c=e.cutWidth,d=e.cutHeight,f=e.customPivot,p=e.source.resolution,g=t.displayOriginX,v=t.displayOriginY,m=-g+e.x,y=-v+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),c=x.cw,d=x.ch,l=x.cx,u=x.cy,m=-g+x.x,y=-v+x.y,t.flipX&&(m>=0?m=-(m+c):m<0&&(m=Math.abs(m)-c)),t.flipY&&(y>=0?y=-(y+d):y<0&&(y=Math.abs(y)-d))}var w=1,T=1;t.flipX&&(f||(m+=-e.realWidth+2*g),w=-1),t.flipY&&(f||(y+=-e.realHeight+2*v),T=-1);var b=t.x,S=t.y;if(i.roundPixels&&(b=Math.floor(b),S=Math.floor(S)),o.applyITRS(b,S,t.rotation,t.scaleX*w,t.scaleY*T),a.copyFrom(i.matrix),n?(a.multiplyWithOffset(n,-i.scrollX*t.scrollFactorX,-i.scrollY*t.scrollFactorY),o.e=b,o.f=S):(o.e-=i.scrollX*t.scrollFactorX,o.f-=i.scrollY*t.scrollFactorY),a.multiply(o),i.renderRoundPixels&&(a.e=Math.floor(a.e+.5),a.f=Math.floor(a.f+.5)),r.save(),a.setToContext(r),r.globalCompositeOperation=this.blendModes[t.blendMode],r.globalAlpha=s,r.imageSmoothingEnabled=!e.source.scaleMode,t.mask&&t.mask.preRenderCanvas(this,t,i),c>0&&d>0){var E=c/p,_=d/p;i.roundPixels&&(m=Math.floor(m+.5),y=Math.floor(y+.5),E+=.5,_+=.5),r.drawImage(e.source.image,l,u,c,d,m,y,E,_)}t.mask&&t.mask.postRenderCanvas(this,t,i),r.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});return rS=c}function Hk(){if(hS)return oS;hS=1;var t=Vh(),e=Yk(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){void 0===s&&(s=1),void 0===r&&(r=0),void 0===a&&(a=!0),void 0===o&&(o=!1),void 0===h&&(h=!0),void 0===l&&(l=!0),this.renderer=t,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=s,this.minFilter=r,this.autoClear=a,this.autoResize=!0,this.hasDepthBuffer=h,this.forceClamp=l,this.init(i,n),o?this.renderer.on(e.RESIZE,this.resize,this):this.autoResize=!1},init:function(t,e){var i=this.renderer;this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(e.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(e.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){if(this.autoResize&&this.willResize(t,e)){var i=this.renderer;i.deleteFramebuffer(this.framebuffer),i.deleteTexture(this.texture),this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e}return this},willResize:function(t,e){return"number"==typeof t&&"number"==typeof e&&(t=Math.round(t*this.scale),e=Math.round(e*this.scale),t=Math.max(t,1),e=Math.max(e,1),t!==this.width||e!==this.height)},bind:function(t,e,i){void 0===t&&(t=!1);var n=this.renderer;if(t&&n.flush(),e&&i&&this.resize(e,i),n.pushFramebuffer(this.framebuffer,!1,!1),t&&this.adjustViewport(),this.autoClear){var s=this.renderer.gl;s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)}n.clearStencilMask()},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(t,e,i,n){var s=this.renderer,r=s.gl;s.pushFramebuffer(this.framebuffer),void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?(r.enable(r.SCISSOR_TEST),r.scissor(t,e,i,n)):r.disable(r.SCISSOR_TEST),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),s.popFramebuffer(),s.resetScissor()},unbind:function(t){void 0===t&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.off(e.RESIZE,this.resize,this),t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});return oS=i}function Vk(){return uS?lS:(uS=1,lS=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join("\n"))}function jk(){return dS?cS:(dS=1,cS=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join("\n"))}function qk(){return pS?fS:(pS=1,fS={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}})}function Kk(){return RS?MS:(RS=1,MS={AFTER_FLUSH:vS?gS:(vS=1,gS="pipelineafterflush"),BEFORE_FLUSH:yS?mS:(yS=1,mS="pipelinebeforeflush"),BIND:wS?xS:(wS=1,xS="pipelinebind"),BOOT:bS?TS:(bS=1,TS="pipelineboot"),DESTROY:ES?SS:(ES=1,SS="pipelinedestroy"),REBIND:CS?_S:(CS=1,_S="pipelinerebind"),RESIZE:PS?AS:(PS=1,AS="pipelineresize")})}function Zk(){return OS||(OS=1,LS={getTintFromFloats:function(t,e,i,n){return((255*n&255)<<24|(255*t&255)<<16|(255*e&255)<<8|255*i&255)>>>0},getTintAppendFloatAlpha:function(t,e){return((255*e&255)<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255*e&255)<<24|(255&t)<<16|(t>>8&255)<<8|t>>16&255)>>>0},getFloatsFromUintRGB:function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},checkShaderMax:function(t,e){var i=Math.min(16,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));return e&&-1!==e?Math.min(i,e):i},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var i="",n=0;n<e;n++)n>0&&(i+="\n\telse "),n<e-1&&(i+="if (outTexId < "+n+".5)"),i+="\n\t{",i+="\n\t\ttexture = texture2D(uMainSampler["+n+"], outTexCoord);",i+="\n\t}";return(t=t.replace(/%count%/gi,e.toString())).replace(/%forloop%/gi,i)},setGlowQuality:function(t,e,i,n){return void 0===i&&(i=e.config.glowFXQuality),void 0===n&&(n=e.config.glowFXDistance),(t=t.replace(/__SIZE__/gi,(1/i/n).toFixed(7))).replace(/__DIST__/gi,n.toFixed(0)+".0")}}),LS}function Jk(){if(DS)return FS;DS=1;var t=Vh(),e=Tl(),i=Wh(),n=qk(),s=new t({initialize:function(t,e,i,n,s){this.pipeline=t,this.name=e,this.renderer=t.renderer,this.gl=this.renderer.gl,this.fragSrc=n,this.vertSrc=i,this.program=this.renderer.createProgram(i,n),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(s),this.createUniforms()},createAttributes:function(t){var e=0,s=0,r=[];this.vertexComponentCount=0;for(var a=0;a<t.length;a++){var o=t[a],h=o.name,l=i(o,"size",1),u=i(o,"type",n.FLOAT),c=u.enum,d=u.size,f=!!o.normalized;r.push({name:h,size:l,type:c,normalized:f,offset:s,enabled:!1,location:-1}),4===d?e+=l:e++,s+=l*d}this.vertexSize=s,this.vertexComponentCount=e,this.attributes=r},bind:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){void 0===t&&(t=!1);for(var e=this.gl,i=this.renderer,n=this.vertexSize,s=this.attributes,r=this.program,a=0;a<s.length;a++){var o=s[a],h=o.size,l=o.type,u=o.offset,c=o.enabled,d=o.location,f=!!o.normalized;if(t){-1!==d&&i.deleteAttribLocation(d);var p=this.renderer.createAttribLocation(r,o.name);p.webGLAttribLocation>=0?(e.enableVertexAttribArray(p.webGLAttribLocation),e.vertexAttribPointer(p.webGLAttribLocation,h,l,f,n,u),o.enabled=!0,o.location=p):-1!==p.webGLAttribLocation&&e.disableVertexAttribArray(p.webGLAttribLocation)}else c?e.vertexAttribPointer(d.webGLAttribLocation,h,l,f,n,u):!c&&-1!==d&&d.webGLAttribLocation>-1&&(e.disableVertexAttribArray(d.webGLAttribLocation),o.location=-1)}return this},createUniforms:function(){var t,e,i,n=this.gl,s=this.program,r=this.uniforms,a=n.getProgramParameter(s.webGLProgram,n.ACTIVE_UNIFORMS);for(t=0;t<a;t++){var o=n.getActiveUniform(s.webGLProgram,t);if(o){e=o.name,null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null});var h=e.indexOf("[");h>0&&(e=e.substr(0,h),r.hasOwnProperty(e)||null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null}))}}return this},syncUniforms:function(){var t=this.gl;for(var e in this.renderer.setProgram(this.program),this.uniforms){var i=this.uniforms[e];i.setter&&i.setter.call(t,i.location.webGLUniformLocation,i.value1,i.value2,i.value3,i.value4)}},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,i,n){var s=this.uniforms[e];return s?((n||s.value1!==i)&&(s.setter||(s.setter=t),s.value1=i,this.renderer.setProgram(this.program),t.call(this.gl,s.location.webGLUniformLocation,i),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,i,n,s){var r=this.uniforms[e];return r?((s||r.value1!==i||r.value2!==n)&&(r.setter||(r.setter=t),r.value1=i,r.value2=n,this.renderer.setProgram(this.program),t.call(this.gl,r.location.webGLUniformLocation,i,n),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,i,n,s,r){var a=this.uniforms[e];return a?((r||a.value1!==i||a.value2!==n||a.value3!==s)&&(a.setter||(a.setter=t),a.value1=i,a.value2=n,a.value3=s,this.renderer.setProgram(this.program),t.call(this.gl,a.location.webGLUniformLocation,i,n,s),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,i,n,s,r,a){var o=this.uniforms[e];return o?((a||o.value1!==i||o.value2!==n||o.value3!==s||o.value4!==r)&&(o.setter||(o.setter=t),o.value1=i,o.value2=n,o.value3=s,o.value4=r,this.renderer.setProgram(this.program),t.call(this.gl,o.location.webGLUniformLocation,i,n,s,r),this.pipeline.currentShader=this),this):this},setBoolean:function(t,e){return this.setUniform1(this.gl.uniform1i,t,Number(e))},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,i){return this.setUniform2(this.gl.uniform2f,t,e,i)},set3f:function(t,e,i,n){return this.setUniform3(this.gl.uniform3f,t,e,i,n)},set4f:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4f,t,e,i,n,s)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e,!0)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e,!0)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e,!0)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e,!0)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e,!0)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e,!0)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e,!0)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e,!0)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,i){return this.setUniform2(this.gl.uniform2i,t,e,i)},set3i:function(t,e,i,n){return this.setUniform3(this.gl.uniform3i,t,e,i,n)},set4i:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4i,t,e,i,n,s)},setMatrix2fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,i,!0)},setMatrix3fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,i,!0)},setMatrix4fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,i,!0)},createProgram:function(t,e){return void 0===t&&(t=this.vertSrc),void 0===e&&(e=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=t,this.fragSrc=e,this.program=this.renderer.createProgram(t,e),this.createUniforms(),this.rebind()},destroy:function(){var t=this.renderer;e(this.uniforms,function(e){t.deleteUniformLocation(e.location)}),this.uniforms=null,e(this.attributes,function(e){t.deleteAttribLocation(e.location)}),this.attributes=null,t.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});return FS=s}function $k(){if(kS)return IS;kS=1;var t=Vh(),e=Vu(),i=qF(),n=Kk(),s=Wh(),r=Ak(),a=Yk(),o=Hk(),h=Zk(),l=Jk(),u=new t({Extends:i,initialize:function(t){i.call(this);var e=t.game,n=e.renderer,r=n.gl;this.name=s(t,"name","WebGLPipeline"),this.game=e,this.renderer=n,this.manager,this.gl=r,this.view=e.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=s(t,"topology",r.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=s(t,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=t,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=s(t,"resizeUniform","")},boot:function(){var t,e=this.gl,i=this.config,h=this.renderer;this.isPostFX||(this.projectionMatrix=(new r).identity());var l=this.renderTargets,u=s(i,"renderTarget",!1);"boolean"==typeof u&&u&&(u=1);var c=h.width,d=h.height;if("number"==typeof u)for(t=0;t<u;t++)l.push(new o(h,c,d,1,0,!0));else if(Array.isArray(u))for(t=0;t<u.length;t++){var f=s(u[t],"scale",1),p=s(u[t],"minFilter",0),g=s(u[t],"autoClear",1),v=s(u[t],"autoResize",!1),m=s(u[t],"width",null),y=s(u[t],"height",m);m?l.push(new o(h,m,y,1,p,g,v)):l.push(new o(h,c,d,f,p,g,v))}l.length&&(this.currentRenderTarget=l[0]),this.setShadersFromConfig(i);var x=this.shaders,w=0;for(t=0;t<x.length;t++)x[t].vertexSize>w&&(w=x[t].vertexSize);var T=s(i,"batchSize",h.config.batchSize);this.vertexCapacity=6*T;var b=new ArrayBuffer(this.vertexCapacity*w);this.vertexData=b,this.bytes=new Uint8Array(b),this.vertexViewF32=new Float32Array(b),this.vertexViewU32=new Uint32Array(b);var S=s(i,"vertices",null);for(S?(this.vertexViewF32.set(S),this.vertexBuffer=h.createVertexBuffer(b,e.STATIC_DRAW)):this.vertexBuffer=h.createVertexBuffer(b.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=x.length-1;t>=0;t--)x[t].rebind();this.hasBooted=!0,h.on(a.RESIZE,this.resize,this),h.on(a.PRE_RENDER,this.onPreRender,this),h.on(a.RENDER,this.onRender,this),h.on(a.POST_RENDER,this.onPostRender,this),this.emit(n.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e,i){var n=this.renderer;return t===this.currentShader&&n.currentProgram===this.currentShader.program||(this.flush(),this.setVertexBuffer(i)&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t),this},getShaderByName:function(t){for(var e=this.shaders,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},setShadersFromConfig:function(t){var i,n=this.shaders,r=this.renderer;for(i=0;i<n.length;i++)n[i].destroy();var a="vertShader",o="fragShader",u="attributes",c=s(t,a,null),d=h.parseFragmentShaderMaxTextures(s(t,o,null),r.maxTextures),f=s(t,u,null),p=s(t,"shaders",[]),g=p.length;if(0===g)c&&d&&(this.shaders=[new l(this,"default",c,d,e(f))]);else{var v=[];for(i=0;i<g;i++){var m,y,x,w,T=p[i];if("string"==typeof T?(m="default",y=c,x=h.parseFragmentShaderMaxTextures(T,r.maxTextures),w=f):(m=s(T,"name","default"),y=s(T,a,c),x=h.parseFragmentShaderMaxTextures(s(T,o,d),r.maxTextures),w=s(T,u,f)),"default"===m){var b=x.split("\n")[0].trim();b.indexOf("#define SHADER_NAME")>-1&&(m=b.substring(20))}y&&x&&v.push(new l(this,m,y,x,e(w)))}this.shaders=v}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},createBatch:function(t){return this.currentBatch={start:this.vertexCount,count:0,texture:[t],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=t,this.batch.push(this.currentBatch),0},addTextureToBatch:function(t){var e=this.currentBatch;e&&(e.texture.push(t),e.unit++,e.maxUnit++)},pushBatch:function(t){if(!this.currentBatch||this.forceZero&&t!==this.currentTexture)return this.createBatch(t);if(t===this.currentTexture)return this.currentUnit;var e=this.currentBatch,i=e.texture.indexOf(t);return-1===i?e.texture.length===this.renderer.maxTextures?this.createBatch(t):(e.unit++,e.maxUnit++,e.texture.push(t),this.currentUnit=e.unit,this.currentTexture=t,e.unit):(this.currentUnit=i,this.currentTexture=t,i)},setGameObject:function(t,e){return void 0===e&&(e=t.frame),this.pushBatch(e.source.glTexture)},shouldFlush:function(t){return void 0===t&&(t=0),this.vertexCount+t>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(t,e){t===this.width&&e===this.height||this.flush(),this.width=t,this.height=e;for(var i=this.renderTargets,s=0;s<i.length;s++)i[s].resize(t,e);return this.setProjectionMatrix(t,e),this.resizeUniform&&this.set2f(this.resizeUniform,t,e),this.emit(n.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var i=this.projectionMatrix;if(!i)return this;this.projectionWidth=t,this.projectionHeight=e,i.ortho(0,t,e,0,-1e3,1e3);for(var n=this.shaders,s="uProjectionMatrix",r=0;r<n.length;r++){var a=n[r];a.hasUniform(s)&&(a.resetUniform(s),a.setMatrix4fv(s,!1,i.val,a))}return this},flipProjectionMatrix:function(t){void 0===t&&(t=!0);var e=this.projectionMatrix;if(!e)return this;var i=this.projectionWidth,n=this.projectionHeight;t?e.ortho(0,i,0,n,-1e3,1e3):e.ortho(0,i,n,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,e.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;this.projectionWidth===t&&this.projectionHeight===e||this.setProjectionMatrix(t,e)}},bind:function(t){if(void 0===t&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=!1,i=this.gl;return i.getParameter(i.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,e=!0),t.bind(e),this.currentShader=t,this.activeTextures.length=0,this.emit(n.BIND,this,t),this.onActive(t),this},rebind:function(t){this.activeBuffer=null,this.setVertexBuffer();for(var e=this.shaders,i=e.length-1;i>=0;i--){var s=e[i].rebind();t&&s!==t||(this.currentShader=s)}return this.activeTextures.length=0,this.emit(n.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var t=this.shaders,e=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,e&&this.setVertexBuffer();for(var i=0;i<t.length;i++){var n=t[i];n.syncUniforms(),e&&n.rebind()}},setVertexBuffer:function(t){if(void 0===t&&(t=this.vertexBuffer),t!==this.activeBuffer){var e=this.gl;return this.gl.bindBuffer(e.ARRAY_BUFFER,t.webGLBuffer),this.activeBuffer=t,!0}return!1},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(void 0===t&&(t=!1),this.vertexCount>0){this.emit(n.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,i=this.vertexCount,s=this.currentShader.vertexSize,r=this.topology;if(this.active){var a,o,h;this.setVertexBuffer(),i===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,i*s));var l=this.batch,u=this.activeTextures;if(this.forceZero)for(u[0]||e.activeTexture(e.TEXTURE0),a=0;a<l.length;a++)h=(o=l[a]).texture[0],u[0]!==h&&(e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[0]=h),e.drawArrays(r,o.start,o.count);else for(a=0;a<l.length;a++){o=l[a];for(var c=0;c<=o.maxUnit;c++)h=o.texture[c],u[c]!==h&&(e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[c]=h);e.drawArrays(r,o.start,o.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(n.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,i,n,s,r,a){var o=this.vertexViewF32,h=this.vertexViewU32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;o[++l]=t,o[++l]=e,o[++l]=i,o[++l]=n,o[++l]=s,o[++l]=r,h[++l]=a,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x){void 0===x&&(x=this.currentUnit);var w=!1;this.shouldFlush(6)&&(this.flush(),w=!0),this.currentBatch||(x=this.setTexture2D(y));var T=this.vertexViewF32,b=this.vertexViewU32,S=this.vertexCount*this.currentShader.vertexComponentCount-1;return T[++S]=e,T[++S]=i,T[++S]=l,T[++S]=u,T[++S]=x,T[++S]=m,b[++S]=f,T[++S]=n,T[++S]=s,T[++S]=l,T[++S]=d,T[++S]=x,T[++S]=m,b[++S]=g,T[++S]=r,T[++S]=a,T[++S]=c,T[++S]=d,T[++S]=x,T[++S]=m,b[++S]=v,T[++S]=e,T[++S]=i,T[++S]=l,T[++S]=u,T[++S]=x,T[++S]=m,b[++S]=f,T[++S]=r,T[++S]=a,T[++S]=c,T[++S]=d,T[++S]=x,T[++S]=m,b[++S]=v,T[++S]=o,T[++S]=h,T[++S]=c,T[++S]=u,T[++S]=x,T[++S]=m,b[++S]=p,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),w},batchTri:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v){void 0===v&&(v=this.currentUnit);var m=!1;this.shouldFlush(3)&&(this.flush(),m=!0),this.currentBatch||(v=this.setTexture2D(g));var y=this.vertexViewF32,x=this.vertexViewU32,w=this.vertexCount*this.currentShader.vertexComponentCount-1;return y[++w]=e,y[++w]=i,y[++w]=o,y[++w]=h,y[++w]=v,y[++w]=p,x[++w]=c,y[++w]=n,y[++w]=s,y[++w]=o,y[++w]=u,y[++w]=v,y[++w]=p,x[++w]=d,y[++w]=r,y[++w]=a,y[++w]=l,y[++w]=u,y[++w]=v,y[++w]=p,x[++w]=f,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),m},drawFillRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=this.renderer.whiteTexture),void 0===o&&(o=!0),t=Math.floor(t),e=Math.floor(e);var l=Math.floor(t+i),u=Math.floor(e+n),c=this.setTexture2D(a),d=h.getTintAppendFloatAlphaAndSwap(s,r),f=0,p=1;o&&(f=1,p=0),this.batchQuad(null,t,e,t,u,l,u,l,e,0,f,1,p,d,d,d,d,0,a,c)},setTexture2D:function(t){return void 0===t&&(t=this.renderer.whiteTexture),this.pushBatch(t)},bindTexture:function(t,e){void 0===e&&(e=0);var i=this.gl;return i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,t.webGLTexture),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t,e){return this.set1f(t,this.game.loop.getDuration(),e),this},setBoolean:function(t,e,i){return void 0===i&&(i=this.currentShader),i.setBoolean(t,e),this},set1f:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1f(t,e),this},set2f:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2f(t,e,i),this},set3f:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3f(t,e,i,n),this},set4f:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4f(t,e,i,n,s),this},set1fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1fv(t,e),this},set2fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2fv(t,e),this},set3fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3fv(t,e),this},set4fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4fv(t,e),this},set1iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1iv(t,e),this},set2iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2iv(t,e),this},set3iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3iv(t,e),this},set4iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4iv(t,e),this},set1i:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1i(t,e),this},set2i:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2i(t,e,i),this},set3i:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3i(t,e,i,n),this},set4i:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4i(t,e,i,n,s),this},setMatrix2fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix2fv(t,e,i),this},setMatrix3fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix3fv(t,e,i),this},setMatrix4fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix4fv(t,e,i),this},destroy:function(){var t;this.emit(n.DESTROY,this);var e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var i=this.renderTargets;for(t=0;t<i.length;t++)i[t].destroy();var s=this.renderer;return s.deleteBuffer(this.vertexBuffer),s.off(a.RESIZE,this.resize,this),s.off(a.PRE_RENDER,this.onPreRender,this),s.off(a.RENDER,this.onRender,this),s.off(a.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});return IS=u}function Qk(){if(NS)return BS;NS=1;var t=Vh(),e=Wh(),i=Vk(),n=jk(),s=qk(),r=$k(),a=new t({Extends:r,initialize:function(t){t.fragShader=e(t,"fragShader",i),t.vertShader=e(t,"vertShader",n),t.batchSize=e(t,"batchSize",1),t.vertices=e(t,"vertices",[-1,1,-1,-7,7,1]),t.attributes=e(t,"attributes",[{name:"inPosition",size:2,type:s.FLOAT}]),r.call(this,t)},boot:function(){r.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){r.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,i){this.renderer.beginBitmapMask(t,i)},endMask:function(t,e,i){var n=this.gl,s=this.renderer,r=t.bitmapMask;r&&n&&(s.drawBitmapMask(r,e,this),i&&this.set2f("uResolution",i.width,i.height),this.set1i("uInvertMaskAlpha",t.invertAlpha),n.drawArrays(this.topology,0,3),i&&this.set2f("uResolution",this.width,this.height),n.bindTexture(n.TEXTURE_2D,null))}});return BS=a}function tB(){return zS?US:(zS=1,US=["#define SHADER_NAME BARREL_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float amount;","varying vec2 outTexCoord;","vec2 Distort(vec2 p)","{","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, amount);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * (p + 1.0);","}","void main()","{","    vec2 xy = 2.0 * outTexCoord - 1.0;","    vec2 texCoord = outTexCoord;","    if (length(xy) < 1.0)","    {","        texCoord = Distort(xy);","    }","    gl_FragColor = texture2D(uMainSampler, texCoord);","}"].join("\n"))}function eB(){return XS?YS:(XS=1,YS=["#define SHADER_NAME PHASER_POSTFX_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}"].join("\n"))}function iB(){return WS?GS:(WS=1,GS=["#define SHADER_NAME PHASER_QUAD_VS","precision mediump float;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","varying vec2 outFragCoord;","varying vec2 outTexCoord;","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","    gl_Position = vec4(inPosition, 0, 1);","}"].join("\n"))}function nB(){if(VS)return HS;VS=1;var t=Vh(),e=lu(),i=Wh(),n=eB(),s=iB(),r=$k(),a=new t({Extends:r,initialize:function(t){t.renderTarget=i(t,"renderTarget",1),t.fragShader=i(t,"fragShader",n),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.batchSize=1,t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],r.call(this,t),this.isPostFX=!0,this.gameObject,this.controller,this.colorMatrix=new e,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines)},bootFX:function(){r.prototype.boot.call(this);var t=this.manager.UTILITY_PIPELINE;this.fullFrame1=t.fullFrame1,this.fullFrame2=t.fullFrame2,this.halfFrame1=t.halfFrame1,this.halfFrame2=t.halfFrame2;var e=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",e.width,e.height);for(var i=this.renderTargets,n=0;n<i.length;n++)i[n].autoResize=!0},postBatch:function(t){return this.hasBooted||(this.bootFX(),this.currentRenderTarget&&this.currentRenderTarget.bind()),this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(t){this.bindAndDraw(t)},getController:function(t){return void 0!==t?t:this.controller?this.controller:this},copySprite:function(t,e,i){void 0===i&&(i=!1);var n=this.gl;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.texture.webGLTexture);var s=n.getParameter(n.FRAMEBUFFER_BINDING);n.bindFramebuffer(n.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.texture.webGLTexture,0),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.bufferData(n.ARRAY_BUFFER,this.vertexData,n.STATIC_DRAW),n.drawArrays(n.TRIANGLES,0,6),i&&(n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,s))},copyFrame:function(t,e,i,n,s){this.manager.copyFrame(t,e,i,n,s)},copyToGame:function(t){this.manager.copyToGame(t)},drawFrame:function(t,e,i){this.manager.drawFrame(t,e,i,this.colorMatrix)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},clearFrame:function(t,e){this.manager.clearFrame(t,e)},blitFrame:function(t,e,i,n,s,r){this.manager.blitFrame(t,e,i,n,s,r)},copyFrameRect:function(t,e,i,n,s,r,a,o){this.manager.copyFrameRect(t,e,i,n,s,r,a,o)},bindAndDraw:function(t,e,i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);var r=this.gl,a=this.renderer;this.bind(s),this.set1i("uMainSampler",0),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0),i&&(n?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT))):(a.popFramebuffer(!1,!1),a.currentFramebuffer||r.viewport(0,0,a.width,a.height)),a.restoreStencilMask(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),e&&(r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,a.currentFramebuffer.webGLFramebuffer))},destroy:function(){return this.controller&&this.controller.destroy(),this.gameObject=null,this.controller=null,this.colorMatrix=null,this.fullFrame1=null,this.fullFrame2=null,this.halfFrame1=null,this.halfFrame2=null,this.manager.removePostPipeline(this),r.prototype.destroy.call(this),this}});return HS=a}function sB(){if(qS)return jS;qS=1;var t=Vh(),e=tB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e){t=this.getController(t),this.set1f("amount",t.amount,e)}});return jS=n}function rB(){return ZS?KS:(ZS=1,KS=["#define SHADER_NAME BLOOM_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;","    gl_FragColor = (sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913) * vec4(color, 1);","}"].join("\n"))}function aB(){if($S)return JS;$S=1;var t=Vh(),e=rB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.steps=4,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.strength=1,this.glcolor=[1,1,1]},onPreRender:function(t){t=this.getController(t),this.set1f("strength",t.blurStrength),this.set3fv("color",t.glcolor)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1,n=this.fullFrame2;this.copyFrame(t,n);for(var s=2/t.width*e.offsetX,r=2/t.height*e.offsetY,a=0;a<e.steps;a++)this.set2f("offset",s,0),this.copySprite(t,i),this.set2f("offset",0,r),this.copySprite(i,t);this.blendFrames(n,t,i,e.strength),this.copyToGame(i)}});return JS=n}function oB(){return tE?QS:(tE=1,QS=["#define SHADER_NAME BLUR_LOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 offset = vec2(1.333) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.29411764705882354;","    col += texture2D(uMainSampler, uv + (offset / resolution)) * 0.35294117647058826;","    col += texture2D(uMainSampler, uv - (offset / resolution)) * 0.35294117647058826;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function hB(){return iE?eE:(iE=1,eE=["#define SHADER_NAME BLUR_MED_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.3846153846) * offset * strength;","    vec2 off2 = vec2(3.2307692308) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.2270270270;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.0702702703;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.0702702703;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function lB(){return sE?nE:(sE=1,nE=["#define SHADER_NAME BLUR_HIGH_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.411764705882353) * offset * strength;","    vec2 off2 = vec2(3.2941176470588234) * offset * strength;","    vec2 off3 = vec2(5.176470588235294) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.1964825501511404;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv + (off3 / resolution)) * 0.010381362401148057;","    col += texture2D(uMainSampler, uv - (off3 / resolution)) * 0.010381362401148057;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function uB(){if(aE)return rE;aE=1;var t=Vh(),e=oB(),i=hB(),n=lB(),s=nB(),r=new t({Extends:s,initialize:function(t){s.call(this,{game:t,shaders:[{name:"Gaussian5",fragShader:e},{name:"Gaussian9",fragShader:i},{name:"Gaussian13",fragShader:n}]}),this.activeShader=this.shaders[0],this.x=2,this.y=2,this.steps=4,this.strength=1,this.glcolor=[1,1,1]},setQualityLow:function(){return this.activeShader=this.shaders[0],this},setQualityMedium:function(){return this.activeShader=this.shaders[1],this},setQualityHigh:function(){return this.activeShader=this.shaders[2],this},onDraw:function(t){var e=this.getController(),i=this.gl,n=this.fullFrame1,s=i.getParameter(i.FRAMEBUFFER_BINDING);this.bind(this.shaders[e.quality]),i.activeTexture(i.TEXTURE0),i.viewport(0,0,t.width,t.height),this.set1i("uMainSampler",0),this.set2f("resolution",t.width,t.height),this.set1f("strength",e.strength),this.set3fv("color",e.glcolor);for(var r=0;r<e.steps;r++)this.set2f("offset",e.x,0),this.copySprite(t,n),this.set2f("offset",0,e.y),this.copySprite(n,t);i.bindFramebuffer(i.FRAMEBUFFER,s),i.bindTexture(i.TEXTURE_2D,null),this.copyToGame(t)}});return rE=r}function cB(){return hE?oE:(hE=1,oE=["#define SHADER_NAME BOKEH_FS","precision mediump float;","#define ITERATIONS 100.0","#define ONEOVER_ITR 1.0 / ITERATIONS","#define PI 3.141596","#define GOLDEN_ANGLE 2.39996323","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float radius;","uniform float amount;","uniform float contrast;","uniform bool isTiltShift;","uniform float strength;","uniform vec2 blur;","varying vec2 outTexCoord;","vec2 Sample (in float theta, inout float r)","{","    r += 1.0 / r;","    return (r - 1.0) * vec2(cos(theta), sin(theta)) * 0.06;","}","vec3 Bokeh (sampler2D tex, vec2 uv, float radius)","{","    vec3 acc = vec3(0.0);","    vec3 div = vec3(0.0);","    vec2 pixel = vec2(resolution.y / resolution.x, 1.0) * radius * .025;","    float r = 1.0;","    for (float j = 0.0; j < GOLDEN_ANGLE * ITERATIONS; j += GOLDEN_ANGLE)","    {","        vec3 col = texture2D(tex, uv + pixel * Sample(j, r)).xyz;","        col = contrast > 0.0 ? col * col * (1.0 + contrast) : col;","        vec3 bokeh = vec3(0.5) + pow(col, vec3(10.0)) * amount;","        acc += col * bokeh;","        div += bokeh;","    }","    return acc / div;","}","void main ()","{","    float shift = 1.0;","    if (isTiltShift)","    {","        vec2 uv = vec2(gl_FragCoord.xy / resolution + vec2(-0.5, -0.5)) * 2.0;","        float centerStrength = 1.0;","        shift = length(uv * blur * strength) * centerStrength;","    }","    gl_FragColor = vec4(Bokeh(uMainSampler, outTexCoord * vec2(1.0, 1.0), radius * shift), 0.0);","}"].join("\n"))}function dB(){if(uE)return lE;uE=1;var t=Vh(),e=cB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.isTiltShift=!1,this.strength=1,this.blurX=1,this.blurY=1,this.radius=.5,this.amount=1,this.contrast=.2},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("amount",t.amount,e),this.set1f("contrast",t.contrast,e),this.set1f("strength",t.strength,e),this.set2f("blur",t.blurX,t.blurY,e),this.setBoolean("isTiltShift",t.isTiltShift,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return lE=n}function fB(){return dE?cE:(dE=1,cE=["#define SHADER_NAME CIRCLE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec3 color;","uniform vec4 backgroundColor;","uniform float thickness;","uniform float scale;","uniform float feather;","varying vec2 outTexCoord;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 position = (gl_FragCoord.xy / resolution.xy) * 2.0 - 1.0;","    float aspectRatio = resolution.x / resolution.y;","    position.x *= aspectRatio;","    float grad = length(position);","    float outer = aspectRatio;","    float inner = outer - (thickness * 2.0 / resolution.y);","    if (aspectRatio >= 1.0)","    {","        float f = 2.0 + (resolution.y / resolution.x);","        outer = 1.0;","        inner = 1.0 - (thickness * f / resolution.x);","    }","    outer *= scale;","    inner *= scale;","    float circle = smoothstep(outer, outer - 0.01, grad);","    float ring = circle - smoothstep(inner, inner - feather, grad);","    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);","    texture = (texture * (circle - ring));","    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);","}"].join("\n"))}function pB(){if(pE)return fE;pE=1;var t=Vh(),e=fB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.scale=1,this.feather=.005,this.thickness=8,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("scale",t.scale,e),this.set1f("feather",t.feather,e),this.set1f("thickness",t.thickness,e),this.set3fv("color",t.glcolor,e),this.set4fv("backgroundColor",t.glcolor2,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return fE=n}function gB(){if(vE)return gE;vE=1;var t=Vh(),e=nB(),i=new t({Extends:e,initialize:function(t){e.call(this,{game:t})},onDraw:function(t){var e=this.fullFrame1;this.controller?this.manager.drawFrame(t,e,!0,this.controller):this.drawFrame(t,e),this.copyToGame(e)}});return gE=i}function vB(){return yE?mE:(yE=1,mE=["#define SHADER_NAME DISPLACEMENT_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform sampler2D uDisplacementSampler;","uniform vec2 amount;","varying vec2 outTexCoord;","void main ()","{","    vec2 disp = (-vec2(0.5, 0.5) + texture2D(uDisplacementSampler, outTexCoord).rr) * amount;","    gl_FragColor = texture2D(uMainSampler, outTexCoord + disp).rgba;","}"].join("\n"))}function mB(){if(wE)return xE;wE=1;var t=Vh(),e=vB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.005,this.y=.005,this.glTexture},onBoot:function(){this.setTexture("__WHITE")},setTexture:function(t){var e=this.game.textures.getFrame(t);e&&(this.glTexture=e.glTexture)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1;this.bind(),this.set1i("uMainSampler",0),this.set1i("uDisplacementSampler",1),this.set2f("amount",e.x,e.y),this.bindTexture(e.glTexture,1),this.copySprite(t,i),this.copyToGame(i)}});return xE=n}function yB(){return bE?TE:(bE=1,TE=["#define SHADER_NAME GLOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform float outerStrength;","uniform float innerStrength;","uniform vec2 resolution;","uniform vec4 glowColor;","uniform bool knockout;","const float PI = 3.14159265358979323846264;","const float DIST = __DIST__;","const float SIZE = min(__SIZE__, PI * 2.0);","const float STEP = ceil(PI * 2.0 / SIZE);","const float MAX_ALPHA = STEP * DIST * (DIST + 1.0) / 2.0;","void main ()","{","    vec2 px = vec2(1.0 / resolution.x, 1.0 / resolution.y);","    float totalAlpha = 0.0;","    vec2 direction;","    vec2 displaced;","    vec4 color;","    for (float angle = 0.0; angle < PI * 2.0; angle += SIZE)","    {","        direction = vec2(cos(angle), sin(angle)) * px;","        for (float curDistance = 0.0; curDistance < DIST; curDistance++)","        {","            displaced = outTexCoord + direction * (curDistance + 1.0);","            color = texture2D(uMainSampler, displaced);","            totalAlpha += (DIST - curDistance) * color.a;","        }","    }","    color = texture2D(uMainSampler, outTexCoord);","    float alphaRatio = (totalAlpha / MAX_ALPHA);","    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * color.a;","    float innerGlowStrength = min(1.0, innerGlowAlpha);","    vec4 innerColor = mix(color, glowColor, innerGlowStrength);","    float outerGlowAlpha = alphaRatio * outerStrength * (1.0 - color.a);","    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);","    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;","    if (knockout)","    {","        float resultAlpha = outerGlowAlpha + innerGlowAlpha;","        gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);","    }","    else","    {","        gl_FragColor = innerColor + outerGlowColor;","    }","}"].join("\n"))}function xB(){if(EE)return SE;EE=1;var t=Vh(),e=Wh(),i=yB(),n=nB(),s=Zk(),r=new t({Extends:n,initialize:function(t,r){var a=e(r,"quality",.1),o=e(r,"distance",10);n.call(this,{game:t,fragShader:s.setGlowQuality(i,t,a,o)}),this.outerStrength=4,this.innerStrength=0,this.knockout=!1,this.glcolor=[1,1,1,1]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("outerStrength",t.outerStrength,e),this.set1f("innerStrength",t.innerStrength,e),this.set4fv("glowColor",t.glcolor,e),this.setBoolean("knockout",t.knockout,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return SE=r}function wB(){return CE?_E:(CE=1,_E=["#define SHADER_NAME GRADIENT_FS","#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))","#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))","#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 positionFrom;","uniform vec2 positionTo;","uniform vec3 color1;","uniform vec3 color2;","uniform float alpha;","uniform int size;","varying vec2 outTexCoord;","float gradientNoise(in vec2 uv)","{","    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(magic.z * fract(dot(uv, magic.xy)));","}","float stepped (in float s, in float scale, in int steps)","{","    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;","}","void main ()","{","    vec2 a = positionFrom;","    vec2 b = positionTo;","    vec2 ba = b - a;","    float d = dot(outTexCoord - a, ba) / dot(ba, ba);","    float t = size > 0 ? stepped(d, 1.0, size) : d;","    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));","    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);","    color = LINEAR_TO_SRGB(color);","    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;","}"].join("\n"))}function TB(){if(PE)return AE;PE=1;var t=Vh(),e=wB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.alpha=.2,this.size=0,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0]},onPreRender:function(t,e){t=this.getController(t),this.set1f("alpha",t.alpha,e),this.set1i("size",t.size,e),this.set3fv("color1",t.glcolor1,e),this.set3fv("color2",t.glcolor2,e),this.set2f("positionFrom",t.fromX,t.fromY,e),this.set2f("positionTo",t.toX,t.toY,e)}});return AE=n}function bB(){return RE?ME:(RE=1,ME=["#define SHADER_NAME PIXELATE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float amount;","varying vec2 outTexCoord;","void main ()","{","    float pixelSize = floor(2.0 + amount);","    vec2 center = pixelSize * floor(outTexCoord * resolution / pixelSize) + pixelSize * vec2(0.5, 0.5);","    vec2 corner1 = center + pixelSize * vec2(-0.5, -0.5);","    vec2 corner2 = center + pixelSize * vec2(+0.5, -0.5);","    vec2 corner3 = center + pixelSize * vec2(+0.5, +0.5);","    vec2 corner4 = center + pixelSize * vec2(-0.5, +0.5);","    vec4 pixel = 0.4 * texture2D(uMainSampler, center / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner1 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner2 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner3 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner4 / resolution);","    gl_FragColor = pixel;","}"].join("\n"))}function SB(){if(OE)return LE;OE=1;var t=Vh(),e=bB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("amount",t.amount,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return LE=n}function EB(){return DE?FE:(DE=1,FE=["#define SHADER_NAME SHADOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform vec2 lightPosition;","uniform vec4 color;","uniform float decay;","uniform float power;","uniform float intensity;","uniform int samples;","const int MAX = 12;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 pc = (lightPosition - outTexCoord) * intensity;","    float shadow = 0.0;","    float limit = max(float(MAX), float(samples));","    for (int i = 0; i < MAX; ++i)","    {","        if (i >= samples)","        {","            break;","        }","        shadow += texture2D(uMainSampler, outTexCoord + float(i) * decay / limit * pc).a * power;","    }","    float mask = 1.0 - texture.a;","    gl_FragColor = mix(texture, color, shadow * mask);","}"].join("\n"))}function _B(){if(kE)return IE;kE=1;var t=Vh(),e=EB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=0,this.y=0,this.decay=.1,this.power=1,this.glcolor=[0,0,0,1],this.samples=6,this.intensity=1},onPreRender:function(t,e){var i=(t=this.getController(t)).samples;this.set1i("samples",i,e),this.set1f("intensity",t.intensity,e),this.set1f("decay",t.decay,e),this.set1f("power",t.power/i,e),this.set2f("lightPosition",t.x,t.y,e),this.set4fv("color",t.glcolor,e)}});return IE=n}function CB(){return NE?BE:(NE=1,BE=["#define SHADER_NAME SHINE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform bool reveal;","uniform float speed;","uniform float time;","uniform float lineWidth;","uniform float gradient;","varying vec2 outTexCoord;","void main ()","{","\tvec2 uv = gl_FragCoord.xy / resolution.xy;","    vec4 tex = texture2D(uMainSampler, outTexCoord);","    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);","    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);","    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;","    float y = uv.x * gradient;","    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);","    gl_FragColor = (((s * col1) + (s * col2)) * tex);","    if (!reveal)","    {","        gl_FragColor += tex;","    }","}"].join("\n"))}function AB(){if(zE)return UE;zE=1;var t=Vh(),e=CB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1},onPreRender:function(t,e,i,n){t=this.getController(t),this.setTime("time",e),this.set1f("speed",t.speed,e),this.set1f("lineWidth",t.lineWidth,e),this.set1f("gradient",t.gradient,e),this.setBoolean("reveal",t.reveal,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return UE=n}function PB(){return XE?YE:(XE=1,YE=["#define SHADER_NAME VIGNETTE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float radius;","uniform float strength;","uniform vec2 position;","varying vec2 outTexCoord;","void main ()","{","    vec4 col = vec4(1.0);","    float d = length(outTexCoord - position);","    if (d <= radius)","    {","        float g = d / radius;","        g = sin(g * 3.14 * strength);","    \tcol = vec4(g * g * g);","    }","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = texture * (1.0 - col);","}"].join("\n"))}function MB(){if(WE)return GE;WE=1;var t=Vh(),e=PB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5},onPreRender:function(t,e){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("strength",t.strength,e),this.set2f("position",t.x,t.y,e)}});return GE=n}function RB(){return VE?HE:(VE=1,HE=["#define SHADER_NAME WIPE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec4 config;","uniform bool reveal;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 color0;","    vec4 color1;","    if (reveal)","    {","        color0 = vec4(0);","        color1 = texture2D(uMainSampler, uv);","    }","    else","    {","        color0 = texture2D(uMainSampler, uv);","        color1 = vec4(0);","    }","    float distance = config.x;","    float width = config.y;","    float direction = config.z;","    float axis = uv.x;","    if (config.w == 1.0)","    {","        axis = uv.y;","    }","    float adjust = mix(width, -width, distance);","    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);","    gl_FragColor = mix(color1, color0, value);","}"].join("\n"))}function LB(){if(qE)return jE;qE=1;var t=Vh(),e=RB(),i=nB(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1},onPreRender:function(t,e){var i=(t=this.getController(t)).progress,n=t.wipeWidth,s=t.direction,r=t.axis;this.set4f("config",i,n,s,r,e),this.setBoolean("reveal",t.reveal,e)}});return jE=n}function OB(){if(ZE)return KE;ZE=1;var t={Barrel:sB(),Bloom:aB(),Blur:uB(),Bokeh:dB(),Circle:pB(),ColorMatrix:gB(),Displacement:mB(),Glow:xB(),Gradient:TB(),Pixelate:SB(),Shadow:_B(),Shine:AB(),Vignette:MB(),Wipe:LB()};return KE=t}function FB(){return $E?JE:($E=1,JE=["#define SHADER_NAME PHASER_COLORMATRIX_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","varying vec2 outTexCoord;","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","        return;","    }","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","    vec4 result;","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","    rgb *= result.a;","    gl_FragColor = vec4(rgb, result.a);","}"].join("\n"))}function DB(){if(t_)return QE;function t(t,i,s){s=s||2;var r,a,o,u,c,f,p,g=i&&i.length,v=g?i[0]*s:t.length,m=e(t,0,v,s,!0),y=[];if(!m||m.next===m.prev)return y;if(g&&(m=function(t,i,n,s){var r,a,o,u=[];for(r=0,a=i.length;r<a;r++)(o=e(t,i[r]*s,r<a-1?i[r+1]*s:t.length,s,!1))===o.next&&(o.steiner=!0),u.push(d(o));for(u.sort(h),r=0;r<u.length;r++)n=l(u[r],n);return n}(t,i,m,s)),t.length>80*s){r=o=t[0],a=u=t[1];for(var x=s;x<v;x+=s)(c=t[x])<r&&(r=c),(f=t[x+1])<a&&(a=f),c>o&&(o=c),f>u&&(u=f);p=0!==(p=Math.max(o-r,u-a))?32767/p:0}return n(m,y,s,r,a,p,0),y}function e(t,e,i,n,s){var r,a;if(s===_(t,e,i,n)>0)for(r=e;r<i;r+=n)a=b(r,t[r],t[r+1],a);else for(r=i-n;r>=e;r-=n)a=b(r,t[r],t[r+1],a);return a&&v(a,a.next)&&(S(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!v(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(S(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function n(t,e,h,l,u,d,f){if(t){!f&&d&&function(t,e,i,n){var s=t;do{0===s.z&&(s.z=c(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,function(t){var e,i,n,s,r,a,o,h,l=1;do{for(i=t,t=null,r=null,a=0;i;){for(a++,n=i,o=0,e=0;e<l&&(o++,n=n.nextZ);e++);for(h=l;o>0||h>0&&n;)0!==o&&(0===h||!n||i.z<=n.z)?(s=i,i=i.nextZ,o--):(s=n,n=n.nextZ,h--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(a>1)}(s)}(t,l,u,d);for(var p,g,v=t;t.prev!==t.next;)if(p=t.prev,g=t.next,d?r(t,l,u,d):s(t))e.push(p.i/h|0),e.push(t.i/h|0),e.push(g.i/h|0),S(t),t=g.next,v=g.next;else if((t=g)===v){f?1===f?n(t=a(i(t),e,h),e,h,l,u,d,2):2===f&&o(t,e,h,l,u,d):n(i(t),e,h,l,u,d,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(g(e,i,n)>=0)return!1;for(var s=e.x,r=i.x,a=n.x,o=e.y,h=i.y,l=n.y,u=s<r?s<a?s:a:r<a?r:a,c=o<h?o<l?o:l:h<l?h:l,d=s>r?s>a?s:a:r>a?r:a,p=o>h?o>l?o:l:h>l?h:l,v=n.next;v!==e;){if(v.x>=u&&v.x<=d&&v.y>=c&&v.y<=p&&f(s,o,r,h,a,l,v.x,v.y)&&g(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function r(t,e,i,n){var s=t.prev,r=t,a=t.next;if(g(s,r,a)>=0)return!1;for(var o=s.x,h=r.x,l=a.x,u=s.y,d=r.y,p=a.y,v=o<h?o<l?o:l:h<l?h:l,m=u<d?u<p?u:p:d<p?d:p,y=o>h?o>l?o:l:h>l?h:l,x=u>d?u>p?u:p:d>p?d:p,w=c(v,m,e,i,n),T=c(y,x,e,i,n),b=t.prevZ,S=t.nextZ;b&&b.z>=w&&S&&S.z<=T;){if(b.x>=v&&b.x<=y&&b.y>=m&&b.y<=x&&b!==s&&b!==a&&f(o,u,h,d,l,p,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,S.x>=v&&S.x<=y&&S.y>=m&&S.y<=x&&S!==s&&S!==a&&f(o,u,h,d,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;b&&b.z>=w;){if(b.x>=v&&b.x<=y&&b.y>=m&&b.y<=x&&b!==s&&b!==a&&f(o,u,h,d,l,p,b.x,b.y)&&g(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;S&&S.z<=T;){if(S.x>=v&&S.x<=y&&S.y>=m&&S.y<=x&&S!==s&&S!==a&&f(o,u,h,d,l,p,S.x,S.y)&&g(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function a(t,e,n){var s=t;do{var r=s.prev,a=s.next.next;!v(r,a)&&m(r,s,s.next,a)&&w(r,a)&&w(a,r)&&(e.push(r.i/n|0),e.push(s.i/n|0),e.push(a.i/n|0),S(s),S(s.next),s=t=a),s=s.next}while(s!==t);return i(s)}function o(t,e,s,r,a,o){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&p(h,l)){var u=T(h,l);return h=i(h,h.next),u=i(u,u.next),n(h,e,s,r,a,o,0),void n(u,e,s,r,a,o,0)}l=l.next}h=h.next}while(h!==t)}function h(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var i,n=e,s=t.x,r=t.y,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var o=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=s&&o>a&&(a=o,i=n.x<n.next.x?n:n.next,o===s))return i}n=n.next}while(n!==e);if(!i)return null;var h,l=i,c=i.x,d=i.y,p=1/0;n=i;do{s>=n.x&&n.x>=c&&s!==n.x&&f(r<d?s:a,r,c,d,r<d?a:s,r,n.x,n.y)&&(h=Math.abs(r-n.y)/(s-n.x),w(n,t)&&(h<p||h===p&&(n.x>i.x||n.x===i.x&&u(i,n)))&&(i=n,p=h)),n=n.next}while(n!==l);return i}(t,e);if(!n)return e;var s=T(n,t);return i(s,s.next),i(n,n.next)}function u(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function c(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,n,s,r,a,o){return(s-a)*(e-o)>=(t-a)*(r-o)&&(t-a)*(n-o)>=(i-a)*(e-o)&&(i-a)*(r-o)>=(s-a)*(n-o)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&m(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||v(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,i,n){var s=x(g(t,e,i)),r=x(g(t,e,n)),a=x(g(i,n,t)),o=x(g(i,n,e));return s!==r&&a!==o||!(0!==s||!y(t,i,e))||!(0!==r||!y(t,n,e))||!(0!==a||!y(i,t,n))||!(0!==o||!y(i,e,n))}function y(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function x(t){return t>0?1:t<0?-1:0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function T(t,e){var i=new E(t.i,t.x,t.y),n=new E(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function b(t,e,i,n){var s=new E(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(t,e,i,n){for(var s=0,r=e,a=i-n;r<i;r+=n)s+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return s}return t_=1,t.deviation=function(t,e,i,n){var s=e&&e.length,r=s?e[0]*i:t.length,a=Math.abs(_(t,0,r,i));if(s)for(var o=0,h=e.length;o<h;o++){var l=e[o]*i,u=o<h-1?e[o+1]*i:t.length;a-=Math.abs(_(t,l,u,i))}var c=0;for(o=0;o<n.length;o+=3){var d=n[o]*i,f=n[o+1]*i,p=n[o+2]*i;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,s=0;s<t.length;s++){for(var r=0;r<t[s].length;r++)for(var a=0;a<e;a++)i.vertices.push(t[s][r][a]);s>0&&(n+=t[s-1].length,i.holes.push(n))}return i},QE=t}function IB(){return i_?e_:(i_=1,e_=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function kB(){return s_?n_:(s_=1,n_=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function BB(){if(a_)return r_;a_=1;var t=Vh(),e=DB(),i=Wh(),n=IB(),s=kB(),r=tc(),a=Zk(),o=qk(),h=$k(),l=new t({Extends:h,initialize:function(t){var e=t.game.renderer,l=i(t,"fragShader",n);t.fragShader=a.parseFragmentShaderMaxTextures(l,e.maxTextures),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:o.UNSIGNED_BYTE,normalized:!0}]),t.resizeUniform="uResolution",h.call(this,t),this._tempMatrix1=new r,this._tempMatrix2=new r,this._tempMatrix3=new r,this.calcMatrix=new r,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){h.prototype.boot.call(this);var t=this.renderer;this.set1iv("uMainSampler",t.textureIndexes),this.set2f("uResolution",t.width,t.height)},batchSprite:function(t,e,i){this.manager.set(this,t);var n=this._tempMatrix1,s=this._tempMatrix2,r=this._tempMatrix3,o=t.frame,h=o.glTexture,l=o.u0,u=o.v0,c=o.u1,d=o.v1,f=o.x,p=o.y,g=o.cutWidth,v=o.cutHeight,m=o.customPivot,y=t.displayOriginX,x=t.displayOriginY,w=-y+f,T=-x+p;if(t.isCropped){var b=t._crop;b.flipX===t.flipX&&b.flipY===t.flipY||o.updateCropUVs(b,t.flipX,t.flipY),l=b.u0,u=b.v0,c=b.u1,d=b.v1,g=b.width,v=b.height,w=-y+(f=b.x),T=-x+(p=b.y)}var S=1,E=1;t.flipX&&(m||(w+=-o.realWidth+2*y),S=-1),t.flipY&&(m||(T+=-o.realHeight+2*x),E=-1);var _=t.x,C=t.y;e.roundPixels&&(_=Math.floor(_),C=Math.floor(C)),s.applyITRS(_,C,t.rotation,t.scaleX*S,t.scaleY*E),n.copyFrom(e.matrix),i?(n.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),s.e=_,s.f=C):(s.e-=e.scrollX*t.scrollFactorX,s.f-=e.scrollY*t.scrollFactorY),n.multiply(s,r);var A=r.setQuad(w,T,w+g,T+v,e.renderRoundPixels),P=a.getTintAppendFloatAlpha,M=e.alpha,R=P(t.tintTopLeft,M*t._alphaTL),L=P(t.tintTopRight,M*t._alphaTR),O=P(t.tintBottomLeft,M*t._alphaBL),F=P(t.tintBottomRight,M*t._alphaBR);this.shouldFlush(6)&&this.flush();var D=this.setGameObject(t,o);this.manager.preBatch(t),this.batchQuad(t,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],l,u,c,d,R,L,O,F,t.tintFill,h,D),this.manager.postBatch(t)},batchTexture:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,T,b,S,E,_,C,A,P,M,R,L,O){void 0===O&&(O=!1),this.manager.set(this,t);var F=this._tempMatrix1,D=this._tempMatrix2,I=this._tempMatrix3,k=m/i+C,B=y/n+A,N=(m+x)/i+C,U=(y+w)/n+A,z=a,Y=o,X=-g,G=-v;if(t.isCropped){var W=t._crop,H=W.width,V=W.height;z=H,Y=V,a=H,o=V;var j=m=W.x,q=y=W.y;c&&(j=x-W.x-H),d&&(q=w-W.y-V),k=j/i+C,B=q/n+A,N=(j+H)/i+C,U=(q+V)/n+A,X=-g+m,G=-v+y}c&&(z*=-1,X+=a),(d^=!R&&e.isRenderTexture?1:0)&&(Y*=-1,G+=o),P.roundPixels&&(s=Math.floor(s),r=Math.floor(r)),D.applyITRS(s,r,u,h,l),F.copyFrom(P.matrix),M?(F.multiplyWithOffset(M,-P.scrollX*f,-P.scrollY*p),D.e=s,D.f=r):(D.e-=P.scrollX*f,D.f-=P.scrollY*p),F.multiply(D,I);var K=I.setQuad(X,G,X+z,G+Y,P.renderRoundPixels);null==L&&(L=this.setTexture2D(e)),t&&!O&&this.manager.preBatch(t),this.batchQuad(t,K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],k,B,N,U,T,b,S,E,_,e,L),t&&!O&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,i,n,s,r,o){this.manager.set(this);var h=this._tempMatrix1.copyFrom(r),l=this._tempMatrix2;o?h.multiply(o,l):l=h;var u=l.setQuad(e,i,e+t.width,i+t.height),c=this.setTexture2D(t.source.glTexture);n=a.getTintAppendFloatAlpha(n,s),this.batchQuad(null,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],t.u0,t.v0,t.u1,t.v1,n,n,n,n,0,t.glTexture,c)},batchFillRect:function(t,e,i,n,s,r){this.renderer.pipelines.set(this);var a=this.calcMatrix;r&&r.multiply(s,a);var o=a.setQuad(t,e,t+i,e+n),h=this.fillTint;this.batchQuad(null,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],0,0,1,1,h.TL,h.TR,h.BL,h.BR,2)},batchFillTriangle:function(t,e,i,n,s,r,a,o){this.renderer.pipelines.set(this);var h=this.calcMatrix;o&&o.multiply(a,h);var l=h.getX(t,e),u=h.getY(t,e),c=h.getX(i,n),d=h.getY(i,n),f=h.getX(s,r),p=h.getY(s,r),g=this.fillTint;this.batchTri(null,l,u,c,d,f,p,0,0,1,1,g.TL,g.TR,g.BL,2)},batchStrokeTriangle:function(t,e,i,n,s,r,a,o,h){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=a,l[1].x=i,l[1].y=n,l[1].width=a,l[2].x=s,l[2].y=r,l[2].width=a,l[3].x=t,l[3].y=e,l[3].width=a,this.batchStrokePath(l,a,!1,o,h)},batchFillPath:function(t,i,n){this.renderer.pipelines.set(this);var s=this.calcMatrix;n&&n.multiply(i,s);for(var r,a,o=t.length,h=this.polygonCache,l=this.fillTint.TL,u=this.fillTint.TR,c=this.fillTint.BL,d=0;d<o;++d)a=t[d],h.push(a.x,a.y);o=(r=e(h)).length;for(var f=0;f<o;f+=3){var p=2*r[f+0],g=2*r[f+1],v=2*r[f+2],m=h[p+0],y=h[p+1],x=h[g+0],w=h[g+1],T=h[v+0],b=h[v+1],S=s.getX(m,y),E=s.getY(m,y),_=s.getX(x,w),C=s.getY(x,w),A=s.getX(T,b),P=s.getY(T,b);this.batchTri(null,S,E,_,C,A,P,0,0,1,1,l,u,c,2)}h.length=0},batchStrokePath:function(t,e,i,n,s){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var r=t.length-1,a=0;a<r;a++){var o=t[a],h=t[a+1];this.batchLine(o.x,o.y,h.x,h.y,o.width/2,h.width/2,e,a,!i&&a===r-1,n,s)}},batchLine:function(t,e,i,n,s,r,a,o,h,l,u){this.renderer.pipelines.set(this);var c=this.calcMatrix;u&&u.multiply(l,c);var d=i-t,f=n-e,p=Math.sqrt(d*d+f*f);if(0!==p){var g=s*(n-e)/p,v=s*(t-i)/p,m=r*(n-e)/p,y=r*(t-i)/p,x=i-m,w=n-y,T=t-g,b=e-v,S=i+m,E=n+y,_=t+g,C=e+v,A=c.getX(x,w),P=c.getY(x,w),M=c.getX(T,b),R=c.getY(T,b),L=c.getX(S,E),O=c.getY(S,E),F=c.getX(_,C),D=c.getY(_,C),I=this.strokeTint,k=I.TL,B=I.TR,N=I.BL,U=I.BR;if(this.batchQuad(null,F,D,M,R,A,P,L,O,0,0,1,1,k,B,N,U,2),!(a<=2)){var z=this.prevQuad,Y=this.firstQuad;o>0&&z[4]?this.batchQuad(null,F,D,M,R,z[0],z[1],z[2],z[3],0,0,1,1,k,B,N,U,2):(Y[0]=F,Y[1]=D,Y[2]=M,Y[3]=R,Y[4]=1),h&&Y[4]?this.batchQuad(null,A,P,L,O,Y[0],Y[1],Y[2],Y[3],0,0,1,1,k,B,N,U,2):(z[0]=A,z[1]=P,z[2]=L,z[3]=O,z[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,h.prototype.destroy.call(this),this}});return r_=l}function NB(){return h_?o_:(h_=1,o_=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function UB(){return u_?l_:(u_=1,l_=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function zB(){if(d_)return c_;d_=1;var t=Qo(),e=kI(),i=Vh(),n=FB(),s=Wh(),r=BB(),a=eB(),o=Fu(),h=Hk(),l=NB(),u=UB(),c=$k(),d=new i({Extends:r,initialize:function(t){var e=s(t,"fragShader",a),i=s(t,"vertShader",u),h=s(t,"drawShader",a),c=[{name:"DrawSprite",fragShader:l,vertShader:u},{name:"CopySprite",fragShader:e,vertShader:i},{name:"DrawGame",fragShader:h,vertShader:u},{name:"ColorMatrix",fragShader:n}],d=s(t,"shaders",[]);t.shaders=c.concat(d),t.vertShader||(t.vertShader=i),t.batchSize=1,r.call(this,t),this.isPreFX=!0,this.customMainSampler=null,this.drawSpriteShader,this.copyShader,this.gameShader,this.colorMatrixShader,this.quadVertexData,this.quadVertexBuffer,this.quadVertexViewF32,this.spriteBounds=new o,this.targetBounds=new o,this.fsTarget,this.tempSprite,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){c.prototype.boot.call(this);var t=this.shaders,e=this.renderer;this.drawSpriteShader=t[0],this.copyShader=t[1],this.gameShader=t[2],this.colorMatrixShader=t[3],this.fsTarget=new h(e,e.width,e.height,1,0,!0,!0),this.renderTargets=this.manager.renderTargets.concat(this.fsTarget);var i=new ArrayBuffer(168);this.quadVertexData=i,this.quadVertexViewF32=new Float32Array(i),this.quadVertexBuffer=e.createVertexBuffer(i,this.gl.STATIC_DRAW),this.onResize(e.width,e.height),this.currentShader=this.copyShader,this.set2f("uResolution",e.width,e.height)},onResize:function(t,e){var i=this.quadVertexViewF32;i[1]=e,i[22]=e,i[14]=t,i[28]=t,i[35]=t,i[36]=e},batchQuad:function(t,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x){var w=Math.min(i,s,a,h),T=Math.min(n,r,o,l),b=Math.max(i,s,a,h)-w,S=Math.max(n,r,o,l)-T,E=this.spriteBounds.setTo(w,T,b,S),_=t?t.preFX.padding:0,C=b+2*_,A=S+2*_,P=Math.abs(Math.max(C,A)),M=this.manager.getRenderTarget(P),R=this.targetBounds.setTo(0,0,M.width,M.height);e(R,Math.round(E.centerX),Math.round(E.centerY)),this.tempSprite=t;var L=this.gl,O=this.renderer;O.clearStencilMask(),this.setShader(this.drawSpriteShader),this.set1i("uMainSampler",0),this.set2f("uResolution",O.width,O.height),this.flipProjectionMatrix(!0),t&&(this.onDrawSprite(t,M),t.preFX.onFX(this));var F=this.fsTarget;return this.flush(),L.viewport(0,0,O.width,O.height),L.bindFramebuffer(L.FRAMEBUFFER,F.framebuffer.webGLFramebuffer),L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_2D,F.texture.webGLTexture,0),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),this.setTexture2D(x),this.batchVert(i,n,u,c,0,y,p),this.batchVert(s,r,u,f,0,y,v),this.batchVert(a,o,d,f,0,y,m),this.batchVert(i,n,u,c,0,y,p),this.batchVert(a,o,d,f,0,y,m),this.batchVert(h,l,d,c,0,y,g),this.flush(),this.flipProjectionMatrix(!1),L.activeTexture(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,M.texture.webGLTexture),L.copyTexSubImage2D(L.TEXTURE_2D,0,0,0,R.x,R.y,R.width,R.height),L.bindFramebuffer(L.FRAMEBUFFER,null),L.bindTexture(L.TEXTURE_2D,null),this.onBatch(t),this.currentShader=this.copyShader,this.onDraw(M,this.manager.getSwapRenderTarget(),this.manager.getAltSwapRenderTarget()),!0},onDrawSprite:function(){},onCopySprite:function(){},copySprite:function(e,i,n,s,r,a,o){void 0===n&&(n=!0),void 0===s&&(s=!0),void 0===r&&(r=!1),void 0===o&&(o=this.copyShader);var h=this.gl,l=this.tempSprite;a&&(o=this.colorMatrixShader),this.currentShader=o;var u=this.setVertexBuffer(this.quadVertexBuffer);o.bind(u,!1);var c=this.renderer;if(this.set1i("uMainSampler",0),this.set2f("uResolution",c.width,c.height),l.preFX.onFXCopy(this),this.onCopySprite(e,i,l),a&&(this.set1fv("uColorMatrix",a.getData()),this.set1f("uAlpha",a.alpha)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),e.height>i.height)h.viewport(0,0,e.width,e.height),this.setTargetUVs(e,i);else{var d=i.height-e.height;h.viewport(0,d,e.width,e.height),this.resetUVs()}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),n&&(h.clearColor(0,0,0,Number(!s)),h.clear(h.COLOR_BUFFER_BIT)),r){var f=this.renderer.currentBlendMode;this.renderer.setBlendMode(t.ERASE)}h.bufferData(h.ARRAY_BUFFER,this.quadVertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),r&&this.renderer.setBlendMode(f),h.bindFramebuffer(h.FRAMEBUFFER,null)},copy:function(t,e){var i=this.gl;this.set1i("uMainSampler",0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.webGLTexture),i.viewport(0,0,t.width,t.height),this.setUVs(0,0,0,1,1,1,1,0),i.bindFramebuffer(i.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.texture.webGLTexture,0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.bufferData(i.ARRAY_BUFFER,this.quadVertexData,i.STATIC_DRAW),i.drawArrays(i.TRIANGLES,0,6),i.bindFramebuffer(i.FRAMEBUFFER,null)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},drawToGame:function(t){this.currentShader=null,this.setShader(this.copyShader),this.bindAndDraw(t)},copyToGame:function(t){this.currentShader=null,this.setShader(this.gameShader),this.bindAndDraw(t)},bindAndDraw:function(t){var e=this.gl,i=this.renderer;this.set1i("uMainSampler",0),this.customMainSampler?this.setTexture2D(this.customMainSampler):this.setTexture2D(t.texture);var n=this._tempMatrix1.loadIdentity(),s=this.targetBounds.x,r=this.targetBounds.y,a=s+t.width,o=r+t.height,h=n.getX(s,r),l=n.getX(s,o),u=n.getX(a,o),c=n.getX(a,r),d=n.getY(s,r),f=n.getY(s,o),p=n.getY(a,o),g=n.getY(a,r),v=16777215;this.batchVert(h,d,0,0,0,0,v),this.batchVert(l,f,0,1,0,0,v),this.batchVert(u,p,1,1,0,0,v),this.batchVert(h,d,0,0,0,0,v),this.batchVert(u,p,1,1,0,0,v),this.batchVert(c,g,1,0,0,0,v),i.restoreFramebuffer(!1,!0),i.currentFramebuffer||e.viewport(0,0,i.width,i.height),i.restoreStencilMask(),this.flush(),this.tempSprite=null},onDraw:function(t){this.drawToGame(t)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.quadVertexViewF32;h[2]=t,h[3]=e,h[9]=i,h[10]=n,h[16]=s,h[17]=r,h[23]=t,h[24]=e,h[30]=s,h[31]=r,h[37]=a,h[38]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)},destroy:function(){return this.renderer.deleteBuffer(this.quadVertexBuffer),this.drawSpriteShader=null,this.copyShader=null,this.gameShader=null,this.colorMatrixShader=null,this.quadVertexData=null,this.quadVertexBuffer=null,this.quadVertexViewF32=null,this.fsTarget=null,this.tempSprite=null,r.prototype.destroy.call(this),this}});return c_=d}function YB(){return p_?f_:(p_=1,f_=["#define SHADER_NAME PHASER_ADD_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = frame1 + frame2 * uStrength;","}"].join("\n"))}function XB(){return v_?g_:(v_=1,g_=["#define SHADER_NAME PHASER_COPY_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uBrightness;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}"].join("\n"))}function GB(){return y_?m_:(y_=1,m_=["#define SHADER_NAME PHASER_LIGHT_FS","precision mediump float;","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","const int kMaxLights = %LIGHT_COUNT%;","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","uniform int uLightCount;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","    for (int index = 0; index < kMaxLights; ++index)","    {","        if (index < uLightCount)","        {","            Light light = uLights[index];","            vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","            vec3 lightNormal = normalize(lightDir);","            float distToSurf = length(lightDir) * uCamera.w;","            float diffuseFactor = max(dot(normal, lightNormal), 0.0);","            float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","            float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","            vec3 diffuse = light.color * diffuseFactor;","            finalColor += (attenuation * diffuse) * light.intensity;","        }","    }","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}"].join("\n"))}function WB(){return w_?x_:(w_=1,x_=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}"].join("\n"))}function HB(){return R_?M_:(R_=1,M_=["#define SHADER_NAME PHASER_POINTLIGHT_FS","precision mediump float;","uniform vec2 uResolution;","uniform float uCameraZoom;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","    float distToSurf = length(center - gl_FragCoord.xy);","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}"].join("\n"))}function VB(){return O_?L_:(O_=1,L_=["#define SHADER_NAME PHASER_POINTLIGHT_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}"].join("\n"))}function jB(){if(k_)return I_;k_=1;var t=Vh(),e=OB(),i=iu(),n=Wh(),s=zB(),r=D_?F_:(D_=1,F_={AddBlendFrag:YB(),BitmapMaskFrag:Vk(),BitmapMaskVert:jk(),ColorMatrixFrag:FB(),CopyFrag:XB(),FXBarrelFrag:tB(),FXBloomFrag:rB(),FXBlurHighFrag:lB(),FXBlurLowFrag:oB(),FXBlurMedFrag:hB(),FXBokehFrag:cB(),FXCircleFrag:fB(),FXDisplacementFrag:vB(),FXGlowFrag:yB(),FXGradientFrag:wB(),FXPixelateFrag:bB(),FXShadowFrag:EB(),FXShineFrag:CB(),FXVignetteFrag:PB(),FXWipeFrag:RB(),LightFrag:GB(),LinearBlendFrag:WB(),MeshFrag:b_?T_:(b_=1,T_=["#define SHADER_NAME PHASER_MESH_FS","precision mediump float;","uniform vec3 uLightPosition;","uniform vec3 uLightAmbient;","uniform vec3 uLightDiffuse;","uniform vec3 uLightSpecular;","uniform vec3 uFogColor;","uniform float uFogNear;","uniform float uFogFar;","uniform vec3 uMaterialAmbient;","uniform vec3 uMaterialDiffuse;","uniform vec3 uMaterialSpecular;","uniform float uMaterialShine;","uniform vec3 uCameraPosition;","uniform sampler2D uTexture;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main (void)","{","    vec4 color = texture2D(uTexture, vTextureCoord);","    vec3 ambient = uLightAmbient * uMaterialAmbient;","    vec3 norm = normalize(vNormal);","    vec3 lightDir = normalize(uLightPosition - vPosition);","    float diff = max(dot(norm, lightDir), 0.0);","    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);","    vec3 viewDir = normalize(uCameraPosition - vPosition);","    vec3 reflectDir = reflect(-lightDir, norm);","    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);","    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);","    vec3 result = (ambient + diffuse + specular) * color.rgb;","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep(uFogNear, uFogFar, depth);","    gl_FragColor.rgb = mix(result.rgb, uFogColor, fogFactor);","    gl_FragColor.a = color.a;","}"].join("\n")),MeshVert:E_?S_:(E_=1,S_=["#define SHADER_NAME PHASER_MESH_VS","precision mediump float;","attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uViewProjectionMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uNormalMatrix;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main ()","{","    vTextureCoord = aTextureCoord;","    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));","    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));","    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);","}"].join("\n")),MobileFrag:C_?__:(C_=1,__=["#define SHADER_NAME PHASER_MOBILE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")),MobileVert:P_?A_:(P_=1,A_=["#define SHADER_NAME PHASER_MOBILE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")),MultiFrag:IB(),MultiVert:kB(),PointLightFrag:HB(),PointLightVert:VB(),PostFXFrag:eB(),QuadVert:iB(),SingleFrag:NB(),SingleVert:UB()}),a=Zk(),o=new t({Extends:s,initialize:function(t){t.shaders=[a.setGlowQuality(r.FXGlowFrag,t.game),r.FXShadowFrag,r.FXPixelateFrag,r.FXVignetteFrag,r.FXShineFrag,r.FXBlurLowFrag,r.FXBlurMedFrag,r.FXBlurHighFrag,r.FXGradientFrag,r.FXBloomFrag,r.ColorMatrixFrag,r.FXCircleFrag,r.FXBarrelFrag,r.FXDisplacementFrag,r.FXWipeFrag,r.FXBokehFrag],s.call(this,t);var n=this.game;this.glow=new e.Glow(n),this.shadow=new e.Shadow(n),this.pixelate=new e.Pixelate(n),this.vignette=new e.Vignette(n),this.shine=new e.Shine(n),this.gradient=new e.Gradient(n),this.circle=new e.Circle(n),this.barrel=new e.Barrel(n),this.wipe=new e.Wipe(n),this.bokeh=new e.Bokeh(n);var o=[];o[i.GLOW]=this.onGlow,o[i.SHADOW]=this.onShadow,o[i.PIXELATE]=this.onPixelate,o[i.VIGNETTE]=this.onVignette,o[i.SHINE]=this.onShine,o[i.BLUR]=this.onBlur,o[i.GRADIENT]=this.onGradient,o[i.BLOOM]=this.onBloom,o[i.COLOR_MATRIX]=this.onColorMatrix,o[i.CIRCLE]=this.onCircle,o[i.BARREL]=this.onBarrel,o[i.DISPLACEMENT]=this.onDisplacement,o[i.WIPE]=this.onWipe,o[i.BOKEH]=this.onBokeh,this.fxHandlers=o,this.source,this.target,this.swap},onDraw:function(t,e,i){this.source=t,this.target=e,this.swap=i;var n=t.width,s=t.height,r=this.tempSprite,a=this.fxHandlers;if(r&&r.preFX)for(var o=r.preFX.list,h=0;h<o.length;h++){var l=o[h];l.active&&a[l.type].call(this,l,n,s)}this.drawToGame(this.source)},runDraw:function(){var t=this.source,e=this.target;this.copy(t,e),this.source=e,this.target=t},onGlow:function(t,e,n){var s=this.shaders[i.GLOW];this.setShader(s),this.glow.onPreRender(t,s,e,n),this.runDraw()},onShadow:function(t){var e=this.shaders[i.SHADOW];this.setShader(e),this.shadow.onPreRender(t,e),this.runDraw()},onPixelate:function(t,e,n){var s=this.shaders[i.PIXELATE];this.setShader(s),this.pixelate.onPreRender(t,s,e,n),this.runDraw()},onVignette:function(t){var e=this.shaders[i.VIGNETTE];this.setShader(e),this.vignette.onPreRender(t,e),this.runDraw()},onShine:function(t,e,n){var s=this.shaders[i.SHINE];this.setShader(s),this.shine.onPreRender(t,s,e,n),this.runDraw()},onBlur:function(t,e,s){var r=n(t,"quality"),a=this.shaders[i.BLUR+r];this.setShader(a),this.set1i("uMainSampler",0),this.set2f("resolution",e,s),this.set1f("strength",n(t,"strength")),this.set3fv("color",n(t,"glcolor"));for(var o=n(t,"x"),h=n(t,"y"),l=n(t,"steps"),u=0;u<l;u++)this.set2f("offset",o,0),this.runDraw(),this.set2f("offset",0,h),this.runDraw()},onGradient:function(t){var e=this.shaders[i.GRADIENT];this.setShader(e),this.gradient.onPreRender(t,e),this.runDraw()},onBloom:function(t,e,s){var r=this.shaders[i.BLOOM];this.copySprite(this.source,this.swap),this.setShader(r),this.set1i("uMainSampler",0),this.set1f("strength",n(t,"blurStrength")),this.set3fv("color",n(t,"glcolor"));for(var a=2/e*n(t,"offsetX"),o=2/s*n(t,"offsetY"),h=n(t,"steps"),l=0;l<h;l++)this.set2f("offset",a,0),this.runDraw(),this.set2f("offset",0,o),this.runDraw();this.blendFrames(this.swap,this.source,this.target,n(t,"strength")),this.copySprite(this.target,this.source)},onColorMatrix:function(t){this.setShader(this.colorMatrixShader),this.set1fv("uColorMatrix",t.getData()),this.set1f("uAlpha",t.alpha),this.runDraw()},onCircle:function(t,e,n){var s=this.shaders[i.CIRCLE];this.setShader(s),this.circle.onPreRender(t,s,e,n),this.runDraw()},onBarrel:function(t){var e=this.shaders[i.BARREL];this.setShader(e),this.barrel.onPreRender(t,e),this.runDraw()},onDisplacement:function(t){this.setShader(this.shaders[i.DISPLACEMENT]),this.set1i("uDisplacementSampler",1),this.set2f("amount",t.x,t.y),this.bindTexture(t.glTexture,1),this.runDraw()},onWipe:function(t){var e=this.shaders[i.WIPE];this.setShader(e),this.wipe.onPreRender(t,e),this.runDraw()},onBokeh:function(t,e,n){var s=this.shaders[i.BOKEH];this.setShader(s),this.bokeh.onPreRender(t,s,e,n),this.runDraw()},destroy:function(){return this.glow.destroy(),this.shadow.destroy(),this.pixelate.destroy(),this.vignette.destroy(),this.shine.destroy(),this.gradient.destroy(),this.circle.destroy(),this.barrel.destroy(),this.wipe.destroy(),this.bokeh.destroy(),this.fxHandlers=null,this.source=null,this.target=null,this.swap=null,s.prototype.destroy.call(this),this}});return I_=o}function qB(){if(N_)return B_;N_=1;var t=Vh(),e=Wh(),i=GB(),n=BB(),s=tc(),r=Ru(),a=$k(),o=new t({Extends:n,initialize:function(t){var a=e(t,"fragShader",i);t.fragShader=a.replace("%LIGHT_COUNT%",t.game.renderer.config.maxLights),n.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.currentNormalMap,this.lightsActive=!0,this.tempVec2=new r,this._tempMatrix=new s,this._tempMatrix2=new s},boot:function(){a.prototype.boot.call(this)},onRender:function(t,e){var i=t.sys.lights;if(this.lightsActive=!1,i&&i.active){var n,s=i.getLights(e),r=s.length;this.lightsActive=!0;var a=this.renderer.height,o=e.matrix,h=this.tempVec2;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",e.x,e.y,e.rotation,e.zoom),this.set3f("uAmbientLightColor",i.ambientColor.r,i.ambientColor.g,i.ambientColor.b),this.set1i("uLightCount",r),n=0;n<r;n++){var l=s[n].light,u=l.color,c="uLights["+n+"].";o.transformPoint(l.x,l.y,h),this.set2f(c+"position",h.x-e.scrollX*l.scrollFactorX*e.zoom,a-(h.y-e.scrollY*l.scrollFactorY*e.zoom)),this.set3f(c+"color",u.r,u.g,u.b),this.set1f(c+"intensity",l.intensity),this.set1f(c+"radius",l.radius)}this.currentNormalMapRotation=null}},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.vertexCount){this.vertexCount>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var i=-t,n=Math.cos(i),s=Math.sin(i);e[1]=s,e[3]=-s,e[0]=e[4]=n}else e[0]=e[4]=1,e[1]=e[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},setTexture2D:function(t,e){var i=this.renderer;void 0===t&&(t=i.whiteTexture);var n=this.getNormalMap(e);this.isNewNormalMap(t,n)&&(this.flush(),this.createBatch(t),this.addTextureToBatch(n),this.currentNormalMap=n);var s=0;return e&&e.parentContainer?s=e.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2).rotationNormalized:e&&(s=e.rotation),null===this.currentBatch&&(this.createBatch(t),this.addTextureToBatch(n)),this.setNormalMapRotation(s),0},setGameObject:function(t,e){void 0===e&&(e=t.frame);var i=e.glTexture,n=this.getNormalMap(t);if(this.isNewNormalMap(i,n)&&(this.flush(),this.createBatch(i),this.addTextureToBatch(n),this.currentNormalMap=n),t.parentContainer){var s=t.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);this.setNormalMapRotation(s.rotationNormalized)}else this.setNormalMapRotation(t.rotation);return null===this.currentBatch&&(this.createBatch(i),this.addTextureToBatch(n)),0},isNewNormalMap:function(t,e){return this.currentTexture!==t||this.currentNormalMap!==e},getNormalMap:function(t){var e;return t?(t.displayTexture?e=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?e=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(e=Array.isArray(t.tileset)?t.tileset[0].image.dataSource[0]:t.tileset.image.dataSource[0]),e?e.glTexture:this.renderer.normalTexture):this.renderer.normalTexture},batchSprite:function(t,e,i){this.lightsActive&&n.prototype.batchSprite.call(this,t,e,i)},batchTexture:function(t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,T,b,S,E,_,C,A,P,M,R,L,O){this.lightsActive&&n.prototype.batchTexture.call(this,t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,v,m,y,x,w,T,b,S,E,_,C,A,P,M,R,L,O)},batchTextureFrame:function(t,e,i,s,r,a,o){this.lightsActive&&n.prototype.batchTextureFrame.call(this,t,e,i,s,r,a,o)}});return B_=o}function KB(){if(z_)return U_;z_=1;var t=Vh(),e=Wh(),i=BB(),n=NB(),s=UB(),r=qk(),a=$k(),o=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:r.UNSIGNED_BYTE,normalized:!0}]),t.forceZero=!0,t.resizeUniform="uResolution",i.call(this,t)},boot:function(){a.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return U_=o}function ZB(){if(X_)return Y_;X_=1;var t=Vh(),e=Wh(),i=HB(),n=VB(),s=$k(),r=new t({Extends:s,initialize:function(t){t.vertShader=e(t,"vertShader",n),t.fragShader=e(t,"fragShader",i),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),s.call(this,t)},onRender:function(t,e){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",e.zoom)},batchPointLight:function(t,e,i,n,s,r,a,o,h,l,u,c){var d=t.color,f=t.intensity,p=t.radius,g=t.attenuation,v=d.r*f,m=d.g*f,y=d.b*f,x=e.alpha*t.alpha;this.shouldFlush(6)&&this.flush(),this.currentBatch||this.setTexture2D(),this.batchLightVert(i,n,u,c,p,g,v,m,y,x),this.batchLightVert(s,r,u,c,p,g,v,m,y,x),this.batchLightVert(a,o,u,c,p,g,v,m,y,x),this.batchLightVert(i,n,u,c,p,g,v,m,y,x),this.batchLightVert(a,o,u,c,p,g,v,m,y,x),this.batchLightVert(h,l,u,c,p,g,v,m,y,x),this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchLightVert:function(t,e,i,n,s,r,a,o,h,l){var u=this.vertexViewF32,c=this.vertexCount*this.currentShader.vertexComponentCount-1;u[++c]=t,u[++c]=e,u[++c]=i,u[++c]=n,u[++c]=s,u[++c]=r,u[++c]=a,u[++c]=o,u[++c]=h,u[++c]=l,this.vertexCount++}});return Y_=r}function JB(){if(W_)return G_;W_=1;var t=Vh(),e=Wh(),i=BB(),n=new t({Extends:i,initialize:function(t){t.topology=5,t.batchSize=e(t,"batchSize",256),i.call(this,t)}});return G_=n}function $B(){if(V_)return H_;V_=1;var t=Vh(),e=Wh(),i=BB(),n=NB(),s=UB(),r=$k(),a=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.forceZero=!0,i.call(this,t)},boot:function(){r.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return H_=a}function QB(){if(q_)return j_;q_=1;var t=YB(),e=Qo(),i=Vh(),n=lu(),s=FB(),r=XB(),a=Wh(),o=WB(),h=iB(),l=$k(),u=new i({Extends:l,initialize:function(e){e.renderTarget=a(e,"renderTarget",[{scale:1,autoResize:!0},{scale:1,autoResize:!0},{scale:.5,autoResize:!0},{scale:.5,autoResize:!0}]),e.vertShader=a(e,"vertShader",h),e.shaders=a(e,"shaders",[{name:"Copy",fragShader:r},{name:"AddBlend",fragShader:t},{name:"LinearBlend",fragShader:o},{name:"ColorMatrix",fragShader:s}]),e.attributes=a(e,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),e.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],e.batchSize=1,l.call(this,e),this.colorMatrix=new n,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){l.prototype.boot.call(this);var t=this.shaders,e=this.renderTargets;this.copyShader=t[0],this.addShader=t[1],this.linearShader=t[2],this.colorMatrixShader=t[3],this.fullFrame1=e[0],this.fullFrame2=e[1],this.halfFrame1=e[2],this.halfFrame2=e[3]},copyFrame:function(t,e,i,n,s){void 0===i&&(i=1),void 0===n&&(n=!0),void 0===s&&(s=!0);var r=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",i),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0)):r.viewport(0,0,t.width,t.height),n&&(s?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT)),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)},blitFrame:function(t,i,n,s,r,a,o){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===a&&(a=!1),void 0===o&&(o=!1);var h=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,t.texture.webGLTexture),t.height>i.height)h.viewport(0,0,t.width,t.height),this.setTargetUVs(t,i);else{var l=i.height-t.height;h.viewport(0,l,t.width,t.height)}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),s&&(r?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),a){var u=this.renderer.currentBlendMode;this.renderer.setBlendMode(e.ERASE)}o&&this.flipY(),h.bufferData(h.ARRAY_BUFFER,this.vertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),a&&this.renderer.setBlendMode(u),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=!0),void 0===o&&(o=!0);var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,t.texture.webGLTexture,0),a&&(o?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),h.copyTexSubImage2D(h.TEXTURE_2D,0,0,0,i,n,s,r),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null)},copyToGame:function(t){var e=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture.webGLTexture),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),e.drawArrays(e.TRIANGLES,0,6)},drawFrame:function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=this.colorMatrix);var s=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",n.getData()),this.set1f("uAlpha",n.alpha),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture.webGLTexture),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture.webGLTexture,0)):s.viewport(0,0,t.width,t.height),i?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D,null)},blendFrames:function(t,e,i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=this.linearShader);var a=this.gl;this.setShader(r),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",n),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture.webGLTexture),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,e.texture.webGLTexture),i?(a.bindFramebuffer(a.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i.texture.webGLTexture,0),a.viewport(0,0,i.width,i.height)):a.viewport(0,0,t.width,t.height),s?a.clearColor(0,0,0,0):a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.bufferData(a.ARRAY_BUFFER,this.vertexData,a.STATIC_DRAW),a.drawArrays(a.TRIANGLES,0,6),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindTexture(a.TEXTURE_2D,null)},blendFramesAdditive:function(t,e,i,n,s){this.blendFrames(t,e,i,n,s,this.addShader)},clearFrame:function(t,e){void 0===e&&(e=!0);var i=this.gl;i.viewport(0,0,t.width,t.height),i.bindFramebuffer(i.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),e?i.clearColor(0,0,0,0):i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);var n=this.renderer.currentFramebuffer;i.bindFramebuffer(i.FRAMEBUFFER,n.webGLFramebuffer)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.vertexViewF32;h[2]=t,h[3]=e,h[6]=i,h[7]=n,h[10]=s,h[11]=r,h[14]=t,h[15]=e,h[18]=s,h[19]=r,h[22]=a,h[23]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});return j_=u}function tN(){if(Z_)return K_;Z_=1;var t=Vh(),e=Bk(),i=fI(),n=$l(),s=Wh(),r=Hk(),a=bk(),o=Qk(),h=OB(),l=iu(),u=jB(),c=qB(),d=KB(),f=BB(),p=ZB(),g=JB(),v=$B(),m=QB(),y=Tl(),x=kl(),w=new t({initialize:function(t){this.game=t.game,this.renderer=t,this.classes=new i([[e.UTILITY_PIPELINE,m],[e.MULTI_PIPELINE,f],[e.BITMAPMASK_PIPELINE,o],[e.SINGLE_PIPELINE,v],[e.ROPE_PIPELINE,g],[e.LIGHT_PIPELINE,c],[e.POINTLIGHT_PIPELINE,p],[e.MOBILE_PIPELINE,d]]),this.postPipelineClasses=new i,this.pipelines=new i,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(t,i,a){var o=this.renderer,c=this.renderTargets;this.frameInc=Math.floor(s(t,"frameInc",32));var d,f,p=o.width,g=o.height,v=this.game.config.disablePreFX;if(this.game.config.disablePostFX||this.postPipelineClasses.setAll([[String(l.BARREL),h.Barrel],[String(l.BLOOM),h.Bloom],[String(l.BLUR),h.Blur],[String(l.BOKEH),h.Bokeh],[String(l.CIRCLE),h.Circle],[String(l.COLOR_MATRIX),h.ColorMatrix],[String(l.DISPLACEMENT),h.Displacement],[String(l.GLOW),h.Glow],[String(l.GRADIENT),h.Gradient],[String(l.PIXELATE),h.Pixelate],[String(l.SHADOW),h.Shadow],[String(l.SHINE),h.Shine],[String(l.VIGNETTE),h.Vignette],[String(l.WIPE),h.Wipe]]),!v){this.classes.set(e.FX_PIPELINE,u);for(var m=Math.min(p,g),y=Math.ceil(m/this.frameInc),x=1;x<y;x++){var w=x*this.frameInc;c.push(new r(o,w,w)),c.push(new r(o,w,w)),c.push(new r(o,w,w)),this.maxDimension=w}c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0))}var T=this,b=this.game;if(this.classes.each(function(t,i){d=T.add(t,new i({game:b})),t===e.UTILITY_PIPELINE&&(T.UTILITY_PIPELINE=d,T.fullFrame1=d.fullFrame1,T.fullFrame2=d.fullFrame2,T.halfFrame1=d.halfFrame1,T.halfFrame2=d.halfFrame2)}),this.MULTI_PIPELINE=this.get(e.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(e.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(e.MOBILE_PIPELINE),v||(this.FX_PIPELINE=this.get(e.FX_PIPELINE)),t)for(f in t){var S=t[f];(d=new S(b)).name=f,d.isPostFX?this.postPipelineClasses.set(f,S):this.has(f)||(this.classes.set(f,S),this.add(f,d))}this.default=this.get(i),a&&!n.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(t){var e=this.get(t);return e&&(this.default=e),e},add:function(t,e){if(!e.isPostFX){var i=this.pipelines,n=this.renderer;return i.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,i.set(t,e)),e.hasBooted||e.boot(),0===n.width||0===n.height||e.isPreFX||e.resize(n.width,n.height),e}console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return"string"==typeof t?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;return"string"==typeof t?e.get(t):e.contains(t)?t:void 0},getPostPipeline:function(t,e,i){var n,s=this.postPipelineClasses,r="",a=typeof t;if("string"===a||"number"===a?(n=s.get(t),r=t):"function"===a?(s.contains(t)&&(n=t),r=t.name):"object"===a&&(n=s.get(t.name),r=t.name),n){var o=new n(this.game,i);return o.name=r,e&&(o.gameObject=e),this.postPipelineInstances.push(o),o}},removePostPipeline:function(t){x(this.postPipelineInstances,t)},remove:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),this.pipelines.delete(t),e&&this.classes.delete(t),i&&this.postPipelineClasses.delete(t)},set:function(t,e,i){if(!t.isPostFX)return this.isCurrent(t,i)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(i)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},isCurrent:function(t,e){var i=this.renderer,n=this.current;return n&&!e&&(e=n.currentShader),!(n!==t||e.program!==i.currentProgram)},copyFrame:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,i,n,s),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,i,n){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,i,n),this},blendFrames:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,i,n,s),this},blendFramesAdditive:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,i,n,s),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,i,n,s,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,i,n,s,r),this},copyFrameRect:function(t,e,i,n,s,r,a,o){return this.UTILITY_PIPELINE.copyFrameRect(t,e,i,n,s,r,a,o),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(t,e){e.restoreContext()}),y(this.postPipelineInstances,function(t){t.restoreContext()})},rebind:function(t){void 0===t&&this.previous&&(t=this.previous);var e=this.renderer,i=e.gl;i.disable(i.DEPTH_TEST),i.disable(i.CULL_FACE),e.hasActiveStencilMask()?i.clear(i.DEPTH_BUFFER_BIT):(i.disable(i.STENCIL_TEST),i.clear(i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT)),i.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var n=e.vaoExtension;n&&n.bindVertexArrayOES(null);var s=this.pipelines.entries;for(var r in s)s[r].glReset=!0;t&&(this.current=t,t.rebind())},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0);var e=t.vaoExtension;e&&e.bindVertexArrayOES(null)},getRenderTarget:function(t){var e=this.renderTargets;if(t>this.maxDimension)return this.targetIndex=e.length-3,e[this.targetIndex];var i=3*(a(t,this.frameInc,0,!0)-1);return this.targetIndex=i,e[i]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});return K_=w}function eN(){if($_)return J_;$_=1;var t=Hl(),e=PI(),i=Wh();return J_=function(n,s){var r=n,a=i(s,"callback"),o=i(s,"type","image/png"),h=i(s,"encoder",.92),l=Math.abs(Math.round(i(s,"x",0))),u=Math.abs(Math.round(i(s,"y",0))),c=i(s,"getPixel",!1),d=i(s,"isFramebuffer",!1),f=d?i(s,"bufferWidth",1):r.drawingBufferWidth,p=d?i(s,"bufferHeight",1):r.drawingBufferHeight;if(c){var g=new Uint8Array(4),v=d?u:p-u;r.readPixels(l,v,1,1,r.RGBA,r.UNSIGNED_BYTE,g),a.call(null,new e(g[0],g[1],g[2],g[3]))}else{var m=Math.floor(i(s,"width",f)),y=Math.floor(i(s,"height",p)),x=m*y*4,w=new Uint8Array(x);r.readPixels(l,p-u-y,m,y,r.RGBA,r.UNSIGNED_BYTE,w);for(var T=t.createWebGL(this,m,y),b=T.getContext("2d",{willReadFrequently:!0}),S=b.getImageData(0,0,m,y),E=S.data,_=0;_<y;_++)for(var C=0;C<m;C++){var A=4*((y-_-1)*m+C),P=d?x-4*(_*m+(m-C)):4*(_*m+C);E[P+0]=w[A+0],E[P+1]=w[A+1],E[P+2]=w[A+2],E[P+3]=w[A+3]}b.putImageData(S,0,0);var M=new Image;M.onerror=function(){a.call(null),t.remove(T)},M.onload=function(){a.call(null,M),t.remove(T)},M.src=T.toDataURL(o,h)}},J_}function iN(){if(tC)return Q_;tC=1;var t=new(Vh())({initialize:function(t,e,i,n){this.webGLBuffer=null,this.gl=t,this.initialDataOrSize=e,this.bufferType=i,this.bufferUsage=n,this.createResource()},createResource:function(){if(null!==this.initialDataOrSize){var t=this.gl;if(!t.isContextLost()){var e=this.bufferType,i=t.createBuffer();this.webGLBuffer=i,t.bindBuffer(e,this.webGLBuffer),t.bufferData(e,this.initialDataOrSize,this.bufferUsage),t.bindBuffer(e,null)}}},destroy:function(){var t=this.gl;t.isContextLost()||t.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});return Q_=t}function nN(){if(iC)return eC;iC=1;var t=new(Vh())({initialize:function(t,e,i){this.webGLProgram=null,this.gl=t,this.vertexSource=e,this.fragmentSource=i,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var e=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,this.vertexSource),t.shaderSource(n,this.fragmentSource),t.compileShader(i),t.compileShader(n);var s="Shader failed:\n";if(!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex "+s+t.getShaderInfoLog(i));if(!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment "+s+t.getShaderInfoLog(n));if(t.attachShader(e,i),t.attachShader(e,n),t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS))throw new Error("Link "+s+t.getProgramInfoLog(e));t.useProgram(e),this.webGLProgram=e}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});return eC=t}function sN(){if(sC)return nC;sC=1;var t=Vh(),e=Tk(),i=new t({initialize:function(t,e,i,n,s,r,a,o,h,l,u,c,d){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=t,this.mipLevel=e,this.minFilter=i,this.magFilter=n,this.wrapT=s,this.wrapS=r,this.format=a,this.pixels=o,this.width=h,this.height=l,this.pma=null==u||u,this.forceSize=!!c,this.flipY=!!d,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost())if(this.pixels instanceof i)this.webGLTexture=this.pixels.webGLTexture;else{var e=t.createTexture();e.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=e,this._processTexture()}},update:function(t,e,i,n,s,r,a,o,h){0!==e&&0!==i&&(this.pixels=t,this.width=e,this.height=i,this.flipY=n,this.wrapS=s,this.wrapT=r,this.minFilter=a,this.magFilter=o,this.format=h,this.gl.isContextLost()||this._processTexture())},_processTexture:function(){var t=this.gl;t.activeTexture(t.TEXTURE0);var i=t.getParameter(t.TEXTURE_BINDING_2D);t.bindTexture(t.TEXTURE_2D,this.webGLTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY);var n=this.pixels,s=this.mipLevel,r=this.width,a=this.height,o=this.format,h=!1;if(null==n)t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,null),h=e(r,a);else if(n.compressed){r=n.width,a=n.height,h=n.generateMipmap;for(var l=0;l<n.mipmaps.length;l++)t.compressedTexImage2D(t.TEXTURE_2D,l,n.internalFormat,n.mipmaps[l].width,n.mipmaps[l].height,0,n.mipmaps[l].data)}else n instanceof Uint8Array?(t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,n),h=e(r,a)):(this.forceSize||(r=n.width,a=n.height),t.texImage2D(t.TEXTURE_2D,s,o,o,t.UNSIGNED_BYTE,n),h=e(r,a));h&&t.generateMipmap(t.TEXTURE_2D),i?t.bindTexture(t.TEXTURE_2D,i):t.bindTexture(t.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(t){this.__SPECTOR_Metadata=t,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=t)}},destroy:function(){null!==this.webGLTexture&&(this.gl.isContextLost()||this.pixels instanceof i||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});return nC=i}function rN(){if(aC)return rC;aC=1;var t=Vh(),e={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},i=new t({initialize:function(t,e,i,n,s){this.webGLFramebuffer=null,this.gl=t,this.width=e,this.height=i,this.renderTexture=n,this.addDepthStencilBuffer=!!s,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var i,n=this.renderTexture,s=t.createFramebuffer();if(this.webGLFramebuffer=s,t.bindFramebuffer(t.FRAMEBUFFER,s),n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.webGLTexture,0),(i=t.checkFramebufferStatus(t.FRAMEBUFFER))!==t.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(e[i]||i));if(this.addDepthStencilBuffer){var r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r)}t.bindFramebuffer(t.FRAMEBUFFER,null)}},destroy:function(){if(null!==this.webGLFramebuffer){var t=this.gl;if(!t.isContextLost()){t.bindFramebuffer(t.FRAMEBUFFER,this.webGLFramebuffer);var e=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==e&&(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.deleteTexture(e));var i=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==i&&t.deleteRenderbuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});return rC=i}function aN(){if(hC)return oC;hC=1;var t=new(Vh())({initialize:function(t,e,i){this.webGLAttribLocation=-1,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLAttribLocation=t.getAttribLocation(this.program.webGLProgram,this.name))}else this.webGLAttribLocation=-1},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});return oC=t}function oN(){if(uC)return lC;uC=1;var t=new(Vh())({initialize:function(t,e,i){this.webGLUniformLocation=null,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLUniformLocation=t.getUniformLocation(this.program.webGLProgram,this.name))}else this.webGLUniformLocation=null},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});return lC=t}function hN(){if(dC)return cC;dC=1;var t=Tl(),e=kl(),i=SI(),n=Vh(),s=eh(),r=qF(),a=Yk(),o=Tk(),h=Ak(),l=Hh(),u=tN(),c=Hk(),d=VI(),f=Gk(),p=Zk(),g=eN(),v=iN(),m=nN(),y=sN(),x=rN(),w=aN(),T=oN(),b=new n({Extends:r,initialize:function(t){r.call(this);var e=t.config,i={alpha:e.transparent,desynchronized:e.desynchronized,depth:!0,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference,preserveDrawingBuffer:e.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:i,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights,mipmapFilter:e.mipmapFilter},this.game=t,this.type=s.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=l,this.contextRestoredHandler=l,this.previousContextLostHandler=l,this.previousContextRestoredHandler=l,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(t){var e,i=this.game,n=this.canvas,r=t.backgroundColor;if(!(e=i.config.context?i.config.context:n.getContext("webgl",t.contextCreation)||n.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e,this.setExtensions(),this.setContextHandlers(),i.context=e;for(var a=0;a<=27;a++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});return this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats=[e.BYTE,e.SHORT,e.UNSIGNED_BYTE,e.UNSIGNED_SHORT,e.FLOAT],this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}},t.maxTextures&&-1!==t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),e.clear(e.COLOR_BUFFER_BIT),-1!==["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"].indexOf(t.mipmapFilter)&&(this.mipmapFilter=e[t.mipmapFilter]),this.maxTextures=p.checkShaderMax(e,t.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new u(this),this.setBlendMode(s.BlendModes.NORMAL),this.projectionMatrix=(new h).identity(),i.textures.once(f.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,i=t.scale.baseSize,n=i.width,s=i.height;this.width=n,this.height=s,this.isBooted=!0,this.renderTarget=new c(this,n,s,1,0,!0,!0),this.maskTarget=new c(this,n,s,1,0,!0,!0),this.maskSource=new c(this,n,s,1,0,!0,!0);var r=t.config;e.boot(r.pipeline,r.defaultPipeline,r.autoMobilePipeline),this.blankTexture=t.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=t.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=t.textures.getFrame("__WHITE").glTexture;var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),t.scale.on(d.RESIZE,this.onResize,this),this.resize(n,s)},setExtensions:function(){var t=this.gl,e=t.getSupportedExtensions();this.supportedExtensions=e;var i="ANGLE_instanced_arrays";this.instancedArraysExtension=e.indexOf(i)>-1?t.getExtension(i):null;var n="OES_vertex_array_object";this.vaoExtension=e.indexOf(n)>-1?t.getExtension(n):null},setContextHandlers:function(t,e){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),this.contextLostHandler="function"==typeof t?t.bind(this):this.dispatchContextLost.bind(this),this.contextRestoredHandler="function"==typeof e?e.bind(this):this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(t){this.contextLost=!0,console&&console.warn("WebGL Context lost. Renderer disabled"),this.emit(a.LOSE_WEBGL,this),t.preventDefault()},dispatchContextRestored:function(e){var i=this.gl;if(i.isContextLost())console&&console.log("WebGL Context restored, but context is still lost");else{this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(s.BlendModes.NORMAL),i.disable(i.BLEND),i.disable(i.DEPTH_TEST),i.enable(i.CULL_FACE),this.compression=this.getCompressedTextures();var n=function(t){t.createResource()};t(this.glTextureWrappers,n),t(this.glBufferWrappers,n),t(this.glFramebufferWrappers,n),t(this.glProgramWrappers,n),t(this.glAttribLocationWrappers,n),t(this.glUniformLocationWrappers,n),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,console&&console.warn("WebGL Context restored. Renderer running again."),this.emit(a.RESTORE_WEBGL,this),e.preventDefault()}},createTemporaryTextures:function(){for(var t=this.gl,e=0;e<this.maxTextures;e++){var i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(e)}},captureFrame:function(t,e){},captureNextFrame:function(){},getFps:function(){},log:function(){},startCapture:function(t,e,i){},stopCapture:function(){},onCapture:function(t){},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},beginCapture:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var i=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),i.viewport(0,0,t,e),this.drawingBufferHeight=i.drawingBufferHeight,i.scissor(0,i.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(a.RESIZE,t,e),this},getCompressedTextures:function(){var t="WEBGL_compressed_texture_",e="WEBKIT_"+t,i=function(i,n){var s=i.getExtension(t+n)||i.getExtension(e+n)||i.getExtension("EXT_texture_compression_"+n);if(s){var r={};for(var a in s)r[s[a]]=a;return r}},n=this.gl;return{ETC:i(n,"etc"),ETC1:i(n,"etc1"),ATC:i(n,"atc"),ASTC:i(n,"astc"),BPTC:i(n,"bptc"),RGTC:i(n,"rgtc"),PVRTC:i(n,"pvrtc"),S3TC:i(n,"s3tc"),S3TCSRGB:i(n,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(t,e){var i=this.compression[t.toUpperCase()];if(e in i)return i[e]},supportsCompressedTexture:function(t,e){var i=this.compression[t.toUpperCase()];return!!i&&(!e||e in i)},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return t===this.projectionWidth&&e===this.projectionHeight||(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=[t,e,i,n];return this.scissorStack.push(r),this.setScissor(t,e,i,n,s),this.currentScissor=r,r},setScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=this.gl,a=this.currentScissor,o=i>0&&n>0;if(a&&o){var h=a[0],l=a[1],u=a[2],c=a[3];o=h!==t||l!==e||u!==i||c!==n}o&&(this.flush(),r.scissor(t,s-e-n,i,n))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var i=e[0],n=e[1],s=e[2],r=e[3];s>0&&r>0&&t.scissor(i,this.drawingBufferHeight-n-r,s,r)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){void 0===e&&(e=!1);var i=this.gl,n=this.blendModes[t];return!!(e||t!==s.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),i.enable(i.BLEND),i.blendEquation(n.equation),n.func.length>2?i.blendFuncSeparate(n.func[0],n.func[1],n.func[2],n.func[3]):i.blendFunc(n.func[0],n.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,i){return this.blendModes[t]&&(this.blendModes[t].func=e,i&&(this.blendModes[t].equation=i)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},pushFramebuffer:function(t,e,i,n,s){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,i,n,s))},setFramebuffer:function(t,e,i,n,s){if(void 0===e&&(e=!1),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===s&&(s=!1),t===this.currentFramebuffer)return this;var r=this.gl,a=this.width,o=this.height;return t&&t.renderTexture&&i?(a=t.renderTexture.width,o=t.renderTexture.height):this.flush(),t?r.bindFramebuffer(r.FRAMEBUFFER,t.webGLFramebuffer):r.bindFramebuffer(r.FRAMEBUFFER,null),i&&r.viewport(0,0,a,o),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.webGLTexture,0),s&&(r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)),e&&(t?(this.drawingBufferHeight=o,this.pushScissor(0,0,a,o)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,this},popFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack;i.pop();var n=i[i.length-1];return n||(n=null),this.setFramebuffer(n,t,e),n},restoreFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack,n=i[i.length-1];n||(n=null),this.currentFramebuffer=null,this.setFramebuffer(n,t,e)},setProgram:function(t){return t!==this.currentProgram&&(this.flush(),this.gl.useProgram(t.webGLProgram),this.currentProgram=t,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(t,e,i,n,r){void 0===r&&(r=!1);var a=this.gl,h=a.NEAREST,l=a.NEAREST,u=a.CLAMP_TO_EDGE;e=t?t.width:e,i=t?t.height:i;var c=o(e,i);if(c&&!r&&(u=a.REPEAT),n===s.ScaleModes.LINEAR&&this.config.antialias){var d=t&&t.compressed,f=!d&&c||d&&t.mipmaps.length>1;h=this.mipmapFilter&&f?this.mipmapFilter:a.LINEAR,l=a.LINEAR}return t||"number"!=typeof e||"number"!=typeof i?this.createTexture2D(0,h,l,u,u,a.RGBA,t):this.createTexture2D(0,h,l,u,u,a.RGBA,null,e,i)},createTexture2D:function(t,e,i,n,s,r,a,o,h,l,u,c){"number"!=typeof o&&(o=a?a.width:1),"number"!=typeof h&&(h=a?a.height:1);var d=new y(this.gl,t,e,i,n,s,r,a,o,h,l,u,c);return this.glTextureWrappers.push(d),d},createFramebuffer:function(t,e,i,n){this.currentFramebuffer=null;var s=new x(this.gl,t,e,i,n);return this.glFramebufferWrappers.push(s),s},beginBitmapMask:function(t,e){this.gl&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==t&&(this.currentMask.mask=t,this.currentMask.camera=e))},drawBitmapMask:function(t,e,i){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),t.renderWebGL(this,t,e),this.maskSource.unbind(!0),this.maskTarget.unbind();var n=this.gl,s=this.getCurrentStencilMask();s?(n.enable(n.STENCIL_TEST),s.mask.applyStencil(this,s.camera,!0)):this.currentMask.mask=null,this.pipelines.set(i),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.maskTarget.texture.webGLTexture),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(t,e){var i=new m(this.gl,t,e);return this.glProgramWrappers.push(i),i},createVertexBuffer:function(t,e){var i=this.gl,n=new v(i,t,i.ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},createAttribLocation:function(t,e){var i=new w(this.gl,t,e);return this.glAttribLocationWrappers.push(i),i},createUniformLocation:function(t,e){var i=new T(this.gl,t,e);return this.glUniformLocationWrappers.push(i),i},createIndexBuffer:function(t,e){var i=this.gl,n=new v(i,t,i.ELEMENT_ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},deleteTexture:function(t){if(t)return e(this.glTextureWrappers,t),t.destroy(),this},deleteFramebuffer:function(t){return t?(e(this.fboStack,t),e(this.glFramebufferWrappers,t),t.destroy(),this):this},deleteProgram:function(t){return t&&(e(this.glProgramWrappers,t),t.destroy()),this},deleteAttribLocation:function(t){return t&&(e(this.glAttribLocationWrappers,t),t.destroy()),this},deleteUniformLocation:function(t){return t&&(e(this.glUniformLocationWrappers,t),t.destroy()),this},deleteBuffer:function(t){return t?(e(this.glBufferWrappers,t),t.destroy(),this):this},preRenderCamera:function(t){var e=t.x,n=t.y,s=t.width,r=t.height,a=t.backgroundColor;t.emit(i.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,n,s,r),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),a.alphaGL>0&&this.pipelines.setMulti().drawFillRect(e,n,s,r,p.getTintFromFloats(a.blueGL,a.greenGL,a.redGL,1),a.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,i=this.currentCameraMask;return e.length>0?t=e[e.length-1]:i.mask&&i.mask.isStencil&&(t=i),t},postRenderCamera:function(t){var e=t.flashEffect,n=t.fadeEffect;if(e.isRunning||n.isRunning||n.isComplete){var s=this.pipelines.setMulti();e.postRenderWebGL(s,p.getTintFromFloats),n.postRenderWebGL(s,p.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(i.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.emit(a.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(a.PRE_RENDER)}},render:function(t,e,i){if(!this.contextLost){var n=e.length;if(this.emit(a.RENDER,t,i),this.preRenderCamera(i),0===n)return this.setBlendMode(s.BlendModes.NORMAL),void this.postRenderCamera(i);this.currentType="";for(var r=this.currentMask,o=0;o<n;o++){this.finalType=o===n-1;var h=e[o],l=h.mask;(r=this.currentMask).mask&&r.mask!==l&&r.mask.postRenderWebGL(this,r.camera),l&&r.mask!==l&&l.preRenderWebGL(this,h,i),h.blendMode!==this.currentBlendMode&&this.setBlendMode(h.blendMode);var u=h.type;u!==this.currentType&&(this.newType=!0,this.currentType=u),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[o+1].type===this.currentType,h.renderWebGL(this,h,i),this.newType=!1}(r=this.currentMask).mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(s.BlendModes.NORMAL),this.postRenderCamera(i)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(a.POST_RENDER);var t=this.snapshotState;t.callback&&(g(this.gl,t),t.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var t=this.gl,e=this.getCurrentStencilMask();if(e){var i=e.mask;t.enable(t.STENCIL_TEST),i.invertAlpha?t.stencilFunc(t.NOTEQUAL,i.level,255):t.stencilFunc(t.EQUAL,i.level,255)}},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=i,o.height=n,this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,i,n,s,r,a,o,h,l,u){void 0===s&&(s=!1),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=e),void 0===h&&(h=i),"pixel"===l&&(s=!0,l="image/png");var c=this.currentFramebuffer;this.snapshotArea(r,a,o,h,n,l,u);var d=this.snapshotState;return d.getPixel=s,d.isFramebuffer=!0,d.bufferWidth=e,d.bufferHeight=i,d.width=Math.min(d.width,e),d.height=Math.min(d.height,i),this.setFramebuffer(t),g(this.gl,d),this.setFramebuffer(c),d.callback=null,d.isFramebuffer=!1,this},canvasToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.width,l=t.height,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!1,n)},createCanvasTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.canvasToTexture(t,null,e,i)},updateCanvasTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.canvasToTexture(t,e,n,i)},videoToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.videoWidth,l=t.videoHeight,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!0,n)},createVideoTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.videoToTexture(t,null,e,i)},updateVideoTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.videoToTexture(t,e,n,i)},createUint8ArrayTexture:function(t,e,i){var n=this.gl,s=n.NEAREST,r=n.NEAREST,a=n.CLAMP_TO_EDGE;return o(e,i)&&(a=n.REPEAT),this.createTexture2D(0,s,r,a,a,n.RGBA,t,e,i)},setTextureFilter:function(t,e){var i=this.gl,n=0===e?i.LINEAR:i.NEAREST;i.activeTexture(i.TEXTURE0);var s=i.getParameter(i.TEXTURE_BINDING_2D);return i.bindTexture(i.TEXTURE_2D,t.webGLTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n),t.minFilter=n,t.magFilter=n,s&&i.bindTexture(i.TEXTURE_2D,s),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var e=function(t){t.destroy()};t(this.glAttribLocationWrappers,e),t(this.glBufferWrappers,e),t(this.glFramebufferWrappers,e),t(this.glProgramWrappers,e),t(this.glTextureWrappers,e),t(this.glUniformLocationWrappers,e),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}});return cC=b}function lN(){if(pC)return fC;pC=1;var t=Uk(),e=Hl(),i=eh(),n=Vl();return fC=function(s){var r=s.config;if((r.customEnvironment||r.canvas)&&r.renderType===i.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!r.customEnvironment&&!r.canvas&&r.renderType!==i.HEADLESS)if(r.renderType===i.AUTO&&(r.renderType=n.webGL?i.WEBGL:i.CANVAS),r.renderType===i.WEBGL){if(!n.webGL)throw new Error("Cannot create WebGL context, aborting.")}else{if(r.renderType!==i.CANVAS)throw new Error("Unknown value for renderer type: "+r.renderType);if(!n.canvas)throw new Error("Cannot create Canvas context, aborting.")}r.antialias||e.disableSmoothing();var a,o,h=s.scale.baseSize,l=h.width,u=h.height;r.canvas?(s.canvas=r.canvas,s.canvas.width=l,s.canvas.height=u):s.canvas=e.create(s,l,u,r.renderType),r.canvasStyle&&(s.canvas.style=r.canvasStyle),r.antialias||t.setCrisp(s.canvas),r.renderType!==i.HEADLESS&&(a=Wk(),o=hN(),r.renderType===i.WEBGL?s.renderer=new o(s):(s.renderer=new a(s),s.context=s.renderer.gameContext))}}function uN(){if(vC)return gC;vC=1;var t=eh();return gC=function(e){var i=e.config;if(!i.hideBanner){var n="WebGL";i.renderType===t.CANVAS?n="Canvas":i.renderType===t.HEADLESS&&(n="Headless");var s,r=i.audio,a=e.device.audio;if(s=a.webAudio&&!r.disableWebAudio?"Web Audio":r.noAudio||!a.webAudio&&!a.audioData?"No Audio":"HTML5 Audio",e.device.browser.ie)window.console&&console.log("Phaser v"+t.VERSION+" / https://phaser.io");else{var o,h="",l=[h];Array.isArray(i.bannerBackgroundColor)?(i.bannerBackgroundColor.forEach(function(t){h=h.concat("%c "),l.push("background: "+t),o=t}),l[l.length-1]="color: "+i.bannerTextColor+"; background: "+o):(h=h.concat("%c "),l.push("color: "+i.bannerTextColor+"; background: "+i.bannerBackgroundColor)),l.push("background: transparent"),i.gameTitle&&(h=h.concat(i.gameTitle),i.gameVersion&&(h=h.concat(" v"+i.gameVersion)),i.hidePhaser||(h=h.concat(" / "))),i.hidePhaser||(h=h.concat("Phaser v"+t.VERSION+"-FB ("+n+" | "+s+")")),h=h.concat(" %c "+i.gameURL),l[0]=h,console.log.apply(console,l)}}},gC}function cN(){if(yC)return mC;yC=1;var t=Vh(),e=Hh(),i=new t({initialize:function(){this.isRunning=!1,this.callback=e,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var t=this;this.step=function e(i){t.callback(i),t.isRunning&&(t.timeOutID=window.requestAnimationFrame(e))},this.stepTimeout=function e(){t.isRunning&&(t.timeOutID=window.setTimeout(e,t.delay)),t.callback(window.performance.now())}},start:function(t,e,i){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.delay=i,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=e}});return mC=i}function dN(){if(wC)return xC;wC=1;var t=Vh(),e=Ol(),i=Hh(),n=cN(),s=new t({initialize:function(t,s){this.game=t,this.raf=new n,this.started=!1,this.running=!1,this.minFps=e(s,"min",5),this.targetFps=e(s,"target",60),this.fpsLimit=e(s,"limit",0),this.hasFpsLimit=this.fpsLimit>0,this._limitRate=this.hasFpsLimit?1e3/this.fpsLimit:0,this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=i,this.forceSetTimeOut=e(s,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this.pauseDuration=0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=e(s,"deltaHistory",10),this.panicMax=e(s,"panicMax",120),this.rawDelta=0,this.now=0,this.smoothStep=e(s,"smoothStep",!0)},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.pauseDuration=this.time-this._pauseTime,this.startTime+=this.pauseDuration},resetDelta:function(){var t=window.performance.now();this.time=t,this.lastTime=t,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=Math.min(this._target,this.deltaHistory[e]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(t){if(this.started)return this;this.started=!0,this.running=!0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=t;var i=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(i,this.forceSetTimeOut,this._target)},smoothDelta:function(t){var e=this.deltaIndex,i=this.deltaHistory,n=this.deltaSmoothingMax;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,t=Math.min(t,this._target)),t>this._min&&(t=i[e],t=Math.min(t,this._min)),i[e]=t,this.deltaIndex++,this.deltaIndex>=n&&(this.deltaIndex=0);for(var s=0,r=0;r<n;r++)s+=i[r];return s/n},updateFPS:function(t){this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0},stepLimitFPS:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta+=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.delta>=this._limitRate&&(this.callback(t,this.delta),this.delta=0),this.lastTime=t,this.frame++},step:function(t){this.now=t;var e=Math.max(0,t-this.lastTime);this.rawDelta=e,this.time+=this.rawDelta,this.smoothStep&&(e=this.smoothDelta(e)),this.delta=e,t>=this.nextFpsUpdate&&this.updateFPS(t),this.framesThisSecond++,this.callback(t,e),this.lastTime=t,this.frame++},tick:function(){var t=window.performance.now();this.hasFpsLimit?this.stepLimitFPS(t):this.step(t)},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(t){void 0===t&&(t=!1);var e=window.performance.now();if(!this.running){t&&(this.startTime+=-this.lastTime+(this.lastTime+e));var i=this.hasFpsLimit?this.stepLimitFPS.bind(this):this.step.bind(this);this.raf.start(i,this.forceSetTimeOut,this._target),this.running=!0,this.nextFpsUpdate=e+1e3,this.framesThisSecond=0,this.fpsLimitTriggered=!1,this.tick()}},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.raf.destroy(),this.raf=null,this.game=null,this.callback=null}});return xC=s}function fN(){if(bC)return TC;bC=1;var t=pI();return TC=function(e){var i,n=e.events;void 0!==document.hidden?i="visibilitychange":["webkit","moz","ms"].forEach(function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},i=t+"visibilitychange")}),i&&document.addEventListener(i,function(e){document.hidden||"pause"===e.type?n.emit(t.HIDDEN):n.emit(t.VISIBLE)},!1),window.onblur=function(){n.emit(t.BLUR)},window.onfocus=function(){n.emit(t.FOCUS)},window.focus&&e.config.autoFocus&&window.focus()}}function pN(){return CC?_C:(CC=1,_C={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"})}function gN(){if(PC)return AC;PC=1;var t=pN(),e=Hl(),i=Ol();return AC=function(n){var s=i(n,"data",[]),r=i(n,"canvas",null),a=i(n,"palette",t),o=i(n,"pixelWidth",1),h=i(n,"pixelHeight",o),l=i(n,"resizeCanvas",!0),u=i(n,"clearCanvas",!0),c=i(n,"preRender",null),d=i(n,"postRender",null),f=Math.floor(Math.abs(s[0].length*o)),p=Math.floor(Math.abs(s.length*h));r||(r=e.create2D(this,f,p),l=!1,u=!1),l&&(r.width=f,r.height=p);var g=r.getContext("2d",{willReadFrequently:!0});u&&g.clearRect(0,0,f,p),c&&c(r,g);for(var v=0;v<s.length;v++)for(var m=s[v],y=0;y<m.length;y++){var x=m[y];"."!==x&&" "!==x&&(g.fillStyle=a[x],g.fillRect(y*o,v*h,o,h))}return d&&d(r,g),r},AC}function vN(){if(XC)return YC;XC=1;var t=Fu(),e=Qh();return YC=function(i,n){if(void 0===n&&(n=new t),0===i.length)return n;for(var s,r,a,o=Number.MAX_VALUE,h=Number.MAX_VALUE,l=e.MIN_SAFE_INTEGER,u=e.MIN_SAFE_INTEGER,c=0;c<i.length;c++)s=i[c],Array.isArray(s)?(r=s[0],a=s[1]):(r=s.x,a=s.y),o=Math.min(o,r),h=Math.min(h,a),l=Math.max(l,r),u=Math.max(u,a);return n.x=o,n.y=h,n.width=l-o,n.height=u-h,n}}function mN(){if(WC)return GC;WC=1;var t=Vh(),e=vN(),i=Fu(),n=Ru(),s=new t({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new n,this._tmpVec2B=new n},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,n){t||(t=new i),void 0===n&&(n=16);var s=this.getLength();n>s&&(n=s/2);var r=Math.max(1,Math.round(s/n));return e(this.getSpacedPoints(r),t)},getDistancePoints:function(t){var e=this.getLength(),i=Math.max(1,e/t);return this.getSpacedPoints(i)},getEndPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i=[],n=this.getPoint(0,this._tmpVec2A),s=0;i.push(0);for(var r=1;r<=t;r++)s+=(e=this.getPoint(r/t,this._tmpVec2B)).distance(n),i.push(s),n.copy(e);return this.cacheArcLengths=i,i},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++)i.push(this.getPoint(n/t));return i},getRandomPoint:function(t){return void 0===t&&(t=new n),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++){var s=this.getUtoTmapping(n/t,null,t);i.push(this.getPoint(s))}return i},getStartPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new n);var i=1e-4,s=t-i,r=t+i;return s<0&&(s=0),r>1&&(r=1),this.getPoint(s,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var i=this.getUtoTmapping(t);return this.getTangent(i,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,i){var n,s=this.getLengths(i),r=0,a=s.length;n=e?Math.min(e,s[a-1]):t*s[a-1];for(var o,h=0,l=a-1;h<=l;)if((o=s[r=Math.floor(h+(l-h)/2)]-n)<0)h=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(s[r=l]===n)return r/(a-1);var u=s[r];return(r+(n-u)/(s[r+1]-u))/(a-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});return GC=s}function yN(){if(VC)return HC;VC=1;var t=Vh(),e=gk(),i=mN(),n=Ru(),s=new t({Extends:i,initialize:function(t,e,s,r){i.call(this,"CubicBezierCurve"),Array.isArray(t)&&(r=new n(t[6],t[7]),s=new n(t[4],t[5]),e=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=e,this.p2=s,this.p3=r},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,i){void 0===i&&(i=new n);var s=this.p0,r=this.p1,a=this.p2,o=this.p3;return i.set(e(t,s.x,r.x,a.x,o.x),e(t,s.y,r.y,a.y,o.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]),o=new n(e[6],e[7]);return new s(i,r,a,o)},HC=s}function xN(){if(qC)return jC;qC=1;var t=Vh(),e=mN(),i=Xu(),n=Ol(),s=Mk(),r=Ru(),a=new t({Extends:e,initialize:function(t,s,a,o,h,l,u,c){if("object"==typeof t){var d=t;t=n(d,"x",0),s=n(d,"y",0),a=n(d,"xRadius",0),o=n(d,"yRadius",a),h=n(d,"startAngle",0),l=n(d,"endAngle",360),u=n(d,"clockwise",!1),c=n(d,"rotation",0)}else void 0===o&&(o=a),void 0===h&&(h=0),void 0===l&&(l=360),void 0===u&&(u=!1),void 0===c&&(c=0);e.call(this,"EllipseCurve"),this.p0=new r(t,s),this._xRadius=a,this._yRadius=o,this._startAngle=i(h),this._endAngle=i(l),this._clockwise=u,this._rotation=i(c)},getStartPoint:function(t){return void 0===t&&(t=new r),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new r);for(var i=2*Math.PI,n=this._endAngle-this._startAngle,s=Math.abs(n)<Number.EPSILON;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(n=s?0:i),this._clockwise&&!s&&(n===i?n=-i:n-=i);var a=this._startAngle+t*n,o=this.p0.x+this._xRadius*Math.cos(a),h=this.p0.y+this._yRadius*Math.sin(a);if(0!==this._rotation){var l=Math.cos(this._rotation),u=Math.sin(this._rotation),c=o-this.p0.x,d=h-this.p0.y;o=c*l-d*u+this.p0.x,h=c*u+d*l+this.p0.y}return e.set(o,h)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return s(this._startAngle)},set:function(t){this._startAngle=i(t)}},endAngle:{get:function(){return s(this._endAngle)},set:function(t){this._endAngle=i(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return s(this._rotation)},set:function(t){this._rotation=i(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:s(this._startAngle),endAngle:s(this._endAngle),clockwise:this._clockwise,rotation:s(this._rotation)}}});return a.fromJSON=function(t){return new a(t)},jC=a}function wN(){if(ZC)return KC;ZC=1;var t=Vh(),e=mN(),i=vN(),n=Fu(),s=Ru(),r=new t({Extends:e,initialize:function(t,i){e.call(this,"LineCurve"),Array.isArray(t)&&(i=new s(t[2],t[3]),t=new s(t[0],t[1])),this.p0=t,this.p1=i,this.arcLengthDivisions=1},getBounds:function(t){return void 0===t&&(t=new n),i([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new s),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new s),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(t,e){return void 0===e&&(e=new s),e.copy(this.p1).subtract(this.p0).normalize(),e},getUtoTmapping:function(t,e,i){var n;if(e){var s=this.getLengths(i),r=s[s.length-1];n=Math.min(e,r)/r}else n=t;return n},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});return r.fromJSON=function(t){var e=t.points,i=new s(e[0],e[1]),n=new s(e[2],e[3]);return new r(i,n)},KC=r}function TN(){if($C)return JC;$C=1;var t=Vh(),e=Ru(),i=new t({initialize:function(t,i){this.active=!1,this.p0=new e(t,i)},getPoint:function(t,i){return void 0===i&&(i=new e),i.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});return JC=i}function bN(){if(tA)return QC;tA=1;var t=Vh(),e=mN(),i=mk(),n=Ru(),s=new t({Extends:e,initialize:function(t,i,s){e.call(this,"QuadraticBezierCurve"),Array.isArray(t)&&(s=new n(t[4],t[5]),i=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=i,this.p2=s},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new n);var s=this.p0,r=this.p1,a=this.p2;return e.set(i(t,s.x,r.x,a.x),i(t,s.y,r.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]);return new s(i,r,a)},QC=s}function SN(){if(iA)return eA;iA=1;var t=fk(),e=Vh(),i=mN(),n=Ru(),s=new e({Extends:i,initialize:function(t){void 0===t&&(t=[]),i.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var i=new n;"number"==typeof t[e]?(i.x=t[e],i.y=t[e+1],e++):Array.isArray(t[e])?(i.x=t[e][0],i.y=t[e][1]):(i.x=t[e].x,i.y=t[e].y),this.points.push(i)}return this},addPoint:function(t,e){var i=new n(t,e);return this.points.push(i),i},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(e,i){void 0===i&&(i=new n);var s=this.points,r=(s.length-1)*e,a=Math.floor(r),o=r-a,h=s[0===a?a:a-1],l=s[a],u=s[a>s.length-2?s.length-1:a+1],c=s[a>s.length-3?s.length-1:a+2];return i.set(t(o,h.x,l.x,u.x,c.x),t(o,h.y,l.y,u.y,c.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});return s.fromJSON=function(t){return new s(t.points)},eA=s}function EN(){if(sA)return nA;sA=1;var t=Vh(),e=yN(),i=xN(),n=Nu(),s=wN(),r=TN(),a=bN(),o=Fu(),h=SN(),l=Ru(),u=Qh(),c=new t({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.defaultDivisions=12,this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new l,this._tmpVec2A=new l,this._tmpVec2B=new l,"object"==typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,i){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,i)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new s(e,t)),this},cubicBezierTo:function(t,i,n,s,r,a){var o,h,u,c=this.getEndPoint();return t instanceof l?(o=t,h=i,u=n):(o=new l(n,s),h=new l(r,a),u=new l(t,i)),this.add(new e(c,o,h,u))},quadraticBezierTo:function(t,e,i,n){var s,r,o=this.getEndPoint();return t instanceof l?(s=t,r=e):(s=new l(i,n),r=new l(t,e)),this.add(new a(o,s,r))},draw:function(t,e){for(var i=0;i<this.curves.length;i++){var n=this.curves[i];n.active&&n.draw(t,e)}return t},ellipseTo:function(t,e,n,s,r,a){var o=new i(0,0,t,e,n,s,r,a),h=this.getEndPoint(this._tmpVec2A),l=o.getStartPoint(this._tmpVec2B);return h.subtract(l),o.x=h.x,o.y=h.y,this.add(o)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var n=0;n<t.curves.length;n++){var r=t.curves[n];switch(r.type){case"LineCurve":this.add(s.fromJSON(r));break;case"EllipseCurve":this.add(i.fromJSON(r));break;case"SplineCurve":this.add(h.fromJSON(r));break;case"CubicBezierCurve":this.add(e.fromJSON(r));break;case"QuadraticBezierCurve":this.add(a.fromJSON(r))}}return this},getBounds:function(t,e){void 0===t&&(t=new o),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var i=new o,n=u.MIN_SAFE_INTEGER,s=u.MIN_SAFE_INTEGER,r=0;r<this.curves.length;r++){var a=this.curves[r];a.active&&(a.getBounds(i,e),t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),n=Math.max(n,i.right),s=Math.max(s,i.bottom))}return t.right=n,t.bottom=s,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0;i<this.curves.length;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getCurveAt:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e)return this.curves[n];n++}return null},getEndPoint:function(t){return void 0===t&&(t=new l),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getPointAt(h,e)}s++}return null},getPoints:function(t,e){t||e||(t=this.defaultDivisions);for(var i,n=[],s=0;s<this.curves.length;s++){var r=this.curves[s];if(r.active)for(var a=r.getResolution(t),o=r.getPoints(a,e),h=0;h<o.length;h++){var l=o[h];i&&i.equals(l)||(n.push(l),i=l)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},getRandomPoint:function(t){return void 0===t&&(t=new l),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new l),t.copy(this.startPoint)},getTangent:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getTangentAt(h,e)}s++}return null},lineTo:function(t,e){t instanceof l?this._tmpVec2B.copy(t):"object"==typeof t?this._tmpVec2B.setFromObject(t):this._tmpVec2B.set(t,e);var i=this.getEndPoint(this._tmpVec2A);return this.add(new s([i.x,i.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new h(t))},moveTo:function(t,e){return t instanceof l?this.add(new r(t.x,t.y)):this.add(new r(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});return n.register("path",function(t,e){return new c(t,e)}),nA=c}function _N(){if(hA)return oA;hA=1;var t=Vh(),e=hc(),i=ku(),n=Bu(),s=new t({Extends:e,initialize:function(t){e.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){e.prototype.destroy.call(this),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("DataManagerPlugin",s,"data"),oA=s}function CN(){if(vA)return gA;vA=1;var t=sh(),e=nh(),i={In:dA?cA:(dA=1,cA={BottomCenter:Fh(),BottomLeft:Dh(),BottomRight:Ih(),Center:Bh(),LeftCenter:Nh(),QuickSet:Gh(),RightCenter:Uh(),TopCenter:zh(),TopLeft:Yh(),TopRight:Xh()}),To:pA?fA:(pA=1,fA={BottomCenter:lh(),BottomLeft:dh(),BottomRight:gh(),LeftBottom:mh(),LeftCenter:wh(),LeftTop:bh(),QuickSet:Mh(),RightBottom:Sh(),RightCenter:Eh(),RightTop:_h(),TopCenter:Ch(),TopLeft:Ah(),TopRight:Ph()})};return i=e(!1,i,t),gA=i}function AN(){if(yA)return mA;yA=1;var t=new(Vh())({initialize:function(t,e,i,n){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),i&&""!==i||(i=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===n&&(n=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=i,this.uniforms=n}});return mA=t}function PN(){if(wA)return xA;wA=1;var t=rh(),e=uh(),i=fh(),n=Th(),s=Fu();return xA=function(r,a){void 0===a&&(a=new s);var o=e(r),h=n(r);return a.x=o,a.y=h,a.width=i(r)-o,a.height=t(r)-h,a}}function MN(){return NA||(NA=1,BA=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}),BA}function RN(){return zA?UA:(zA=1,UA=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t})}function LN(){if($A)return JA;$A=1;var t=PI();return t.ColorSpectrum=function(){if(DA)return FA;DA=1;var t=EI();return FA=function(e){void 0===e&&(e=1024);var i,n=[],s=255,r=255,a=0,o=0;for(i=0;i<=s;i++)n.push({r:r,g:i,b:o,color:t(r,i,o)});for(a=255,i=s;i>=0;i--)n.push({r:i,g:a,b:o,color:t(i,a,o)});for(r=0,i=0;i<=s;i++,a--)n.push({r:r,g:a,b:i,color:t(r,a,i)});for(a=0,o=255,i=0;i<=s;i++,o--,r++)n.push({r:r,g:a,b:o,color:t(r,a,o)});if(1024===e)return n;var h=[],l=0,u=1024/e;for(i=0;i<e;i++)h.push(n[Math.floor(l)]),l+=u;return h}}(),t.ColorToRGBA=(kA||(kA=1,IA=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}),IA),t.ComponentToHex=MN(),t.GetColor=EI(),t.GetColor32=_I(),t.HexStringToColor=MI(),t.HSLToColor=function(){if(XA)return YA;XA=1;var t=PI(),e=RN();return YA=function(i,n,s){var r=s,a=s,o=s;if(0!==n){var h=s<.5?s*(1+n):s+n-s*n,l=2*s-h;r=e(l,h,i+1/3),a=e(l,h,i),o=e(l,h,i-1/3)}return(new t).setGLTo(r,a,o,1)}}(),t.HSVColorWheel=function(){if(WA)return GA;WA=1;var t=CI();return GA=function(e,i){void 0===e&&(e=1),void 0===i&&(i=1);for(var n=[],s=0;s<=359;s++)n.push(t(s/359,e,i));return n}}(),t.HSVToRGB=CI(),t.HueToComponent=RN(),t.IntegerToColor=LI(),t.IntegerToRGB=RI(),t.Interpolate=function(){if(VA)return HA;VA=1;var t=WI(),e=EI(),i=function(i,n,s,r,a,o,h,l){void 0===h&&(h=100),void 0===l&&(l=0);var u=l/h,c=t(i,r,u),d=t(n,a,u),f=t(s,o,u);return{r:c,g:d,b:f,a:255,color:e(c,d,f)}};return HA={RGBWithRGB:i,ColorWithRGB:function(t,e,n,s,r,a){return void 0===r&&(r=100),void 0===a&&(a=0),i(t.r,t.g,t.b,e,n,s,r,a)},ColorWithColor:function(t,e,n,s){return void 0===n&&(n=100),void 0===s&&(s=0),i(t.r,t.g,t.b,e.r,e.g,e.b,n,s)}},HA}(),t.ObjectToColor=OI(),t.RandomRGB=function(){if(qA)return jA;qA=1;var t=vI(),e=PI();return jA=function(i,n){return void 0===i&&(i=0),void 0===n&&(n=255),new e(t(i,n),t(i,n),t(i,n))}}(),t.RGBStringToColor=FI(),t.RGBToHSV=AI(),t.RGBToString=function(){if(ZA)return KA;ZA=1;var t=MN();return KA=function(e,i,n,s,r){return void 0===s&&(s=255),void 0===r&&(r="#"),"#"===r?"#"+((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1,7):"0x"+t(s)+t(e)+t(i)+t(n)}}(),t.ValueToColor=DI(),JA=t}function ON(){if(iP)return eP;iP=1;var t=Vh(),e=Hh(),i=new t({initialize:function(t,i,n){this._rgb=[0,0,0],this.onChangeCallback=e,this.dirty=!1,this.set(t,i,n)},set:function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._rgb=[t,e,i],this.onChange(),this},equals:function(t,e,i){var n=this._rgb;return n[0]===t&&n[1]===e&&n[2]===i},onChange:function(){this.dirty=!0;var t=this._rgb;this.onChangeCallback.call(this,t[0],t[1],t[2])},r:{get:function(){return this._rgb[0]},set:function(t){this._rgb[0]=t,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(t){this._rgb[1]=t,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(t){this._rgb[2]=t,this.onChange()}},destroy:function(){this.onChangeCallback=null}});return eP=i}function FN(){return aP?rP:(aP=1,rP=function(t,e){var i;if(e)"string"==typeof e?i=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(i=e);else if(t.parentElement||null===e)return t;return i||(i=document.body),i.appendChild(t),t})}function DN(){if(hP)return oP;hP=1;var t=Xl();return oP=function(e){if("complete"!==document.readyState&&"interactive"!==document.readyState){var i=function(){document.removeEventListener("deviceready",i,!0),document.removeEventListener("DOMContentLoaded",i,!0),window.removeEventListener("load",i,!0),e()};document.body?t.cordova?document.addEventListener("deviceready",i,!1):(document.addEventListener("DOMContentLoaded",i,!0),window.addEventListener("load",i,!0)):window.setTimeout(i,20)}else e()}}function IN(){return uP?lP:(uP=1,lP=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),i={w:0,h:0},n=document.createElement("div");return n.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(n),i.w=90===e?n.offsetHeight:window.innerWidth,i.h=90===e?window.innerWidth:n.offsetHeight,document.documentElement.removeChild(n),n=null,90!==Math.abs(window.orientation)?i.h:i.w})}function kN(){return dP?cP:(dP=1,cP={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3})}function BN(){return pP?fP:(pP=1,fP={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"})}function NN(){return vP?gP:(vP=1,gP={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6})}function UN(){return yP?mP:(yP=1,mP={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1})}function zN(){if(wP)return xP;wP=1;var t={CENTER:kN(),ORIENTATION:BN(),SCALE_MODE:NN(),ZOOM:UN()};return xP=t}function YN(){if(bP)return TP;bP=1;var t=zN();return TP=function(e,i){var n=window.screen,s=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);return s&&"string"==typeof s.type?s.type:"string"==typeof s?s:"number"==typeof window.orientation?0===window.orientation||180===window.orientation?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?t.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?t.ORIENTATION.LANDSCAPE:void 0:i>e?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE}}function XN(){return EP?SP:(EP=1,SP=function(t){var e;return""!==t&&("string"==typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e})}function GN(){return CP||(CP=1,_P=function(t){var e="";try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}),_P}function WN(){return PP?AP:(PP=1,AP=function(t){t.parentNode&&t.parentNode.removeChild(t)})}function HN(){if(RP)return MP;RP=1;var t={AddToDOM:FN(),DOMContentLoaded:DN(),GetInnerHeight:IN(),GetScreenOrientation:YN(),GetTarget:XN(),ParseXML:GN(),RemoveFromDOM:WN(),RequestAnimationFrame:cN()};return MP=t}function VN(){if(OP)return LP;OP=1;var t=Vh(),e=qF(),i=ku(),n=new t({Extends:e,initialize:function(){e.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});return i.register("EventEmitter",n,"events"),LP=n}function jN(){return NP?BP:(NP=1,BP={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8})}function qN(){return ER?SR:(ER=1,SR={BOOT:zP?UP:(zP=1,UP="boot"),DESTROY:XP?YP:(XP=1,YP="destroy"),DRAG_END:WP?GP:(WP=1,GP="dragend"),DRAG_ENTER:VP?HP:(VP=1,HP="dragenter"),DRAG:qP?jP:(qP=1,jP="drag"),DRAG_LEAVE:ZP?KP:(ZP=1,KP="dragleave"),DRAG_OVER:$P?JP:($P=1,JP="dragover"),DRAG_START:tM?QP:(tM=1,QP="dragstart"),DROP:iM?eM:(iM=1,eM="drop"),GAME_OUT:sM?nM:(sM=1,nM="gameout"),GAME_OVER:aM?rM:(aM=1,rM="gameover"),GAMEOBJECT_DOWN:hM?oM:(hM=1,oM="gameobjectdown"),GAMEOBJECT_DRAG_END:uM?lM:(uM=1,lM="dragend"),GAMEOBJECT_DRAG_ENTER:dM?cM:(dM=1,cM="dragenter"),GAMEOBJECT_DRAG:pM?fM:(pM=1,fM="drag"),GAMEOBJECT_DRAG_LEAVE:vM?gM:(vM=1,gM="dragleave"),GAMEOBJECT_DRAG_OVER:yM?mM:(yM=1,mM="dragover"),GAMEOBJECT_DRAG_START:wM?xM:(wM=1,xM="dragstart"),GAMEOBJECT_DROP:bM?TM:(bM=1,TM="drop"),GAMEOBJECT_MOVE:EM?SM:(EM=1,SM="gameobjectmove"),GAMEOBJECT_OUT:CM?_M:(CM=1,_M="gameobjectout"),GAMEOBJECT_OVER:PM?AM:(PM=1,AM="gameobjectover"),GAMEOBJECT_POINTER_DOWN:RM?MM:(RM=1,MM="pointerdown"),GAMEOBJECT_POINTER_MOVE:OM?LM:(OM=1,LM="pointermove"),GAMEOBJECT_POINTER_OUT:DM?FM:(DM=1,FM="pointerout"),GAMEOBJECT_POINTER_OVER:kM?IM:(kM=1,IM="pointerover"),GAMEOBJECT_POINTER_UP:NM?BM:(NM=1,BM="pointerup"),GAMEOBJECT_POINTER_WHEEL:zM?UM:(zM=1,UM="wheel"),GAMEOBJECT_UP:XM?YM:(XM=1,YM="gameobjectup"),GAMEOBJECT_WHEEL:WM?GM:(WM=1,GM="gameobjectwheel"),MANAGER_BOOT:VM?HM:(VM=1,HM="boot"),MANAGER_PROCESS:qM?jM:(qM=1,jM="process"),MANAGER_UPDATE:ZM?KM:(ZM=1,KM="update"),POINTER_DOWN:$M?JM:($M=1,JM="pointerdown"),POINTER_DOWN_OUTSIDE:tR?QM:(tR=1,QM="pointerdownoutside"),POINTER_MOVE:iR?eR:(iR=1,eR="pointermove"),POINTER_OUT:sR?nR:(sR=1,nR="pointerout"),POINTER_OVER:aR?rR:(aR=1,rR="pointerover"),POINTER_UP:hR?oR:(hR=1,oR="pointerup"),POINTER_UP_OUTSIDE:uR?lR:(uR=1,lR="pointerupoutside"),POINTER_WHEEL:dR?cR:(dR=1,cR="wheel"),POINTERLOCK_CHANGE:pR?fR:(pR=1,fR="pointerlockchange"),PRE_UPDATE:vR?gR:(vR=1,gR="preupdate"),SHUTDOWN:yR?mR:(yR=1,mR="shutdown"),START:wR?xR:(wR=1,xR="start"),UPDATE:bR?TR:(bR=1,TR="update")})}function KN(){return CR?_R:(CR=1,_R={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175})}function ZN(){if(PR)return AR;PR=1;var t=kl(),e=Vh(),i=pI(),n=qN(),s=KN(),r=Hh(),a=new e({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=r,this.onKeyUp=r,t.events.once(n.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(i.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}},this.onKeyUp=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,i=0;i<t.length;i++){var n=t[i];"string"==typeof n&&(n=s[n.trim().toUpperCase()]),-1===e.indexOf(n)&&e.push(n)}this.preventDefault=e.length>0},removeCapture:function(e){"string"==typeof e&&(e=e.split(",")),Array.isArray(e)||(e=[e]);for(var i=this.captures,n=0;n<e.length;n++){var r=e[n];"string"==typeof r&&(r=s[r.toUpperCase()]),t(i,r)}this.preventDefault=i.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(i.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});return AR=a}function JN(){if(RR)return MR;RR=1;var t=Vh(),e=Vl(),i=qN(),n=Hh(),s=new t({initialize:function(t){this.manager=t,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=n,this.onMouseDown=n,this.onMouseUp=n,this.onMouseDownWindow=n,this.onMouseUpWindow=n,this.onMouseOver=n,this.onMouseOut=n,this.onMouseWheel=n,this.pointerLockChange=n,this.isTop=!0,t.events.once(i.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},requestPointerLock:function(){if(e.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){e.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var i=this,n=this.manager,s=n.canvas,r=window&&window.focus&&n.game.config.autoFocus;this.onMouseMove=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseMove(t),i.preventDefaultMove&&t.preventDefault())},this.onMouseDown=function(t){r&&window.focus(),!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseDown(t),i.preventDefaultDown&&t.target===s&&t.preventDefault())},this.onMouseDownWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseDown(t)},this.onMouseUp=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseUp(t),i.preventDefaultUp&&t.target===s&&t.preventDefault())},this.onMouseUpWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseUp(t)},this.onMouseOver=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOver(t)},this.onMouseOut=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOut(t)},this.onMouseWheel=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.onMouseWheel(t),i.preventDefaultWheel&&t.target===s&&t.preventDefault()};var a={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,a),t.addEventListener("mouseout",this.onMouseOut,a),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,a),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,a),window.top.addEventListener("mouseup",this.onMouseUpWindow,a)}catch(t){window.addEventListener("mousedown",this.onMouseDownWindow,a),window.addEventListener("mouseup",this.onMouseUpWindow,a),this.isTop=!1}e.pointerLock&&(this.pointerLockChange=function(t){var e=i.target;i.locked=document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e,n.onPointerLockChange(t)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&((t=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),e.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return MR=s}function $N(){if(OR)return LR;OR=1;var t=KI(),e=Vh(),i=ID(),n=Mu(),s=yk(),r=Ru(),a=Xl(),o=new e({initialize:function(t,e){this.manager=t,this.id=e,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new r,this.prevPosition=new r,this.midPoint=new r(-1,-1),this.velocity=new r,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var e=this.position.x,i=this.position.y,r=this.midPoint.x,a=this.midPoint.y;if(e!==r||i!==a){var o=s(this.motionFactor,r,e),h=s(this.motionFactor,a,i);n(o,e,.1)&&(o=e),n(h,i,.1)&&(h=i),this.midPoint.set(o,h);var l=e-o,u=i-h;this.velocity.set(l,u),this.angle=t(o,h,e,i),this.distance=Math.sqrt(l*l+u*u)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),a.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.buttons?0===this.button&&!this.isDown:0===this.button},rightButtonReleased:function(){return 0===this.buttons?2===this.button&&!this.isDown:2===this.button},middleButtonReleased:function(){return 0===this.buttons?1===this.button&&!this.isDown:1===this.button},backButtonReleased:function(){return 0===this.buttons?3===this.button&&!this.isDown:3===this.button},forwardButtonReleased:function(){return 0===this.buttons?4===this.button&&!this.isDown:4===this.button},getDistance:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?t(this.downX,this.downY,this.x,this.y):t(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var i=this.prevPosition.x,n=this.prevPosition.y,r=this.position.x,a=this.position.y,o=0;o<t;o++){var h=1/t*o;e[o]={x:s(h,i,r),y:s(h,n,a)}}return e},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=0===this.id},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});return LR=o}function QN(){if(DR)return FR;DR=1;var t=Vh(),e=qN(),i=Hh(),n=new t({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=i,this.onTouchStartWindow=i,this.onTouchMove=i,this.onTouchEnd=i,this.onTouchEndWindow=i,this.onTouchCancel=i,this.onTouchCancelWindow=i,this.isTop=!0,t.events.once(e.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},startListeners:function(){var t=this.target;if(t){var e=this,i=this.manager,n=i.canvas,s=window&&window.focus&&i.game.config.autoFocus;this.onTouchMove=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchMove(t),e.capture&&t.cancelable&&t.preventDefault())},this.onTouchStart=function(t){s&&window.focus(),!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchStart(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchStartWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchStart(t)},this.onTouchEnd=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchEnd(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchEndWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchEnd(t)},this.onTouchCancel=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchCancel(t),e.capture&&t.preventDefault())},this.onTouchCancelWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&i.onTouchCancel(t)};var r=this.capture,a={passive:!0},o={passive:!1};if(t.addEventListener("touchstart",this.onTouchStart,r?o:a),t.addEventListener("touchmove",this.onTouchMove,r?o:a),t.addEventListener("touchend",this.onTouchEnd,r?o:a),t.addEventListener("touchcancel",this.onTouchCancel,r?o:a),window&&i.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,o),window.top.addEventListener("touchend",this.onTouchEndWindow,o),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,o)}catch(t){window.addEventListener("touchstart",this.onTouchStartWindow,o),window.addEventListener("touchend",this.onTouchEndWindow,o),window.addEventListener("touchcancel",this.onTouchCancelWindow,o),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),window&&((t=this.isTop?window.top:window).removeEventListener("touchstart",this.onTouchStartWindow),t.removeEventListener("touchend",this.onTouchEndWindow),t.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return FR=n}function tU(){if(kR)return IR;kR=1;var t=Vh(),e=jN(),i=qF(),n=qN(),s=pI(),r=ZN(),a=JN(),o=$N(),h=QN(),l=tc(),u=ec(),c=new t({initialize:function(t,e){this.game=t,this.scaleManager,this.canvas,this.config=e,this.enabled=!0,this.events=new i,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new r(this):null,this.mouse=e.inputMouse?new a(this):null,this.touch=e.inputTouch?new h(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers;for(var n=0;n<=this.pointersTotal;n++){var u=new o(this,n);u.smoothFactor=e.inputSmoothFactor,this.pointers.push(u)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new l,this._tempMatrix2=new l,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(s.BOOT,this.boot,this)},boot:function(){var t=this.game,e=t.events;this.canvas=t.canvas,this.scaleManager=t.scale,this.events.emit(n.MANAGER_BOOT),e.on(s.PRE_RENDER,this.preRender,this),e.once(s.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(n.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(n.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,i=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(n.MANAGER_UPDATE);for(var s=0;s<i.length;s++){var r=i[s];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t,e){(e||t&&t.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var i=0;i<t;i++){var n=this.pointers.length,s=new o(this,n);s.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(s),this.pointersTotal++,e.push(s)}return e},updateInputPlugins:function(t,e){var i=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var n=0;n<i.length;n++){var s=i[n];if(s.sys.input&&(s.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip))return}},onTouchStart:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(!o.active){o.touchstart(r,t),this.activePointer=o,n.push(o);break}}this.updateInputPlugins(e.TOUCH_START,n)},onTouchMove:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){var h=document.elementFromPoint(r.clientX,r.clientY)===this.canvas;!this.isOver&&h?this.setCanvasOver(t):this.isOver&&!h&&this.setCanvasOut(t),this.isOver&&(o.touchmove(r,t),this.activePointer=o,n.push(o));break}}this.updateInputPlugins(e.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchend(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_END,n)},onTouchCancel:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchcancel(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_CANCEL,n)},onMouseDown:function(t){var i=this.mousePointer;i.down(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var i=this.mousePointer;i.move(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var i=this.mousePointer;i.up(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var i=this.mousePointer;i.wheel(t),this.activePointer=i,this.updateInputPlugins(e.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(n.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var i=t.input;if(!i||!i.enabled||!t.willRender(e))return!1;var n=!0,s=t.parentContainer;if(s)do{if(!s.willRender(e)){n=!1;break}s=s.parentContainer}while(s);return n},hitTest:function(t,e,i,n){void 0===n&&(n=this._tempHitTest);var s=this._tempPoint,r=i.scrollX,a=i.scrollY;n.length=0;var o=t.x,h=t.y;i.getWorldPoint(o,h,s),t.worldX=s.x,t.worldY=s.y;for(var l={x:0,y:0},c=this._tempMatrix,d=this._tempMatrix2,f=0;f<e.length;f++){var p=e[f];if(this.inputCandidate(p,i)){var g=s.x+r*p.scrollFactorX-r,v=s.y+a*p.scrollFactorY-a;p.parentContainer?(p.getWorldTransformMatrix(c,d),c.applyInverse(g,v,l)):u(g,v,p.x,p.y,p.rotation,p.scaleX,p.scaleY,l),this.pointWithinHitArea(p,l.x,l.y)&&n.push(p)}}return n},pointWithinHitArea:function(t,e,i){e+=t.displayOriginX,i+=t.displayOriginY;var n=t.input;return!(!n||!n.hitAreaCallback(n.hitArea,e,i,t)||(n.localX=e,n.localY=i,0))},pointWithinInteractiveObject:function(t,e,i){return!!t.hitArea&&(e+=t.gameObject.displayOriginX,i+=t.gameObject.displayOriginY,t.localX=e,t.localY=i,t.hitAreaCallback(t.hitArea,e,i,t))},transformPointer:function(t,e,i,n){var s=t.position,r=t.prevPosition;r.x=s.x,r.y=s.y;var a=this.scaleManager.transformX(e),o=this.scaleManager.transformY(i),h=t.smoothFactor;n&&0!==h?(s.x=a*h+r.x*(1-h),s.y=o*h+r.y*(1-h)):(s.x=a,s.y=o)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(s.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});return IR=c}function eU(){if(NR)return BR;NR=1;var t={},e={install:function(e){for(var i in t)e[i]=t[i]},register:function(e,i){t[e]=i},destroy:function(){t={}}};return BR=e}function iU(){if(zR)return UR;zR=1;var t=Vh(),e=ku(),i=Bu(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectCreator",n,"make"),UR=n}function nU(){if(XR)return YR;XR=1;var t=Vh(),e=pI(),i=qF(),n=eU(),s=iU(),r=Nu(),a=Wh(),o=ku(),h=kl(),l=eh(),u=new t({Extends:i,initialize:function(t){i.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted||t.config.renderType===l.HEADLESS?this.boot():t.events.once(e.BOOT,this.boot,this)},boot:function(){var t,i,n,s,r,o,h,l=this.game.config,u=l.installGlobalPlugins;for(u=u.concat(this._pendingGlobal),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),r=a(i,"start",!1),o=a(i,"mapping",null),h=a(i,"data",null),n&&(s?this.install(n,s,r,o,h):console.warn("Missing `plugin` for key: "+n));for(u=(u=l.installScenePlugins).concat(this._pendingScene),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),o=a(i,"mapping",null),n&&(s?this.installScenePlugin(n,s,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(e.DESTROY,this.destroy,this)},addToScene:function(t,e,i){var n,s,r,a=this.game,h=t.scene,l=t.settings.map,u=t.settings.isBooted;for(n=0;n<e.length;n++)a[s=e[n]]?(t[s]=a[s],l.hasOwnProperty(s)&&(h[l[s]]=t[s])):"game"===s&&l.hasOwnProperty(s)&&(h[l[s]]=a);for(var c=0;c<i.length;c++)for(r=i[c],n=0;n<r.length;n++)if(s=r[n],o.hasCore(s)){var d=o.getCore(s),f=d.mapping,p=new d.plugin(h,this,f);t[f]=p,d.custom?h[f]=p:l.hasOwnProperty(f)&&(h[l[f]]=p),u&&p.boot()}for(r=this.plugins,n=0;n<r.length;n++){var g=r[n];g.mapping&&(h[g.mapping]=g.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t.concat(this.scenePlugins)},installScenePlugin:function(t,e,i,n,s){if(void 0===s&&(s=!1),"function"==typeof e){if(o.hasCore(t)||o.register(t,e,i,!0),-1===this.scenePlugins.indexOf(t))this.scenePlugins.push(t);else if(!s&&o.hasCore(t))return void console.warn("Scene Plugin key in use: "+t);if(n){var r=new e(n,this,t);n.sys[t]=r,i&&""!==i&&(n[i]=r),r.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,i,n,s){if(void 0===i&&(i=!1),void 0===n&&(n=null),void 0===s&&(s=null),"function"!=typeof e)return console.warn("Invalid Plugin: "+t),null;if(o.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==n&&(i=!0),this.game.isBooted){if(o.registerCustom(t,e,n,s),i)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:i,mapping:n,data:s});return null},getIndex:function(t){for(var e=this.plugins,i=0;i<e.length;i++)if(e[i].key===t)return i;return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var i=this.getEntry(e);return i&&!i.active?(i.active=!0,i.plugin.start()):i||(i=this.createEntry(t,e)),i?i.plugin:null},createEntry:function(t,e){var i=o.getCustom(t);if(i){var n=new i.plugin(this);i={key:e,plugin:n,active:!0,mapping:i.mapping,data:i.data},this.plugins.push(i),n.init(i.data),n.start()}return i},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var i=this.getEntry(t);if(i)return i.plugin;var n=this.getClass(t);return n&&e?(i=this.createEntry(t,t))?i.plugin:null:n||null},getClass:function(t){return o.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&h(this.plugins,e),o.removeCustom(t)},removeScenePlugin:function(t){h(this.scenePlugins,t),o.remove(t)},registerGameObject:function(t,e,i){return e&&r.register(t,e),i&&s.register(t,i),this},removeGameObject:function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),e&&r.remove(t),i&&s.remove(t),this},registerFileType:function(t,e,i){n.register(t,e),i&&i.sys.load&&(i.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();o.destroyCustomPlugins(),this.game.noReturn&&o.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});return YR=u}function sU(){if(WR)return GR;WR=1;var t=Jh(),e=Vh(),i=Sk(),n=Ru(),s=new e({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===s&&(s=null),this._width=t,this._height=e,this._parent=s,this.aspectMode=i,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new n},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(e,i){return void 0===e&&(e=0),void 0===i&&(i=e),this.minWidth=t(e,0,this.maxWidth),this.minHeight=t(i,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(e,i){return void 0===e&&(e=Number.MAX_VALUE),void 0===i&&(i=e),this.maxWidth=t(e,this.minWidth,Number.MAX_VALUE),this.maxHeight=t(i,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case s.NONE:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case s.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case s.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(i(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case s.FIT:this.constrain(t,e,!0);break;case s.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minWidth,this.maxWidth),i&&this._parent&&e>this._parent.width&&(e=Math.max(this.minWidth,this._parent.width)),e},getNewHeight:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minHeight,this.maxHeight),i&&this._parent&&e>this._parent.height&&(e=Math.max(this.minHeight,this._parent.height)),e},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var s=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=i(t,s.x))/this.aspectRatio,s.y>0&&(t=(e=i(e,s.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=i(e,s.y))*this.aspectRatio,s.x>0&&(e=(t=i(t,s.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});return s.NONE=0,s.WIDTH_CONTROLS_HEIGHT=1,s.HEIGHT_CONTROLS_WIDTH=2,s.FIT=3,s.ENVELOP=4,GR=s}function rU(){if(VR)return HR;VR=1;var t=zN(),e=Vh(),i=Jh(),n=qF(),s=VI(),r=pI(),a=IN(),o=XN(),h=YN(),l=Hh(),u=Fu(),c=sU(),d=Sk(),f=Ru(),p=HI(),g=new e({Extends:n,initialize:function(e){n.call(this),this.game=e,this.canvas,this.canvasBounds=new u,this.parent=null,this.parentIsWindow=!1,this.parentSize=new c,this.gameSize=new c,this.baseSize=new c,this.displaySize=new c,this.scaleMode=t.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new f(1,1),this.autoRound=!1,this.autoCenter=t.CENTER.NO_CENTER,this.orientation=t.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:l,windowResize:l,fullScreenChange:l,fullScreenError:l}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(r.BOOT,this.boot,this)},boot:function(){var e=this.game;this.canvas=e.canvas,this.fullscreen=e.device.fullscreen;var i=this.scaleMode;i!==t.SCALE_MODE.RESIZE&&i!==t.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(i),i===t.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),e.events.on(r.PRE_STEP,this.step,this),e.events.once(r.READY,this.refresh,this),e.events.once(r.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(e){this.getParent(e),this.getParentBounds();var i=e.width,n=e.height,s=e.scaleMode,r=e.zoom,a=e.autoRound;if("string"==typeof i)if("%"!==i.substr(-1))i=parseInt(i,10);else{var o=this.parentSize.width;0===o&&(o=window.innerWidth);var l=parseInt(i,10)/100;i=Math.floor(o*l)}if("string"==typeof n)if("%"!==n.substr(-1))n=parseInt(n,10);else{var u=this.parentSize.height;0===u&&(u=window.innerHeight);var c=parseInt(n,10)/100;n=Math.floor(u*c)}this.scaleMode=s,this.autoRound=a,this.autoCenter=e.autoCenter,this.resizeInterval=e.resizeInterval,a&&(i=Math.floor(i),n=Math.floor(n)),this.gameSize.setSize(i,n),r===t.ZOOM.MAX_ZOOM&&(r=this.getMaxZoom()),this.zoom=r,1!==r&&(this._resetZoom=!0),this.baseSize.setSize(i,n),a&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),e.minWidth>0&&this.displaySize.setMin(e.minWidth*r,e.minHeight*r),e.maxWidth>0&&this.displaySize.setMax(e.maxWidth*r,e.maxHeight*r),this.displaySize.setSize(i,n),(e.snapWidth>0||e.snapHeight>0)&&this.displaySize.setSnap(e.snapWidth,e.snapHeight),this.orientation=h(i,n)},getParent:function(e){var i=e.parent;if(null!==i){if(this.parent=o(i),this.parentIsWindow=this.parent===document.body,e.expandParent&&e.scaleMode!==t.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}e.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=o(e.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=a(!0));var i=e.width,n=e.height;if(t.width!==i||t.height!==n)return t.setSize(i,n),!0;if(this.canvas){var s=this.canvasBounds,r=this.canvas.getBoundingClientRect();if(r.x!==s.x||r.y!==s.y)return!0}return!1},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e.call(screen,t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var n=this.width,s=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(n,s)},resize:function(t,e){var i=this.zoom,n=this.autoRound;n&&(t=Math.floor(t),e=Math.floor(e));var s=this.width,r=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*i,e*i),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var a=this.canvas.style,o=t*i,h=e*i;return n&&(o=Math.floor(o),h=Math.floor(h)),o===t&&h===e||(a.width=o+"px",a.height=h+"px"),this.refresh(s,r)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displaySize.setSnap(t,e),this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var i=this.game.domContainer;if(i){this.baseSize.setCSS(i);var n=this.canvas.style,r=i.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=n.marginLeft,r.marginTop=n.marginTop}return this.emit(s.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=h(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(s.ORIENTATION_CHANGE,t))}},updateScale:function(){var e,n,s=this.canvas.style,r=this.gameSize.width,a=this.gameSize.height,o=this.zoom,h=this.autoRound;if(this.scaleMode===t.SCALE_MODE.NONE)this.displaySize.setSize(r*o,a*o),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this._resetZoom&&(s.width=e+"px",s.height=n+"px",this._resetZoom=!1);else if(this.scaleMode===t.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this.canvas.width=e,this.canvas.height=n;else if(this.scaleMode===t.SCALE_MODE.EXPAND){var l,u,c=this.game.config.width,d=this.game.config.height,f=this.parentSize.width,p=this.parentSize.height,g=f/c,v=p/d;g<v?(l=c,u=0!==g?p/g:d):(l=0!==v?f/v:c,u=d);var m=i(l,this.displaySize.minWidth,this.displaySize.maxWidth),y=i(u,this.displaySize.minHeight,this.displaySize.maxHeight);this.baseSize.setSize(m,y),this.gameSize.setSize(m,y),h&&(m=Math.floor(m),y=Math.floor(y)),this.canvas.width=m,this.canvas.height=y;var x=f*(m/l),w=p*(y/u);this.displaySize.setSize(x,w),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px"}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=d(this.parentSize.width,this.gameSize.width,0,!0),e=d(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var e=this.autoCenter;if(e!==t.CENTER.NO_CENTER){var i=this.canvas,n=i.style,s=i.getBoundingClientRect(),r=s.width,a=s.height,o=Math.floor((this.parentSize.width-r)/2),h=Math.floor((this.parentSize.height-a)/2);e===t.CENTER.CENTER_HORIZONTALLY?h=0:e===t.CENTER.CENTER_VERTICALLY&&(o=0),n.marginLeft=o+"px",n.marginTop=h+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var i=this.getFullscreenTarget();e.keyboard?i[e.request](Element.ALLOW_KEYBOARD_INPUT):i[e.request](t)}}else this.emit(s.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(s.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(s.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}return this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(s.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(s.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.domlisteners;e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0,t.refresh()},e.windowResize=function(){t.updateBounds(),t.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",e.orientationChange,!1):window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available&&(e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)},["webkit","moz",""].forEach(function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1))},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(t,e){t instanceof p||(e=t,t=void 0),void 0===e&&(e=new u);var i,n,s=this.baseSize,r=this.parentSize,a=this.canvasBounds,o=this.displayScale,h=a.x>=0?0:-a.x*o.x,l=a.y>=0?0:-a.y*o.y;return i=r.width>=a.width?s.width:s.width-(a.width-r.width)*o.x,n=r.height>=a.height?s.height:s.height-(a.height-r.height)*o.y,e.setTo(h,l,i,n),t&&(e.width/=t.zoomX,e.height/=t.zoomY,e.centerX=t.centerX+t.scrollX,e.centerY=t.centerY+t.scrollY),e},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",t.orientationChange,!1):window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1),["webkit","moz",""].forEach(function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===t.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===t.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});return HR=g}function aU(){return qR?jR:(qR=1,jR={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9})}function oU(){return vL?gL:(vL=1,gL={ADD:ZR?KR:(ZR=1,KR="addfile"),COMPLETE:$R?JR:($R=1,JR="complete"),FILE_COMPLETE:tL?QR:(tL=1,QR="filecomplete"),FILE_KEY_COMPLETE:iL?eL:(iL=1,eL="filecomplete-"),FILE_LOAD_ERROR:sL?nL:(sL=1,nL="loaderror"),FILE_LOAD:aL?rL:(aL=1,rL="load"),FILE_PROGRESS:hL?oL:(hL=1,oL="fileprogress"),POST_PROCESS:uL?lL:(uL=1,lL="postprocess"),PROGRESS:dL?cL:(dL=1,cL="progress"),START:pL?fL:(pL=1,fL="start")})}function hU(){if(yL)return mL;yL=1;var t=Wh(),e=mD();return mL=function(i){var n=i.game.config.defaultPhysicsSystem,s=t(i.settings,"physics",!1);if(n||s){var r=[];if(n&&r.push(e(n+"Physics")),s)for(var a in s)a=e(a.concat("Physics")),-1===r.indexOf(a)&&r.push(a);return r}}}function lU(){if(wL)return xL;wL=1;var t=Wh();return xL=function(e){var i=e.plugins.getDefaultScenePlugins(),n=t(e.settings,"plugins",!1);return Array.isArray(n)?n:i||[]}}function uU(){return bL?TL:(bL=1,TL=function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i]=t[i].slice(0):e[i]=t[i];return e})}function cU(){if(EL)return SL;EL=1;var t=uU();return SL=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)||(n[s]=i[s]);return n}}function dU(){if(PL)return AL;PL=1;var t=aU(),e=Ol(),i=cU(),n=function(){if(CL)return _L;CL=1;return _L={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter",cameras3d:"cameras3d",facebook:"facebook"}}();return AL={create:function(s){return"string"==typeof s?s={key:s}:void 0===s&&(s={}),{status:t.PENDING,key:e(s,"key",""),active:e(s,"active",!1),visible:e(s,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:e(s,"pack",!1),cameras:e(s,"cameras",null),map:e(s,"map",i(n,e(s,"mapAdd",{}))),physics:e(s,"physics",{}),loader:e(s,"loader",{}),plugins:e(s,"plugins",!1),input:e(s,"input",{})}}}}function fU(){if(RL)return ML;RL=1;var t=Vh(),e=aU(),i=qI(),n=Bu(),s=hU(),r=lU(),a=Hh(),o=dU(),h=new t({initialize:function(t,e){this.scene=t,this.game,this.renderer,this.facebook,this.config=e,this.settings=o.create(e),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=a},init:function(t){this.settings.status=e.INIT,this.sceneUpdate=a,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var o=t.plugins;this.plugins=o,o.addToScene(this,i.Global,[i.CoreScene,r(this),s(this)]),this.events.emit(n.BOOT,this),this.settings.isBooted=!0},step:function(t,e){var i=this.events;i.emit(n.PRE_UPDATE,t,e),i.emit(n.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),i.emit(n.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(n.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(n.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot pause non-running Scene",i.key):this.settings.active&&(i.status=e.PAUSED,i.active=!1,this.events.emit(n.PAUSE,this,t)),this},resume:function(t){var i=this.events,s=this.settings;return this.settings.active||(s.status=e.RUNNING,s.active=!0,i.emit(n.RESUME,this,t)),this},sleep:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot sleep non-running Scene",i.key):(i.status=e.SLEEPING,i.active=!1,i.visible=!1,this.events.emit(n.SLEEP,this,t)),this},wake:function(t){var i=this.events,s=this.settings;return s.status=e.RUNNING,s.active=!0,s.visible=!0,i.emit(n.WAKE,this,t),s.isTransition&&i.emit(n.TRANSITION_WAKE,s.transitionFrom,s.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var t=this.settings.status;return t>e.PENDING&&t<=e.RUNNING},isSleeping:function(){return this.settings.status===e.SLEEPING},isActive:function(){return this.settings.status===e.RUNNING},isPaused:function(){return this.settings.status===e.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var i=this.events,s=this.settings;t&&(s.data=t),s.status=e.START,s.active=!0,s.visible=!0,i.emit(n.START,this),i.emit(n.READY,this,t)},shutdown:function(t){var i=this.events,s=this.settings;i.off(n.TRANSITION_INIT),i.off(n.TRANSITION_START),i.off(n.TRANSITION_COMPLETE),i.off(n.TRANSITION_OUT),s.status=e.SHUTDOWN,s.active=!1,s.visible=!1,i.emit(n.SHUTDOWN,this,t)},destroy:function(){var t=this.events,i=this.settings;i.status=e.DESTROYED,i.active=!1,i.visible=!1,t.emit(n.DESTROY,this),t.removeAllListeners();for(var s=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],r=0;r<s.length;r++)this[s[r]]=null}});return ML=h}function pU(){if(OL)return LL;OL=1;var t=Vh(),e=fU(),i=new t({initialize:function(t){this.sys=new e(this,t),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.facebook,this.scale,this.plugins,this.renderer},update:function(){}});return LL=i}function gU(){if(DL)return FL;DL=1;var t=Vh(),e=aU(),i=Bu(),n=pI(),s=Ol(),r=oU(),a=Hh(),o=pU(),h=fU(),l=new t({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)this._pending.push({key:"default",scene:e[i],autoStart:0===i,data:{}})}t.events.once(n.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,i,s;for(this.systemScene=this.createSceneFromInstance("__SYSTEM",new o),this.game.events.emit(n.SYSTEM_READY,this.systemScene,this),t=0;t<this._pending.length;t++){var r;i=(e=this._pending[t]).key,(s=e.scene)instanceof o?r=this.createSceneFromInstance(i,s):"object"==typeof s?r=this.createSceneFromObject(i,s):"function"==typeof s&&(r=this.createSceneFromFunction(i,s)),i=r.sys.settings.key,this.keys[i]=r,this.scenes.push(r),this._data[i]&&(r.sys.settings.data=this._data[i].data,this._data[i].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(i)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(0!==t||0!==e){var i,n;if(t){for(i=0;i<t;i++)n=this._pending[i],this.add(n.key,n.scene,n.autoStart,n.data);for(i=0;i<this._start.length;i++)n=this._start[i],this.start(n);this._start.length=0,this._pending.length=0}for(i=0;i<this._queue.length;i++)this[(n=this._queue[i]).op](n.keyA,n.keyB,n.data);this._queue.length=0}},add:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:i,data:n}),this.isBooted||(this._data[t]={data:n}),null):(t=this.getKey(t,e),e instanceof o?s=this.createSceneFromInstance(t,e):"object"==typeof e?(e.key=t,s=this.createSceneFromObject(t,e)):"function"==typeof e&&(s=this.createSceneFromFunction(t,e)),s.sys.settings.data=n,t=s.sys.settings.key,this.keys[t]=s,this.scenes.push(s),(i||s.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),s);var s},remove:function(t){if(this.isProcessing)return this.queueOp("remove",t);var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var i=this.scenes.indexOf(e),n=e.sys.settings.key;return i>-1&&(delete this.keys[n],this.scenes.splice(i,1),this._start.indexOf(n)>-1&&(i=this._start.indexOf(n),this._start.splice(i,1)),e.sys.destroy()),this},bootScene:function(t){var n,s=t.sys,o=s.settings;s.sceneUpdate=a,t.init&&(t.init.call(t,o.data),o.status=e.INIT,o.isTransition&&s.events.emit(i.TRANSITION_INIT,o.transitionFrom,o.transitionDuration)),s.load&&(n=s.load).reset(),n&&t.preload?(t.preload.call(t),o.status=e.LOADING,n.once(r.COMPLETE,this.loadComplete,this),n.start()):this.create(t)},loadComplete:function(t){this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,i){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var s=this.scenes[n].sys;s.settings.status>e.START&&s.settings.status<=e.RUNNING&&s.step(t,i),s.scenePlugin&&s.scenePlugin._target&&s.scenePlugin.step(t,i)}},render:function(t){for(var i=0;i<this.scenes.length;i++){var n=this.scenes[i].sys;n.settings.visible&&n.settings.status>=e.LOADING&&n.settings.status<e.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var n=t.sys,s=n.settings;t.create&&(s.status=e.CREATING,t.create.call(t,s.data),s.status===e.DESTROYED)||(s.isTransition&&n.events.emit(i.TRANSITION_START,s.transitionFrom,s.transitionDuration),t.update&&(n.sceneUpdate=t.update),s.status=e.RUNNING,n.events.emit(i.CREATE,t))},createSceneFromFunction:function(t,e){var i=new e;if(i instanceof o){var n=i.sys.settings.key;if(""!==n&&(t=n),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return this.createSceneFromInstance(t,i)}return i.sys=new h(i),i.sys.settings.key=t,i.sys.init(this.game),i},createSceneFromInstance:function(t,e){return""===e.sys.settings.key&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var i=new o(e),n=i.sys.settings.key;""!==n?t=n:i.sys.settings.key=t,i.sys.init(this.game);for(var r=["init","preload","create","update","render"],a=0;a<r.length;a++){var h=s(e,r[a],null);h&&(i[r[a]]=h)}if(e.hasOwnProperty("extend"))for(var l in e.extend)if(e.extend.hasOwnProperty(l)){var u=e.extend[l];"data"===l&&i.hasOwnProperty("data")&&"object"==typeof u?i.data.merge(u):"sys"!==l&&(i[l]=u)}return i},getKey:function(t,e){if(t||(t="default"),"function"==typeof e)return t;if(e instanceof o?t=e.sys.settings.key:"object"==typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var i=[],n=this.scenes,s=0;s<n.length;s++){var r=n[s];r&&(!t||t&&r.sys.isActive())&&i.push(r)}return e?i.reverse():i},getScene:function(t){if("string"==typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var i=this.getScene(t);return i&&i.sys.pause(e),this},resume:function(t,e){var i=this.getScene(t);return i&&i.sys.resume(e),this},sleep:function(t,e){var i=this.getScene(t);return i&&!i.sys.isTransitioning()&&i.sys.sleep(e),this},wake:function(t,e){var i=this.getScene(t);return i&&i.sys.wake(e),this},run:function(t,e){var i=this.getScene(t);if(!i){for(var n=0;n<this._pending.length;n++)if(this._pending[n].key===t){this.queueOp("start",t,e);break}return this}i.sys.isSleeping()?i.sys.wake(e):i.sys.isPaused()?i.sys.resume(e):this.start(t,e)},start:function(t,i){if(!this.isBooted)return this._data[t]={autoStart:!0,data:i},this;var n=this.getScene(t);if(!n)return console.warn("Scene key not found: "+t),this;var s,o=n.sys,h=o.settings.status;if(h>=e.START&&h<=e.CREATING)return this;if(h>=e.RUNNING&&h<=e.SLEEPING)o.shutdown(),o.sceneUpdate=a,o.start(i);else if(o.sceneUpdate=a,o.start(i),o.load&&(s=o.load),s&&o.settings.hasOwnProperty("pack")&&(s.reset(),s.addPack({payload:o.settings.pack})))return o.settings.status=e.LOADING,s.once(r.COMPLETE,this.payloadComplete,this),s.start(),this;return this.bootScene(n),this},stop:function(t,i){var n=this.getScene(t);if(n&&!n.sys.isTransitioning()&&n.sys.settings.status!==e.SHUTDOWN){var s=n.sys.load;s&&(s.off(r.COMPLETE,this.loadComplete,this),s.off(r.COMPLETE,this.payloadComplete,this)),n.sys.shutdown(i)}return this},switch:function(t,e,i){var n=this.getScene(t),s=this.getScene(e);return n&&s&&n!==s&&(this.sleep(t),this.isSleeping(e)?this.wake(e,i):this.start(e,i)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)return this.queueOp("bringToTop",t);var e=this.getIndex(t),i=this.scenes;if(-1!==e&&e<i.length){var n=this.getScene(t);i.splice(e,1),i.push(n)}return this},sendToBack:function(t){if(this.isProcessing)return this.queueOp("sendToBack",t);var e=this.getIndex(t);if(-1!==e&&e>0){var i=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(i)}return this},moveDown:function(t){if(this.isProcessing)return this.queueOp("moveDown",t);var e=this.getIndex(t);if(e>0){var i=e-1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveUp:function(t){if(this.isProcessing)return this.queueOp("moveUp",t);var e=this.getIndex(t);if(e<this.scenes.length-1){var i=e+1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveAbove",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n<i){var s=this.getAt(n);this.scenes.splice(n,1),this.scenes.splice(i+(n>i),0,s)}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveBelow",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n>i){var s=this.getAt(n);this.scenes.splice(n,1),0===i?this.scenes.unshift(s):this.scenes.splice(i-(n<i),0,s)}return this},queueOp:function(t,e,i,n){return this._queue.push({op:t,keyA:e,keyB:i,data:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("swapPosition",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(i!==n&&-1!==i&&-1!==n){var s=this.getAt(i);this.scenes[i]=this.scenes[n],this.scenes[n]=s}return this},dump:function(){for(var t=[],i=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var s=this.scenes[n].sys,r=!s.settings.visible||s.settings.status!==e.RUNNING&&s.settings.status!==e.PAUSED?"[-] ":"[*] ";r+=s.settings.key+" ("+i[s.settings.status]+")",t.push(r)}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++)this.scenes[t].sys.destroy();this.systemScene.sys.destroy(),this.update=a,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});return FL=l}function vU(){if(kL)return IL;kL=1;var t=Hl(),e=Vh(),i=Tk(),n=th(),s=sN(),r=new e({initialize:function(t,e,r,a,o){void 0===o&&(o=!1);var h=t.manager.game;this.renderer=h.renderer,this.texture=t,this.source=e,this.image=e.compressed?null:e,this.compressionAlgorithm=e.compressed?e.format:null,this.resolution=1,this.width=r||e.naturalWidth||e.videoWidth||e.width||0,this.height=a||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=n.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type||"DynamicTexture"===e.type,this.isGLTexture=e instanceof s,this.isPowerOf2=i(this.width,this.height),this.glTexture=null,this.flipY=o,this.init(h)},init:function(t){var e=this.renderer;if(e){var i=this.source;if(e.gl){var n=this.image,s=this.flipY,r=this.width,a=this.height,o=this.scaleMode;this.isCanvas?this.glTexture=e.createCanvasTexture(n,!1,s):this.isVideo?this.glTexture=e.createVideoTexture(n,!1,s):this.isRenderTexture?this.glTexture=e.createTextureFromSource(null,r,a,o):this.isGLTexture?this.glTexture=i:this.compressionAlgorithm?this.glTexture=e.createTextureFromSource(i,void 0,void 0,o):i instanceof Uint8Array?this.glTexture=e.createUint8ArrayTexture(i,r,a,o):this.glTexture=e.createTextureFromSource(n,r,a,o),this.glTexture.spectorMetadata={textureKey:this.texture.key}}else this.isRenderTexture&&(this.image=i.canvas)}t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),t===this.flipY||(this.flipY=t,this.update()),this},update:function(){var t=this.renderer,e=this.image,i=this.flipY,n=t.gl;n&&this.isCanvas?t.updateCanvasTexture(e,this.glTexture,i):n&&this.isVideo&&t.updateVideoTexture(e,this.glTexture,i)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&t.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});return IL=r}function mU(){if(NL)return BL;NL=1;var t=Vh(),e=Zu(),i=vU(),n='Texture "%s" has no frame "%s"',s=new t({initialize:function(t,e,n,s,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var a=0;a<n.length;a++)this.source.push(new i(this,n[a],s,r))},add:function(t,i,n,s,r,a){if(this.has(t))return null;var o=new e(this,t,i,n,s,r,a);return this.frames[t]=o,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,o},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames.hasOwnProperty(t)},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(n,this.key,t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var i=[];for(var n in this.frames)if("__BASE"!==n||e){var s=this.frames[n];s.sourceIndex===t&&i.push(s)}return i},getFrameBounds:function(t){void 0===t&&(t=0);for(var e=this.getFramesFromTextureSource(t,!0),i=e[0],n=i.cutX,s=i.cutY,r=i.cutX+i.cutWidth,a=i.cutY+i.cutHeight,o=1;o<e.length;o++){var h=e[o];h.cutX<n&&(n=h.cutX),h.cutY<s&&(s=h.cutY),h.cutX+h.cutWidth>r&&(r=h.cutX+h.cutWidth),h.cutY+h.cutHeight>a&&(a=h.cutY+h.cutHeight)}return{x:n,y:s,width:r-n,height:a-s}},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var i=e.indexOf("__BASE");-1!==i&&e.splice(i,1)}return e},getSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(n,this.key,t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e,i=this.frames[t];return i?e=i.sourceIndex:(console.warn(n,this.key,t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new i(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t,e=this.source,i=this.dataSource;for(t=0;t<e.length;t++)e[t]&&e[t].destroy();for(t=0;t<i.length;t++)i[t]&&i[t].destroy();for(var n in this.frames){var s=this.frames[n];s&&s.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});return BL=s}function yU(){if(zL)return UL;zL=1;var t=Vh(),e=Jh(),i=PI(),n=eh(),s=Tk(),r=mU(),a=new t({Extends:r,initialize:function(t,e,i,n,s){r.call(this,t,e,i,n,s),this.add("__BASE",0,0,0,n,s),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=n,this.height=s,this.imageData=this.context.getImageData(0,0,n,s),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===n.WEBGL&&this.refresh(),this},draw:function(t,e,i,n){return void 0===n&&(n=!0),this.context.drawImage(i,t,e),n&&this.update(),this},drawFrame:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=!0);var r=this.manager.getFrame(t,e);if(r){var a=r.canvasData,o=r.cutWidth,h=r.cutHeight,l=r.source.resolution;this.context.drawImage(r.source.image,a.x,a.y,o,h,i,n,o/l,h/l),s&&this.update()}return this},setPixel:function(t,e,i,n,s,r){if(void 0===r&&(r=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var a=this.context.getImageData(t,e,1,1);a.data[0]=i,a.data[1]=n,a.data[2]=s,a.data[3]=r,this.context.putImageData(a,t,e)}return this},putData:function(t,e,i,n,s,r,a){return void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=t.width),void 0===a&&(a=t.height),this.context.putImageData(t,e,i,n,s,r,a),this},getData:function(t,i,n,s){return t=e(Math.floor(t),0,this.width-1),i=e(Math.floor(i),0,this.height-1),n=e(n,1,this.width-t),s=e(s,1,this.height-i),this.context.getImageData(t,i,n,s)},getPixel:function(t,e,n){n||(n=new i);var s=this.getIndex(t,e);if(s>-1){var r=this.data,a=r[s+0],o=r[s+1],h=r[s+2],l=r[s+3];n.setTo(a,o,h,l)}return n},getPixels:function(t,n,s,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=s),t=Math.abs(Math.round(t)),n=Math.abs(Math.round(n));for(var a=e(t,0,this.width),o=e(t+s,0,this.width),h=e(n,0,this.height),l=e(n+r,0,this.height),u=new i,c=[],d=h;d<l;d++){for(var f=[],p=a;p<o;p++)u=this.getPixel(p,d,u),f.push({x:p,y:d,color:u.color,alpha:u.alphaGL});c.push(f)}return c},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,i,n,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=!0),this.context.clearRect(t,e,i,n),s&&this.update(),this},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=s(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){r.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});return UL=a}function xU(){if(XL)return YL;XL=1;var t=Qo(),e=HI(),i=Hl(),n=Vh(),s=eh(),r=Zu(),a=Wh(),o=Bk(),h=Hk(),l=mU(),u=Zk(),c=new n({Extends:l,initialize:function(t,n,r,a,u){void 0===r&&(r=256),void 0===a&&(a=256),void 0===u&&(u=!0),this.type="DynamicTexture";var c=t.game.renderer,d=c&&c.type===s.CANVAS,f=d?i.create2D(this,r,a):[this];l.call(this,t,n,f,r,a),this.add("__BASE",0,0,0,r,a),this.renderer=c,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=d?f:null,this.context=d?f.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new e(0,0,r,a).setScene(t.game.scene.systemScene,!1),this.renderTarget=d?null:new h(c,r,a,1,0,!1,!1,!0,!1),this.pipeline=d?null:c.pipelines.get(o.SINGLE_PIPELINE),this.setSize(r,a,u)},setSize:function(t,e,i){void 0===e&&(e=t),void 0===i&&(i=!0),i&&((t=Math.floor(t))%2!=0&&t++,(e=Math.floor(e))%2!=0&&e++);var n=this.get(),s=n.source;if(t!==this.width||e!==this.height){this.canvas&&(this.canvas.width=t,this.canvas.height=e);var r=this.renderTarget;r&&(r.willResize(t,e)&&r.resize(t,e),r.texture!==s.glTexture&&this.renderer.deleteTexture(s.glTexture),this.setFromRenderTarget()),this.camera.setSize(t,e),s.width=t,s.height=e,n.setSize(t,e),this.width=t,this.height=e}else{var a=this.getSourceImage();n.cutX+t>a.width&&(t=a.width-n.cutX),n.cutY+e>a.height&&(e=a.height-n.cutY),n.setSize(t,e,n.cutX,n.cutY)}return this},setFromRenderTarget:function(){var t=this.get().source,e=this.renderTarget;return t.isRenderTexture=!0,t.isGLTexture=!0,t.glTexture=e.texture,this},setIsSpriteTexture:function(t){return this.isSpriteTexture=t,this},fill:function(t,e,i,n,s,r){var a=this.camera,o=this.renderer;void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=this.height);var h=t>>16&255,l=t>>8&255,c=255&t,d=this.renderTarget;if(a.preRender(),d){d.bind(!0);var f=this.pipeline.manager.set(this.pipeline),p=o.width/d.width,g=o.height/d.height,v=d.height-(n+r);f.drawFillRect(i*p,v*g,s*p,r*g,u.getTintFromFloats(c/255,l/255,h/255,1),e),d.unbind(!0)}else{var m=this.context;o.setContext(m),m.globalCompositeOperation="source-over",m.fillStyle="rgba("+h+","+l+","+c+","+e+")",m.fillRect(i,n,s,r),o.setContext()}return this.dirty=!0,this},clear:function(t,e,i,n){if(this.dirty){var s=this.context,r=this.renderTarget;r?r.clear(t,e,i,n):s&&(void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?s.clearRect(t,e,i,n):(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,this.width,this.height),s.restore())),this.dirty=!1}return this},stamp:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0);var r=a(s,"alpha",1),o=a(s,"tint",16777215),h=a(s,"angle",0),l=a(s,"rotation",0),u=a(s,"scale",1),c=a(s,"scaleX",u),d=a(s,"scaleY",u),f=a(s,"originX",.5),p=a(s,"originY",.5),g=a(s,"blendMode",0),v=a(s,"erase",!1),m=a(s,"skipBatch",!1),y=this.manager.resetStamp(r,o);return y.setAngle(0),0!==h?y.setAngle(h):0!==l&&y.setRotation(l),y.setScale(c,d),y.setTexture(t,e),y.setOrigin(f,p),y.setBlendMode(g),v&&(this._eraseMode=!0),m?this.batchGameObject(y,i,n):this.draw(y,i,n),v&&(this._eraseMode=!1),this},erase:function(t,e,i){return this._eraseMode=!0,this.draw(t,e,i),this._eraseMode=!1,this},draw:function(t,e,i,n,s){return this.beginDraw(),this.batchDraw(t,e,i,n,s),this.endDraw(),this},drawFrame:function(t,e,i,n,s,r){return this.beginDraw(),this.batchDrawFrame(t,e,i,n,s,r),this.endDraw(),this},repeat:function(t,e,i,n,s,a,o,h,l){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=1),void 0===h&&(h=16777215),void 0===l&&(l=!1),!(e=t instanceof r?t:this.manager.getFrame(t,e)))return this;var u=this.manager.resetStamp(o,h);u.setFrame(e),u.setOrigin(0);var c=e.width,d=e.height;s=Math.floor(s),a=Math.floor(a);var f=Math.ceil(s/c),p=Math.ceil(a/d),g=f*c-s,v=p*d-a;g>0&&(g=c-g),v>0&&(v=d-v),i<0&&(f+=Math.ceil(Math.abs(i)/c)),n<0&&(p+=Math.ceil(Math.abs(n)/d));var m=i,y=n,x=!1,w=this.manager.stampCrop.setTo(0,0,c,d);l||this.beginDraw();for(var T=0;T<p;T++)if(y+d<0)y+=d;else{for(var b=0;b<f;b++)x=!1,m+c<0||(m<0&&(x=!0,w.width=c+m,w.x=c-w.width),y<0&&(x=!0,w.height=d+y,w.y=d-w.height),g>0&&b===f-1&&(x=!0,w.width=g),v>0&&T===p-1&&(x=!0,w.height=v),x&&u.setCrop(w),this.batchGameObject(u,m,y),u.isCropped=!1,w.setTo(0,0,c,d)),m+=c;m=i,y+=d}return l||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var t=this.camera,e=this.renderer,i=this.renderTarget;t.preRender(),i?e.beginCapture(i.width,i.height):e.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(t,e,i,n,s){return Array.isArray(t)||(t=[t]),this.batchList(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===r&&(r=16777215);var a=this.manager.getFrame(t,e);return a&&(this.renderTarget?this.pipeline.batchTextureFrame(a,i,n,r,s,this.camera.matrix,null):this.batchTextureFrame(a,i,n,s,r)),this},endDraw:function(t){if(void 0===t&&(t=this._eraseMode),this.isDrawing){var e=this.renderer,i=this.renderTarget;if(i){var n=e.endCapture();e.pipelines.setUtility().blitFrame(n,i,1,!1,!1,t,this.isSpriteTexture),e.resetScissor(),e.resetViewport()}else e.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(t,e,i,n,s){var a=t.length;if(0!==a)for(var o=0;o<a;o++){var h=t[o];h&&h!==this&&(h.renderWebGL||h.renderCanvas?this.batchGameObject(h,e,i):h.isParent||h.list?this.batchGroup(h.getChildren(),e,i):"string"==typeof h?this.batchTextureFrameKey(h,null,e,i,n,s):h instanceof r?this.batchTextureFrame(h,e,i,n,s):Array.isArray(h)&&this.batchList(h,e,i,n,s))}},batchGroup:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0;n<t.length;n++){var s=t[n];s.willRender(this.camera)&&this.batchGameObject(s,s.x+e,s.y+i)}},batchGameObject:function(e,i,n){void 0===i&&(i=e.x),void 0===n&&(n=e.y);var s=e.x,r=e.y,a=this.camera,o=this.renderer,h=this._eraseMode,l=e.mask;if(e.setPosition(i,n),this.canvas){if(h){var u=e.blendMode;e.blendMode=t.ERASE}l&&l.preRenderCanvas(o,e,a),e.renderCanvas(o,e,a,null),l&&l.postRenderCanvas(o,e,a),h&&(e.blendMode=u)}else o&&(l&&l.preRenderWebGL(o,e,a),h||o.setBlendMode(e.blendMode),e.renderWebGL(o,e,a),l&&l.postRenderWebGL(o,a,this.renderTarget));e.setPosition(s,r)},batchTextureFrameKey:function(t,e,i,n,s,r){var a=this.manager.getFrame(t,e);a&&this.batchTextureFrame(a,i,n,s,r)},batchTextureFrame:function(t,e,i,n,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=16777215);var r=this.camera.matrix;if(this.renderTarget)this.pipeline.batchTextureFrame(t,e,i,s,n,r,null);else{var a=this.context,o=t.canvasData,h=t.source.image;a.save(),a.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",a.globalAlpha=n,r.setToContext(a),o.width>0&&o.height>0&&a.drawImage(h,o.x,o.y,o.width,o.height,e,i,o.width,o.height),a.restore()}},snapshotArea:function(t,e,i,n,s,r,a){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,s,!1,t,e,i,n,r,a):this.renderer.snapshotCanvas(this.canvas,s,!1,t,e,i,n,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(t,e,i,n){var s=this.manager.resetStamp();s.setTexture(this),s.setOrigin(0),s.renderWebGL(t,s,i,n)},renderCanvas:function(){},destroy:function(){var t=this.manager.stamp;t&&t.texture===this&&this.manager.resetStamp(),l.prototype.destroy.call(this),i.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});return YL=c}function wU(){if(ZL)return KL;ZL=1;var t=Vh(),e=ac(),i=ZF(),n=function(){if(qL)return jL;qL=1;var t;Hh();return t=WL?GL:(WL=1,GL=function(t,e,i,n){i.addToRenderList(e),this.pipeline.batchSprite(e,i,n)}),VL||(VL=1,HL=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),jL={renderWebGL:t,renderCanvas:HL}}(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.TextureCrop,e.Tint,e.Transform,e.Visible,n],initialize:function(t,e,n,s,r){i.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(s,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});return KL=s}function TU(){if(sO)return nO;sO=1;var t=uU();return nO=function(e,i,n){if(n.frames||n.textures){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);for(var r,a=Array.isArray(n.textures)?n.textures[i].frames:n.frames,o=0;o<a.length;o++){var h=a[o];if(r=e.add(h.filename,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+h.filename)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Array")}}function bU(){if(aO)return rO;aO=1;var t=uU();return rO=function(e,i,n){if(n.frames){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);var r,a=n.frames;for(var o in a)if(a.hasOwnProperty(o)){var h=a[o];if(r=e.add(o,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+o)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")}}function SU(){return hO||(hO=1,oO=function(t){var e,i=[171,75,84,88,32,49,49,187,13,10,26,10],n=new Uint8Array(t,0,12);for(e=0;e<n.length;e++)if(n[e]!==i[e])return void console.warn("KTXParser - Invalid file format");var s=Uint32Array.BYTES_PER_ELEMENT,r=new DataView(t,12,13*s),a=67305985===r.getUint32(0,!0);if(0===r.getUint32(1*s,a)){var o=r.getUint32(4*s,a),h=r.getUint32(6*s,a),l=r.getUint32(7*s,a),u=Math.max(1,r.getUint32(11*s,a)),c=r.getUint32(12*s,a),d=new Array(u),f=64+c,p=h,g=l;for(e=0;e<u;e++){var v=new Int32Array(t,f,1)[0];f+=4,d[e]={data:new Uint8Array(t,f,v),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=v}return{mipmaps:d,width:h,height:l,internalFormat:o,compressed:!0,generateMipmap:!1}}console.warn("KTXParser - Only compressed formats supported")}),oO}function EU(){if(uO)return lO;function t(t,e,i,n,s,r,a){return void 0===a&&(a=16),Math.floor((t+i)/s)*Math.floor((e+n)/r)*a}function e(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function i(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function n(t,e){return Math.ceil(t/4)*Math.ceil(e/4)*16}function s(e,i){return t(e,i,3,3,4,4,8)}function r(e,i){return t(e,i,3,3,4,4)}uO=1;var a={0:{sizeFunc:e,glFormat:[35841]},1:{sizeFunc:e,glFormat:[35843]},2:{sizeFunc:i,glFormat:[35840]},3:{sizeFunc:i,glFormat:[35842]},6:{sizeFunc:s,glFormat:[36196]},7:{sizeFunc:s,glFormat:[33776,35916]},8:{sizeFunc:r,glFormat:[33777,35917]},9:{sizeFunc:r,glFormat:[33778,35918]},11:{sizeFunc:r,glFormat:[33779,35919]},14:{sizeFunc:n,glFormat:[36494,36495]},15:{sizeFunc:n,glFormat:[36492,36493]},22:{sizeFunc:s,glFormat:[37492,37493]},23:{sizeFunc:r,glFormat:[37496,37497]},24:{sizeFunc:s,glFormat:[37494,37495]},25:{sizeFunc:s,glFormat:[37488]},26:{sizeFunc:r,glFormat:[37490]},27:{sizeFunc:r,glFormat:[37808,37840]},28:{sizeFunc:function(e,i){return t(e,i,4,3,5,4)},glFormat:[37809,37841]},29:{sizeFunc:function(e,i){return t(e,i,4,4,5,5)},glFormat:[37810,37842]},30:{sizeFunc:function(e,i){return t(e,i,5,4,6,5)},glFormat:[37811,37843]},31:{sizeFunc:function(e,i){return t(e,i,5,5,6,6)},glFormat:[37812,37844]},32:{sizeFunc:function(e,i){return t(e,i,7,4,8,5)},glFormat:[37813,37845]},33:{sizeFunc:function(e,i){return t(e,i,7,5,8,6)},glFormat:[37814,37846]},34:{sizeFunc:function(e,i){return t(e,i,7,7,8,8)},glFormat:[37815,37847]},35:{sizeFunc:function(e,i){return t(e,i,9,4,10,5)},glFormat:[37816,37848]},36:{sizeFunc:function(e,i){return t(e,i,9,5,10,6)},glFormat:[37817,37849]},37:{sizeFunc:function(e,i){return t(e,i,9,7,10,8)},glFormat:[37818,37850]},38:{sizeFunc:function(e,i){return t(e,i,9,9,10,10)},glFormat:[37819,37851]},39:{sizeFunc:function(e,i){return t(e,i,11,9,12,10)},glFormat:[37820,37852]},40:{sizeFunc:function(e,i){return t(e,i,11,11,12,12)},glFormat:[37821,37853]}};return lO=function(t){for(var e=new Uint32Array(t,0,13),i=55727696===e[0]?e[2]:e[3],n=e[4],s=a[i].glFormat[n],r=a[i].sizeFunc,o=e[11],h=e[7],l=e[6],u=52+e[12],c=new Uint8Array(t,u),d=new Array(o),f=0,p=h,g=l,v=0;v<o;v++){var m=r(p,g);d[v]={data:new Uint8Array(c.buffer,c.byteOffset+f,m),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=m}return{mipmaps:d,width:h,height:l,internalFormat:s,compressed:!0,generateMipmap:!1}},lO}function _U(){if(dO)return cO;dO=1;var t=Wh();return cO=function(e,i,n,s,r,a,o){var h=t(o,"frameWidth",null),l=t(o,"frameHeight",h);if(null===h)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var u=e.source[i];e.add("__BASE",i,0,0,u.width,u.height);var c=t(o,"startFrame",0),d=t(o,"endFrame",-1),f=t(o,"margin",0),p=t(o,"spacing",0),g=Math.floor((r-f+p)/(h+p))*Math.floor((a-f+p)/(l+p));0===g&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",e.key),(c>g||c<-g)&&(c=0),c<0&&(c=g+c),(-1===d||d>g||d<c)&&(d=g);for(var v=f,m=f,y=0,x=0,w=0,T=0;T<g;T++){y=0,x=0;var b=v+h,S=m+l;b>r&&(y=b-r),S>a&&(x=S-a),T>=c&&T<=d&&(e.add(w,i,n+v,s+m,h-y,l-x),w++),(v+=h+p)+h>r&&(v=f,m+=l+p)}return e},cO}function CU(){if(pO)return fO;pO=1;var t=Wh();return fO=function(e,i,n){var s=t(n,"frameWidth",null),r=t(n,"frameHeight",s);if(!s)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var a=e.source[0];e.add("__BASE",0,0,0,a.width,a.height),t(n,"startFrame",0),t(n,"endFrame",-1);for(var o,h=t(n,"margin",0),l=t(n,"spacing",0),u=i.cutX,c=i.cutY,d=i.cutWidth,f=i.cutHeight,p=i.realWidth,g=i.realHeight,v=Math.floor((p-h+l)/(s+l)),m=Math.floor((g-h+l)/(r+l)),y=i.x,x=s-y,w=s-(p-d-y),T=i.y,b=r-T,S=r-(g-f-T),E=h,_=h,C=0,A=0;A<m;A++){for(var P=0===A,M=A===m-1,R=0;R<v;R++){var L=0===R,O=R===v-1;if(o=e.add(C,0,u+E,c+_,s,r),L||P||O||M){var F=L?y:0,D=P?T:0,I=0,k=0;L&&(I+=s-x),O&&(I+=s-w),P&&(k+=r-b),M&&(k+=r-S);var B=s-I,N=r-k;o.cutWidth=B,o.cutHeight=N,o.setTrim(s,r,F,D,B,N)}E+=l,E+=L?x:O?w:s,C++}E=h,_+=l,_+=P?b:M?S:r}return e}}function AU(){if(vO)return gO;vO=1;var t=0,e=function(e,i,n,s){var r=t-s.y-s.height;e.add(n,i,s.x,r,s.width,s.height)};return gO=function(i,n,s){var r=i.source[n];i.add("__BASE",n,0,0,r.width,r.height),t=r.height;for(var a=s.split("\n"),o=/^[ ]*(- )*(\w+)+[: ]+(.*)/,h="",l="",u={x:0,y:0,width:0,height:0},c=0;c<a.length;c++){var d=a[c].match(o);if(d){var f="- "===d[1],p=d[2],g=d[3];if(f&&(l!==h&&(e(i,n,l,u),h=l),u={x:0,y:0,width:0,height:0}),"name"!==p)switch(p){case"x":case"y":case"width":case"height":u[p]=parseInt(g,10)}else l=g}}return l!==h&&e(i,n,l,u),i},gO}function PU(){return yO?mO:(yO=1,mO={AtlasXML:$L?JL:($L=1,JL=function(t,e,i){if(i.getElementsByTagName("TextureAtlas")){var n=t.source[e];t.add("__BASE",e,0,0,n.width,n.height);for(var s,r=i.getElementsByTagName("SubTexture"),a=0;a<r.length;a++){var o=r[a].attributes,h=o.name.value,l=parseInt(o.x.value,10),u=parseInt(o.y.value,10),c=parseInt(o.width.value,10),d=parseInt(o.height.value,10);if(s=t.add(h,e,l,u,c,d),o.frameX){var f=Math.abs(parseInt(o.frameX.value,10)),p=Math.abs(parseInt(o.frameY.value,10)),g=parseInt(o.frameWidth.value,10),v=parseInt(o.frameHeight.value,10);s.setTrim(c,d,f,p,g,v)}}return t}console.warn("Invalid Texture Atlas XML given")}),Canvas:tO?QL:(tO=1,QL=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}),Image:iO?eO:(iO=1,eO=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}),JSONArray:TU(),JSONHash:bU(),KTXParser:SU(),PVRParser:EU(),SpriteSheet:_U(),SpriteSheetFromAtlas:CU(),UnityYAML:AU()})}function MU(){if(wO)return xO;wO=1;var t=Hl(),e=yU(),i=Vh(),n=PI(),s=eh(),r=xU(),a=qF(),o=Gk(),h=Zu(),l=pI(),u=gN(),c=Ol(),d=wU(),f=ih(),p=PU(),g=Fu(),v=mU(),m=new i({Extends:a,initialize:function(e){a.call(this),this.game=e,this.name="TextureManager",this.list={},this._tempCanvas=t.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new g,this.silentWarnings=!1,e.events.once(l.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(o.LOAD,this.updatePending,this),this.on(o.ERROR,this.updatePending,this);var t=this.game.config;null!==t.defaultImage&&this.addBase64("__DEFAULT",t.defaultImage),null!==t.missingImage&&this.addBase64("__MISSING",t.missingImage),null!==t.whiteImage&&this.addBase64("__WHITE",t.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(l.DESTROY,this.destroy,this),this.game.events.once(l.SYSTEM_READY,function(t){this.stamp=new d(t).setOrigin(0)},this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(o.LOAD),this.off(o.ERROR),this.emit(o.READY))},checkKey:function(t){return!(!t||"string"!=typeof t||this.exists(t))||(this.silentWarnings||console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"==typeof t){if(!this.exists(t))return this.silentWarnings||console.warn("No texture found matching key: "+t),this;t=this.get(t)}var e=t.key;return this.list.hasOwnProperty(e)&&(t.destroy(),this.emit(o.REMOVE,e),this.emit(o.REMOVE_KEY+e)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var i=this,n=new Image;n.onerror=function(){i.emit(o.ERROR,t)},n.onload=function(){var e=i.create(t,n);e&&(p.Image(e,0),i.emit(o.ADD,t,e),i.emit(o.ADD_KEY+t,e),i.emit(o.LOAD,t,e))},n.src=e}return this},getBase64:function(e,i,n,s){void 0===n&&(n="image/png"),void 0===s&&(s=.92);var r="",a=this.getFrame(e,i);if(a&&(a.source.isRenderTexture||a.source.isGLTexture))this.silentWarnings||console.warn("Cannot getBase64 from WebGL Texture");else if(a){var o=a.canvasData,h=t.create2D(this,o.width,o.height),l=h.getContext("2d",{willReadFrequently:!0});o.width>0&&o.height>0&&l.drawImage(a.source.image,o.x,o.y,o.width,o.height,0,0,o.width,o.height),r=h.toDataURL(n,s),t.remove(h)}return r},addImage:function(t,e,i){var n=null;return this.checkKey(t)&&(n=this.create(t,e),p.Image(n,0),i&&n.setDataSource(i),this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)),n},addGLTexture:function(t,e){var i=null;if(this.checkKey(t)){var n=e.width,s=e.height;(i=this.create(t,e,n,s)).add("__BASE",0,0,0,n,s),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)}return i},addCompressedTexture:function(t,e,i){var n=null;if(this.checkKey(t)){if((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),i){var s=function(t,e,i){Array.isArray(i.textures)||Array.isArray(i.frames)?p.JSONArray(t,e,i):p.JSONHash(t,e,i)};if(Array.isArray(i))for(var r=0;r<i.length;r++)s(n,r,i[r]);else s(n,0,i)}this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)}return n},addRenderTexture:function(t,e){var i=null;return this.checkKey(t)&&((i=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)),i},generate:function(e,i){if(this.checkKey(e)){var n=t.create(this,1,1);return i.canvas=n,u(i),this.addCanvas(e,n)}return null},createCanvas:function(e,i,n){if(void 0===i&&(i=256),void 0===n&&(n=256),this.checkKey(e)){var r=t.create(this,i,n,s.CANVAS,!0);return this.addCanvas(e,r)}return null},addCanvas:function(t,i,n){void 0===n&&(n=!1);var s=null;return n?s=new e(this,t,i,i.width,i.height):this.checkKey(t)&&(s=new e(this,t,i,i.width,i.height),this.list[t]=s,this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addDynamicTexture:function(t,e,i){var n=null;return"string"!=typeof t||this.exists(t)?t=(n=t).key:n=new r(this,t,e,i),this.checkKey(t)?(this.list[t]=n,this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)):n=null,n},addAtlas:function(t,e,i,n){return Array.isArray(i.textures)||Array.isArray(i.frames)?this.addAtlasJSONArray(t,e,i,n):this.addAtlasJSONHash(t,e,i,n)},addAtlasJSONArray:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=1===i.length,a=0;a<s.source.length;a++){var h=r?i[0]:i[a];p.JSONArray(s,a,h)}else p.JSONArray(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasJSONHash:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=0;r<i.length;r++)p.JSONHash(s,r,i[r]);else p.JSONHash(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasXML:function(t,e,i,n){var s=null;return e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.AtlasXML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addUnityAtlas:function(t,e,i,n){var s=null;return e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.UnityYAML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addSpriteSheet:function(t,e,i,n){var s=null;if(e instanceof v?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){var r=s.source[0].width,a=s.source[0].height;p.SpriteSheet(s,0,0,0,r,a,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var i=c(e,"atlas",null),n=c(e,"frame",null);if(i&&n){var s=this.get(i).get(n);if(s){var r=s.source.image;r||(r=s.source.glTexture);var a=this.create(t,r);return s.trimmed?p.SpriteSheetFromAtlas(a,s,e):p.SpriteSheet(a,0,s.cutX,s.cutY,s.cutWidth,s.cutHeight,e),this.emit(o.ADD,t,a),this.emit(o.ADD_KEY+t,a),a}}},addUint8Array:function(t,e,i,n){if(!this.checkKey(t)||e.length/4!==i*n)return null;var s=this.create(t,e,i,n);return s.add("__BASE",0,0,0,i,n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s),s},create:function(t,e,i,n){var s=null;return this.checkKey(t)&&(s=new v(this,t,e,i,n),this.list[t]=s),s},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof v?t:t instanceof h?t.texture:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},parseFrame:function(t){if(t)return"string"==typeof t?this.getFrame(t):Array.isArray(t)&&2===t.length?this.getFrame(t[0],t[1]):f(t)?this.getFrame(t.key,t.frame):t instanceof v?t.get():t instanceof h?t:void 0},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&"__WHITE"!==e&&"__NORMAL"!==e&&t.push(e);return t},getPixel:function(t,e,i,s){var r=this.getFrame(i,s);if(r){t-=r.x,e-=r.y;var a=r.data.cut;if(t+=a.x,e+=a.y,t>=a.x&&t<a.r&&e>=a.y&&e<a.b){var o=this._tempContext;o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1);var h=o.getImageData(0,0,1,1);return new n(h.data[0],h.data[1],h.data[2],h.data[3])}}return null},getPixelAlpha:function(t,e,i,n){var s=this.getFrame(i,n);if(s){t-=s.x,e-=s.y;var r=s.data.cut;if(t+=r.x,e+=r.y,t>=r.x&&t<r.r&&e>=r.y&&e<r.b){var a=this._tempContext;return a.clearRect(0,0,1,1),a.drawImage(s.source.image,t,e,1,1,0,0,1,1),a.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,i){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(i)),t},renameTexture:function(t,e){var i=this.get(t);return!(!i||t===e||(i.key=e,this.list[e]=i,delete this.list[t],0))},each:function(t,e){for(var i=[null],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[0]=this.list[s],t.apply(e,i)},resetStamp:function(t,e){void 0===t&&(t=1),void 0===e&&(e=16777215);var i=this.stamp;return i.setCrop(),i.setPosition(0),i.setAngle(0),i.setScale(1),i.setAlpha(t),i.setTint(e),i.setTexture("__WHITE"),i},destroy:function(){for(var e in this.list)this.list[e].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,t.remove(this._tempCanvas)}});return xO=m}function RU(){if(bO)return TO;bO=1;var t=FN(),e=gI(),i=wI(),n=Hl(),s=Vh(),r=Nk(),a=function(){if(kP)return IP;kP=1;var t=FN();return IP=function(e){var i=e.config;if(i.parent&&i.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+e.scale.width+"px;","height: "+e.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+i.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),e.domContainer=n,t(n,i.parent)}}}(),o=lN(),h=hc(),l=uN(),u=$l(),c=DN(),d=qF(),f=pI(),p=tU(),g=ku(),v=nU(),m=rU(),y=gU(),x=Gk(),w=MU(),T=dN(),b=fN(),S=new s({initialize:function(t){this.config=new r(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new d,this.anims=new e(this),this.textures=new w(this),this.cache=new i(this),this.registry=new h(this,new d),this.input=new p(this,this.config),this.scene=new y(this,this.config.sceneConfig),this.device=u,this.scale=new m(this,this.config),this.sound=null,this.loop=new T(this,this.config.fps),this.plugins=new v(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,c(this.boot.bind(this))},boot:function(){g.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),o(this),a(this),l(this),t(this.canvas,this.config.parent),this.textures.once(x.READY,this.texturesReady,this),this.events.emit(f.BOOT),window&&(window.PHASER_GAME=this)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(f.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),b(this);var t=this.events;t.on(f.HIDDEN,this.onHidden,this),t.on(f.VISIBLE,this.onVisible,this),t.on(f.BLUR,this.onBlur,this),t.on(f.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(f.PRE_STEP,t,e),i.emit(f.STEP,t,e),this.scene.update(t,e),i.emit(f.POST_STEP,t,e);var n=this.renderer;n.preRender(),i.emit(f.PRE_RENDER,n,t,e),this.scene.render(n),n.postRender(),i.emit(f.POST_RENDER,n,t,e)}},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(f.PRE_STEP,t,e),i.emit(f.STEP,t,e),this.scene.update(t,e),i.emit(f.POST_STEP,t,e),this.scene.isProcessing=!1,i.emit(f.PRE_RENDER,null,t,e),i.emit(f.POST_RENDER,null,t,e)}},onHidden:function(){this.loop.pause(),this.events.emit(f.PAUSE)},pause:function(){var t=this.isPaused;this.isPaused=!0,t||this.events.emit(f.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(f.RESUME,this.loop.pauseDuration)},resume:function(){var t=this.isPaused;this.isPaused=!1,t&&this.events.emit(f.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(f.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(n.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});return TO=S}function LU(){if(EO)return SO;EO=1;var t=tu(),e=Vh(),i=Hh(),n=Ql(),s=new e({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=i,this.removeCallback=i,this._sortKey=""},add:function(e,i){return i?t.Add(this.list,e):t.Add(this.list,e,0,this.addCallback,this)},addAt:function(e,i,n){return n?t.AddAt(this.list,e,i):t.AddAt(this.list,e,i,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,i){return e[t]-i[t]}),n(this.list,e),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i){return t.CountAllMatching(this.list,e,i)},swap:function(e,i){t.Swap(this.list,e,i)},moveTo:function(e,i){return t.MoveTo(this.list,e,i)},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i)},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i)},remove:function(e,i){return i?t.Remove(this.list,e):t.Remove(this.list,e,this.removeCallback,this)},removeAt:function(e,i){return i?t.RemoveAt(this.list,e):t.RemoveAt(this.list,e,this.removeCallback,this)},removeBetween:function(e,i,n){return n?t.RemoveBetween(this.list,e,i):t.RemoveBetween(this.list,e,i,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(e){return t.BringToTop(this.list,e)},sendToBack:function(e){return t.SendToBack(this.list,e)},moveUp:function(e){return t.MoveUp(this.list,e),e},moveDown:function(e){return t.MoveDown(this.list,e),e},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i){return t.Replace(this.list,e,i)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});return SO=s}function OU(){if(CO)return _O;CO=1;var t=Vh(),e=LU(),i=ku(),n=KF(),s=Bu(),r=Ql(),a=new t({Extends:e,initialize:function(t){e.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.events.once(s.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(n.ADDED_TO_SCENE,t,this.scene),this.events.emit(s.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(n.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(s.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(r(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list,e=t.length;e--;)t[e]&&t[e].destroy(!0);t.length=0,this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});return i.register("DisplayList",a,"displayList"),_O=a}function FU(){return OO?LO:(OO=1,LO={PROCESS_QUEUE_ADD:PO?AO:(PO=1,AO="add"),PROCESS_QUEUE_REMOVE:RO?MO:(RO=1,MO="remove")})}function DU(){if(DO)return FO;DO=1;var t=Vh(),e=qF(),i=FU(),n=new t({Extends:e,initialize:function(){e.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(t){return this._active.indexOf(t)>-1},isPending:function(t){return this._toProcess>0&&this._pending.indexOf(t)>-1},isDestroying:function(t){return this._destroy.indexOf(t)>-1},add:function(t){return this.checkQueue&&this.isActive(t)&&!this.isDestroying(t)||this.isPending(t)||(this._pending.push(t),this._toProcess++),t},remove:function(t){if(this.isPending(t)){var e=this._pending,i=e.indexOf(t);-1!==i&&e.splice(i,1)}else this.isActive(t)&&(this._destroy.push(t),this._toProcess++);return t},removeAll:function(){for(var t=this._active,e=this._destroy,i=t.length;i--;)e.push(t[i]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,s=this._active;for(t=0;t<n.length;t++){e=n[t];var r=s.indexOf(e);-1!==r&&(s.splice(r,1),this.emit(i.PROCESS_QUEUE_REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)e=n[t],(!this.checkQueue||this.checkQueue&&-1===s.indexOf(e))&&(s.push(e),this.emit(i.PROCESS_QUEUE_ADD,e));return n.length=0,this._toProcess=0,s},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});return FO=n}function IU(){if(kO)return IO;kO=1;var t=Vh(),e=DU(),i=ku(),n=Bu(),s=new t({Extends:e,initialize:function(t){e.call(this),this.checkQueue=!0,this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.systems.events.once(n.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(n.PRE_UPDATE,this.update,this),t.on(n.UPDATE,this.sceneUpdate,this),t.once(n.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var i=this._active,n=i.length,s=0;s<n;s++){var r=i[s];r.active&&r.preUpdate.call(r,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(n.PRE_UPDATE,this.update,this),e.off(n.UPDATE,this.sceneUpdate,this),e.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("UpdateList",s,"updateList"),IO=s}function kU(){if(NO)return BO;NO=1;var t=tc(),e=new t,i=new t,n=new t,s={camera:e,sprite:i,calc:n};return BO=function(t,r,a){var o=e,h=i,l=n;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),o.copyFrom(r.matrix),a?(o.multiplyWithOffset(a,-r.scrollX*t.scrollFactorX,-r.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=r.scrollX*t.scrollFactorX,h.f-=r.scrollY*t.scrollFactorY),o.multiply(h,l),s}}function BU(){if(zO)return UO;zO=1;var t=kk(),e=Ol();return UO=function(i,n,s){var r=e(i,n,null);if(null===r)return s;if(Array.isArray(r))return t.RND.pick(r);if("object"==typeof r){if(r.hasOwnProperty("randInt"))return t.RND.integerInRange(r.randInt[0],r.randInt[1]);if(r.hasOwnProperty("randFloat"))return t.RND.realInRange(r.randFloat[0],r.randFloat[1])}else if("function"==typeof r)return r(n);return r}}function NU(){if(XO)return YO;XO=1;var t=Qo(),e=BU();return YO=function(i,n,s){n.x=e(s,"x",0),n.y=e(s,"y",0),n.depth=e(s,"depth",0),n.flipX=e(s,"flipX",!1),n.flipY=e(s,"flipY",!1);var r=e(s,"scale",null);"number"==typeof r?n.setScale(r):null!==r&&(n.scaleX=e(r,"x",1),n.scaleY=e(r,"y",1));var a=e(s,"scrollFactor",null);"number"==typeof a?n.setScrollFactor(a):null!==a&&(n.scrollFactorX=e(a,"x",1),n.scrollFactorY=e(a,"y",1)),n.rotation=e(s,"rotation",0);var o=e(s,"angle",null);null!==o&&(n.angle=o),n.alpha=e(s,"alpha",1);var h=e(s,"origin",null);if("number"==typeof h)n.setOrigin(h);else if(null!==h){var l=e(h,"x",.5),u=e(h,"y",.5);n.setOrigin(l,u)}return n.blendMode=e(s,"blendMode",t.NORMAL),n.visible=e(s,"visible",!0),e(s,"add",!0)&&i.sys.displayList.add(n),n.preUpdate&&i.sys.updateList.add(n),n},YO}function UU(){if(WO)return GO;WO=1;var t=BU();return GO=function(e,i){var n=t(i,"anims",null);if(null===n)return e;if("string"==typeof n)e.anims.play(n);else if("object"==typeof n){var s=e.anims,r=t(n,"key",void 0);if(r){var a=t(n,"startFrame",void 0),o=t(n,"delay",0),h=t(n,"repeat",0),l=t(n,"repeatDelay",0),u=t(n,"yoyo",!1),c=t(n,"play",!1),d=t(n,"delayedPlay",0),f={key:r,delay:o,repeat:h,repeatDelay:l,yoyo:u,startFrame:a};c?s.play(f):d>0?s.playAfterDelay(f,d):s.load(f)}}return e}}function zU(){if(qO)return jO;function t(t,e){return parseInt(t.getAttribute(e),10)}return qO=1,jO=function(e,i,n,s,r){void 0===n&&(n=0),void 0===s&&(s=0);var a=i.cutX,o=i.cutY,h=i.source.width,l=i.source.height,u=i.sourceIndex,c={},d=e.getElementsByTagName("info")[0],f=e.getElementsByTagName("common")[0];c.font=d.getAttribute("face"),c.size=t(d,"size"),c.lineHeight=t(f,"lineHeight")+s,c.chars={};var p=e.getElementsByTagName("char"),g=void 0!==i&&i.trimmed;if(g)var v=i.height,m=i.width;for(var y=0;y<p.length;y++){var x=p[y],w=t(x,"id"),T=String.fromCharCode(w),b=t(x,"x"),S=t(x,"y"),E=t(x,"width"),_=t(x,"height");g&&(b<m&&(m=b),S<v&&(v=S)),g&&0!==v&&0!==m&&(b-=i.x,S-=i.y);var C=(a+b)/h,A=(o+S)/l,P=(a+b+E)/h,M=(o+S+_)/l;if(c.chars[w]={x:b,y:S,width:E,height:_,centerX:Math.floor(E/2),centerY:Math.floor(_/2),xOffset:t(x,"xoffset"),yOffset:t(x,"yoffset"),xAdvance:t(x,"xadvance")+n,data:{},kerning:{},u0:C,v0:A,u1:P,v1:M},r&&0!==E&&0!==_){var R=r.add(T,u,b,S,E,_);R&&R.setUVs(E,_,C,A,P,M)}}var L=e.getElementsByTagName("kerning");for(y=0;y<L.length;y++){var O=L[y],F=t(O,"first"),D=t(O,"second"),I=t(O,"amount");c.chars[D].kerning[F]=I}return c},jO}function YU(){if(iF)return eF;iF=1;var t=kU();return eF=function(e,i,n,s,r){var a=s.alpha*n.alpha;if(a<=0)return!1;var o=t(n,s,r).calc;return i.globalCompositeOperation=e.blendModes[n.blendMode],i.globalAlpha=a,i.save(),o.setToContext(i),i.imageSmoothingEnabled=n.frame?!n.frame.source.scaleMode:e.antialias,!0},eF}function XU(){if(aF)return rF;aF=1;var t,e,i=Hh();return t=function(){if(tF)return QO;tF=1;var t=$O?JO:($O=1,JO=function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p){var g=i.x-e.displayOriginX+s,v=i.y-e.displayOriginY+r,m=g+i.w,y=v+i.h,x=a.a,w=a.b,T=a.c,b=a.d,S=a.e,E=a.f,_=g*x+v*T+S,C=g*w+v*b+E,A=g*x+y*T+S,P=g*w+y*b+E,M=m*x+y*T+S,R=m*w+y*b+E,L=m*x+v*T+S,O=m*w+v*b+E;o&&(_=Math.round(_),C=Math.round(C),A=Math.round(A),P=Math.round(P),M=Math.round(M),R=Math.round(R),L=Math.round(L),O=Math.round(O)),t.batchQuad(e,_,C,A,P,M,R,L,O,n.u0,n.v0,n.u1,n.v1,h,l,u,c,d,f,p)}),e=kU(),i=Zk();return QO=function(n,s,r,a){if(0!==s._text.length){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline,s),h=e(s,r,a).calc;n.pipelines.preBatch(s);var l,u,c,d=r.roundPixels,f=r.alpha,p=s.charColors,g=s.tintFill,v=i.getTintAppendFloatAlpha,m=v(s.tintTopLeft,f*s._alphaTL),y=v(s.tintTopRight,f*s._alphaTR),x=v(s.tintBottomLeft,f*s._alphaBL),w=v(s.tintBottomRight,f*s._alphaBR),T=s.frame.glTexture,b=o.setGameObject(s),S=s.getTextBounds(!1).characters,E=s.dropShadowX,_=s.dropShadowY;if(0!==E||0!==_){var C=s.dropShadowColor,A=s.dropShadowAlpha,P=v(C,f*A*s._alphaTL),M=v(C,f*A*s._alphaTR),R=v(C,f*A*s._alphaBL),L=v(C,f*A*s._alphaBR);for(l=0;l<S.length;l++)c=(u=S[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height&&t(o,s,u,c,E,_,h,d,P,M,R,L,1,T,b)}for(l=0;l<S.length;l++)if(c=(u=S[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height)if(o.shouldFlush(6)&&(o.flush(),b=o.setGameObject(s)),p[u.i]){var O=p[u.i],F=O.tintEffect,D=v(O.tintTL,f*s._alphaTL),I=v(O.tintTR,f*s._alphaTR),k=v(O.tintBL,f*s._alphaBL),B=v(O.tintBR,f*s._alphaBR);t(o,s,u,c,0,0,h,d,D,I,k,B,F,T,b)}else t(o,s,u,c,0,0,h,d,m,y,x,w,g,T,b);n.pipelines.postBatch(s)}},QO}(),e=function(){if(sF)return nF;sF=1;var t=YU();return nF=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.fontData.chars,u=i.fontData.lineHeight,c=i._letterSpacing,d=i._lineSpacing,f=0,p=0,g=0,v=null,m=0,y=0,x=0,w=0,T=0,b=0,S=null,E=0,_=h.source.image,C=h.cutX,A=h.cutY,P=i._fontSize/i.fontData.size,M=i._align,R=0,L=0,O=i.getTextBounds(!1);i.maxWidth>0&&(a=(r=O.wrappedText).length);var F=i._bounds.lines;1===M?L=(F.longest-F.lengths[0])/2:2===M&&(L=F.longest-F.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);for(var D=n.roundPixels,I=0;I<a;I++)if(10!==(g=r.charCodeAt(I))){if(v=l[g]){if(m=C+v.x,y=A+v.y,x=v.width,w=v.height,T=v.xOffset+f,b=v.yOffset+p,null!==S){var k=v.kerning[E];T+=void 0!==k?k:0}T*=P,b*=P,T+=L,f+=v.xAdvance+c+(void 0!==k?k:0),S=v,E=g,0!==x&&0!==w&&32!==g&&(D&&(T=Math.round(T),b=Math.round(b)),o.save(),o.translate(T,b),o.scale(P,P),o.drawImage(_,m,y,x,w,0,0,x,w),o.restore())}}else R++,1===M?L=(F.longest-F.lengths[R])/2:2===M&&(L=F.longest-F.lengths[R]),f=0,p+=u+d,S=null;o.restore()}},nF}(),rF={renderWebGL:t,renderCanvas:e}}function GU(){if(hF)return oF;hF=1;var t=Vh(),e=Jh(),i=ac(),n=ZF(),s=(VO||(VO=1,HO=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n)return{local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var s,r,a,o=t.text,h=o.length,l=t.maxWidth,u=t.wordWrapCharCode,c=Number.MAX_VALUE,d=Number.MAX_VALUE,f=0,p=0,g=t.fontData.chars,v=t.fontData.lineHeight,m=t.letterSpacing,y=t.lineSpacing,x=0,w=0,T=0,b=null,S=t._align,E=0,_=0,C=t.fontSize/t.fontData.size,A=C*t.scaleX,P=C*t.scaleY,M=null,R=0,L=[],O=Number.MAX_VALUE,F=0,D=0,I=0,k=[],B=[],N=null,U=function(t,e){for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n),r=e.chars[s];r&&(i+=r.xAdvance)}return i*A};if(l>0){a=o.split("\n");var z=[];for(s=0;s<a.length;s++){var Y=a[s],X="",G="",W="",H="";for(r=0;r<Y.length;r++)T=Y.charCodeAt(r),X+=Y[r],(T===u||r===Y.length-1)&&(U(H=W+X,t.fontData)<=l?W=H:(G=G.slice(0,-1),G+=(G?"\n":"")+W,W=X),X="");G=G.slice(0,-1),G+=(G?"\n":"")+W,z.push(G)}o=z.join("\n"),n.wrappedText=o,h=o.length}var V=0;for(s=0;s<h;s++)if(10!==(T=o.charCodeAt(s))){if(b=g[T]){if(E=x,_=w,null!==M){var j=b.kerning[R];E+=void 0!==j?j:0}c>E&&(c=E),d>_&&(d=_);var q=E+b.xAdvance,K=_+v;f<q&&(f=q),p<K&&(p=K);var Z=b.xOffset+b.xAdvance+(void 0!==j?j:0);T===u?null!==N&&(k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),N=null):(null===N&&(N={word:"",i:V,x:x,y:w,w:0,h:v}),N.word=N.word.concat(o[s]),N.w+=Z),B.push({i:V,idx:s,char:o[s],code:T,x:(b.xOffset+E)*C,y:(b.yOffset+w)*C,w:b.width*C,h:b.height*C,t:w*C,r:q*C,b:v*C,line:D,glyph:b}),x+=b.xAdvance+m+(void 0!==j?j:0),M=b,R=T,I=q*C,V++}}else null!==N&&(k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),N=null),M=null,L[D]=I,I>F&&(F=I),I<O&&(O=I),I=0,x=0,w=(v+y)*++D;if(null!==N&&k.push({word:N.word,i:N.i,x:N.x*A,y:N.y*P,w:N.w*A,h:N.h*P}),L[D]=I,I>F&&(F=I),I<O&&(O=I),S>0)for(var J=0;J<B.length;J++){var $=B[J];if(1===S){var Q=(F-L[$.line])/2;$.x+=Q,$.r+=Q}else if(2===S){var tt=F-L[$.line];$.x+=tt,$.r+=tt}}var et=n.local,it=n.global;return a=n.lines,et.x=c*C,et.y=d*C,et.width=f*C,et.height=p*C,it.x=t.x-t._displayOriginX+c*A,it.y=t.y-t._displayOriginY+d*P,it.width=f*A,it.height=p*P,a.shortest=O,a.longest=F,a.lengths=L,e&&(et.x=Math.ceil(et.x),et.y=Math.ceil(et.y),et.width=Math.ceil(et.width),et.height=Math.ceil(et.height),it.x=Math.ceil(it.x),it.y=Math.ceil(it.y),it.width=Math.ceil(it.width),it.height=Math.ceil(it.height),a.shortest=Math.ceil(O),a.longest=Math.ceil(F)),i&&(t._displayOriginX=t.originX*et.width,t._displayOriginY=t.originY*et.height,it.x=t.x-t._displayOriginX*t.scaleX,it.y=t.y-t._displayOriginY*t.scaleY,e&&(it.x=Math.ceil(it.x),it.y=Math.ceil(it.y))),n.words=k,n.characters=B,n.lines.height=v,n.scale=C,n.scaleX=t.scaleX,n.scaleY=t.scaleY,n}),HO),r=function(){if(ZO)return KO;ZO=1;var t=zU();return KO=function(e,i,n,s,r,a,o){var h=e.sys.textures.get(n),l=h.get(s),u=e.sys.cache.xml.get(r);if(l&&u){var c=t(u,l,a,o,h);return e.sys.cache.bitmapFont.add(i,{data:c,texture:n,frame:s,fromAtlas:!0}),!0}return!1},KO}(),a=zU(),o=Fu(),h=XU(),l=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Texture,i.Tint,i.Transform,i.Visible,h],initialize:function(t,e,i,r,a,o,h){void 0===a&&(a=""),void 0===h&&(h=0),n.call(this,t,"BitmapText"),this.font=r;var l=this.scene.sys.cache.bitmapFont.get(r);if(!l)throw new Error("Invalid BitmapText key: "+r);this.fontData=l.data,this._text="",this._fontSize=o||this.fontData.size,this._letterSpacing=0,this._lineSpacing=0,this._align=h,this._bounds=s(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.fromAtlas=l.fromAtlas,this.setTexture(l.texture,l.frame),this.setPosition(e,i),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(),this.setText(a)},setLeftAlign:function(){return this._align=l.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=l.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=l.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setLineSpacing:function(t){return void 0===t&&(t=0),this.lineSpacing=t,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=.5),this.dropShadowX=t,this.dropShadowY=e,this.dropShadowColor=i,this.dropShadowAlpha=n,this},setCharacterTint:function(t,i,n,s,r,a,o){void 0===t&&(t=0),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===s&&(s=-1),void 0===r&&(r=s,a=s,o=s);var h=this.text.length;-1===i&&(i=h),t<0&&(t=h+t),t=e(t,0,h-1);for(var l=e(t+i,t,h),u=this.charColors,c=t;c<l;c++){var d=u[c];if(-1===s)u[c]=null;else{var f=n?1:0;d?(d.tintEffect=f,d.tintTL=s,d.tintTR=r,d.tintBL=a,d.tintBR=o):u[c]={tintEffect:f,tintTL:s,tintTR:r,tintBL:a,tintBR:o}}}return this},setWordTint:function(t,e,i,n,s,r,a){void 0===e&&(e=1);for(var o=this.getTextBounds().words,h="number"==typeof t,l=0,u=0;u<o.length;u++){var c=o[u];if((h&&u===t||!h&&c.word===t)&&(this.setCharacterTint(c.i,c.word.length,i,n,s,r,a),++l===e))return this}return this},getTextBounds:function(t){var e=this._bounds;return(this._dirty||t||this.scaleX!==e.scaleX||this.scaleY!==e.scaleY)&&(s(this,t,!0,e),this._dirty=!1),e},getCharacterAt:function(t,e,i){for(var n=this.getLocalPoint(t,e,null,i),s=this.getTextBounds().characters,r=new o,a=0;a<s.length;a++){var h=s[a];if(r.setTo(h.x,h.t,h.r-h.x,h.b),r.contains(n.x,n.y))return h}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(t,e,i){void 0===e&&(e=this._fontSize),void 0===i&&(i=this._align);var n=this.scene.sys.cache.bitmapFont.get(t);return n&&(this.font=t,this.fontData=n.data,this._fontSize=e,this._align=i,this.fromAtlas=!0===n.fromAtlas,this.setTexture(n.texture,n.frame),s(this,!1,!0,this._bounds)),this},setMaxWidth:function(t,e){return this._maxWidth=t,this._dirty=!0,void 0!==e&&(this.wordWrapCharCode=e),this},setDisplaySize:function(t,e){this.setScale(1,1),this.getTextBounds(!1);var i=t/this.width,n=e/this.height;return this.setScale(i,n),this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},lineSpacing:{set:function(t){this._lineSpacing=t,this._dirty=!0},get:function(){return this._lineSpacing}},maxWidth:{set:function(t){this._maxWidth=t,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},displayWidth:{set:function(t){this.setScaleX(1),this.getTextBounds(!1);var e=t/this.width;this.setScaleX(e)},get:function(){return this.width}},displayHeight:{set:function(t){this.setScaleY(1),this.getTextBounds(!1);var e=t/this.height;this.setScaleY(e)},get:function(){return this.height}},toJSON:function(){var t=i.ToJSON(this),e={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineSpacing:this.lineSpacing,align:this.align};return t.data=e,t},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});return l.ALIGN_LEFT=0,l.ALIGN_CENTER=1,l.ALIGN_RIGHT=2,l.ParseFromAtlas=r,l.ParseXMLBitmapFont=a,oF=l}function WU(){if(vF)return gF;vF=1;var t=Vh(),e=Zu(),i=new t({initialize:function(t,e,i,n,s){this.parent=t,this.x=e,this.y=i,this.frame=n,this.data={},this.tint=16777215,this._visible=s,this._alpha=1,this.flipX=!1,this.flipY=!1,this.hasTransformComponent=!0},setFrame:function(t){return void 0===t?this.frame=this.parent.frame:t instanceof e&&t.texture===this.parent.texture?this.frame=t:this.frame=this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,i){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,i&&this.setFrame(i),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!=t>0,this._alpha=t}}});return gF=i}function HU(){if(yF)return mF;yF=1;var t=function(){if(pF)return fF;pF=1;var t;Hh();return t=function(){if(uF)return lF;uF=1;var t=tc(),e=Zk(),i=new t;return lF=function(t,n,s,r){var a=n.getRenderList(),o=s.alpha*n.alpha;if(0!==a.length&&0!==o){s.addToRenderList(n);var h=t.pipelines.set(this.pipeline,n),l=s.scrollX*n.scrollFactorX,u=s.scrollY*n.scrollFactorY,c=i.copyFrom(s.matrix);r&&(c.multiplyWithOffset(r,-l,-u),l=0,u=0);var d=n.x-l,f=n.y-u,p=-1,g=s.roundPixels;t.pipelines.preBatch(n);for(var v=0;v<a.length;v++){var m=a[v],y=m.frame,x=m.alpha*o;if(0!==x){var w=y.width,T=y.height,b=d+m.x+y.x,S=f+m.y+y.y;m.flipX&&(w*=-1,b+=y.width),m.flipY&&(T*=-1,S+=y.height);var E=c.setQuad(b,S,b+w,S+T,g),_=e.getTintAppendFloatAlpha(m.tint,x);if(y.sourceIndex!==p){var C=h.setGameObject(n,y);p=y.sourceIndex}h.batchQuad(n,E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],y.u0,y.v0,y.u1,y.v1,_,_,_,_,!1,y.glTexture,C)&&(p=-1)}}t.pipelines.postBatch(n)}},lF}(),dF||(dF=1,cF=function(t,e,i,n){var s=e.getRenderList();if(0!==s.length){var r=t.currentContext,a=i.alpha*e.alpha;if(0!==a){i.addToRenderList(e),r.globalCompositeOperation=t.blendModes[e.blendMode],r.imageSmoothingEnabled=!e.frame.source.scaleMode;var o=e.x-i.scrollX*e.scrollFactorX,h=e.y-i.scrollY*e.scrollFactorY;r.save(),n&&n.copyToContext(r);for(var l=i.roundPixels,u=0;u<s.length;u++){var c=s[u],d=c.flipX||c.flipY,f=c.frame,p=f.canvasData,g=f.x,v=f.y,m=1,y=1,x=c.alpha*a;0!==x&&(r.globalAlpha=x,d?(c.flipX&&(m=-1,g-=p.width),c.flipY&&(y=-1,v-=p.height),p.width>0&&p.height>0&&(r.save(),r.translate(c.x+o,c.y+h),r.scale(m,y),r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g,v,p.width,p.height),r.restore())):(l&&(g=Math.round(g),v=Math.round(v)),p.width>0&&p.height>0&&r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g+c.x+o,v+c.y+h,p.width,p.height)))}r.restore()}}}),fF={renderWebGL:t,renderCanvas:cF}}(),e=WU(),i=Vh(),n=ac(),s=Zu(),r=ZF(),a=LU(),o=new i({Extends:r,Mixins:[n.Alpha,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Size,n.Texture,n.Transform,n.Visible,t],initialize:function(t,e,i,n,s){r.call(this,t,"Blitter"),this.setTexture(n,s),this.setPosition(e,i),this.initPipeline(),this.initPostPipeline(),this.children=new a,this.renderList=[],this.dirty=!1},create:function(t,i,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=this.children.length),void 0===n?n=this.frame:n instanceof s||(n=this.texture.get(n));var o=new e(this,t,i,n,r);return this.children.addAt(o,a,!1),this.dirty=!0,o},createFromCallback:function(t,e,i,n){for(var s=this.createMultiple(e,i,n),r=0;r<s.length;r++){var a=s[r];t.call(this,a,r)}return s},createMultiple:function(t,e,i){void 0===e&&(e=this.frame.name),void 0===i&&(i=!0),Array.isArray(e)||(e=[e]);var n=[],s=this;return e.forEach(function(e){for(var r=0;r<t;r++)n.push(s.create(0,0,e,i))}),n},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});return mF=o}function VU(){if(CF)return _F;CF=1;var t=Fu();return _F=function(e,i,n){void 0===n&&(n=new t);var s=Math.min(e.x,i.x),r=Math.min(e.y,i.y),a=Math.max(e.right,i.right)-s,o=Math.max(e.bottom,i.bottom)-r;return n.setTo(s,r,a,o)}}function jU(){if(PF)return AF;PF=1;var t=tu(),e=Qo(),i=Vh(),n=ac(),s=KF(),r=ZF(),a=Fu(),o=EF?SF:(EF=1,Hh(),wF||(wF=1,xF=function(t,e,i,n){i.addToRenderList(e);var s=e.list,r=s.length;if(0!==r){var a=e.localTransform;n?(a.loadIdentity(),a.multiply(n),a.translate(e.x,e.y),a.rotate(e.rotation),a.scale(e.scaleX,e.scaleY)):a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var h=e.alpha,l=e.scrollFactorX,u=e.scrollFactorY,c=0;c<r;c++){var d=s[c];if(d.willRender(i)){var f,p,g,v;if(void 0!==d.alphaTopLeft)f=d.alphaTopLeft,p=d.alphaTopRight,g=d.alphaBottomLeft,v=d.alphaBottomRight;else{var m=d.alpha;f=m,p=m,g=m,v=m}var y=d.scrollFactorX,x=d.scrollFactorY;o||d.blendMode===t.currentBlendMode||t.setBlendMode(d.blendMode);var w=d.mask;w&&w.preRenderWebGL(t,d,i);var T=d.type;T!==t.currentType&&(t.newType=!0,t.currentType=T),t.nextTypeMatch=c<r-1&&s[c+1].type===t.currentType,d.setScrollFactor(y*l,x*u),d.setAlpha(f*h,p*h,g*h,v*h),d.renderWebGL(t,d,i,a,e),d.setAlpha(f,p,g,v),d.setScrollFactor(y,x),w&&w.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),bF||(bF=1,TF=function(t,e,i,n){i.addToRenderList(e);var s=e.list;if(0!==s.length){var r=e.localTransform;n?(r.loadIdentity(),r.multiply(n),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var a=-1!==e.blendMode;a||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,l=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var u=0;u<s.length;u++){var c=s[u];if(c.willRender(i)){var d=c.alpha,f=c.scrollFactorX,p=c.scrollFactorY;a||c.blendMode===t.currentBlendMode||t.setBlendMode(c.blendMode),c.setScrollFactor(f*h,p*l),c.setAlpha(d*o),c.renderCanvas(t,c,i,r),c.setAlpha(d),c.setScrollFactor(f,p)}}e.mask&&e.mask.postRenderCanvas(t)}}),SF={renderWebGL:xF,renderCanvas:TF}),h=VU(),l=Ru(),u=new n.TransformMatrix,c=new i({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.ComputedSize,n.Depth,n.Mask,n.PostPipeline,n.Transform,n.Visible,o],initialize:function(t,i,s,a){r.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new n.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(i,s),this.setBlendMode(e.SKIP_CHECK),a&&this.add(a)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new a),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);t.setTo(e.x,e.y,0,0)}if(this.list.length>0){var i=this.list,n=new a,s=!1;t.setEmpty();for(var r=0;r<i.length;r++){var o=i[r];o.getBounds&&(o.getBounds(n),s?h(n,t,t):(t.setTo(n.x,n.y,n.width,n.height),s=!0))}}return t},addHandler:function(t){t.once(s.DESTROY,this.onChildDestroyed,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this,t.removeFromDisplayList(),t.addedToScene())},removeHandler:function(t){t.off(s.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer=null,t.removedFromScene(),t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new l),this.parentContainer?this.parentContainer.pointToContainer(t,e):(e.x=t.x,e.y=t.y);var i=u;return i.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),i.invert(),i.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(u,this.localTransform)},add:function(e){return t.Add(this.list,e,this.maxSize,this.addHandler,this),this},addAt:function(e,i){return t.AddAt(this.list,e,i,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(e,i){return e?(void 0===i&&(i=function(t,i){return t[e]-i[e]}),t.StableSort(this.list,i),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i,n,s){return t.CountAllMatching(this.list,e,i,n,s)},swap:function(e,i){return t.Swap(this.list,e,i),this},moveTo:function(e,i){return t.MoveTo(this.list,e,i),this},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i),this},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i),this},remove:function(e,i){var n=t.Remove(this.list,e,this.removeHandler,this);if(i&&n){Array.isArray(n)||(n=[n]);for(var s=0;s<n.length;s++)n[s].destroy()}return this},removeAt:function(e,i){var n=t.RemoveAt(this.list,e,this.removeHandler,this);return i&&n&&n.destroy(),this},removeBetween:function(e,i,n){var s=t.RemoveBetween(this.list,e,i,this.removeHandler,this);if(n)for(var r=0;r<s.length;r++)s[r].destroy();return this},removeAll:function(e){var i=this.list;if(e){for(var n=0;n<i.length;n++)i[n]&&i[n].scene&&(i[n].off(s.DESTROY,this.onChildDestroyed,this),i[n].destroy());this.list=[]}else t.RemoveBetween(i,0,i.length,this.removeHandler,this);return this},bringToTop:function(e){return t.BringToTop(this.list,e),this},sendToBack:function(e){return t.SendToBack(this.list,e),this},moveUp:function(e){return t.MoveUp(this.list,e),this},moveDown:function(e){return t.MoveDown(this.list,e),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i,n){return t.Replace(this.list,e,i)&&(this.addHandler(i),this.removeHandler(e),n&&e.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){var i,n=[null],s=this.list.slice(),r=s.length;for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<r;i++)n[0]=s[i],t.apply(e,n);return this},iterate:function(t,e){var i,n=[null];for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(e,i,n){return void 0===i&&(i=e),void 0===n&&(n=!1),this.scrollFactorX=e,this.scrollFactorY=i,n&&(t.SetAll(this.list,"scrollFactorX",e),t.SetAll(this.list,"scrollFactorY",i)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(e){t.Remove(this.list,e),this.exclusive&&(e.parentContainer=null,e.removedFromScene())}});return AF=c}function qU(){if(OF)return LF;OF=1;var t=RF?MF:(RF=1,MF=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]),e=ZF(),i=tc(),n=new i,s=new i,r=new i;return LF=function(i,a,o,h){if(a.node){var l=a.node.style,u=a.scene.sys.settings;if(!l||!u.visible||e.RENDER_MASK!==a.renderFlags||0!==a.cameraFilter&&a.cameraFilter&o.id||a.parentContainer&&!a.parentContainer.willRender())l.display="none";else{var c=a.parentContainer,d=o.alpha*a.alpha;c&&(d*=c.alpha);var f=n,p=s,g=r,v=0,m=0,y="0%",x="0%";h?(v=a.width*a.scaleX*a.originX,m=a.height*a.scaleY*a.originY,p.applyITRS(a.x-v,a.y-m,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),f.multiplyWithOffset(h,-o.scrollX*a.scrollFactorX,-o.scrollY*a.scrollFactorY),p.e=a.x-v,p.f=a.y-m,f.multiply(p,g)):(v=a.width*a.originX,m=a.height*a.originY,p.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),y=100*a.originX+"%",x=100*a.originY+"%",p.e-=o.scrollX*a.scrollFactorX,p.f-=o.scrollY*a.scrollFactorY,f.multiply(p,g),g.e-=v,g.f-=m),a.transformOnly||(l.display="block",l.opacity=d,l.zIndex=a._depth,l.pointerEvents=a.pointerEvents,l.mixBlendMode=t[a._blendMode]),l.transform=g.getCSSMatrix()+" skew("+a.skewX+"rad, "+a.skewY+"rad) rotate3d("+a.rotate3d.x+","+a.rotate3d.y+","+a.rotate3d.z+","+a.rotate3d.w+a.rotate3dAngle+")",l.transformOrigin=y+" "+x}}}}function KU(){if(kF)return IF;kF=1;var t=Vh(),e=ac(),i=function(){if(DF)return FF;DF=1;var t,e;Hh();return t=qU(),e=qU(),FF={renderWebGL:t,renderCanvas:e}}(),n=ZF(),s=ih(),r=WN(),a=Bu(),o=Ok(),h=new t({Extends:n,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Origin,e.ScrollFactor,e.Transform,e.Visible,i],initialize:function(t,e,i,s,r,h){if(n.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,!this.parent)throw new Error("No DOM Container set in game config");this.cache=t.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new o,this.rotate3dAngle="deg",this.pointerEvents="auto",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,i),"string"==typeof s?"#"===s[0]?this.setElement(s.substr(1),r,h):this.createElement(s,r,h):s&&this.setElement(s,r,h),t.sys.events.on(a.SLEEP,this.handleSceneEvent,this),t.sys.events.on(a.WAKE,this.handleSceneEvent,this),t.sys.events.on(a.PRE_RENDER,this.preRender,this)},handleSceneEvent:function(t){var e=this.node,i=e.style;e&&(i.display=t.settings.visible?"block":"none")},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,i){return this.setElement(document.createElement(t),e,i)},setElement:function(t,e,i){var n;if(this.removeElement(),"string"==typeof t?("#"===t[0]&&(t=t.substr(1)),n=document.getElementById(t)):"object"==typeof t&&1===t.nodeType&&(n=t),!n)return this;if(this.node=n,e&&s(e))for(var r in e)n.style[r]=e[r];else"string"==typeof e&&(n.style=e);return n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent.appendChild(n),i&&(n.innerText=i),this.updateSize()},createFromCache:function(t,e){var i=this.cache.get(t);return i&&this.createFromHTML(i,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var i=document.createElement(e);return this.node=i,i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent.appendChild(i),i.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(r(this.node),this.node=null),this},updateSize:function(){var t=this.node;return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=this.width*this.scaleX,this.displayHeight=this.height*this.scaleY,this},getChildByProperty:function(t,e){if(this.node)for(var i=this.node.querySelectorAll("*"),n=0;n<i.length;n++)if(i[n][t]===e)return i[n];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preRender:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(a.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(a.WAKE,this.handleSceneEvent,this),this.scene.sys.events.off(a.PRE_RENDER,this.preRender,this)}});return IF=h}function ZU(){if(WF)return GF;WF=1;var t=GU(),e=Vh(),i=function(){if(XF)return YF;XF=1;var t,e;Hh();return t=function(){if(NF)return BF;NF=1;var t=kU(),e=tc(),i=Zk(),n=new e;return BF=function(e,s,r,a){var o=s.text,h=o.length;if(0!==h){r.addToRenderList(s);var l=e.pipelines.set(s.pipeline,s),u=t(s,r,a);e.pipelines.preBatch(s);var c=u.sprite,d=u.calc,f=n,p=s.cropWidth>0||s.cropHeight>0;p&&(l.flush(),e.pushScissor(d.tx,d.ty,s.cropWidth*d.scaleX,s.cropHeight*d.scaleY));var g,v,m=s.frame.glTexture,y=s.tintFill,x=i.getTintAppendFloatAlpha(s.tintTopLeft,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(s.tintTopRight,r.alpha*s._alphaTR),T=i.getTintAppendFloatAlpha(s.tintBottomLeft,r.alpha*s._alphaBL),b=i.getTintAppendFloatAlpha(s.tintBottomRight,r.alpha*s._alphaBR),S=l.setGameObject(s),E=0,_=0,C=0,A=0,P=s.letterSpacing,M=0,R=0,L=s.scrollX,O=s.scrollY,F=s.fontData,D=F.chars,I=F.lineHeight,k=s.fontSize/F.size,B=0,N=s._align,U=0,z=0,Y=s.getTextBounds(!1);s.maxWidth>0&&(h=(o=Y.wrappedText).length);var X=s._bounds.lines;1===N?z=(X.longest-X.lengths[0])/2:2===N&&(z=X.longest-X.lengths[0]);for(var G=r.roundPixels,W=s.displayCallback,H=s.callbackData,V=0;V<h;V++)if(10!==(C=o.charCodeAt(V))){if(g=D[C]){M=g.width,R=g.height;var j=g.xOffset+E-L,q=g.yOffset+_-O;if(null!==v){var K=g.kerning[A]||0;j+=K,E+=K}if(E+=g.xAdvance+P,v=g,A=C,0!==M&&0!==R&&32!==C){if(k=s.fontSize/s.fontData.size,B=0,W){H.color=0,H.tint.topLeft=x,H.tint.topRight=w,H.tint.bottomLeft=T,H.tint.bottomRight=b,H.index=V,H.charCode=C,H.x=j,H.y=q,H.scale=k,H.rotation=B,H.data=g.data;var Z=W(H);j=Z.x,q=Z.y,k=Z.scale,B=Z.rotation,Z.color?(x=Z.color,w=Z.color,T=Z.color,b=Z.color):(x=Z.tint.topLeft,w=Z.tint.topRight,T=Z.tint.bottomLeft,b=Z.tint.bottomRight),x=i.getTintAppendFloatAlpha(x,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(w,r.alpha*s._alphaTR),T=i.getTintAppendFloatAlpha(T,r.alpha*s._alphaBL),b=i.getTintAppendFloatAlpha(b,r.alpha*s._alphaBR)}j*=k,q*=k,j-=s.displayOriginX,q-=s.displayOriginY,j+=z,f.applyITRS(j,q,B,k,k),d.multiply(f,c);var J=g.u0,$=g.v0,Q=g.u1,tt=g.v1,et=M,it=R,nt=c.e,st=c.f,rt=it*c.c+c.e,at=it*c.d+c.f,ot=et*c.a+it*c.c+c.e,ht=et*c.b+it*c.d+c.f,lt=et*c.a+c.e,ut=et*c.b+c.f;G&&(nt=Math.round(nt),st=Math.round(st),rt=Math.round(rt),at=Math.round(at),ot=Math.round(ot),ht=Math.round(ht),lt=Math.round(lt),ut=Math.round(ut)),l.shouldFlush(6)&&(l.flush(),S=l.setGameObject(s)),l.batchQuad(s,nt,st,rt,at,ot,ht,lt,ut,J,$,Q,tt,x,w,T,b,y,m,S)}}}else U++,1===N?z=(X.longest-X.lengths[U])/2:2===N&&(z=X.longest-X.lengths[U]),E=0,_+=I,v=null;p&&(l.flush(),e.popScissor()),e.pipelines.postBatch(s)}},BF}(),e=function(){if(zF)return UF;zF=1;var t=YU();return UF=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.displayCallback,u=i.callbackData,c=i.fontData.chars,d=i.fontData.lineHeight,f=i._letterSpacing,p=0,g=0,v=0,m=null,y=0,x=0,w=0,T=0,b=0,S=0,E=null,_=0,C=i.frame.source.image,A=h.cutX,P=h.cutY,M=0,R=0,L=i._fontSize/i.fontData.size,O=i._align,F=0,D=0;i.getTextBounds(!1);var I=i._bounds.lines;1===O?D=(I.longest-I.lengths[0])/2:2===O&&(D=I.longest-I.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);var k=n.roundPixels;i.cropWidth>0&&i.cropHeight>0&&(o.beginPath(),o.rect(0,0,i.cropWidth,i.cropHeight),o.clip());for(var B=0;B<a;B++)if(R=L,M=0,10!==(v=r.charCodeAt(B))){if(m=c[v]){if(y=A+m.x,x=P+m.y,w=m.width,T=m.height,b=m.xOffset+p-i.scrollX,S=m.yOffset+g-i.scrollY,null!==E){var N=m.kerning[_];b+=void 0!==N?N:0}if(l){u.index=B,u.charCode=v,u.x=b,u.y=S,u.scale=R,u.rotation=M,u.data=m.data;var U=l(u);b=U.x,S=U.y,R=U.scale,M=U.rotation}b*=R,S*=R,b+=D,p+=m.xAdvance+f+(void 0!==N?N:0),E=m,_=v,0!==w&&0!==T&&32!==v&&(k&&(b=Math.round(b),S=Math.round(S)),o.save(),o.translate(b,S),o.rotate(M),o.scale(R,R),o.drawImage(C,y,x,w,T,0,0,w,T),o.restore())}}else F++,1===O?D=(I.longest-I.lengths[F])/2:2===O&&(D=I.longest-I.lengths[F]),p=0,g+=d,E=null;o.restore()}},UF}(),YF={renderWebGL:t,renderCanvas:e}}(),n=new e({Extends:t,Mixins:[i],initialize:function(e,i,n,s,r,a,o){t.call(this,e,i,n,s,r,a,o),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});return GF=n}var JU,$U,QU,tz,ez,iz,nz,sz,rz,az,oz,hz,lz,uz,cz,dz,fz,pz,gz,vz,mz,yz,xz,wz,Tz,bz,Sz,Ez,_z,Cz,Az,Pz,Mz,Rz,Lz,Oz,Fz,Dz,Iz,kz,Bz,Nz,Uz,zz,Yz,Xz,Gz,Wz,Hz,Vz,jz,qz,Kz,Zz,Jz,$z,Qz,tY,eY,iY,nY,sY,rY,aY,oY,hY,lY,uY,cY,dY,fY,pY,gY,vY,mY,yY,xY,wY,TY,bY,SY,EY,_Y,CY,AY,PY,MY,RY,LY,OY,FY,DY,IY,kY,BY,NY,UY,zY,YY,XY,GY,WY,HY,VY,jY,qY,KY,ZY,JY,$Y,QY,tX,eX,iX,nX,sX,rX,aX,oX,hX,lX,uX,cX,dX,fX,pX,gX,vX,mX,yX,xX,wX,TX,bX,SX,EX,_X,CX,AX,PX,MX,RX,LX,OX,FX,DX,IX,kX,BX,NX,UX,zX,YX,XX,GX,WX,HX,VX,jX,qX,KX,ZX,JX,$X,QX,tG,eG,iG,nG,sG,rG,aG,oG,hG,lG,uG,cG,dG,fG,pG,gG,vG,mG,yG,xG,wG,TG,bG,SG,EG,_G,CG,AG,PG,MG,RG,LG,OG,FG,DG,IG,kG,BG,NG,UG,zG,YG,XG,GG,WG,HG,VG,jG,qG,KG,ZG,JG,$G,QG,tW,eW,iW,nW,sW,rW,aW,oW,hW,lW,uW,cW,dW,fW,pW,gW,vW,mW,yW,xW,wW,TW,bW,SW,EW,_W,CW,AW,PW,MW,RW,LW,OW,FW,DW,IW,kW,BW,NW,UW,zW,YW,XW,GW,WW,HW,VW,jW,qW,KW,ZW,JW,$W,QW,tH,eH,iH,nH,sH,rH,aH,oH,hH,lH,uH,cH,dH,fH,pH,gH,vH,mH,yH,xH,wH,TH,bH,SH,EH,_H,CH,AH,PH,MH,RH,LH,OH,FH,DH,IH,kH,BH,NH,UH,zH,YH,XH,GH,WH,HH,VH,jH,qH,KH,ZH,JH={};function $H(){if(tz)return QU;tz=1;var t=Vh(),e=ac(),i=ZF(),n=function(){if($U)return JU;$U=1;var t;Hh();return t=function(){if(VF)return HF;VF=1;var t=kU();return HF=function(e,i,n,s){e.pipelines.clear();var r=t(i,n,s).calc;i.render.call(i,e,n,r),e.pipelines.rebind()},HF}(),JU={renderWebGL:t,renderCanvas:JH}}(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.Origin,e.ScrollFactor,e.Size,e.Texture,e.Tint,e.Transform,e.Visible,n],initialize:function(t){i.call(this,t,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});return QU=s}function QH(){return iz?ez:(iz=1,ez={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22})}function tV(){return sz||(sz=1,nz=function(t,e,i){if(t.width<=0||t.height<=0)return!1;var n=(e-t.x)/t.width,s=(i-t.y)/t.height;return(n*=n)+(s*=s)<.25}),nz}function eV(){if(az)return rz;az=1;var t=Kh();return rz=function(e,i,n){void 0===n&&(n=new t);var s=e.width/2,r=e.height/2;return n.x=e.x+s*Math.cos(i),n.y=e.y+r*Math.sin(i),n},rz}function iV(){if(hz)return oz;hz=1;var t=eV(),e=$h(),i=Qh(),n=Kh();return oz=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},oz}function nV(){return uz||(uz=1,lz=function(t){var e=t.width/2,i=t.height/2,n=Math.pow(e-i,2)/Math.pow(e+i,2);return Math.PI*(e+i)*(1+3*n/(10+Math.sqrt(4-3*n)))}),lz}function sV(){if(dz)return cz;dz=1;var t=nV(),e=eV(),i=$h(),n=Qh();return cz=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},cz}function rV(){if(pz)return fz;pz=1;var t=Vh(),e=tV(),i=iV(),n=sV(),s=qh(),r=AD(),a=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.ELLIPSE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return fz=a}function aV(){if(yz)return mz;yz=1;var t=QH(),e=YU();return mz=function(i,n,s,r,a,o){var h=n.commandBuffer,l=h.length,u=a||i.currentContext;if(0!==l&&e(i,u,n,s,r)){s.addToRenderList(n);var c=1,d=1,f=0,p=0,g=1,v=0,m=0,y=0;u.beginPath();for(var x=0;x<l;++x)switch(h[x]){case t.ARC:u.arc(h[x+1],h[x+2],h[x+3],h[x+4],h[x+5],h[x+6]),x+=7;break;case t.LINE_STYLE:g=h[x+1],f=h[x+2],c=h[x+3],v=(16711680&f)>>>16,m=(65280&f)>>>8,y=255&f,u.strokeStyle="rgba("+v+","+m+","+y+","+c+")",u.lineWidth=g,x+=3;break;case t.FILL_STYLE:p=h[x+1],d=h[x+2],v=(16711680&p)>>>16,m=(65280&p)>>>8,y=255&p,u.fillStyle="rgba("+v+","+m+","+y+","+d+")",x+=2;break;case t.BEGIN_PATH:u.beginPath();break;case t.CLOSE_PATH:u.closePath();break;case t.FILL_PATH:o||u.fill();break;case t.STROKE_PATH:o||u.stroke();break;case t.FILL_RECT:o?u.rect(h[x+1],h[x+2],h[x+3],h[x+4]):u.fillRect(h[x+1],h[x+2],h[x+3],h[x+4]),x+=4;break;case t.FILL_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.fill(),x+=6;break;case t.STROKE_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.stroke(),x+=6;break;case t.LINE_TO:u.lineTo(h[x+1],h[x+2]),x+=2;break;case t.MOVE_TO:u.moveTo(h[x+1],h[x+2]),x+=2;break;case t.LINE_FX_TO:u.lineTo(h[x+1],h[x+2]),x+=5;break;case t.MOVE_FX_TO:u.moveTo(h[x+1],h[x+2]),x+=5;break;case t.SAVE:u.save();break;case t.RESTORE:u.restore();break;case t.TRANSLATE:u.translate(h[x+1],h[x+2]),x+=2;break;case t.SCALE:u.scale(h[x+1],h[x+2]),x+=2;break;case t.ROTATE:u.rotate(h[x+1]),x+=1;break;case t.GRADIENT_FILL_STYLE:x+=5;break;case t.GRADIENT_LINE_STYLE:x+=6}u.restore()}},mz}function oV(){if(bz)return Tz;bz=1;var t=II(),e=Vh(),i=QH(),n=ac(),s=rV(),r=ZF(),a=Wh(),o=Ol(),h=Qh(),l=function(){if(wz)return xz;wz=1;var t,e;Hh();return t=function(){if(vz)return gz;vz=1;var t=QH(),e=kU(),i=tc(),n=Zk(),s=function(t,e,i){this.x=t,this.y=e,this.width=i},r=function(t,e,i){this.points=[],this.pointsLength=1,this.points[0]=new s(t,e,i)},a=[],o=new i;return gz=function(i,h,l,u){if(0!==h.commandBuffer.length){l.addToRenderList(h);var c=i.pipelines.set(h.pipeline,h);i.pipelines.preBatch(h);for(var d=e(h,l,u).calc,f=o.loadIdentity(),p=h.commandBuffer,g=l.alpha*h.alpha,v=1,m=c.fillTint,y=c.strokeTint,x=0,w=0,T=0,b=2*Math.PI,S=[],E=0,_=!0,C=null,A=n.getTintAppendFloatAlpha,P=0;P<p.length;P++)switch(p[P]){case t.BEGIN_PATH:S.length=0,C=null,_=!0;break;case t.CLOSE_PATH:_=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case t.FILL_PATH:for(E=0;E<S.length;E++)c.batchFillPath(S[E].points,f,d);break;case t.STROKE_PATH:for(E=0;E<S.length;E++)c.batchStrokePath(S[E].points,v,_,f,d);break;case t.LINE_STYLE:v=p[++P];var M=A(p[++P],p[++P]*g);y.TL=M,y.TR=M,y.BL=M,y.BR=M;break;case t.FILL_STYLE:var R=A(p[++P],p[++P]*g);m.TL=R,m.TR=R,m.BL=R,m.BR=R;break;case t.GRADIENT_FILL_STYLE:var L=p[++P]*g,O=p[++P]*g,F=p[++P]*g,D=p[++P]*g;m.TL=A(p[++P],L),m.TR=A(p[++P],O),m.BL=A(p[++P],F),m.BR=A(p[++P],D);break;case t.GRADIENT_LINE_STYLE:v=p[++P];var I=p[++P]*g;y.TL=A(p[++P],I),y.TR=A(p[++P],I),y.BL=A(p[++P],I),y.BR=A(p[++P],I);break;case t.ARC:var k=0,B=p[++P],N=p[++P],U=p[++P],z=p[++P],Y=p[++P],X=p[++P],G=p[++P];for(Y-=z,X?Y<-b?Y=-b:Y>0&&(Y=Y%b-b):Y>b?Y=b:Y<0&&(Y=b+Y%b),null===C&&(C=new r(B+Math.cos(z)*U,N+Math.sin(z)*U,v),S.push(C),k+=.01);k<1+G;)T=Y*k+z,x=B+Math.cos(T)*U,w=N+Math.sin(T)*U,C.points.push(new s(x,w,v)),k+=.01;T=Y+z,x=B+Math.cos(T)*U,w=N+Math.sin(T)*U,C.points.push(new s(x,w,v));break;case t.FILL_RECT:c.batchFillRect(p[++P],p[++P],p[++P],p[++P],f,d);break;case t.FILL_TRIANGLE:c.batchFillTriangle(p[++P],p[++P],p[++P],p[++P],p[++P],p[++P],f,d);break;case t.STROKE_TRIANGLE:c.batchStrokeTriangle(p[++P],p[++P],p[++P],p[++P],p[++P],p[++P],v,f,d);break;case t.LINE_TO:null!==C?C.points.push(new s(p[++P],p[++P],v)):(C=new r(p[++P],p[++P],v),S.push(C));break;case t.MOVE_TO:C=new r(p[++P],p[++P],v),S.push(C);break;case t.SAVE:a.push(f.copyToArray());break;case t.RESTORE:f.copyFromArray(a.pop());break;case t.TRANSLATE:B=p[++P],N=p[++P],f.translate(B,N);break;case t.SCALE:B=p[++P],N=p[++P],f.scale(B,N);break;case t.ROTATE:f.rotate(p[++P])}i.pipelines.postBatch(h)}},gz}(),aV(),e=aV(),xz={renderWebGL:t,renderCanvas:e}}(),u=new e({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.Transform,n.Visible,n.ScrollFactor,l],initialize:function(t,e){var i=o(e,"x",0),n=o(e,"y",0);r.call(this,t,"Graphics"),this.setPosition(i,n),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(e)},setDefaultStyles:function(t){return o(t,"lineStyle",null)&&(this.defaultStrokeWidth=o(t,"lineStyle.width",1),this.defaultStrokeColor=o(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=o(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),o(t,"fillStyle",null)&&(this.defaultFillColor=o(t,"fillStyle.color",16777215),this.defaultFillAlpha=o(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(i.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(i.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,s,r,a,o,h){return void 0===r&&(r=1),void 0===a&&(a=r),void 0===o&&(o=r),void 0===h&&(h=r),this.commandBuffer.push(i.GRADIENT_FILL_STYLE,r,a,o,h,t,e,n,s),this},lineGradientStyle:function(t,e,n,s,r,a){return void 0===a&&(a=1),this.commandBuffer.push(i.GRADIENT_LINE_STYLE,t,a,e,n,s,r),this},beginPath:function(){return this.commandBuffer.push(i.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(i.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(i.FILL_PATH),this},fill:function(){return this.commandBuffer.push(i.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(i.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(i.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.fillPath(),this},strokeCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,s){return this.commandBuffer.push(i.FILL_RECT,t,e,n,s),this},strokeRect:function(t,e,i,n){var s=this._lineWidth/2,r=t-s,a=t+s;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+n),this.strokePath(),this.beginPath(),this.moveTo(t+i,e),this.lineTo(t+i,e+n),this.strokePath(),this.beginPath(),this.moveTo(r,e),this.lineTo(a+i,e),this.strokePath(),this.beginPath(),this.moveTo(r,e+n),this.lineTo(a+i,e+n),this.strokePath(),this},fillRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var c=r>=0,d=o>=0,f=l>=0,p=u>=0;return r=Math.abs(r),o=Math.abs(o),l=Math.abs(l),u=Math.abs(u),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),d?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),p?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),f?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),c?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s,c=Math.min(i,n)/2;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var d=r>=0,f=o>=0,p=l>=0,g=u>=0;return r=Math.min(Math.abs(r),c),o=Math.min(Math.abs(o),c),l=Math.min(Math.abs(l),c),u=Math.min(Math.abs(u),c),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),this.moveTo(t+i-o,e),f?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),this.moveTo(t+i,e+n-u),g?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),this.moveTo(t+l,e+n),p?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),this.moveTo(t,e+r),d?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(i.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.FILL_TRIANGLE,t,e,n,s,r,a),this},strokeTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.STROKE_TRIANGLE,t,e,n,s,r,a),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,i,n){return this.beginPath(),this.moveTo(t,e),this.lineTo(i,n),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(i.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(i.MOVE_TO,t,e),this},strokePoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.strokePoints(i,!0)},strokeEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.strokePoints(a,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.fillPoints(i,!0)},fillEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.fillPoints(a,!0)},arc:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this},slice:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.BEGIN_PATH),this.commandBuffer.push(i.MOVE_TO,t,e),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this.commandBuffer.push(i.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(i.SAVE),this},restore:function(){return this.commandBuffer.push(i.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(i.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(i.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(i.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,i){var n,s,r=this.scene.sys,a=r.game.renderer;void 0===e&&(e=r.scale.width),void 0===i&&(i=r.scale.height),u.TargetCamera.setScene(this.scene),u.TargetCamera.setViewport(0,0,e,i),u.TargetCamera.scrollX=this.x,u.TargetCamera.scrollY=this.y;var o={willReadFrequently:!0};if("string"==typeof t)if(r.textures.exists(t)){var h=(n=r.textures.get(t)).getSourceImage();h instanceof HTMLCanvasElement&&(s=h.getContext("2d",o))}else s=(n=r.textures.createCanvas(t,e,i)).getSourceImage().getContext("2d",o);else t instanceof HTMLCanvasElement&&(s=t.getContext("2d",o));return s&&(this.renderCanvas(a,this,u.TargetCamera,null,s,!1),n&&n.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});return u.TargetCamera=new t,Tz=u}function hV(){return Ez?Sz:(Ez=1,Sz=function(t,e){return t.hasOwnProperty(e)})}function lV(){if(Cz)return _z;Cz=1;var t=new(Vh())({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var i=0;i<this.entries.length;i++){var n=this.entries[i];if(n[t]===e)return n}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var i,n=this.entries.slice(),s=n.length;if(e)for(i=0;i<s&&!1!==t.call(e,n[i],i);i++);else for(i=0;i<s&&!1!==t(n[i],i);i++);return this},iterate:function(t,e){var i,n=this.entries.length;if(e)for(i=0;i<n&&!1!==t.call(e,this.entries[i],i);i++);else for(i=0;i<n&&!1!==t(this.entries[i],i);i++);return this},iterateLocal:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var n=this.entries.length;for(e=0;e<n;e++){var s=this.entries[e];s[t].apply(s,i)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(e){var i=new t;return e.entries.forEach(function(t){i.set(t)}),this.entries.forEach(function(t){i.set(t)}),i},intersect:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)&&i.set(t)}),i},difference:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)||i.set(t)}),i},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});return _z=t}function uV(){if(Dz)return Fz;Dz=1;var t=mI(),e=Vh(),i=ac(),n=ZF(),s=function(){if(Oz)return Lz;Oz=1;var t;Hh();return t=Pz?Az:(Pz=1,Az=function(t,e,i,n){i.addToRenderList(e),e.pipeline.batchSprite(e,i,n)}),Rz||(Rz=1,Mz=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),Lz={renderWebGL:t,renderCanvas:Mz}}(),r=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Size,i.TextureCrop,i.Tint,i.Transform,i.Visible,s],initialize:function(e,i,s,r,a){n.call(this,e,"Sprite"),this._crop=this.resetCropObject(),this.anims=new t(this),this.setTexture(r,a),this.setPosition(i,s),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return i.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});return Fz=r}function cV(){if(kz)return Iz;kz=1;var t=lI(),e=Vh(),i=KF(),n=qF(),s=_l(),r=Wh(),a=Ol(),o=hV(),h=ih(),l=Dl(),u=lV(),c=uV(),d=new e({Extends:n,initialize:function(t,e,s){n.call(this),s?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?h(e[0])&&(s=e,e=null):h(e)&&(s=e,e=null),this.scene=t,this.children=new u,this.isParent=!0,this.type="Group",this.classType=r(s,"classType",c),this.name=r(s,"name",""),this.active=r(s,"active",!0),this.maxSize=r(s,"maxSize",-1),this.defaultKey=r(s,"defaultKey",null),this.defaultFrame=r(s,"defaultFrame",null),this.runChildUpdate=r(s,"runChildUpdate",!1),this.createCallback=r(s,"createCallback",null),this.removeCallback=r(s,"removeCallback",null),this.createMultipleCallback=r(s,"createMultipleCallback",null),this.internalCreateCallback=r(s,"internalCreateCallback",null),this.internalRemoveCallback=r(s,"internalRemoveCallback",null),e&&this.addMultiple(e),s&&this.createMultiple(s),this.on(i.ADDED_TO_SCENE,this.addedToScene,this),this.on(i.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,i,n,s,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.defaultKey),void 0===n&&(n=this.defaultFrame),void 0===s&&(s=!0),void 0===r&&(r=!0),this.isFull())return null;var a=new this.classType(this.scene,t,e,i,n);return a.addToDisplayList(this.scene.sys.displayList),a.addToUpdateList(),a.visible=s,a.setActive(r),this.add(a),a},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var i=0;i<t.length;i++){var n=this.createFromConfig(t[i]);e=e.concat(n)}return e},createFromConfig:function(e){if(this.isFull())return[];this.classType=r(e,"classType",this.classType);var i=r(e,"key",void 0),n=r(e,"frame",null),s=r(e,"visible",!0),h=r(e,"active",!0),u=[];if(void 0===i)return u;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);var c=r(e,"repeat",0),d=r(e,"randomKey",!1),f=r(e,"randomFrame",!1),p=r(e,"yoyo",!1),g=r(e,"quantity",!1),v=r(e,"frameQuantity",1),m=r(e,"max",0),y=l(i,n,{max:m,qty:g||v,random:d,randomB:f,repeat:c,yoyo:p});e.createCallback&&(this.createCallback=e.createCallback),e.removeCallback&&(this.removeCallback=e.removeCallback),e.internalCreateCallback&&(this.internalCreateCallback=e.internalCreateCallback),e.internalRemoveCallback&&(this.internalRemoveCallback=e.internalRemoveCallback);for(var x=0;x<y.length;x++){var w=this.create(0,0,y[x].a,y[x].b,s,h);if(!w)break;u.push(w)}if(o(e,"setXY")){var T=a(e,"setXY.x",0),b=a(e,"setXY.y",0),S=a(e,"setXY.stepX",0),E=a(e,"setXY.stepY",0);t.SetXY(u,T,b,S,E)}if(o(e,"setRotation")){var _=a(e,"setRotation.value",0),C=a(e,"setRotation.step",0);t.SetRotation(u,_,C)}if(o(e,"setScale")){var A=a(e,"setScale.x",1),P=a(e,"setScale.y",A),M=a(e,"setScale.stepX",0),R=a(e,"setScale.stepY",0);t.SetScale(u,A,P,M,R)}if(o(e,"setOrigin")){var L=a(e,"setOrigin.x",.5),O=a(e,"setOrigin.y",L),F=a(e,"setOrigin.stepX",0),D=a(e,"setOrigin.stepY",0);t.SetOrigin(u,L,O,F,D)}if(o(e,"setAlpha")){var I=a(e,"setAlpha.value",1),k=a(e,"setAlpha.step",0);t.SetAlpha(u,I,k)}if(o(e,"setDepth")){var B=a(e,"setDepth.value",0),N=a(e,"setDepth.step",0);t.SetDepth(u,B,N)}if(o(e,"setScrollFactor")){var U=a(e,"setScrollFactor.x",1),z=a(e,"setScrollFactor.y",U),Y=a(e,"setScrollFactor.stepX",0),X=a(e,"setScrollFactor.stepY",0);t.SetScrollFactor(u,U,z,Y,X)}var G=r(e,"hitArea",null),W=r(e,"hitAreaCallback",null);G&&t.SetHitArea(u,G,W);var H=r(e,"gridAlign",!1);return H&&t.GridAlign(u,H),this.createMultipleCallback&&this.createMultipleCallback.call(this,u),u},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var i=this.children.entries.slice(),n=0;n<i.length;n++){var s=i[n];s.active&&s.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(i.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(i.DESTROY,this.remove,this),n?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,s=0;s<n.size;s++){var r=n.entries[s];r.off(i.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,i,n){return s(this.children.entries,t,e,i,n)},getFirst:function(t,e,i,n,s,r,a){return this.getHandler(!0,1,t,e,i,n,s,r,a)},getFirstNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!0,t,e,i,n,s,r,a,o)},getLast:function(t,e,i,n,s,r,a){return this.getHandler(!1,1,t,e,i,n,s,r,a)},getLastNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!1,t,e,i,n,s,r,a,o)},getHandler:function(t,e,i,n,s,r,a,o,h){var l,u;void 0===i&&(i=!1),void 0===n&&(n=!1);var c=0,d=this.children.entries;if(t)for(u=0;u<d.length;u++)if((l=d[u]).active===i){if(++c===e)break}else l=null;else for(u=d.length-1;u>=0;u--)if((l=d[u]).active===i){if(++c===e)break}else l=null;return l?("number"==typeof s&&(l.x=s),"number"==typeof r&&(l.y=r),l):n?this.create(s,r,a,o,h):null},get:function(t,e,i,n,s){return this.getFirst(!1,!0,t,e,i,n,s)},getFirstAlive:function(t,e,i,n,s,r){return this.getFirst(!0,t,e,i,n,s,r)},getFirstDead:function(t,e,i,n,s,r){return this.getFirst(!1,t,e,i,n,s,r)},playAnimation:function(e,i){return t.PlayAnimation(this.children.entries,e,i),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,i=0;i<this.children.size;i++)this.children.entries[i].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(e,i,n,s,r){return t.PropertyValueSet(this.children.entries,e,i,n,s,r),this},propertyValueInc:function(e,i,n,s,r){return t.PropertyValueInc(this.children.entries,e,i,n,s,r),this},setX:function(e,i){return t.SetX(this.children.entries,e,i),this},setY:function(e,i){return t.SetY(this.children.entries,e,i),this},setXY:function(e,i,n,s){return t.SetXY(this.children.entries,e,i,n,s),this},incX:function(e,i){return t.IncX(this.children.entries,e,i),this},incY:function(e,i){return t.IncY(this.children.entries,e,i),this},incXY:function(e,i,n,s){return t.IncXY(this.children.entries,e,i,n,s),this},shiftPosition:function(e,i,n){return t.ShiftPosition(this.children.entries,e,i,n),this},angle:function(e,i){return t.Angle(this.children.entries,e,i),this},rotate:function(e,i){return t.Rotate(this.children.entries,e,i),this},rotateAround:function(e,i){return t.RotateAround(this.children.entries,e,i),this},rotateAroundDistance:function(e,i,n){return t.RotateAroundDistance(this.children.entries,e,i,n),this},setAlpha:function(e,i){return t.SetAlpha(this.children.entries,e,i),this},setTint:function(e,i,n,s){return t.SetTint(this.children.entries,e,i,n,s),this},setOrigin:function(e,i,n,s){return t.SetOrigin(this.children.entries,e,i,n,s),this},scaleX:function(e,i){return t.ScaleX(this.children.entries,e,i),this},scaleY:function(e,i){return t.ScaleY(this.children.entries,e,i),this},scaleXY:function(e,i,n,s){return t.ScaleXY(this.children.entries,e,i,n,s),this},setDepth:function(e,i){return t.SetDepth(this.children.entries,e,i),this},setBlendMode:function(e){return t.SetBlendMode(this.children.entries,e),this},setHitArea:function(e,i){return t.SetHitArea(this.children.entries,e,i),this},shuffle:function(){return t.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(e,i,n){return t.SetVisible(this.children.entries,e,i,n),this},toggleVisible:function(){return t.ToggleVisible(this.children.entries),this},destroy:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.scene&&!this.ignoreDestroy&&(this.emit(i.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});return Iz=d}function dV(){if(Wz)return Gz;Wz=1;var t=Qo(),e=Vh(),i=ac(),n=Qu(),s=hc(),r=qF(),a=KF(),o=LU(),h=Xz?Yz:(Xz=1,Hh(),Nz||(Nz=1,Bz=function(t,e,i){var n=e.list,s=n.length;if(0!==s){e.depthSort(),t.pipelines.preBatch(e);var r=-1!==e.blendMode;r||t.setBlendMode(0);for(var a=e.alpha,o=0;o<s;o++){var h=n[o];if(h.willRender(i)){var l,u,c,d;if(void 0!==h.alphaTopLeft)l=h.alphaTopLeft,u=h.alphaTopRight,c=h.alphaBottomLeft,d=h.alphaBottomRight;else{var f=h.alpha;l=f,u=f,c=f,d=f}r||h.blendMode===t.currentBlendMode||t.setBlendMode(h.blendMode);var p=h.mask;p&&p.preRenderWebGL(t,h,i);var g=h.type;g!==t.currentType&&(t.newType=!0,t.currentType=g),t.nextTypeMatch=o<s-1&&n[o+1].type===t.currentType,h.setAlpha(l*a,u*a,c*a,d*a),h.renderWebGL(t,h,i),h.setAlpha(l,u,c,d),p&&p.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),zz||(zz=1,Uz=function(t,e,i){var n=e.list;if(0!==n.length){e.depthSort();var s=-1!==e.blendMode;s||t.setBlendMode(0);var r=e._alpha;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var a=0;a<n.length;a++){var o=n[a];if(o.willRender(i)){var h=o.alpha;s||o.blendMode===t.currentBlendMode||t.setBlendMode(o.blendMode),o.setAlpha(h*r),o.renderCanvas(t,o,i),o.setAlpha(h)}}e.mask&&e.mask.postRenderCanvas(t)}}),Yz={renderWebGL:Bz,renderCanvas:Uz}),l=Bu(),u=Ql(),c=new e({Extends:o,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Mask,i.PostPipeline,i.Visible,r,h],initialize:function(e,i){o.call(this,e),r.call(this),this.scene=e,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=e.sys,this.events=e.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPostPipeline(),this.clearAlpha(),this.setBlendMode(t.SKIP_CHECK),i&&this.add(i),e.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return n(this)},willRender:function(t){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return i.unshift(this.displayList.getIndex(t)),i},addChildCallback:function(t){var e=t.displayList;e&&e!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(a.ADDED_TO_SCENE,t,this.scene),this.events.emit(l.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(a.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(l.REMOVED_FROM_SCENE,t,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(u(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(a.ADDED_TO_SCENE,this,this.scene),t.events.emit(l.ADDED_TO_SCENE,this,this.scene)),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(a.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(l.REMOVED_FROM_SCENE,this,this.scene)),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){if(this.scene&&!this.ignoreDestroy){this.emit(a.DESTROY,this);for(var e=this.list;e.length;)e[0].destroy(t);this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0,!1),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}});return Gz=c}function fV(){if(Vz)return Hz;Vz=1;var t=dk(),e=pk(),i={bezier:t,catmull:e,catmullrom:e,linear:vk()};return Hz=function(t){if(null===t)return null;var e=i.linear;return"string"==typeof t?i.hasOwnProperty(t)&&(e=i[t]):"function"==typeof t&&(e=t),e},Hz}function pV(){if(qz)return jz;qz=1;var t=vI(),e=Jh(),i=Vh(),n=ik(),s=yD(),r=Wh(),a=fV(),o=Ek(),h=ic(),l=new i({initialize:function(t,e,i){void 0===i&&(i=!1),this.propertyKey=t,this.propertyValue=e,this.defaultValue=e,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=i,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=r(t,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(t){var i;switch(this.method){case 1:case 3:case 8:i=t;break;case 2:this.propertyValue.indexOf(t)>=0&&(i=t);break;case 4:var n=(this.end-this.start)/this.steps;i=o(t,n),this.counter=i;break;case 5:case 6:case 7:i=e(t,this.start,this.end);break;case 9:i=this.start[0]}return this.current=i,this},getMethod:function(){var t=this.propertyValue;if(null===t)return 0;var e=typeof t;if("number"===e)return 1;if(Array.isArray(t))return 2;if("function"===e)return 3;if("object"===e){if(this.hasBoth(t,"start","end"))return this.has(t,"steps")?4:5;if(this.hasBoth(t,"min","max"))return 6;if(this.has(t,"random"))return 7;if(this.hasEither(t,"onEmit","onUpdate"))return 8;if(this.hasEither(t,"values","interpolation"))return 9}return 0},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,n=this.defaultUpdate;switch(this.method){case 1:i=this.staticValueEmit;break;case 2:i=this.randomStaticValueEmit,e=t[0];break;case 3:this._onEmit=t,i=this.proxyEmit,e=this.defaultValue;break;case 4:this.start=t.start,this.end=t.end,this.steps=t.steps,this.counter=this.start,this.yoyo=!!this.has(t,"yoyo")&&t.yoyo,this.direction=0,i=this.steppedEmit,e=this.start;break;case 5:this.start=t.start,this.end=t.end;var r=this.has(t,"ease")?t.ease:"Linear";this.ease=s(r,t.easeParams),i=this.has(t,"random")&&t.random?this.randomRangedValueEmit:this.easedValueEmit,n=this.easeValueUpdate,e=this.start;break;case 6:this.start=t.min,this.end=t.max,i=this.has(t,"int")&&t.int?this.randomRangedIntEmit:this.randomRangedValueEmit,e=this.start;break;case 7:var o=t.random;Array.isArray(o)&&(this.start=o[0],this.end=o[1]),i=this.randomRangedIntEmit,e=this.start;break;case 8:this._onEmit=this.has(t,"onEmit")?t.onEmit:this.defaultEmit,this._onUpdate=this.has(t,"onUpdate")?t.onUpdate:this.defaultUpdate,i=this.proxyEmit,n=this.proxyUpdate,e=this.defaultValue;break;case 9:this.start=t.values;var h=this.has(t,"ease")?t.ease:"Linear";this.ease=s(h,t.easeParams),this.interpolation=a(t.interpolation),i=this.easedValueEmit,n=this.easeValueUpdate,e=this.start[0]}return this.onEmit=i,this.onUpdate=n,this.current=e,this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,i){return t.hasOwnProperty(e)&&t.hasOwnProperty(i)},hasEither:function(t,e,i){return t.hasOwnProperty(e)||t.hasOwnProperty(i)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(t,e,i,n){return n},proxyEmit:function(t,e,i){var n=this._onEmit(t,e,i);return this.current=n,n},proxyUpdate:function(t,e,i,n){var s=this._onUpdate(t,e,i,n);return this.current=s,s},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[t],this.current},randomRangedValueEmit:function(t,e){var i=n(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=i,t.data[e].max=this.end),this.current=i,i},randomRangedIntEmit:function(e,i){var n=t(this.start,this.end);return e&&e.data[i]&&(e.data[i].min=n,e.data[i].max=this.end),this.current=n,n},steppedEmit:function(){var t,e=this.counter,i=e,n=(this.end-this.start)/this.steps;return this.yoyo?(0===this.direction?(i+=n)>=this.end&&(t=i-this.end,i=this.end-t,this.direction=1):(i-=n)<=this.start&&(t=this.start-i,i=this.start+t,this.direction=0),this.counter=i):this.counter=h(i+n,this.start,this.end),this.current=e,e},easedValueEmit:function(t,e){if(t&&t.data[e]){var i=t.data[e];i.min=this.start,i.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(t,e,i){var n,s=t.data[e],r=this.ease(i);return n=this.interpolation?this.interpolation(this.start,r):(s.max-s.min)*r+s.min,this.current=n,n},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});return jz=l}function gV(){if(Zz)return Kz;Zz=1;var t=Vh(),e=pV(),i=EI(),n=yD(),s=fV(),r=RI(),a=new t({Extends:e,initialize:function(t){e.call(this,t,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return null===this.propertyValue?0:9},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,a=this.defaultUpdate;if(9===this.method){this.start=t[0],this.ease=n("Linear"),this.interpolation=s("linear"),i=this.easedValueEmit,a=this.easeValueUpdate,e=t[0],this.active=!0,this.r.length=0,this.g.length=0,this.b.length=0;for(var o=0;o<t.length;o++){var h=r(t[o]);this.r.push(h.r),this.g.push(h.g),this.b.push(h.b)}}return this.onEmit=i,this.onUpdate=a,this.current=e,this},setEase:function(t){this.easeName=t,this.ease=n(t)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(t,e,n){var s=this.ease(n),r=this.interpolation(this.r,s),a=this.interpolation(this.g,s),o=this.interpolation(this.b,s),h=i(r,a,o);return this.current=h,h}});return Kz=a}function vV(){return hY?oY:(hY=1,oY={COMPLETE:$z?Jz:($z=1,Jz="complete"),DEATH_ZONE:tY?Qz:(tY=1,Qz="deathzone"),EXPLODE:iY?eY:(iY=1,eY="explode"),START:sY?nY:(sY=1,nY="start"),STOP:aY?rY:(aY=1,rY="stop")})}function mV(){if(uY)return lY;uY=1;var t=new(Vh())({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!0),this.emitter,this.x=t,this.y=e,this.active=i},update:function(){},destroy:function(){this.emitter=null}});return lY=t}function yV(){if(dY)return cY;dY=1;var t=Vh(),e=Wh(),i=mV(),n=new t({Extends:i,initialize:function(t,n,s,r,a){if("object"==typeof t){var o=t;t=e(o,"x",0),n=e(o,"y",0),s=e(o,"power",0),r=e(o,"epsilon",100),a=e(o,"gravity",50)}else void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=100),void 0===a&&(a=50);i.call(this,t,n,!0),this._gravity=a,this._power=s*a,this._epsilon=r*r},update:function(t,e){var i=this.x-t.x,n=this.y-t.y,s=i*i+n*n;if(0!==s){var r=Math.sqrt(s);s<this._epsilon&&(s=this._epsilon);var a=this._power*e/(s*r)*100;t.velocityX+=i*a,t.velocityY+=n*a}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});return cY=n}function xV(){if(pY)return fY;pY=1;var t=mI(),e=Jh(),i=Vh(),n=Xu(),s=Fu(),r=Du(),a=Ru(),o=new i({initialize:function(e){this.emitter=e,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new a,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=e.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new t(this)),this.bounds=new s},emit:function(t,e,i,n,s,r){return this.emitter.emit(t,e,i,n,s,r)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},fire:function(t,e){var i=this.emitter,s=i.ops,r=i.getAnim();if(r?this.anims.play(r):(this.frame=i.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(i.getEmitZone(this),void 0===t?this.x+=s.x.onEmit(this,"x"):s.x.steps>0?this.x+=t+s.x.onEmit(this,"x"):this.x+=t,void 0===e?this.y+=s.y.onEmit(this,"y"):s.y.steps>0?this.y+=e+s.y.onEmit(this,"y"):this.y+=e,this.life=s.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=s.delay.onEmit(this,"delay"),this.holdCurrent=s.hold.onEmit(this,"hold"),this.scaleX=s.scaleX.onEmit(this,"scaleX"),this.scaleY=s.scaleY.active?s.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=s.rotate.onEmit(this,"rotate"),this.rotation=n(this.angle),i.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),0===this.delayCurrent&&i.getDeathZone(this))return this.lifeCurrent=0,!1;var a=s.speedX.onEmit(this,"speedX"),o=s.speedY.active?s.speedY.onEmit(this,"speedY"):a;if(i.radial){var h=n(s.angle.onEmit(this,"angle"));this.velocityX=Math.cos(h)*Math.abs(a),this.velocityY=Math.sin(h)*Math.abs(o)}else if(i.moveTo){var l=s.moveToX.onEmit(this,"moveToX"),u=s.moveToY.onEmit(this,"moveToY"),c=this.life/1e3;this.velocityX=(l-this.x)/c,this.velocityY=(u-this.y)/c}else this.velocityX=a,this.velocityY=o;return i.acceleration&&(this.accelerationX=s.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=s.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=s.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=s.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=s.bounce.onEmit(this,"bounce"),this.alpha=s.alpha.onEmit(this,"alpha"),s.color.active?this.tint=s.color.onEmit(this,"tint"):this.tint=s.tint.onEmit(this,"tint"),!0},update:function(t,i,s){if(this.lifeCurrent<=0)return!(this.holdCurrent>0)||(this.holdCurrent-=t,this.holdCurrent<=0);if(this.delayCurrent>0)return this.delayCurrent-=t,!1;this.anims&&this.anims.update(0,t);var r=this.emitter,a=r.ops,o=1-this.lifeCurrent/this.life;if(this.lifeT=o,this.x=a.x.onUpdate(this,"x",o,this.x),this.y=a.y.onUpdate(this,"y",o,this.y),r.moveTo){var h=a.moveToX.onUpdate(this,"moveToX",o,r.moveToX),l=a.moveToY.onUpdate(this,"moveToY",o,r.moveToY),u=this.lifeCurrent/1e3;this.velocityX=(h-this.x)/u,this.velocityY=(l-this.y)/u}return this.computeVelocity(r,t,i,s,o),this.scaleX=a.scaleX.onUpdate(this,"scaleX",o,this.scaleX),a.scaleY.active?this.scaleY=a.scaleY.onUpdate(this,"scaleY",o,this.scaleY):this.scaleY=this.scaleX,this.angle=a.rotate.onUpdate(this,"rotate",o,this.angle),this.rotation=n(this.angle),r.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=e(a.alpha.onUpdate(this,"alpha",o,this.alpha),0,1),a.color.active?this.tint=a.color.onUpdate(this,"color",o,this.tint):this.tint=a.tint.onUpdate(this,"tint",o,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(t,i,n,s,r){var a=t.ops,o=this.velocityX,h=this.velocityY,l=a.accelerationX.onUpdate(this,"accelerationX",r,this.accelerationX),u=a.accelerationY.onUpdate(this,"accelerationY",r,this.accelerationY),c=a.maxVelocityX.onUpdate(this,"maxVelocityX",r,this.maxVelocityX),d=a.maxVelocityY.onUpdate(this,"maxVelocityY",r,this.maxVelocityY);this.bounce=a.bounce.onUpdate(this,"bounce",r,this.bounce),o+=t.gravityX*n+l*n,h+=t.gravityY*n+u*n,o=e(o,-c,c),h=e(h,-d,d),this.velocityX=o,this.velocityY=h,this.x+=o*n,this.y+=h*n,t.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var f=0;f<s.length;f++){var p=s[f];p.active&&p.update(this,i,n,r)}},setSizeToFrame:function(){},getBounds:function(t){void 0===t&&(t=this.emitter.getWorldTransformMatrix());var e=Math.abs(t.scaleX)*this.scaleX,i=Math.abs(t.scaleY)*this.scaleY,n=this.x,s=this.y,o=this.rotation,h=this.frame.width*e/2,l=this.frame.height*i/2,u=this.bounds,c=new a(n-h,s-l),d=new a(n+h,s-l),f=new a(n-h,s+l),p=new a(n+h,s+l);return 0!==o&&(r(c,n,s,o),r(d,n,s,o),r(f,n,s,o),r(p,n,s,o)),t.transformPoint(c.x,c.y,c),t.transformPoint(d.x,d.y,d),t.transformPoint(f.x,f.y,f),t.transformPoint(p.x,p.y,p),u.x=Math.min(c.x,d.x,f.x,p.x),u.y=Math.min(c.y,d.y,f.y,p.y),u.width=Math.max(c.x,d.x,f.x,p.x)-u.x,u.height=Math.max(c.y,d.y,f.y,p.y)-u.y,u},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});return fY=o}function wV(){if(vY)return gY;vY=1;var t=Vh(),e=mV(),i=Fu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===a&&(a=!0),void 0===o&&(o=!0),void 0===h&&(h=!0),void 0===l&&(l=!0),e.call(this,t,n,!0),this.bounds=new i(t,n,s,r),this.collideLeft=a,this.collideRight=o,this.collideTop=h,this.collideBottom=l},update:function(t){var e=this.bounds,i=-t.bounce,n=t.worldPosition;n.x<e.x&&this.collideLeft?(t.x+=e.x-n.x,t.velocityX*=i):n.x>e.right&&this.collideRight&&(t.x-=n.x-e.right,t.velocityX*=i),n.y<e.y&&this.collideTop?(t.y+=e.y-n.y,t.velocityY*=i):n.y>e.bottom&&this.collideBottom&&(t.y-=n.y-e.bottom,t.velocityY*=i)}});return gY=n}function TV(){return yY?mY:(yY=1,mY=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)})}function bV(){if(wY)return xY;wY=1;var t=new(Vh())({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=t.worldPosition,i=this.source.contains(e.x,e.y);return i&&this.killOnEnter||!i&&!this.killOnEnter}});return xY=t}function SV(){if(bY)return TY;bY=1;var t=new(Vh())({initialize:function(t,e,i,n,s,r){void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===r&&(r=-1),this.source=t,this.points=[],this.quantity=e,this.stepRate=i,this.yoyo=n,this.counter=-1,this.seamless=s,this._length=0,this._direction=0,this.total=r,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var i=this._length;return this._length=this.points.length,this._length<i&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});return TY=t}function EV(){return EY?SY:(EY=1,SY=function(t,e){for(var i=0;i<e.length;i++)if(!t.hasOwnProperty(e[i]))return!1;return!0})}function _V(){return CY?_Y:(CY=1,_Y=function(t,e){for(var i=0;i<e.length;i++)if(t.hasOwnProperty(e[i]))return!0;return!1})}function CV(){if(PY)return AY;PY=1;var t=kI();return AY=function(e,i,n){var s=e.centerX,r=e.centerY;return e.setSize(e.width+2*i,e.height+2*n),t(e,s,r)}}function AV(){return RY?MY:(RY=1,MY=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.right,e.right);t.x=i,t.width=n-i;var s=Math.min(t.y,e.y),r=Math.max(t.bottom,e.bottom);return t.y=s,t.height=r-s,t})}function PV(){if(OY)return LY;OY=1;var t=uU();return LY=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)&&(n[s]=i[s]);return n}}function MV(){if(DY)return FY;DY=1;var t=Vh(),e=Ru(),i=new t({initialize:function(t){this.source=t,this._tempVec=new e,this.total=-1},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});return FY=i}function RV(){return kY?IY:(kY=1,IY=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0||t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)})}function LV(){if(WY)return GY;WY=1;var t=Vh(),e=ac(),i=Qu(),n=TV(),s=bV(),r=SV(),a=gV(),o=pV(),h=vV(),l=ZF(),u=Wh(),c=Al(),d=yV(),f=EV(),p=_V(),g=hV(),v=CV(),m=LU(),y=AV(),x=PV(),w=xV(),T=wV(),b=MV(),S=Fu(),E=RV(),_=kl(),C=function(){if(XY)return YY;XY=1;var t,e;Hh();return t=function(){if(NY)return BY;NY=1;var t=RV(),e=tc(),i=Zk(),n=new e,s=new e,r=new e,a=new e;return BY=function(e,o,h,l){var u=e.pipelines.set(o.pipeline),c=n,d=s,f=r,p=a;l?(p.loadIdentity(),p.multiply(l),p.translate(o.x,o.y),p.rotate(o.rotation),p.scale(o.scaleX,o.scaleY)):p.applyITRS(o.x,o.y,o.rotation,o.scaleX,o.scaleY);var g=i.getTintAppendFloatAlpha,v=h.alpha,m=o.alpha;e.pipelines.preBatch(o);var y=o.alive,x=y.length,w=o.viewBounds;if(0!==x&&(!w||t(w,h.worldView))){o.sortCallback&&o.depthSort(),h.addToRenderList(o),c.copyFrom(h.matrix),c.multiplyWithOffset(p,-h.scrollX*o.scrollFactorX,-h.scrollY*o.scrollFactorY),e.setBlendMode(o.blendMode),o.mask&&(o.mask.preRenderWebGL(e,o,h),e.pipelines.set(o.pipeline));for(var T,b,S=o.tintFill,E=0;E<x;E++){var _=y[E],C=_.alpha*m*v;if(!(C<=0||0===_.scaleX||0===_.scaleY)){f.applyITRS(_.x,_.y,_.rotation,_.scaleX,_.scaleY),f.e=_.x,f.f=_.y,c.multiply(f,d);var A=_.frame;A.glTexture!==b&&(b=A.glTexture,T=u.setGameObject(o,A));var P=-A.halfWidth,M=-A.halfHeight,R=d.setQuad(P,M,P+A.width,M+A.height),L=g(_.tint,C);u.shouldFlush(6)&&(u.flush(),T=u.setGameObject(o,A)),u.batchQuad(o,R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],A.u0,A.v0,A.u1,A.v1,L,L,L,L,S,b,T)}}o.mask&&o.mask.postRenderWebGL(e,h),e.pipelines.postBatch(o)}},BY}(),e=function(){if(zY)return UY;zY=1;var t=RV(),e=tc(),i=new e,n=new e,s=new e,r=new e;return UY=function(e,a,o,h){var l=i,u=n,c=s,d=r;h?(d.loadIdentity(),d.multiply(h),d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.scaleX,a.scaleY)):d.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY);var f=e.currentContext,p=o.roundPixels,g=o.alpha,v=a.alpha,m=a.alive,y=m.length,x=a.viewBounds;if(a.visible&&0!==y&&(!x||t(x,o.worldView))){a.sortCallback&&a.depthSort(),o.addToRenderList(a);var w=a.scrollFactorX,T=a.scrollFactorY;f.save(),f.globalCompositeOperation=e.blendModes[a.blendMode];for(var b=0;b<y;b++){var S=m[b],E=S.alpha*v*g;if(!(E<=0||0===S.scaleX||0===S.scaleY)){c.applyITRS(S.x,S.y,S.rotation,S.scaleX,S.scaleY),l.copyFrom(o.matrix),l.multiplyWithOffset(d,-o.scrollX*w,-o.scrollY*T),c.e=S.x,c.f=S.y,l.multiply(c,u);var _=S.frame,C=_.canvasData;if(C.width>0&&C.height>0){var A=-_.halfWidth,P=-_.halfHeight;f.globalAlpha=E,f.save(),u.setToContext(f),p&&(A=Math.round(A),P=Math.round(P)),f.imageSmoothingEnabled=!_.source.scaleMode,f.drawImage(_.source.image,C.x,C.y,C.width,C.height,A,P,C.width,C.height),f.restore()}}}f.restore()}},UY}(),YY={renderWebGL:t,renderCanvas:e}}(),A=Ql(),P=tc(),M=Ru(),R=ic(),L=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],O=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],F=new t({Extends:l,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,C],initialize:function(t,e,i,n,s){l.call(this,t,"ParticleEmitter"),this.particleClass=w,this.config=null,this.ops={accelerationX:new o("accelerationX",0),accelerationY:new o("accelerationY",0),alpha:new o("alpha",1),angle:new o("angle",{min:0,max:360},!0),bounce:new o("bounce",0),color:new a("color"),delay:new o("delay",0,!0),hold:new o("hold",0,!0),lifespan:new o("lifespan",1e3,!0),maxVelocityX:new o("maxVelocityX",1e4),maxVelocityY:new o("maxVelocityY",1e4),moveToX:new o("moveToX",0),moveToY:new o("moveToY",0),quantity:new o("quantity",1,!0),rotate:new o("rotate",0),scaleX:new o("scaleX",1),scaleY:new o("scaleY",1),speedX:new o("speedX",0,!0),speedY:new o("speedY",0,!0),tint:new o("tint",16777215),x:new o("x",0),y:new o("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new M,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new P,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new m(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(e,i),this.setTexture(n),s&&this.setConfig(s)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(t){if(!t)return this;this.config=t;var e=0,i="",n=this.ops;for(e=0;e<O.length;e++)n[i=O[e]].loadConfig(t);for(e=0;e<L.length;e++)g(t,i=L[e])&&(this[i]=u(t,i));if(this.acceleration=0!==this.accelerationX||0!==this.accelerationY,this.moveTo=f(t,["moveToX","moveToY"]),g(t,"speed")&&(n.speedX.loadConfig(t,"speed"),n.speedY.active=!1),(p(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),g(t,"scale")&&(n.scaleX.loadConfig(t,"scale"),n.scaleY.active=!1),g(t,"callbackScope")){var s=u(t,"callbackScope",null);this.emitCallbackScope=s,this.deathCallbackScope=s}if(g(t,"emitZone")&&this.addEmitZone(t.emitZone),g(t,"deathZone")&&this.addDeathZone(t.deathZone),g(t,"bounds")){var r=this.addParticleBounds(t.bounds);r.collideLeft=u(t,"collideLeft",!0),r.collideRight=u(t,"collideRight",!0),r.collideTop=u(t,"collideTop",!0),r.collideBottom=u(t,"collideBottom",!0)}return g(t,"followOffset")&&this.followOffset.setFromObject(u(t,"followOffset",0)),g(t,"texture")&&this.setTexture(t.texture),g(t,"frame")?this.setEmitterFrame(t.frame):g(t,"anim")&&this.setAnim(t.anim),g(t,"reserve")&&this.reserve(t.reserve),g(t,"advance")&&this.fastForward(t.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(h.START,this),this},updateConfig:function(t){return t&&(this.config?this.setConfig(x(this.config,t)):this.setConfig(t)),this},toJSON:function(){var t=i(this),e=0,n="";for(e=0;e<L.length;e++)t[n=L[e]]=this[n];var s=this.ops;for(e=0;e<O.length;e++)s[n=O[e]]&&(t[n]=s[n].toJSON());return s.speedY.active||(delete t.speedX,t.speed=s.speedX.toJSON()),this.scaleX===this.scaleY&&(delete t.scaleX,delete t.scaleY,t.scale=s.scaleX.toJSON()),t},resetCounters:function(t,e){var i=this.counters;i.fill(0),i[0]=t,e&&(i[5]=1)},startFollow:function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),this.follow=t,this.followOffset.set(e,i),this.trackVisible=n,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var t,e=this.frames,i=e.length;return 1===i?t=e[0]:this.randomFrame?t=c(e):(t=e[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===i&&(this.currentFrame=0))),this.texture.get(t)},setEmitterFrame:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomFrame=e,this.frameQuantity=i,this.currentFrame=0;var n=typeof t;if(this.frames.length=0,Array.isArray(t))this.frames=this.frames.concat(t);else if("string"===n||"number"===n)this.frames.push(t);else if("object"===n){var s=t;(t=u(s,"frames",null))&&(this.frames=this.frames.concat(t));var r=u(s,"cycle",!1);this.randomFrame=!r,this.frameQuantity=u(s,"quantity",i)}return 1===this.frames.length&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var t=this.anims,e=t.length;if(0===e)return null;if(1===e)return t[0];if(this.randomAnim)return c(t);var i=t[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=R(this.currentAnim+1,0,e)),i},setAnim:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomAnim=e,this.animQuantity=i,this.currentAnim=0;var n=typeof t;if(this.anims.length=0,Array.isArray(t))this.anims=this.anims.concat(t);else if("string"===n)this.anims.push(t);else if("object"===n){var s=t;(t=u(s,"anims",null))&&(this.anims=this.anims.concat(t));var r=u(s,"cycle",!1);this.randomAnim=!r,this.animQuantity=u(s,"quantity",i)}return 1===this.anims.length&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},addParticleBounds:function(t,e,i,n,s,r,a,o){if("object"==typeof t){var h=t;t=h.x,e=h.y,i=g(h,"w")?h.w:h.width,n=g(h,"h")?h.h:h.height}return this.addParticleProcessor(new T(t,e,i,n,s,r,a,o))},setParticleSpeed:function(t,e){return void 0===e&&(e=t),this.ops.speedX.onChange(t),t===e?this.ops.speedY.active=!1:this.ops.speedY.onChange(e),this.radial=!0,this},setParticleScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.ops.scaleX.onChange(t),this.ops.scaleY.onChange(e),this},setParticleGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setParticleAlpha:function(t){return this.ops.alpha.onChange(t),this},setParticleTint:function(t){return this.ops.tint.onChange(t),this},setEmitterAngle:function(t){return this.ops.angle.onChange(t),this},setParticleLifespan:function(t){return this.ops.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity=t,this},setFrequency:function(t,e){return this.frequency=t,this.flowCounter=t>0?t:0,e&&(this.quantity=e),this},addDeathZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof s)i.push(e);else if("function"==typeof e.contains)e=new s(e,!0),i.push(e);else{var r=u(e,"type","onEnter"),a=u(e,"source",null);a&&"function"==typeof a.contains&&(e=new s(a,"onEnter"===r),i.push(e))}return this.deathZones=this.deathZones.concat(i),i},removeDeathZone:function(t){return _(this.deathZones,t),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof b||e instanceof r)i.push(e);else{var s=u(e,"source",null);if(s){var a=u(e,"type","random");if("random"===a&&"function"==typeof s.getRandomPoint)e=new b(s),i.push(e);else if("edge"===a&&"function"==typeof s.getPoints){var o=u(e,"quantity",1),h=u(e,"stepRate",0),l=u(e,"yoyo",!1),c=u(e,"seamless",!0),d=u(e,"total",-1);e=new r(s,o,h,l,c,d),i.push(e)}}}return this.emitZones=this.emitZones.concat(i),i},removeEmitZone:function(t){return _(this.emitZones,t),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(t){var e=this.emitZones,i=e.length;if(0!==i){var n=e[this.zoneIndex];n.getPoint(t),n.total>-1&&(this.zoneTotal++,this.zoneTotal===n.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===i&&(this.zoneIndex=0)))}},getDeathZone:function(t){for(var e=this.deathZones,i=0;i<e.length;i++){var n=e[i];if(n.willKill(t))return this.emit(h.DEATH_ZONE,this,t,n),!0}return!1},setEmitZone:function(t){var e;return(e=isFinite(t)?t:this.emitZones.indexOf(t))>=0&&(this.zoneIndex=e),this},addParticleProcessor:function(t){return this.processors.exists(t)||(t.emitter&&t.emitter.removeParticleProcessor(t),this.processors.add(t),t.emitter=this),t},removeParticleProcessor:function(t){return this.processors.exists(t)&&(this.processors.remove(t,!0),t.emitter=null),t},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(t){return this.addParticleProcessor(new d(t))},reserve:function(t){var e=this.dead;if(this.maxParticles>0){var i=this.getParticleCount();i+t>this.maxParticles&&(t=this.maxParticles-(i+t))}for(var n=0;n<t;n++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles||this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var i=this.alive,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},forEachDead:function(t,e){for(var i=this.dead,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},start:function(t,e){return void 0===t&&(t=0),this.emitting||(t>0&&this.fastForward(t),this.emitting=!0,this.resetCounters(this.frequency,!0),void 0!==e&&(this.duration=Math.abs(e)),this.emit(h.START,this)),this},stop:function(t){return void 0===t&&(t=!1),this.emitting&&(this.emitting=!1,t&&this.killAll(),this.emit(h.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(t,e){return void 0===t&&(t=""),void 0===e&&(e=this.true),this.sortProperty=t,this.sortOrderAsc=e,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(t){return t=""!==this.sortProperty?this.depthSortCallback:null,this.sortCallback=t,this},depthSort:function(){return A(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(t,e){var i=this.sortProperty;return this.sortOrderAsc?t[i]-e[i]:e[i]-t[i]},flow:function(t,e,i){return void 0===e&&(e=1),this.emitting=!1,this.frequency=t,this.quantity=e,void 0!==i&&(this.stopAfter=i),this.start()},explode:function(t,e,i){this.frequency=-1,this.resetCounters(-1,!0);var n=this.emitParticle(t,e,i);return this.emit(h.EXPLODE,this,n),n},emitParticleAt:function(t,e,i){return this.emitParticle(i,t,e)},emitParticle:function(t,e,i){if(!this.atLimit()){void 0===t&&(t=this.ops.quantity.onEmit());for(var n=this.dead,s=this.stopAfter,r=this.follow?this.follow.x+this.followOffset.x:e,a=this.follow?this.follow.y+this.followOffset.y:i,o=0;o<t;o++){var h=n.pop();if(h||(h=new this.particleClass(this)),h.fire(r,a)?(this.particleBringToTop?this.alive.push(h):this.alive.unshift(h),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,h,this)):this.dead.push(h),s>0&&(this.stopCounter++,this.stopCounter>=s))break;if(this.atLimit())break}return h}},fastForward:function(t,e){void 0===e&&(e=1e3/60);var i=0;for(this.skipping=!0;i<Math.abs(t);)this.preUpdate(0,e),i+=e;return this.skipping=!1,this},preUpdate:function(t,e){var i=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var n=this.getProcessors(),s=this.alive,r=this.dead,a=0,o=[],l=s.length;for(a=0;a<l;a++){var u=s[a];u.update(e,i,n)&&o.push({index:a,particle:u})}if((l=o.length)>0){var c=this.deathCallback,d=this.deathCallbackScope;for(a=l-1;a>=0;a--){var f=o[a];s.splice(f.index,1),r.push(f.particle),c&&c.call(d,f.particle),f.particle.setPosition()}}if(this.emitting||this.skipping){if(0===this.frequency)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=e;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())}else 1===this.completeFlag&&0===s.length&&(this.completeFlag=0,this.emit(h.COMPLETE,this))},overlap:function(t){for(var e=this.getWorldTransformMatrix(),i=this.alive,n=i.length,s=[],r=0;r<n;r++){var a=i[r];E(t,a.getBounds(e))&&s.push(a)}return s},getBounds:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1e3/60),void 0===s&&(s=new S);var r,a,o=this.getWorldTransformMatrix(),h=this.alive,l=!1;if(s.setTo(0,0,0,0),e>0){var u=0;for(this.skipping=!0;u<Math.abs(e);){for(this.preUpdate(0,i),r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));u+=i}this.skipping=!1}else for(r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));return t>0&&v(s,t,t),s},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(t){this.ops.x.onChange(t)}},particleY:{get:function(){return this.ops.y.current},set:function(t){this.ops.y.onChange(t)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(t){this.ops.accelerationX.onChange(t)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(t){this.ops.accelerationY.onChange(t)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(t){this.ops.maxVelocityX.onChange(t)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(t){this.ops.maxVelocityY.onChange(t)}},speed:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t),this.ops.speedY.onChange(t)}},speedX:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t)}},speedY:{get:function(){return this.ops.speedY.current},set:function(t){this.ops.speedY.onChange(t)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(t){this.ops.moveToX.onChange(t)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(t){this.ops.moveToY.onChange(t)}},bounce:{get:function(){return this.ops.bounce.current},set:function(t){this.ops.bounce.onChange(t)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(t){this.ops.scaleX.onChange(t)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(t){this.ops.scaleY.onChange(t)}},particleColor:{get:function(){return this.ops.color.current},set:function(t){this.ops.color.onChange(t)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(t){this.ops.color.setEase(t)}},particleTint:{get:function(){return this.ops.tint.current},set:function(t){this.ops.tint.onChange(t)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(t){this.ops.alpha.onChange(t)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(t){this.ops.lifespan.onChange(t)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(t){this.ops.angle.onChange(t)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(t){this.ops.rotate.onChange(t)}},quantity:{get:function(){return this.ops.quantity.current},set:function(t){this.ops.quantity.onChange(t)}},delay:{get:function(){return this.ops.delay.current},set:function(t){this.ops.delay.onChange(t)}},hold:{get:function(){return this.ops.hold.current},set:function(t){this.ops.hold.onChange(t)}},flowCounter:{get:function(){return this.counters[0]},set:function(t){this.counters[0]=t}},frameCounter:{get:function(){return this.counters[1]},set:function(t){this.counters[1]=t}},animCounter:{get:function(){return this.counters[2]},set:function(t){this.counters[2]=t}},elapsed:{get:function(){return this.counters[3]},set:function(t){this.counters[3]=t}},stopCounter:{get:function(){return this.counters[4]},set:function(t){this.counters[4]=t}},completeFlag:{get:function(){return this.counters[5]},set:function(t){this.counters[5]=t}},zoneIndex:{get:function(){return this.counters[6]},set:function(t){this.counters[6]=t}},zoneTotal:{get:function(){return this.counters[7]},set:function(t){this.counters[7]=t}},currentFrame:{get:function(){return this.counters[8]},set:function(t){this.counters[8]=t}},currentAnim:{get:function(){return this.counters[9]},set:function(t){this.counters[9]=t}},preDestroy:function(){var t;this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var e=this.ops;for(t=0;t<O.length;t++)e[O[t]].destroy();for(t=0;t<this.alive.length;t++)this.alive[t].destroy();for(t=0;t<this.dead.length;t++)this.dead[t].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});return GY=F}function OV(){if(ZY)return KY;ZY=1;var t=Vh(),e=ac(),i=uV(),n=new t({Extends:i,Mixins:[e.PathFollower],initialize:function(t,e,n,s,r,a){i.call(this,t,n,s,r,a),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});return KY=n}function FV(){if($Y)return JY;$Y=1;var t=Vh(),e=xU(),i=wU(),n=new t({Extends:i,initialize:function(t,n,s,r,a,o){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=32),void 0===a&&(a=32),void 0===o&&(o=!0);var h=new e(t.sys.textures,"",r,a,o);i.call(this,t,n,s,h),this.type="RenderTexture",this.camera=this.texture.camera,this._saved=!1},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},resize:function(t,e,i){return this.texture.setSize(t,e,i),this.setSize(this.texture.width,this.texture.height),this},saveTexture:function(t){var e=this.texture;return e.key=t,e.manager.addDynamicTexture(e)&&(this._saved=!0),e},fill:function(t,e,i,n,s,r){return this.texture.fill(t,e,i,n,s,r),this},clear:function(){return this.texture.clear(),this},stamp:function(t,e,i,n,s){return this.texture.stamp(t,e,i,n,s),this},erase:function(t,e,i){return this.texture.erase(t,e,i),this},draw:function(t,e,i,n,s){return this.texture.draw(t,e,i,n,s),this},drawFrame:function(t,e,i,n,s,r){return this.texture.drawFrame(t,e,i,n,s,r),this},repeat:function(t,e,i,n,s,r,a,o,h){return this.texture.repeat(t,e,i,n,s,r,a,o,h),this},beginDraw:function(){return this.texture.beginDraw(),this},batchDraw:function(t,e,i,n,s){return this.texture.batchDraw(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){return this.texture.batchDrawFrame(t,e,i,n,s,r),this},endDraw:function(t){return this.texture.endDraw(t),this},snapshotArea:function(t,e,i,n,s,r,a){return this.texture.snapshotArea(t,e,i,n,s,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},preDestroy:function(){this.camera=null,this._saved||this.texture.destroy()}});return JY=n}function DV(){if(iX)return eX;iX=1;var t=Ol();return eX=function(e,i){var n=i.width,s=i.height,r=Math.floor(n/2),a=Math.floor(s/2),o=t(i,"chars","");if(""!==o){var h=t(i,"image",""),l=e.sys.textures.getFrame(h),u=l.cutX,c=l.cutY,d=l.source.width,f=l.source.height,p=t(i,"offset.x",0),g=t(i,"offset.y",0),v=t(i,"spacing.x",0),m=t(i,"spacing.y",0),y=t(i,"lineSpacing",0),x=t(i,"charsPerRow",null);null===x&&(x=d/n)>o.length&&(x=o.length);for(var w=p,T=g,b={retroFont:!0,font:h,size:n,lineHeight:s+y,chars:{}},S=0,E=0;E<o.length;E++){var _=o.charCodeAt(E),C=(u+w)/d,A=(c+T)/f,P=(u+w+n)/d,M=(c+T+s)/f;b.chars[_]={x:w,y:T,width:n,height:s,centerX:r,centerY:a,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{},u0:C,v0:A,u1:P,v1:M},++S===x?(S=0,w=p,T+=s+m):w+=n+v}return{data:b,frame:null,texture:h}}},eX}function IV(){if(sX)return nX;sX=1;var t=tX?QY:(tX=1,QY={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}),e=nh(),i={Parse:DV()};return i=e(!1,i,t),nX=i}function kV(){if(dX)return cX;dX=1;var t=mI(),e=Vh(),i=ac(),n=ZF(),s=Bk(),r=function(){if(uX)return lX;uX=1;var t,e;Hh();return t=function(){if(aX)return rX;aX=1;var t=kU(),e=Zk();return rX=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline,n),o=t(n,s,r).calc,h=n.vertices,l=n.uv,u=n.colors,c=n.alphas,d=n.alpha,f=e.getTintAppendFloatAlpha,p=s.roundPixels,g=h.length,v=Math.floor(.5*g);a.flush(),i.pipelines.preBatch(n);var m=a.setGameObject(n),y=a.vertexViewF32,x=a.vertexViewU32,w=a.vertexCount*a.currentShader.vertexComponentCount-1,T=0,b=n.tintFill;n.dirty&&n.updateVertices();for(var S=n.debugCallback,E=[],_=0;_<g;_+=2){var C=h[_+0],A=h[_+1],P=C*o.a+A*o.c+o.e,M=C*o.b+A*o.d+o.f;p&&(P=Math.round(P),M=Math.round(M)),y[++w]=P,y[++w]=M,y[++w]=l[_+0],y[++w]=l[_+1],y[++w]=m,y[++w]=b,x[++w]=f(u[T],s.alpha*(c[T]*d)),T++,S&&(E[_+0]=P,E[_+1]=M)}S&&S.call(n,n,g,E),a.vertexCount+=v,a.currentBatch.count=a.vertexCount-a.currentBatch.start,i.pipelines.postBatch(n)},rX}(),e=hX?oX:(hX=1,oX=function(){}),lX={renderWebGL:t,renderCanvas:e}}(),a=Ru(),o=new e({Extends:n,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Flip,i.Mask,i.Pipeline,i.PostPipeline,i.Size,i.Texture,i.Transform,i.Visible,i.ScrollFactor,r],initialize:function(e,i,r,o,h,l,u,c,d){void 0===o&&(o="__DEFAULT"),void 0===l&&(l=2),void 0===u&&(u=!0),n.call(this,e,"Rope"),this.anims=new t(this),this.points=l,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===o,this.dirty=!1,this.horizontal=u,this._flipX=!1,this._flipY=!1,this._perp=new a,this.debugCallback=null,this.debugGraphic=null,this.setTexture(o,h),this.setPosition(i,r),this.setSizeToFrame(),this.initPipeline(s.ROPE_PIPELINE),this.initPostPipeline(),Array.isArray(l)&&this.resizeArrays(l.length),this.setPoints(l,c,d),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){var i=this.anims.currentFrame;this.anims.update(t,e),this.anims.currentFrame!==i&&(this.updateUVs(),this.updateVertices())},play:function(t,e,i){return this.anims.play(t,e,i),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(t,e,i))},setVertical:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(t,e,i)):this},setTintFill:function(t){return void 0===t&&(t=!1),this.tintFill=t,this},setAlphas:function(t,e){var i=this.points.length;if(i<1)return this;var n,s=this.alphas;void 0===t?t=[1]:Array.isArray(t)||void 0!==e||(t=[t]);var r=0;if(void 0!==e)for(n=0;n<i;n++)s[r=2*n]=t,s[r+1]=e;else if(t.length===i)for(n=0;n<i;n++)s[r=2*n]=t[n],s[r+1]=t[n];else{var a=t[0];for(n=0;n<i;n++)r=2*n,t.length>r&&(a=t[r]),s[r]=a,t.length>r+1&&(a=t[r+1]),s[r+1]=a}return this},setColors:function(t){var e=this.points.length;if(e<1)return this;var i,n=this.colors;void 0===t?t=[16777215]:Array.isArray(t)||(t=[t]);var s=0;if(t.length===e)for(i=0;i<e;i++)n[s=2*i]=t[i],n[s+1]=t[i];else{var r=t[0];for(i=0;i<e;i++)s=2*i,t.length>s&&(r=t[s]),n[s]=r,t.length>s+1&&(r=t[s+1]),n[s+1]=r}return this},setPoints:function(t,e,i){if(void 0===t&&(t=2),"number"==typeof t){var n,s,r,a=t;if(a<2&&(a=2),t=[],this.horizontal)for(r=-this.frame.halfWidth,s=this.frame.width/(a-1),n=0;n<a;n++)t.push({x:r+n*s,y:0});else for(r=-this.frame.halfHeight,s=this.frame.height/(a-1),n=0;n<a;n++)t.push({x:0,y:r+n*s})}var o=t.length,h=this.points.length;return o<1?(console.warn("Rope: Not enough points given"),this):(1===o&&(t.unshift({x:0,y:0}),o++),h!==o&&this.resizeArrays(o),this.dirty=!0,this.points=t,this.updateUVs(),null!=e&&this.setColors(e),null!=i&&this.setAlphas(i),this)},updateUVs:function(){for(var t=this.uv,e=this.points.length,i=this.frame.u0,n=this.frame.v0,s=this.frame.u1,r=this.frame.v1,a=(s-i)/(e-1),o=(r-n)/(e-1),h=0;h<e;h++){var l,u,c,d,f=4*h;this.horizontal?(this._flipX?(l=s-h*a,c=s-h*a):(l=i+h*a,c=i+h*a),this._flipY?(u=r,d=n):(u=n,d=r)):(this._flipX?(l=i,c=s):(l=s,c=i),this._flipY?(u=r-h*o,d=r-h*o):(u=n+h*o,d=n+h*o)),t[f+0]=l,t[f+1]=u,t[f+2]=c,t[f+3]=d}return this},resizeArrays:function(t){var e=this.colors,i=this.alphas;this.vertices=new Float32Array(4*t),this.uv=new Float32Array(4*t),e=new Uint32Array(2*t),i=new Float32Array(2*t);for(var n=0;n<2*t;n++)e[n]=16777215,i[n]=1;return this.colors=e,this.alphas=i,this.dirty=!0,this},updateVertices:function(){var t=this._perp,e=this.points,i=this.vertices,n=e.length;if(this.dirty=!1,!(n<1)){for(var s,r=e[0],a=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,o=0;o<n;o++){var h=e[o],l=4*o;s=o<n-1?e[o+1]:h,t.x=s.y-r.y,t.y=-(s.x-r.x);var u=t.length();t.x/=u,t.y/=u,t.x*=a,t.y*=a,i[l]=h.x+t.x,i[l+1]=h.y+t.y,i[l+2]=h.x-t.x,i[l+3]=h.y-t.y,r=h}return this}},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts:function(t,e,i){var n=t.debugGraphic,s=i[0],r=i[1],a=i[2],o=i[3];n.lineBetween(s,r,a,o);for(var h=4;h<e;h+=4){var l=i[h+0],u=i[h+1],c=i[h+2],d=i[h+3];n.lineBetween(s,r,l,u),n.lineBetween(a,o,c,d),n.lineBetween(a,o,l,u),n.lineBetween(l,u,c,d),s=l,r=u,a=c,o=d}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(t){return this._flipX=t,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(t){return this._flipY=t,this.updateUVs()}}});return cX=o}function BV(){return pX||(pX=1,fX=function(t,e,i){var n=t.canvas,s=t.context,r=t.style,a=[],o=0,h=i.length;r.maxLines>0&&r.maxLines<i.length&&(h=r.maxLines),r.syncFont(n,s);for(var l=t.letterSpacing,u=0;u<h;u++){var c=r.strokeThickness;if(0===l)c+=s.measureText(i[u]).width;else{for(var d=i[u],f=0;f<d.length;f++)c+=s.measureText(d[f]).width;d.length>1&&(c+=l*(d.length-1))}r.wordWrap&&(c-=s.measureText(" ").width),a[u]=Math.ceil(c),o=Math.max(o,a[u])}var p=e.fontSize+r.strokeThickness,g=p*h,v=t.lineSpacing;return h>1&&(g+=v*(h-1)),{width:o,height:g,lines:h,lineWidths:a,lineSpacing:v,lineHeight:p}}),fX}function NV(){if(bX)return TX;bX=1;var t=Hl();return TX=function(e){var i=t.create(this),n=i.getContext("2d",{willReadFrequently:!0});e.syncFont(i,n);var s=n.measureText(e.testString);if("actualBoundingBoxAscent"in s){var r=s.actualBoundingBoxAscent,a=s.actualBoundingBoxDescent;return t.remove(i),{ascent:r,descent:a,fontSize:r+a}}var o=Math.ceil(s.width*e.baselineX),h=o,l=2*h;h=h*e.baselineY|0,i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(e.testString,0,h);var u={ascent:0,descent:0,fontSize:0},c=n.getImageData(0,0,o,l);if(!c)return u.ascent=h,u.descent=h+6,u.fontSize=u.ascent+u.descent,t.remove(i),u;var d,f,p=c.data,g=p.length,v=4*o,m=0,y=!1;for(d=0;d<h;d++){for(f=0;f<v;f+=4)if(255!==p[m+f]){y=!0;break}if(y)break;m+=v}for(u.ascent=h-d,m=g-v,y=!1,d=l;d>h;d--){for(f=0;f<v;f+=4)if(255!==p[m+f]){y=!0;break}if(y)break;m-=v}return u.descent=d-h,u.fontSize=u.ascent+u.descent,t.remove(i),u},TX}function UV(){if(EX)return SX;EX=1;var t=Vh(),e=BU(),i=Ol(),n=NV(),s={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|MÃâ°qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},r=new t({initialize:function(t,e){this.parent=t,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(e,!1,!0)},setStyle:function(t,r,a){for(var o in void 0===r&&(r=!0),void 0===a&&(a=!1),s){var h=a?s[o][1]:this[o];"wordWrapCallback"===o||"wordWrapCallbackScope"===o?this[o]=i(t,s[o][0],h):t&&"fontSize"===o&&"number"==typeof t.fontSize?this[o]=t.fontSize.toString()+"px":this[o]=e(t,s[o][0],h)}var l=i(t,"font",null);null!==l&&this.setFont(l,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var u=i(t,"fill",null);null!==u&&(this.color=u);var c=i(t,"metrics",!1);return c?this.metrics={ascent:i(c,"ascent",0),descent:i(c,"descent",0),fontSize:i(c,"fontSize",0)}:!r&&this.metrics||(this.metrics=n(this)),r?this.parent.updateText():this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=n(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,s="",r="";if("string"!=typeof t)n=i(t,"fontFamily","Courier"),s=i(t,"fontSize","16px"),r=i(t,"fontStyle","");else{var a=t.split(" "),o=0;r=a.length>2?a[o++]:"",s=a[o++]||"16px",n=a[o++]||"Courier"}return n===this.fontFamily&&s===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=s,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=n,this.shadowStroke=s,this.shadowFill=r,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in s)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});return SX=r}function zV(){return CX?_X:(CX=1,_X=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})})}function YV(){if(PX)return AX;PX=1;var t=FN(),e=Hl(),i=Vh(),n=ac(),s=ZF(),r=BV(),a=Ol(),o=WN(),h=function(){if(wX)return xX;wX=1;var t;Hh();return t=function(){if(vX)return gX;vX=1;var t=Zk();return gX=function(e,i,n,s){if(0!==i.width&&0!==i.height){n.addToRenderList(i);var r=i.frame,a=r.width,o=r.height,h=t.getTintAppendFloatAlpha,l=e.pipelines.set(i.pipeline,i),u=l.setTexture2D(r.glTexture,i);l.batchTexture(i,r.glTexture,a,o,i.x,i.y,a/i.style.resolution,o/i.style.resolution,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.displayOriginX,i.displayOriginY,0,0,a,o,h(i.tintTopLeft,n.alpha*i._alphaTL),h(i.tintTopRight,n.alpha*i._alphaTR),h(i.tintBottomLeft,n.alpha*i._alphaBL),h(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,0,0,n,s,!1,u)}},gX}(),yX||(yX=1,mX=function(t,e,i,n){0!==e.width&&0!==e.height&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),xX={renderWebGL:t,renderCanvas:mX}}(),l=UV(),u=zV(),c=new i({Extends:s,Mixins:[n.Alpha,n.BlendMode,n.ComputedSize,n.Crop,n.Depth,n.Flip,n.GetBounds,n.Mask,n.Origin,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Tint,n.Transform,n.Visible,h],initialize:function(t,i,n,r,a){void 0===i&&(i=0),void 0===n&&(n=0),s.call(this,t,"Text"),this.renderer=t.sys.renderer,this.setPosition(i,n),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=e.create(this),this.context,this.style=new l(this,a),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=u(),this.texture=t.sys.textures.addCanvas(this._textureKey,this.canvas),this.context=this.texture.context,this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(r),a&&a.padding&&this.setPadding(a.padding),a&&a.lineSpacing&&this.setLineSpacing(a.lineSpacing),a&&a.letterSpacing&&this.setLetterSpacing(a.letterSpacing)},initRTL:function(){if(!this.style.rtl)return this.canvas.dir="ltr",void(this.context.direction="ltr");this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas),this.originX=1},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var i=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(i)&&(i=i.join("\n")),i}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,i){for(var n="",s=t.replace(/ +/gi," ").split(this.splitRegExp),r=s.length,a=0;a<r;a++){var o=s[a],h="",l=(o=o.replace(/^ *|\s*$/gi,"")).length*this.letterSpacing;if(e.measureText(o).width+l<i)n+=o+"\n";else{for(var u=i,c=o.split(" "),d=0;d<c.length;d++){var f=c[d],p=f+" ",g=p.length*this.letterSpacing,v=e.measureText(p).width+g;if(v>u){if(0===d){for(var m=p;m.length;){var y=(m=m.slice(0,-1)).length*this.letterSpacing;if((v=e.measureText(m).width+y)<=u)break}if(!m.length)throw new Error("wordWrapWidth < a single character");var x=f.substr(m.length);c[d]=x,h+=m}var w=c[d].length?d:d+1,T=c.slice(w).join(" ").replace(/[ \n]*$/gi,"");s.splice(a+1,0,T),r=s.length;break}h+=p,u-=v}n+=h.replace(/[ \n]*$/gi,"")+"\n"}}return n.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,i){for(var n="",s=t.split(this.splitRegExp),r=s.length-1,a=e.measureText(" ").width,o=0;o<=r;o++){for(var h=i,l=s[o].split(" "),u=l.length-1,c=0;c<=u;c++){var d=l[c],f=d.length*this.letterSpacing,p=e.measureText(d).width+f,g=p;c<u&&(g+=a),g>h&&c>0&&(n+="\n",h=i),n+=d,c<u?(n+=" ",h-=g):h-=p}o<r&&(n+="\n")}return n},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},appendText:function(t,e){void 0===e&&(e=!0),t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t=t.toString();var i=this._text.concat(e?"\n"+t:t);return i!==this._text&&(this._text=i,this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,i,n,s,r){return this.style.setShadow(t,e,i,n,s,r)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setLetterSpacing:function(t){return this.letterSpacing=t,this.updateText()},setPadding:function(t,e,i,n){if("object"==typeof t){var s=t,r=a(s,"x",null);null!==r?(t=r,i=r):(t=a(s,"left",0),i=a(s,"right",t));var o=a(s,"y",null);null!==o?(e=o,n=o):(e=a(s,"top",0),n=a(s,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=n,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},setRTL:function(e){void 0===e&&(e=!0);var i=this.style;return i.rtl===e||(i.rtl=e,e?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),"left"===i.align?i.align="right":"right"===i.align&&(i.align="left")),this},updateText:function(){var t=this.canvas,e=this.context,i=this.style,n=i.resolution,s=i.metrics;i.syncFont(t,e);var a=this._text;(i.wordWrapWidth||i.wordWrapCallback)&&(a=this.runWordWrap(this._text));var o,h=a.split(this.splitRegExp),l=r(this,s,h),u=this.padding;0===i.fixedWidth?(this.width=l.width+u.left+u.right,o=l.width):(this.width=i.fixedWidth,(o=this.width-u.left-u.right)<l.width&&(o=l.width)),0===i.fixedHeight?this.height=l.height+u.top+u.bottom:this.height=i.fixedHeight;var c,d,f=this.width,p=this.height;this.updateDisplayOrigin(),f*=n,p*=n,f=Math.max(f,1),p=Math.max(p,1),t.width!==f||t.height!==p?(t.width=f,t.height=p,this.frame.setSize(f,p),i.syncFont(t,e),i.rtl&&(e.direction="rtl")):e.clearRect(0,0,f,p),e.save(),e.scale(n,n),i.backgroundColor&&(e.fillStyle=i.backgroundColor,e.fillRect(0,0,f,p)),i.syncStyle(t,e),e.translate(u.left,u.top);for(var g=0;g<l.lines;g++){if(c=i.strokeThickness/2,d=i.strokeThickness/2+g*l.lineHeight+s.ascent,g>0&&(d+=l.lineSpacing*g),i.rtl)c=f-c-u.left-u.right;else if("right"===i.align)c+=o-l.lineWidths[g];else if("center"===i.align)c+=(o-l.lineWidths[g])/2;else if("justify"===i.align&&l.lineWidths[g]/l.width>=.85){var v=l.width-l.lineWidths[g],m=e.measureText(" ").width,y=h[g].trim(),x=y.split(" ");v+=(h[g].length-y.length)*m;for(var w=Math.floor(v/m),T=0;w>0;)x[T]+=" ",T=(T+1)%(x.length-1||1),--w;h[g]=x.join(" ")}this.autoRound&&(c=Math.round(c),d=Math.round(d));var b=this.letterSpacing;if(i.strokeThickness&&0===b&&(i.syncShadow(e,i.shadowStroke),e.strokeText(h[g],c,d)),i.color)if(i.syncShadow(e,i.shadowFill),0!==b)for(var S=0,E=h[g].split(""),_=0;_<E.length;_++)i.strokeThickness&&(i.syncShadow(e,i.shadowStroke),e.strokeText(E[_],c+S,d),i.syncShadow(e,i.shadowFill)),e.fillText(E[_],c+S,d),S+=e.measureText(E[_]).width+b;else e.fillText(h[g],c,d)}e.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture.spectorMetadata={textureKey:"Text Game Object"});var C=this.input;return C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=n.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){o(this.canvas),e.remove(this.canvas);var t=this.texture;t&&t.destroy()}});return AX=c}function XV(){if(kX)return IX;kX=1;var t=Hl(),e=Vh(),i=ac(),n=ZF(),s=wk(),r=Wl(),a=function(){if(DX)return FX;DX=1;var t;Hh();return t=function(){if(RX)return MX;RX=1;var t=Zk();return MX=function(e,i,n,s){i.updateCanvas();var r=i.width,a=i.height;if(0!==r&&0!==a){n.addToRenderList(i);var o=t.getTintAppendFloatAlpha,h=e.pipelines.set(i.pipeline,i),l=h.setTexture2D(i.fillPattern,i);h.batchTexture(i,i.fillPattern,i.displayFrame.width*i.tileScaleX,i.displayFrame.height*i.tileScaleY,i.x,i.y,r,a,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.originX*r,i.originY*a,0,0,r,a,o(i.tintTopLeft,n.alpha*i._alphaTL),o(i.tintTopRight,n.alpha*i._alphaTR),o(i.tintBottomLeft,n.alpha*i._alphaBL),o(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,i.tilePositionX%i.displayFrame.width/i.displayFrame.width,i.tilePositionY%i.displayFrame.height/i.displayFrame.height,n,s,!1,l)}},MX}(),OX||(OX=1,LX=function(t,e,i,n){e.updateCanvas(),i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),FX={renderWebGL:t,renderCanvas:LX}}(),o=zV(),h=Ru(),l=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Crop,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Tint,i.Transform,i.Visible,a],initialize:function(e,i,r,a,l,u,c){var d=e.sys.renderer;n.call(this,e,"TileSprite");var f=e.sys.textures.get(u),p=f.get(c);p.source.compressionAlgorithm&&(console.warn("TileSprite cannot use compressed texture"),p=(f=e.sys.textures.get("__MISSING")).get()),"DynamicTexture"===f.type&&(console.warn("TileSprite cannot use Dynamic Texture"),p=(f=e.sys.textures.get("__MISSING")).get()),a&&l?(a=Math.floor(a),l=Math.floor(l)):(a=a||p.width,l=l||p.height),this._tilePosition=new h,this._tileScale=new h(1,1),this.dirty=!1,this.renderer=d,this.canvas=t.create(this,a,l),this.context=this.canvas.getContext("2d",{willReadFrequently:!1}),this.displayTexture=f,this.displayFrame=p,this._crop=this.resetCropObject(),this._textureKey=o(),this.texture=e.sys.textures.addCanvas(this._textureKey,this.canvas),this.frame=this.texture.get(),this.potWidth=s(p.width),this.potHeight=s(p.height),this.fillCanvas=t.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d",{willReadFrequently:!1}),this.fillPattern=null,this.setPosition(i,r),this.setSize(a,l),this.setFrame(c),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){var e=this.displayTexture.get(t);return this.potWidth=s(e.width),this.potHeight=s(e.height),this.canvas.width=0,e.cutWidth&&e.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=e,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,i=this.fillCanvas,n=this.potWidth,s=this.potHeight;this.renderer&&this.renderer.gl||(n=t.cutWidth,s=t.cutHeight),e.clearRect(0,0,n,s),i.width=n,i.height=s,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,n,s),this.renderer&&this.renderer.gl?(this.fillPattern=this.renderer.canvasToTexture(i,this.fillPattern),this.fillPattern.spectorMetadata={textureKey:"TileSprite Game Object"}):this.fillPattern=e.createPattern(i,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||r.disable(e);var i=this._tileScale.x,n=this._tileScale.y,s=this._tilePosition.x,a=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(i,n),e.translate(-s,-a),e.fillStyle=this.fillPattern,e.fillRect(s,a,this.width/i,this.height/n),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),t.remove(this.canvas),t.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null;var e=this.texture;e&&e.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});return IX=l}function GV(){if(zG)return UG;zG=1;var t=Jh(),e=Vh(),i=ac(),n=KF(),s=pI(),r=ZF(),a=Qh(),o=OG?LG:(OG=1,LG={COMPLETE:NX?BX:(NX=1,BX="complete"),DECODED:zX?UX:(zX=1,UX="decoded"),DECODED_ALL:XX?YX:(XX=1,YX="decodedall"),DESTROY:WX?GX:(WX=1,GX="destroy"),DETUNE:VX?HX:(VX=1,HX="detune"),GLOBAL_DETUNE:qX?jX:(qX=1,jX="detune"),GLOBAL_MUTE:ZX?KX:(ZX=1,KX="mute"),GLOBAL_RATE:$X?JX:($X=1,JX="rate"),GLOBAL_VOLUME:tG?QX:(tG=1,QX="volume"),LOOP:iG?eG:(iG=1,eG="loop"),LOOPED:sG?nG:(sG=1,nG="looped"),MUTE:aG?rG:(aG=1,rG="mute"),PAN:hG?oG:(hG=1,oG="pan"),PAUSE_ALL:uG?lG:(uG=1,lG="pauseall"),PAUSE:dG?cG:(dG=1,cG="pause"),PLAY:pG?fG:(pG=1,fG="play"),RATE:vG?gG:(vG=1,gG="rate"),RESUME_ALL:yG?mG:(yG=1,mG="resumeall"),RESUME:wG?xG:(wG=1,xG="resume"),SEEK:bG?TG:(bG=1,TG="seek"),STOP_ALL:EG?SG:(EG=1,SG="stopall"),STOP:CG?_G:(CG=1,_G="stop"),UNLOCKED:PG?AG:(PG=1,AG="unlocked"),VOLUME:RG?MG:(RG=1,MG="volume")}),h=zV(),l=function(){if(NG)return BG;NG=1;var t;Hh();return t=DG?FG:(DG=1,FG=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),e.pipeline.batchSprite(e,i,n))}),kG||(kG=1,IG=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),BG={renderWebGL:t,renderCanvas:IG}}(),u=new e({Extends:r,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.TextureCrop,i.Tint,i.Transform,i.Visible,l],initialize:function(t,e,i,n){r.call(this,t,"Video"),this.video,this.videoTexture,this.videoTextureSource,this.snapshotTexture,this.flipY=!1,this._key=h(),this.touchLocked=!1,this.playWhenUnlocked=!1,this.frameReady=!1,this.isStalled=!1,this.failedPlayAttempts=0,this.metadata,this.retry=0,this.retryInterval=500,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={ended:this.completeHandler.bind(this),legacy:this.legacyPlayHandler.bind(this),playing:this.playingHandler.bind(this),seeked:this.seekedHandler.bind(this),seeking:this.seekingHandler.bind(this),stalled:this.stalledHandler.bind(this),suspend:this.stalledHandler.bind(this),waiting:this.stalledHandler.bind(this)},this._loadCallbackHandler=this.loadErrorHandler.bind(this),this._metadataCallbackHandler=this.metadataHandler.bind(this),this._crop=this.resetCropObject(),this.markers={},this._markerIn=0,this._markerOut=0,this._playingMarker=!1,this._lastUpdate=0,this.cacheKey="",this.isSeeking=!1,this._playCalled=!1,this._getFrame=!1,this._rfvCallbackId=0;var a=t.sys.game;this._device=a.device.video,this.setPosition(e,i),this.setSize(256,256),this.initPipeline(),this.initPostPipeline(!0),a.events.on(s.PAUSE,this.globalPause,this),a.events.on(s.RESUME,this.globalResume,this);var l=t.sys.sound;l&&l.on(o.GLOBAL_MUTE,this.globalMute,this),n&&this.load(n)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},load:function(t){var e=this.scene.sys.cache.video.get(t);return e?(this.cacheKey=t,this.loadHandler(e.url,e.noAudio,e.crossOrigin)):console.warn("No video in cache for key: "+t),this},changeSource:function(t,e,i,n,s){void 0===e&&(e=!0),void 0===i&&(i=!1),this.cacheKey!==t&&(this.load(t),e&&this.play(i,n,s))},getVideoKey:function(){return this.cacheKey},loadURL:function(t,e,i){void 0===e&&(e=!1);var n=this._device.getVideoURL(t);return n?(this.cacheKey="",this.loadHandler(n.url,e,i)):console.warn("No supported video format found for "+t),this},loadMediaStream:function(t,e,i){return this.loadHandler(null,e,i,t)},loadHandler:function(t,e,i,n){e||(e=!1);var s=this.video;if(s?(this.removeLoadEventHandlers(),this.stop()):((s=document.createElement("video")).controls=!1,s.setAttribute("playsinline","playsinline"),s.setAttribute("preload","auto"),s.setAttribute("disablePictureInPicture","true")),e?(s.muted=!0,s.defaultMuted=!0,s.setAttribute("autoplay","autoplay")):(s.muted=!1,s.defaultMuted=!1,s.removeAttribute("autoplay")),i?s.setAttribute("crossorigin",i):s.removeAttribute("crossorigin"),n)if("srcObject"in s)try{s.srcObject=n}catch(t){if("TypeError"!==t.name)throw t;s.src=URL.createObjectURL(n)}else s.src=URL.createObjectURL(n);else s.src=t;this.retry=0,this.video=s,this._playCalled=!1,s.load(),this.addLoadEventHandlers();var r=this.scene.sys.textures.get(this._key);return this.setTexture(r),this},requestVideoFrame:function(t,e){var i=this.video;if(i){var s=e.width,r=e.height,a=this.videoTexture,o=this.videoTextureSource,h=!a||o.source!==i;h?(this._codePaused=i.paused,this._codeMuted=i.muted,a?(o.source=i,o.width=s,o.height=r,a.get().setSize(s,r)):((a=this.scene.sys.textures.create(this._key,i,s,r)).add("__BASE",0,0,0,s,r),this.setTexture(a),this.videoTexture=a,this.videoTextureSource=a.source[0],this.videoTextureSource.setFlipY(this.flipY),this.emit(n.VIDEO_TEXTURE,this,a)),this.setSizeToFrame(),this.updateDisplayOrigin()):o.update(),this.isStalled=!1,this.metadata=e;var l=e.mediaTime;h&&(this._lastUpdate=l,this.emit(n.VIDEO_CREATED,this,s,r),this.frameReady||(this.frameReady=!0,this.emit(n.VIDEO_PLAY,this))),this._playingMarker?l>=this._markerOut&&(i.loop?(i.currentTime=this._markerIn,this.emit(n.VIDEO_LOOP,this)):(this.stop(!1),this.emit(n.VIDEO_COMPLETE,this))):l<this._lastUpdate&&this.emit(n.VIDEO_LOOP,this),this._lastUpdate=l,this._getFrame?(this.removeEventHandlers(),i.pause(),this._getFrame=!1):this._rfvCallbackId=this.video.requestVideoFrameCallback(this.requestVideoFrame.bind(this))}},play:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=a.MAX_SAFE_INTEGER);var n=this.video;return!n||this.isPlaying()?(n||console.warn("Video not loaded"),this):(void 0===t&&(t=n.loop),n.loop=t,this._markerIn=e,this._markerOut=i,this._playingMarker=e>-1&&i>e&&i<a.MAX_SAFE_INTEGER,this._playCalled||(this._getFrame=!1,this._rfvCallbackId=n.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this._playCalled=!0,this.createPlayPromise()),this)},getFirstFrame:function(){var t=this.video;return!t||this.isPlaying()?(t||console.warn("Video not loaded"),this):(this._playCalled||(this._getFrame=!0,this._rfvCallbackId=t.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this.createPlayPromise()),this)},addLoadEventHandlers:function(){var t=this.video;t&&(t.addEventListener("error",this._loadCallbackHandler),t.addEventListener("abort",this._loadCallbackHandler),t.addEventListener("loadedmetadata",this._metadataCallbackHandler))},removeLoadEventHandlers:function(){var t=this.video;t&&(t.removeEventListener("error",this._loadCallbackHandler),t.removeEventListener("abort",this._loadCallbackHandler))},addEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.addEventListener(i,e[i])}},removeEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.removeEventListener(i,e[i])}},createPlayPromise:function(t){void 0===t&&(t=!0);var e=this.video,i=e.play();if(void 0!==i){var n=this.playSuccess.bind(this),s=this.playError.bind(this);if(!t){var r=this;s=function(){r.failedPlayAttempts++}}i.then(n).catch(s)}else e.addEventListener("playing",this._callbacks.legacy),t||this.failedPlayAttempts++},addMarker:function(t,e,i){return!isNaN(e)&&e>=0&&!isNaN(i)&&i>e&&(this.markers[t]=[e,i]),this},playMarker:function(t,e){var i=this.markers[t];return i&&this.play(e,i[0],i[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,i,n,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=i),void 0===r&&(r=n);var a=this.video,o=this.snapshotTexture;return o?(o.setSize(s,r),a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)):(o=this.scene.sys.textures.createCanvas(h(),s,r),this.snapshotTexture=o,a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)),o.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},playSuccess:function(){if(this._playCalled){this.addEventHandlers(),this._codePaused=!1,this.touchLocked&&(this.touchLocked=!1,this.emit(n.VIDEO_UNLOCKED,this));var t=this.scene.sys.sound;t&&t.mute&&this.setMute(!0),this._markerIn>-1&&(this.video.currentTime=this._markerIn)}},playError:function(t){var e=t.name;"NotAllowedError"===e?(this.touchLocked=!0,this.playWhenUnlocked=!0,this.failedPlayAttempts=1,this.emit(n.VIDEO_LOCKED,this)):"NotSupportedError"===e?(this.stop(!1),this.emit(n.VIDEO_UNSUPPORTED,this,t)):(this.stop(!1),this.emit(n.VIDEO_ERROR,this,t))},legacyPlayHandler:function(){var t=this.video;t&&(this.playSuccess(),t.removeEventListener("playing",this._callbacks.legacy))},playingHandler:function(){this.isStalled=!1,this.emit(n.VIDEO_PLAYING,this)},loadErrorHandler:function(t){this.stop(!1),this.emit(n.VIDEO_ERROR,this,t)},metadataHandler:function(t){this.emit(n.VIDEO_METADATA,this,t)},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,1!==this.scaleX&&(this.scaleX=this.displayWidth/this.width),1!==this.scaleY&&(this.scaleY=this.displayHeight/this.height);var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},stalledHandler:function(t){this.isStalled=!0,this.emit(n.VIDEO_STALLED,this,t)},completeHandler:function(){this._playCalled=!1,this.emit(n.VIDEO_COMPLETE,this)},preUpdate:function(t,e){this.video&&this._playCalled&&this.touchLocked&&this.playWhenUnlocked&&(this.retry+=e,this.retry>=this.retryInterval&&(this.createPlayPromise(!1),this.retry=0))},seekTo:function(t){var e=this.video;if(e){var i=e.duration;if(i!==1/0&&!isNaN(i)){var n=i*t;this.setCurrentTime(n)}}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"==typeof t){var i=t[0],n=parseFloat(t.substr(1));"+"===i?t=e.currentTime+n:"-"===i&&(t=e.currentTime-n)}e.currentTime=t}return this},seekingHandler:function(){this.isSeeking=!0,this.emit(n.VIDEO_SEEKING,this)},seekedHandler:function(){this.isSeeking=!1,this.emit(n.VIDEO_SEEKED,this)},getProgress:function(){var t=this.video;if(t){var e=t.duration;if(e!==1/0&&!isNaN(e))return t.currentTime/e}return-1},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var i=this.video;i&&(i.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&!this.video.ended&&(this.removeEventHandlers(),this.video.pause())},globalResume:function(){this._systemPaused=!1,!this.video||this._codePaused||this.video.ended||this.createPlayPromise()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&!e.ended&&(t?e.paused||(this.removeEventHandlers(),e.pause()):t||(this._playCalled?e.paused&&!this._systemPaused&&this.createPlayPromise():this.play())),this},pause:function(){return this.setPaused(!0)},resume:function(){return this.setPaused(!1)},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(e){return void 0===e&&(e=1),this.video&&(this.video.volume=t(e,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this._playCalled&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&(this.scene.sys.textures.renameTexture(this._key,t),this.videoTextureSource.setFlipY(e)),this._key=t,this.flipY=e,!!this.videoTexture},stop:function(t){void 0===t&&(t=!0);var e=this.video;return e&&(this.removeEventHandlers(),e.cancelVideoFrameCallback(this._rfvCallbackId),e.pause()),this.retry=0,this._playCalled=!1,t&&this.emit(n.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(!1),this.removeLoadEventHandlers(),this.removeVideoElement();var t=this.scene.sys.game.events;t.off(s.PAUSE,this.globalPause,this),t.off(s.RESUME,this.globalResume,this);var e=this.scene.sys.sound;e&&e.off(o.GLOBAL_MUTE,this.globalMute,this)}});return UG=u}function WV(){if(XG)return YG;XG=1;var t=Vh(),e=ac(),i=ZF(),n=Lu(),s=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible],initialize:function(t,e,s){void 0===e&&(e="Shape"),i.call(this,t,e),this.geom=s,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new n,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,i){return void 0===i&&(i=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=i,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});return YG=s}function HV(){if(WG)return GG;WG=1;var t=Zk();return GG=function(e,i,n,s,r,a){for(var o=t.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*s),h=n.pathData,l=n.pathIndexes,u=0;u<l.length;u+=3){var c=2*l[u],d=2*l[u+1],f=2*l[u+2],p=h[c+0]-r,g=h[c+1]-a,v=h[d+0]-r,m=h[d+1]-a,y=h[f+0]-r,x=h[f+1]-a,w=i.getX(p,g),T=i.getY(p,g),b=i.getX(v,m),S=i.getY(v,m),E=i.getX(y,x),_=i.getY(y,x);e.batchTri(n,w,T,b,S,E,_,0,0,1,1,o,o,o,2)}}}function VV(){if(VG)return HG;VG=1;var t=Zk();return HG=function(e,i,n,s,r){var a=e.strokeTint,o=t.getTintAppendFloatAlpha(i.strokeColor,i.strokeAlpha*n);a.TL=o,a.TR=o,a.BL=o,a.BR=o;var h=i.pathData,l=h.length-1,u=i.lineWidth,c=u/2,d=h[0]-s,f=h[1]-r;i.closePath||(l-=2);for(var p=2;p<l;p+=2){var g=h[p]-s,v=h[p+1]-r;e.batchLine(d,f,g,v,c,c,u,p-2,!!i.closePath&&p===l-1),d=g,f=v}}}function jV(){return ZG?KG:(ZG=1,KG=function(t,e,i,n){var s=i||e.fillColor,r=n||e.fillAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.fillStyle="rgba("+a+","+o+","+h+","+r+")"})}function qV(){return $G?JG:($G=1,JG=function(t,e,i,n){var s=i||e.strokeColor,r=n||e.strokeAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.strokeStyle="rgba("+a+","+o+","+h+","+r+")",t.lineWidth=e.lineWidth})}function KV(){if(sW)return nW;sW=1;var t=function(){if(iW)return eW;iW=1;var t,e;Hh();return t=function(){if(qG)return jG;qG=1;var t=kU(),e=HV(),i=VV();return jG=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&e(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},jG}(),e=function(){if(tW)return QG;tW=1;var t=Xu(),e=jV(),i=qV(),n=YU();return QG=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(n(s,h,r,a,o)){var l=r.radius;h.beginPath(),h.arc(l-r.originX*(2*l),l-r.originY*(2*l),l,t(r._startAngle),t(r._endAngle),r.anticlockwise),r.closePath&&h.closePath(),r.isFilled&&(e(h,r),h.fill()),r.isStroked&&(i(h,r),h.stroke()),h.restore()}},QG}(),eW={renderWebGL:t,renderCanvas:e}}(),e=Vh(),i=Xu(),n=DB(),s=sl(),r=Qh(),a=WV(),o=new e({Extends:a,Mixins:[t],initialize:function(t,e,i,n,r,o,h,l,u){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=128),void 0===r&&(r=0),void 0===o&&(o=360),void 0===h&&(h=!1),a.call(this,t,"Arc",new s(0,0,n)),this._startAngle=r,this._endAngle=o,this._anticlockwise=h,this._iterations=.01,this.setPosition(e,i);var c=2*this.geom.radius;this.setSize(c,c),void 0!==l&&this.setFillStyle(l,u),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,s=this.geom.radius,a=i(this._startAngle),o=i(this._endAngle),h=s,l=s;o-=a,this._anticlockwise?o<-r.PI2?o=-r.PI2:o>0&&(o=-r.PI2+o%r.PI2):o>r.PI2?o=r.PI2:o<0&&(o=r.PI2+o%r.PI2);for(var u,c=[h+Math.cos(a)*s,l+Math.sin(a)*s];e<1;)u=o*e+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),e+=t;return u=o+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),c.push(h+Math.cos(a)*s,l+Math.sin(a)*s),this.pathIndexes=n(c),this.pathData=c,this}});return nW=o}function ZV(){if(dW)return cW;dW=1;var t=Vh(),e=function(){if(uW)return lW;uW=1;var t,e;Hh();return t=function(){if(aW)return rW;aW=1;var t=HV(),e=kU(),i=VV();return rW=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX+s._curveBounds.x,c=s._displayOriginY+s._curveBounds.y,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},rW}(),e=function(){if(hW)return oW;hW=1;var t=jV(),e=qV(),i=YU();return oW=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX+s._curveBounds.x,l=s._displayOriginY+s._curveBounds.y,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},oW}(),lW={renderWebGL:t,renderCanvas:e}}(),i=DB(),n=Fu(),s=WV(),r=new t({Extends:s,Mixins:[e],initialize:function(t,e,i,r,a,o){void 0===e&&(e=0),void 0===i&&(i=0),s.call(this,t,"Curve",r),this._smoothness=32,this._curveBounds=new n,this.closePath=!1,this.setPosition(e,i),void 0!==a&&this.setFillStyle(a,o),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],s=this.geom.getPoints(e),r=0;r<s.length;r++)n.push(s[r].x,s[r].y);return n.push(s[0].x,s[0].y),this.pathIndexes=i(n),this.pathData=n,this}});return cW=r}function JV(){if(wW)return xW;wW=1;var t=Vh(),e=DB(),i=function(){if(yW)return mW;yW=1;var t,e;Hh();return t=function(){if(pW)return fW;pW=1;var t=HV(),e=kU(),i=VV();return fW=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},fW}(),e=function(){if(vW)return gW;vW=1;var t=jV(),e=qV(),i=YU();return gW=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},gW}(),mW={renderWebGL:t,renderCanvas:e}}(),n=rV(),s=WV(),r=new t({Extends:s,Mixins:[i],initialize:function(t,e,i,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===a&&(a=128),s.call(this,t,"Ellipse",new n(r/2,a/2,r,a)),this._smoothness=64,this.setPosition(e,i),this.width=r,this.height=a,void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setPosition(t/2,e/2),this.geom.setSize(t,e),this.updateDisplayOrigin(),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],i=this.geom.getPoints(this._smoothness),n=0;n<i.length;n++)t.push(i[n].x,i[n].y);return t.push(i[0].x,i[0].y),this.pathIndexes=e(t),this.pathData=t,this}});return xW=r}function $V(){if(PW)return AW;PW=1;var t=Vh(),e=WV(),i=function(){if(CW)return _W;CW=1;var t,e;Hh();return t=function(){if(bW)return TW;bW=1;var t=kU(),e=Zk();return TW=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc).translate(-n._displayOriginX,-n._displayOriginY);var h,l,u=s.alpha*n.alpha,c=n.width,d=n.height,f=n.cellWidth,p=n.cellHeight,g=Math.ceil(c/f),v=Math.ceil(d/p),m=f,y=p,x=f-(g*f-c),w=p-(v*p-d),T=n.showCells,b=n.showAltCells,S=n.showOutline,E=0,_=0,C=0,A=0,P=0;if(S&&(m--,y--,x===f&&x--,w===p&&w--),i.pipelines.preBatch(n),T&&n.fillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<v;_++)for(b&&(C=_%2),E=0;E<g;E++)b&&C?C=0:(C++,A=E<g-1?m:x,P=_<v-1?y:w,a.batchFillRect(E*f,_*p,A,P));if(b&&n.altFillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.altFillColor,n.altFillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<v;_++)for(b&&(C=_%2),E=0;E<g;E++)!b||C?(C=0,A=E<g-1?m:x,P=_<v-1?y:w,a.batchFillRect(E*f,_*p,A,P)):C=1;if(S&&n.outlineFillAlpha>0){var M=a.strokeTint,R=e.getTintAppendFloatAlpha(n.outlineFillColor,n.outlineFillAlpha*u);for(M.TL=R,M.TR=R,M.BL=R,M.BR=R,E=1;E<g;E++){var L=E*f;a.batchLine(L,0,L,d,n.lineWidth,n.lineWidth,1,0,!1)}for(_=1;_<v;_++){var O=_*p;a.batchLine(0,O,c,O,n.lineWidth,n.lineWidth,1,0,!1)}}i.pipelines.postBatch(n)},TW}(),e=function(){if(EW)return SW;EW=1;var t=jV(),e=qV(),i=YU();return SW=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=-s._displayOriginX,l=-s._displayOriginY,u=r.alpha*s.alpha,c=s.width,d=s.height,f=s.cellWidth,p=s.cellHeight,g=Math.ceil(c/f),v=Math.ceil(d/p),m=f,y=p,x=f-(g*f-c),w=p-(v*p-d),T=s.showCells,b=s.showAltCells,S=s.showOutline,E=0,_=0,C=0,A=0,P=0;if(S&&(m--,y--,x===f&&x--,w===p&&w--),T&&s.fillAlpha>0)for(t(o,s),_=0;_<v;_++)for(b&&(C=_%2),E=0;E<g;E++)b&&C?C=0:(C++,A=E<g-1?m:x,P=_<v-1?y:w,o.fillRect(h+E*f,l+_*p,A,P));if(b&&s.altFillAlpha>0)for(t(o,s,s.altFillColor,s.altFillAlpha*u),_=0;_<v;_++)for(b&&(C=_%2),E=0;E<g;E++)!b||C?(C=0,A=E<g-1?m:x,P=_<v-1?y:w,o.fillRect(h+E*f,l+_*p,A,P)):C=1;if(S&&s.outlineFillAlpha>0){for(e(o,s,s.outlineFillColor,s.outlineFillAlpha*u),E=1;E<g;E++){var M=E*f;o.beginPath(),o.moveTo(M+h,l),o.lineTo(M+h,d+l),o.stroke()}for(_=1;_<v;_++){var R=_*p;o.beginPath(),o.moveTo(h,R+l),o.lineTo(h+c,R+l),o.stroke()}}o.restore()}},SW}(),_W={renderWebGL:t,renderCanvas:e}}(),n=new t({Extends:e,Mixins:[i],initialize:function(t,i,n,s,r,a,o,h,l,u,c){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=128),void 0===r&&(r=128),void 0===a&&(a=32),void 0===o&&(o=32),e.call(this,t,"Grid",null),this.cellWidth=a,this.cellHeight=o,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(i,n),this.setSize(s,r),this.setFillStyle(h,l),void 0!==u&&this.setOutlineStyle(u,c),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});return AW=n}function QV(){if(kW)return IW;kW=1;var t=function(){if(DW)return FW;DW=1;var t,e;Hh();return t=function(){if(RW)return MW;RW=1;var t=kU(),e=Zk();return MW=function(i,n,s,r){s.addToRenderList(n);var a,o,h,l,u,c,d,f,p,g=i.pipelines.set(n.pipeline),v=t(n,s,r),m=g.calcMatrix.copyFrom(v.calc),y=n.width,x=n.height,w=y/2,T=y/n.projection,b=s.alpha*n.alpha;n.isFilled&&(i.pipelines.preBatch(n),n.showTop&&(a=e.getTintAppendFloatAlpha(n.fillTop,b),o=m.getX(-w,-x),h=m.getY(-w,-x),l=m.getX(0,-T-x),u=m.getY(0,-T-x),c=m.getX(w,-x),d=m.getY(w,-x),f=m.getX(0,T-x),p=m.getY(0,T-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showLeft&&(a=e.getTintAppendFloatAlpha(n.fillLeft,b),o=m.getX(-w,0),h=m.getY(-w,0),l=m.getX(0,T),u=m.getY(0,T),c=m.getX(0,T-x),d=m.getY(0,T-x),f=m.getX(-w,-x),p=m.getY(-w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showRight&&(a=e.getTintAppendFloatAlpha(n.fillRight,b),o=m.getX(w,0),h=m.getY(w,0),l=m.getX(0,T),u=m.getY(0,T),c=m.getX(0,T-x),d=m.getY(0,T-x),f=m.getX(w,-x),p=m.getY(w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),i.pipelines.postBatch(n))},MW}(),e=function(){if(OW)return LW;OW=1;var t=jV(),e=YU();return LW=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection;n.showTop&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(l,-1),a.lineTo(0,u-1),a.lineTo(-l,-1),a.lineTo(-l,-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(-l,-h),a.lineTo(-l,0),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(l,-h),a.lineTo(l,0),a.fill()),a.restore()}},LW}(),FW={renderWebGL:t,renderCanvas:e}}(),e=Vh(),i=WV(),n=new e({Extends:i,Mixins:[t],initialize:function(t,e,n,s,r,a,o,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=15658734),void 0===o&&(o=10066329),void 0===h&&(h=13421772),i.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=a,this.fillLeft=o,this.fillRight=h,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return IW=n}function tj(){if(WW)return GW;WW=1;var t=Vh(),e=function(){if(XW)return YW;XW=1;var t,e;Hh();return t=function(){if(NW)return BW;NW=1;var t=kU(),e=Zk();return BW=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r),h=a.calcMatrix.copyFrom(o.calc),l=n.width,u=n.height,c=l/2,d=l/n.projection,f=n.isReversed,p=s.alpha*n.alpha;if(n.isFilled){var g,v,m,y,x,w,T;if(i.pipelines.preBatch(n),n.showTop&&f){g=e.getTintAppendFloatAlpha(n.fillTop,p),v=h.getX(-c,-u),m=h.getY(-c,-u),y=h.getX(0,-d-u),x=h.getY(0,-d-u),w=h.getX(c,-u),T=h.getY(c,-u);var b=h.getX(0,d-u),S=h.getY(0,d-u);a.batchQuad(n,v,m,y,x,w,T,b,S,0,0,1,1,g,g,g,g,2)}n.showLeft&&(g=e.getTintAppendFloatAlpha(n.fillLeft,p),f?(v=h.getX(-c,-u),m=h.getY(-c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),T=h.getY(0,d-u)):(v=h.getX(-c,0),m=h.getY(-c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),T=h.getY(0,d-u)),a.batchTri(n,v,m,y,x,w,T,0,0,1,1,g,g,g,2)),n.showRight&&(g=e.getTintAppendFloatAlpha(n.fillRight,p),f?(v=h.getX(c,-u),m=h.getY(c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),T=h.getY(0,d-u)):(v=h.getX(c,0),m=h.getY(c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),T=h.getY(0,d-u)),a.batchTri(n,v,m,y,x,w,T,0,0,1,1,g,g,g,2)),i.pipelines.postBatch(n)}},BW}(),e=function(){if(zW)return UW;zW=1;var t=jV(),e=YU();return UW=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection,c=n.isReversed;n.showTop&&c&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(0,u-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),c?(a.moveTo(-l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),c?(a.moveTo(l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),a.restore()}},UW}(),YW={renderWebGL:t,renderCanvas:e}}(),i=WV(),n=new t({Extends:i,Mixins:[e],initialize:function(t,e,n,s,r,a,o,h,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=!1),void 0===o&&(o=15658734),void 0===h&&(h=10066329),void 0===l&&(l=13421772),i.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=o,this.fillLeft=h,this.fillRight=l,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=a,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return GW=n}function ej(){if($W)return JW;$W=1;var t=Vh(),e=WV(),i=Lu(),n=function(){if(ZW)return KW;ZW=1;var t,e;Hh();return t=function(){if(VW)return HW;VW=1;var t=kU(),e=Zk();return HW=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc);var h=n._displayOriginX,l=n._displayOriginY,u=s.alpha*n.alpha;if(i.pipelines.preBatch(n),n.isStroked){var c=a.strokeTint,d=e.getTintAppendFloatAlpha(n.strokeColor,n.strokeAlpha*u);c.TL=d,c.TR=d,c.BL=d,c.BR=d,a.batchLine(n.geom.x1-h,n.geom.y1-l,n.geom.x2-h,n.geom.y2-l,n._startWidth/2,n._endWidth/2,1,0,!1,o.sprite,o.camera)}i.pipelines.postBatch(n)},HW}(),e=function(){if(qW)return jW;qW=1;var t=qV(),e=YU();return jW=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)){var o=n._displayOriginX,h=n._displayOriginY;n.isStroked&&(t(a,n),a.beginPath(),a.moveTo(n.geom.x1-o,n.geom.y1-h),a.lineTo(n.geom.x2-o,n.geom.y2-h),a.stroke()),a.restore()}},jW}(),KW={renderWebGL:t,renderCanvas:e}}(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=128),void 0===h&&(h=0),e.call(this,t,"Line",new i(r,a,o,h));var c=Math.max(1,this.geom.right-this.geom.left),d=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(n,s),this.setSize(c,d),void 0!==l&&this.setStrokeStyle(1,l,u),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,i,n){return this.geom.setTo(t,e,i,n),this}});return JW=s}function ij(){if(aH)return rH;aH=1;var t=Fu();return rH=function(e,i){void 0===i&&(i=new t);for(var n,s=1/0,r=1/0,a=-s,o=-r,h=0;h<e.points.length;h++)n=e.points[h],s=Math.min(s,n.x),r=Math.min(r,n.y),a=Math.max(a,n.x),o=Math.max(o,n.y);return i.x=s,i.y=r,i.width=a-s,i.height=o-r,i},rH}function nj(){return hH||(hH=1,oH=function(t,e,i){for(var n=!1,s=-1,r=t.points.length-1;++s<t.points.length;r=s){var a=t.points[s].x,o=t.points[s].y,h=t.points[r].x,l=t.points[r].y;(o<=i&&i<l||l<=i&&i<o)&&e<(h-a)*(i-o)/(l-o)+a&&(n=!n)}return n}),oH}function sj(){if(uH)return lH;uH=1;var t=Cu(),e=Lu();return lH=function(i){for(var n=i.points,s=0,r=0;r<n.length;r++){var a=n[r],o=n[(r+1)%n.length],h=new e(a.x,a.y,o.x,o.y);s+=t(h)}return s},lH}function rj(){if(dH)return cH;dH=1;var t=Cu(),e=Lu(),i=sj();return cH=function(n,s,r,a){void 0===a&&(a=[]);var o=n.points,h=i(n);!s&&r>0&&(s=h/r);for(var l=0;l<s;l++)for(var u=h*(l/s),c=0,d=0;d<o.length;d++){var f=o[d],p=o[(d+1)%o.length],g=new e(f.x,f.y,p.x,p.y),v=t(g);if(!(u<c||u>c+v)){var m=g.getPoint((u-c)/v);a.push(m);break}c+=v}return a},cH}function aj(){if(pH)return fH;pH=1;var t=Vh(),e=nj(),i=rj(),n=qh(),s=new t({initialize:function(t){this.type=n.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,i){return e(this,t,i)},setTo:function(t){if(this.area=0,this.points=[],"string"==typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,i=0;i<t.length;i++)e={x:0,y:0},"number"==typeof t[i]||"string"==typeof t[i]?(e.x=parseFloat(t[i]),e.y=parseFloat(t[i+1]),i++):Array.isArray(t[i])?(e.x=t[i][0],e.y=t[i][1]):(e.x=t[i].x,e.y=t[i].y),this.points.push(e);return this.calculateArea(),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,i=0,n=0;n<this.points.length-1;n++)t=this.points[n],i+=((e=this.points[n+1]).x-t.x)*(t.y+e.y);return t=this.points[0],e=this.points[this.points.length-1],i+=(t.x-e.x)*(e.y+t.y),this.area=.5*-i,this.area},getPoints:function(t,e,n){return i(this,t,e,n)}});return fH=s}function oj(){if(vH)return gH;vH=1;var t=function(t,e){return t[0]=e[0],t[1]=e[1],t};return gH=function(e){var i,n=[],s=e.points;for(i=0;i<s.length;i++)n.push([s[i].x,s[i].y]);var r=[];for(n.length>0&&r.push(t([0,0],n[0])),i=0;i<n.length-1;i++){var a=n[i],o=n[i+1],h=a[0],l=a[1],u=o[0],c=o[1];r.push([.85*h+.15*u,.85*l+.15*c]),r.push([.15*h+.85*u,.15*l+.85*c])}return n.length>1&&r.push(t([0,0],n[n.length-1])),e.setTo(r)},gH}function hj(){if(yH)return mH;yH=1;var t=function(){if(sH)return nH;sH=1;var t,e;Hh();return t=function(){if(tH)return QW;tH=1;var t=HV(),e=kU(),i=VV();return QW=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},QW}(),e=function(){if(iH)return eH;iH=1;var t=jV(),e=qV(),i=YU();return eH=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},eH}(),nH={renderWebGL:t,renderCanvas:e}}(),e=Vh(),i=DB(),n=ij(),s=aj(),r=WV(),a=oj(),o=new e({Extends:r,Mixins:[t],initialize:function(t,e,i,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),r.call(this,t,"Polygon",new s(a));var l=n(this.geom);this.setPosition(e,i),this.setSize(l.width,l.height),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)a(this.geom);return this.updateData()},setTo:function(t){this.geom.setTo(t);var e=n(this.geom);return this.setSize(e.width,e.height),this.updateDisplayOrigin(),this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=i(t),this.pathData=t,this}});return mH=o}function lj(){if(CH)return _H;CH=1;var t=Vh(),e=DB(),i=Fu(),n=WV(),s=function(){if(EH)return SH;EH=1;var t,e;Hh();return t=function(){if(wH)return xH;wH=1;var t=HV(),e=kU(),i=VV(),n=Zk();return xH=function(s,r,a,o){a.addToRenderList(r);var h=s.pipelines.set(r.pipeline),l=e(r,a,o);h.calcMatrix.copyFrom(l.calc);var u=r._displayOriginX,c=r._displayOriginY,d=a.alpha*r.alpha;if(s.pipelines.preBatch(r),r.isRounded&&r.isFilled)t(h,l.calc,r,d,u,c);else if(r.isFilled){var f=h.fillTint,p=n.getTintAppendFloatAlpha(r.fillColor,r.fillAlpha*d);f.TL=p,f.TR=p,f.BL=p,f.BR=p,h.batchFillRect(-u,-c,r.width,r.height)}r.isStroked&&i(h,r,d,u,c),s.pipelines.postBatch(r)},xH}(),e=function(){if(bH)return TH;bH=1;var t=jV(),e=qV(),i=YU(),n=function(t,e,i,n,s,r){var a=Math.min(n/2,s/2),o=Math.min(r,a);0!==o?(t.moveTo(e+o,i),t.lineTo(e+n-o,i),t.arcTo(e+n,i,e+n,i+o,o),t.lineTo(e+n,i+s-o),t.arcTo(e+n,i+s,e+n-o,i+s,o),t.lineTo(e+o,i+s),t.arcTo(e,i+s,e,i+s-o,o),t.lineTo(e,i+o),t.arcTo(e,i,e+o,i,o),t.closePath()):t.rect(e,i,n,s)};return TH=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(i(s,h,r,a,o)){var l=r._displayOriginX,u=r._displayOriginY;r.isFilled&&(t(h,r),r.isRounded?(h.beginPath(),n(h,-l,-u,r.width,r.height,r.radius),h.fill()):h.fillRect(-l,-u,r.width,r.height)),r.isStroked&&(e(h,r),h.beginPath(),r.isRounded?n(h,-l,-u,r.width,r.height,r.radius):h.rect(-l,-u,r.width,r.height),h.stroke()),h.restore()}},TH}(),SH={renderWebGL:t,renderCanvas:e}}(),r=new t({Extends:n,Mixins:[s],initialize:function(t,e,s,r,a,o,h){void 0===e&&(e=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),n.call(this,t,"Rectangle",new i(0,0,r,a)),this.radius=20,this.isRounded=!1,this.setPosition(e,s),this.setSize(r,a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setRounded:function(t){return void 0===t&&(t=16),this.radius=t,this.isRounded=t>0,this.updateRoundedData()},setSize:function(t,e){this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},updateData:function(){if(this.isRounded)return this.updateRoundedData();var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),e.getLineD(i),t.push(i.x2,i.y2),this.pathData=t,this},updateRoundedData:function(){var t=[],i=this.width/2,n=this.height/2,s=Math.min(i,n),r=Math.min(this.radius,s),a=i,o=n,h=Math.max(1,Math.floor(r/5));return this.arcTo(t,a-i+r,o-n+r,r,Math.PI,1.5*Math.PI,h),t.push(a+i-r,o-n),this.arcTo(t,a+i-r,o-n+r,r,1.5*Math.PI,2*Math.PI,h),t.push(a+i,o+n-r),this.arcTo(t,a+i-r,o+n-r,r,0,.5*Math.PI,h),t.push(a-i+r,o+n),this.arcTo(t,a-i+r,o+n-r,r,.5*Math.PI,Math.PI,h),t.push(a-i,o-n+r),this.pathIndexes=e(t),this.pathData=t,this},arcTo:function(t,e,i,n,s,r,a){for(var o=(r-s)/a,h=0;h<=a;h++){var l=s+o*h;t.push(e+Math.cos(l)*n,i+Math.sin(l)*n)}}});return _H=r}function uj(){if(DH)return FH;DH=1;var t=function(){if(OH)return LH;OH=1;var t,e;Hh();return t=function(){if(PH)return AH;PH=1;var t=HV(),e=kU(),i=VV();return AH=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},AH}(),e=function(){if(RH)return MH;RH=1;var t=jV(),e=qV(),i=YU();return MH=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,v=u[p+1]-l;o.lineTo(g,v)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},MH}(),LH={renderWebGL:t,renderCanvas:e}}(),e=Vh(),i=DB(),n=WV(),s=new e({Extends:n,Mixins:[t],initialize:function(t,e,i,s,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=5),void 0===r&&(r=32),void 0===a&&(a=64),n.call(this,t,"Star",null),this._points=s,this._innerRadius=r,this._outerRadius=a,this.setPosition(e,i),this.setSize(2*a,2*a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,s=this._outerRadius,r=Math.PI/2*3,a=Math.PI/e,o=s,h=s;t.push(o,h+-s);for(var l=0;l<e;l++)t.push(o+Math.cos(r)*s,h+Math.sin(r)*s),r+=a,t.push(o+Math.cos(r)*n,h+Math.sin(r)*n),r+=a;return t.push(o,h+-s),this.pathIndexes=i(t),this.pathData=t,this}});return FH=s}function cj(){return kH||(kH=1,IH=function(t,e,i){var n=t.x3-t.x1,s=t.y3-t.y1,r=t.x2-t.x1,a=t.y2-t.y1,o=e-t.x1,h=i-t.y1,l=n*n+s*s,u=n*r+s*a,c=n*o+s*h,d=r*r+a*a,f=r*o+a*h,p=l*d-u*u,g=0===p?0:1/p,v=(d*c-u*f)*g,m=(l*f-u*c)*g;return v>=0&&m>=0&&v+m<1}),IH}function dj(){if(NH)return BH;NH=1;var t=Kh(),e=Cu();return BH=function(i,n,s){void 0===s&&(s=new t);var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();if(n<=0||n>=1)return s.x=r.x1,s.y=r.y1,s;var h=e(r),l=e(a),u=e(o),c=(h+l+u)*n,d=0;return c<h?(d=c/h,s.x=r.x1+(r.x2-r.x1)*d,s.y=r.y1+(r.y2-r.y1)*d):c>h+l?(d=(c-=h+l)/u,s.x=o.x1+(o.x2-o.x1)*d,s.y=o.y1+(o.y2-o.y1)*d):(d=(c-=h)/l,s.x=a.x1+(a.x2-a.x1)*d,s.y=a.y1+(a.y2-a.y1)*d),s},BH}function fj(){if(zH)return UH;zH=1;var t=Cu(),e=Kh();return UH=function(i,n,s,r){void 0===r&&(r=[]);var a=i.getLineA(),o=i.getLineB(),h=i.getLineC(),l=t(a),u=t(o),c=t(h),d=l+u+c;!n&&s>0&&(n=d/s);for(var f=0;f<n;f++){var p=d*(f/n),g=0,v=new e;p<l?(g=p/l,v.x=a.x1+(a.x2-a.x1)*g,v.y=a.y1+(a.y2-a.y1)*g):p>l+u?(g=(p-=l+u)/c,v.x=h.x1+(h.x2-h.x1)*g,v.y=h.y1+(h.y2-h.y1)*g):(g=(p-=l)/u,v.x=o.x1+(o.x2-o.x1)*g,v.y=o.y1+(o.y2-o.y1)*g),r.push(v)}return r},UH}function pj(){if(XH)return YH;XH=1;var t=Vh(),e=cj(),i=dj(),n=fj(),s=qh(),r=Lu(),a=LD(),o=new t({initialize:function(t,e,i,n,r,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),this.type=s.TRIANGLE,this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=r,this.y3=a},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=s,this.y3=r,this},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}}});return YH=o}function gj(){if(ZH)return KH;ZH=1;var t=Vh(),e=WV(),i=pj(),n=function(){if(qH)return jH;qH=1;var t,e;Hh();return t=function(){if(WH)return GH;WH=1;var t=kU(),e=VV(),i=Zk();return GH=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a);o.calcMatrix.copyFrom(h.calc);var l=s._displayOriginX,u=s._displayOriginY,c=r.alpha*s.alpha;if(n.pipelines.preBatch(s),s.isFilled){var d=o.fillTint,f=i.getTintAppendFloatAlpha(s.fillColor,s.fillAlpha*c);d.TL=f,d.TR=f,d.BL=f,d.BR=f;var p=s.geom.x1-l,g=s.geom.y1-u,v=s.geom.x2-l,m=s.geom.y2-u,y=s.geom.x3-l,x=s.geom.y3-u;o.batchFillTriangle(p,g,v,m,y,x,h.sprite,h.camera)}s.isStroked&&e(o,s,c,l,u),n.pipelines.postBatch(s)},GH}(),e=function(){if(VH)return HH;VH=1;var t=jV(),e=qV(),i=YU();return HH=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.geom.x1-h,c=s.geom.y1-l,d=s.geom.x2-h,f=s.geom.y2-l,p=s.geom.x3-h,g=s.geom.y3-l;o.beginPath(),o.moveTo(u,c),o.lineTo(d,f),o.lineTo(p,g),o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},HH}(),jH={renderWebGL:t,renderCanvas:e}}(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u,c,d){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=128),void 0===o&&(o=64),void 0===h&&(h=0),void 0===l&&(l=128),void 0===u&&(u=128),e.call(this,t,"Triangle",new i(r,a,o,h,l,u));var f=this.geom.right-this.geom.left,p=this.geom.bottom-this.geom.top;this.setPosition(n,s),this.setSize(f,p),void 0!==c&&this.setFillStyle(c,d),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,i,n,s,r){return this.geom.setTo(t,e,i,n,s,r),this.updateData()},updateData:function(){var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),this.pathData=t,this}});return KH=s}var vj,mj={};function yj(){if(vj)return mj;vj=1;var t=HU();return Nu().register("blitter",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),mj}var xj,wj={};function Tj(){if(xj)return wj;xj=1;var t=jU();return Nu().register("container",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),wj}var bj,Sj={};function Ej(){if(bj)return Sj;bj=1;var t=KU();return Nu().register("dom",function(e,i,n,s,r){var a=new t(this.scene,e,i,n,s,r);return this.displayList.add(a),a}),Sj}var _j,Cj={};function Aj(){if(_j)return Cj;_j=1;var t=ZU();return Nu().register("dynamicBitmapText",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,s,r))}),Cj}var Pj,Mj={};function Rj(){if(Pj)return Mj;Pj=1;var t=$H();return Nu().register("extern",function(){var e=new t(this.scene);return this.displayList.add(e),e}),Mj}var Lj,Oj={};function Fj(){if(Lj)return Oj;Lj=1;var t=oV();return Nu().register("graphics",function(e){return this.displayList.add(new t(this.scene,e))}),Oj}var Dj,Ij={};function kj(){if(Dj)return Ij;Dj=1;var t=cV();return Nu().register("group",function(e,i){return this.updateList.add(new t(this.scene,e,i))}),Ij}var Bj,Nj={};function Uj(){if(Bj)return Nj;Bj=1;var t=wU();return Nu().register("image",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),Nj}var zj,Yj={};function Xj(){if(zj)return Yj;zj=1;var t=dV();return Nu().register("layer",function(e){return this.displayList.add(new t(this.scene,e))}),Yj}var Gj,Wj={};function Hj(){if(Gj)return Wj;Gj=1;var t=Nu(),e=LV();return t.register("particles",function(t,i,n,s){return void 0!==t&&"string"==typeof t&&console.warn("ParticleEmitterManager was removed in Phaser 3.60. See documentation for details"),this.displayList.add(new e(this.scene,t,i,n,s))}),Wj}var Vj,jj={};function qj(){if(Vj)return jj;Vj=1;var t=Nu(),e=OV();return t.register("follower",function(t,i,n,s,r){var a=new e(this.scene,t,i,n,s,r);return this.displayList.add(a),this.updateList.add(a),a}),jj}var Kj,Zj={};function Jj(){if(Kj)return Zj;Kj=1;var t=Nu(),e=FV();return t.register("renderTexture",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),Zj}var $j,Qj={};function tq(){if($j)return Qj;$j=1;var t=kV();return Nu().register("rope",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),Qj}var eq,iq={};function nq(){if(eq)return iq;eq=1;var t=Nu(),e=uV();return t.register("sprite",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),iq}var sq,rq={};function aq(){if(sq)return rq;sq=1;var t=GU();return Nu().register("bitmapText",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),rq}var oq,hq={};function lq(){if(oq)return hq;oq=1;var t=YV();return Nu().register("text",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),hq}var uq,cq={};function dq(){if(uq)return cq;uq=1;var t=XV();return Nu().register("tileSprite",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),cq}var fq,pq={};function gq(){if(fq)return pq;fq=1;var t=JF();return Nu().register("zone",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),pq}var vq,mq={};function yq(){if(vq)return mq;vq=1;var t=GV();return Nu().register("video",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),mq}var xq,wq={};function Tq(){if(xq)return wq;xq=1;var t=KV(),e=Nu();return e.register("arc",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),e.register("circle",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,0,360,!1,s,r))}),wq}var bq,Sq={};function Eq(){if(bq)return Sq;bq=1;var t=Nu(),e=ZV();return t.register("curve",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),Sq}var _q,Cq={};function Aq(){if(_q)return Cq;_q=1;var t=JV();return Nu().register("ellipse",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),Cq}var Pq,Mq={};function Rq(){if(Pq)return Mq;Pq=1;var t=Nu(),e=$V();return t.register("grid",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),Mq}var Lq,Oq={};function Fq(){if(Lq)return Oq;Lq=1;var t=Nu(),e=QV();return t.register("isobox",function(t,i,n,s,r,a,o){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o))}),Oq}var Dq,Iq={};function kq(){if(Dq)return Iq;Dq=1;var t=Nu(),e=tj();return t.register("isotriangle",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),Iq}var Bq,Nq={};function Uq(){if(Bq)return Nq;Bq=1;var t=Nu(),e=ej();return t.register("line",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),Nq}var zq,Yq={};function Xq(){if(zq)return Yq;zq=1;var t=Nu(),e=hj();return t.register("polygon",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),Yq}var Gq,Wq={};function Hq(){if(Gq)return Wq;Gq=1;var t=Nu(),e=lj();return t.register("rectangle",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),Wq}var Vq,jq={};function qq(){if(Vq)return jq;Vq=1;var t=uj();return Nu().register("star",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),jq}var Kq,Zq={};function Jq(){if(Kq)return Zq;Kq=1;var t=Nu(),e=gj();return t.register("triangle",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),Zq}var $q,Qq={};function tK(){if($q)return Qq;$q=1;var t=HU(),e=NU(),i=iU(),n=BU();return i.register("blitter",function(i,s){void 0===i&&(i={});var r=n(i,"key",null),a=n(i,"frame",null),o=new t(this.scene,0,0,r,a);return void 0!==s&&(i.add=s),e(this.scene,o,i),o}),Qq}var eK,iK={};function nK(){if(eK)return iK;eK=1;var t=NU(),e=jU(),i=iU(),n=BU(),s=Wh();return i.register("container",function(i,r){void 0===i&&(i={});var a=n(i,"x",0),o=n(i,"y",0),h=s(i,"children",null),l=new e(this.scene,a,o,h);return void 0!==r&&(i.add=r),t(this.scene,l,i),l}),iK}var sK,rK={};function aK(){if(sK)return rK;sK=1;var t=ZU(),e=NU(),i=iU(),n=BU();return i.register("dynamicBitmapText",function(i,s){void 0===i&&(i={});var r=n(i,"font",""),a=n(i,"text",""),o=n(i,"size",!1),h=new t(this.scene,0,0,r,a,o);return void 0!==s&&(i.add=s),e(this.scene,h,i),h}),rK}var oK,hK={};function lK(){if(oK)return hK;oK=1;var t=iU(),e=oV();return t.register("graphics",function(t,i){void 0===t&&(t={}),void 0!==i&&(t.add=i);var n=new e(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n}),hK}var uK,cK={};function dK(){if(uK)return cK;uK=1;var t=iU(),e=cV();return t.register("group",function(t){return new e(this.scene,null,t)}),cK}var fK,pK={};function gK(){if(fK)return pK;fK=1;var t=NU(),e=iU(),i=BU(),n=wU();return e.register("image",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"frame",null),o=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,o,e),o}),pK}var vK,mK={};function yK(){if(vK)return mK;vK=1;var t=NU(),e=dV(),i=iU(),n=BU();return i.register("layer",function(i,s){void 0===i&&(i={});var r=n(i,"children",null),a=new e(this.scene,r);return void 0!==s&&(i.add=s),t(this.scene,a,i),a}),mK}var xK,wK={};function TK(){if(xK)return wK;xK=1;var t=NU(),e=iU(),i=BU(),n=Wh(),s=LV();return e.register("particles",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=n(e,"config",null),h=new s(this.scene,0,0,a);return void 0!==r&&(e.add=r),t(this.scene,h,e),o&&h.setConfig(o),h}),wK}var bK,SK={};function EK(){if(bK)return SK;bK=1;var t=NU(),e=iU(),i=BU(),n=FV();return e.register("renderTexture",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",32),h=i(e,"height",32),l=new n(this.scene,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),SK}var _K,CK={};function AK(){if(_K)return CK;_K=1;var t=NU(),e=iU(),i=BU(),n=Ol(),s=kV();return e.register("rope",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=i(e,"horizontal",!0),l=n(e,"points",void 0),u=n(e,"colors",void 0),c=n(e,"alphas",void 0),d=new s(this.scene,0,0,a,o,l,h,u,c);return void 0!==r&&(e.add=r),t(this.scene,d,e),d}),CK}var PK,MK={};function RK(){if(PK)return MK;PK=1;var t=NU(),e=UU(),i=iU(),n=BU(),s=uV();return i.register("sprite",function(i,r){void 0===i&&(i={});var a=n(i,"key",null),o=n(i,"frame",null),h=new s(this.scene,0,0,a,o);return void 0!==r&&(i.add=r),t(this.scene,h,i),e(h,i),h}),MK}var LK,OK={};function FK(){if(LK)return OK;LK=1;var t=GU(),e=NU(),i=iU(),n=BU(),s=Ol();return i.register("bitmapText",function(i,r){void 0===i&&(i={});var a=s(i,"font",""),o=n(i,"text",""),h=n(i,"size",!1),l=s(i,"align",0),u=new t(this.scene,0,0,a,o,h,l);return void 0!==r&&(i.add=r),e(this.scene,u,i),u}),OK}var DK,IK={};function kK(){if(DK)return IK;DK=1;var t=NU(),e=iU(),i=BU(),n=YV();return e.register("text",function(e,s){void 0===e&&(e={});var r=i(e,"text",""),a=i(e,"style",null),o=i(e,"padding",null);null!==o&&(a.padding=o);var h=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,h,e),h.autoRound=i(e,"autoRound",!0),h.resolution=i(e,"resolution",1),h}),IK}var BK,NK={};function UK(){if(BK)return NK;BK=1;var t=NU(),e=iU(),i=BU(),n=XV();return e.register("tileSprite",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",512),h=i(e,"height",512),l=i(e,"key",""),u=i(e,"frame",""),c=new n(this.scene,r,a,o,h,l,u);return void 0!==s&&(e.add=s),t(this.scene,c,e),c}),NK}var zK,YK={};function XK(){if(zK)return YK;zK=1;var t=iU(),e=BU(),i=JF();return t.register("zone",function(t){var n=e(t,"x",0),s=e(t,"y",0),r=e(t,"width",1),a=e(t,"height",r);return new i(this.scene,n,s,r,a)}),YK}var GK,WK,HK,VK,jK,qK,KK,ZK,JK,$K,QK,tZ,eZ,iZ,nZ,sZ,rZ,aZ,oZ,hZ,lZ,uZ,cZ,dZ,fZ,pZ,gZ,vZ,mZ,yZ,xZ,wZ,TZ,bZ,SZ,EZ,_Z,CZ,AZ,PZ,MZ,RZ,LZ,OZ={};function FZ(){if(GK)return OZ;GK=1;var t=NU(),e=iU(),i=BU(),n=GV();return e.register("video",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=new n(this.scene,0,0,r);return void 0!==s&&(e.add=s),t(this.scene,a,e),a}),OZ}function DZ(){return HK?WK:(HK=1,WK=function(t,e,i){if(!t||"number"==typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=i,!0;if(-1!==e.indexOf(".")){for(var n=e.split("."),s=t,r=t,a=0;a<n.length;a++){if(!s.hasOwnProperty(n[a]))return!1;r=s,s=s[n[a]]}return r[n[n.length-1]]=i,!0}return!1})}function IZ(){if(QK)return $K;QK=1;var t=Vh(),e=ac(),i=ZF(),n=Wh(),s=nh(),r=DZ(),a=function(){if(JK)return ZK;JK=1;var t,e;Hh();return t=function(){if(jK)return VK;jK=1;var t=kU();return VK=function(e,i,n,s){if(i.shader){if(n.addToRenderList(i),e.pipelines.clear(),i.renderToTexture)i.load(),i.flush();else{var r=t(i,n,s).calc;e.width===i._rendererWidth&&e.height===i._rendererHeight||i.projOrtho(0,e.width,e.height,0),i.load(r.matrix),i.flush()}e.pipelines.rebind()}},VK}(),e=KK?qK:(KK=1,qK=function(){}),ZK={renderWebGL:t,renderCanvas:e}}(),o=tc(),h=Tl(),l=Yk(),u=new t({Extends:i,Mixins:[e.ComputedSize,e.Depth,e.GetBounds,e.Mask,e.Origin,e.ScrollFactor,e.Transform,e.Visible,a],initialize:function(t,e,n,s,r,a,h,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),i.call(this,t,"Shader"),this.blendMode=-1,this.shader;var c=t.sys.renderer;this.renderer=c,this.gl=c.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=c.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this._deferSetShader=null,this._deferProjOrtho=null,this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new o,this._tempMatrix2=new o,this._tempMatrix3=new o,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=c.width,this._rendererHeight=c.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,s),this.setSize(r,a),this.setOrigin(.5,.5),this.setShader(e,h,u),this.renderer.on(l.RESTORE_WEBGL,this.onContextRestored,this)},willRender:function(t){return!!this.renderToTexture||!(i.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(!this.renderToTexture){var i=this.width,n=this.height,s=this.renderer;this.glTexture=s.createTextureFromSource(null,i,n,0),this.framebuffer=s.createFramebuffer(i,n,this.glTexture,!1),this._rendererWidth=i,this._rendererHeight=n,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture))}return this.shader&&(s.pipelines.clear(),this.load(),this.flush(),s.pipelines.rebind()),this},setShader:function(t,e,i){if(this.renderer.contextLost)return this._deferSetShader={key:t,textures:e,textureData:i},this;if(void 0===e&&(e=[]),"string"==typeof t){var n=this.scene.sys.cache.shader;if(!n.has(t))return console.warn("Shader missing: "+t),this;this.shader=n.get(t)}else this.shader=t;var r=this.gl,a=this.renderer;this.program&&a.deleteProgram(this.program);var o=a.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uViewMatrix"),!1,this.viewMatrix),r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),r.uniform2f(r.getUniformLocation(o.webGLProgram,"uResolution"),this.width,this.height),this.program=o;var h=new Date,l={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[h.getFullYear(),h.getMonth(),h.getDate(),60*h.getHours()*60+60*h.getMinutes()+h.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=s(!0,{},this.shader.uniforms,l):this.uniforms=l;for(var u=0;u<4;u++)e[u]&&this.setSampler2D("iChannel"+u,e[u],u,i);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,i,n){if(this.renderer.contextLost)this._deferProjOrtho={left:t,right:e,bottom:i,top:n};else{var s=1/(t-e),r=1/(i-n),a=this.projectionMatrix;a[0]=-2*s,a[5]=-2*r,a[10]=-.001,a[12]=(t+e)*s,a[13]=(n+i)*r,a[14]=-0;var o=this.program,h=this.gl;this.renderer.setProgram(o),h.uniformMatrix4fv(h.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=i}},initUniforms:function(){var t=this.renderer.glFuncMap,e=this.program;for(var i in this._textureCount=0,this.uniforms){var n=this.uniforms[i],s=n.type,r=t[s];n.uniformLocation=this.renderer.createUniformLocation(e,i),"sampler2D"!==s&&(n.glMatrix=r.matrix,n.glValueLength=r.length,n.glFunc=r.func)}},setSampler2DBuffer:function(t,e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r={});var a=this.uniforms[t];return a.value=e,r.width=i,r.height=n,a.textureData=r,this._textureCount=s,this.initSampler2D(a),this},setSampler2D:function(t,e,i,n){void 0===i&&(i=0);var s=this.scene.sys.textures;if(s.exists(e)){var r=s.getFrame(e);if(r.glTexture&&r.glTexture.isRenderTexture)return this.setSampler2DBuffer(t,r.glTexture,r.width,r.height,i,n);var a=this.uniforms[t],o=r.source;a.textureKey=e,a.source=o.image,a.value=r.glTexture,o.isGLTexture&&(n||(n={}),n.width=o.width,n.height=o.height),n&&(a.textureData=n),this._textureCount=i,this.initSampler2D(a)}return this},setUniform:function(t,e){return r(this.uniforms,t,e),this},getUniform:function(t){return n(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=t.textureData;if(e&&!t.value.isRenderTexture){var i=this.gl,s=t.value,r=i[n(e,"magFilter","linear").toUpperCase()],a=i[n(e,"minFilter","linear").toUpperCase()],o=i[n(e,"wrapS","repeat").toUpperCase()],h=i[n(e,"wrapT","repeat").toUpperCase()],l=i[n(e,"format","rgba").toUpperCase()],u=n(e,"flipY",!1),c=n(e,"width",s.width),d=n(e,"height",s.height),f=n(e,"source",s.pixels);e.repeat&&(o=i.REPEAT,h=i.REPEAT),e.width&&(f=null),s.update(f,c,d,u,o,h,a,r,l)}this.renderer.setProgram(this.program),this._textureCount++}},syncUniforms:function(){var t,e,i,n,s,r=this.gl,a=this.uniforms,o=0;for(var h in a)i=(t=a[h]).glFunc,e=t.glValueLength,n=t.uniformLocation,null!==(s=t.value)&&(1===e?t.glMatrix?i.call(r,n.webGLUniformLocation,t.transpose,s):i.call(r,n.webGLUniformLocation,s):2===e?i.call(r,n.webGLUniformLocation,s.x,s.y):3===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z):4===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z,s.w):"sampler2D"===t.type&&(r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,s.webGLTexture),r.uniform1i(n.webGLUniformLocation,o),o++))},load:function(t){var e=this.gl,i=this.width,n=this.height,s=this.renderer,r=this.program,a=this.viewMatrix;if(!this.renderToTexture){var o=-this._displayOriginX,h=-this._displayOriginY;a[0]=t[0],a[1]=t[1],a[4]=t[2],a[5]=t[3],a[8]=t[4],a[9]=t[5],a[12]=a[0]*o+a[4]*h,a[13]=a[1]*o+a[5]*h}e.useProgram(r.webGLProgram),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uViewMatrix"),!1,a),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),e.uniform2f(e.getUniformLocation(r.webGLProgram,"uResolution"),this.width,this.height);var l=this.uniforms,u=l.resolution;u.value.x=i,u.value.y=n,l.time.value=s.game.loop.getDuration();var c=this.pointer;if(c){var d=l.mouse,f=c.x/i,p=1-c.y/n;d.value.x=f.toFixed(2),d.value.y=p.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,i=this.program,n=this.gl,s=this.vertexBuffer,r=this.renderer,a=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(r.setFramebuffer(this.framebuffer),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),n.bindBuffer(n.ARRAY_BUFFER,s.webGLBuffer);var o=n.getAttribLocation(i.webGLProgram,"inPosition");-1!==o&&(n.enableVertexAttribArray(o),n.vertexAttribPointer(o,2,n.FLOAT,!1,a,0));var h=this.vertexViewF32;h[3]=e,h[4]=t,h[5]=e,h[8]=t,h[9]=e,h[10]=t,n.bufferSubData(n.ARRAY_BUFFER,0,this.bytes.subarray(0,6*a)),n.drawArrays(n.TRIANGLES,0,6),this.renderToTexture&&r.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},onContextRestored:function(){if(null!==this._deferSetShader){var t=this._deferSetShader.key,e=this._deferSetShader.textures,i=this._deferSetShader.textureData;this._deferSetShader=null,this.setShader(t,e,i)}if(null!==this._deferProjOrtho){var n=this._deferProjOrtho.left,s=this._deferProjOrtho.right,r=this._deferProjOrtho.bottom,a=this._deferProjOrtho.top;this._deferProjOrtho=null,this.projOrtho(n,s,r,a)}},preDestroy:function(){var t=this.renderer;t.off(l.RESTORE_WEBGL,this.onContextRestored,this),t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(t.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null),h(this.uniforms,function(e){t.deleteUniformLocation(e.uniformLocation),e.uniformLocation=null})}});return $K=u}function kZ(){if(eZ)return tZ;eZ=1;var t=Vh(),e=Fu(),i=Ru();function n(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}var s=new t({initialize:function(t,n,s){this.vertex1=t,this.vertex2=n,this.vertex3=s,this.bounds=new e,this._inCenter=new i},getInCenter:function(t){void 0===t&&(t=!0);var e,i,s,r,a,o,h=this.vertex1,l=this.vertex2,u=this.vertex3;t?(e=h.x,i=h.y,s=l.x,r=l.y,a=u.x,o=u.y):(e=h.vx,i=h.vy,s=l.vx,r=l.vy,a=u.vx,o=u.vy);var c=n(a,o,s,r),d=n(e,i,a,o),f=n(s,r,e,i),p=c+d+f;return this._inCenter.set((e*c+s*d+a*f)/p,(i*c+r*d+o*f)/p)},contains:function(t,e,i){var n=this.vertex1,s=this.vertex2,r=this.vertex3,a=n.vx,o=n.vy,h=s.vx,l=s.vy,u=r.vx,c=r.vy;if(i){var d=i.a,f=i.b,p=i.c,g=i.d,v=i.e,m=i.f;a=n.vx*d+n.vy*p+v,o=n.vx*f+n.vy*g+m,h=s.vx*d+s.vy*p+v,l=s.vx*f+s.vy*g+m,u=r.vx*d+r.vy*p+v,c=r.vx*f+r.vy*g+m}var y=u-a,x=c-o,w=h-a,T=l-o,b=t-a,S=e-o,E=y*y+x*x,_=y*w+x*T,C=y*b+x*S,A=w*w+T*T,P=w*b+T*S,M=E*A-_*_,R=0===M?0:1/M,L=(A*C-_*P)*R,O=(E*P-_*C)*R;return L>=0&&O>=0&&L+O<1},isCounterClockwise:function(t){var e=this.vertex1,i=this.vertex2,n=this.vertex3,s=(i.vx-e.vx)*(n.vy-e.vy)-(i.vy-e.vy)*(n.vx-e.vx);return t<=0?s>=0:s<0},load:function(t,e,i,n,s){return i=this.vertex1.load(t,e,i,n,s),i=this.vertex2.load(t,e,i,n,s),this.vertex3.load(t,e,i,n,s)},transformCoordinatesLocal:function(t,e,i,n){return this.vertex1.transformCoordinatesLocal(t,e,i,n),this.vertex2.transformCoordinatesLocal(t,e,i,n),this.vertex3.transformCoordinatesLocal(t,e,i,n),this},updateBounds:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3,n=this.bounds;return n.x=Math.min(t.vx,e.vx,i.vx),n.y=Math.min(t.vy,e.vy,i.vy),n.width=Math.max(t.vx,e.vx,i.vx)-n.x,n.height=Math.max(t.vy,e.vy,i.vy)-n.y,this},isInView:function(t,e,i,n,s,r,a,o,h,l,u){this.update(n,s,r,a,o,h,l,u);var c=this.vertex1,d=this.vertex2,f=this.vertex3;if(c.ta<=0&&d.ta<=0&&f.ta<=0)return!1;if(e&&!this.isCounterClockwise(i))return!1;var p=this.bounds;p.x=Math.min(c.tx,d.tx,f.tx),p.y=Math.min(c.ty,d.ty,f.ty),p.width=Math.max(c.tx,d.tx,f.tx)-p.x,p.height=Math.max(c.ty,d.ty,f.ty)-p.y;var g=t.x+t.width,v=t.y+t.height;return!(p.width<=0||p.height<=0||t.width<=0||t.height<=0||p.right<t.x||p.bottom<t.y||p.x>g||p.y>v)},scrollUV:function(t,e){return this.vertex1.scrollUV(t,e),this.vertex2.scrollUV(t,e),this.vertex3.scrollUV(t,e),this},scaleUV:function(t,e){return this.vertex1.scaleUV(t,e),this.vertex2.scaleUV(t,e),this.vertex3.scaleUV(t,e),this},setColor:function(t){return this.vertex1.color=t,this.vertex2.color=t,this.vertex3.color=t,this},update:function(t,e,i,n,s,r,a,o){return this.vertex1.update(e,i,n,s,r,a,o,t),this.vertex2.update(e,i,n,s,r,a,o,t),this.vertex3.update(e,i,n,s,r,a,o,t),this},translate:function(t,e){void 0===e&&(e=0);var i=this.vertex1,n=this.vertex2,s=this.vertex3;return i.x+=t,i.y+=e,n.x+=t,n.y+=e,s.x+=t,s.y+=e,this},x:{get:function(){return this.getInCenter().x},set:function(t){var e=this.getInCenter();this.translate(t-e.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(t){var e=this.getInCenter();this.translate(0,t-e.y)}},alpha:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.alpha+e.alpha+i.alpha)/3},set:function(t){this.vertex1.alpha=t,this.vertex2.alpha=t,this.vertex3.alpha=t}},depth:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.vz+e.vz+i.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}});return tZ=s}function BZ(){if(nZ)return iZ;nZ=1;var t=Vh(),e=Zk(),i=Ck(),n=new t({Extends:i,initialize:function(t,e,n,s,r,a,o,h,l,u){void 0===a&&(a=16777215),void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),i.call(this,t,e,n),this.vx=0,this.vy=0,this.vz=0,this.nx=h,this.ny=l,this.nz=u,this.u=s,this.v=r,this.color=a,this.alpha=o,this.tx=0,this.ty=0,this.ta=0,this.tu=s,this.tv=r},setUVs:function(t,e){return this.u=t,this.v=e,this.tu=t,this.tv=e,this},scrollUV:function(t,e){return this.tu+=t,this.tv+=e,this},scaleUV:function(t,e){return this.tu=this.u*t,this.tv=this.v*e,this},transformCoordinatesLocal:function(t,e,i,n){var s=this.x,r=this.y,a=this.z,o=t.val,h=s*o[0]+r*o[4]+a*o[8]+o[12],l=s*o[1]+r*o[5]+a*o[9]+o[13],u=s*o[2]+r*o[6]+a*o[10]+o[14],c=s*o[3]+r*o[7]+a*o[11]+o[15];this.vx=h/c*e,this.vy=-l/c*i,this.vz=n<=0?u/c:-u/c},resize:function(t,e,i,n,s,r){return this.x=t,this.y=e,this.vx=this.x*i,this.vy=-this.y*n,this.vz=0,s<.5?this.vx+=i*(.5-s):s>.5&&(this.vx-=i*(s-.5)),r<.5?this.vy+=n*(.5-r):r>.5&&(this.vy-=n*(r-.5)),this},update:function(t,e,i,n,s,r,a,o){var h=this.vx*t+this.vy*i+s,l=this.vx*e+this.vy*n+r;return a&&(h=Math.round(h),l=Math.round(l)),this.tx=h,this.ty=l,this.ta=this.alpha*o,this},load:function(t,i,n,s,r){return t[++n]=this.tx,t[++n]=this.ty,t[++n]=this.tu,t[++n]=this.tv,t[++n]=s,t[++n]=r,i[++n]=e.getTintAppendFloatAlpha(this.color,this.ta),n}});return iZ=n}function NZ(){if(rZ)return sZ;rZ=1;var t=kZ(),e=Ak(),i=Ck(),n=BZ(),s=new i,r=new i,a=new e;return sZ=function(e,i,o,h,l,u,c,d,f,p){void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),void 0===p&&(p=!0);var g={faces:[],verts:[]},v=e.materials;s.set(h,l,u),r.set(c,d,f),a.fromRotationXYTranslation(r,s,p);for(var m=0;m<e.models.length;m++)for(var y=e.models[m],x=y.vertices,w=y.textureCoords,T=y.faces,b=0;b<T.length;b++){var S=T[b],E=S.vertices[0],_=S.vertices[1],C=S.vertices[2],A=x[E.vertexIndex],P=x[_.vertexIndex],M=x[C.vertexIndex],R=E.textureCoordsIndex,L=_.textureCoordsIndex,O=C.textureCoordsIndex,F=-1===R?{u:0,v:1}:w[R],D=-1===L?{u:0,v:0}:w[L],I=-1===O?{u:1,v:1}:w[O],k=16777215;""!==S.material&&v[S.material]&&(k=v[S.material]);var B=new n(A.x*o,A.y*o,A.z*o,F.u,F.v,k).transformMat4(a),N=new n(P.x*o,P.y*o,P.z*o,D.u,D.v,k).transformMat4(a),U=new n(M.x*o,M.y*o,M.z*o,I.u,I.v,k).transformMat4(a);g.verts.push(B,N,U),g.faces.push(new t(B,N,U))}return i&&(i.faces=i.faces.concat(g.faces),i.vertices=i.vertices.concat(g.verts)),g},sZ}function UZ(){if(oZ)return aZ;oZ=1;var t=kZ(),e=BZ();return aZ=function(i,n,s,r,a,o,h,l){if(void 0===r&&(r=!1),void 0===o&&(o=16777215),void 0===h&&(h=1),void 0===l&&(l=!1),i.length===n.length||r){var u,c,d,f,p,g,v,m,y,x,w,T={faces:[],vertices:[]},b=r?3:2,S=Array.isArray(o),E=Array.isArray(h);if(Array.isArray(s)&&s.length>0)for(u=0;u<s.length;u++){var _=s[u],C=2*s[u],A=s[u]*b;c=i[A],d=i[A+1],f=r?i[A+2]:0,p=n[C],g=n[C+1],l&&(g=1-g),v=S?o[_]:o,m=E?h[_]:h,y=0,x=0,w=0,a&&(y=a[A],x=a[A+1],w=r?a[A+2]:0),T.vertices.push(new e(c,d,f,p,g,v,m,y,x,w))}else{var P=0,M=0;for(u=0;u<i.length;u+=b)c=i[u],d=i[u+1],f=r?i[u+2]:0,p=n[P],g=n[P+1],v=S?o[M]:o,m=E?h[M]:h,y=0,x=0,w=0,a&&(y=a[u],x=a[u+1],w=r?a[u+2]:0),T.vertices.push(new e(c,d,f,p,g,v,m,y,x,w)),P+=2,M++}for(u=0;u<T.vertices.length;u+=3){var R=T.vertices[u],L=T.vertices[u+1],O=T.vertices[u+2];T.faces.push(new t(R,L,O))}return T}console.warn("GenerateVerts: vertices and uvs count not equal")},aZ}function zZ(){if(gZ)return pZ;gZ=1;var t=Vh(),e=ac(),i=Xu(),n=kZ(),s=ZF(),r=NZ(),a=UZ(),o=kU(),h=Ak(),l=function(){if(fZ)return dZ;fZ=1;var t,e;Hh();return t=function(){if(lZ)return hZ;lZ=1;var t=kU();return hZ=function(e,i,n,s){var r=i.faces,a=r.length;if(0!==a){n.addToRenderList(i);var o=e.pipelines.set(i.pipeline,i),h=t(i,n,s).calc;e.pipelines.preBatch(i);for(var l=o.setGameObject(i),u=o.vertexViewF32,c=o.vertexViewU32,d=o.vertexCount*o.currentShader.vertexComponentCount-1,f=i.tintFill,p=[],g=i.debugCallback,v=h.a,m=h.b,y=h.c,x=h.d,w=h.e,T=h.f,b=i.viewPosition.z,S=i.hideCCW,E=n.roundPixels,_=n.alpha*i.alpha,C=0,A=0;A<a;A++){var P=r[A];P.isInView(n,S,b,_,v,m,y,x,w,T,E)&&(o.shouldFlush(3)&&(o.flush(),l=o.setGameObject(i),d=o.vertexCount*o.currentShader.vertexComponentCount-1),d=P.load(u,c,d,l,f),C++,o.vertexCount+=3,o.currentBatch.count=o.vertexCount-o.currentBatch.start,g&&p.push(P))}i.totalFrame+=C,g&&g.call(i,i,p),e.pipelines.postBatch(i)}},hZ}(),e=cZ?uZ:(cZ=1,uZ=function(){}),dZ={renderWebGL:t,renderCanvas:e}}(),u=Mk(),c=Ql(),d=Ck(),f=BZ(),p=new t({Extends:s,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.Texture,e.Transform,e.Visible,l],initialize:function(t,e,i,n,r,a,o,l,u,c,f,p){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="__WHITE"),s.call(this,t,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new d,this.modelScale=new d(1,1,1),this.modelRotation=new d,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new h,this.viewPosition=new d,this.viewMatrix=new h,this.projectionMatrix=new h,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1,this.fov,this.displayOriginX=0,this.displayOriginY=0;var g=t.sys.renderer;this.setPosition(e,i),this.setTexture(n,r),this.setSize(g.width,g.height),this.initPipeline(),this.initPostPipeline(),this.setPerspective(g.width,g.height),a&&this.addVertices(a,o,l,u,c,f,p)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(t){return this.viewPosition.addScale(d.LEFT,t),this.dirtyCache[10]=1,this},panY:function(t){return this.viewPosition.y+=d.DOWN.y*t,this.dirtyCache[10]=1,this},panZ:function(t){return this.viewPosition.z+=t,this.dirtyCache[10]=1,this},setPerspective:function(t,e,n,s,r){return void 0===n&&(n=45),void 0===s&&(s=.01),void 0===r&&(r=1e3),this.fov=n,this.projectionMatrix.perspective(i(n),t/e,s,r),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(t,e,i,n){return void 0===t&&(t=this.scene.sys.renderer.getAspectRatio()),void 0===e&&(e=1),void 0===i&&(i=-1e3),void 0===n&&(n=1e3),this.fov=0,this.projectionMatrix.ortho(-t,t,-e,e,i,n),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach(function(t){t.destroy()}),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(t,e,i,n,s,a,o,h,l){var u,c=this.scene.sys.cache.obj.get(t);return c&&(u=r(c,this,e,i,n,s,a,o,h,l)),u&&0!==u.verts.length||console.warn("Mesh.addVerticesFromObj data empty:",t),this},sortByDepth:function(t,e){return t.depth-e.depth},depthSort:function(){return c(this.faces,this.sortByDepth),this},addVertex:function(t,e,i,n,s,r,a){var o=new f(t,e,i,n,s,r,a);return this.vertices.push(o),o},addFace:function(t,e,i){var s=new n(t,e,i);return this.faces.push(s),this.dirtyCache[9]=-1,s},addVertices:function(t,e,i,n,s,r,o){var h=a(t,e,i,n,s,r,o);return h?(this.faces=this.faces.concat(h.faces),this.vertices=this.vertices.concat(h.vertices)):console.warn("Mesh.addVertices data empty or invalid"),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(t){return this.faces[t]},hasFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=0;r<s.length;r++)if(s[r].contains(t,e,n))return!0;return!1},getFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=[],a=0;a<s.length;a++){var h=s[a];h.contains(t,e,n)&&r.push(h)}return c(r,this.sortByDepth)},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebug:null,this},isDirty:function(){var t=this.modelPosition,e=this.modelRotation,i=this.modelScale,n=this.dirtyCache,s=t.x,r=t.y,a=t.z,o=e.x,h=e.y,l=e.z,u=i.x,c=i.y,d=i.z,f=this.getFaceCount(),p=n[0],g=n[1],v=n[2],m=n[3],y=n[4],x=n[5],w=n[6],T=n[7],b=n[8],S=n[9];return n[0]=s,n[1]=r,n[2]=a,n[3]=o,n[4]=h,n[5]=l,n[6]=u,n[7]=c,n[8]=d,n[9]=f,p!==s||g!==r||v!==a||m!==o||y!==h||x!==l||w!==u||T!==c||b!==d||S!==f},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var t=this.dirtyCache;if(this.ignoreDirtyCache||t[10]||this.isDirty()){var e=this.width,i=this.height,n=this.viewMatrix,s=this.viewPosition;t[10]&&(n.identity(),n.translate(s),n.invert(),t[10]=0);var r=this.transformMatrix;r.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var a=s.z,o=this.faces,h=0;h<o.length;h++)o[h].transformCoordinatesLocal(r,e,i,a);this.depthSort()}},renderDebug:function(t,e){for(var i=t.debugGraphic,n=0;n<e.length;n++){var s=e[n],r=s.vertex1.tx,a=s.vertex1.ty,o=s.vertex2.tx,h=s.vertex2.ty,l=s.vertex3.tx,u=s.vertex3.ty;i.strokeTriangle(r,a,o,h,l,u)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null},clearTint:function(){return this.setTint()},setInteractive:function(t){void 0===t&&(t={});var e=function(t,e,i){for(var n=this.faces,s=0;s<n.length;s++)if(n[s].contains(e,i))return!0;return!1}.bind(this);return this.scene.sys.input.enable(this,t,e),this},setTint:function(t){void 0===t&&(t=16777215);for(var e=this.vertices,i=0;i<e.length;i++)e[i].color=t;return this},uvScroll:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scrollUV(t,e);return this},uvScale:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scaleUV(t,e);return this},tint:{set:function(t){this.setTint(t)}},rotateX:{get:function(){return u(this.modelRotation.x)},set:function(t){this.modelRotation.x=i(t)}},rotateY:{get:function(){return u(this.modelRotation.y)},set:function(t){this.modelRotation.y=i(t)}},rotateZ:{get:function(){return u(this.modelRotation.z)},set:function(t){this.modelRotation.z=i(t)}}});return pZ=p}function YZ(){if(TZ)return wZ;TZ=1;var t=Vh(),e=ac(),i=ZF(),n=function(){if(xZ)return yZ;xZ=1;var t,e=Hh(),i=e;return t=function(){if(mZ)return vZ;mZ=1;var t=kU(),e=Zk();return vZ=function(i,n,s,r){var a=n.vertices,o=a.length;if(0!==o){s.addToRenderList(n);var h=i.pipelines.set(n.pipeline,n),l=t(n,s,r,!1).calc;i.pipelines.preBatch(n);var u=h.setGameObject(n),c=h.vertexViewF32,d=h.vertexViewU32,f=h.vertexCount*h.currentShader.vertexComponentCount-1,p=s.roundPixels,g=n.tintFill,v=s.alpha*n.alpha,m=e.getTintAppendFloatAlpha(n.tint,v),y=h.vertexAvailable(),x=-1;y<o&&(x=y);for(var w=0;w<o;w++){var T=a[w];w===x&&(h.flush(),u=h.setGameObject(n),f=0),c[++f]=l.getXRound(T.vx,T.vy,p),c[++f]=l.getYRound(T.vx,T.vy,p),c[++f]=T.u,c[++f]=T.v,c[++f]=u,c[++f]=g,d[++f]=m,h.vertexCount++,h.currentBatch.count=h.vertexCount-h.currentBatch.start}i.pipelines.postBatch(n)}},vZ}(),yZ={renderWebGL:t,renderCanvas:i}}(),s=BZ(),r=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,n],initialize:function(t,e,n,r,a,o,h,l,u,c,d){i.call(this,t,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var f=t.textures.getFrame(r,a);this.is3Slice=!c&&!d,f&&f.scale9&&(this.is3Slice=f.is3Slice);for(var p=this.is3Slice?18:54,g=0;g<p;g++)this.vertices.push(new s);this.setPosition(e,n),this.setTexture(r,a),this.setSlices(o,h,l,u,c,d,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(t,e,i,n,s,r,a){void 0===i&&(i=10),void 0===n&&(n=10),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1);var o=this.frame,h=!1;if(this.is3Slice&&a&&0!==s&&0!==r&&(h=!0),h)console.warn("Cannot change 9 slice to 3 slice");else{if(o&&o.scale9&&!a){var l=o.data.scale9Borders,u=l.x,c=l.y;i=u,n=o.width-l.w-u,s=c,r=o.height-l.h-c,void 0===t&&(t=o.width),void 0===e&&(e=o.height)}else void 0===t&&(t=256),void 0===e&&(e=256);this._width=t,this._height=e,this.leftWidth=i,this.rightWidth=n,this.topHeight=s,this.bottomHeight=r,this.is3Slice&&(e=o.height,this._height=e,this.topHeight=e,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.frame.width,r=this.frame.height;this.updateQuadUVs(0,0,0,t/s,i/r),this.updateQuadUVs(6,t/s,0,1-e/s,i/r),this.updateQuadUVs(12,1-e/s,0,1,i/r),this.is3Slice||(this.updateQuadUVs(18,0,i/r,t/s,1-n/r),this.updateQuadUVs(24,t/s,i/r,1-e/s,1-n/r),this.updateQuadUVs(30,1-e/s,i/r,1,1-n/r),this.updateQuadUVs(36,0,1-n/r,t/s,1),this.updateQuadUVs(42,t/s,1-n/r,1-e/s,1),this.updateQuadUVs(48,1-e/s,1-n/r,1,1))},updateVertices:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.width,r=this.height;this.updateQuad(0,-.5,.5,t/s-.5,.5-i/r),this.updateQuad(6,t/s-.5,.5,.5-e/s,.5-i/r),this.updateQuad(12,.5-e/s,.5,.5,.5-i/r),this.is3Slice||(this.updateQuad(18,-.5,.5-i/r,t/s-.5,n/r-.5),this.updateQuad(24,t/s-.5,.5-i/r,.5-e/s,n/r-.5),this.updateQuad(30,.5-e/s,.5-i/r,.5,n/r-.5),this.updateQuad(36,-.5,n/r-.5,t/s-.5,-.5),this.updateQuad(42,t/s-.5,n/r-.5,.5-e/s,-.5),this.updateQuad(48,.5-e/s,n/r-.5,.5,-.5))},updateQuad:function(t,e,i,n,s){var r=this.width,a=this.height,o=this.originX,h=this.originY,l=this.vertices;l[t+0].resize(e,i,r,a,o,h),l[t+1].resize(e,s,r,a,o,h),l[t+2].resize(n,i,r,a,o,h),l[t+3].resize(e,s,r,a,o,h),l[t+4].resize(n,s,r,a,o,h),l[t+5].resize(n,i,r,a,o,h)},updateQuadUVs:function(t,e,i,n,s){var r=this.vertices,a=this.frame,o=a.u0,h=a.v0,l=a.u1,u=a.v1;if(0!==o||1!==l){var c=l-o;e=o+e*c,n=o+n*c}if(0!==h||1!==u){var d=u-h;i=h+i*d,s=h+s*d}r[t+0].setUVs(e,i),r[t+1].setUVs(e,s),r[t+2].setUVs(n,i),r[t+3].setUVs(e,s),r[t+4].setUVs(n,s),r[t+5].setUVs(n,i)},clearTint:function(){return this.setTint(16777215),this},setTint:function(t){return void 0===t&&(t=16777215),this.tint=t,this.tintFill=!1,this},setTintFill:function(t){return this.setTint(t),this.tintFill=!0,this},isTinted:{get:function(){return 16777215!==this.tint}},width:{get:function(){return this._width},set:function(t){this._width=Math.max(t,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(t){this.is3Slice||(this._height=Math.max(t,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},originX:{get:function(){return this._originX},set:function(t){this._originX=t,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(t){this._originY=t,this.updateVertices()}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this._originX=t,this._originY=e,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var t=this.frame.height;this._height=t,this.topHeight=t,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});return wZ=r}function XZ(){if(AZ)return CZ;AZ=1;var t=Vh(),e=ac(),i=ZF(),n=LI(),s=Bk(),r=function(){if(_Z)return EZ;_Z=1;var t,e=Hh(),i=e;return t=function(){if(SZ)return bZ;SZ=1;var t=kU();return bZ=function(e,i,n,s){n.addToRenderList(i);var r=e.pipelines.set(i.pipeline),a=t(i,n,s).calc,o=i.width,h=i.height,l=-i._radius,u=-i._radius,c=l+o,d=u+h,f=a.getX(0,0),p=a.getY(0,0),g=a.getX(l,u),v=a.getY(l,u),m=a.getX(l,d),y=a.getY(l,d),x=a.getX(c,d),w=a.getY(c,d),T=a.getX(c,u),b=a.getY(c,u);e.pipelines.preBatch(i),r.batchPointLight(i,n,g,v,m,y,x,w,T,b,f,p),e.pipelines.postBatch(i)},bZ}(),EZ={renderWebGL:t,renderCanvas:i}}(),a=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible,r],initialize:function(t,e,r,a,o,h,l){void 0===a&&(a=16777215),void 0===o&&(o=128),void 0===h&&(h=1),void 0===l&&(l=.1),i.call(this,t,"PointLight"),this.initPipeline(s.POINTLIGHT_PIPELINE),this.initPostPipeline(),this.setPosition(e,r),this.color=n(a),this.intensity=h,this.attenuation=l,this.width=2*o,this.height=2*o,this._radius=o},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*t,this.height=2*t}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}});return CZ=a}function GZ(){if(MZ)return PZ;MZ=1;var t=kZ(),e=Wh(),i=Ak(),n=Ck(),s=BZ(),r=new n,a=new n,o=new i;return PZ=function(i){var n,h=e(i,"mesh"),l=e(i,"texture",null),u=e(i,"frame"),c=e(i,"width",1),d=e(i,"height",c),f=e(i,"widthSegments",1),p=e(i,"heightSegments",f),g=e(i,"x",0),v=e(i,"y",0),m=e(i,"z",0),y=e(i,"rotateX",0),x=e(i,"rotateY",0),w=e(i,"rotateZ",0),T=e(i,"zIsUp",!0),b=e(i,"isOrtho",!!h&&h.dirtyCache[11]),S=e(i,"colors",[16777215]),E=e(i,"alphas",[1]),_=e(i,"tile",!1),C=e(i,"flipY",!1),A=e(i,"width",null),P={faces:[],verts:[]};if(r.set(g,v,m),a.set(y,x,w),o.fromRotationXYTranslation(a,r,T),!l&&h)l=h.texture,u||(n=h.frame);else if(h&&"string"==typeof l)l=h.scene.sys.textures.get(l);else if(!l)return P;n||(n=l.get(u)),!A&&b&&l&&h&&(c=n.width/h.height,d=n.height/h.height);var M,R,L=c/2,O=d/2,F=Math.floor(f),D=Math.floor(p),I=F+1,k=D+1,B=c/F,N=d/D,U=[],z=[],Y=0,X=1,G=0,W=1;n&&(Y=n.u0,X=n.u1,C?(G=n.v1,W=n.v0):(G=n.v0,W=n.v1));var H=X-Y,V=W-G;for(R=0;R<k;R++){var j=R*N-O;for(M=0;M<I;M++){var q=M*B-L;z.push(q,-j);var K=Y+H*(M/F),Z=G+V*(R/D);U.push(K,Z)}}Array.isArray(S)||(S=[S]),Array.isArray(E)||(E=[E]);var J=0,$=0;for(R=0;R<D;R++)for(M=0;M<F;M++){var Q=2*(M+I*R),tt=2*(M+I*(R+1)),et=2*(M+1+I*(R+1)),it=2*(M+1+I*R),nt=S[$],st=E[J],rt=new s(z[Q],z[Q+1],0,U[Q],U[Q+1],nt,st).transformMat4(o),at=new s(z[tt],z[tt+1],0,U[tt],U[tt+1],nt,st).transformMat4(o),ot=new s(z[it],z[it+1],0,U[it],U[it+1],nt,st).transformMat4(o),ht=new s(z[tt],z[tt+1],0,U[tt],U[tt+1],nt,st).transformMat4(o),lt=new s(z[et],z[et+1],0,U[et],U[et+1],nt,st).transformMat4(o),ut=new s(z[it],z[it+1],0,U[it],U[it+1],nt,st).transformMat4(o);_&&(rt.setUVs(Y,W),at.setUVs(Y,G),ot.setUVs(X,W),ht.setUVs(Y,G),lt.setUVs(X,G),ut.setUVs(X,W)),++$===S.length&&($=0),++J===E.length&&(J=0),P.verts.push(rt,at,ot,ht,lt,ut),P.faces.push(new t(rt,at,ot),new t(ht,lt,ut))}return h&&(h.faces=h.faces.concat(P.faces),h.vertices=h.vertices.concat(P.verts)),P},PZ}function WZ(){if(LZ)return RZ;LZ=1;var t=mI(),e=Vh(),i=GZ(),n=RI(),s=zZ(),r=zV(),a=new e({Extends:s,initialize:function(e,i,n,r,a,o,h,l){r||(r="__DEFAULT"),s.call(this,e,i,n,r,a),this.type="Plane",this.anims=new t(this),this.gridWidth,this.gridHeight,this.isTiled,this._checkerboard=null,this.hideCCW=!1,this.setGridSize(o,h,l),this.setSizeToFrame(!1),this.setViewHeight()},originX:{get:function(){return.5}},originY:{get:function(){return.5}},setGridSize:function(t,e,n){void 0===t&&(t=8),void 0===e&&(e=8),void 0===n&&(n=!1);var s=!1;return n&&(s=!0),this.gridWidth=t,this.gridHeight=e,this.isTiled=n,this.clear(),i({mesh:this,widthSegments:t,heightSegments:e,isOrtho:!1,tile:n,flipY:s}),this},setSizeToFrame:function(t){void 0===t&&(t=!0);var e=this.frame;if(this.setPerspective(this.width/e.width,this.height/e.height),this._checkerboard&&this._checkerboard!==this.texture&&this.removeCheckerboard(),!t)return this;var i,n,s=this.gridWidth,r=this.gridHeight,a=this.vertices,o=e.u0,h=e.u1,l=e.v0,u=e.v1,c=0;if(this.isTiled)for(l=e.v1,u=e.v0,n=0;n<r;n++)for(i=0;i<s;i++)a[c++].setUVs(o,u),a[c++].setUVs(o,l),a[c++].setUVs(h,u),a[c++].setUVs(o,l),a[c++].setUVs(h,l),a[c++].setUVs(h,u);else{var d=s+1,f=r+1,p=h-o,g=u-l,v=[];for(n=0;n<f;n++)for(i=0;i<d;i++){var m=o+p*(i/s),y=l+g*(n/r);v.push(m,y)}for(n=0;n<r;n++)for(i=0;i<s;i++){var x=2*(i+d*n),w=2*(i+d*(n+1)),T=2*(i+1+d*(n+1)),b=2*(i+1+d*n);a[c++].setUVs(v[x],v[x+1]),a[c++].setUVs(v[w],v[w+1]),a[c++].setUVs(v[b],v[b+1]),a[c++].setUVs(v[w],v[w+1]),a[c++].setUVs(v[T],v[T+1]),a[c++].setUVs(v[b],v[b+1])}}return this},setViewHeight:function(t){void 0===t&&(t=this.frame.height);var e=this.fov*(Math.PI/180);this.viewPosition.z=this.height/t/Math.tan(e/2),this.dirtyCache[10]=1},createCheckerboard:function(t,e,i,s,a){void 0===t&&(t=16777215),void 0===e&&(e=255),void 0===i&&(i=255),void 0===s&&(s=255),void 0===a&&(a=128);for(var o=n(t),h=n(e),l=[],u=0;u<16;u++)for(var c=0;c<16;c++)u<8&&c<8||u>7&&c>7?l.push(o.r,o.g,o.b,i):l.push(h.r,h.g,h.b,s);var d=this.scene.sys.textures.addUint8Array(r(),new Uint8Array(l),16,16);return this.removeCheckerboard(),this.setTexture(d),this.setSizeToFrame(),this.setViewHeight(a),this},removeCheckerboard:function(){this._checkerboard&&(this._checkerboard.destroy(),this._checkerboard=null)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},preUpdate:function(t,e){s.prototype.preUpdate.call(this,t,e),this.anims.update(t,e)},preDestroy:function(){this.clear(),this.removeCheckerboard(),this.anims.destroy(),this.anims=void 0,this.debugCallback=null,this.debugGraphic=null}});return RZ=a}var HZ,VZ,jZ,qZ,KZ,ZZ,JZ,$Z,QZ,tJ,eJ,iJ,nJ,sJ,rJ,aJ,oJ,hJ,lJ,uJ,cJ,dJ,fJ,pJ,gJ,vJ,mJ,yJ,xJ,wJ,TJ,bJ,SJ,EJ,_J,CJ,AJ,PJ,MJ,RJ,LJ,OJ,FJ,DJ,IJ,kJ,BJ,NJ,UJ,zJ,YJ,XJ,GJ,WJ,HJ,VJ,jJ,qJ,KJ,ZJ,JJ,$J,QJ,t$,e$,i$,n$,s$,r$,a$,o$,h$,l$,u$,c$,d$,f$,p$,g$,v$,m$,y$,x$,w$,T$,b$,S$,E$,_$,C$,A$,P$,M$,R$,L$,O$,F$,D$,I$,k$,B$,N$,U$,z$,Y$,X$,G$,W$,H$,V$,j$,q$,K$,Z$,J$,$$,Q$,tQ,eQ,iQ,nQ,sQ,rQ,aQ,oQ,hQ,lQ,uQ,cQ,dQ,fQ,pQ,gQ,vQ,mQ,yQ,xQ,wQ,TQ,bQ,SQ,EQ,_Q,CQ,AQ,PQ,MQ,RQ,LQ,OQ,FQ,DQ,IQ,kQ,BQ,NQ,UQ,zQ,YQ,XQ,GQ,WQ,HQ,VQ,jQ,qQ,KQ,ZQ,JQ,$Q,QQ,t0,e0,i0,n0,s0,r0,a0,o0,h0,l0,u0,c0,d0,f0,p0,g0,v0,m0,y0,x0,w0,T0,b0,S0,E0,_0,C0,A0,P0,M0,R0,L0,O0,F0,D0,I0,k0,B0,N0,U0,z0,Y0,X0,G0,W0,H0,V0,j0,q0,K0,Z0,J0,$0,Q0,t1,e1,i1,n1,s1,r1,a1,o1,h1,l1,u1,c1,d1,f1,p1,g1,v1,m1,y1,x1,w1,T1,b1,S1,E1,_1,C1,A1,P1,M1,R1,L1,O1,F1,D1,I1,k1,B1,N1,U1,z1,Y1,X1,G1,W1,H1,V1,j1,q1,K1,Z1,J1,$1,Q1,t2,e2,i2,n2,s2,r2,a2,o2,h2,l2,u2,c2,d2,f2,p2,g2,v2,m2,y2,x2,w2,T2,b2,S2,E2,_2,C2,A2,P2,M2,R2,L2,O2,F2,D2,I2,k2,B2,N2,U2,z2,Y2,X2,G2,W2,H2,V2,j2,q2,K2,Z2,J2,$2,Q2,t3,e3,i3,n3,s3,r3,a3,o3,h3,l3,u3,c3,d3,f3,p3,g3,v3,m3,y3,x3,w3,T3,b3,S3,E3,_3,C3,A3,P3,M3,R3,L3,O3,F3,D3,I3,k3,B3,N3,U3,z3,Y3,X3,G3,W3,H3,V3,j3,q3,K3,Z3,J3,$3,Q3,t5,e5,i5,n5,s5,r5,a5,o5,h5,l5,u5,c5,d5,f5,p5,g5,v5,m5,y5,x5,w5,T5,b5,S5,E5,_5,C5,A5,P5,M5,R5,L5,O5,F5,D5,I5,k5,B5,N5,U5,z5,Y5,X5,G5={},W5={},H5={},V5={},j5={},q5={},K5={},Z5={},J5={},$5={};function Q5(){if(iJ)return eJ;iJ=1;var t=sl(),e=Vh(),i=ac(),n=ON(),s=Zk(),r=new e({Extends:t,Mixins:[i.Origin,i.ScrollFactor,i.Visible],initialize:function(e,i,s,r,a,o,h){t.call(this,e,i,s),this.color=new n(r,a,o),this.intensity=h,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1),this.setOrigin(),this.setDisplayOrigin(s)},displayWidth:{get:function(){return this.diameter},set:function(t){this.diameter=t}},displayHeight:{get:function(){return this.diameter},set:function(t){this.diameter=t}},width:{get:function(){return this.diameter},set:function(t){this.diameter=t}},height:{get:function(){return this.diameter},set:function(t){this.diameter=t}},willRender:function(t){return!(r.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setColor:function(t){var e=s.getFloatsFromUintRGB(t);return this.color.set(e[0],e[1],e[2]),this},setIntensity:function(t){return this.intensity=t,this},setRadius:function(t){return this.radius=t,this}});return r.RENDER_MASK=15,eJ=r}function t4(){return sJ||(sJ=1,nJ=function(t,e){var i=e.width/2,n=e.height/2,s=Math.abs(t.x-e.x-i),r=Math.abs(t.y-e.y-n),a=i+t.radius,o=n+t.radius;if(s>a||r>o)return!1;if(s<=i||r<=n)return!0;var h=s-i,l=r-n;return h*h+l*l<=t.radius*t.radius}),nJ}function e4(){if(aJ)return rJ;aJ=1;var t=t4(),e=Vh(),i=ID(),n=Q5(),s=XZ(),r=ON(),a=Il(),o=Ql(),h=Zk(),l=new e({initialize:function(){this.lights=[],this.ambientColor=new r(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(t,e,i,n,r,a){return this.systems.displayList.add(new s(this.scene,t,e,i,n,r,a))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(e){for(var n=this.lights,s=e.worldView,r=[],a=0;a<n.length;a++){var h=n[a];h.willRender(e)&&t(h,s)&&r.push({light:h,distance:i(h.x,h.y,s.centerX,s.centerY)})}return r.length>this.maxLights&&(o(r,this.sortByDistance),r=r.slice(0,this.maxLights)),this.visibleLights=r.length,r},sortByDistance:function(t,e){return t.distance>=e.distance},setAmbientColor:function(t){var e=h.getFloatsFromUintRGB(t);return this.ambientColor.set(e[0],e[1],e[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(t,e,i,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=128),void 0===s&&(s=16777215),void 0===r&&(r=1);var a=h.getFloatsFromUintRGB(s),o=new n(t,e,i,a[0],a[1],a[2],r);return this.lights.push(o),o},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&a(this.lights,e),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}});return rJ=l}function i4(){if(uJ)return lJ;uJ=1;var t={Events:KF(),DisplayList:OU(),GameObjectCreator:iU(),GameObjectFactory:Nu(),UpdateList:IU(),Components:ac(),GetCalcMatrix:kU(),BuildGameObject:NU(),BuildGameObjectAnimation:UU(),GameObject:ZF(),BitmapText:GU(),Blitter:HU(),Bob:WU(),Container:jU(),DOMElement:KU(),DynamicBitmapText:ZU(),Extern:$H(),Graphics:oV(),Group:cV(),Image:wU(),Layer:dV(),Particles:qY?jY:(qY=1,jY={EmitterColorOp:gV(),EmitterOp:pV(),Events:vV(),GravityWell:yV(),Particle:xV(),ParticleBounds:wV(),ParticleEmitter:LV(),ParticleProcessor:mV(),Zones:VY?HY:(VY=1,HY={DeathZone:bV(),EdgeZone:SV(),RandomZone:MV()})}),PathFollower:OV(),RenderTexture:FV(),RetroFont:IV(),Rope:kV(),Sprite:uV(),Text:YV(),GetTextSize:BV(),MeasureText:NV(),TextStyle:UV(),TileSprite:XV(),Zone:JF(),Video:GV(),Shape:WV(),Arc:KV(),Curve:ZV(),Ellipse:JV(),Grid:$V(),IsoBox:QV(),IsoTriangle:tj(),Line:ej(),Polygon:hj(),Rectangle:lj(),Star:uj(),Triangle:gj(),Factories:{Blitter:yj(),Container:Tj(),DOMElement:Ej(),DynamicBitmapText:Aj(),Extern:Rj(),Graphics:Fj(),Group:kj(),Image:Uj(),Layer:Xj(),Particles:Hj(),PathFollower:qj(),RenderTexture:Jj(),Rope:tq(),Sprite:nq(),StaticBitmapText:aq(),Text:lq(),TileSprite:dq(),Zone:gq(),Video:yq(),Arc:Tq(),Curve:Eq(),Ellipse:Aq(),Grid:Rq(),IsoBox:Fq(),IsoTriangle:kq(),Line:Uq(),Polygon:Xq(),Rectangle:Hq(),Star:qq(),Triangle:Jq()},Creators:{Blitter:tK(),Container:nK(),DynamicBitmapText:aK(),Graphics:lK(),Group:dK(),Image:gK(),Layer:yK(),Particles:TK(),RenderTexture:EK(),Rope:AK(),Sprite:RK(),StaticBitmapText:FK(),Text:kK(),TileSprite:UK(),Zone:XK(),Video:FZ()}};return t.Shader=IZ(),t.Mesh=zZ(),t.NineSlice=YZ(),t.PointLight=XZ(),t.Plane=WZ(),t.Factories.Shader=function(){if(HZ)return G5;HZ=1;var t=IZ();return Nu().register("shader",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),G5}(),t.Factories.Mesh=function(){if(VZ)return W5;VZ=1;var t=zZ();return Nu().register("mesh",function(e,i,n,s,r,a,o,h,l,u,c){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u,c))}),W5}(),t.Factories.NineSlice=function(){if(jZ)return H5;jZ=1;var t=YZ();return Nu().register("nineslice",function(e,i,n,s,r,a,o,h,l,u){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u))}),H5}(),t.Factories.PointLight=function(){if(qZ)return V5;qZ=1;var t=Nu(),e=XZ();return t.register("pointlight",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),V5}(),t.Factories.Plane=function(){if(KZ)return j5;KZ=1;var t=WZ();return Nu().register("plane",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),j5}(),t.Creators.Shader=function(){if(ZZ)return q5;ZZ=1;var t=NU(),e=iU(),i=BU(),n=IZ();return e.register("shader",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"x",0),o=i(e,"y",0),h=i(e,"width",128),l=i(e,"height",128),u=new n(this.scene,r,a,o,h,l);return void 0!==s&&(e.add=s),t(this.scene,u,e),u}),q5}(),t.Creators.Mesh=function(){if(JZ)return K5;JZ=1;var t=NU(),e=iU(),i=BU(),n=Ol(),s=zZ();return e.register("mesh",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"vertices",[]),l=n(e,"uvs",[]),u=n(e,"indicies",[]),c=n(e,"containsZ",!1),d=n(e,"normals",[]),f=n(e,"colors",16777215),p=n(e,"alphas",1),g=new s(this.scene,0,0,a,o,h,l,u,c,d,f,p);return void 0!==r&&(e.add=r),t(this.scene,g,e),g}),K5}(),t.Creators.NineSlice=function(){if($Z)return Z5;$Z=1;var t=NU(),e=iU(),i=BU(),n=Ol(),s=YZ();return e.register("nineslice",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"width",256),l=n(e,"height",256),u=n(e,"leftWidth",10),c=n(e,"rightWidth",10),d=n(e,"topHeight",0),f=n(e,"bottomHeight",0),p=new s(this.scene,0,0,a,o,h,l,u,c,d,f);return void 0!==r&&(e.add=r),t(this.scene,p,e),p}),Z5}(),t.Creators.PointLight=function(){if(QZ)return J5;QZ=1;var t=NU(),e=iU(),i=BU(),n=XZ();return e.register("pointlight",function(e,s){void 0===e&&(e={});var r=i(e,"color",16777215),a=i(e,"radius",128),o=i(e,"intensity",1),h=i(e,"attenuation",.1),l=new n(this.scene,0,0,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),J5}(),t.Creators.Plane=function(){if(tJ)return $5;tJ=1;var t=NU(),e=UU(),i=iU(),n=BU(),s=Ol(),r=WZ();return i.register("plane",function(i,a){void 0===i&&(i={});var o=n(i,"key",null),h=n(i,"frame",null),l=s(i,"width",8),u=s(i,"height",8),c=s(i,"tile",!1),d=new r(this.scene,0,0,o,h,l,u,c);void 0!==a&&(i.add=a);var f=s(i,"checkerboard",null);if(f){var p=s(f,"color1",16777215),g=s(f,"color2",255),v=s(f,"alpha1",255),m=s(f,"alpha2",255),y=s(f,"height",128);d.createCheckerboard(p,g,v,m,y)}return t(this.scene,d,i),e(d,i),d}),$5}(),t.Light=Q5(),t.LightsManager=e4(),t.LightsPlugin=function(){if(hJ)return oJ;hJ=1;var t=Vh(),e=e4(),i=ku(),n=Bu(),s=new t({Extends:e,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(n.BOOT,this.boot,this),e.call(this)},boot:function(){var t=this.systems.events;t.on(n.SHUTDOWN,this.shutdown,this),t.on(n.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});return i.register("LightsPlugin",s,"lights"),oJ=s}(),lJ=t}function n4(){if(RJ)return MJ;RJ=1;var t=sl();return t.Area=(dJ||(dJ=1,cJ=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}),cJ),t.Circumference=el(),t.CircumferencePoint=Zh(),t.Clone=function(){if(pJ)return fJ;pJ=1;var t=sl();return fJ=function(e){return new t(e.x,e.y,e.radius)}}(),t.Contains=jh(),t.ContainsPoint=function(){if(vJ)return gJ;vJ=1;var t=jh();return gJ=function(e,i){return t(e,i.x,i.y)},gJ}(),t.ContainsRect=function(){if(yJ)return mJ;yJ=1;var t=jh();return mJ=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},mJ}(),t.CopyFrom=wJ?xJ:(wJ=1,xJ=function(t,e){return e.setTo(t.x,t.y,t.radius)}),t.Equals=(bJ||(bJ=1,TJ=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}),TJ),t.GetBounds=function(){if(EJ)return SJ;EJ=1;var t=Fu();return SJ=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.diameter,i.height=e.diameter,i},SJ}(),t.GetPoint=tl(),t.GetPoints=il(),t.Offset=(CJ||(CJ=1,_J=function(t,e,i){return t.x+=e,t.y+=i,t}),_J),t.OffsetPoint=(PJ||(PJ=1,AJ=function(t,e){return t.x+=e.x,t.y+=e.y,t}),AJ),t.Random=nl(),MJ=t}function s4(){if(ZJ)return KJ;ZJ=1;var t=rV();return t.Area=(OJ||(OJ=1,LJ=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}),LJ),t.Circumference=nV(),t.CircumferencePoint=eV(),t.Clone=function(){if(DJ)return FJ;DJ=1;var t=rV();return FJ=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=tV(),t.ContainsPoint=function(){if(kJ)return IJ;kJ=1;var t=tV();return IJ=function(e,i){return t(e,i.x,i.y)},IJ}(),t.ContainsRect=function(){if(NJ)return BJ;NJ=1;var t=tV();return BJ=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},BJ}(),t.CopyFrom=zJ?UJ:(zJ=1,UJ=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}),t.Equals=(XJ||(XJ=1,YJ=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),YJ),t.GetBounds=function(){if(WJ)return GJ;WJ=1;var t=Fu();return GJ=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.width,i.height=e.height,i},GJ}(),t.GetPoint=iV(),t.GetPoints=sV(),t.Offset=(VJ||(VJ=1,HJ=function(t,e,i){return t.x+=e,t.y+=i,t}),HJ),t.OffsetPoint=(qJ||(qJ=1,jJ=function(t,e){return t.x+=e.x,t.y+=e.y,t}),jJ),t.Random=AD(),KJ=t}function r4(){if($J)return JJ;$J=1;var t=ID();return JJ=function(e,i){return t(e.x,e.y,i.x,i.y)<=e.radius+i.radius}}function a4(){if(t$)return QJ;t$=1;var t=Kh(),e=r4();return QJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o,h,l=i.x,u=i.y,c=i.radius,d=n.x,f=n.y,p=n.radius;if(u===f)0==(o=(a=-2*f)*a-4*(r=1)*(d*d+(h=(p*p-c*c-d*d+l*l)/(2*(l-d)))*h-2*d*h+f*f-p*p))?s.push(new t(h,-a/(2*r))):o>0&&(s.push(new t(h,(-a+Math.sqrt(o))/(2*r))),s.push(new t(h,(-a-Math.sqrt(o))/(2*r))));else{var g=(l-d)/(u-f),v=(p*p-c*c-d*d+l*l-f*f+u*u)/(2*(u-f));0==(o=(a=2*u*g-2*v*g-2*l)*a-4*(r=g*g+1)*(l*l+u*u+v*v-c*c-2*u*v))?(h=-a/(2*r),s.push(new t(h,v-h*g))):o>0&&(h=(-a+Math.sqrt(o))/(2*r),s.push(new t(h,v-h*g)),h=(-a-Math.sqrt(o))/(2*r),s.push(new t(h,v-h*g)))}}return s}}function o4(){if(i$)return e$;i$=1;var t=jh(),e=new(Kh());return e$=function(i,n,s){if(void 0===s&&(s=e),t(n,i.x1,i.y1))return s.x=i.x1,s.y=i.y1,!0;if(t(n,i.x2,i.y2))return s.x=i.x2,s.y=i.y2,!0;var r=i.x2-i.x1,a=i.y2-i.y1,o=n.x-i.x1,h=n.y-i.y1,l=r*r+a*a,u=r,c=a;if(l>0){var d=(o*r+h*a)/l;u*=d,c*=d}return s.x=i.x1+u,s.y=i.y1+c,u*u+c*c<=l&&u*r+c*a>=0&&t(n,s.x,s.y)},e$}function h4(){if(s$)return n$;s$=1;var t=Kh(),e=o4();return n$=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o=i.x1,h=i.y1,l=i.x2,u=i.y2,c=n.x,d=n.y,f=n.radius,p=l-o,g=u-h,v=o-c,m=h-d,y=p*p+g*g,x=2*(p*v+g*m),w=x*x-4*y*(v*v+m*m-f*f);if(0===w){var T=-x/(2*y);r=o+T*p,a=h+T*g,T>=0&&T<=1&&s.push(new t(r,a))}else if(w>0){var b=(-x-Math.sqrt(w))/(2*y);r=o+b*p,a=h+b*g,b>=0&&b<=1&&s.push(new t(r,a));var S=(-x+Math.sqrt(w))/(2*y);r=o+S*p,a=h+S*g,S>=0&&S<=1&&s.push(new t(r,a))}}return s},n$}function l4(){if(a$)return r$;a$=1;var t=h4(),e=t4();return r$=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=n.getLineD();t(r,i,s),t(a,i,s),t(o,i,s),t(h,i,s)}return s},r$}function u4(){if(h$)return o$;h$=1;var t=Ck();return o$=function(e,i,n,s){void 0===n&&(n=!1);var r,a,o,h=e.x1,l=e.y1,u=e.x2,c=e.y2,d=i.x1,f=i.y1,p=u-h,g=c-l,v=i.x2-d,m=i.y2-f,y=p*m-g*v;if(0===y)return null;if(n){if(r=(p*(f-l)+g*(h-d))/(v*g-m*p),0!==p)a=(d+v*r-h)/p;else{if(0===g)return null;a=(f+m*r-l)/g}if(a<0||r<0||r>1)return null;o=a}else{if(a=((l-f)*p-(h-d)*g)/y,(r=((d-h)*m-(f-l)*v)/y)<0||r>1||a<0||a>1)return null;o=r}return void 0===s&&(s=new t),s.set(h+p*o,l+g*o,o)}}function c4(){if(u$)return l$;u$=1;var t=u4(),e=Lu(),i=Ck(),n=new e,s=new i;return l$=function(e,r,a,o){void 0===a&&(a=!1),void 0===o&&(o=new i);var h=!1;o.set(),s.set();for(var l=r[r.length-1],u=0;u<r.length;u++){var c=r[u];n.setTo(l.x,l.y,c.x,c.y),l=c,t(e,n,a,s)&&(!h||s.z<o.z)&&(o.copy(s),h=!0)}return h?o:null},l$}function d4(){if(d$)return c$;d$=1;var t=Ck(),e=Ok(),i=c4(),n=new t;return c$=function(t,s,r,a){void 0===a&&(a=new e),Array.isArray(s)||(s=[s]);var o=!1;a.set(),n.set();for(var h=0;h<s.length;h++)i(t,s[h].points,r,n)&&(!o||n.z<a.z)&&(a.set(n.x,n.y,n.z,h),o=!0);return o?a:null},c$}function f4(){return p$?f$:(p$=1,f$=function(t,e,i){var n=t.x1,s=t.y1,r=t.x2,a=t.y2,o=e.x1,h=e.y1,l=e.x2,u=e.y2;if(n===r&&s===a||o===l&&h===u)return!1;var c=(u-h)*(r-n)-(l-o)*(a-s);if(0===c)return!1;var d=((l-o)*(s-h)-(u-h)*(n-o))/c,f=((r-n)*(s-h)-(a-s)*(n-o))/c;return!(d<0||d>1||f<0||f>1||(i&&(i.x=n+d*(r-n),i.y=s+d*(a-s)),0))})}function p4(){return v$||(v$=1,g$=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=e.x,o=e.y,h=e.right,l=e.bottom,u=0;if(i>=a&&i<=h&&n>=o&&n<=l||s>=a&&s<=h&&r>=o&&r<=l)return!0;if(i<a&&s>=a){if((u=n+(r-n)*(a-i)/(s-i))>o&&u<=l)return!0}else if(i>h&&s<=h&&(u=n+(r-n)*(h-i)/(s-i))>=o&&u<=l)return!0;if(n<o&&r>=o){if((u=i+(s-i)*(o-n)/(r-n))>=a&&u<=h)return!0}else if(n>l&&r<=l&&(u=i+(s-i)*(l-n)/(r-n))>=a&&u<=h)return!0;return!1}),g$}function g4(){if(y$)return m$;y$=1;var t=Kh(),e=f4(),i=p4();return m$=function(n,s,r){if(void 0===r&&(r=[]),i(n,s))for(var a=s.getLineA(),o=s.getLineB(),h=s.getLineC(),l=s.getLineD(),u=[new t,new t,new t,new t],c=[e(a,n,u[0]),e(o,n,u[1]),e(h,n,u[2]),e(l,n,u[3])],d=0;d<4;d++)c[d]&&r.push(u[d]);return r},m$}function v4(){if(w$)return x$;w$=1;var t=Ok(),e=d4(),i=new(Lu());function n(n,s,r,a,o){var h=Math.cos(n),l=Math.sin(n);i.setTo(s,r,s+h,r+l);var u=e(i,a,!0);u&&o.push(new t(u.x,u.y,n,u.w))}function s(t,e){return t.z-e.z}return x$=function(t,e,i){Array.isArray(i)||(i=[i]);for(var r=[],a=[],o=0;o<i.length;o++)for(var h=i[o].points,l=0;l<h.length;l++){var u=Math.atan2(h[l].y-e,h[l].x-t);-1===a.indexOf(u)&&(n(u,t,e,i,r),n(u-1e-5,t,e,i,r),n(u+1e-5,t,e,i,r),a.push(u))}return r.sort(s)},x$}function m4(){if(b$)return T$;b$=1;var t=Fu(),e=RV();return T$=function(i,n,s){return void 0===s&&(s=new t),e(i,n)&&(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y),s}}function y4(){if(E$)return S$;E$=1;var t=g4(),e=RV();return S$=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC(),h=i.getLineD();t(r,n,s),t(a,n,s),t(o,n,s),t(h,n,s)}return s}}function x4(){return C$||(C$=1,_$=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=[]);for(var s,r,a,o,h,l,u=t.x3-t.x1,c=t.y3-t.y1,d=t.x2-t.x1,f=t.y2-t.y1,p=u*u+c*c,g=u*d+c*f,v=d*d+f*f,m=p*v-g*g,y=0===m?0:1/m,x=t.x1,w=t.y1,T=0;T<e.length&&(r=(p*(l=d*(a=e[T].x-x)+f*(o=e[T].y-w))-g*(h=u*a+c*o))*y,!((s=(v*h-g*l)*y)>=0&&r>=0&&s+r<1&&(n.push({x:e[T].x,y:e[T].y}),i)));T++);return n}),_$}function w4(){return P$?A$:(P$=1,A$=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e})}function T4(){if(R$)return M$;R$=1;var t=f4(),e=Tu(),i=x4(),n=w4();return M$=function(s,r){if(r.left>s.right||r.right<s.left||r.top>s.bottom||r.bottom<s.top)return!1;var a=r.getLineA(),o=r.getLineB(),h=r.getLineC();if(e(s,a.x1,a.y1)||e(s,a.x2,a.y2))return!0;if(e(s,o.x1,o.y1)||e(s,o.x2,o.y2))return!0;if(e(s,h.x1,h.y1)||e(s,h.x2,h.y2))return!0;var l=s.getLineA(),u=s.getLineB(),c=s.getLineC(),d=s.getLineD();if(t(a,l)||t(a,u)||t(a,c)||t(a,d))return!0;if(t(o,l)||t(o,u)||t(o,c)||t(o,d))return!0;if(t(h,l)||t(h,u)||t(h,c)||t(h,d))return!0;var f=n(s);return i(r,f,!0).length>0},M$}function b4(){if(O$)return L$;O$=1;var t=T4(),e=g4();return L$=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(r,i,s),e(a,i,s),e(o,i,s)}return s},L$}function S4(){if(D$)return F$;D$=1;var t=o4(),e=cj();return F$=function(i,n){return!(i.left>n.right||i.right<n.left||i.top>n.bottom||i.bottom<n.top||!e(i,n.x,n.y)&&!t(i.getLineA(),n)&&!t(i.getLineB(),n)&&!t(i.getLineC(),n))},F$}function E4(){if(k$)return I$;k$=1;var t=h4(),e=S4();return I$=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();t(r,n,s),t(a,n,s),t(o,n,s)}return s},I$}function _4(){if(N$)return B$;N$=1;var t=f4();return B$=function(e,i){return!!(e.contains(i.x1,i.y1)||e.contains(i.x2,i.y2)||t(e.getLineA(),i)||t(e.getLineB(),i)||t(e.getLineC(),i))},B$}function C4(){if(z$)return U$;z$=1;var t=Kh(),e=_4(),i=f4();return U$=function(n,s,r){if(void 0===r&&(r=[]),e(n,s))for(var a=n.getLineA(),o=n.getLineB(),h=n.getLineC(),l=[new t,new t,new t],u=[i(a,s,l[0]),i(o,s,l[1]),i(h,s,l[2])],c=0;c<3;c++)u[c]&&r.push(l[c]);return r},U$}function A4(){return X$||(X$=1,Y$=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e}),Y$}function P4(){if(W$)return G$;W$=1;var t=x4(),e=A4(),i=f4();return G$=function(n,s){if(n.left>s.right||n.right<s.left||n.top>s.bottom||n.bottom<s.top)return!1;var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=s.getLineA(),l=s.getLineB(),u=s.getLineC();if(i(r,h)||i(r,l)||i(r,u))return!0;if(i(a,h)||i(a,l)||i(a,u))return!0;if(i(o,h)||i(o,l)||i(o,u))return!0;var c=e(n),d=t(s,c,!0);return d.length>0||(c=e(s),(d=t(n,c,!0)).length>0)}}function M4(){if(V$)return H$;V$=1;var t=P4(),e=C4();return H$=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(i,r,s),e(i,a,s),e(i,o,s)}return s}}function R4(){return q$||(q$=1,j$=function(t,e,i){void 0===i&&(i=1);var n=e.x1,s=e.y1,r=e.x2,a=e.y2,o=t.x,h=t.y,l=(r-n)*(r-n)+(a-s)*(a-s);if(0===l)return!1;var u=((o-n)*(r-n)+(h-s)*(a-s))/l;if(u<0)return Math.sqrt((n-o)*(n-o)+(s-h)*(s-h))<=i;if(u>=0&&u<=1){var c=((s-h)*(r-n)-(n-o)*(a-s))/l;return Math.abs(c)*Math.sqrt(l)<=i}return Math.sqrt((r-o)*(r-o)+(a-h)*(a-h))<=i}),j$}function L4(){if(Z$)return K$;Z$=1;var t=R4();return K$=function(e,i){if(!t(e,i))return!1;var n=Math.min(i.x1,i.x2),s=Math.max(i.x1,i.x2),r=Math.min(i.y1,i.y2),a=Math.max(i.y1,i.y2);return e.x>=n&&e.x<=s&&e.y>=r&&e.y<=a},K$}function O4(){return tQ?Q$:(tQ=1,Q$={CircleToCircle:r4(),CircleToRectangle:t4(),GetCircleToCircle:a4(),GetCircleToRectangle:l4(),GetLineToCircle:h4(),GetLineToLine:u4(),GetLineToPoints:c4(),GetLineToPolygon:d4(),GetLineToRectangle:g4(),GetRaysFromPointToPolygon:v4(),GetRectangleIntersection:m4(),GetRectangleToRectangle:y4(),GetRectangleToTriangle:b4(),GetTriangleToCircle:E4(),GetTriangleToLine:C4(),GetTriangleToTriangle:M4(),LineToCircle:o4(),LineToLine:f4(),LineToRectangle:p4(),PointToLine:R4(),PointToLineSegment:L4(),RectangleToRectangle:RV(),RectangleToTriangle:T4(),RectangleToValues:$$?J$:($$=1,J$=function(t,e,i,n,s,r){return void 0===r&&(r=0),!(e>t.right+r||i<t.left-r||n>t.bottom+r||s<t.top-r)}),TriangleToCircle:S4(),TriangleToLine:_4(),TriangleToTriangle:P4()})}function F4(){return iQ||(iQ=1,eQ=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}),eQ}function D4(){if(EQ)return SQ;EQ=1;var t=Qh(),e=ic(),i=F4();return SQ=function(n){var s=i(n)-t.TAU;return e(s,-Math.PI,Math.PI)},SQ}function I4(){return kQ||(kQ=1,IQ=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,t}),IQ}function k4(){if(qQ)return jQ;qQ=1;var t=Lu();return t.Angle=F4(),t.BresenhamPoints=SD(),t.CenterOn=(sQ||(sQ=1,nQ=function(t,e,i){var n=e-(t.x1+t.x2)/2,s=i-(t.y1+t.y2)/2;return t.x1+=n,t.y1+=s,t.x2+=n,t.y2+=s,t}),nQ),t.Clone=function(){if(aQ)return rQ;aQ=1;var t=Lu();return rQ=function(e){return new t(e.x1,e.y1,e.x2,e.y2)}}(),t.CopyFrom=hQ?oQ:(hQ=1,oQ=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}),t.Equals=(uQ||(uQ=1,lQ=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}),lQ),t.Extend=function(){if(dQ)return cQ;dQ=1;var t=Cu();return cQ=function(e,i,n){void 0===n&&(n=i);var s=t(e),r=e.x2-e.x1,a=e.y2-e.y1;return i&&(e.x1=e.x1-r/s*i,e.y1=e.y1-a/s*i),n&&(e.x2=e.x2+r/s*n,e.y2=e.y2+a/s*n),e},cQ}(),t.GetEasedPoints=xD(),t.GetMidPoint=function(){if(pQ)return fQ;pQ=1;var t=Kh();return fQ=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2)/2,i.y=(e.y1+e.y2)/2,i},fQ}(),t.GetNearestPoint=function(){if(vQ)return gQ;vQ=1;var t=Kh();return gQ=function(e,i,n){void 0===n&&(n=new t);var s=e.x1,r=e.y1,a=e.x2,o=e.y2,h=(a-s)*(a-s)+(o-r)*(o-r);if(0===h)return n;var l=((i.x-s)*(a-s)+(i.y-r)*(o-r))/h;return n.x=s+l*(a-s),n.y=r+l*(o-r),n},gQ}(),t.GetNormal=function(){if(yQ)return mQ;yQ=1;var t=Qh(),e=F4(),i=Kh();return mQ=function(n,s){void 0===s&&(s=new i);var r=e(n)-t.TAU;return s.x=Math.cos(r),s.y=Math.sin(r),s},mQ}(),t.GetPoint=_u(),t.GetPoints=Au(),t.GetShortestDistance=(wQ||(wQ=1,xQ=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=(s-i)*(s-i)+(r-n)*(r-n);if(0===a)return!1;var o=((n-e.y)*(s-i)-(i-e.x)*(r-n))/a;return Math.abs(o)*Math.sqrt(a)}),xQ),t.Height=(bQ||(bQ=1,TQ=function(t){return Math.abs(t.y1-t.y2)}),TQ),t.Length=Cu(),t.NormalAngle=D4(),t.NormalX=function(){if(CQ)return _Q;CQ=1;var t=Qh(),e=F4();return _Q=function(i){return Math.cos(e(i)-t.TAU)},_Q}(),t.NormalY=function(){if(PQ)return AQ;PQ=1;var t=Qh(),e=F4();return AQ=function(i){return Math.sin(e(i)-t.TAU)},AQ}(),t.Offset=(RQ||(RQ=1,MQ=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t}),MQ),t.PerpSlope=(OQ||(OQ=1,LQ=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}),LQ),t.Random=Pu(),t.ReflectAngle=function(){if(DQ)return FQ;DQ=1;var t=F4(),e=D4();return FQ=function(i,n){return 2*e(n)-Math.PI-t(i)}}(),t.Rotate=function(){if(NQ)return BQ;NQ=1;var t=I4();return BQ=function(e,i){var n=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2;return t(e,n,s,i)},BQ}(),t.RotateAroundPoint=function(){if(zQ)return UQ;zQ=1;var t=I4();return UQ=function(e,i,n){return t(e,i.x,i.y,n)},UQ}(),t.RotateAroundXY=I4(),t.SetToAngle=(XQ||(XQ=1,YQ=function(t,e,i,n,s){return t.x1=e,t.y1=i,t.x2=e+Math.cos(n)*s,t.y2=i+Math.sin(n)*s,t}),YQ),t.Slope=(WQ||(WQ=1,GQ=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}),GQ),t.Width=(VQ||(VQ=1,HQ=function(t){return Math.abs(t.x1-t.x2)}),HQ),jQ=t}function B4(){if(ZQ)return KQ;ZQ=1;var t=!0,e="untitled",i="",n="";function s(t){var e=t.indexOf("#");return e>-1?t.substring(0,e):t}function r(t){return 0===t.models.length&&t.models.push({faces:[],name:e,textureCoords:[],vertexNormals:[],vertices:[]}),i="",t.models[t.models.length-1]}function a(t,n){var s=t.length>=2?t[1]:e;n.models.push({faces:[],name:s,textureCoords:[],vertexNormals:[],vertices:[]}),i=""}function o(t){2===t.length&&(i=t[1])}function h(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertices.push({x:n,y:s,z:a})}function l(e,i){var n=e.length,s=n>=2?parseFloat(e[1]):0,a=n>=3?parseFloat(e[2]):0,o=n>=4?parseFloat(e[3]):0;isNaN(s)&&(s=0),isNaN(a)&&(a=0),isNaN(o)&&(o=0),t&&(a=1-a),r(i).textureCoords.push({u:s,v:a,w:o})}function u(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertexNormals.push({x:n,y:s,z:a})}function c(t,e){var s=t.length-1;if(!(s<3)){for(var a={group:i,material:n,vertices:[]},o=0;o<s;o++){var h=t[o+1].split("/"),l=h.length;if(!(l<1||l>3)){var u=0,c=0,d=0;u=parseInt(h[0],10),l>1&&""!==h[1]&&(c=parseInt(h[1],10)),l>2&&(d=parseInt(h[2],10)),0!==u&&(u<0&&(u=r(e).vertices.length+1+u),c-=1,u-=1,d-=1,a.vertices.push({textureCoordsIndex:c,vertexIndex:u,vertexNormalIndex:d}))}}r(e).faces.push(a)}}function d(t,e){t.length>=2&&e.materialLibraries.push(t[1])}function f(t){t.length>=2&&(n=t[1])}return KQ=function(e,r){void 0===r&&(r=!0),t=r;var p={materials:{},materialLibraries:[],models:[]};i="",n="";for(var g=e.split("\n"),v=0;v<g.length;v++){var m=s(g[v]).replace(/\s\s+/g," ").trim().split(" ");switch(m[0].toLowerCase()){case"o":a(m,p);break;case"g":o(m);break;case"v":h(m,p);break;case"vt":l(m,p);break;case"vn":u(m,p);break;case"f":c(m,p);break;case"mtllib":d(m,p);break;case"usemtl":f(m)}}return p},KQ}function N4(){if($Q)return JQ;$Q=1;var t=EI();return JQ=function(e){for(var i={},n=e.split("\n"),s="",r=0;r<n.length;r++){var a=n[r].trim();if(0!==a.indexOf("#")&&""!==a){var o=a.replace(/\s\s+/g," ").trim().split(" ");switch(o[0].toLowerCase()){case"newmtl":s=o[1];break;case"kd":var h=Math.floor(255*o[1]),l=o.length>=2?Math.floor(255*o[2]):h,u=o.length>=3?Math.floor(255*o[3]):h;i[s]=t(h,l,u)}}}return i},JQ}function U4(){if(i0)return e0;i0=1;var t={Face:kZ(),GenerateGridVerts:GZ(),GenerateObjVerts:NZ(),GenerateVerts:UZ(),ParseObj:B4(),ParseObjMaterial:N4(),RotateFace:(t0||(t0=1,QQ=function(t,e,i,n){var s,r;if(void 0===i&&void 0===n){var a=t.getInCenter();s=a.x,r=a.y}var o=Math.cos(e),h=Math.sin(e),l=t.vertex1,u=t.vertex2,c=t.vertex3,d=l.x-s,f=l.y-r;l.set(d*o-f*h+s,d*h+f*o+r),d=u.x-s,f=u.y-r,u.set(d*o-f*h+s,d*h+f*o+r),d=c.x-s,f=c.y-r,c.set(d*o-f*h+s,d*h+f*o+r)}),QQ),Vertex:BZ()};return e0=t}function z4(){return v0||(v0=1,g0=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}),g0}function Y4(){return y0||(y0=1,m0=function(t){return t.x*t.x+t.y*t.y}),m0}function X4(){if(D0)return F0;D0=1;var t=Kh();return t.Ceil=(s0||(s0=1,n0=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}),n0),t.Clone=function(){if(a0)return r0;a0=1;var t=Kh();return r0=function(e){return new t(e.x,e.y)}}(),t.CopyFrom=h0?o0:(h0=1,o0=function(t,e){return e.setTo(t.x,t.y)}),t.Equals=(u0||(u0=1,l0=function(t,e){return t.x===e.x&&t.y===e.y}),l0),t.Floor=(d0||(d0=1,c0=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}),c0),t.GetCentroid=function(){if(p0)return f0;p0=1;var t=Kh();return f0=function(e,i){if(void 0===i&&(i=new t),!Array.isArray(e))throw new Error("GetCentroid points argument must be an array");var n=e.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)i.x=e[0].x,i.y=e[0].y;else{for(var s=0;s<n;s++)i.x+=e[s].x,i.y+=e[s].y;i.x/=n,i.y/=n}return i}}(),t.GetMagnitude=z4(),t.GetMagnitudeSq=Y4(),t.GetRectangleFromPoints=function(){if(w0)return x0;w0=1;var t=Fu();return x0=function(e,i){void 0===i&&(i=new t);for(var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=0;o<e.length;o++){var h=e[o];h.x>n&&(n=h.x),h.x<s&&(s=h.x),h.y>r&&(r=h.y),h.y<a&&(a=h.y)}return i.x=s,i.y=a,i.width=n-s,i.height=r-a,i},x0}(),t.Interpolate=function(){if(b0)return T0;b0=1;var t=Kh();return T0=function(e,i,n,s){return void 0===n&&(n=0),void 0===s&&(s=new t),s.x=e.x+(i.x-e.x)*n,s.y=e.y+(i.y-e.y)*n,s}}(),t.Invert=(E0||(E0=1,S0=function(t){return t.setTo(t.y,t.x)}),S0),t.Negative=function(){if(C0)return _0;C0=1;var t=Kh();return _0=function(e,i){return void 0===i&&(i=new t),i.setTo(-e.x,-e.y)},_0}(),t.Project=function(){if(P0)return A0;P0=1;var t=Kh(),e=Y4();return A0=function(i,n,s){void 0===s&&(s=new t);var r=(i.x*n.x+i.y*n.y)/e(n);return 0!==r&&(s.x=r*n.x,s.y=r*n.y),s}}(),t.ProjectUnit=function(){if(R0)return M0;R0=1;var t=Kh();return M0=function(e,i,n){void 0===n&&(n=new t);var s=e.x*i.x+e.y*i.y;return 0!==s&&(n.x=s*i.x,n.y=s*i.y),n}}(),t.SetMagnitude=function(){if(O0)return L0;O0=1;var t=z4();return L0=function(e,i){if(0!==e.x||0!==e.y){var n=t(e);e.x/=n,e.y/=n}return e.x*=i,e.y*=i,e},L0}(),F0=t}function G4(){if(W0)return G0;function t(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}function e(t,e,i){var n=e.x,s=e.y,r=i.x-n,a=i.y-s;if(0!==r||0!==a){var o=((t.x-n)*r+(t.y-s)*a)/(r*r+a*a);o>1?(n=i.x,s=i.y):o>0&&(n+=r*o,s+=a*o)}return(r=t.x-n)*r+(a=t.y-s)*a}function i(t,n,s,r,a){for(var o,h=r,l=n+1;l<s;l++){var u=e(t[l],t[n],t[s]);u>h&&(o=l,h=u)}h>r&&(o-n>1&&i(t,n,o,r,a),a.push(t[o]),s-o>1&&i(t,o,s,r,a))}function n(t,e){var n=t.length-1,s=[t[0]];return i(t,0,n,e,s),s.push(t[n]),s}return W0=1,G0=function(e,i,s){void 0===i&&(i=1),void 0===s&&(s=!1);var r=e.points;if(r.length>2){var a=i*i;s||(r=function(e,i){for(var n,s=e[0],r=[s],a=1,o=e.length;a<o;a++)t(n=e[a],s)>i&&(r.push(n),s=n);return s!==n&&r.push(n),r}(r,a)),e.setTo(n(r,a))}return e},G0}function W4(){if(q0)return j0;q0=1;var t=aj();return t.Clone=function(){if(k0)return I0;k0=1;var t=aj();return I0=function(e){return new t(e.points)},I0}(),t.Contains=nj(),t.ContainsPoint=function(){if(N0)return B0;N0=1;var t=nj();return B0=function(e,i){return t(e,i.x,i.y)},B0}(),t.Earcut=DB(),t.GetAABB=ij(),t.GetNumberArray=(z0||(z0=1,U0=function(t,e){void 0===e&&(e=[]);for(var i=0;i<t.points.length;i++)e.push(t.points[i].x),e.push(t.points[i].y);return e}),U0),t.GetPoints=rj(),t.Perimeter=sj(),t.Reverse=(X0||(X0=1,Y0=function(t){return t.points.reverse(),t}),Y0),t.Simplify=G4(),t.Smooth=oj(),t.Translate=(V0||(V0=1,H0=function(t,e,i){for(var n=t.points,s=0;s<n.length;s++)n[s].x+=e,n[s].y+=i;return t}),H0),j0=t}function H4(){return a1?r1:(a1=1,r1=function(t,e){return!(e.width*e.height>t.width*t.height)&&e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom})}function V4(){return u1?l1:(u1=1,l1=function(t){return 0===t.height?NaN:t.width/t.height})}function j4(){if(V1)return H1;V1=1;var t=Fu();return t.Area=Z0?K0:(Z0=1,K0=function(t){return t.width*t.height}),t.Ceil=$0?J0:($0=1,J0=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}),t.CeilAll=t1?Q0:(t1=1,Q0=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}),t.CenterOn=kI(),t.Clone=function(){if(i1)return e1;i1=1;var t=Fu();return e1=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=Tu(),t.ContainsPoint=function(){if(s1)return n1;s1=1;var t=Tu();return n1=function(e,i){return t(e,i.x,i.y)},n1}(),t.ContainsRect=H4(),t.CopyFrom=TV(),t.Decompose=w4(),t.Equals=h1?o1:(h1=1,o1=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),t.FitInside=function(){if(d1)return c1;d1=1;var t=V4();return c1=function(e,i){var n=t(e);return n<t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)}}(),t.FitOutside=function(){if(p1)return f1;p1=1;var t=V4();return f1=function(e,i){var n=t(e);return n>t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)}}(),t.Floor=v1?g1:(v1=1,g1=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}),t.FloorAll=y1?m1:(y1=1,m1=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}),t.FromPoints=vN(),t.FromXY=function(){if(w1)return x1;w1=1;var t=Fu();return x1=function(e,i,n,s,r){return void 0===r&&(r=new t),r.setTo(Math.min(e,n),Math.min(i,s),Math.abs(e-n),Math.abs(i-s))}}(),t.GetAspectRatio=V4(),t.GetCenter=function(){if(b1)return T1;b1=1;var t=Kh();return T1=function(e,i){return void 0===i&&(i=new t),i.x=e.centerX,i.y=e.centerY,i}}(),t.GetPoint=Su(),t.GetPoints=Eu(),t.GetSize=function(){if(E1)return S1;E1=1;var t=Kh();return S1=function(e,i){return void 0===i&&(i=new t),i.x=e.width,i.y=e.height,i}}(),t.Inflate=CV(),t.Intersection=function(){if(C1)return _1;C1=1;var t=Fu(),e=RV();return _1=function(i,n,s){return void 0===s&&(s=new t),e(i,n)?(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y):s.setEmpty(),s}}(),t.MarchingAnts=TD(),t.MergePoints=P1?A1:(P1=1,A1=function(t,e){for(var i=t.x,n=t.right,s=t.y,r=t.bottom,a=0;a<e.length;a++)i=Math.min(i,e[a].x),n=Math.max(n,e[a].x),s=Math.min(s,e[a].y),r=Math.max(r,e[a].y);return t.x=i,t.y=s,t.width=n-i,t.height=r-s,t}),t.MergeRect=AV(),t.MergeXY=R1?M1:(R1=1,M1=function(t,e,i){var n=Math.min(t.x,e),s=Math.max(t.right,e);t.x=n,t.width=s-n;var r=Math.min(t.y,i),a=Math.max(t.bottom,i);return t.y=r,t.height=a-r,t}),t.Offset=O1?L1:(O1=1,L1=function(t,e,i){return t.x+=e,t.y+=i,t}),t.OffsetPoint=(D1||(D1=1,F1=function(t,e){return t.x+=e.x,t.y+=e.y,t}),F1),t.Overlaps=k1?I1:(k1=1,I1=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}),t.Perimeter=bu(),t.PerimeterPoint=function(){if(N1)return B1;N1=1;var t=Kh(),e=Xu();return B1=function(i,n,s){void 0===s&&(s=new t),n=e(n);var r=Math.sin(n),a=Math.cos(n),o=a>0?i.width/2:i.width/-2,h=r>0?i.height/2:i.height/-2;return Math.abs(o*r)<Math.abs(h*a)?h=o*r/a:o=h*a/r,s.x=o+i.centerX,s.y=h+i.centerY,s},B1}(),t.Random=Ou(),t.RandomOutside=function(){if(z1)return U1;z1=1;var t=vI(),e=H4(),i=Kh();return U1=function(n,s,r){if(void 0===r&&(r=new i),e(n,s))switch(t(0,3)){case 0:r.x=n.x+Math.random()*(s.right-n.x),r.y=n.y+Math.random()*(s.top-n.y);break;case 1:r.x=s.x+Math.random()*(n.right-s.x),r.y=s.bottom+Math.random()*(n.bottom-s.bottom);break;case 2:r.x=n.x+Math.random()*(s.x-n.x),r.y=s.y+Math.random()*(n.bottom-s.y);break;case 3:r.x=s.right+Math.random()*(n.right-s.right),r.y=n.y+Math.random()*(s.bottom-n.y)}return r}}(),t.SameDimensions=X1?Y1:(X1=1,Y1=function(t,e){return t.width===e.width&&t.height===e.height}),t.Scale=W1?G1:(W1=1,G1=function(t,e,i){return void 0===i&&(i=e),t.width*=e,t.height*=i,t}),t.Union=VU(),H1=t}function q4(){if(i2)return e2;i2=1;var t=Kh();return e2=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2+e.x3)/3,i.y=(e.y1+e.y2+e.y3)/3,i},e2}function K4(){return s2||(s2=1,n2=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t.x3+=e,t.y3+=i,t}),n2}function Z4(){if(w2)return x2;w2=1;var t=Kh();function e(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}return x2=function(i,n){void 0===n&&(n=new t);var s=i.x1,r=i.y1,a=i.x2,o=i.y2,h=i.x3,l=i.y3,u=e(h,l,a,o),c=e(s,r,h,l),d=e(a,o,s,r),f=u+c+d;return n.x=(s*u+a*c+h*d)/f,n.y=(r*u+o*c+l*d)/f,n},x2}function J4(){return E2||(E2=1,S2=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,a=t.x3-e,o=t.y3-i,t.x3=a*s-o*r+e,t.y3=a*r+o*s+i,t}),S2}function $4(){if(R2)return M2;R2=1;var t=pj();return t.Area=(q1||(q1=1,j1=function(t){var e=t.x1,i=t.y1,n=t.x2,s=t.y2,r=t.x3,a=t.y3;return Math.abs(((r-e)*(s-i)-(n-e)*(a-i))/2)}),j1),t.BuildEquilateral=function(){if(Z1)return K1;Z1=1;var t=pj();return K1=function(e,i,n){var s=n*(Math.sqrt(3)/2);return new t(e,i,e+n/2,i+s,e-n/2,i+s)}}(),t.BuildFromPolygon=function(){if($1)return J1;$1=1;var t=DB(),e=pj();return J1=function(i,n,s,r,a){void 0===n&&(n=null),void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=[]);for(var o,h,l,u,c,d,f,p,g,v=t(i,n),m=0;m<v.length;m+=3)o=v[m],h=v[m+1],l=v[m+2],u=i[2*o]*s,c=i[2*o+1]*r,d=i[2*h]*s,f=i[2*h+1]*r,p=i[2*l]*s,g=i[2*l+1]*r,a.push(new e(u,c,d,f,p,g));return a},J1}(),t.BuildRight=function(){if(t2)return Q1;t2=1;var t=pj();return Q1=function(e,i,n,s){return void 0===s&&(s=n),new t(e,i,e,i-s,e+n,i)}}(),t.CenterOn=function(){if(a2)return r2;a2=1;var t=q4(),e=K4();return r2=function(i,n,s,r){void 0===r&&(r=t);var a=r(i),o=n-a.x,h=s-a.y;return e(i,o,h)},r2}(),t.Centroid=q4(),t.CircumCenter=function(){if(h2)return o2;h2=1;var t=Ru();function e(t,e,i,n){return t*n-e*i}return o2=function(i,n){void 0===n&&(n=new t);var s=i.x3,r=i.y3,a=i.x1-s,o=i.y1-r,h=i.x2-s,l=i.y2-r,u=2*e(a,o,h,l),c=e(o,a*a+o*o,l,h*h+l*l),d=e(a,a*a+o*o,h,h*h+l*l);return n.x=s-c/u,n.y=r+d/u,n},o2}(),t.CircumCircle=function(){if(u2)return l2;u2=1;var t=sl();return l2=function(e,i){void 0===i&&(i=new t);var n,s,r=e.x1,a=e.y1,o=e.x2,h=e.y2,l=e.x3,u=e.y3,c=o-r,d=h-a,f=l-r,p=u-a,g=c*(r+o)+d*(a+h),v=f*(r+l)+p*(a+u),m=2*(c*(u-h)-d*(l-o));if(Math.abs(m)<1e-6){var y=Math.min(r,o,l),x=Math.min(a,h,u);n=.5*(Math.max(r,o,l)-y),s=.5*(Math.max(a,h,u)-x),i.x=y+n,i.y=x+s,i.radius=Math.sqrt(n*n+s*s)}else i.x=(p*g-d*v)/m,i.y=(c*v-f*g)/m,n=i.x-r,s=i.y-a,i.radius=Math.sqrt(n*n+s*s);return i},l2}(),t.Clone=function(){if(d2)return c2;d2=1;var t=pj();return c2=function(e){return new t(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3)}}(),t.Contains=cj(),t.ContainsArray=x4(),t.ContainsPoint=function(){if(p2)return f2;p2=1;var t=cj();return f2=function(e,i){return t(e,i.x,i.y)},f2}(),t.CopyFrom=v2?g2:(v2=1,g2=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}),t.Decompose=A4(),t.Equals=(y2||(y2=1,m2=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}),m2),t.GetPoint=dj(),t.GetPoints=fj(),t.InCenter=Z4(),t.Perimeter=function(){if(b2)return T2;b2=1;var t=Cu();return T2=function(e){var i=e.getLineA(),n=e.getLineB(),s=e.getLineC();return t(i)+t(n)+t(s)},T2}(),t.Offset=K4(),t.Random=LD(),t.Rotate=function(){if(C2)return _2;C2=1;var t=J4(),e=Z4();return _2=function(i,n){var s=e(i);return t(i,s.x,s.y,n)},_2}(),t.RotateAroundPoint=function(){if(P2)return A2;P2=1;var t=J4();return A2=function(e,i,n){return t(e,i.x,i.y,n)},A2}(),t.RotateAroundXY=J4(),M2=t}function Q4(){if(O2)return L2;O2=1;var t=qh(),e=nh(),i={Circle:n4(),Ellipse:s4(),Intersects:O4(),Line:k4(),Mesh:U4(),Point:X4(),Polygon:W4(),Rectangle:j4(),Triangle:$4()};return i=e(!1,i,t),L2=i}function t6(){return D2?F2:(D2=1,F2=function(t,e){return function(i,n,s,r){var a=t.getPixelAlpha(n,s,r.texture.key,r.frame.name);return a&&a>=e}})}function e6(){return k2?I2:(k2=1,I2=function(t,e,i){return{gameObject:t,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:i,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}})}function i6(){if(N2)return B2;N2=1;var t=new(Vh())({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});return B2=t}function n6(){return $2?J2:($2=1,J2={BUTTON_DOWN:z2?U2:(z2=1,U2="down"),BUTTON_UP:X2?Y2:(X2=1,Y2="up"),CONNECTED:W2?G2:(W2=1,G2="connected"),DISCONNECTED:V2?H2:(V2=1,H2="disconnected"),GAMEPAD_BUTTON_DOWN:q2?j2:(q2=1,j2="down"),GAMEPAD_BUTTON_UP:Z2?K2:(Z2=1,K2="up")})}function s6(){if(t3)return Q2;t3=1;var t=Vh(),e=n6(),i=new t({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var i=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(e.BUTTON_DOWN,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(e.BUTTON_UP,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});return Q2=i}function r6(){if(i3)return e3;i3=1;var t=i6(),e=s6(),i=Vh(),n=qF(),s=Ru(),r=new i({Extends:n,initialize:function(i,r){n.call(this),this.manager=i,this.pad=r,this.id=r.id,this.index=r.index;for(var a=[],o=0;o<r.buttons.length;o++)a.push(new e(this,o));this.buttons=a;var h=[];for(o=0;o<r.axes.length;o++)h.push(new t(this,o));this.axes=h,this.vibration=r.vibrationActuator;var l={value:0,pressed:!1};this._LCLeft=a[14]?a[14]:l,this._LCRight=a[15]?a[15]:l,this._LCTop=a[12]?a[12]:l,this._LCBottom=a[13]?a[13]:l,this._RCLeft=a[2]?a[2]:l,this._RCRight=a[1]?a[1]:l,this._RCTop=a[3]?a[3]:l,this._RCBottom=a[0]?a[0]:l,this._FBLeftTop=a[4]?a[4]:l,this._FBLeftBottom=a[6]?a[6]:l,this._FBRightTop=a[5]?a[5]:l,this._FBRightBottom=a[7]?a[7]:l;var u={value:0};this._HAxisLeft=h[0]?h[0]:u,this._VAxisLeft=h[1]?h[1]:u,this._HAxisRight=h[2]?h[2]:u,this._VAxisRight=h[3]?h[3]:u,this.leftStick=new s,this.rightStick=new s,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){if(!(t.timestamp<this._created)){var e,i=this.buttons,n=t.buttons,s=i.length;for(e=0;e<s;e++)i[e].update(n[e].value);var r=this.axes,a=t.axes;for(s=r.length,e=0;e<s;e++)r[e].update(a[e]);s>=2&&(this.leftStick.set(r[0].getValue(),r[1].getValue()),s>=4&&this.rightStick.set(r[2].getValue(),r[3].getValue()))}},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});return e3=r}function a6(){if(s3)return n3;s3=1;var t=Ol(),e={},i={register:function(t,i,n,s,r){e[t]={plugin:i,mapping:n,settingsKey:s,configKey:r}},getPlugin:function(t){return e[t]},install:function(i){var n=i.scene.sys,s=n.settings.input,r=n.game.config;for(var a in e){var o=e[a].plugin,h=e[a].mapping,l=e[a].settingsKey,u=e[a].configKey;t(s,l,r[u])&&(i[h]=new o(i))}},remove:function(t){e.hasOwnProperty(t)&&delete e[t]}};return n3=i}function o6(){if(a3)return r3;a3=1;var t=Vh(),e=qF(),i=n6(),n=r6(),s=Ol(),r=a6(),a=qN(),o=new t({Extends:e,initialize:function(t){e.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,t.pluginEvents.once(a.BOOT,this.boot,this),t.pluginEvents.on(a.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,i=t.config;this.enabled=s(e,"gamepad",i.inputGamepad)&&t.device.input.gamepads,this.target=s(e,"gamepad.target",i.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(a.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(a.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,i=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=i,e.addEventListener("gamepadconnected",i,!1),e.addEventListener("gamepaddisconnected",i,!1),this.sceneInputPlugin.pluginEvents.on(a.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(a.UPDATE,this.update);for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].removeAllListeners()},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].pad.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,i=0;i<t.length;i++){var s=t[i];if(s){var r=s.id,a=s.index,o=e[a];if(o)o.id!==r?(o.destroy(),e[a]=new n(this,s)):o.update(s);else{var h=new n(this,s);e[a]=h,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=h):this._pad3=h:this._pad2=h:this._pad1=h}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,i=0;i<e.length;i++)e[i]&&t.push(e[i]);return t},getPad:function(t){for(var e=this.gamepads,i=0;i<e.length;i++)if(e[i]&&e[i].index===t)return e[i]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var s=e[n],r=this.getPad(s.gamepad.index);"gamepadconnected"===s.type?this.emit(i.CONNECTED,r,s):"gamepaddisconnected"===s.type&&this.emit(i.DISCONNECTED,r,s)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});return r.register("GamepadPlugin",o,"gamepad","gamepad","inputGamepad"),r3=o}function h6(){if(y3)return m3;y3=1;var t=sl(),e=jh(),i=Vh(),n=jN(),s=e6(),r=t6(),a=ID(),o=rV(),h=tV(),l=qN(),u=qF(),c=Wh(),d=qh(),f=a6(),p=ih(),g=ku(),v=Fu(),m=Tu(),y=Bu(),x=pj(),w=cj(),T=new i({Extends:u,initialize:function(t){u.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new u,this.enabled=!0,this.displayList,this.cameras,f.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(y.BOOT,this.boot,this),t.sys.events.on(y.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(y.DESTROY,this.destroy,this),this.pluginEvents.emit(l.BOOT)},start:function(){var t=this.systems.events;t.on(y.TRANSITION_START,this.transitionIn,this),t.on(y.TRANSITION_OUT,this.transitionOut,this),t.on(y.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(y.PRE_UPDATE,this.preUpdate,this),t.once(y.SHUTDOWN,this.shutdown,this),this.manager.events.on(l.GAME_OUT,this.onGameOut,this),this.manager.events.on(l.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(l.START)},onGameOver:function(t){this.isActive()&&this.emit(l.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(l.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(l.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,i=t.length,n=e.length;if(0!==i||0!==n){for(var s=this._list,r=0;r<i;r++){var a=t[r],o=s.indexOf(a);o>-1&&(s.splice(o,1),this.clear(a,!0))}this._pendingRemoval.length=0,this._list=s.concat(e.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(t){this.manager&&this.manager.setCursor(t)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(l.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var i,n=this.manager.pointers;for(i=0;i<n.length;i++)n[i].updateMotion();if(0===this._list.length)return!1;var s=this.pollRate;if(-1===s)return!1;if(s>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var r=!1;for(i=0;i<n.length;i++){var a=0,o=n[i];this._tempZones=[],this._temp=this.hitTestPointer(o),this.sortGameObjects(this._temp,o),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),a+=this.processOverOutEvents(o),2===this.getDragState(o)&&this.processDragThresholdEvent(o,t),a>0&&(r=!0)}return r},update:function(t,e){if(!this.isActive())return!1;for(var i=!1,s=0;s<e.length;s++){var r=0,a=e[s];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp,a),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case n.MOUSE_DOWN:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_UP:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOverOutEvents(a);break;case n.TOUCH_START:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverEvents(a);break;case n.TOUCH_END:case n.TOUCH_CANCEL:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOutEvents(a);break;case n.MOUSE_MOVE:case n.TOUCH_MOVE:r+=this.processDragMoveEvent(a),r+=this.processMoveEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_WHEEL:r+=this.processWheelEvent(a)}r>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1),this.disable(t);var i=t.input;i&&(this.removeDebug(t),this.manager.resetCursor(i),i.gameObject=void 0,i.target=void 0,i.hitArea=void 0,i.hitAreaCallback=void 0,i.callbackContext=void 0,t.input=null),e||this.queueForRemoval(t);var n=this._draggable.indexOf(t);return n>-1&&this._draggable.splice(n,1),t},disable:function(t,e){void 0===e&&(e=!1);var i=t.input;i&&(i.enabled=!1,i.dragState=0);for(var n,s=this._drag,r=this._over,a=this.manager,o=0;o<a.pointers.length;o++)(n=s[o].indexOf(t))>-1&&s[o].splice(n,1),(n=r[o].indexOf(t))>-1&&r[o].splice(n,1);return e&&this.resetCursor(),this},enable:function(t,e,i,n){return void 0===n&&(n=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,i),t.input&&n&&!t.input.dropZone&&(t.input.dropZone=n),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),i=0;i<e.length;i++){for(var n=e[i],s=this.manager.hitTest(t,this._list,n),r=0;r<s.length;r++){var a=s[r];a.input.dropZone&&this._tempZones.push(a)}if(s.length>0)return t.camera=n,s}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled&&(this.emit(l.GAMEOBJECT_DOWN,t,a,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&(t.downElement===this.manager.game.canvas?this.emit(l.POINTER_DOWN,t,i):this.emit(l.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var i=!1,n=this.dragTimeThreshold,s=this.dragDistanceThreshold;if((s>0&&a(t.x,t.y,t.downX,t.downY)>=s||n>0&&e>=t.downTime+n)&&(i=!0),i)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;s.dragState=2,s.dragStartX=n.x,s.dragStartY=n.y,s.dragStartXGlobal=t.worldX,s.dragStartYGlobal=t.worldY,s.dragStartCamera=t.camera,s.dragX=s.dragStartXGlobal-s.dragStartX,s.dragY=s.dragStartYGlobal-s.dragStartY,n.emit(l.GAMEOBJECT_DRAG_START,t,s.dragX,s.dragY),this.emit(l.DRAG_START,t,n)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var i=[],n=0;n<e.length;n++){var s=e[n];s.input.draggable&&0===s.input.dragState&&i.push(s)}return 0===i.length?(this.setDragState(t,0),0):(i.length>1&&(this.sortGameObjects(i,t),this.topOnly&&i.splice(1)),this._drag[t.id]=i,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(2===this.getDragState(t)&&this.processDragThresholdEvent(t,this.manager.game.loop.now),4!==this.getDragState(t))return 0;var e=this._tempZones,i=this._drag[t.id];i.length>1&&(i=i.slice(0));for(var n=0;n<i.length;n++){var s,r,a=i[n],o=a.input,h=o.target;if(h){var u=e.indexOf(h);0===u?(a.emit(l.GAMEOBJECT_DRAG_OVER,t,h),this.emit(l.DRAG_OVER,t,a,h)):u>0?(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),e[0]?(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):o.target=null)}else!h&&e[0]&&(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h));var c=t.positionToCamera(o.dragStartCamera);if(a.parentContainer){var d=c.x-o.dragStartXGlobal,f=c.y-o.dragStartYGlobal,p=a.getParentRotation(),g=d*Math.cos(p)+f*Math.sin(p),v=f*Math.cos(p)-d*Math.sin(p);g*=1/a.parentContainer.scaleX,v*=1/a.parentContainer.scaleY,s=g+o.dragStartX,r=v+o.dragStartY}else s=c.x-o.dragX,r=c.y-o.dragY;a.emit(l.GAMEOBJECT_DRAG,t,s,r),this.emit(l.DRAG,t,a,s,r)}return i.length},processDragUpEvent:function(t){var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;if(s&&2===s.dragState){s.dragState=0,s.dragX=s.localX-n.displayOriginX,s.dragY=s.localY-n.displayOriginY,s.dragStartCamera=null;var r=!1,a=s.target;a&&(n.emit(l.GAMEOBJECT_DROP,t,a),this.emit(l.DROP,t,n,a),s.target=null,r=!0),n.input&&n.input.enabled&&(n.emit(l.GAMEOBJECT_DRAG_END,t,s.dragX,s.dragY,r),this.emit(l.DRAG_END,t,n,r))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled){if(this.emit(l.GAMEOBJECT_MOVE,t,a,s),n.cancelled||!this.isActive())break;if(this.topOnly)break}}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_MOVE,t,i),e},processWheelEvent:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=t.deltaX,a=t.deltaY,o=t.deltaZ,h=0;h<i.length;h++){var u=i[h];if(u.input&&u.input.enabled){if(e++,u.emit(l.GAMEOBJECT_POINTER_WHEEL,t,r,a,o,s),n.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_WHEEL,t,u,r,a,o,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_WHEEL,t,i,r,a,o),e},processOverEvents:function(t){var e=this._temp,i=0,n=e.length,s=[];if(n>0){var r=this.manager,a=this._eventData,o=this._eventContainer;a.cancelled=!1;for(var h=0;h<n;h++){var u=e[h];if(u.input&&u.input.enabled){if(s.push(u),r.setCursor(u.input),u.emit(l.GAMEOBJECT_POINTER_OVER,t,u.input.localX,u.input.localY,o),i++,a.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,u,o),a.cancelled||!this.isActive()))break}}!a.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,s)}return this._over[t.id]=s,i},processOutEvents:function(t){var e=this._over[t.id],i=0,n=e.length;if(n>0){var s=this.manager,r=this._eventData,a=this._eventContainer;r.cancelled=!1,this.sortGameObjects(e,t);for(var o=0;o<n;o++){var h=e[o];if((h=e[o]).input&&h.input.enabled){if(s.resetCursor(h.input),h.emit(l.GAMEOBJECT_POINTER_OUT,t,a),i++,r.cancelled||!this.isActive())break;if(h.input&&h.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,h,a),r.cancelled||!this.isActive()))break}}!r.cancelled&&this.isActive()&&this.emit(l.POINTER_OUT,t,e),this._over[t.id]=[]}return i},processOverOutEvents:function(t){var e,i,n=this._temp,s=[],r=[],a=[],o=this._over[t.id],h=this._drag[t.id],u=this.manager;for(e=0;e<o.length;e++)i=o[e],-1===n.indexOf(i)&&-1===h.indexOf(i)?s.push(i):a.push(i);for(e=0;e<n.length;e++)i=n[e],-1===o.indexOf(i)&&r.push(i);var c=s.length,d=0,f=this._eventData,p=this._eventContainer;if(f.cancelled=!1,c>0){for(this.sortGameObjects(s,t),e=0;e<c;e++)if((i=s[e]).input&&i.input.enabled){if(u.resetCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OUT,t,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,i,p),f.cancelled||!this.isActive()))break}f.cancelled&&!this.isActive()||this.emit(l.POINTER_OUT,t,s)}if(c=r.length,f.cancelled=!1,c>0){for(this.sortGameObjects(r,t),e=0;e<c;e++)if((i=r[e]).input&&i.input.enabled){if(u.setCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OVER,t,i.input.localX,i.input.localY,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,i,p),f.cancelled||!this.isActive()))break}!f.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,r)}return o=a.concat(r),this._over[t.id]=this.sortGameObjects(o,t),d},processUpEvents:function(t){var e=this._temp,i=this._eventData,n=this._eventContainer;i.cancelled=!1;for(var s=0;s<e.length;s++){var r=e[s];if(r.input&&r.input.enabled){if(r.emit(l.GAMEOBJECT_POINTER_UP,t,r.input.localX,r.input.localY,n),i.cancelled||!this.isActive())break;if(r.input&&r.input.enabled&&(this.emit(l.GAMEOBJECT_UP,t,r,n),i.cancelled||!this.isActive()))break}}return!i.cancelled&&this.isActive()&&(t.upElement===this.manager.game.canvas?this.emit(l.POINTER_UP,t,e):this.emit(l.POINTER_UP_OUTSIDE,t)),e.length},forceDownState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_DOWN,l.GAMEOBJECT_DOWN,!1)},forceUpState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_UP,l.GAMEOBJECT_UP,!1)},forceOverState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OVER,l.GAMEOBJECT_OVER,!0)},forceOutState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OUT,l.GAMEOBJECT_OUT,!1)},forceState:function(t,e,i,n,s){var r=this._eventData,a=this._eventContainer;r.cancelled=!1,e.input&&e.input.enabled&&(e.emit(i,t,e.input.localX,e.input.localY,a),s&&this.setCursor(e.input),!r.cancelled&&this.isActive()&&e.input&&e.input.enabled&&this.emit(n,t,e,a))},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];n.input.draggable=e;var s=this._draggable.indexOf(n);e&&-1===s?this._draggable.push(n):!e&&s>-1&&this._draggable.splice(s,1)}return this},makePixelPerfect:function(t){void 0===t&&(t=1);var e=this.systems.textures;return r(e,t)},setHitArea:function(t,e,i){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var n=!1,r=!1,a=!1,o=!1,h=!1,l=!0;if(p(e)&&Object.keys(e).length){var u=e,d=t.some(function(t){return t.hasOwnProperty("faces")});if(!d){e=c(u,"hitArea",null),i=c(u,"hitAreaCallback",null),h=c(u,"pixelPerfect",!1);var f=c(u,"alphaTolerance",1);h&&(e={},i=this.makePixelPerfect(f))}n=c(u,"draggable",!1),r=c(u,"dropZone",!1),a=c(u,"cursor",!1),o=c(u,"useHandCursor",!1),e&&i||(this.setHitAreaFromTexture(t),l=!1)}else"function"!=typeof e||i||(i=e,e={});for(var g=0;g<t.length;g++){var v=t[g];if(h&&"Container"===v.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var m=v.input?v.input:s(v,e,i);m.customHitArea=l,m.dropZone=r,m.cursor=o?"pointer":a,v.input=m,n&&this.setDraggable(v),this.queueForInsertion(v)}}return this},setHitAreaCircle:function(i,n,s,r,a){void 0===a&&(a=e);var o=new t(n,s,r);return this.setHitArea(i,o,a)},setHitAreaEllipse:function(t,e,i,n,s,r){void 0===r&&(r=h);var a=new o(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=m),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i],r=n.frame,a=0,o=0;n.width?(a=n.width,o=n.height):r&&(a=r.realWidth,o=r.realHeight),"Container"!==n.type||0!==a&&0!==o?0!==a&&0!==o&&(n.input=s(n,new v(0,0,a,o),e),this.queueForInsertion(n)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,i,n,s,r){void 0===r&&(r=m);var a=new v(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaTriangle:function(t,e,i,n,s,r,a,o){void 0===o&&(o=w);var h=new x(e,i,n,s,r,a);return this.setHitArea(t,h,o)},enableDebug:function(t,e){void 0===e&&(e=65280);var i=t.input;if(!i||!i.hitArea)return this;var n=i.hitArea,s=n.type,r=i.hitAreaDebug,a=this.systems.add,o=this.systems.updateList;r&&(o.remove(r),r.destroy(),r=null);var h=0,l=0;switch(s){case d.CIRCLE:r=a.arc(0,0,n.radius),h=n.x-n.radius,l=n.y-n.radius;break;case d.ELLIPSE:r=a.ellipse(0,0,n.width,n.height),h=n.x-n.width/2,l=n.y-n.height/2;break;case d.LINE:r=a.line(0,0,n.x1,n.y1,n.x2,n.y2);break;case d.POLYGON:r=a.polygon(0,0,n.points);break;case d.RECTANGLE:r=a.rectangle(0,0,n.width,n.height),h=n.x,l=n.y;break;case d.TRIANGLE:r=a.triangle(0,0,n.x1,n.y1,n.x2,n.y2,n.x3,n.y3)}return r&&(r.isFilled=!1,r.strokeColor=e,r.preUpdate=function(){r.setVisible(t.visible),r.setStrokeStyle(1/t.scale,r.strokeColor),r.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var e=t.x,i=t.y,n=t.rotation,s=t.scaleX,a=t.scaleY;if(t.parentContainer){var o=t.getWorldTransformMatrix();e=o.tx,i=o.ty,n=o.rotation,s=o.scaleX,a=o.scaleY}r.setRotation(n),r.setScale(s,a),r.setPosition(e+h*s,i+l*a),r.setScrollFactor(t.scrollFactorX,t.scrollFactorY),r.setDepth(t.depth)},o.add(r),i.hitAreaDebug=r),this},removeDebug:function(t){var e=t.input;return e&&e.hitAreaDebug&&(e.hitAreaDebug.destroy(),e.hitAreaDebug=null),this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2||!e.camera)return t;var i=e.camera.renderList;return t.sort(function(t,e){var n=Math.max(i.indexOf(t),0);return Math.max(i.indexOf(e),0)-n})},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(t.parentContainer||e.parentContainer){if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var i=t.getIndexList(),n=e.getIndexList(),s=Math.min(i.length,n.length),r=0;r<s;r++){var a=i[r],o=n[r];if(a!==o)return o-a}return n.length-i.length}return this.displayList.getIndex(e)-this.displayList.getIndex(t)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(l.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var i=this.systems.events;i.off(y.TRANSITION_START,this.transitionIn,this),i.off(y.TRANSITION_OUT,this.transitionOut,this),i.off(y.TRANSITION_COMPLETE,this.transitionComplete,this),i.off(y.PRE_UPDATE,this.preUpdate,this),e.events.off(l.GAME_OUT,this.onGameOut,this),e.events.off(l.GAME_OVER,this.onGameOver,this),i.off(y.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var t=this.manager.pointers,e=0;e<t.length;e++)t[e].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(l.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(y.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});return g.register("InputPlugin",T,"input"),m3=T}function l6(){return D3?F3:(D3=1,F3={ANY_KEY_DOWN:w3?x3:(w3=1,x3="keydown"),ANY_KEY_UP:b3?T3:(b3=1,T3="keyup"),COMBO_MATCH:E3?S3:(E3=1,S3="keycombomatch"),DOWN:C3?_3:(C3=1,_3="down"),KEY_DOWN:P3?A3:(P3=1,A3="keydown-"),KEY_UP:R3?M3:(R3=1,M3="keyup-"),UP:O3?L3:(O3=1,L3="up")})}function u6(){if(k3)return I3;k3=1;var t=Vh(),e=qF(),i=l6(),n=new t({Extends:e,initialize:function(t,i){e.call(this),this.plugin=t,this.keyCode=i,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(i.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(i.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(i.UP,this,t))},reset:function(){return this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});return I3=n}function c6(){return N3?B3:(N3=1,B3=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)})}function d6(){if(z3)return U3;z3=1;var t=c6();return U3=function(e,i){if(i.matched)return!0;var n=!1,s=!1;if(e.keyCode===i.current)if(i.index>0&&i.maxKeyDelay>0){var r=i.timeLastMatched+i.maxKeyDelay;e.timeStamp<=r&&(s=!0,n=t(e,i))}else s=!0,n=t(e,i);return!s&&i.resetOnWrongKey&&(i.index=0,i.current=i.keyCodes[0]),n&&(i.timeLastMatched=e.timeStamp,i.matched=!0,i.timeMatched=e.timeStamp),n}}function f6(){return X3?Y3:(X3=1,Y3=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t})}function p6(){if(W3)return G3;W3=1;var t=Vh(),e=l6(),i=Wh(),n=d6(),s=f6(),r=new t({initialize:function(t,r,a){if(void 0===a&&(a={}),r.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var o=0;o<r.length;o++){var h=r[o];"string"==typeof h?this.keyCodes.push(h.toUpperCase().charCodeAt(0)):"number"==typeof h?this.keyCodes.push(h):h.hasOwnProperty("keyCode")&&this.keyCodes.push(h.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=i(a,"resetOnWrongKey",!0),this.maxKeyDelay=i(a,"maxKeyDelay",0),this.resetOnMatch=i(a,"resetOnMatch",!1),this.deleteOnMatch=i(a,"deleteOnMatch",!1);var l=this;this.onKeyDown=function(t){!l.matched&&l.enabled&&n(t,l)&&(l.manager.emit(e.COMBO_MATCH,l,t),l.resetOnMatch?s(l):l.deleteOnMatch&&l.destroy())},this.manager.on(e.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(e.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});return G3=r}function g6(){if(q3)return j3;q3=1;var t=Vh(),e=qF(),i=l6(),n=pI(),s=Ol(),r=qN(),a=a6(),o=u6(),h=KN(),l=p6(),u=function(){if(V3)return H3;V3=1;var t=KN(),e={};for(var i in t)e[t[i]]=i;return H3=e}(),c=Bu(),d=Sk(),f=new t({Extends:e,initialize:function(t){e.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,t.pluginEvents.once(r.BOOT,this.boot,this),t.pluginEvents.on(r.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=s(t,"keyboard",!0);var e=s(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(r.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(r.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(r.SHUTDOWN,this.shutdown,this),this.game.events.on(n.BLUR,this.resetKeys,this),this.scene.sys.events.on(c.PAUSE,this.resetKeys,this),this.scene.sys.events.on(c.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.canInput()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:h.UP,down:h.DOWN,left:h.LEFT,right:h.RIGHT,space:h.SPACE,shift:h.SHIFT})},addKeys:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n={};if("string"==typeof t){t=t.split(",");for(var s=0;s<t.length;s++){var r=t[s].trim();r&&(n[r]=this.addKey(r,e,i))}}else for(var a in t)n[a]=this.addKey(t[a],e,i);return n},addKey:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n=this.keys;if(t instanceof o){var s=n.indexOf(t);return s>-1?n[s]=t:n[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(i),t}return"string"==typeof t&&(t=h[t.toUpperCase()]),n[t]||(n[t]=new o(this,t),e&&this.addCapture(t),n[t].setEmitOnRepeat(i)),n[t]},removeKey:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n,s=this.keys;if(t instanceof o){var r=s.indexOf(t);r>-1&&(n=this.keys[r],this.keys[r]=void 0)}else"string"==typeof t&&(t=h[t.toUpperCase()]);return s[t]&&(n=s[t],s[t]=void 0),n&&(n.plugin=null,i&&this.removeCapture(n.keyCode),e&&n.destroy()),this},removeAllKeys:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var i=this.keys,n=0;n<i.length;n++){var s=i[n];s&&(i[n]=void 0,e&&this.removeCapture(s.keyCode),t&&s.destroy())}return this},createCombo:function(t,e){return new l(this,t,e)},checkDown:function(t,e){if(void 0===e&&(e=0),this.enabled&&t.isDown){var i=d(this.time-t.timeDown,e);if(i>t._tick)return t._tick=i,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,s=0;s<e;s++){var r=t[s],a=r.keyCode,o=n[a],h=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&(a===this.prevCode&&r.timeStamp===this.prevTime&&r.type===this.prevType||(this.prevCode=a,this.prevTime=r.timeStamp,this.prevType=r.type,"keydown"===r.type?(o&&(h=o.isDown,o.onDown(r)),r.cancelled||o&&h||(u[a]&&this.emit(i.KEY_DOWN+u[a],r),r.cancelled||this.emit(i.ANY_KEY_DOWN,r))):(o&&o.onUp(r),r.cancelled||(u[a]&&this.emit(i.KEY_UP+u[a],r),r.cancelled||this.emit(i.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0)))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(r.MANAGER_PROCESS,this.update,this),this.game.events.off(n.BLUR,this.resetKeys),this.scene.sys.events.off(c.PAUSE,this.resetKeys,this),this.scene.sys.events.off(c.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});return a.register("KeyboardPlugin",f,"keyboard","keyboard","inputKeyboard"),j3=f}function v6(){if(u5)return l5;u5=1;var t=jN(),e=nh(),i={CreatePixelPerfectHandler:t6(),CreateInteractiveObject:e6(),Events:qN(),Gamepad:v3?g3:(v3=1,g3={Axis:i6(),Button:s6(),Events:n6(),Gamepad:r6(),GamepadPlugin:o6(),Configs:p3?f3:(p3=1,f3={DUALSHOCK_4:h3?o3:(h3=1,o3={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}),SNES_USB:u3?l3:(u3=1,l3={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}),XBOX_360:d3?c3:(d3=1,c3={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3})})}),InputManager:tU(),InputPlugin:h6(),InputPluginCache:a6(),Keyboard:s5?n5:(s5=1,n5={Events:l6(),KeyboardManager:ZN(),KeyboardPlugin:g6(),Key:u6(),KeyCodes:KN(),KeyCombo:p6(),AdvanceKeyCombo:c6(),ProcessKeyCombo:d6(),ResetKeyCombo:f6(),JustDown:Z3?K3:(Z3=1,K3=function(t){return!!t._justDown&&(t._justDown=!1,!0)}),JustUp:$3?J3:($3=1,J3=function(t){return!!t._justUp&&(t._justUp=!1,!0)}),DownDuration:t5?Q3:(t5=1,Q3=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeDown;return t.isDown&&i<e}),UpDuration:i5?e5:(i5=1,e5=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeUp;return t.isUp&&i<e})}),Mouse:a5?r5:(a5=1,r5={MouseManager:JN()}),Pointer:$N(),Touch:h5?o5:(h5=1,o5={TouchManager:QN()})};return i=e(!1,i,t),l5=i}function m6(){return d5?c5:(d5=1,c5={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20})}function y6(){return p5?f5:(p5=1,f5=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)})}function x6(){return v5?g5:(v5=1,g5=function(t,e,i,n,s,r){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===i&&(i=""),void 0===n&&(n=""),void 0===s&&(s=0),void 0===r&&(r=!1),{responseType:t,async:e,user:i,password:n,timeout:s,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:r}})}function w6(){if(y5)return m5;y5=1;var t=nh(),e=x6();return m5=function(i,n){var s=void 0===i?e():t({},i);if(n)for(var r in n)void 0!==n[r]&&(s[r]=n[r]);return s}}function T6(){if(w5)return x5;w5=1;var t=w6();return x5=function(e,i){var n=t(i,e.xhrSettings);if(e.base64){var s,r=e.url.split(";base64,").pop()||e.url.split(",").pop();return s="arraybuffer"===e.xhrSettings.responseType?{response:Uint8Array.from(atob(r),function(t){return t.charCodeAt(0)}).buffer}:{responseText:atob(r)},void e.onBase64Load(s)}var a=new XMLHttpRequest;if(a.open("GET",e.src,n.async,n.user,n.password),a.responseType=e.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var o in n.headers)a.setRequestHeader(o,n.headers[o]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=e.onLoad.bind(e,a),a.onerror=e.onError.bind(e,a),a.onprogress=e.onProgress.bind(e),a.ontimeout=e.onError.bind(e,a),a.send(),a}}function b6(){if(b5)return T5;b5=1;var t=Vh(),e=m6(),i=oU(),n=Wh(),s=y6(),r=w6(),a=T6(),o=x6(),h=new t({initialize:function(t,i){if(this.loader=t,this.cache=n(i,"cache",!1),this.type=n(i,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=n(i,"key",!1);var s=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+s),!this.key)throw new Error("Invalid File key: "+this.key);var a=n(i,"url");void 0===a?a=t.path+s+"."+n(i,"extension",""):"string"!=typeof a||a.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)||(a=t.path+a),this.url=a,this.src="",this.xhrSettings=o(n(i,"responseType",void 0)),n(i,"xhrSettings",!1)&&(this.xhrSettings=r(this.xhrSettings,n(i,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?e.FILE_POPULATED:e.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=n(i,"config",{}),this.multiFile,this.linkFile,this.base64="string"==typeof a&&0===a.indexOf("data:"),this.retryAttempts=n(i,"maxRetries",t.maxRetries)},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===e.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=e.FILE_LOADING,this.src=s(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);0===this.src.indexOf("data:")&&(this.base64=!0),this.xhrLoader=a(this,this.loader.xhr)}},onLoad:function(t,i){var n=t.responseURL&&this.loader.localSchemes.some(function(e){return 0===t.responseURL.indexOf(e)})&&0===i.target.status,s=!(i.target&&200!==i.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(s=!1),this.state=e.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,s)},onBase64Load:function(t){this.xhrLoader=t,this.state=e.FILE_LOADED,this.percentComplete=1,this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=e.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=e.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){console.error('Failed to process file: %s "%s"',this.type,this.key),this.state=e.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(t){if(this.state!==e.FILE_PENDING_DESTROY){void 0===t&&(t=this.data);var n=this.key,s=this.type;this.loader.emit(i.FILE_COMPLETE,n,s,t),this.loader.emit(i.FILE_KEY_COMPLETE+s+"-"+n,n,s,t),this.loader.flagForRemoval(this),this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});return h.createObjectURL=function(t,e,i){if("function"==typeof URL)t.src=URL.createObjectURL(e);else{var n=new FileReader;n.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||i)+";base64,"+n.result.split(",")[1]},n.onerror=t.onerror,n.readAsDataURL(e)}},h.revokeObjectURL=function(t){"function"==typeof URL&&URL.revokeObjectURL(t.src)},T5=h}function S6(){if(E5)return S5;E5=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=Ol(),a=ih(),o=new t({Extends:i,initialize:function(t,n,o,h,l){var u="json";if(a(n)){var c=n;n=s(c,"key"),o=s(c,"url"),h=s(c,"xhrSettings"),u=s(c,"extension",u),l=s(c,"dataKey",l)}var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:n,url:o,xhrSettings:h,config:l};i.call(this,t,d),a(o)&&(this.data=l?r(o,l):o,this.state=e.FILE_POPULATED)},onProcess:function(){if(this.state!==e.FILE_POPULATED){this.state=e.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw this.onProcessError(),t}var i=this.config;this.data="string"==typeof i?r(t,i,t):t}this.onProcessComplete()}});return n.register("json",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,n,i));return this}),S5=o}function E6(){if(C5)return _5;C5=1;var t=Vh(),e=eU(),i=S6(),n=oU(),s=new t({Extends:i,initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.type="animationJSON"},onProcess:function(){this.loader.once(n.POST_PROCESS,this.onLoadComplete,this),i.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});return e.register("animation",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),_5=s}function _6(){if(P5)return A5;P5=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=y6(),o=new t({Extends:i,initialize:function t(e,n,a,o,h){var l,u="png";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"normalMap"),o=s(c,"xhrSettings"),u=s(c,"extension",u),h=s(c,"frameConfig")}Array.isArray(a)&&(l=a[1],a=a[0]);var d={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:a,xhrSettings:o,config:h};if(i.call(this,e,d),l){var f=new t(e,this.key,l,o,h);f.type="normalMap",this.setLink(f),e.addFile(f)}this.useImageElementLoad="HTMLImageElement"===e.imageLoadType||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){i.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(t.data),t.onProcessError()},i.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var t=this.state;this.state=e.FILE_PROCESSING,t===e.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=e.FILE_LOADING,this.src=a(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){t.state=e.FILE_LOADED,t.loader.nextFile(t,!0)},this.data.onerror=function(){t.loader.nextFile(t,!1)},this.data.src=this.src},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("spritesheet"===t.type?t.addToCache():"normalMap"===this.type?this.cache.addImage(this.key,t.data,this.data):this.cache.addImage(this.key,this.data,t.data)):this.cache.addImage(this.key,this.data)}});return n.register("image",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),A5=o}function C6(){if(R5)return M5;R5=1;var t=Vh(),e=m6(),i=oU(),n=new t({initialize:function(t,i,n,s){var r=[];s.forEach(function(t){t&&r.push(t)}),this.loader=t,this.type=i,this.key=n;var a=this.key;t.prefix&&""!==t.prefix&&(this.key=t.prefix+a),this.multiKeyIndex=t.multiKeyIndex++,this.files=r,this.state=e.FILE_PENDING,this.complete=!1,this.pending=r.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var o=0;o<r.length;o++)r[o].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&(this.failed++,console.error('File failed: %s "%s" (via %s "%s")',this.type,this.key,t.type,t.key))},pendingDestroy:function(){if(this.state!==e.FILE_PENDING_DESTROY){var t=this.key,n=this.type;this.loader.emit(i.FILE_COMPLETE,t,n),this.loader.emit(i.FILE_KEY_COMPLETE+n+"-"+t,t,n),this.loader.flagForRemoval(this);for(var s=0;s<this.files.length;s++)this.files[s].pendingDestroy();this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});return M5=n}function A6(){if(O5)return L5;O5=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=S6(),a=C6(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),e.addToCache(),this.complete=!0}}});return e.register("aseprite",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),L5=o}function P6(){if(D5)return F5;D5=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=S6(),a=C6(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),F5=o}function M6(){if(k5)return I5;k5=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=GN(),o=new t({Extends:i,initialize:function(t,e,n,a){var o="xml";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"xml",cache:t.cacheManager.xml,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=a(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});return n.register("xml",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),I5=o}function R6(){if(N5)return B5;N5=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=C6(),a=M6(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","xml"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"atlasxml",e,[c,d,c.linkFile]):r.call(this,t,"atlasxml",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlasXML",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),B5=o}function L6(){if(z5)return U5;z5=1;var t=Vh(),e=oU(),i=b6(),n=Wh(),s=y6(),r=ih(),a=new t({Extends:i,initialize:function(t,e,s,a){if(r(e)){var o=e;e=n(o,"key"),a=n(o,"config",a)}var h={type:"audio",cache:t.cacheManager.audio,extension:s.type,key:e,url:s.url,config:a};i.call(this,t,h),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var i=t.target;i.oncanplaythrough=null,i.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(e.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var i=new Audio;i.dataset||(i.dataset={}),i.dataset.name=this.key+("0"+e).slice(-2),i.dataset.used="false",this.locked?i.dataset.locked="true":(i.dataset.locked="false",i.preload="auto",i.oncanplaythrough=this.onProgress.bind(this),i.onerror=this.onError.bind(this)),this.data.push(i)}for(e=0;e<this.data.length;e++)(i=this.data[e]).src=s(this,this.loader.baseURL),this.locked||i.load();this.locked&&setTimeout(this.onLoad.bind(this))}});return U5=a}function O6(){if(X5)return Y5;X5=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=L6(),a=ih(),o=new t({Extends:i,initialize:function(t,e,n,r,o){if(a(e)){var h=e;e=s(h,"key"),r=s(h,"xhrSettings"),o=s(h,"context",o)}var l={type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:r,config:{context:o}};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(e){t.data=e,t.onProcessComplete()},function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()}),this.config.context=null}});return o.create=function(t,e,i,n,h){var l=t.systems.game,u=l.config.audio,c=l.device.audio;a(e)&&(i=s(e,"url",[]),n=s(e,"config",{}));var d=o.getAudioURL(l,i);return d?c.webAudio&&!u.disableWebAudio?new o(t,e,d,h,l.sound.context):new r(t,e,d,n):(console.warn('No audio URLs for "%s" can play on this device',e),null)},o.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var n=s(e[i],"url",e[i]);if(0===n.indexOf("blob:")||0===n.indexOf("data:"))return{url:n,type:""};var r=n.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=s(e[i],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:n,type:r}}return null},n.register("audio",function(t,e,i,n){var s,r=this.systems.game,a=r.config.audio,h=r.device.audio;if(a.noAudio||!h.webAudio&&!h.audioData)return this;if(Array.isArray(t))for(var l=0;l<t.length;l++)(s=o.create(this,t[l]))&&this.addFile(s);else(s=o.create(this,t,e,i,n))&&this.addFile(s);return this}),Y5=o}var F6,D6,I6,k6,B6,N6,U6,z6,Y6,X6,G6,W6,H6,V6,j6,q6,K6,Z6,J6,$6,Q6,t8,e8,i8,n8,s8,r8,a8,o8,h8,l8,u8,c8,d8,f8,p8,g8,v8,m8,y8,x8,w8,T8,b8,S8,E8,_8,C8,A8,P8,M8,R8,L8,O8,F8,D8,I8,k8,B8,N8,U8,z8,Y8,X8,G8,W8,H8,V8,j8,q8,K8,Z8,J8,$8,Q8,t7,e7,i7,n7,s7,r7,a7,o7,h7,l7,u7,c7,d7,f7,p7,g7,v7,m7,y7,x7,w7,T7,b7,S7,E7,_7,C7,A7,P7,M7,R7,L7,O7,F7,D7,I7,k7,B7,N7,U7,z7,Y7,X7,G7,W7,H7,V7,j7,q7,K7,Z7,J7,$7,Q7,t9,e9,i9,n9,s9,r9,a9,o9,h9,l9,u9,c9,d9,f9,p9,g9,v9,m9,y9,x9,w9,T9,b9,S9,E9,_9,C9,A9,P9,M9,R9,L9,O9,F9,D9,I9,k9,B9,N9,U9,z9,Y9,X9,G9,W9,H9,V9,j9,q9,K9,Z9,J9,$9={};function Q9(){if(F6)return $9;F6=1;var t=O6(),e=Vh(),i=eU(),n=Wh(),s=ih(),r=S6(),a=C6(),o=new e({Extends:a,initialize:function(e,i,o,h,l,u,c){if(s(i)){var d=i;i=n(d,"key"),o=n(d,"jsonURL"),h=n(d,"audioURL"),l=n(d,"audioConfig"),u=n(d,"audioXhrSettings"),c=n(d,"jsonXhrSettings")}var f;if(h){var p=t.create(e,i,h,l,u);p&&(f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[p,f]),this.config.resourceLoad=!1)}else f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[f]),this.config.resourceLoad=!0,this.config.audioConfig=l,this.config.audioXhrSettings=u},onFileComplete:function(e){if(-1!==this.files.indexOf(e)&&(this.pending--,this.config.resourceLoad&&"json"===e.type&&e.data.hasOwnProperty("resources"))){var i=e.data.resources,s=n(this.config,"audioConfig"),r=n(this.config,"audioXhrSettings"),a=t.create(this.loader,e.key,i,s,r);a&&(this.addToMultiFile(a),this.loader.addFile(a))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.complete=!0}}});return i.register("audioSprite",function(t,e,i,n,s,r){var a,h=this.systems.game,l=h.config.audio,u=h.device.audio;if(l&&l.noAudio||!u.webAudio&&!u.audioData)return this;if(Array.isArray(t))for(var c=0;c<t.length;c++)(a=new o(this,t[c])).files&&this.addFile(a.files);else(a=new o(this,t,e,i,n,s,r)).files&&this.addFile(a.files);return this}),$9}function ttt(){if(I6)return D6;I6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="bin";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"xhrSettings"),h=s(l,"extension",h),o=s(l,"dataType",o)}var u={type:"binary",cache:t.cacheManager.binary,extension:h,responseType:"arraybuffer",key:e,url:n,xhrSettings:a,config:{dataType:o}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});return n.register("binary",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,n,i));return this}),D6=a}function ett(){if(B6)return k6;B6=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=C6(),a=zU(),o=M6(),h=new t({Extends:r,initialize:function(t,e,a,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new o(t,{key:e,url:i(f,"fontDataURL"),extension:i(f,"fontDataExtension","xml"),xhrSettings:i(f,"fontDataXhrSettings")})}else c=new n(t,e,a,l),d=new o(t,e,h,u);c.linkFile?r.call(this,t,"bitmapfont",e,[c,d,c.linkFile]):r.call(this,t,"bitmapfont",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache();var i=t.cache.get(t.key),n=a(e.data,t.cache.getFrame(t.key),0,0,i);this.loader.cacheManager.bitmapFont.add(t.key,{data:n,texture:t.key,frame:null}),this.complete=!0}}});return e.register("bitmapFont",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),k6=h}function itt(){if(U6)return N6;U6=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=S6(),a=C6(),o=new t({Extends:a,initialize:function(t,e,n,o,h,l,u){if(s(e)){var c=e;e=i(c,"key"),n=i(c,"url",!1)?i(c,"url"):i(c,"atlasURL"),l=i(c,"xhrSettings"),o=i(c,"path"),h=i(c,"baseURL"),u=i(c,"textureXhrSettings")}var d=new r(t,e,n,l);a.call(this,t,"multiatlas",e,[d]),this.config.path=o,this.config.baseURL=h,this.config.textureXhrSettings=u},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,s=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=i(s,"baseURL",this.baseURL),u=i(s,"path",this.path),c=i(s,"prefix",this.prefix),d=i(s,"textureXhrSettings");r.setBaseURL(l),r.setPath(u),r.setPrefix(c);for(var f=0;f<e.length;f++){var p=e[f].image,g="MA"+this.multiKeyIndex+"_"+p,v=new n(r,g,p,d);if(this.addToMultiFile(v),r.addFile(v),e[f].normalMap){var m=new n(r,g,e[f].normalMap,d);m.type="normalMap",v.setLink(m),this.addToMultiFile(m),r.addFile(m)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],i=[],n=[],s=1;s<this.files.length;s++){var r=this.files[s];if("normalMap"!==r.type)for(var a=r.key.indexOf("_"),o=r.key.substr(a+1),h=r.data,l=0;l<t.data.textures.length;l++){var u=t.data.textures[l];if(u.image===o){i.push(h),e.push(u),r.linkFile&&n.push(r.linkFile.data);break}}}0===n.length&&(n=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,i,e,n),this.complete=!0}}});return e.register("multiatlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),N6=o}function ntt(){if(G6)return X6;G6=1;var t=P6(),e=ttt(),i=Vh(),n=eU(),s=Wh(),r=_6(),a=ih(),o=S6(),h=SU(),l=cU(),u=itt(),c=C6(),d=EU(),f=function(){if(Y6)return z6;Y6=1;var t=Tk();function e(t){for(var e=t.mipmaps,i=0;i<e.length;i++){var n=e[i].width,s=e[i].height;if((n<<i)%4!=0||(s<<i)%4!=0)return console.warn("BPTC, RGTC, and S3TC dimensions must be a multiple of 4 pixels, and each successive mip level must be half the size of the previous level, rounded down. Mip level "+i+" is "+n+"x"+s),!1}return!0}function i(){return!0}function n(e){var i=e.mipmaps[0];return!!t(i.width,i.height)||(console.warn("PVRTC base dimensions must be power of two. Base level is "+i.width+"x"+i.height),!1)}function s(t){var e=t.mipmaps[0];return e.width%4==0&&e.height%4==0||(console.warn("S3TC SRGB base dimensions must be a multiple of 4 pixels. Base level is "+e.width+"x"+e.height+" pixels"),!1)}var r={37488:i,37489:i,37490:i,37491:i,37492:i,37493:i,37494:i,37495:i,37496:i,37497:i,36196:i,37808:i,37809:i,37810:i,37811:i,37812:i,37813:i,37814:i,37815:i,37816:i,37817:i,37818:i,37819:i,37820:i,37821:i,37840:i,37841:i,37842:i,37843:i,37844:i,37845:i,37846:i,37847:i,37848:i,37849:i,37850:i,37851:i,37852:i,37853:i,36492:e,36493:e,36494:e,36495:e,36283:e,36284:e,36285:e,36286:e,35840:n,35841:n,35842:n,35843:n,33776:e,33777:e,33778:e,33779:e,35916:s,35917:s,35918:s,35919:s};return z6=function(e){for(var i=e.mipmaps,n=1;n<i.length;n++){var s=i[n].width,a=i[n].height;if(!t(s,a))return console.warn("Mip level "+n+" is not a power-of-two size: "+s+"x"+a),!1}var o=r[e.internalFormat];return o?o(e):(console.warn("No format checker found for internal format "+e.internalFormat+". Assuming valid."),!0)},z6}(),p=new i({Extends:c,initialize:function(t,i,n,s){if(n.multiAtlasURL){var r=new o(t,{key:i,url:n.multiAtlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[r])}else{var a=n.textureURL.substr(n.textureURL.length-3);n.type||(n.type="ktx"===a.toLowerCase()?"KTX":"PVR");var h=new e(t,{key:i,url:n.textureURL,extension:a,xhrSettings:s,config:n});if(n.atlasURL){var l=new o(t,{key:i,url:n.atlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[h,l])}else c.call(this,t,"texture",i,[h])}this.config=n},onFileComplete:function(t){if(-1!==this.files.indexOf(t)){if(this.pending--,!this.config.multiAtlasURL)return;if("json"===t.type&&t.data.hasOwnProperty("textures")){var i=t.data.textures,n=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=s(n,"multiBaseURL",this.baseURL),u=s(n,"multiPath",this.path),c=s(n,"prefix",this.prefix),d=s(n,"textureXhrSettings");l&&r.setBaseURL(l),u&&r.setPath(u),c&&r.setPrefix(c);for(var f=0;f<i.length;f++){var p=i[f].image,g="CMA"+this.multiKeyIndex+"_"+p,v=new e(r,g,p,d);if(this.addToMultiFile(v),r.addFile(v),i[f].normalMap){var m=new e(r,g,i[f].normalMap,d);m.type="normalMap",v.setLink(m),this.addToMultiFile(m),r.addFile(m)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}}},addToCache:function(){function t(t){console.warn('Compressed Texture Invalid: "'+r.key+'". '+t)}if(this.isReadyToProcess()){var e=this.config;if(e.multiAtlasURL)this.addMultiToCache();else{var i,n=this.loader.systems.renderer,s=this.loader.textureManager,r=this.files[0],a=this.files[1];if("PVR"===e.type?i=d(r.data):"KTX"===e.type&&((i=h(r.data))||t("KTX file contains unsupported format.")),i&&!f(i)&&(t("Texture dimensions failed verification. Check the texture format specifications for "+e.format+" 0x"+i.internalFormat.toString(16)+"."),i=null),i&&!n.supportsCompressedTexture(e.format,i.internalFormat)&&(t("Texture format "+e.format+" with internal format "+i.internalFormat+" not supported by the GPU. Texture invalid. This is often due to the texture using sRGB instead of linear RGB."),i=null),i){i.format=n.getCompressedTextureName(e.format,i.internalFormat);var o=a&&a.data?a.data:null;s.addCompressedTexture(r.key,i,o)}}this.complete=!0}},addMultiToCache:function(){for(var t,e=this.config,i=this.files[0],n=[],s=[],r=[],a=this.loader.systems.renderer,o=this.loader.textureManager,l=1;l<this.files.length;l++){var u=this.files[l];if("normalMap"!==u.type)for(var c=u.key.indexOf("_"),f=u.key.substr(c+1),p=u.data,g=0;g<i.data.textures.length;g++){var v=i.data.textures[g];if(v.image===f){"PVR"===e.type?t=d(p):"KTX"===e.type&&(t=h(p)),t&&a.supportsCompressedTexture(e.format,t.internalFormat)&&(t.format=a.getCompressedTextureName(e.format,t.internalFormat),s.push(t),n.push(v),u.linkFile&&r.push(u.linkFile.data));break}}}0===r.length&&(r=void 0),o.addAtlasJSONArray(this.key,s,n,r),this.complete=!0}});return n.register("texture",function(e,i,n){var o=this.systems.renderer,h=function(e,i,n,h){var c={format:null,type:null,textureURL:void 0,atlasURL:void 0,multiAtlasURL:void 0,multiPath:void 0,multiBaseURL:void 0};if(a(i)){var d=i;i=s(d,"key"),n=s(d,"url"),h=s(d,"xhrSettings")}var f=!1;for(var g in n)if(o.supportsCompressedTexture(g)){var v=n[g];"string"==typeof v?c.textureURL=v:c=l(v,c),c.format=g.toUpperCase(),f=!0;break}if(f)if("IMG"===c.format){var m;m=c.multiAtlasURL?new u(e,i,c.multiAtlasURL,c.multiPath,c.multiBaseURL,h).files:c.atlasURL?new t(e,i,c.textureURL,c.atlasURL,h).files:new r(e,i,c.textureURL,h),e.addFile(m)}else{var y=new p(e,i,c,h);e.addFile(y.files)}else console.warn("No supported compressed texture format or IMG fallback",i)};if(Array.isArray(e))for(var c=0;c<e.length;c++)h(this,e[c]);else h(this,e,i,n);return this}),X6=p}function stt(){if(H6)return W6;H6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="css";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"script",cache:!1,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("css",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),W6=a}function rtt(){if(j6)return V6;j6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=y6(),a=ih(),o=new t({Extends:i,initialize:function(t,n,r,o,h,l){var u="ttf";if(a(n)){var c=n;n=s(c,"key"),r=s(c,"url"),o=s(c,"format","truetype"),h=s(c,"descriptors",null),l=s(c,"xhrSettings"),u=s(c,"extension",u)}else void 0===o&&(o="truetype");var d={type:"font",cache:!1,extension:u,responseType:"text",key:n,url:r,xhrSettings:l};i.call(this,t,d),this.data={format:o,descriptors:h},this.state=e.FILE_POPULATED},onProcess:function(){var t;this.state=e.FILE_PROCESSING,this.src=r(this,this.loader.baseURL);var i=this.key,n="url("+this.src+') format("'+this.data.format+'")';t=this.data.descriptors?new FontFace(i,n,this.data.descriptors):new FontFace(i,n);var s=this;t.load().then(function(){document.fonts.add(t),document.body.classList.add("fonts-loaded"),s.onProcessComplete()}).catch(function(){console.warn("Font failed to load",n),s.onProcessComplete()})}});return n.register("font",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new o(this,t[r]));else this.addFile(new o(this,t,e,i,n,s));return this}),V6=o}function att(){if(K6)return q6;K6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=AN(),o=new t({Extends:i,initialize:function(t,e,n,a,o){var h="glsl";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"shaderType","fragment"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="fragment");var u={type:"glsl",cache:t.cacheManager.shader,extension:h,responseType:"text",key:e,url:n,config:{shaderType:a},xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var i=this.getShaderName(e.header),n=this.getShaderType(e.header),s=this.getShaderUniforms(e.header),r=e.shader;if(this.cache.has(i)){var o=this.cache.get(i);"fragment"===n?o.fragmentSrc=r:o.vertexSrc=r,o.uniforms||(o.uniforms=s)}else"fragment"===n?this.cache.add(i,new a(i,r,"",s)):this.cache.add(i,new a(i,"",r,s));e=this.extractBlock(t,e.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new a(this.key,this.data)):this.cache.add(this.key,new a(this.key,"",this.data))},getShaderName:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("name:"===i.substring(0,5))return i.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("type:"===i.substring(0,5))return i.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},i=0;i<t.length;i++){var n=t[i].trim();if("uniform."===n.substring(0,8)){var s=n.indexOf(":");if(s){var r=n.substring(8,s);try{e[r]=JSON.parse(n.substring(s+1))}catch(t){console.warn("Invalid uniform JSON: "+r)}}}}return e},extractBlock:function(t,e){for(var i=-1,n=-1,s=-1,r=!1,a=!1,o=[],h=[],l=e;l<t.length;l++){var u=t[l].trim();if("---"===u)if(-1===i)i=l,r=!0;else{if(!r){a=!1;break}n=l,r=!1,a=!0}else r?o.push(u):a&&(h.push(u),s=l)}return r||-1===n?null:{header:o,shader:h.join("\n"),offset:s}}});return n.register("glsl",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,i,n));return this}),q6=o}function ott(){if(J6)return Z6;J6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="html";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",cache:t.cacheManager.html,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("html",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),Z6=a}function htt(){if(Q6)return $6;Q6=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o,h){void 0===a&&(a=512),void 0===o&&(o=512);var l="html";if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),h=s(u,"xhrSettings"),l=s(u,"extension",l),a=s(u,"width",a),o=s(u,"height",o)}var c={type:"html",cache:t.textureManager,extension:l,responseType:"text",key:e,url:n,xhrSettings:h,config:{width:a,height:o}};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.width,n=this.config.height,s=[];s.push('<svg width="'+t+'px" height="'+n+'px" viewBox="0 0 '+t+" "+n+'" xmlns="http://www.w3.org/2000/svg">'),s.push('<foreignObject width="100%" height="100%">'),s.push('<body xmlns="http://www.w3.org/1999/xhtml">'),s.push(this.xhrLoader.responseText),s.push("</body>"),s.push("</foreignObject>"),s.push("</svg>");var r=[s.join("\n")],a=this;try{var o=new window.Blob(r,{type:"image/svg+xml;charset=utf-8"})}catch(t){return a.state=e.FILE_ERRORED,void a.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){i.revokeObjectURL(a.data),a.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(a.data),a.onProcessError()},i.createObjectURL(this.data,o,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("htmlTexture",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),$6=a}function ltt(){if(e8)return t8;e8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="js";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"type","script"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="script");var u={type:a,cache:!1,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("script",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),t8=a}function utt(){if(n8)return i8;n8=1;var t=Vh(),e=eU(),i=Wh(),n=ih(),s=C6(),r=ltt(),a=new t({Extends:s,initialize:function(t,e,a,o){var h="js",l=[];if(n(e)){var u=e;e=i(u,"key"),a=i(u,"url"),o=i(u,"xhrSettings"),h=i(u,"extension",h)}Array.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=new r(t,{key:e+"_"+c.toString(),url:a[c],extension:h,xhrSettings:o});d.onProcess=function(){this.onProcessComplete()},l.push(d)}s.call(this,t,"scripts",e,l)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});return e.register("scripts",function(t,e,i){var n;if(Array.isArray(t))for(var s=0;s<t.length;s++)n=new a(this,t[s]),this.addFile(n.files);else n=new a(this,t,e,i),this.addFile(n.files);return this}),i8=a}function ctt(){if(r8)return s8;r8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="text",h="txt",l=t.cacheManager.text;if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),a=s(u,"xhrSettings"),h=s(u,"extension",h),o=s(u,"type",o),l=s(u,"cache",l)}var c={type:o,cache:l,extension:h,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("text",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),s8=a}function dtt(){if(o8)return a8;o8=1;var t=Vh(),e=eU(),i=Wh(),n=ih(),s=C6(),r=B4(),a=N4(),o=ctt(),h=new t({Extends:s,initialize:function(t,e,r,a,h,l){var u,c,d=t.cacheManager.obj;if(n(e)){var f=e;e=i(f,"key"),u=new o(t,{key:e,type:"obj",cache:d,url:i(f,"url"),extension:i(f,"extension","obj"),xhrSettings:i(f,"xhrSettings"),config:{flipUV:i(f,"flipUV",h)}}),(a=i(f,"matURL"))&&(c=new o(t,{key:e,type:"mat",cache:d,url:a,extension:i(f,"matExtension","mat"),xhrSettings:i(f,"xhrSettings")}))}else u=new o(t,{key:e,url:r,type:"obj",cache:d,extension:"obj",xhrSettings:l,config:{flipUV:h}}),a&&(c=new o(t,{key:e,url:a,type:"mat",cache:d,extension:"mat",xhrSettings:l}));s.call(this,t,"obj",e,[u,c])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=r(t.data,t.config.flipUV);e&&(i.materials=a(e.data)),t.cache.add(t.key,i),this.complete=!0}}});return e.register("obj",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),a8=h}function ftt(){if(l8)return h8;l8=1;var t=Vh(),e=m6(),i=eU(),n=S6(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,s,r),this.type="packfile"},onProcess:function(){if(this.state!==e.FILE_POPULATED&&(this.state=e.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.data.hasOwnProperty("files")&&this.config){var t={};t[this.config]=this.data,this.data=t}this.loader.addPack(this.data,this.config),this.onProcessComplete()}});return i.register("pack",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),h8=s}function ptt(){if(c8)return u8;c8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"start"),h=s(c,"mapping")}var d={type:"plugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{start:o,mapping:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=s(i,"start",!1),r=s(i,"mapping",null);if(this.state===e.FILE_POPULATED)t.install(this.key,this.data,n,r);else{this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var a=t.install(this.key,window[this.key],n,r);(n||r)&&(this.loader.systems[r]=a,this.loader.scene[r]=a)}this.onProcessComplete()}});return n.register("plugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),u8=a}function gtt(){if(f8)return d8;f8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="js";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),e=eval;this.loader.sceneManager.add(this.key,e(t)),this.complete=!0}});return n.register("sceneFile",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),d8=a}function vtt(){if(g8)return p8;g8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"systemKey"),h=s(c,"sceneKey")}var d={type:"scenePlugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{systemKey:o,sceneKey:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=this.key,r=s(i,"systemKey",n),a=s(i,"sceneKey",n);this.state===e.FILE_POPULATED?t.installScenePlugin(r,this.data,a,this.loader.scene,!0):(this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(r,window[this.key],a,this.loader.scene,!0)),this.onProcessComplete()}});return n.register("scenePlugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),p8=a}function mtt(){if(m8)return v8;m8=1;var t=Vh(),e=m6(),i=eU(),n=_6(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,r,s),this.type="spritesheet"},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("normalMap"===this.type?this.cache.addSpriteSheet(this.key,t.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,t.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});return i.register("spritesheet",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,i,n));return this}),v8=s}function ytt(){if(x8)return y8;x8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="svg";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"svgConfig",{}),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"svg",cache:t.textureManager,extension:h,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:s(a,"width"),height:s(a,"height"),scale:s(a,"scale")}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.xhrLoader.responseText,n=[t],s=this.config.width,r=this.config.height,a=this.config.scale;t:if(s&&r||a){var o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],h=o.hasAttribute("viewBox"),l=parseFloat(o.getAttribute("width")),u=parseFloat(o.getAttribute("height"));if(!h&&l&&u)o.setAttribute("viewBox","0  0 "+l+" "+u);else if(h&&!l&&!u){var c=o.getAttribute("viewBox").split(/\s+|,/);l=c[2],u=c[3]}if(a){if(!l||!u)break t;s=l*a,r=u*a}o.setAttribute("width",s.toString()+"px"),o.setAttribute("height",r.toString()+"px"),n=[(new XMLSerializer).serializeToString(o)]}try{var d=new window.Blob(n,{type:"image/svg+xml;charset=utf-8"})}catch(t){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var f=this,p=!1;this.data.onload=function(){p||i.revokeObjectURL(f.data),f.onProcessComplete()},this.data.onerror=function(){p?f.onProcessError():(p=!0,i.revokeObjectURL(f.data),f.data.src="data:image/svg+xml,"+encodeURIComponent(n.join("")))},i.createObjectURL(this.data,d,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("svg",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),y8=a}function xtt(){return T8?w8:(T8=1,w8={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3})}function wtt(){if(S8)return b8;S8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=Wh(),r=ih(),a=xtt(),o=new t({Extends:i,initialize:function(t,e,n,o){var h="csv";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u),this.tilemapFormat=a.CSV},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t)}});return n.register("tilemapCSV",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),b8=o}function Ttt(){if(_8)return E8;_8=1;var t=Vh(),e=eU(),i=S6(),n=xtt(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.WELTMEISTER,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapImpact",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),E8=s}function btt(){if(A8)return C8;A8=1;var t=Vh(),e=eU(),i=S6(),n=xtt(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.TILED_JSON,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapTiledJSON",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),C8=s}function Stt(){if(M8)return P8;M8=1;var t=Vh(),e=eU(),i=Wh(),n=_6(),s=ih(),r=C6(),a=ctt(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","txt"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"unityatlas",e,[c,d,c.linkFile]):r.call(this,t,"unityatlas",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("unityAtlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),P8=o}function Ett(){if(L8)return R8;L8=1;var t=Vh(),e=m6(),i=b6(),n=eU(),s=y6(),r=Wh(),a=ih(),o=new t({Extends:i,initialize:function(t,e,n,s){if(void 0===s&&(s=!1),a(e)){var o=e;e=r(o,"key"),n=r(o,"url",[]),s=r(o,"noAudio",!1)}var h=t.systems.game.device.video.getVideoURL(n);h||console.warn("VideoFile: No supported format for "+e);var l={type:"video",cache:t.cacheManager.video,extension:h.type,key:e,url:h.url,config:{noAudio:s}};i.call(this,t,l)},onProcess:function(){this.data={url:this.src,noAudio:this.config.noAudio,crossOrigin:this.crossOrigin},this.onProcessComplete()},load:function(){this.src=s(this,this.loader.baseURL),this.state=e.FILE_LOADED,this.loader.nextFile(this,!0)}});return n.register("video",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),R8=o}function _tt(){if(I8)return D8;I8=1;var t=Vh(),e=m6(),i=lV(),n=qF(),s=oU(),r=eU(),a=Wh(),o=Ol(),h=ih(),l=ku(),u=Bu(),c=x6(),d=new t({Extends:n,initialize:function(t){n.call(this);var s=t.sys.game.config,o=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,r.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(a(o,"baseURL",s.loaderBaseURL)),this.setPath(a(o,"path",s.loaderPath)),this.setPrefix(a(o,"prefix",s.loaderPrefix)),this.maxParallelDownloads=a(o,"maxParallelDownloads",s.loaderMaxParallelDownloads),this.xhr=c(a(o,"responseType",s.loaderResponseType),a(o,"async",s.loaderAsync),a(o,"user",s.loaderUser),a(o,"password",s.loaderPassword),a(o,"timeout",s.loaderTimeout),a(o,"withCredentials",s.loaderWithCredentials)),this.crossOrigin=a(o,"crossOrigin",s.loaderCrossOrigin),this.imageLoadType=a(o,"imageLoadType",s.loaderImageLoadType),this.localSchemes=a(o,"localScheme",s.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new i,this.inflight=new i,this.queue=new i,this._deleteQueue=new i,this.totalFailed=0,this.totalComplete=0,this.state=e.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=a(o,"maxRetries",s.loaderMaxRetries),t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.pluginStart,this)},boot:function(){this.systems.events.once(u.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(u.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];this.keyExists(i)||(this.list.set(i),this.emit(s.ADD,i.key,i.type,this,i),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),!e&&this.isLoading()&&(this.inflight.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),this.queue.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1})),e},addPack:function(t,e){if("string"==typeof e){var i=o(t,e);i&&(t={packKey:i})}var n=0,s=this.baseURL,r=this.path,h=this.prefix;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=t[l],c=a(u,"baseURL",s),d=a(u,"path",r),f=a(u,"prefix",h),p=a(u,"files",null),g=a(u,"defaultType","void");if(Array.isArray(p)){this.setBaseURL(c),this.setPath(d),this.setPrefix(f);for(var v=0;v<p.length;v++){var m=p[v],y=m.hasOwnProperty("type")?m.type:g;this[y]&&(this[y](m),n++)}}}return this.setBaseURL(s),this.setPath(r),this.setPrefix(h),n>0},removePack:function(t,e){var i,n=this.systems.anims,s=this.cacheManager,r=this.textureManager,o={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"};if(h(t))i=t;else if(!(i=s.json.get(t)))return void console.warn("Asset Pack not found in JSON cache:",t);for(var l in e&&(i={_:i[e]}),i){var u=i[l],c=a(u,"prefix",""),d=a(u,"files"),f=a(u,"defaultType");if(Array.isArray(d))for(var p=0;p<d.length;p++){var g=d[p],v=g.hasOwnProperty("type")?g.type:f;if(v){var m=c+g.key;if("animation"===v&&n.remove(m),"aseprite"!==v&&"atlas"!==v&&"atlasXML"!==v&&"htmlTexture"!==v&&"image"!==v&&"multiatlas"!==v&&"spritesheet"!==v&&"svg"!==v&&"texture"!==v&&"unityAtlas"!==v||(r.remove(m),o[v]))if("pack"!==v){if("spine"===v){var y=s.custom.spine.get(m);if(!y)continue;var x=void 0===y.prefix?"":y.prefix;s.custom.spine.remove(m);var w=s.custom.spineTextures.get(m);if(!w)continue;s.custom.spineTextures.remove(m);for(var T=0;T<w.pages.length;T++){var b=x+w.pages[T].name,S=m+":"+b;r.exists(S)?r.remove(S):r.remove(b)}}var E=o[v];null!==E&&(E?s[E].remove(m):console.warn("Unknown type:",v))}else this.removePack(m,g.dataKey)}else console.warn("No type:",g)}}},isLoading:function(){return this.state===e.LOADER_LOADING||this.state===e.LOADER_PROCESSING},isReady:function(){return this.state===e.LOADER_IDLE||this.state===e.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(s.START,this),0===this.list.size?this.loadComplete():(this.state=e.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(u.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(s.PROGRESS,this.progress)},update:function(){this.state===e.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(t){if((t.state===e.FILE_POPULATED||t.state===e.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(s.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(s.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===e.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===e.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&(t.multiFile.addToCache(),t.multiFile.pendingDestroy()):(t.addToCache(),t.pendingDestroy())),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(s.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=e.LOADER_COMPLETE,this.systems.events.off(u.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(s.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,i){void 0===e&&(e="file.json"),void 0===i&&(i="application/json");var n=new Blob([t],{type:i}),s=URL.createObjectURL(n),r=document.createElement("a");return r.download=e,r.textContent="Download "+e,r.href=s,r.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,i=this.systems.settings.loader;this.setBaseURL(a(i,"baseURL",t.loaderBaseURL)),this.setPath(a(i,"path",t.loaderPath)),this.setPrefix(a(i,"prefix",t.loaderPrefix)),this.state=e.LOADER_IDLE},shutdown:function(){this.reset(),this.state=e.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=e.LOADER_DESTROYED,this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});return l.register("Loader",d,"load"),D8=d}function Ctt(){if(B8)return k8;B8=1;var t=m6(),e=nh(),i={Events:oU(),FileTypes:F8?O8:(F8=1,O8={AnimationJSONFile:E6(),AsepriteFile:A6(),AtlasJSONFile:P6(),AtlasXMLFile:R6(),AudioFile:O6(),AudioSpriteFile:Q9(),BinaryFile:ttt(),BitmapFontFile:ett(),CompressedTextureFile:ntt(),CSSFile:stt(),FontFile:rtt(),GLSLFile:att(),HTML5AudioFile:L6(),HTMLFile:ott(),HTMLTextureFile:htt(),ImageFile:_6(),JSONFile:S6(),MultiAtlasFile:itt(),MultiScriptFile:utt(),OBJFile:dtt(),PackFile:ftt(),PluginFile:ptt(),SceneFile:gtt(),ScenePluginFile:vtt(),ScriptFile:ltt(),SpriteSheetFile:mtt(),SVGFile:ytt(),TextFile:ctt(),TilemapCSVFile:wtt(),TilemapImpactFile:Ttt(),TilemapJSONFile:btt(),UnityAtlasFile:Stt(),VideoFile:Ett(),XMLFile:M6()}),File:b6(),FileTypesManager:eU(),GetURL:y6(),LoaderPlugin:_tt(),MergeXHRSettings:w6(),MultiFile:C6(),XHRLoader:T6(),XHRSettings:x6()};return i=e(!1,i,t),k8=i}function Att(){return U8?N8:(U8=1,N8={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14})}function Ptt(){return j8?V8:(j8=1,V8=function(t){var e=0;if(Array.isArray(t))for(var i=0;i<t.length;i++)e|=t[i];else e=t;return e})}function Mtt(){if(K8)return q8;K8=1;var t=Ptt();return q8={setCollisionCategory:function(t){return(this.body?this.body:this).collisionCategory=t,this},willCollideWith:function(t){return 0!==((this.body?this.body:this).collisionMask&t)},addCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask|t,this},removeCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask&~t,this},setCollidesWith:function(e){return(this.body?this.body:this).collisionMask=t(e),this},resetCollisionCategory:function(){var t=this.body?this.body:this;return t.collisionCategory=1,t.collisionMask=2147483647,this}}}function Rtt(){return c7||(c7=1,u7=function(t,e,i,n,s,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1);var o=[],h=[],l=t.treeMinMax;if(l.minX=e,l.minY=i,l.maxX=e+n,l.maxY=i+s,a&&(h=t.staticTree.search(l)),r&&t.useTree)o=t.tree.search(l);else if(r){var u=t.bodies,c={position:{x:e,y:i},left:e,top:i,right:e+n,bottom:i+s,isCircle:!1},d=t.intersects;u.iterate(function(t){d(t,c)&&o.push(t)})}return h.concat(o)}),u7}function Ltt(){if(f7)return d7;f7=1;var t=Rtt(),e=sl(),i=r4(),n=t4();return d7=function(s,r,a,o,h,l){var u=t(s,r-o,a-o,2*o,2*o,h,l);if(0===u.length)return u;for(var c=new e(r,a,o),d=new e,f=[],p=0;p<u.length;p++){var g=u[p];g.isCircle?(d.setTo(g.center.x,g.center.y,g.halfWidth),i(c,d)&&f.push(g)):n(c,g)&&f.push(g)}return f}}function Ott(){return T7?w7:(T7=1,w7={Acceleration:Y8?z8:(Y8=1,z8={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}),Angular:G8?X8:(G8=1,X8={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}),Bounce:H8?W8:(H8=1,W8={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,i,n){return this.body.setCollideWorldBounds(t,e,i,n),this}}),Collision:Mtt(),Debug:J8?Z8:(J8=1,Z8={setDebug:function(t,e,i){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=i,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}),Drag:Q8?$8:(Q8=1,$8={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}),Enable:e7?t7:(e7=1,t7={setDirectControl:function(t){return this.body.setDirectControl(t),this},enableBody:function(t,e,i,n,s){return t&&this.body.reset(e,i),n&&(this.body.gameObject.active=!0),s&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}}),Friction:n7?i7:(n7=1,i7={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}),Gravity:r7?s7:(r7=1,s7={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}),Immovable:o7?a7:(o7=1,a7={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}}),Mass:l7?h7:(l7=1,h7={setMass:function(t){return this.body.mass=t,this}}),OverlapCirc:Ltt(),OverlapRect:Rtt(),Pushable:g7?p7:(g7=1,p7={setPushable:function(t){return void 0===t&&(t=!0),this.body.pushable=t,this}}),Size:m7?v7:(m7=1,v7={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,i){return this.body.setSize(t,e,i),this},setBodySize:function(t,e,i){return this.body.setSize(t,e,i),this},setCircle:function(t,e,i){return this.body.setCircle(t,e,i),this}}),Velocity:x7?y7:(x7=1,y7={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}})})}function Ftt(){if(S7)return b7;S7=1;var t=Vh(),e=Ott(),i=wU(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return b7=n}function Dtt(){if(_7)return E7;_7=1;var t=Vh(),e=Ott(),i=uV(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return E7=n}function Itt(){return G7?X7:(G7=1,X7={COLLIDE:A7?C7:(A7=1,C7="collide"),OVERLAP:M7?P7:(M7=1,P7="overlap"),PAUSE:L7?R7:(L7=1,R7="pause"),RESUME:F7?O7:(F7=1,O7="resume"),TILE_COLLIDE:I7?D7:(I7=1,D7="tilecollide"),TILE_OVERLAP:B7?k7:(B7=1,k7="tileoverlap"),WORLD_BOUNDS:U7?N7:(U7=1,N7="worldbounds"),WORLD_STEP:Y7?z7:(Y7=1,z7="worldstep")})}function ktt(){return H7||(H7=1,W7=function(t,e){return void 0===e&&(e={}),e.none=t,e.up=!1,e.down=!1,e.left=!1,e.right=!1,t||(e.up=!0,e.down=!0,e.left=!0,e.right=!0),e}),W7}function Btt(){if(j7)return V7;j7=1;var t=Vh(),e=Mtt(),i=Att(),n=Itt(),s=Mk(),r=Fu(),a=Tu(),o=ktt(),h=Ru(),l=new t({Mixins:[e],initialize:function(t,e){var n=64,s=64,a=void 0!==e;a&&e.displayWidth&&(n=e.displayWidth,s=e.displayHeight),a||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=a?e:void 0,this.isBody=!0,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new h,this.position=new h(e.x-e.scaleX*e.displayOriginX,e.y-e.scaleY*e.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=s,this.sourceWidth=n,this.sourceHeight=s,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(s/2),this.center=new h(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new h,this.newVelocity=new h,this.deltaMax=new h,this.acceleration=new h,this.allowDrag=!0,this.drag=new h,this.allowGravity=!0,this.gravity=new h,this.bounce=new h,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new h(1e4,1e4),this.maxSpeed=-1,this.friction=new h(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=i.FACING_NONE,this.immovable=!1,this.pushable=!0,this.slideFactor=new h(1,1),this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=o(!1),this.touching=o(!0),this.wasTouching=o(!0),this.blocked=o(!0),this.syncBounds=!1,this.physicsType=i.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new r,this.directControl=!1,this.autoFrame=this.position.clone()},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var i=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=i.tx,e.y=i.ty,e.rotation=s(i.rotation),e.scaleX=i.scaleX,e.scaleY=i.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var n=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,n=!0}else{var a=Math.abs(e.scaleX),o=Math.abs(e.scaleY);this._sx===a&&this._sy===o||(this.width=this.sourceWidth*a,this.height=this.sourceHeight*o,this._sx=a,this._sy=o,n=!0)}n&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var t=this.transform;this.position.x=t.x+t.scaleX*(this.offset.x-t.displayOriginX),this.position.y=t.y+t.scaleY*(this.offset.y-t.displayOriginY),this.updateCenter()},resetFlags:function(t){void 0===t&&(t=!1);var e=this.wasTouching,i=this.touching,n=this.blocked;t?o(!0,e):(e.none=i.none,e.up=i.up,e.down=i.down,e.left=i.left,e.right=i.right),o(!0,i),o(!0,n),this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){if(t&&this.resetFlags(),this.gameObject&&this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves){var i=this.position;this.prev.x=i.x,this.prev.y=i.y,this.prevFrame.x=i.x,this.prevFrame.y=i.y}t&&this.update(e)},update:function(t){var e=this.prev,i=this.position,s=this.velocity;if(e.set(i.x,i.y),!this.moves)return this._dx=i.x-e.x,void(this._dy=i.y-e.y);if(this.directControl){var r=this.autoFrame;s.set((i.x-r.x)/t,(i.y-r.y)/t),this.world.updateMotion(this,t),this._dx=i.x-r.x,this._dy=i.y-r.y}else this.world.updateMotion(this,t),this.newVelocity.set(s.x*t,s.y*t),i.add(this.newVelocity),this._dx=i.x-e.x,this._dy=i.y-e.y;var a=s.x,o=s.y;if(this.updateCenter(),this.angle=Math.atan2(o,a),this.speed=Math.sqrt(a*a+o*o),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds){var h=this.blocked;this.world.emit(n.WORLD_BOUNDS,this,h.up,h.down,h.left,h.right)}},postUpdate:function(){var t=this.position,e=t.x-this.prevFrame.x,n=t.y-this.prevFrame.y,s=this.gameObject;if(this.moves){var r=this.deltaMax.x,a=this.deltaMax.y;0!==r&&0!==e&&(e<0&&e<-r?e=-r:e>0&&e>r&&(e=r)),0!==a&&0!==n&&(n<0&&n<-a?n=-a:n>0&&n>a&&(n=a)),s&&(s.x+=e,s.y+=n)}e<0?this.facing=i.FACING_LEFT:e>0&&(this.facing=i.FACING_RIGHT),n<0?this.facing=i.FACING_UP:n>0&&(this.facing=i.FACING_DOWN),this.allowRotation&&s&&(s.angle+=this.deltaZ()),this._tx=e,this._ty=n,this.autoFrame.set(t.x,t.y)},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.velocity,i=this.blocked,n=this.customBoundsRectangle,s=this.world.checkCollision,r=this.worldBounce?-this.worldBounce.x:-this.bounce.x,a=this.worldBounce?-this.worldBounce.y:-this.bounce.y,o=!1;return t.x<n.x&&s.left?(t.x=n.x,e.x*=r,i.left=!0,o=!0):this.right>n.right&&s.right&&(t.x=n.right-this.width,e.x*=r,i.right=!0,o=!0),t.y<n.y&&s.up?(t.y=n.y,e.y*=a,i.up=!0,o=!0):this.bottom>n.bottom&&s.down&&(t.y=n.bottom-this.height,e.y*=a,i.down=!0,o=!0),o&&(this.blocked.none=!1,this.updateCenter()),o},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this},setGameObject:function(t,e){if(void 0===e&&(e=!0),!t||!t.hasTransformComponent)return this;var i=this.world;return this.gameObject&&this.gameObject.body&&(i.disable(this.gameObject),this.gameObject.body=null),t.body&&i.disable(t),this.gameObject=t,t.body=this,this.setSize(),this.enable=e,this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&(!t&&n.frame&&(t=n.frame.realWidth),!e&&n.frame&&(e=n.frame.realHeight)),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),i&&n&&n.getCenter){var s=(n.width-t)/2,r=(n.height-e)/2;this.offset.set(s,r)}return this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var i=this.gameObject;i&&(i.setPosition(t,e),this.rotation=i.angle,this.preRotation=i.angle);var n=this.position;i&&i.getTopLeft?i.getTopLeft(n):n.set(t,e),this.prev.copy(n),this.prevFrame.copy(n),this.autoFrame.copy(n),i&&this.updateBounds(),this.updateCenter(),this.collideWorldBounds&&this.checkWorldBounds(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:a(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(i,n,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(i,n,i+this.velocity.x/2,n+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setDirectControl:function(t){return void 0===t&&(t=!0),this.directControl=t,this},setCollideWorldBounds:function(t,e,i,n){void 0===t&&(t=!0),this.collideWorldBounds=t;var s=void 0!==e,r=void 0!==i;return(s||r)&&(this.worldBounce||(this.worldBounce=new h),s&&(this.worldBounce.x=e),r&&(this.worldBounce.y=i)),void 0!==n&&(this.onWorldBounds=n),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){return this.setVelocity(t,this.velocity.y)},setVelocityY:function(t){return this.setVelocity(this.velocity.x,t)},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxVelocityX:function(t){return this.maxVelocity.x=t,this},setMaxVelocityY:function(t){return this.maxVelocity.y=t,this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setSlideFactor:function(t,e){return this.slideFactor.set(t,e),this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDamping:function(t){return this.useDamping=t,this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},processX:function(t,e,i,n){this.x+=t,this.updateCenter(),null!==e&&(this.velocity.x=e*this.slideFactor.x);var s=this.blocked;i&&(s.left=!0,s.none=!1),n&&(s.right=!0,s.none=!1)},processY:function(t,e,i,n){this.y+=t,this.updateCenter(),null!==e&&(this.velocity.y=e*this.slideFactor.y);var s=this.blocked;i&&(s.up=!0,s.none=!1),n&&(s.down=!0,s.none=!1)},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return V7=l}function Ntt(){if(K7)return q7;K7=1;var t=Dtt(),e=Vh(),i=Mtt(),n=Att(),s=Wh(),r=cV(),a=ih(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){if(o||h)if(a(o))h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler;else if(Array.isArray(o)&&a(o[0])){var l=this;o.forEach(function(e){e.internalCreateCallback=l.createCallbackHandler,e.internalRemoveCallback=l.removeCallbackHandler,e.classType=s(e,"classType",t)}),h=null}else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};this.world=e,h&&(h.classType=s(h,"classType",t)),this.physicsType=n.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=2147483647,this.defaults={setCollideWorldBounds:s(h,"collideWorldBounds",!1),setBoundsRectangle:s(h,"customBoundsRectangle",null),setAccelerationX:s(h,"accelerationX",0),setAccelerationY:s(h,"accelerationY",0),setAllowDrag:s(h,"allowDrag",!0),setAllowGravity:s(h,"allowGravity",!0),setAllowRotation:s(h,"allowRotation",!0),setDamping:s(h,"useDamping",!1),setBounceX:s(h,"bounceX",0),setBounceY:s(h,"bounceY",0),setDragX:s(h,"dragX",0),setDragY:s(h,"dragY",0),setEnable:s(h,"enable",!0),setGravityX:s(h,"gravityX",0),setGravityY:s(h,"gravityY",0),setFrictionX:s(h,"frictionX",0),setFrictionY:s(h,"frictionY",0),setMaxSpeed:s(h,"maxSpeed",-1),setMaxVelocityX:s(h,"maxVelocityX",1e4),setMaxVelocityY:s(h,"maxVelocityY",1e4),setVelocityX:s(h,"velocityX",0),setVelocityY:s(h,"velocityY",0),setAngularVelocity:s(h,"angularVelocity",0),setAngularAcceleration:s(h,"angularAcceleration",0),setAngularDrag:s(h,"angularDrag",0),setMass:s(h,"mass",1),setImmovable:s(h,"immovable",!1)},r.call(this,i,o,h),this.type="PhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.DYNAMIC_BODY);var e=t.body;for(var i in this.defaults)e[i](this.defaults[i])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,i){void 0===i&&(i=0);for(var n=this.getChildren(),s=0;s<n.length;s++)n[s].body.velocity.set(t+s*i,e+s*i);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.x=t+n*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.y=t+n*e;return this}});return q7=o}function Utt(){if(J7)return Z7;J7=1;var t=jh(),e=Vh(),i=Mtt(),n=Att(),s=Tu(),r=ktt(),a=Ru(),o=new e({Mixins:[i],initialize:function(t,e){var i=64,s=64,o=void 0!==e;o&&e.displayWidth&&(i=e.displayWidth,s=e.displayHeight),o||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=o?e:void 0,this.isBody=!0,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new a,this.position=new a(e.x-i*e.originX,e.y-s*e.originY),this.width=i,this.height=s,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new a(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=a.ZERO,this.allowGravity=!1,this.gravity=a.ZERO,this.bounce=a.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=r(!1),this.touching=r(!0),this.wasTouching=r(!0),this.blocked=r(!0),this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._dx=0,this._dy=0},setGameObject:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),!t||!t.hasTransformComponent)return this;var n=this.world;return this.gameObject&&this.gameObject.body&&(n.disable(this.gameObject),this.gameObject.body=null),t.body&&n.disable(t),this.gameObject=t,t.body=this,this.setSize(),e&&this.updateFromGameObject(),this.enable=i,this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&n.frame&&(t||(t=n.frame.realWidth),e||(e=n.frame.realHeight)),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),i&&n&&n.getCenter){var s=n.displayWidth/2,r=n.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(s-this.halfWidth,r-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var i=this.gameObject;void 0===t&&(t=i.x),void 0===e&&(e=i.y),this.world.staticTree.remove(this),i.setPosition(t,e),i.getTopLeft(this.position),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(e,i){return this.isCircle?t(this,e,i):s(this,e,i)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(i,n,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return Z7=o}function ztt(){if(Q7)return $7;Q7=1;var t=Dtt(),e=Vh(),i=Mtt(),n=Att(),s=Wh(),r=cV(),a=ih(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){o||h?a(o)?(h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler,h.createMultipleCallback=this.createMultipleCallbackHandler,h.classType=s(h,"classType",t)):Array.isArray(o)&&a(o[0])?(h=o,o=null,h.forEach(function(e){e.internalCreateCallback=this.createCallbackHandler,e.internalRemoveCallback=this.removeCallbackHandler,e.createMultipleCallback=this.createMultipleCallbackHandler,e.classType=s(e,"classType",t)})):h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:t},this.world=e,this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,r.call(this,i,o,h),this.type="StaticPhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});return $7=o}function Ytt(){if(e9)return t9;e9=1;var t=Ftt(),e=Dtt(),i=Btt(),n=Vh(),s=Att(),r=Ntt(),a=Utt(),o=ztt(),h=new n({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,i,n,s){return this.world.addCollider(t,e,i,n,s)},overlap:function(t,e,i,n,s){return this.world.addOverlap(t,e,i,n,s)},existing:function(t,e){var i=e?s.STATIC_BODY:s.DYNAMIC_BODY;return this.world.enableBody(t,i),t},staticImage:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},image:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticSprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},sprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticGroup:function(t,e){return this.sys.updateList.add(new o(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new r(this.world,this.world.scene,t,e))},body:function(t,e,n,r){var a=new i(this.world);return a.position.set(t,e),n&&r&&a.setSize(n,r),this.world.add(a,s.DYNAMIC_BODY),a},staticBody:function(t,e,i,n){var r=new a(this.world);return r.position.set(t,e),i&&n&&r.setSize(i,n),this.world.add(r,s.STATIC_BODY),r},destroy:function(){this.world=null,this.scene=null,this.sys=null}});return t9=h}function Xtt(){if(n9)return i9;n9=1;var t=new(Vh())({initialize:function(t,e,i,n,s,r,a){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=i,this.object2=n,this.collideCallback=s,this.processCallback=r,this.callbackContext=a},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});return i9=t}function Gtt(){if(r9)return s9;r9=1;var t=Att();return s9=function(e,i,n,s){var r=0,a=e.deltaAbsX()+i.deltaAbsX()+s;return 0===e._dx&&0===i._dx?(e.embedded=!0,i.embedded=!0):e._dx>i._dx?(r=e.right-i.x)>a&&!n||!1===e.checkCollision.right||!1===i.checkCollision.left?r=0:(e.touching.none=!1,e.touching.right=!0,i.touching.none=!1,i.touching.left=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.right=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.left=!0)):e._dx<i._dx&&(-(r=e.x-i.width-i.x)>a&&!n||!1===e.checkCollision.left||!1===i.checkCollision.right?r=0:(e.touching.none=!1,e.touching.left=!0,i.touching.none=!1,i.touching.right=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.left=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.right=!0))),e.overlapX=r,i.overlapX=r,r}}function Wtt(){if(o9)return a9;o9=1;var t=Att();return a9=function(e,i,n,s){var r=0,a=e.deltaAbsY()+i.deltaAbsY()+s;return 0===e._dy&&0===i._dy?(e.embedded=!0,i.embedded=!0):e._dy>i._dy?(r=e.bottom-i.y)>a&&!n||!1===e.checkCollision.down||!1===i.checkCollision.up?r=0:(e.touching.none=!1,e.touching.down=!0,i.touching.none=!1,i.touching.up=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.down=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.up=!0)):e._dy<i._dy&&(-(r=e.y-i.bottom)>a&&!n||!1===e.checkCollision.up||!1===i.checkCollision.down?r=0:(e.touching.none=!1,e.touching.up=!0,i.touching.none=!1,i.touching.down=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.up=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.down=!0))),e.overlapY=r,i.overlapY=r,r}}function Htt(){if(l9)return h9;l9=1;var t=Wh();return h9=function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=a.width),void 0===s&&(s=a.height),r||(r={});var o=t(r,"isNotEmpty",!1),h=t(r,"isColliding",!1),l=t(r,"hasInterestingFace",!1);e<0&&(n+=e,e=0),i<0&&(s+=i,i=0),e+n>a.width&&(n=Math.max(a.width-e,0)),i+s>a.height&&(s=Math.max(a.height-i,0));for(var u=[],c=i;c<i+s;c++)for(var d=e;d<e+n;d++){var f=a.data[c][d];if(null!==f){if(o&&-1===f.index)continue;if(h&&!f.collides)continue;if(l&&!f.hasInterestingFace)continue;u.push(f)}}return u}}function Vtt(){if(c9)return u9;c9=1;var t=Htt(),e=Ru(),i=new e,n=new e;return u9=function(e,s,r,a,o,h,l){var u=l.tilemapLayer.tilemap._convert.WorldToTileXY;u(e,s,!0,i,h,l);var c=i.x,d=i.y;u(e+r,s+a,!1,n,h,l);var f=Math.ceil(n.x),p=Math.ceil(n.y);return t(c,d,f-c,p-d,o,l)}}function jtt(){return f9?d9:(f9=1,d9=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)})}function qtt(){if(g9)return p9;g9=1;var t=Ll();function e(t){if(!(this instanceof e))return new e(t);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function n(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,s){s||(s=p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var a,o=e;o<i;o++)a=t.children[o],r(s,t.leaf?n(a):a);return s}function r(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,s,r){for(var a,o=[i,n];o.length;)(n=o.pop())-(i=o.pop())<=s||(a=i+Math.ceil((n-i)/s/2)*s,t(e,a,i,n,r),o.push(i,a,a,n))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!f(t,e))return i;for(var s,r,a,o,h=[];e;){for(s=0,r=e.children.length;s<r;s++)a=e.children[s],f(t,o=e.leaf?n(a):a)&&(e.leaf?i.push(a):d(t,o)?this._all(a,i):h.push(a));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!f(t,e))return!1;for(var n,s,r,a,o=[];e;){for(n=0,s=e.children.length;n<s;n++)if(r=e.children[n],f(t,a=e.leaf?i(r):r)){if(e.leaf||d(t,a))return!0;o.push(r)}e=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,s,r,a,o=this.data,h=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],n=u.pop(),a=!0),o.leaf&&-1!==(r=i(t,o.children,e)))return o.children.splice(r,1),l.push(o),this._condense(l),this;a||o.leaf||!d(o,h)?s?(n++,o=s.children[n],a=!1):o=null:(l.push(o),u.push(n),n=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:a,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var r,a=i-e+1,o=this._maxEntries;if(a<=o)return n(r=p(t.slice(e,i+1)),this.toBBox),r;s||(s=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,s-1))),(r=p([])).leaf=!1,r.height=s;var h,l,u,c,d=Math.ceil(a/o),f=d*Math.ceil(Math.sqrt(o));for(g(t,e,i,f,this.compareMinX),h=e;h<=i;h+=f)for(g(t,h,u=Math.min(h+f-1,i),d,this.compareMinY),l=h;l<=u;l+=d)c=Math.min(l+d-1,u),r.children.push(this._build(t,l,c,s-1));return n(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var s,r,a,o,l,c,d,f;n.push(e),!e.leaf&&n.length-1!==i;){for(d=f=1/0,s=0,r=e.children.length;s<r;s++)l=h(a=e.children[s]),(c=u(t,a)-l)<f?(f=c,d=l<d?l:d,o=a):c===f&&l<d&&(d=l,o=a);e=o||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,s=i?t:n(t),a=[],o=this._chooseSubtree(s,this.data,e,a);for(o.children.push(t),r(o,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)},_split:function(t,e){var i=t[e],s=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,s);var a=this._chooseSplitIndex(i,r,s),o=p(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,n(i,this.toBBox),n(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,a,o,l,u,d,f;for(u=d=1/0,n=e;n<=i-e;n++)o=c(r=s(t,0,n,this.toBBox),a=s(t,n,i,this.toBBox)),l=h(r)+h(a),o<u?(u=o,f=n,d=l<d?l:d):o===u&&l<d&&(d=l,f=n);return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:a,s=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var a,o,h=this.toBBox,u=s(t,0,e,h),c=s(t,i-e,i,h),d=l(u)+l(c);for(a=e;a<i-e;a++)o=t.children[a],r(u,t.leaf?h(o):o),d+=l(u);for(a=i-e-1;a>=e;a--)o=t.children[a],r(c,t.leaf?h(o):o),d+=l(c);return d},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)r(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():n(t[i],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},p9=e}function Ktt(){return m9?v9:(m9=1,v9=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,t.updateCenter(),0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x})}function Ztt(){if(x9)return y9;x9=1;var t=Ktt();return y9=function(e,i,n,s,r,a){var o=0,h=i.faceLeft,l=i.faceRight,u=i.collideLeft,c=i.collideRight;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaX()<0&&c&&e.checkCollision.left?l&&e.x<s&&(o=e.x-s)<-r&&(o=0):e.deltaX()>0&&u&&e.checkCollision.right&&h&&e.right>n&&(o=e.right-n)>r&&(o=0),0!==o&&(e.customSeparateX?e.overlapX=o:t(e,o)),o}}function Jtt(){return T9?w9:(T9=1,w9=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,t.updateCenter(),0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y})}function $tt(){if(S9)return b9;S9=1;var t=Jtt();return b9=function(e,i,n,s,r,a){var o=0,h=i.faceTop,l=i.faceBottom,u=i.collideUp,c=i.collideDown;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaY()<0&&c&&e.checkCollision.up?l&&e.y<s&&(o=e.y-s)<-r&&(o=0):e.deltaY()>0&&u&&e.checkCollision.down&&h&&e.bottom>n&&(o=e.bottom-n)>r&&(o=0),0!==o&&(e.customSeparateY?e.overlapY=o:t(e,o)),o}}function Qtt(){return _9?E9:(_9=1,E9=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)})}function tet(){if(A9)return C9;A9=1;var t=Ztt(),e=$tt(),i=Qtt();return C9=function(n,s,r,a,o,h,l){var u=a.left,c=a.top,d=a.right,f=a.bottom,p=r.faceLeft||r.faceRight,g=r.faceTop||r.faceBottom;if(l||(p=!0,g=!0),!p&&!g)return!1;var v=0,m=0,y=0,x=1;if(s.deltaAbsX()>s.deltaAbsY()?y=-1:s.deltaAbsX()<s.deltaAbsY()&&(x=-1),0!==s.deltaX()&&0!==s.deltaY()&&p&&g&&(y=Math.min(Math.abs(s.position.x-d),Math.abs(s.right-u)),x=Math.min(Math.abs(s.position.y-f),Math.abs(s.bottom-c))),y<x){if(p&&0!==(v=t(s,r,u,d,h,l))&&!i(a,s))return!0;g&&(m=e(s,r,c,f,h,l))}else{if(g&&0!==(m=e(s,r,c,f,h,l))&&!i(a,s))return!0;p&&(v=t(s,r,u,d,h,l))}return 0!==v||0!==m}}function eet(){if(L9)return R9;L9=1;var t=Gtt(),e=function(){if(M9)return P9;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v;M9=1;var m=function(){return l&&p&&e.blocked.right?(t.processX(-v,a,!1,!0),1):h&&g&&e.blocked.left?(t.processX(v,a,!0),1):d&&g&&t.blocked.right?(e.processX(-v,o,!1,!0),2):c&&p&&t.blocked.left?(e.processX(v,o,!0),2):0},y=function(p){if(i&&n)v*=.5,0===p||3===p?(t.processX(v,s),e.processX(-v,r)):(t.processX(-v,s),e.processX(v,r));else if(i&&!n)0===p||3===p?t.processX(v,a,!0):t.processX(-v,a,!1,!0);else if(!i&&n)0===p||3===p?e.processX(-v,o,!1,!0):e.processX(v,o,!0);else{var g=.5*v;0===p?f?(t.processX(v,0,!0),e.processX(0,null,!1,!0)):d?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.x,!0),e.processX(-g,null,!1,!0)):1===p?u?(t.processX(0,null,!1,!0),e.processX(v,0,!0)):l?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,null,!1,!0),e.processX(g,t.velocity.x,!0)):2===p?f?(t.processX(-v,0,!1,!0),e.processX(0,null,!0)):c?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,e.velocity.x,!1,!0),e.processX(g,null,!0)):3===p&&(u?(t.processX(0,null,!0),e.processX(-v,0,!1,!0)):h?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.y,!0),e.processX(-g,null,!1,!0)))}return!0};return P9={BlockCheck:m,Check:function(){var i=t.velocity.x,n=e.velocity.x,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.x,r=u+o*e.bounce.x,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.x,w=e.velocity.x;return i=t.pushable,h=t._dx<0,l=t._dx>0,u=0===t._dx,p=Math.abs(t.right-e.x)<=Math.abs(e.right-t.x),a=w-x*t.bounce.x,n=e.pushable,c=e._dx<0,d=e._dx>0,f=0===e._dx,g=!p,o=x-w*e.bounce.x,v=Math.abs(y),m()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.x=0:p?e.processX(v,o,!0):e.processX(-v,o,!1,!0),t.moves){var n=t.directControl?t.y-t.autoFrame.y:t.y-t.prev.y;e.y+=n*t.friction.y,e._dy=e.y-e.prev.y}},RunImmovableBody2:function(i){if(2===i?t.velocity.x=0:g?t.processX(v,a,!0):t.processX(-v,a,!1,!0),e.moves){var n=e.directControl?e.y-e.autoFrame.y:e.y-e.prev.y;t.y+=n*e.friction.y,t._dy=t.y-t.prev.y}}}}();return R9=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateX||n.customSeparateX)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function iet(){if(I9)return D9;I9=1;var t=Wtt(),e=function(){if(F9)return O9;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v;F9=1;var m=function(){return l&&p&&e.blocked.down?(t.processY(-v,a,!1,!0),1):h&&g&&e.blocked.up?(t.processY(v,a,!0),1):d&&g&&t.blocked.down?(e.processY(-v,o,!1,!0),2):c&&p&&t.blocked.up?(e.processY(v,o,!0),2):0},y=function(p){if(i&&n)v*=.5,0===p||3===p?(t.processY(v,s),e.processY(-v,r)):(t.processY(-v,s),e.processY(v,r));else if(i&&!n)0===p||3===p?t.processY(v,a,!0):t.processY(-v,a,!1,!0);else if(!i&&n)0===p||3===p?e.processY(-v,o,!1,!0):e.processY(v,o,!0);else{var g=.5*v;0===p?f?(t.processY(v,0,!0),e.processY(0,null,!1,!0)):d?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)):1===p?u?(t.processY(0,null,!1,!0),e.processY(v,0,!0)):l?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,null,!1,!0),e.processY(g,t.velocity.y,!0)):2===p?f?(t.processY(-v,0,!1,!0),e.processY(0,null,!0)):c?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,e.velocity.y,!1,!0),e.processY(g,null,!0)):3===p&&(u?(t.processY(0,null,!0),e.processY(-v,0,!1,!0)):h?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)))}return!0};return O9={BlockCheck:m,Check:function(){var i=t.velocity.y,n=e.velocity.y,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.y,r=u+o*e.bounce.y,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.y,w=e.velocity.y;return i=t.pushable,h=t._dy<0,l=t._dy>0,u=0===t._dy,p=Math.abs(t.bottom-e.y)<=Math.abs(e.bottom-t.y),a=w-x*t.bounce.y,n=e.pushable,c=e._dy<0,d=e._dy>0,f=0===e._dy,g=!p,o=x-w*e.bounce.y,v=Math.abs(y),m()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.y=0:p?e.processY(v,o,!0):e.processY(-v,o,!1,!0),t.moves){var n=t.directControl?t.x-t.autoFrame.x:t.x-t.prev.x;e.x+=n*t.friction.x,e._dx=e.x-e.prev.x}},RunImmovableBody2:function(i){if(2===i?t.velocity.y=0:g?t.processY(v,a,!0):t.processY(-v,a,!1,!0),e.moves){var n=e.directControl?e.x-e.autoFrame.x:e.x-e.prev.x;t.x+=n*e.friction.x,t._dx=t.x-t.prev.x}}}}();return D9=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateY||n.customSeparateY)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function net(){if(B9)return k9;B9=1;var t=ZI(),e=Btt(),i=Jh(),n=Vh(),s=Xtt(),r=Att(),a=ID(),o=nD(),h=qF(),l=Itt(),u=Mu(),c=hk(),d=lk(),f=Gtt(),p=Wtt(),g=Vtt(),v=Ol(),m=Qh(),y=DU(),x=jtt(),w=Fu(),T=qtt(),b=tet(),S=eet(),E=iet(),_=lV(),C=Utt(),A=Qtt(),P=tc(),M=Ru(),R=ic(),L=new n({Extends:h,initialize:function(t,e){h.call(this),this.scene=t,this.bodies=new _,this.staticBodies=new _,this.pendingDestroy=new _,this.colliders=new y,this.gravity=new M(v(e,"gravity.x",0),v(e,"gravity.y",0)),this.bounds=new w(v(e,"x",0),v(e,"y",0),v(e,"width",t.sys.scale.width),v(e,"height",t.sys.scale.height)),this.checkCollision={up:v(e,"checkCollision.up",!0),down:v(e,"checkCollision.down",!0),left:v(e,"checkCollision.left",!0),right:v(e,"checkCollision.right",!0)},this.fps=v(e,"fps",60),this.fixedStep=v(e,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=v(e,"timeScale",1),this.OVERLAP_BIAS=v(e,"overlapBias",4),this.TILE_BIAS=v(e,"tileBias",16),this.forceX=v(e,"forceX",!1),this.isPaused=v(e,"isPaused",!1),this._total=0,this.drawDebug=v(e,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:v(e,"debugShowBody",!0),debugShowStaticBody:v(e,"debugShowStaticBody",!0),debugShowVelocity:v(e,"debugShowVelocity",!0),bodyDebugColor:v(e,"debugBodyColor",16711935),staticBodyDebugColor:v(e,"debugStaticBodyColor",255),velocityDebugColor:v(e,"debugVelocityColor",65280)},this.maxEntries=v(e,"maxEntries",16),this.useTree=v(e,"useTree",!0),this.tree=new T(this.maxEntries),this.staticTree=new T(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new P,this._tempMatrix2=new P,this.tileFilterOptions={isColliding:!0,isNotEmpty:!0,hasInterestingFace:!0},this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=r.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];if(n.isParent)for(var s=n.getChildren(),a=0;a<s.length;a++){var o=s[a];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(n,e)}},enableBody:function(t,i){return void 0===i&&(i=r.DYNAMIC_BODY),t.hasTransformComponent&&(t.body||(i===r.DYNAMIC_BODY?t.body=new e(this,t):i===r.STATIC_BODY&&(t.body=new C(this,t))),this.add(t.body)),t},add:function(t){return t.physicsType===r.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===r.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];if(i.isParent)for(var n=i.getChildren(),s=0;s<n.length;s++){var r=n[s];r.isParent?this.disable(r):this.disableBody(r.body)}else this.disableBody(i.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===r.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===r.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,i,n,s,r,a,o){return this.bounds.setTo(t,e,i,n),void 0!==s&&this.setBoundsCollision(s,r,a,o),this},setBoundsCollision:function(t,e,i,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=i,this.checkCollision.down=n,this},pause:function(){return this.isPaused=!0,this.emit(l.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(l.RESUME),this},addCollider:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!1,t,e,i,n,r);return this.colliders.add(a),a},addOverlap:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!0,t,e,i,n,r);return this.colliders.add(a),a},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var i,n,s=this._frameTime,r=this._frameTimeMS*this.timeScale;this._elapsed+=e;var a=this.bodies.entries,o=this._elapsed>=r;for(this.fixedStep||(s=.001*e,o=!0,this._elapsed=0),i=0;i<a.length;i++)(n=a[i]).enable&&n.preUpdate(o,s);if(o){this._elapsed-=r,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(a));var h=this.colliders.update();for(i=0;i<h.length;i++){var u=h[i];u.active&&u.update()}this.emit(l.WORLD_STEP,s)}for(;this._elapsed>=r;)this._elapsed-=r,this.step(s)}},step:function(t){var e,i,n=this.bodies.entries,s=n.length;for(e=0;e<s;e++)(i=n[e]).enable&&i.update(t);this.useTree&&(this.tree.clear(),this.tree.load(n));var r=this.colliders.update();for(e=0;e<r.length;e++){var a=r[e];a.active&&a.update()}this.emit(l.WORLD_STEP,t),this.stepsLastFrame++},singleStep:function(){this.update(0,this._frameTimeMS),this.postUpdate()},postUpdate:function(){var t,e,i=this.bodies.entries,n=i.length,s=this.bodies,a=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<n;t++)(e=i[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o);for(n=(i=a.entries).length,t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o)}var h=this.pendingDestroy;if(h.size>0){var l=this.tree,u=this.staticTree;for(n=(i=h.entries).length,t=0;t<n;t++)(e=i[t]).physicsType===r.DYNAMIC_BODY?(l.remove(e),s.delete(e)):e.physicsType===r.STATIC_BODY&&(u.remove(e),a.delete(e)),e.world=void 0,e.gameObject=void 0;h.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,s=t.angularAcceleration,r=t.angularDrag,a=t.maxAngular;s?n+=s*e:t.allowDrag&&r&&(c(n-(r*=e),0,.1)?n-=r:d(n+r,0,.1)?n+=r:n=0);var o=(n=i(n,-a,a))-t.angularVelocity;t.angularVelocity+=o,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,s=t.acceleration.x,r=t.drag.x,a=t.maxVelocity.x,o=t.velocity.y,h=t.acceleration.y,l=t.drag.y,f=t.maxVelocity.y,p=t.speed,g=t.maxSpeed,v=t.allowDrag,m=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,o+=(this.gravity.y+t.gravity.y)*e),s?n+=s*e:v&&r&&(m?(n*=r=Math.pow(r,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(n=0)):c(n-(r*=e),0,.01)?n-=r:d(n+r,0,.01)?n+=r:n=0),h?o+=h*e:v&&l&&(m?(o*=l=Math.pow(l,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(o=0)):c(o-(l*=e),0,.01)?o-=l:d(o+l,0,.01)?o+=l:o=0),n=i(n,-a,a),o=i(o,-f,f),t.velocity.set(n,o),g>-1&&t.velocity.length()>g&&(t.velocity.normalize().scale(g),p=g),t.speed=p},separate:function(t,e,i,n,s){var r,a,o=!1,h=!0;if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e)||0===(t.collisionMask&e.collisionCategory)||0===(e.collisionMask&t.collisionCategory))return o;if(i&&!1===i.call(n,t.gameObject||t,e.gameObject||e))return o;if(t.isCircle||e.isCircle){var u=this.separateCircle(t,e,s);u.result?(o=!0,h=!1):(r=u.x,a=u.y,h=!0)}if(h){var c=!1,d=!1,f=this.OVERLAP_BIAS;s?(c=S(t,e,s,f,r),d=E(t,e,s,f,a)):this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(c=S(t,e,s,f,r),this.intersects(t,e)&&(d=E(t,e,s,f,a))):(d=E(t,e,s,f,a),this.intersects(t,e)&&(c=S(t,e,s,f,r))),o=c||d}return o&&(s?(t.onOverlap||e.onOverlap)&&this.emit(l.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(l.COLLIDE,t.gameObject,e.gameObject,t,e)),o},separateCircle:function(e,i,n){f(e,i,!1,0),p(e,i,!1,0);var s=e.isCircle,r=i.isCircle,h=e.center,l=i.center,u=e.immovable,c=i.immovable,d=e.velocity,g=i.velocity,v=0,y=!0;if(s!==r){y=!1;var x=h.x,w=h.y,T=e.halfWidth,b=i.position.x,S=i.position.y,E=i.right,_=i.bottom;r&&(x=l.x,w=l.y,T=i.halfWidth,b=e.position.x,S=e.position.y,E=e.right,_=e.bottom),w<S?x<b?v=a(x,w,b,S)-T:x>E&&(v=a(x,w,E,S)-T):w>_&&(x<b?v=a(x,w,b,_)-T:x>E&&(v=a(x,w,E,_)-T)),v*=-1}else v=e.halfWidth+i.halfWidth-o(h,l);e.overlapR=v,i.overlapR=v;var C=t(h,l),A=(v+m.EPSILON)*Math.cos(C),P=(v+m.EPSILON)*Math.sin(C),M={overlap:v,result:!1,x:A,y:P};if(n&&(!y||y&&0!==v))return M.result=!0,M;if(!y&&0===v||u&&c||e.customSeparateX||i.customSeparateX)return M.x=void 0,M.y=void 0,M;var R=!e.pushable&&!i.pushable;if(y){var L=h.x-l.x,O=h.y-l.y,F=Math.sqrt(Math.pow(L,2)+Math.pow(O,2)),D=(l.x-h.x)/F||0,I=(l.y-h.y)/F||0,k=2*(d.x*D+d.y*I-g.x*D-g.y*I)/(e.mass+i.mass);!u&&!c&&e.pushable&&i.pushable||(k*=2),!u&&e.pushable&&(d.x=d.x-k/e.mass*D,d.y=d.y-k/e.mass*I,d.multiply(e.bounce)),!c&&i.pushable&&(g.x=g.x+k/i.mass*D,g.y=g.y+k/i.mass*I,g.multiply(i.bounce)),u||c||(A*=.5,P*=.5),(!u||e.pushable||R)&&(e.x-=A,e.y-=P,e.updateCenter()),(!c||i.pushable||R)&&(i.x+=A,i.y+=P,i.updateCenter()),M.result=!0}else u||!e.pushable&&!R||(e.x-=A,e.y-=P,e.updateCenter()),c||!i.pushable&&!R||(i.x+=A,i.y+=P,i.updateCenter()),M.x=void 0,M.y=void 0;return M},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?o(t.center,e.center)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.left||t.bottom<=e.top||t.left>=e.right||t.top>=e.bottom))},circleBodyIntersects:function(t,e){var n=i(t.center.x,e.left,e.right),s=i(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-s)*(t.center.y-s)<=t.halfWidth*t.halfWidth},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!1)},collideObjects:function(t,e,i,n,s,r){var a,o;!t.isParent||void 0!==t.physicsType&&void 0!==e&&t!==e||(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var h=Array.isArray(t),l=Array.isArray(e);if(this._total=0,h||l)if(!h&&l)for(a=0;a<e.length;a++)this.collideHandler(t,e[a],i,n,s,r);else if(h&&!l)if(e)for(a=0;a<t.length;a++)this.collideHandler(t[a],e,i,n,s,r);else for(a=0;a<t.length;a++){var u=t[a];for(o=a+1;o<t.length;o++)a!==o&&this.collideHandler(u,t[o],i,n,s,r)}else for(a=0;a<t.length;a++)for(o=0;o<e.length;o++)this.collideHandler(t[a],e[o],i,n,s,r);else this.collideHandler(t,e,i,n,s,r);return this._total>0},collideHandler:function(t,e,i,n,s,r){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,i,n,s,r);if(!t||!e)return!1;if(t.body||t.isBody){if(e.body||e.isBody)return this.collideSpriteVsSprite(t,e,i,n,s,r);if(e.isParent)return this.collideSpriteVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,i,n,s,r)}else if(t.isParent){if(e.body||e.isBody)return this.collideSpriteVsGroup(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,i,n,s,r)}else if(t.isTilemap){if(e.body||e.isBody)return this.collideSpriteVsTilemapLayer(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,i,n,s,r)}},canCollide:function(t,e){return t&&e&&0!==(t.collisionMask&e.collisionCategory)&&0!==(e.collisionMask&t.collisionCategory)},collideSpriteVsSprite:function(t,e,i,n,s,r){var a=t.isBody?t:t.body,o=e.isBody?e:e.body;return!!this.canCollide(a,o)&&(this.separate(a,o,n,s,r)&&(i&&i.call(s,t,e),this._total++),!0)},collideSpriteVsGroup:function(t,e,i,n,s,a){var o,h,l,u=t.isBody?t:t.body;if(0!==e.getLength()&&u&&u.enable&&!u.checkCollision.none&&this.canCollide(u,e))if(this.useTree||e.physicsType===r.STATIC_BODY){var c=this.treeMinMax;c.minX=u.left,c.minY=u.top,c.maxX=u.right,c.maxY=u.bottom;var d=e.physicsType===r.DYNAMIC_BODY?this.tree.search(c):this.staticTree.search(c);for(h=d.length,o=0;o<h;o++)u!==(l=d[o])&&l.enable&&!l.checkCollision.none&&e.contains(l.gameObject)&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}else{var f=e.getChildren(),p=e.children.entries.indexOf(t);for(h=f.length,o=0;o<h;o++)(l=f[o].body)&&o!==p&&l.enable&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,i,n,s,r){if(!this.canCollide(t,e))return!1;var a=t.getChildren();if(0===a.length)return!1;for(var o=!1,h=0;h<a.length;h++)(a[h].body||a[h].isBody)&&this.collideSpriteVsTilemapLayer(a[h],e,i,n,s,r)&&(o=!0);return o},collideTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!1,!1)},overlapTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,i,n,s,r){var a=t.isBody?t:t.body;if(!a.enable||a.checkCollision.none||!this.canCollide(a,e))return!1;var o=e.layer,h=a.x-o.tileWidth*e.scaleX,l=a.y-o.tileHeight*e.scaleY,u=a.width+o.tileWidth*e.scaleX,c=a.height+o.tileHeight*e.scaleY,d=r?null:this.tileFilterOptions,f=g(h,l,u,c,d,e.scene.cameras.main,e.layer);return 0!==f.length&&this.collideSpriteVsTilesHandler(t,f,i,n,s,r,!0)},collideSpriteVsTilesHandler:function(t,e,i,n,s,r,a){for(var o,h,u=t.isBody?t:t.body,c={left:0,right:0,top:0,bottom:0},d=!1,f=0;f<e.length;f++){var p=(h=(o=e[f]).tilemapLayer).tileToWorldXY(o.x,o.y);c.left=p.x,c.top=p.y,c.right=c.left+o.width*h.scaleX,c.bottom=c.top+o.height*h.scaleY,A(c,u)&&(!n||n.call(s,t,o))&&x(o,t)&&(r||b(f,u,o,c,h,this.TILE_BIAS,a))&&(this._total++,d=!0,i&&i.call(s,t,o),r&&u.onOverlap?this.emit(l.TILE_OVERLAP,t,o,u):u.onCollide&&this.emit(l.TILE_COLLIDE,t,o,u))}return d},collideGroupVsGroup:function(t,e,i,n,s,r){if(0!==t.getLength()&&0!==e.getLength()&&this.canCollide(t,e))for(var a=t.getChildren(),o=0;o<a.length;o++)this.collideSpriteVsGroup(a[o],e,i,n,s,r)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var i=0;i<t.length;i++)this.wrapObject(t[i],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=R(t.x,this.bounds.left-e,this.bounds.right+e),t.y=R(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null,this.debugGraphic&&(this.debugGraphic.destroy(),this.debugGraphic=null)}});return k9=L}function set(){if(U9)return N9;U9=1;var t=Vh(),e=Xu(),i=ID(),n=ok(),s=Ytt(),r=Wh(),a=cU(),o=Ltt(),h=Rtt(),l=ku(),u=Bu(),c=Ru(),d=net(),f=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this._category=1,t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.start,this)},boot:function(){this.world=new d(this.scene,this.config),this.add=new s(this.world),this.systems.events.once(u.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new d(this.scene,this.config),this.add=new s(this.world));var t=this.systems.events;r(this.config,"customUpdate",!1)||t.on(u.UPDATE,this.world.update,this.world),t.on(u.POST_UPDATE,this.world.postUpdate,this.world),t.once(u.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(u.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(u.UPDATE,this.world.update,this.world)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return a(r(e,"arcade",{}),r(t,"arcade",{}))},nextCategory:function(){return this._category=this._category<<1,this._category},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!1)},collideTiles:function(t,e,i,n,s){return this.world.collideTiles(t,e,i,n,s)},overlapTiles:function(t,e,i,n,s){return this.world.overlapTiles(t,e,i,n,s)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,i,n,s,r){void 0===n&&(n=60);var a=Math.atan2(i-t.y,e-t.x);return t.body.acceleration.setToPolar(a,n),void 0!==s&&void 0!==r&&t.body.maxVelocity.set(s,r),a},accelerateToObject:function(t,e,i,n,s){return this.accelerateTo(t,e.x,e.y,i,n,s)},closest:function(t,e){e||(e=this.world.bodies.entries);for(var i=Number.MAX_VALUE,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c<i&&(s=l,i=c)}}return s},furthest:function(t,e){e||(e=this.world.bodies.entries);for(var i=-1,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c>i&&(s=l,i=c)}}return s},moveTo:function(t,e,n,s,r){void 0===s&&(s=60),void 0===r&&(r=0);var a=Math.atan2(n-t.y,e-t.x);return r>0&&(s=i(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(a,s),a},moveToObject:function(t,e,i,n){return this.moveTo(t,e.x,e.y,i,n)},velocityFromAngle:function(t,i,n){return void 0===i&&(i=60),void 0===n&&(n=new c),n.setToPolar(e(t),i)},velocityFromRotation:function(t,e,i){return void 0===e&&(e=60),void 0===i&&(i=new c),i.setToPolar(t,e)},overlapRect:function(t,e,i,n,s,r){return h(this.world,t,e,i,n,s,r)},overlapCirc:function(t,e,i,n,s){return o(this.world,t,e,i,n,s)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(u.UPDATE,this.world.update,this.world),t.off(u.POST_UPDATE,this.world.postUpdate,this.world),t.off(u.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null,this._category=1}},destroy:function(){this.shutdown(),this.scene.sys.events.off(u.START,this.start,this),this.scene=null,this.systems=null}});return l.register("ArcadePhysics",f,"arcadePhysics"),N9=f}function ret(){if(Y9)return z9;Y9=1;var t={ProcessTileCallbacks:jtt(),ProcessTileSeparationX:Ktt(),ProcessTileSeparationY:Jtt(),SeparateTile:tet(),TileCheckX:Ztt(),TileCheckY:$tt(),TileIntersectsBody:Qtt()};return z9=t}function aet(){if(G9)return X9;G9=1;var t=Att(),e=nh(),i={ArcadePhysics:set(),Body:Btt(),Collider:Xtt(),Components:Ott(),Events:Itt(),Factory:Ytt(),GetCollidesWith:Ptt(),GetOverlapX:Gtt(),GetOverlapY:Wtt(),SeparateX:eet(),SeparateY:iet(),Group:Ntt(),Image:Ftt(),Sprite:Dtt(),StaticBody:Utt(),StaticGroup:ztt(),Tilemap:ret(),World:net()};return i=e(!1,i,t),X9=i}function oet(){if(j9)return V9;j9=1;var t=new(Vh())({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return V9=t}function het(){if(K9)return q9;K9=1;var t=oet(),e=Vh(),i=Bu(),n=new e({Extends:t,initialize:function(e,n,s){t.call(this,n),this.scene=e,this.systems=e.sys,this.pluginKey=s,e.sys.events.once(i.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return q9=n}var uet,cet,det,fet,pet,get,vet,met,yet,xet,wet,Tet,bet,Eet,_et,Cet,Aet,Pet,Met,Ret,Let,Oet,Fet,Det,Iet,ket,Bet,Net,Uet,zet,Yet,Xet,Get,Wet,Het,Vet,jet,qet,Ket,Zet,Jet,$et,Qet,tit,eit,iit,nit,sit,rit,ait,oit,hit,lit,uit,cit,dit,fit,pit,git,vit,mit,yit,xit,wit,Tit,bit,Sit,Eit,_it,Cit,Ait,Pit,Mit,Rit,Lit,Oit,Fit,Dit,Iit,kit,Bit,Nit,Uit,zit,Yit,Xit,Git,Wit,Hit,Vit,jit,qit,Kit,Zit,Jit,$it,Qit,tnt,ent,int,nnt,snt,rnt,ant,ont,hnt,lnt,unt,cnt,dnt,fnt,pnt,gnt,vnt,mnt,ynt,xnt,wnt,Tnt,bnt,Snt,Ent,_nt,Cnt,Ant,Pnt,Mnt,Rnt,Lnt,Ont,Fnt,Dnt,Int,knt,Bnt,Nnt,Unt,znt,Ynt,Xnt,Gnt,Wnt,Hnt,Vnt,jnt,qnt,Knt,Znt,Jnt,$nt,Qnt,tst,est,ist,nst,sst,rst,ast,ost,hst,lst,ust,cst,dst,fst,pst,gst,vst,mst,yst,xst,wst,Tst,bst,Sst,Est,_st,Cst,Ast,Pst,Mst,Rst,Lst,Ost,Fst,Dst,Ist,kst,Bst,Nst,Ust,zst,Yst,Xst,Gst,Wst,Hst,Vst,jst,qst,Kst,Zst,Jst,$st,Qst,trt,ert,irt,nrt,srt,rrt,art,ort,hrt,lrt,urt,crt,drt,frt,prt,grt,vrt,mrt,yrt,xrt,wrt,Trt,brt,Srt,Ert,_rt,Crt,Art,Prt,Mrt,Rrt,Lrt,Ort,Frt,Drt={exports:{}};function Irt(){if(get)return pet;get=1;var t=Bk(),e=nh(),i={FX:OB(),BitmapMaskPipeline:Qk(),Events:Kk(),FXPipeline:jB(),LightPipeline:qB(),MobilePipeline:KB(),MultiPipeline:BB(),PointLightPipeline:ZB(),PostFXPipeline:nB(),PreFXPipeline:zB(),RopePipeline:JB(),SinglePipeline:$B(),UtilityPipeline:QB()};return i=e(!1,i,t),pet=i}function krt(){if(met)return vet;met=1;var t={WebGLAttribLocationWrapper:aN(),WebGLBufferWrapper:iN(),WebGLProgramWrapper:nN(),WebGLTextureWrapper:sN(),WebGLFramebufferWrapper:rN(),WebGLUniformLocationWrapper:oN()};return vet=t}function Brt(){if(bet)return Tet;bet=1;var t=nh(),e=zN(),i={Center:kN(),Events:VI(),Orientation:BN(),ScaleManager:rU(),ScaleModes:NN(),Zoom:UN()};return i=t(!1,i,e.CENTER),i=t(!1,i,e.ORIENTATION),i=t(!1,i,e.SCALE_MODE),i=t(!1,i,e.ZOOM),Tet=i}function Nrt(){if(_et)return Eet;_et=1;var t=Jh(),e=Vh(),i=Bu(),n=Wh(),s=ku(),r=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.pluginStart,this)},boot:function(){this.systems.events.once(i.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(i.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=n(t,"target",!1),s=this.manager.getScene(e);if(!e||!this.checkValidTransition(s))return!1;var r=n(t,"duration",1e3);this._elapsed=0,this._target=s,this._duration=r,this._willSleep=n(t,"sleep",!1),this._willRemove=n(t,"remove",!1);var a=n(t,"onUpdate",null);a&&(this._onUpdate=a,this._onUpdateScope=n(t,"onUpdateScope",this.scene));var o=n(t,"allowInput",!1);this.settings.transitionAllowInput=o;var h=s.sys.settings;h.isTransition=!0,h.transitionFrom=this.scene,h.transitionDuration=r,h.transitionAllowInput=o,n(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):n(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),s.sys.isSleeping()?s.sys.wake(n(t,"data")):this.manager.start(e,n(t,"data"));var l=n(t,"onStart",null),u=n(t,"onStartScope",this.scene);return l&&l.call(u,this.scene,s,r),this.systems.events.emit(i.TRANSITION_OUT,s,r),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(e,i){this._elapsed+=i,this.transitionProgress=t(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;t.events.emit(i.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,i,n){return this.manager.add(t,e,i,n)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t,e){return t!==this.key&&this.manager.queueOp("switch",this.key,t,e),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,i){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setActive(t,i),this},setVisible:function(t,e){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getStatus:function(t){var e=this.manager.getScene(t);if(e)return e.sys.getStatus()},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(i.SHUTDOWN,this.shutdown,this),t.off(i.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});return s.register("ScenePlugin",r,"scenePlugin"),Eet=r}function Urt(){if(Aet)return Cet;Aet=1;var t=aU(),e=nh(),i={Events:Bu(),GetPhysicsPlugins:hU(),GetScenePlugins:lU(),SceneManager:gU(),ScenePlugin:Nrt(),Settings:dU(),Systems:fU()};return i=e(!1,i,t),Cet=i}function zrt(){if(Fet)return Oet;Fet=1;var t=nh(),e=Let?Ret:(Let=1,Ret={LINEAR:0,NEAREST:1}),i={CanvasTexture:yU(),DynamicTexture:xU(),Events:Gk(),FilterMode:e,Frame:Zu(),Parsers:PU(),Texture:mU(),TextureManager:MU(),TextureSource:vU()};return i=t(!1,i,e),Oet=i}function Yrt(){return Iet?Det:(Iet=1,Det={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3})}function Xrt(){return Uet?Net:(Uet=1,Net=function(t,e,i){return t>=0&&t<i.width&&e>=0&&e<i.height})}function Grt(){if(Yet)return zet;Yet=1;var t=Xrt();return zet=function(e,i,n,s){if(t(e,i,s)){var r=s.data[i][e]||null;return r?-1===r.index?n?r:null:r:null}return null}}function Wrt(){if(Get)return Xet;Get=1;var t=Grt();return Xet=function(e,i,n){var s=t(e,i,!0,n),r=t(e,i-1,!0,n),a=t(e,i+1,!0,n),o=t(e-1,i,!0,n),h=t(e+1,i,!0,n),l=s&&s.collides;return l&&(s.faceTop=!0,s.faceBottom=!0,s.faceLeft=!0,s.faceRight=!0),r&&r.collides&&(l&&(s.faceTop=!1),r.faceBottom=!l),a&&a.collides&&(l&&(s.faceBottom=!1),a.faceTop=!l),o&&o.collides&&(l&&(s.faceLeft=!1),o.faceRight=!l),h&&h.collides&&(l&&(s.faceRight=!1),h.faceLeft=!l),s&&!s.collides&&s.resetFaces(),s}}function Hrt(){if(Het)return Wet;Het=1;var t=Grt(),e=Htt();return Wet=function(i,n,s,r,a){for(var o=null,h=null,l=null,u=null,c=e(i,n,s,r,null,a),d=0;d<c.length;d++){var f=c[d];f&&(f.collides?(o=t(f.x,f.y-1,!0,a),h=t(f.x,f.y+1,!0,a),l=t(f.x-1,f.y,!0,a),u=t(f.x+1,f.y,!0,a),f.faceTop=!o||!o.collides,f.faceBottom=!h||!h.collides,f.faceLeft=!l||!l.collides,f.faceRight=!u||!u.collides):f.resetFaces())}}}function Vrt(){if(jet)return Vet;jet=1;var t=new(Ru());return Vet=function(e,i,n,s){var r=n.tilemapLayer,a=r.cullPaddingX,o=r.cullPaddingY,h=r.tilemap.tileToWorldXY(e,i,t,s,r);return h.x>s.worldView.x+r.scaleX*n.tileWidth*(-a-.5)&&h.x<s.worldView.right+r.scaleX*n.tileWidth*(a-.5)&&h.y>s.worldView.y+r.scaleY*n.tileHeight*(-o-1)&&h.y<s.worldView.bottom+r.scaleY*n.tileHeight*(o-.5)}}function jrt(){if(Ket)return qet;Ket=1;var t=Vh(),e=ac(),i=Yrt(),n=Vu(),s=j4(),r=new t({Mixins:[e.AlphaSingle,e.Flip,e.Visible],initialize:function(t,e,i,n,s,r,a,o){this.layer=t,this.index=e,this.x=i,this.y=n,this.width=s,this.height=r,this.right,this.bottom,this.baseWidth=void 0!==a?a:s,this.baseHeight=void 0!==o?o:r,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,this.collisionCallbackContext=this,this.tint=16777215,this.tintFill=!1,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=n(t.properties),this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).x:this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).y:this.y*this.baseWidth-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new s),e.x=this.getLeft(t),e.y=this.getTop(t),e.width=this.getRight(t)-e.x,e.height=this.getBottom(t)-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},intersects:function(t,e,i,n){return!(i<=this.pixelX||n<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){return void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,i,n,s){return void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=t),void 0===s&&(s=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n,this.faceLeft=t,this.faceRight=e,this.faceTop=i,this.faceBottom=n,s&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,i,n){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==i&&(this.baseWidth=i),void 0!==n&&(this.baseHeight=n),this.updatePixelXY(),this},updatePixelXY:function(){var t=this.layer.orientation;if(t===i.ORTHOGONAL)this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight;else if(t===i.ISOMETRIC)this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5;else if(t===i.STAGGERED)this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2);else if(t===i.HEXAGONAL){var e,n,s=this.layer.staggerAxis,r=this.layer.staggerIndex,a=this.layer.hexSideLength;"y"===s?(n=(this.baseHeight-a)/2+a,this.pixelX="odd"===r?this.x*this.baseWidth+this.y%2*(this.baseWidth/2):this.x*this.baseWidth-this.y%2*(this.baseWidth/2),this.pixelY=this.y*n):"x"===s&&(e=(this.baseWidth-a)/2+a,this.pixelX=this.x*e,this.pixelY="odd"===r?this.y*this.baseHeight+this.x%2*(this.baseHeight/2):this.y*this.baseHeight-this.x%2*(this.baseHeight/2))}return this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});return qet=r}function qrt(){if(Jet)return Zet;Jet=1;var t=Hrt(),e=Htt(),i=Xrt(),n=jrt();return Zet=function(s,r,a,o,h,l,u,c){void 0===u&&(u=!0);var d=e(s,r,a,o,null,c),f=[];d.forEach(function(t){var e=new n(t.layer,t.index,t.x,t.y,t.width,t.height,t.baseWidth,t.baseHeight);e.copy(t),f.push(e)});for(var p=h-s,g=l-r,v=0;v<f.length;v++){var m=f[v],y=m.x+p,x=m.y+g;i(y,x,c)&&c.data[x][y]&&(m.x=y,m.y=x,m.updatePixelXY(),c.data[x][y]=m)}u&&t(h-1,l-1,a+2,o+2,c),d.length=0,f.length=0}}function Krt(){if(Qet)return $et;Qet=1;var t=Htt();return $et=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&h[l].index===e&&(h[l].index=i)}}function Zrt(){if(eit)return tit;eit=1;var t=Vu(),e=Htt(),i=Krt();return tit=function(n,s,r,a,o,h){r||(r={}),Array.isArray(n)||(n=[n]);var l=h.tilemapLayer;a||(a=l.scene),o||(o=a.cameras.main);var u,c=h.width,d=h.height,f=e(0,0,c,d,null,h),p=[],g=function(t,e,i){for(var n=0;n<i.length;n++){var s=i[n];t.hasOwnProperty(s)||(t[s]=e[s])}};for(u=0;u<f.length;u++){var v=f[u],m=t(r);if(-1!==n.indexOf(v.index)){var y=l.tileToWorldXY(v.x,v.y,void 0,o,h);m.x=y.x,m.y=y.y,g(m,v,["rotation","flipX","flipY","alpha","visible","tint"]),m.hasOwnProperty("origin")||(m.x+=.5*v.width,m.y+=.5*v.height),m.hasOwnProperty("useSpriteSheet")&&(m.key=v.tileset.image,m.frame=v.index-v.tileset.firstgid),p.push(a.make.sprite(m))}}if(Array.isArray(s))for(u=0;u<n.length;u++)i(n[u],s[u],0,0,c,d,h);else if(null!==s)for(u=0;u<n.length;u++)i(n[u],s,0,0,c,d,h);return p},tit}function Jrt(){if(nit)return iit;nit=1;var t=Fu(),e=bk(),i=Sk(),n=new t;return iit=function(t,s){var r=t.tilemapLayer.tilemap,a=t.tilemapLayer,o=Math.floor(r.tileWidth*a.scaleX),h=Math.floor(r.tileHeight*a.scaleY),l=i(s.worldView.x-a.x,o,0,!0)-a.cullPaddingX,u=e(s.worldView.right-a.x,o,0,!0)+a.cullPaddingX,c=i(s.worldView.y-a.y,h,0,!0)-a.cullPaddingY,d=e(s.worldView.bottom-a.y,h,0,!0)+a.cullPaddingY;return n.setTo(l,c,u-l,d-c)},iit}function $rt(){return rit||(rit=1,sit=function(t,e,i,n){var s,r,a,o=t.data,h=t.width,l=t.height,u=t.tilemapLayer,c=Math.max(0,e.left),d=Math.min(h,e.right),f=Math.max(0,e.top),p=Math.min(l,e.bottom);if(0===i)for(r=f;r<p;r++)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(1===i)for(r=f;r<p;r++)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(2===i)for(r=p;r>=f;r--)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(3===i)for(r=p;r>=f;r--)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);return u.tilesDrawn=n.length,u.tilesTotal=h*l,n}),sit}function Qrt(){if(oit)return ait;oit=1;var t=Jrt(),e=$rt();return ait=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return(a.skipCull||1!==a.scrollFactorX||1!==a.scrollFactorY)&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},ait}function tat(){return lit?hit:(lit=1,hit=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)})}function eat(){if(cit)return uit;cit=1;var t=Htt(),e=Hrt(),i=tat();return uit=function(n,s,r,a,o,h,l){for(var u=-1!==l.collideIndexes.indexOf(n),c=t(s,r,a,o,null,l),d=0;d<c.length;d++)c[d].index=n,i(c[d],u);h&&e(s-1,r-1,a+2,o+2,l)}}function iat(){if(fit)return dit;fit=1;var t=Htt();return dit=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).filter(e,i)}}function nat(){if(mit)return vit;mit=1;var t=Htt();return vit=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).find(e,i)||null}}function sat(){if(xit)return yit;xit=1;var t=Htt();return yit=function(e,i,n,s,r,a,o,h){t(n,s,r,a,o,h).forEach(e,i)}}function rat(){if(Tit)return wit;Tit=1;var t=bk(),e=Sk();return wit=function(i,n){var s,r,a,o,h=i.tilemapLayer.tilemap,l=i.tilemapLayer,u=Math.floor(h.tileWidth*l.scaleX),c=Math.floor(h.tileHeight*l.scaleY),d=i.hexSideLength;if("y"===i.staggerAxis){var f=(c-d)/2+d;s=e(n.worldView.x-l.x,u,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,u,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,f,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,f,0,!0)+l.cullPaddingY}else{var p=(u-d)/2+d;s=e(n.worldView.x-l.x,p,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,p,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,c,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,c,0,!0)+l.cullPaddingY}return{left:s,right:r,top:a,bottom:o}},wit}function aat(){if(Sit)return bit;Sit=1;var t=rat(),e=$rt();return bit=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},bit}function oat(){if(_it)return Eit;_it=1;var t=Vrt();return Eit=function(e,i,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var r,a,o,h=e.tilemapLayer,l=e.data,u=e.width,c=e.height,d=h.skipCull,f=u,p=c;if(0===s)for(a=0;a<p;a++)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(1===s)for(a=0;a<p;a++)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(2===s)for(a=p;a>=0;a--)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(3===s)for(a=p;a>=0;a--)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);return h.tilesDrawn=n.length,h.tilesTotal=u*c,n}}function hat(){if(Ait)return Cit;Ait=1;var t=bk(),e=Sk();return Cit=function(i,n){var s=i.tilemapLayer.tilemap,r=i.tilemapLayer,a=Math.floor(s.tileWidth*r.scaleX),o=Math.floor(s.tileHeight*r.scaleY);return{left:e(n.worldView.x-r.x,a,0,!0)-r.cullPaddingX,right:t(n.worldView.right-r.x,a,0,!0)+r.cullPaddingX,top:e(n.worldView.y-r.y,o/2,0,!0)-r.cullPaddingY,bottom:t(n.worldView.bottom-r.y,o/2,0,!0)+r.cullPaddingY}},Cit}function lat(){if(Mit)return Pit;Mit=1;var t=hat(),e=$rt();return Pit=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},Pit}function uat(){if(Lit)return Rit;Lit=1;var t=Yrt(),e=Qrt(),i=aat(),n=oat(),s=Hh(),r=lat();return Rit=function(a){return a===t.ORTHOGONAL?e:a===t.HEXAGONAL?i:a===t.STAGGERED?r:a===t.ISOMETRIC?n:s}}function cat(){if(Fit)return Oit;Fit=1;var t=Grt(),e=new(Ru());return Oit=function(i,n,s,r,a){return a.tilemapLayer.worldToTileXY(i,n,!0,e,r),t(e.x,e.y,s,a)}}function dat(){if(Iit)return Dit;Iit=1;var t=Ru();return Dit=function(e,i,n,s){var r=s.baseTileWidth,a=s.baseTileHeight,o=s.tilemapLayer,h=0,l=0;o&&(n||(n=o.scene.cameras.main),h=o.x+n.scrollX*(1-o.scrollFactorX),l=o.y+n.scrollY*(1-o.scrollFactorY),r*=o.scaleX,a*=o.scaleY);var u=h+e*r,c=l+i*a;return[new t(u,c),new t(u+r,c),new t(u+r,c+a),new t(u,c+a)]}}function fat(){if(Bit)return kit;Bit=1;var t=Ru();return kit=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),u=h.y+s.scrollY*(1-h.scrollFactorY),a*=h.scaleX,o*=h.scaleY);var c,d,f=a/2,p=o/2,g=r.staggerAxis,v=r.staggerIndex;return"y"===g?(c=l+a*e+a,d=u+1.5*i*p+p,i%2==0&&("odd"===v?c-=f:c+=f)):"x"===g&&"odd"===v&&(c=l+1.5*e*f+f,d=u+o*e+o,e%2==0&&("odd"===v?d-=p:d+=p)),n.set(c,d)},kit}function pat(){if(Uit)return Nit;Uit=1;var t=fat(),e=Ru(),i=new e;return Nit=function(n,s,r,a){var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(o*=l.scaleX,h*=l.scaleY);var u,c,d=t(n,s,i,r,a),f=[],p=.5773502691896257;"y"===a.staggerAxis?(u=p*o,c=h/2):(u=o/2,c=p*h);for(var g=0;g<6;g++){var v=2*Math.PI*(.5-g)/6;f.push(new e(d.x+u*Math.cos(v),d.y+c*Math.sin(v)))}return f},Nit}function gat(){if(Yit)return zit;Yit=1;var t=Yrt(),e=pat(),i=Hh(),n=dat();return zit=function(s){return s===t.ORTHOGONAL?n:s===t.ISOMETRIC?i:s===t.HEXAGONAL?e:(t.STAGGERED,i)}}function vat(){if(Git)return Xit;Git=1;var t=Q4(),e=Htt(),i=O4(),n=Hh(),s=Ru(),r=Yrt(),a=function(t,e){return i.RectangleToTriangle(e,t)},o=new s,h=new s,l=new s;return Xit=function(s,u,c,d){if(d.orientation!==r.ORTHOGONAL)return console.warn("GetTilesWithinShape only works with orthogonal tilemaps"),[];if(void 0===s)return[];var f=n;s instanceof t.Circle?f=i.CircleToRectangle:s instanceof t.Rectangle?f=i.RectangleToRectangle:s instanceof t.Triangle?f=a:s instanceof t.Line&&(f=i.LineToRectangle),d.tilemapLayer.worldToTileXY(s.left,s.top,!0,h,c);var p=h.x,g=h.y;d.tilemapLayer.worldToTileXY(s.right,s.bottom,!1,l,c);var v=Math.ceil(l.x),m=Math.ceil(l.y),y=Math.max(v-p,1),x=Math.max(m-g,1),w=e(p,g,y,x,u,d),T=d.tileWidth,b=d.tileHeight;d.tilemapLayer&&(T*=d.tilemapLayer.scaleX,b*=d.tilemapLayer.scaleY);for(var S=[],E=new t.Rectangle(0,0,T,b),_=0;_<w.length;_++){var C=w[_];d.tilemapLayer.tileToWorldXY(C.x,C.y,o,c),E.x=o.x,E.y=o.y,f(s,E)&&S.push(C)}return S}}function mat(){return Hit?Wit:(Hit=1,Wit=function(t,e,i){var n=i.baseTileWidth,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.x+e.scrollX*(1-s.scrollFactorX),n*=s.scaleX),r+t*n})}function yat(){if(jit)return Vit;jit=1;var t=Yrt(),e=Hh(),i=mat();return Vit=function(n){return n===t.ORTHOGONAL?i:e}}function xat(){if(Kit)return qit;Kit=1;var t=Ru();return qit=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+a/2*(e-i),d=u+(e+i)*(o/2);return n.set(c,d)},qit}function wat(){if(Jit)return Zit;Jit=1;var t=Ru();return Zit=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+e*a+i%2*(a/2),d=u+i*(o/2);return n.set(c,d)},Zit}function Tat(){return Qit?$it:(Qit=1,$it=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*n})}function bat(){if(ent)return tnt;ent=1;var t=mat(),e=Tat(),i=Ru();return tnt=function(n,s,r,a,o){return r||(r=new i(0,0)),r.x=t(n,a,o),r.y=e(s,a,o),r},tnt}function Sat(){if(nnt)return int;nnt=1;var t=Yrt(),e=fat(),i=xat(),n=Hh(),s=wat(),r=bat();return int=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function Eat(){return rnt?snt:(rnt=1,snt=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(void 0===e&&(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*(n/2)+n})}function _at(){if(ont)return ant;ont=1;var t=Yrt(),e=Hh(),i=Eat(),n=Tat();return ant=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function Cat(){return lnt?hnt:(lnt=1,hnt=function(){return null})}function Aat(){if(cnt)return unt;cnt=1;var t=Ru();return unt=function(e,i,n,s,r,a){void 0===n&&(n=!0),s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u=e/o,c=i/h;return n&&(u=Math.floor(u),c=Math.floor(c)),s.set(u,c)},unt}function Pat(){if(fnt)return dnt;fnt=1;var t=Aat(),e=new(Ru());return dnt=function(i,n,s,r){return t(i,0,n,e,s,r),e.x}}function Mat(){if(gnt)return pnt;gnt=1;var t=Yrt(),e=Cat(),i=Pat();return pnt=function(n){return n===t.ORTHOGONAL?i:e}}function Rat(){if(mnt)return vnt;mnt=1;var t=Ru();return vnt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u,c,d,f,p,g=.5773502691896257,v=-.3333333333333333,m=.6666666666666666,y=o/2,x=h/2;"y"===a.staggerAxis?(d=g*(u=(e-y)/(g*o))+v*(c=(i-x)/x),f=0*u+m*c):(d=v*(u=(e-y)/y)+g*(c=(i-x)/(g*h)),f=m*u+0*c),p=-d-f;var w,T=Math.round(d),b=Math.round(f),S=Math.round(p),E=Math.abs(T-d),_=Math.abs(b-f),C=Math.abs(S-p);E>_&&E>C?T=-b-S:_>C&&(b=-T-S);var A=b;return w="odd"===a.staggerIndex?A%2==0?b/2+T:b/2+T-.5:A%2==0?b/2+T:b/2+T+.5,s.set(w,A)},vnt}function Lat(){if(xnt)return ynt;xnt=1;var t=Ru();return ynt=function(e,i,n,s,r,a,o){s||(s=new t);var h=a.baseTileWidth,l=a.baseTileHeight,u=a.tilemapLayer;u&&(r||(r=u.scene.cameras.main),i-=u.y+r.scrollY*(1-u.scrollFactorY),l*=u.scaleY,e-=u.x+r.scrollX*(1-u.scrollFactorX),h*=u.scaleX);var c=h/2,d=l/2;o||(i-=l);var f=.5*((e-=c)/c+i/d),p=.5*(-e/c+i/d);return n&&(f=Math.floor(f),p=Math.floor(p)),s.set(f,p)},ynt}function Oat(){if(Tnt)return wnt;Tnt=1;var t=Ru();return wnt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),i-=l.y+r.scrollY*(1-l.scrollFactorY),h*=l.scaleY,e-=l.x+r.scrollX*(1-l.scrollFactorX),o*=l.scaleX);var u=n?Math.floor(i/(h/2)):i/(h/2),c=n?Math.floor((e+u%2*.5*o)/o):(e+u%2*.5*o)/o;return s.set(c,u)},wnt}function Fat(){if(Snt)return bnt;Snt=1;var t=Yrt(),e=Rat(),i=Lat(),n=Hh(),s=Oat(),r=Aat();return bnt=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function Dat(){return _nt?Ent:(_nt=1,Ent=function(t,e,i,n){var s=n.baseTileHeight,r=n.tilemapLayer;return r&&(i||(i=r.scene.cameras.main),t-=r.y+i.scrollY*(1-r.scrollFactorY),s*=r.scaleY),e?Math.floor(t/(s/2)):t/(s/2)})}function Iat(){if(Ant)return Cnt;Ant=1;var t=Aat(),e=new(Ru());return Cnt=function(i,n,s,r){return t(0,i,n,e,s,r),e.y}}function kat(){if(Mnt)return Pnt;Mnt=1;var t=Yrt(),e=Cat(),i=Dat(),n=Iat();return Pnt=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function Bat(){if(Lnt)return Rnt;Lnt=1;var t=Xrt();return Rnt=function(e,i,n){if(t(e,i,n)){var s=n.data[i][e];return null!==s&&s.index>-1}return!1}}function Nat(){if(Fnt)return Ont;Fnt=1;var t=Bat(),e=new(Ru());return Ont=function(i,n,s,r){r.tilemapLayer.worldToTileXY(i,n,!0,e,s);var a=e.x,o=e.y;return t(a,o,r)}}function Uat(){if(Int)return Dnt;Int=1;var t=jrt(),e=Xrt(),i=Wrt(),n=tat();return Dnt=function(s,r,a,o,h){if(void 0===o&&(o=!0),!e(r,a,h))return null;var l,u=h.data[a][r],c=u&&u.collides;s instanceof t?(null===h.data[a][r]&&(h.data[a][r]=new t(h,s.index,r,a,h.tileWidth,h.tileHeight)),h.data[a][r].copy(s)):(l=s,null===h.data[a][r]?h.data[a][r]=new t(h,l,r,a,h.tileWidth,h.tileHeight):h.data[a][r].index=l);var d=h.data[a][r],f=-1!==h.collideIndexes.indexOf(d.index);if(-1===(l=s instanceof t?s.index:s))d.width=h.tileWidth,d.height=h.tileHeight;else{var p=h.tilemapLayer.tilemap,g=p.tiles[l][2],v=p.tilesets[g];d.width=v.tileWidth,d.height=v.tileHeight}return n(d,f),o&&c!==d.collides&&i(r,a,h),d},Dnt}function zat(){if(Bnt)return knt;Bnt=1;var t=Uat(),e=new(Ru());return knt=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(n,s,!0,e,a,o),t(i,e.x,e.y,r,o)}}function Yat(){if(Unt)return Nnt;Unt=1;var t=Hrt(),e=Uat();return Nnt=function(i,n,s,r,a){if(void 0===r&&(r=!0),!Array.isArray(i))return null;Array.isArray(i[0])||(i=[i]);for(var o=i.length,h=i[0].length,l=0;l<o;l++)for(var u=0;u<h;u++){var c=i[l][u];e(c,n+u,s+l,!1,a)}r&&t(n-1,s-1,h+2,o+2,a)}}function Xat(){if(Ynt)return znt;Ynt=1;var t=Htt(),e=Al();return znt=function(i,n,s,r,a,o){var h,l=t(i,n,s,r,{},o);if(!a)for(a=[],h=0;h<l.length;h++)-1===a.indexOf(l[h].index)&&a.push(l[h].index);for(h=0;h<l.length;h++)l[h].index=e(a)}}function Gat(){if(Gnt)return Xnt;Gnt=1;var t=jrt(),e=Xrt(),i=Wrt();return Xnt=function(n,s,r,a,o){if(void 0===r&&(r=!0),void 0===a&&(a=!0),!e(n,s,o))return null;var h=o.data[s][n];return h?(o.data[s][n]=r?null:new t(o,-1,n,s,o.tileWidth,o.tileHeight),a&&h&&h.collides&&i(n,s,o),h):null}}function Wat(){if(Hnt)return Wnt;Hnt=1;var t=Gat(),e=new(Ru());return Wnt=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(i,n,!0,e,a,o),t(e.x,e.y,s,r,o)}}function Hat(){if(jnt)return Vnt;jnt=1;var t=Htt(),e=LN(),i=new e(105,210,231,150),n=new e(243,134,48,200),s=new e(40,39,37,150);return Vnt=function(e,r,a){void 0===r&&(r={});var o=void 0!==r.tileColor?r.tileColor:i,h=void 0!==r.collidingTileColor?r.collidingTileColor:n,l=void 0!==r.faceColor?r.faceColor:s,u=t(0,0,a.width,a.height,null,a);e.translateCanvas(a.tilemapLayer.x,a.tilemapLayer.y),e.scaleCanvas(a.tilemapLayer.scaleX,a.tilemapLayer.scaleY);for(var c=0;c<u.length;c++){var d=u[c],f=d.tileset?d.tileset.tileOffset:{x:0,y:0},p=d.width,g=d.height,v=d.pixelX-f.x,m=d.pixelY-f.y,y=d.collides?h:o;null!==y&&(e.fillStyle(y.color,y.alpha/255),e.fillRect(v,m,p,g)),v+=1,m+=1,p-=2,g-=2,null!==l&&(e.lineStyle(1,l.color,l.alpha/255),d.faceTop&&e.lineBetween(v,m,v+p,m),d.faceRight&&e.lineBetween(v+p,m,v+p,m+g),d.faceBottom&&e.lineBetween(v,m+g,v+p,m+g),d.faceLeft&&e.lineBetween(v,m,v,m+g))}},Vnt}function Vat(){return Knt?qnt:(Knt=1,qnt=function(t,e,i){var n=i.collideIndexes.indexOf(t);e&&-1===n?i.collideIndexes.push(t):e||-1===n||i.collideIndexes.splice(n,1)})}function jat(){if(Jnt)return Znt;Jnt=1;var t=tat(),e=Hrt(),i=Vat();return Znt=function(n,s,r,a,o){void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),Array.isArray(n)||(n=[n]);for(var h=0;h<n.length;h++)i(n[h],s,a);if(o)for(var l=0;l<a.height;l++)for(var u=0;u<a.width;u++){var c=a.data[l][u];c&&-1!==n.indexOf(c.index)&&t(c,s)}r&&e(0,0,a.width,a.height,a)}}function qat(){if(Qnt)return $nt;Qnt=1;var t=tat(),e=Hrt(),i=Vat();return $nt=function(n,s,r,a,o,h){if(void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===h&&(h=!0),!(n>s)){for(var l=n;l<=s;l++)i(l,r,o);if(h)for(var u=0;u<o.height;u++)for(var c=0;c<o.width;c++){var d=o.data[u][c];d&&d.index>=n&&d.index<=s&&t(d,r)}a&&e(0,0,o.width,o.height,o)}}}function Kat(){if(est)return tst;est=1;var t=tat(),e=Hrt(),i=Vat();return tst=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0),Array.isArray(n)||(n=[n]);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];l&&-1===n.indexOf(l.index)&&(t(l,s),i(l.index,s,a))}r&&e(0,0,a.width,a.height,a)}}function Zat(){if(nst)return ist;nst=1;var t=tat(),e=Hrt(),i=hV();return ist=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];if(l)for(var u in n)if(i(l.properties,u)){var c=n[u];Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;d++)l.properties[u]===c[d]&&t(l,s)}}r&&e(0,0,a.width,a.height,a)}}function Jat(){if(rst)return sst;rst=1;var t=tat(),e=Hrt();return sst=function(i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);for(var r=0;r<s.height;r++)for(var a=0;a<s.width;a++){var o=s.data[r][a];if(o){var h=o.getCollisionGroup();h&&h.objects&&h.objects.length>0&&t(o,i)}}n&&e(0,0,s.width,s.height,s)}}function $at(){if(lst)return hst;lst=1;var t=Htt();return hst=function(e,i,n,s,r,a,o){for(var h=t(e,i,n,s,null,o),l=0;l<h.length;l++)h[l].setCollisionCallback(r,a)}}function Qat(){if(cst)return ust;cst=1;var t=Htt(),e=Fl();return ust=function(i,n,s,r,a){var o=t(i,n,s,r,null,a),h=o.map(function(t){return t.index});e(h);for(var l=0;l<o.length;l++)o[l].index=h[l]}}function tot(){if(fst)return dst;fst=1;var t=Htt();return dst=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&(h[l].index===e?h[l].index=i:h[l].index===i&&(h[l].index=e))}}function eot(){if(gst)return pst;gst=1;var t=Htt(),e=kk();return pst=function(i,n,s,r,a,o){if(a){var h,l=t(i,n,s,r,null,o),u=0;for(h=0;h<a.length;h++)u+=a[h].weight;if(!(u<=0))for(h=0;h<l.length;h++){for(var c=e.RND.frac()*u,d=0,f=-1,p=0;p<a.length;p++)if(c<=(d+=a[p].weight)){var g=a[p].index;f=Array.isArray(g)?g[Math.floor(e.RND.frac()*g.length)]:g;break}l[h].index=f}}}}function iot(){return mst?vst:(mst=1,vst={CalculateFacesAt:Wrt(),CalculateFacesWithin:Hrt(),CheckIsoBounds:Vrt(),Copy:qrt(),CreateFromTiles:Zrt(),CullBounds:Jrt(),CullTiles:Qrt(),Fill:eat(),FilterTiles:iat(),FindByIndex:git?pit:(git=1,pit=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=!1);var s,r,a,o=0;if(i){for(r=n.height-1;r>=0;r--)for(s=n.width-1;s>=0;s--)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}}else for(r=0;r<n.height;r++)for(s=0;s<n.width;s++)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}return null}),FindTile:nat(),ForEachTile:sat(),GetCullTilesFunction:uat(),GetTileAt:Grt(),GetTileAtWorldXY:cat(),GetTileCorners:dat(),GetTileCornersFunction:gat(),GetTilesWithin:Htt(),GetTilesWithinShape:vat(),GetTilesWithinWorldXY:Vtt(),GetTileToWorldXFunction:yat(),GetTileToWorldXYFunction:Sat(),GetTileToWorldYFunction:_at(),GetWorldToTileXFunction:Mat(),GetWorldToTileXYFunction:Fat(),GetWorldToTileYFunction:kat(),HasTileAt:Bat(),HasTileAtWorldXY:Nat(),HexagonalCullBounds:rat(),HexagonalCullTiles:aat(),HexagonalGetTileCorners:pat(),HexagonalTileToWorldXY:fat(),HexagonalWorldToTileXY:Rat(),IsInLayerBounds:Xrt(),IsometricCullTiles:oat(),IsometricTileToWorldXY:xat(),IsometricWorldToTileXY:Lat(),PutTileAt:Uat(),PutTileAtWorldXY:zat(),PutTilesAt:Yat(),Randomize:Xat(),RemoveTileAt:Gat(),RemoveTileAtWorldXY:Wat(),RenderDebug:Hat(),ReplaceByIndex:Krt(),RunCull:$rt(),SetCollision:jat(),SetCollisionBetween:qat(),SetCollisionByExclusion:Kat(),SetCollisionByProperty:Zat(),SetCollisionFromCollisionGroup:Jat(),SetLayerCollisionIndex:Vat(),SetTileCollision:tat(),SetTileIndexCallback:ost?ast:(ost=1,ast=function(t,e,i,n){if("number"==typeof t)n.callbacks[t]=null!==e?{callback:e,callbackContext:i}:void 0;else for(var s=0,r=t.length;s<r;s++)n.callbacks[t[s]]=null!==e?{callback:e,callbackContext:i}:void 0}),SetTileLocationCallback:$at(),Shuffle:Qat(),StaggeredCullBounds:hat(),StaggeredCullTiles:lat(),StaggeredTileToWorldXY:wat(),StaggeredTileToWorldY:Eat(),StaggeredWorldToTileXY:Oat(),StaggeredWorldToTileY:Dat(),SwapByIndex:tot(),TileToWorldX:mat(),TileToWorldXY:bat(),TileToWorldY:Tat(),WeightedRandomize:eot(),WorldToTileX:Pat(),WorldToTileXY:Aat(),WorldToTileY:Iat()})}function not(){if(xst)return yst;xst=1;var t=Yrt();return yst=function(e){return"isometric"===(e=e.toLowerCase())?t.ISOMETRIC:"staggered"===e?t.STAGGERED:"hexagonal"===e?t.HEXAGONAL:t.ORTHOGONAL}}function sot(){if(Tst)return wst;Tst=1;var t=Vh(),e=Yrt(),i=Wh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","layer"),this.id=i(t,"id",0),this.x=i(t,"x",0),this.y=i(t,"y",0),this.width=i(t,"width",0),this.height=i(t,"height",0),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.baseTileWidth=i(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=i(t,"baseTileHeight",this.tileHeight),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.widthInPixels=i(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=i(t,"alpha",1),this.visible=i(t,"visible",!0),this.properties=i(t,"properties",[]),this.indexes=i(t,"indexes",[]),this.collideIndexes=i(t,"collideIndexes",[]),this.callbacks=i(t,"callbacks",[]),this.bodies=i(t,"bodies",[]),this.data=i(t,"data",[]),this.tilemapLayer=i(t,"tilemapLayer",null),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return wst=n}function rot(){if(Sst)return bst;Sst=1;var t=Vh(),e=Yrt(),i=Wh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","map"),this.width=i(t,"width",0),this.height=i(t,"height",0),this.infinite=i(t,"infinite",!1),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.widthInPixels=i(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.tileHeight),this.format=i(t,"format",null),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.renderOrder=i(t,"renderOrder","right-down"),this.version=i(t,"version","1"),this.properties=i(t,"properties",{}),this.layers=i(t,"layers",[]),this.images=i(t,"images",[]),this.objects=i(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[]),this.collision=i(t,"collision",{}),this.tilesets=i(t,"tilesets",[]),this.imageCollections=i(t,"imageCollections",[]),this.tiles=i(t,"tiles",[]),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return bst=n}function aot(){if(_st)return Est;_st=1;var t=xtt(),e=sot(),i=rot(),n=jrt();return Est=function(s,r,a,o,h){for(var l=new e({tileWidth:a,tileHeight:o}),u=new i({name:s,tileWidth:a,tileHeight:o,format:t.ARRAY_2D,layers:[l]}),c=[],d=r.length,f=0,p=0;p<r.length;p++){c[p]=[];for(var g=r[p],v=0;v<g.length;v++){var m=parseInt(g[v],10);isNaN(m)||-1===m?c[p][v]=h?null:new n(l,-1,v,p,a,o):c[p][v]=new n(l,m,v,p,a,o)}0===f&&(f=g.length)}return u.width=l.width=f,u.height=l.height=d,u.widthInPixels=l.widthInPixels=f*a,u.heightInPixels=l.heightInPixels=d*o,l.data=c,u},Est}function oot(){if(Ast)return Cst;Ast=1;var t=xtt(),e=aot();return Cst=function(i,n,s,r,a){var o=n.trim().split("\n").map(function(t){return t.split(",")}),h=e(i,o,s,r,a);return h.format=t.CSV,h},Cst}function hot(){if(Mst)return Pst;Mst=1;var t=nh();return Pst=function(e){for(var i,n,s,r,a,o=0;o<e.layers.length;o++){i=e.layers[o],r=null;for(var h=0;h<i.data.length;h++){a=i.data[h];for(var l=0;l<a.length;l++)null===(n=a[l])||n.index<0||(s=e.tiles[n.index][2],r=e.tilesets[s],n.width=r.tileWidth,n.height=r.tileHeight,r.tileProperties&&r.tileProperties[n.index-r.firstgid]&&(n.properties=t(n.properties,r.tileProperties[n.index-r.firstgid])))}}}}function lot(){if(Lst)return Rst;Lst=1;var t=Vh(),e=Ru(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){(void 0===n||n<=0)&&(n=32),(void 0===s||s<=0)&&(s=32),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o={}),void 0===h&&(h={}),this.name=t,this.firstgid=i,this.tileWidth=n,this.tileHeight=s,this.tileMargin=r,this.tileSpacing=a,this.tileProperties=o,this.tileData=h,this.tileOffset=new e,void 0!==l&&this.tileOffset.set(l.x,l.y),this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){this.image=t;var e=t.get(),i=t.getFrameBounds();return this.glTexture=e.source.glTexture,e.width>i.width||e.height>i.height?this.updateTileData(e.width,e.height):this.updateTileData(i.width,i.height,i.x,i.y),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var s=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),r=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);s%1==0&&r%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),s=Math.floor(s),r=Math.floor(r),this.rows=s,this.columns=r,this.total=s*r,this.texCoordinates.length=0;for(var a=this.tileMargin+i,o=this.tileMargin+n,h=0;h<this.rows;h++){for(var l=0;l<this.columns;l++)this.texCoordinates.push({x:a,y:o}),a+=this.tileWidth+this.tileSpacing;a=this.tileMargin+i,o+=this.tileHeight+this.tileSpacing}return this}});return Rst=i}function uot(){if(Fst)return Ost;Fst=1;var t=lot();return Ost=function(e){var i,n,s=[];for(i=0;i<e.imageCollections.length;i++)for(var r=e.imageCollections[i].images,a=0;a<r.length;a++){var o=r[a],h={x:0,y:o.height-e.tileHeight};(n=new t(o.image,o.gid,o.width,o.height,0,0,void 0,void 0,h)).updateTileData(o.width,o.height),e.tilesets.push(n)}for(i=0;i<e.tilesets.length;i++)for(var l=(n=e.tilesets[i]).tileMargin,u=n.tileMargin,c=0,d=0,f=0,p=n.firstgid;p<n.firstgid+n.total&&(s[p]=[l,u,i],l+=n.tileWidth+n.tileSpacing,++c!==n.total)&&(++d!==n.columns||(l=n.tileMargin,u+=n.tileHeight+n.tileSpacing,d=0,++f!==n.rows));p++);return s}}function cot(){if(Ist)return Dst;Ist=1;var t=Wh();return Dst=function(e,i,n){if(!i)return{i:0,layers:e.layers,name:"",opacity:1,visible:!0,x:0,y:0};var s=i.x+t(i,"startx",0)*e.tilewidth+t(i,"offsetx",0),r=i.y+t(i,"starty",0)*e.tileheight+t(i,"offsety",0);return{i:0,layers:i.layers,name:n.name+i.name+"/",opacity:n.opacity*i.opacity,visible:n.visible&&i.visible,x:n.x+s,y:n.y+r}}}function dot(){if(Bst)return kst;Bst=1;var t=Wh(),e=cot();return kst=function(i){for(var n=[],s=[],r=e(i);r.i<r.layers.length||s.length>0;)if(r.i>=r.layers.length){if(s.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}r=s.pop()}else{var a=r.layers[r.i];if(r.i++,"imagelayer"===a.type){var o=t(a,"offsetx",0)+t(a,"startx",0),h=t(a,"offsety",0)+t(a,"starty",0);n.push({name:r.name+a.name,image:a.image,x:r.x+o+a.x,y:r.y+h+a.y,alpha:r.opacity*a.opacity,visible:r.visible&&a.visible,properties:t(a,"properties",{})})}else if("group"===a.type){var l=e(i,a,r);s.push(r),r=l}}return n}}function fot(){if(Ust)return Nst;Ust=1;var t=hV();return Nst=function(e,i){for(var n={},s=0;s<i.length;s++){var r=i[s];t(e,r)&&(n[r]=e[r])}return n},Nst}function pot(){if(Yst)return zst;Yst=1;return zst=function(t){var e=Boolean(2147483648&t),i=Boolean(1073741824&t),n=Boolean(536870912&t);t&=536870911;var s=0,r=!1;return e&&i&&n?(s=Math.PI/2,r=!0):e&&i&&!n?(s=Math.PI,r=!1):e&&!i&&n?(s=Math.PI/2,r=!1):!e||i||n?!e&&i&&n?(s=3*Math.PI/2,r=!1):e||!i||n?e||i||!n?e||i||n||(s=0,r=!1):(s=3*Math.PI/2,r=!0):(s=Math.PI,r=!0):(s=0,r=!0),{gid:t,flippedHorizontal:e,flippedVertical:i,flippedAntiDiagonal:n,rotation:s,flipped:r}}}function got(){if(Gst)return Xst;Gst=1;var t=fot(),e=pot(),i=function(t){return{x:t.x,y:t.y}},n=["id","name","type","rotation","properties","visible","x","y","width","height"];return Xst=function(s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o=t(s,n);if(o.x+=r,o.y+=a,s.gid){var h=e(s.gid);o.gid=h.gid,o.flippedHorizontal=h.flippedHorizontal,o.flippedVertical=h.flippedVertical,o.flippedAntiDiagonal=h.flippedAntiDiagonal}else s.polyline?o.polyline=s.polyline.map(i):s.polygon?o.polygon=s.polygon.map(i):s.ellipse?o.ellipse=s.ellipse:s.text?o.text=s.text:s.point?o.point=!0:o.rectangle=!0;return o}}function vot(){if(Hst)return Wst;Hst=1;var t=Vh(),e=Wh(),i=new t({initialize:function(t){void 0===t&&(t={}),this.name=e(t,"name","object layer"),this.id=e(t,"id",0),this.opacity=e(t,"opacity",1),this.properties=e(t,"properties",{}),this.propertyTypes=e(t,"propertytypes",{}),this.type=e(t,"type","objectgroup"),this.visible=e(t,"visible",!0),this.objects=e(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[])}});return Wst=i}function mot(){if(jst)return Vst;jst=1;var t=Wh(),e=got(),i=vot(),n=cot();return Vst=function(s){for(var r=[],a=[],o=n(s);o.i<o.layers.length||a.length>0;)if(o.i>=o.layers.length){if(a.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}o=a.pop()}else{var h=o.layers[o.i];if(o.i++,h.opacity*=o.opacity,h.visible=o.visible&&h.visible,"objectgroup"===h.type){h.name=o.name+h.name;for(var l=o.x+t(h,"startx",0)+t(h,"offsetx",0),u=o.y+t(h,"starty",0)+t(h,"offsety",0),c=[],d=0;d<h.objects.length;d++){var f=e(h.objects[d],l,u);c.push(f)}var p=new i(h);p.objects=c,r.push(p)}else if("group"===h.type){var g=n(s,h,o);a.push(o),o=g}}return r}}function yot(){return Kst||(Kst=1,qst=function(t){for(var e=window.atob(t),i=e.length,n=new Array(i/4),s=0;s<i;s+=4)n[s/4]=(e.charCodeAt(s)|e.charCodeAt(s+1)<<8|e.charCodeAt(s+2)<<16|e.charCodeAt(s+3)<<24)>>>0;return n}),qst}function xot(){if(Jst)return Zst;Jst=1;var t=yot(),e=Yrt(),i=cot(),n=not(),s=Wh(),r=sot(),a=pot(),o=jrt();return Zst=function(h,l){for(var u=s(h,"infinite",!1),c=[],d=[],f=i(h);f.i<f.layers.length||d.length>0;)if(f.i>=f.layers.length){if(d.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}f=d.pop()}else{var p=f.layers[f.i];if(f.i++,"tilelayer"===p.type)if(p.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+p.name+"'");else{if(p.encoding&&"base64"===p.encoding){if(p.chunks)for(var g=0;g<p.chunks.length;g++)p.chunks[g].data=t(p.chunks[g].data);p.data&&(p.data=t(p.data)),delete p.encoding}var v,m,y,x,w,T,b=[],S=0;if(u){var E=s(p,"startx",0)+p.x,_=s(p,"starty",0)+p.y;(v=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+E*h.tilewidth,y:f.y+s(p,"offsety",0)+_*h.tileheight,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(v.hexSideLength=h.hexsidelength,v.staggerAxis=h.staggeraxis,v.staggerIndex=h.staggerindex,"y"===v.staggerAxis?(w=(v.tileHeight-v.hexSideLength)/2,v.widthInPixels=v.tileWidth*(v.width+.5),v.heightInPixels=v.height*(v.hexSideLength+w)+w):(T=(v.tileWidth-v.hexSideLength)/2,v.widthInPixels=v.width*(v.hexSideLength+T)+T,v.heightInPixels=v.tileHeight*(v.height+.5)));for(var C=0;C<p.height;C++){b[C]=[null];for(var A=0;A<p.width;A++)b[C][A]=null}for(C=0,N=p.chunks.length;C<N;C++)for(var P=p.chunks[C],M=P.x-E,R=P.y-_,L=0,O=0,F=P.data.length;O<F;O++){var D=S+M,I=L+R;(m=a(P.data[O])).gid>0?((y=new o(v,m.gid,D,I,h.tilewidth,h.tileheight)).rotation=m.rotation,y.flipX=m.flipped,b[I][D]=y):(x=l?null:new o(v,-1,D,I,h.tilewidth,h.tileheight),b[I][D]=x),++S===P.width&&(L++,S=0)}}else{(v=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+p.x,y:f.y+s(p,"offsety",0)+p.y,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(v.hexSideLength=h.hexsidelength,v.staggerAxis=h.staggeraxis,v.staggerIndex=h.staggerindex,"y"===v.staggerAxis?(w=(v.tileHeight-v.hexSideLength)/2,v.widthInPixels=v.tileWidth*(v.width+.5),v.heightInPixels=v.height*(v.hexSideLength+w)+w):(T=(v.tileWidth-v.hexSideLength)/2,v.widthInPixels=v.width*(v.hexSideLength+T)+T,v.heightInPixels=v.tileHeight*(v.height+.5)));for(var k=[],B=0,N=p.data.length;B<N;B++)(m=a(p.data[B])).gid>0?((y=new o(v,m.gid,S,b.length,h.tilewidth,h.tileheight)).rotation=m.rotation,y.flipX=m.flipped,k.push(y)):(x=l?null:new o(v,-1,S,b.length,h.tilewidth,h.tileheight),k.push(x)),++S===p.width&&(b.push(k),S=0,k=[])}v.data=b,c.push(v)}else if("group"===p.type){var U=i(h,p,f);d.push(f),f=U}}return c}}function wot(){if(Qst)return $st;Qst=1;var t=new(Vh())({initialize:function(t,e,i,n,s,r,a){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===s&&(s=0),void 0===r&&(r=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|i,this.imageHeight=0|n,this.imageMargin=0|s,this.imageSpacing=0|r,this.properties=a||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e,i,n){return this.images.push({gid:t,image:e,width:i,height:n}),this.total++,this}});return $st=t}function Tot(){if(nrt)return irt;nrt=1;var t=lot(),e=wot(),i=got(),n=(ert||(ert=1,trt=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],s=i;if(n.name&&""!==n.name&&(s=n.name),Array.isArray(n.wangtiles)&&n.wangtiles.length>0){var r,a,o,h={},l={};if(Array.isArray(n.edgecolors))for(r=0;r<n.edgecolors.length;r++)o=1+r,""!==(a=n.edgecolors[r]).name&&(h[o]=a.name);if(Array.isArray(n.cornercolors))for(r=0;r<n.cornercolors.length;r++)o=1+r,""!==(a=n.cornercolors[r]).name&&(l[o]=a.name);if(Array.isArray(n.colors))for(r=0;r<n.colors.length;r++)o=1+r,""!==(a=n.colors[r]).name&&(h[o]=l[o]=a.name);for(var u=[h,l,h,l,h,l,h,l],c=0;c<n.wangtiles.length;c++){var d=n.wangtiles[c],f=e[d.tileid]||(e[d.tileid]={});f=f.wangid||(f.wangid={});for(var p=[],g=0;g<Math.min(u.length,d.wangid.length);g++)if(0!==(a=d.wangid[g])){var v=u[g][a];void 0===v?p.push(a):p.push(v)}else p.push(void 0);f[s]=p}}}}),trt);return irt=function(s){for(var r,a=[],o=[],h=null,l=0;l<s.tilesets.length;l++){var u=s.tilesets[l];if(u.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(u.image){var c=new t(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,void 0,void 0,u.tileoffset);if(s.version>1){var d=void 0,f=void 0;if(Array.isArray(u.tiles)){d=d||{},f=f||{};for(var p=0;p<u.tiles.length;p++){var g=u.tiles[p];if(g.properties){var v={};g.properties.forEach(function(t){v[t.name]=t.value}),f[g.id]=v}if(g.objectgroup&&((d[g.id]||(d[g.id]={})).objectgroup=g.objectgroup,g.objectgroup.objects)){var m=g.objectgroup.objects.map(function(t){return i(t)});d[g.id].objectgroup.objects=m}g.animation&&((d[g.id]||(d[g.id]={})).animation=g.animation),g.type&&((d[g.id]||(d[g.id]={})).type=g.type)}}Array.isArray(u.wangsets)&&(d=d||{},f=f||{},n(u.wangsets,d)),d&&(c.tileData=d,c.tileProperties=f)}else if(u.tileproperties&&(c.tileProperties=u.tileproperties),u.tiles)for(r in c.tileData=u.tiles,c.tileData){var y=c.tileData[r].objectgroup;if(y&&y.objects){var x=y.objects.map(function(t){return i(t)});c.tileData[r].objectgroup.objects=x}}c.updateTileData(u.imagewidth,u.imageheight),a.push(c)}else{var w=new e(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,u.properties),T=0;for(p=0;p<u.tiles.length;p++){var b=(g=u.tiles[p]).image,S=parseInt(g.id,10),E=u.firstgid+S,_=g.imagewidth,C=g.imageheight;w.addImage(E,b,_,C),T=Math.max(S,T)}w.maxId=T,o.push(w)}h&&(h.lastgid=u.firstgid-1),h=u}return{tilesets:a,imageCollections:o}}}function bot(){if(rrt)return srt;rrt=1;var t=hot(),e=uot(),i=Yrt(),n=Vu(),s=xtt(),r=not(),a=rot(),o=dot(),h=mot(),l=xot(),u=Tot();return srt=function(c,d,f){var p=n(d),g=new a({width:p.width,height:p.height,name:c,tileWidth:p.tilewidth,tileHeight:p.tileheight,orientation:r(p.orientation),format:s.TILED_JSON,version:p.version,properties:p.properties,renderOrder:p.renderorder,infinite:p.infinite});if(g.orientation===i.HEXAGONAL)if(g.hexSideLength=p.hexsidelength,g.staggerAxis=p.staggeraxis,g.staggerIndex=p.staggerindex,"y"===g.staggerAxis){var v=(g.tileHeight-g.hexSideLength)/2;g.widthInPixels=g.tileWidth*(g.width+.5),g.heightInPixels=g.height*(g.hexSideLength+v)+v}else{var m=(g.tileWidth-g.hexSideLength)/2;g.widthInPixels=g.width*(g.hexSideLength+m)+m,g.heightInPixels=g.tileHeight*(g.height+.5)}g.layers=l(p,f),g.images=o(p);var y=u(p);return g.tilesets=y.tilesets,g.imageCollections=y.imageCollections,g.objects=h(p),g.tiles=e(g),t(g),g}}function Sot(){if(ort)return art;ort=1;var t=sot(),e=jrt();return art=function(i,n){for(var s=[],r=0;r<i.layer.length;r++){for(var a=i.layer[r],o=new t({name:a.name,width:a.width,height:a.height,tileWidth:a.tilesize,tileHeight:a.tilesize,visible:1===a.visible}),h=[],l=[],u=0;u<a.data.length;u++){for(var c=0;c<a.data[u].length;c++){var d,f=a.data[u][c]-1;d=f>-1?new e(o,f,c,u,a.tilesize,a.tilesize):n?null:new e(o,-1,c,u,a.tilesize,a.tilesize),h.push(d)}l.push(h),h=[]}o.data=l,s.push(o)}return s}}function Eot(){if(lrt)return hrt;lrt=1;var t=lot();return hrt=function(e){for(var i=[],n=[],s=0;s<e.layer.length;s++){var r=e.layer[s],a=r.tilesetName;""!==a&&-1===n.indexOf(a)&&(n.push(a),i.push(new t(a,0,r.tilesize,r.tilesize,0,0)))}return i}}function _ot(){if(crt)return urt;crt=1;var t=xtt(),e=rot(),i=Sot(),n=Eot();return urt=function(s,r,a){if(0===r.layer.length)return console.warn("No layers found in the Weltmeister map: "+s),null;for(var o=0,h=0,l=0;l<r.layer.length;l++)r.layer[l].width>o&&(o=r.layer[l].width),r.layer[l].height>h&&(h=r.layer[l].height);var u=new e({width:o,height:h,name:s,tileWidth:r.layer[0].tilesize,tileHeight:r.layer[0].tilesize,format:t.WELTMEISTER});return u.layers=i(r,a),u.tilesets=n(r),u}}function Cot(){if(frt)return drt;frt=1;var t=xtt(),e=aot(),i=oot(),n=bot(),s=_ot();return drt=function(r,a,o,h,l,u){var c;switch(a){case t.ARRAY_2D:c=e(r,o,h,l,u);break;case t.CSV:c=i(r,o,h,l,u);break;case t.TILED_JSON:c=n(r,o,u);break;case t.WELTMEISTER:c=s(r,o,u);break;default:console.warn("Unrecognized tilemap data format: "+a),c=null}return c},drt}function Aot(){if(Mrt)return Prt;Mrt=1;var t=Vh(),e=Mtt(),i=ac(),n=ZF(),s=iot(),r=function(){if(Art)return Crt;Art=1;var t,e;Hh();return t=function(){if(Srt)return brt;Srt=1;var t=Zk();return brt=function(e,i,n){var s=i.cull(n),r=s.length,a=n.alpha*i.alpha;if(!(0===r||a<=0)){var o=i.gidMap,h=e.pipelines.set(i.pipeline,i),l=t.getTintAppendFloatAlpha,u=i.scrollFactorX,c=i.scrollFactorY,d=i.x,f=i.y,p=i.scaleX,g=i.scaleY;e.pipelines.preBatch(i);for(var v=0;v<r;v++){var m=s[v],y=o[m.index];if(y){var x=y.getTileTextureCoordinates(m.index),w=y.tileWidth,T=y.tileHeight;if(x&&0!==w&&0!==T){var b=.5*w,S=.5*T,E=y.glTexture,_=h.setTexture2D(E,i),C=w,A=T,P=x.x,M=x.y,R=y.tileOffset.x,L=y.tileOffset.y,O=l(m.tint,a*m.alpha);h.batchTexture(i,E,E.width,E.height,d+m.pixelX*p+(b*p-R),f+m.pixelY*g+(S*g-L),w,T,p,g,m.rotation,m.flipX,m.flipY,u,c,b,S,P,M,C,A,O,O,O,O,m.tintFill,0,0,n,null,!0,_,!0)}}}e.pipelines.postBatch(i)}},brt}(),e=function(){if(_rt)return Ert;_rt=1;var t=tc(),e=new t,i=new t,n=new t;return Ert=function(t,s,r,a){var o=s.cull(r),h=o.length,l=r.alpha*s.alpha;if(!(0===h||l<=0)){var u=e,c=i,d=n;c.applyITRS(s.x,s.y,s.rotation,s.scaleX,s.scaleY),u.copyFrom(r.matrix);var f=t.currentContext,p=s.gidMap;f.save(),a?(u.multiplyWithOffset(a,-r.scrollX*s.scrollFactorX,-r.scrollY*s.scrollFactorY),c.e=s.x,c.f=s.y,u.multiply(c,d),d.copyToContext(f)):(c.e-=r.scrollX*s.scrollFactorX,c.f-=r.scrollY*s.scrollFactorY,c.copyToContext(f)),(!t.antialias||s.scaleX>1||s.scaleY>1)&&(f.imageSmoothingEnabled=!1);for(var g=0;g<h;g++){var v=o[g],m=p[v.index];if(m){var y=m.image.getSourceImage(),x=m.getTileTextureCoordinates(v.index),w=m.tileWidth,T=m.tileHeight;if(null!==x&&0!==w&&0!==T){var b=.5*w,S=.5*T;x.x+=m.tileOffset.x,x.y+=m.tileOffset.y,f.save(),f.translate(v.pixelX+b,v.pixelY+S),0!==v.rotation&&f.rotate(v.rotation),(v.flipX||v.flipY)&&f.scale(v.flipX?-1:1,v.flipY?-1:1),f.globalAlpha=l*v.alpha,f.drawImage(y,x.x,x.y,w,T,-b,-S,w,T),f.restore()}}}f.restore()}},Ert}(),Crt={renderWebGL:t,renderCanvas:e}}(),a=Ru(),o=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.Transform,i.Visible,i.ScrollFactor,e,r],initialize:function(t,e,i,r,o,h){n.call(this,t,"TilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=i,this.layer=e.layers[i],this.layer.tilemapLayer=this,this.tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=s.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.tempVec=new a,this.collisionCategory=1,this.collisionMask=1,this.setTilesets(r),this.setAlpha(this.layer.alpha),this.setPosition(o,h),this.setOrigin(0,0),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline(),this.initPostPipeline(!1)},setTilesets:function(t){var e=[],i=[],n=this.tilemap;Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];if("string"==typeof r&&(r=n.getTileset(r)),r){i.push(r);for(var a=r.firstgid,o=0;o<r.total;o++)e[a+o]=r}}this.gidMap=e,this.tileset=i},setRenderOrder:function(t){return"string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return s.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,i,n){return s.CalculateFacesWithin(t,e,i,n,this.layer),this},createFromTiles:function(t,e,i,n,r){return s.CreateFromTiles(t,e,i,n,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,i,n,r,a,o){return s.Copy(t,e,i,n,r,a,o,this.layer),this},fill:function(t,e,i,n,r,a){return s.Fill(t,e,i,n,r,a,this.layer),this},filterTiles:function(t,e,i,n,r,a,o){return s.FilterTiles(t,e,i,n,r,a,o,this.layer)},findByIndex:function(t,e,i){return s.FindByIndex(t,e,i,this.layer)},findTile:function(t,e,i,n,r,a,o){return s.FindTile(t,e,i,n,r,a,o,this.layer)},forEachTile:function(t,e,i,n,r,a,o){return s.ForEachTile(t,e,i,n,r,a,o,this.layer),this},setTint:function(t,e,i,n,s,r){return void 0===t&&(t=16777215),this.forEachTile(function(e){e.tint=t,e.tintFill=!1},this,e,i,n,s,r)},setTintFill:function(t,e,i,n,s,r){return void 0===t&&(t=16777215),this.forEachTile(function(e){e.tint=t,e.tintFill=!0},this,e,i,n,s,r)},getTileAt:function(t,e,i){return s.GetTileAt(t,e,i,this.layer)},getTileAtWorldXY:function(t,e,i,n){return s.GetTileAtWorldXY(t,e,i,n,this.layer)},getIsoTileAtWorldXY:function(t,e,i,n,r){void 0===i&&(i=!0);var a=this.tempVec;return s.IsometricWorldToTileXY(t,e,!0,a,r,this.layer,i),this.getTileAt(a.x,a.y,n)},getTilesWithin:function(t,e,i,n,r){return s.GetTilesWithin(t,e,i,n,r,this.layer)},getTilesWithinShape:function(t,e,i){return s.GetTilesWithinShape(t,e,i,this.layer)},getTilesWithinWorldXY:function(t,e,i,n,r,a){return s.GetTilesWithinWorldXY(t,e,i,n,r,a,this.layer)},hasTileAt:function(t,e){return s.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,i){return s.HasTileAtWorldXY(t,e,i,this.layer)},putTileAt:function(t,e,i,n){return s.PutTileAt(t,e,i,n,this.layer)},putTileAtWorldXY:function(t,e,i,n,r){return s.PutTileAtWorldXY(t,e,i,n,r,this.layer)},putTilesAt:function(t,e,i,n){return s.PutTilesAt(t,e,i,n,this.layer),this},randomize:function(t,e,i,n,r){return s.Randomize(t,e,i,n,r,this.layer),this},removeTileAt:function(t,e,i,n){return s.RemoveTileAt(t,e,i,n,this.layer)},removeTileAtWorldXY:function(t,e,i,n,r){return s.RemoveTileAtWorldXY(t,e,i,n,r,this.layer)},renderDebug:function(t,e){return s.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,i,n,r,a){return s.ReplaceByIndex(t,e,i,n,r,a,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,i,n){return s.SetCollision(t,e,i,this.layer,n),this},setCollisionBetween:function(t,e,i,n){return s.SetCollisionBetween(t,e,i,n,this.layer),this},setCollisionByProperty:function(t,e,i){return s.SetCollisionByProperty(t,e,i,this.layer),this},setCollisionByExclusion:function(t,e,i){return s.SetCollisionByExclusion(t,e,i,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return s.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,i){return s.SetTileIndexCallback(t,e,i,this.layer),this},setTileLocationCallback:function(t,e,i,n,r,a){return s.SetTileLocationCallback(t,e,i,n,r,a,this.layer),this},shuffle:function(t,e,i,n){return s.Shuffle(t,e,i,n,this.layer),this},swapByIndex:function(t,e,i,n,r,a){return s.SwapByIndex(t,e,i,n,r,a,this.layer),this},tileToWorldX:function(t,e){return this.tilemap.tileToWorldX(t,e,this)},tileToWorldY:function(t,e){return this.tilemap.tileToWorldY(t,e,this)},tileToWorldXY:function(t,e,i,n){return this.tilemap.tileToWorldXY(t,e,i,n,this)},getTileCorners:function(t,e,i){return this.tilemap.getTileCorners(t,e,i,this)},weightedRandomize:function(t,e,i,n,r){return s.WeightedRandomize(e,i,n,r,t,this.layer),this},worldToTileX:function(t,e,i){return this.tilemap.worldToTileX(t,e,i,this)},worldToTileY:function(t,e,i){return this.tilemap.worldToTileY(t,e,i,this)},worldToTileXY:function(t,e,i,n,s){return this.tilemap.worldToTileXY(t,e,i,n,s,this)},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],n.prototype.destroy.call(this))}});return Prt=o}function Pot(){if(Lrt)return Rrt;Lrt=1;var t=uot(),e=Vh(),i=Xu(),n=xtt(),s=Wh(),r=sot(),a=function(){if(Trt)return wrt;Trt=1;var t=new(Vh())({initialize:function(t){if(this.gids=[],void 0!==t)for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.total;++n)this.gids[i.firstgid+n]=i;this._gids=this.gids},enabled:{get:function(){return!!this.gids},set:function(t){this.gids=t?this._gids:void 0}},getTypeIncludingTile:function(t){if(void 0!==t.type&&""!==t.type)return t.type;if(this.gids&&void 0!==t.gid){var e=this.gids[t.gid];if(e){var i=e.getTileData(t.gid);if(i)return i.type}}},setTextureAndFrame:function(t,e,i,n){if(null===e&&this.gids&&void 0!==n.gid){var s=this.gids[n.gid];s&&(null===e&&void 0!==s.image&&(e=s.image.key),null===i&&(i=n.gid-s.firstgid),t.scene.textures.getFrame(e,i)||(e=null,i=null))}t.setTexture(e,i)},setPropertiesFromTiledObject:function(t,e){if(void 0!==this.gids&&void 0!==e.gid){var i=this.gids[e.gid];void 0!==i&&this.setFromJSON(t,i.getTileProperties(e.gid))}this.setFromJSON(t,e.properties)},setFromJSON:function(t,e){if(e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];void 0!==t[n.name]?t[n.name]=n.value:t.setData(n.name,n.value)}else for(var s in e)void 0!==t[s]?t[s]=e[s]:t.setData(s,e[s])}});return wrt=t}(),o=Yrt(),h=Rk(),l=Il(),u=uV(),c=jrt(),d=iot(),f=Aot(),p=lot(),g=new e({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tiles=e.tiles,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0,this.hexSideLength=e.hexSideLength;var i=this.orientation;this._convert={WorldToTileXY:d.GetWorldToTileXYFunction(i),WorldToTileX:d.GetWorldToTileXFunction(i),WorldToTileY:d.GetWorldToTileYFunction(i),TileToWorldXY:d.GetTileToWorldXYFunction(i),TileToWorldX:d.GetTileToWorldXFunction(i),TileToWorldY:d.GetTileToWorldYFunction(i),GetTileCorners:d.GetTileCornersFunction(i)}},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"==typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(e,i,s,r,a,o,h,l){if(void 0===e)return null;null==i&&(i=e);var u=this.scene.sys.textures;if(!u.exists(i))return console.warn('Texture key "%s" not found',i),null;var c=u.get(i),d=this.getTilesetIndex(e);if(null===d&&this.format===n.TILED_JSON)return console.warn('Tilemap has no tileset "%s". Its tilesets are %o',e,this.tilesets),null;var f=this.tilesets[d];return f?((s||r)&&f.setTileSize(s,r),(a||o)&&f.setSpacing(a,o),f.setImage(c),f):(void 0===s&&(s=this.tileWidth),void 0===r&&(r=this.tileHeight),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l={x:0,y:0}),(f=new p(e,h,s,r,a,o,void 0,void 0,l)).setImage(c),this.tilesets.push(f),this.tiles=t(this),f)},copy:function(t,e,i,n,s,r,a,o){return null!==(o=this.getLayer(o))?(d.Copy(t,e,i,n,s,r,a,o),this):null},createBlankLayer:function(t,e,i,n,s,a,o,h){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=this.tileWidth),void 0===h&&(h=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var l,u=new r({name:t,tileWidth:o,tileHeight:h,width:s,height:a,orientation:this.orientation,hexSideLength:this.hexSideLength}),d=0;d<a;d++){l=[];for(var p=0;p<s;p++)l.push(new c(u,-1,p,d,o,h,this.tileWidth,this.tileHeight));u.data.push(l)}this.layers.push(u),this.currentLayerIndex=this.layers.length-1;var g=new f(this.scene,this,this.currentLayerIndex,e,i,n);return g.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(g),g},createLayer:function(t,e,i,n){var s=this.getLayerIndex(t);if(null===s)return console.warn("Invalid Tilemap Layer ID: "+t),"string"==typeof t&&console.warn("Valid tilelayer names: %o",this.getTileLayerNames()),null;var r=this.layers[s];if(r.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=s,void 0===i&&(i=r.x),void 0===n&&(n=r.y);var a=new f(this.scene,this,s,e,i,n);return a.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(a),a},createFromObjects:function(t,e,n){void 0===n&&(n=!0);var r=[],l=this.getObjectLayer(t);if(!l)return console.warn("createFromObjects: Invalid objectLayerName given: "+t),r;var c=new a(n?this.tilesets:void 0);Array.isArray(e)||(e=[e]);for(var d=l.objects,f=0;f<e.length;f++){var p,g=e[f],v=s(g,"id",null),m=s(g,"gid",null),y=s(g,"name",null),x=s(g,"type",null);c.enabled=!s(g,"ignoreTileset",null);for(var w=[],T=0;T<d.length;T++)p=d[T],(null===v&&null===m&&null===y&&null===x||null!==v&&p.id===v||null!==m&&p.gid===m||null!==y&&p.name===y||null!==x&&c.getTypeIncludingTile(p)===x)&&w.push(p);for(var b=s(g,"classType",u),S=s(g,"scene",this.scene),E=s(g,"container",null),_=s(g,"key",null),C=s(g,"frame",null),A=0;A<w.length;A++){p=w[A];var P=new b(S);if(P.setName(p.name),P.setPosition(p.x,p.y),c.setTextureAndFrame(P,_,C,p),p.width&&(P.displayWidth=p.width),p.height&&(P.displayHeight=p.height),this.orientation===o.ISOMETRIC){var M=this.tileWidth/this.tileHeight,R={x:P.x-P.y,y:(P.x+P.y)/M};P.x=R.x,P.y=R.y}var L={x:P.originX*p.width,y:(P.originY-(p.gid?1:0))*p.height};if(p.rotation){var O=i(p.rotation);h(L,O),P.rotation=O}P.x+=L.x,P.y+=L.y,void 0===p.flippedHorizontal&&void 0===p.flippedVertical||P.setFlip(p.flippedHorizontal,p.flippedVertical),p.visible||(P.visible=!1),c.setPropertiesFromTiledObject(P,p),E?E.add(P):S.add.existing(P),r.push(P)}}return r},createFromTiles:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.CreateFromTiles(t,e,i,n,s,r)},fill:function(t,e,i,n,s,r,a){return void 0===r&&(r=!0),null===(a=this.getLayer(a))?null:(d.Fill(t,e,i,n,s,r,a),this)},filterObjects:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.filter(e,i)},filterTiles:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FilterTiles(t,e,i,n,s,r,a,o)},findByIndex:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.FindByIndex(t,e,i,n)},findObject:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.find(e,i)||null},findTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FindTile(t,e,i,n,s,r,a,o)},forEachTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:(d.ForEachTile(t,e,i,n,s,r,a,o),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map(function(t){return t.name}):[]},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map(function(t){return t.name}):[]},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"==typeof t?this.getLayerIndexByName(t):"number"==typeof t&&t<this.layers.length?t:t instanceof f&&t.tilemap===this?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTileAt(t,e,i,n)},getTileAtWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:d.GetTileAtWorldXY(t,e,i,n,s)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map(function(t){return t.name}):[]},getTilesWithin:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.GetTilesWithin(t,e,i,n,s,r)},getTilesWithinShape:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTilesWithinShape(t,e,i,n)},getTilesWithinWorldXY:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:d.GetTilesWithinWorldXY(t,e,i,n,s,r,a)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,i){return null===(i=this.getLayer(i))?null:d.HasTileAt(t,e,i)},hasTileAtWorldXY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.HasTileAtWorldXY(t,e,i,n)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.PutTileAt(t,e,i,n,s)},putTileAtWorldXY:function(t,e,i,n,s,r){return void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.PutTileAtWorldXY(t,e,i,n,s,r)},putTilesAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.PutTilesAt(t,e,i,n,s),this)},randomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.Randomize(t,e,i,n,s,r),this)},calculateFacesAt:function(t,e,i){return null===(i=this.getLayer(i))?null:(d.CalculateFacesAt(t,e,i),this)},calculateFacesWithin:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.CalculateFacesWithin(t,e,i,n,s),this)},removeLayer:function(t){var e=this.getLayerIndex(t);if(null!==e){l(this.layers,e);for(var i=e;i<this.layers.length;i++)this.layers[i].tilemapLayer&&this.layers[i].tilemapLayer.layerIndex--;return this.currentLayerIndex===e&&(this.currentLayerIndex=0),this}return null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).tilemapLayer.destroy(),l(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=!0);var n=[];Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];n.push(this.removeTileAt(r.x,r.y,!0,i,r.tilemapLayer)),e>-1&&this.putTileAt(e,r.x,r.y,i,r.tilemapLayer)}return n},removeTileAt:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.RemoveTileAt(t,e,i,n,s)},removeTileAtWorldXY:function(t,e,i,n,s,r){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.RemoveTileAtWorldXY(t,e,i,n,s,r)},renderDebug:function(t,e,i){return null===(i=this.getLayer(i))?null:(this.orientation===o.ORTHOGONAL&&d.RenderDebug(t,e,i),this)},renderDebugFull:function(t,e){for(var i=this.layers,n=0;n<i.length;n++)d.RenderDebug(t,e,i[n]);return this},replaceByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.ReplaceByIndex(t,e,i,n,s,r,a),this)},setCollision:function(t,e,i,n,s){return void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===s&&(s=!0),null===(n=this.getLayer(n))?null:(d.SetCollision(t,e,i,n,s),this)},setCollisionBetween:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.SetCollisionBetween(t,e,i,n,s),this)},setCollisionByProperty:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByProperty(t,e,i,n),this)},setCollisionByExclusion:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByExclusion(t,e,i,n),this)},setCollisionFromCollisionGroup:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),null===(i=this.getLayer(i))?null:(d.SetCollisionFromCollisionGroup(t,e,i),this)},setTileIndexCallback:function(t,e,i,n){return null===(n=this.getLayer(n))?null:(d.SetTileIndexCallback(t,e,i,n),this)},setTileLocationCallback:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SetTileLocationCallback(t,e,i,n,s,r,a),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var i=0;i<this.layers.length;i++){this.layers[i].baseTileWidth=t,this.layers[i].baseTileHeight=e;for(var n=this.layers[i].data,s=this.layers[i].width,r=this.layers[i].height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,i){if(null===(i=this.getLayer(i)))return this;i.tileWidth=t,i.tileHeight=e;for(var n=i.data,s=i.width,r=i.height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(t,e)}return this},shuffle:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.Shuffle(t,e,i,n,s),this)},swapByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SwapByIndex(t,e,i,n,s,r,a),this)},tileToWorldX:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldX(t,e,i)},tileToWorldY:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldY(t,e,i)},tileToWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:this._convert.TileToWorldXY(t,e,i,n,s)},getTileCorners:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.GetTileCorners(t,e,i,n)},weightedRandomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.WeightedRandomize(e,i,n,s,t,r),this)},worldToTileX:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileX(t,e,i,n)},worldToTileY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileY(t,e,i,n)},worldToTileXY:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:this._convert.WorldToTileXY(t,e,i,n,s,r)},destroy:function(){this.removeAllLayers(),this.tiles.length=0,this.tilesets.length=0,this.objects.length=0,this.scene=null}});return Rrt=g}function Mot(){if(Frt)return Ort;Frt=1;var t=xtt(),e=rot(),i=Cot(),n=Pot();return Ort=function(s,r,a,o,h,l,u,c){void 0===a&&(a=32),void 0===o&&(o=32),void 0===h&&(h=10),void 0===l&&(l=10),void 0===c&&(c=!1);var d=null;if(Array.isArray(u))d=i(void 0!==r?r:"map",t.ARRAY_2D,u,a,o,c);else if(void 0!==r){var f=s.cache.tilemap.get(r);f?d=i(r,f.format,f.data,a,o,c):console.warn("No map data found for key "+r)}return null===d&&(d=new e({tileWidth:a,tileHeight:o,width:h,height:l})),new n(s,d)},Ort}var Rot,Lot={};function Oot(){if(Rot)return Lot;Rot=1;var t=iU(),e=Mot();return t.register("tilemap",function(t){var i=void 0!==t?t:{};return e(this.scene,i.key,i.tileWidth,i.tileHeight,i.width,i.height,i.data,i.insertNull)}),Lot}var Fot,Dot,Iot,kot,Bot,Not,Uot,zot,Yot,Xot,Got,Wot,Hot,Vot,jot,qot,Kot,Zot,Jot,$ot,Qot,tht,eht,iht,nht,sht,rht,aht,oht,hht,lht,uht,cht,dht,fht,pht,ght,vht,mht,yht,xht,wht,Tht,bht,Sht,Eht,_ht,Cht,Aht,Pht,Mht,Rht,Lht,Oht,Fht,Dht,Iht,kht,Bht,Nht,Uht,zht,Yht,Xht,Ght,Wht,Hht,Vht,jht,qht,Kht,Zht,Jht,$ht,Qht,tlt,elt,ilt,nlt,slt,rlt,alt,olt,hlt,llt,ult,clt,dlt,flt,plt,glt,vlt,mlt,ylt,xlt,wlt,Tlt,blt={};function Slt(){if(Fot)return blt;Fot=1;var t=Nu(),e=Mot();return t.register("tilemap",function(t,i,n,s,r,a,o){return null===t&&(t=void 0),null===i&&(i=void 0),null===n&&(n=void 0),null===s&&(s=void 0),null===r&&(r=void 0),e(this.scene,t,i,n,s,r,a,o)}),blt}function Elt(){if(Iot)return Dot;Iot=1;var t=nh(),e=function(){if(Bet)return ket;Bet=1;var t={ORIENTATION:Yrt()};return ket=t}(),i={Components:iot(),Parsers:xrt?yrt:(xrt=1,yrt={FromOrientationString:not(),Parse:Cot(),Parse2DArray:aot(),ParseCSV:oot(),Impact:grt?prt:(grt=1,prt={ParseTileLayers:Sot(),ParseTilesets:Eot(),ParseWeltmeister:_ot()}),Tiled:mrt?vrt:(mrt=1,vrt={AssignTileProperties:hot(),Base64Decode:yot(),BuildTilesetIndex:uot(),CreateGroupLayer:cot(),ParseGID:pot(),ParseImageLayers:dot(),ParseJSONTiled:bot(),ParseObject:got(),ParseObjectLayers:mot(),ParseTileLayers:xot(),ParseTilesets:Tot()})}),Formats:xtt(),ImageCollection:wot(),ParseToTilemap:Mot(),Tile:jrt(),Tilemap:Pot(),TilemapCreator:Oot(),TilemapFactory:Slt(),Tileset:lot(),TilemapLayer:Aot(),Orientation:Yrt(),LayerData:sot(),MapData:rot(),ObjectLayer:vot()};return i=t(!1,i,e.ORIENTATION),Dot=i}function _lt(){if(Bot)return kot;Bot=1;var t=Vh(),e=Wh(),i=new t({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){if(this.delay=e(t,"delay",0),this.repeat=e(t,"repeat",0),this.loop=e(t,"loop",!1),this.callback=e(t,"callback",void 0),this.callbackScope=e(t,"callbackScope",this),this.args=e(t,"args",[]),this.timeScale=e(t,"timeScale",1),this.startAt=e(t,"startAt",0),this.paused=e(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/t}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});return kot=i}function Clt(){if(Uot)return Not;Uot=1;var t=Vh(),e=ku(),i=Bu(),n=_lt(),s=kl(),r=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(i.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var t=this.systems.events;t.on(i.PRE_UPDATE,this.preUpdate,this),t.on(i.UPDATE,this.update,this),t.once(i.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;if(t instanceof n){if(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=-1===e.repeat||e.loop?999999999999:e.repeat,e.delay<=0&&e.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else e=new n(t);return this._pendingInsertion.push(e),e},delayedCall:function(t,e,i,n){return this.addEvent({delay:t,callback:e,args:i,callbackScope:n})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];s(this._pendingRemoval,i),s(this._pendingInsertion,i),s(this._active,i)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var i,n;for(i=0;i<t;i++){n=this._pendingRemoval[i];var s=this._active.indexOf(n);s>-1&&this._active.splice(s,1),n.destroy()}for(i=0;i<e;i++)n=this._pendingInsertion[i],this._active.push(n);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var i=0;i<this._active.length;i++){var n=this._active[i];if(!n.paused&&(n.elapsed+=e*n.timeScale,n.elapsed>=n.delay)){var s=n.elapsed-n.delay;if(n.elapsed=n.delay,!n.hasDispatched&&n.callback&&(n.hasDispatched=!0,n.callback.apply(n.callbackScope,n.args)),n.repeatCount>0){if(n.repeatCount--,s>=n.delay)for(;s>=n.delay&&n.repeatCount>0;)n.callback&&n.callback.apply(n.callbackScope,n.args),s-=n.delay,n.repeatCount--;n.elapsed=s,n.hasDispatched=!1}else n.hasDispatched&&this._pendingRemoval.push(n)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(i.PRE_UPDATE,this.preUpdate,this),e.off(i.UPDATE,this.update,this),e.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null}});return e.register("Clock",r,"time"),Not=r}function Alt(){return Got?Xot:(Got=1,Xot={COMPLETE:Yot?zot:(Yot=1,zot="complete")})}function Plt(){if(Hot)return Wot;Hot=1;var t=Vh(),e=qF(),i=Nu(),n=Wh(),s=Bu(),r=Alt(),a=new t({Extends:e,initialize:function(t,i){e.call(this),this.scene=t,this.systems=t.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var n=this.systems.events;n.on(s.PRE_UPDATE,this.preUpdate,this),n.on(s.UPDATE,this.update,this),n.once(s.SHUTDOWN,this.destroy,this),i&&this.add(i)},preUpdate:function(t,e){this.paused||(this.elapsed+=e*this.timeScale)},update:function(){if(!this.paused&&!this.complete){var t,e,i=this.events,n=!1,s=this.systems;for(t=0;t<i.length;t++){var a=i[t];if(!a.complete&&a.time<=this.elapsed){if(a.complete=!0,this.totalComplete++,e=a.target?a.target:this,a.if&&!a.if.call(e,a))continue;if(a.once&&(n=!0),a.set&&a.target)for(var o in a.set)a.target[o]=a.set[o];this.iteration&&a.repeat++,a.loop&&a.repeat&&a.loop.call(e),a.tween&&(a.tweenInstance=s.tweens.add(a.tween)),a.sound&&("string"==typeof a.sound?s.sound.play(a.sound):s.sound.play(a.sound.key,a.sound.config)),a.event&&this.emit(a.event,e),a.run&&a.run.call(e),a.stop&&this.stop()}}if(n)for(t=0;t<i.length;t++)i[t].complete&&i[t].once&&(i.splice(t,1),t--);this.totalComplete>=i.length&&(0!==this.loop&&(-1===this.loop||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(r.COMPLETE,this)}},play:function(t){return void 0===t&&(t=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,t&&this.reset(),this},pause:function(){this.paused=!0;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!0)}return this},repeat:function(t){return void 0!==t&&!0!==t||(t=-1),!1===t&&(t=0),this.loop=t,this},resume:function(){this.paused=!1;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(t){void 0===t&&(t=!1),this.elapsed=0,t||(this.iteration=0);for(var e=this.events,i=0;i<e.length;i++){var n=e[i];n.complete=!1,t||(n.repeat=0),n.tweenInstance&&n.tweenInstance.stop()}return this.play(!1)},add:function(t){Array.isArray(t)||(t=[t]);var e=this.events,i=0;e.length>0&&(i=e[e.length-1].time);for(var s=0;s<t.length;s++){var r=t[s],a=n(r,"at",0),o=n(r,"in",null);null!==o&&(a=this.elapsed+o);var h=n(r,"from",null);null!==h&&(a=i+h),e.push({complete:!1,time:a,repeat:0,if:n(r,"if",null),run:n(r,"run",null),loop:n(r,"loop",null),event:n(r,"event",null),target:n(r,"target",null),set:n(r,"set",null),tween:n(r,"tween",null),sound:n(r,"sound",null),once:n(r,"once",!1),stop:n(r,"stop",!1)}),i=a}return this.complete=!1,this},clear:function(){for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&i.tweenInstance.stop()}return t=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){return Math.min(this.totalComplete,this.events.length)/this.events.length},destroy:function(){var t=this.systems.events;t.off(s.PRE_UPDATE,this.preUpdate,this),t.off(s.UPDATE,this.update,this),t.off(s.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});return i.register("timeline",function(t){return new a(this.scene,t)}),Wot=a}function Mlt(){return Kot?qot:(Kot=1,qot=function(t,e,i){var n;return n=t.hasOwnProperty(e)?"function"==typeof t[e]?function(i,n,s,r,a,o){return t[e](i,n,s,r,a,o)}:function(){return t[e]}:"function"==typeof i?i:function(){return i},n})}function Rlt(){if(Qot)return $ot;Qot=1;var t=Jot?Zot:(Jot=1,Zot=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]);return $ot=function(e){var i,n=[];if(e.hasOwnProperty("props"))for(i in e.props)"_"!==i.substring(0,1)&&n.push({key:i,value:e.props[i]});else for(i in e)-1===t.indexOf(i)&&"_"!==i.substring(0,1)&&n.push({key:i,value:e[i]});return n}}function Llt(){if(eht)return tht;eht=1;var t=Ol();return tht=function(e){var i=t(e,"targets",null);return null===i||("function"==typeof i&&(i=i.call()),Array.isArray(i)||(i=[i])),i}}function Olt(){if(nht)return iht;nht=1;var t=vI(),e=ik();function i(t){return!!t.getActive&&"function"==typeof t.getActive}function n(t){return!!t.getStart&&"function"==typeof t.getStart}function s(t){return!!t.getEnd&&"function"==typeof t.getEnd}var r=function(a,o){var h,l=function(t,e,i){return i},u=function(t,e,i){return i},c=null,d=typeof o;if("number"===d)l=function(){return o};else if(Array.isArray(o))u=function(){return o[0]},l=function(){return o[o.length-1]};else if("string"===d){var f=o.toLowerCase(),p="random"===f.substring(0,6),g="int"===f.substring(0,3);if(p||g){var v=f.indexOf("("),m=f.indexOf(")"),y=f.indexOf(",");if(!(v&&m&&y))throw new Error("invalid random() format");var x=parseFloat(f.substring(v+1,y)),w=parseFloat(f.substring(y+1,m));l=p?function(){return e(x,w)}:function(){return t(x,w)}}else{f=f[0];var T=parseFloat(o.substr(2));switch(f){case"+":l=function(t,e,i){return i+T};break;case"-":l=function(t,e,i){return i-T};break;case"*":l=function(t,e,i){return i*T};break;case"/":l=function(t,e,i){return i/T};break;default:l=function(){return parseFloat(o)}}}}else if("function"===d)l=o;else if("object"===d)if(function(t){return n(t)||s(t)||i(t)}(o))i(o)&&(c=o.getActive),s(o)&&(l=o.getEnd),n(o)&&(u=o.getStart);else if(o.hasOwnProperty("value"))h=r(a,o.value);else{var b=o.hasOwnProperty("to"),S=o.hasOwnProperty("from"),E=o.hasOwnProperty("start");if(b&&(S||E)){if(h=r(a,o.to),E){var _=r(a,o.start);h.getActive=_.getEnd}if(S){var C=r(a,o.from);h.getStart=C.getEnd}}}return h||(h={getActive:c,getEnd:l,getStart:u}),h};return iht=r}function Flt(){return _ht?Eht:(_ht=1,Eht={TWEEN_ACTIVE:rht?sht:(rht=1,sht="active"),TWEEN_COMPLETE:oht?aht:(oht=1,aht="complete"),TWEEN_LOOP:lht?hht:(lht=1,hht="loop"),TWEEN_PAUSE:cht?uht:(cht=1,uht="pause"),TWEEN_RESUME:fht?dht:(fht=1,dht="resume"),TWEEN_REPEAT:ght?pht:(ght=1,pht="repeat"),TWEEN_START:mht?vht:(mht=1,vht="start"),TWEEN_STOP:xht?yht:(xht=1,yht="stop"),TWEEN_UPDATE:Tht?wht:(Tht=1,wht="update"),TWEEN_YOYO:Sht?bht:(Sht=1,bht="yoyo")})}function Dlt(){if(Aht)return Cht;Aht=1;var t=Vh(),e=qF(),i=Flt(),n=Wu(),s=new t({Extends:e,initialize:function(t){e.call(this),this.parent=t,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=n.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(i.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(i.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(i.TWEEN_COMPLETE,"onComplete")},complete:function(t){return void 0===t&&(t=0),t?(this.setCompleteDelayState(),this.countdown=t):this.onCompleteHandler(),this},completeAfterLoop:function(t){return void 0===t&&(t=0),this.loopCounter>t&&(this.loopCounter=t),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return!this.parent||this.isRemoved()||this.isPendingRemove()||this.isDestroyed()||(this.dispatchEvent(i.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(t){this.countdown-=t,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(t){return this.countdown-=t,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(i.TWEEN_START,"onStart"),t=0),t},updateCompleteDelay:function(t){this.countdown-=t,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(t,e,i){return void 0===i&&(i=[]),this.callbacks.hasOwnProperty(t)&&(this.callbacks[t]={func:e,params:i}),this},setPendingState:function(){this.state=n.PENDING},setActiveState:function(){this.state=n.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=n.LOOP_DELAY},setCompleteDelayState:function(){this.state=n.COMPLETE_DELAY},setStartDelayState:function(){this.state=n.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=n.PENDING_REMOVE},setRemovedState:function(){this.state=n.REMOVED},setFinishedState:function(){this.state=n.FINISHED},setDestroyedState:function(){this.state=n.DESTROYED},isPending:function(){return this.state===n.PENDING},isActive:function(){return this.state===n.ACTIVE},isLoopDelayed:function(){return this.state===n.LOOP_DELAY},isCompleteDelayed:function(){return this.state===n.COMPLETE_DELAY},isStartDelayed:function(){return this.state===n.START_DELAY},isPendingRemove:function(){return this.state===n.PENDING_REMOVE},isRemoved:function(){return this.state===n.REMOVED},isFinished:function(){return this.state===n.FINISHED},isDestroyed:function(){return this.state===n.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(t){t.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});return s.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],Cht=s}function Ilt(){return Mht?Pht:(Mht=1,Pht={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null})}function klt(){if(Lht)return Rht;Lht=1;var t=Vh(),e=Flt(),i=Wu(),n=new t({initialize:function(t,e,i,n,s,r,a,o,h,l){this.tween=t,this.targetIndex=e,this.duration=n<=0?.01:n,this.totalDuration=0,this.delay=0,this.getDelay=i,this.yoyo=s,this.hold=r,this.repeat=a,this.repeatDelay=o,this.repeatCounter=0,this.flipX=h,this.flipY=l,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(t){void 0===t&&(t=this.current),this.tween.targets[this.targetIndex][this.key]=t},setCreatedState:function(){this.state=i.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=i.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=i.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=i.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=i.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=i.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=i.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=i.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===i.CREATED},isDelayed:function(){return this.state===i.DELAY},isPendingRender:function(){return this.state===i.PENDING_RENDER},isPlayingForward:function(){return this.state===i.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===i.PLAYING_BACKWARD},isHolding:function(){return this.state===i.HOLD_DELAY},isRepeating:function(){return this.state===i.REPEAT_DELAY},isComplete:function(){return this.state===i.COMPLETE},setStateFromEnd:function(t){this.yoyo?this.onRepeat(t,!0,!0):this.repeatCounter>0?this.onRepeat(t,!0,!1):this.setCompleteState()},setStateFromStart:function(t){this.repeatCounter>0?this.onRepeat(t,!1):this.setCompleteState()},reset:function(){var t=this.tween,e=t.totalTargets,n=this.targetIndex,s=t.targets[n],r=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(s,r,0,n,e,t),this.repeatCounter=-1===this.repeat?i.MAX:this.repeat,this.setPendingRenderState();var a=this.duration+this.hold;this.yoyo&&(a+=this.duration);var o=a+this.repeatDelay;this.totalDuration=this.delay+a,-1===this.repeat?(this.totalDuration+=o*i.MAX,t.isInfinite=!0):this.repeat>0&&(this.totalDuration+=o*this.repeat),this.totalDuration>t.duration&&(t.duration=this.totalDuration),this.delay<t.startDelay&&(t.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(t,i,n){var s=this.tween,r=s.totalTargets,a=this.targetIndex,o=s.targets[a],h=this.key,l="texture"!==h;if(this.elapsed=t,this.progress=t/this.duration,this.flipX&&o.toggleFlipX(),this.flipY&&o.toggleFlipY(),l&&(i||n)&&(this.start=this.getStartValue(o,h,this.start,a,r,s)),n)return this.setPlayingBackwardState(),void this.dispatchEvent(e.TWEEN_YOYO,"onYoyo");this.repeatCounter--,l&&(this.end=this.getEndValue(o,h,this.start,a,r,s)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-t,l&&(this.current=this.start,o[h]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(e.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});return Rht=n}function Blt(){if(Fht)return Oht;Fht=1;var t=klt(),e=Jh(),i=Vh(),n=Flt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,v,m){t.call(this,e,i,h,l,u,c,d,f,p,g),this.key=n,this.getActiveValue=a,this.getEndValue=s,this.getStartValue=r,this.ease=o,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=v,this.interpolationData=m},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex],n=this.key;e&&(i[n]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(i[n]=this.getActiveValue(i,n,0))},update:function(t){var i=this.tween,s=i.totalTargets,r=this.targetIndex,a=i.targets[r],o=this.key;if(!a)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(a,o,a[o],r,s,i),this.end=this.getEndValue(a,o,this.start,r,s,i),this.current=this.start,a[o]=this.start,this.setPlayingForwardState(),!0;var h=this.isPlayingForward(),l=this.isPlayingBackward();if(h||l){var u=this.elapsed,c=this.duration,d=0,f=!1;(u+=t)>=c?(d=u-c,u=c,f=!0):u<0&&(u=0);var p=e(u/c,0,1);this.elapsed=u,this.progress=p,this.previous=this.current,h||(p=1-p);var g=this.ease(p);this.interpolation?this.current=this.interpolation(this.interpolationData,g):this.current=this.start+(this.end-this.start)*g,a[o]=this.current,f&&(h?(i.isNumberTween&&(this.current=this.end,a[o]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(d)):(i.isNumberTween&&(this.current=this.start,a[o]=this.current),this.setStateFromStart(d))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key,r=this.current,a=this.previous;i.emit(t,i,s,n,r,a);var o=i.callbacks[e];o&&o.func.apply(i.callbackScope,[i,n,s,r,a].concat(o.params))}},destroy:function(){t.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});return Oht=s}function Nlt(){if(Iht)return Dht;Iht=1;var t=klt(),e=Jh(),i=Vh(),n=Flt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c){t.call(this,e,i,r,a,!1,o,h,l,u,c),this.key="texture",this.startTexture=null,this.endTexture=n,this.startFrame=null,this.endFrame=s,this.yoyo=0!==h},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=i.texture.key,this.startFrame=i.frame.name),e&&i.setTexture(this.startTexture,this.startFrame)},update:function(t){var i=this.tween,s=this.targetIndex,r=i.targets[s];if(!r)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&r.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var a=this.isPlayingForward(),o=this.isPlayingBackward();if(a||o){var h=this.elapsed,l=this.duration,u=0,c=!1;(h+=t)>=l?(u=h-l,h=l,c=!0):h<0&&(h=0);var d=e(h/l,0,1);this.elapsed=h,this.progress=d,c&&(a?(r.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(u)):(r.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(u))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key;i.emit(t,i,s,n);var r=i.callbacks[e];r&&r.func.apply(i.callbackScope,[i,n,s].concat(r.params))}},destroy:function(){t.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});return Dht=s}function Ult(){if(Bht)return kht;Bht=1;var t=Dlt(),e=Vh(),i=Flt(),n=iU(),s=Nu(),r=Qh(),a=Wu(),o=Blt(),h=Nlt(),l=new e({Extends:t,initialize:function(e,i){t.call(this,e),this.targets=i,this.totalTargets=i.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,v){var m=new o(this,t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,v);return this.totalData=this.data.push(m),m},addFrame:function(t,e,i,n,s,r,a,o,l,u){var c=new h(this,t,e,i,n,s,r,a,o,l,u);return this.totalData=this.data.push(c),c},getValue:function(t){void 0===t&&(t=0);var e=null;return this.data&&(e=this.data[t].current),e},hasTarget:function(t){return this.targets&&-1!==this.targets.indexOf(t)},updateTo:function(t,e,i){if(void 0===i&&(i=!1),"texture"!==t)for(var n=0;n<this.totalData;n++){var s=this.data[n];s.key===t&&(s.isPlayingForward()||s.isPlayingBackward())&&(s.end=e,i&&(s.start=s.current))}return this},restart:function(){switch(this.state){case a.REMOVED:case a.FINISHED:this.seek(),this.parent.makeActive(this);break;case a.PENDING:case a.PENDING_REMOVE:this.parent.reset(this);break;case a.DESTROYED:console.warn("Cannot restart destroyed Tween",this);break;default:this.seek()}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,t.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed Tween",this),this):((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=16.6),void 0===n&&(n=!1),this.isDestroyed())return console.warn("Cannot seek destroyed Tween",this),this;n||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive");var s=this.paused;if(this.paused=!1,t>0){for(var r=Math.floor(t/e),a=t-r*e,o=0;o<r;o++)this.update(e);a>0&&this.update(a)}return this.paused=s,this.isSeeking=!1,this},initTweenData:function(t){void 0===t&&(t=!1),this.duration=0,this.startDelay=r.MAX_SAFE_INTEGER;for(var e=this.data,i=0;i<this.totalData;i++)e[i].reset(t);this.duration=Math.max(this.duration,.01);var n=this.duration,s=this.completeDelay,a=this.loopCounter,o=this.loopDelay;this.totalDuration=a>0?n+s+(n+o)*a:n+s},reset:function(t){return void 0===t&&(t=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,-1===this.loop&&(this.isInfinite=!0,this.loopCounter=a.MAX),t||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")),this},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.paused||this.isFinished())return!1;if(t*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(i.TWEEN_START,"onStart"),t=0));var e=!1;if(this.isActive())for(var n=this.data,s=0;s<this.totalData;s++)n[s].update(t)&&(e=!0);this.elapsed+=t,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=t,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),e||this.nextState();var r=this.isPendingRemove();return r&&this.persist&&(this.setFinishedState(),r=!1),r},forward:function(t){return this.update(t),this},rewind:function(t){return this.update(-t),this},dispatchEvent:function(t,e){if(!this.isSeeking){if(this.emit(t,this,this.targets),!this.callbacks)return;var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this,this.targets].concat(i.params))}},destroy:function(){t.prototype.destroy.call(this),this.targets=null}});return s.register("tween",function(t){return this.scene.sys.tweens.add(t)}),n.register("tween",function(t){return this.scene.sys.tweens.create(t)}),kht=l}function zlt(){if(Uht)return Nht;Uht=1;var t=Dlt(),e=Ilt(),i=BU(),n=Gu(),s=yD(),r=Wh(),a=Mlt(),o=Ol(),h=Olt(),l=PV(),u=Ult();return Nht=function(c,d,f){if(d instanceof u)return d.parent=c,d;f=void 0===f?e:l(e,f);var p=r(d,"from",0),g=r(d,"to",1),v=[{value:p}],m=r(d,"delay",f.delay),y=r(d,"easeParams",f.easeParams),x=r(d,"ease",f.ease),w=h("value",g),T=new u(c,v),b=T.add(0,"value",w.getEnd,w.getStart,w.getActive,s(r(d,"ease",x),r(d,"easeParams",y)),a(d,"delay",m),r(d,"duration",f.duration),n(d,"yoyo",f.yoyo),r(d,"hold",f.hold),r(d,"repeat",f.repeat),r(d,"repeatDelay",f.repeatDelay),!1,!1);b.start=p,b.current=p,T.completeDelay=i(d,"completeDelay",0),T.loop=Math.round(i(d,"loop",0)),T.loopDelay=Math.round(i(d,"loopDelay",0)),T.paused=n(d,"paused",!1),T.persist=n(d,"persist",!1),T.isNumberTween=!0,T.callbackScope=o(d,"callbackScope",T);for(var S=t.TYPES,E=0;E<S.length;E++){var _=S[E],C=o(d,_,!1);if(C){var A=o(d,_+"Params",[]);T.setCallback(_,C,A)}}return T},Nht}function Ylt(){if(Yht)return zht;Yht=1;var t=yD(),e=Ol(),i=Qh();return zht=function(n,s){var r;void 0===s&&(s={});var a=e(s,"start",0),o=e(s,"ease",null),h=e(s,"grid",null),l=e(s,"from",0),u="first"===l,c="center"===l,d="last"===l,f="number"==typeof l,p=Array.isArray(n),g=p?parseFloat(n[0]):parseFloat(n),v=p?parseFloat(n[1]):0,m=Math.max(g,v);if(p&&(a+=g),h){var y=h[0],x=h[1],w=0,T=0,b=0,S=0,E=[];d?(w=y-1,T=x-1):f?(w=l%y,T=Math.floor(l/y)):c&&(w=(y-1)/2,T=(x-1)/2);for(var _=i.MIN_SAFE_INTEGER,C=0;C<x;C++){E[C]=[];for(var A=0;A<y;A++){b=w-A,S=T-C;var P=Math.sqrt(b*b+S*S);P>_&&(_=P),E[C][A]=P}}}var M=o?t(o):null;return r=h?function(t,e,i,n){var s,r=0,o=n%y,h=Math.floor(n/y);if(o>=0&&o<y&&h>=0&&h<x&&(r=E[h][o]),p){var l=v-g;s=M?r/_*l*M(r/_):r/_*l}else s=M?r*g*M(r/_):r*g;return s+a}:function(t,e,i,n,s){var r,o,h;return s--,u?r=n:c?r=Math.abs(s/2-n):d?r=s-n:f&&(r=Math.abs(l-n)),p?(h=c?(v-g)/s*(2*r):(v-g)/s*r,o=M?h*M(r/s):h):o=M?s*m*M(r/s):r*g,o+a},r}}function Xlt(){if(Ght)return Xht;Ght=1;var t=Dlt(),e=Ilt(),i=BU(),n=Gu(),s=yD(),r=Wh(),a=fV(),o=Mlt(),h=Rlt(),l=Llt(),u=Ol(),c=Olt(),d=PV(),f=Ult();return Xht=function(p,g,v){if(g instanceof f)return g.parent=p,g;v=void 0===v?e:d(e,v);var m=l(g);!m&&v.targets&&(m=v.targets);for(var y=h(g),x=r(g,"delay",v.delay),w=r(g,"duration",v.duration),T=r(g,"easeParams",v.easeParams),b=r(g,"ease",v.ease),S=r(g,"hold",v.hold),E=r(g,"repeat",v.repeat),_=r(g,"repeatDelay",v.repeatDelay),C=n(g,"yoyo",v.yoyo),A=n(g,"flipX",v.flipX),P=n(g,"flipY",v.flipY),M=r(g,"interpolation",v.interpolation),R=function(t,e,i,h){if("texture"===i){var l=h,u=void 0;Array.isArray(h)?(l=h[0],u=h[1]):h.hasOwnProperty("value")?(l=h.value,Array.isArray(h.value)?(l=h.value[0],u=h.value[1]):"string"==typeof h.value&&(l=h.value)):"string"==typeof h&&(l=h),t.addFrame(e,l,u,o(h,"delay",x),r(h,"duration",w),r(h,"hold",S),r(h,"repeat",E),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",P))}else{var d=c(i,h),f=a(r(h,"interpolation",M));t.add(e,i,d.getEnd,d.getStart,d.getActive,s(r(h,"ease",b),r(h,"easeParams",T)),o(h,"delay",x),r(h,"duration",w),n(h,"yoyo",C),r(h,"hold",S),r(h,"repeat",E),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",P),f,f?h:null)}},L=new f(p,m),O=0;O<y.length;O++)for(var F=y[O].key,D=y[O].value,I=0;I<m.length;I++)"scale"!==F||m[I].hasOwnProperty("scale")?R(L,I,F,D):(R(L,I,"scaleX",D),R(L,I,"scaleY",D));L.completeDelay=i(g,"completeDelay",0),L.loop=Math.round(i(g,"loop",0)),L.loopDelay=Math.round(i(g,"loopDelay",0)),L.paused=n(g,"paused",!1),L.persist=n(g,"persist",!1),L.callbackScope=r(g,"callbackScope",L);for(var k=t.TYPES,B=0;B<k.length;B++){var N=k[B],U=u(g,N,!1);if(U){var z=u(g,N+"Params",[]);L.setCallback(N,U,z)}}return L},Xht}function Glt(){if(jht)return Vht;jht=1;var t=kl(),e=Dlt(),i=Vh(),n=Flt(),s=iU(),r=Nu(),a=Wu(),o=new i({Extends:e,initialize:function(t){e.call(this,t),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=-1===this.loop?a.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(t){var e=this.parent.create(t);Array.isArray(e)||(e=[e]);for(var i=this.data,n=0;n<e.length;n++){var s=e[n];s.parent=this,i.push(s.reset())}return this.totalData=i.length,this},remove:function(e){return t(this.data,e),e.setRemovedState(),e===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(t){for(var e=this.data,i=0;i<this.totalData;i++)if(e[i].hasTarget(t))return!0;return!1},restart:function(){return this.isDestroyed()?(console.warn("Cannot restart destroyed TweenChain",this),this):(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(t){return t.seek(),t.setActiveState(),this},makeActive:function(t){return t.reset(),t.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed TweenChain",this),this):((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var t=this.data,e=this.totalData,i=0;i<e;i++)t[i].reset(!1);this.setCurrentTween(0)},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.isFinished()||this.paused)return!1;if(t*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(n.TWEEN_START,"onStart"),t=0));var e=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(t)&&this.nextTween()&&this.nextState(),(e=this.isPendingRemove())&&this.persist&&(this.setFinishedState(),e=!1)),e},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData||(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(t){this.currentIndex=t,this.currentTween=this.data[t],this.currentTween.setActiveState()},dispatchEvent:function(t,e){this.emit(t,this);var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this].concat(i.params))},destroy:function(){e.prototype.destroy.call(this),this.currentTween=null}});return r.register("tweenchain",function(t){return this.scene.sys.tweens.chain(t)}),s.register("tweenchain",function(t){return this.scene.sys.tweens.create(t)}),Vht=o}function Wlt(){if(Jht)return Zht;Jht=1;var t=kl(),e=Vh(),i=El(),n=zlt(),s=ku(),r=Bu(),a=Ylt(),o=Ult(),h=Xlt(),l=Glt(),u=function(){if(Kht)return qht;Kht=1;var t=Dlt(),e=BU(),i=Gu(),n=Llt(),s=Ol(),r=Xlt(),a=Glt();return qht=function(o,h){if(h instanceof a)return h.parent=o,h;var l,u=new a(o);u.startDelay=s(h,"delay",0),u.completeDelay=e(h,"completeDelay",0),u.loop=Math.round(e(h,"loop",s(h,"repeat",0))),u.loopDelay=Math.round(e(h,"loopDelay",s(h,"repeatDelay",0))),u.paused=i(h,"paused",!1),u.persist=i(h,"persist",!1),u.callbackScope=s(h,"callbackScope",u);var c=t.TYPES;for(l=0;l<c.length;l++){var d=c[l],f=s(h,d,!1);if(f){var p=s(h,d+"Params",[]);u.setCallback(d,f,p)}}var g=s(h,"tweens",null);if(Array.isArray(g)){var v=[],m=n(h),y=void 0;for(m&&(y={targets:m}),l=0;l<g.length;l++)v.push(r(u,g[l],y));u.add(v)}return u},qht}(),c=new e({initialize:function(t){this.scene=t,this.events=t.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(r.BOOT,this.boot,this),this.events.on(r.START,this.start,this)},boot:function(){this.events.once(r.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(r.UPDATE,this.update,this),this.events.once(r.SHUTDOWN,this.shutdown,this)},create:function(t){Array.isArray(t)||(t=[t]);for(var e=[],i=0;i<t.length;i++){var n=t[i];n instanceof o||n instanceof l?e.push(n):Array.isArray(n.tweens)?e.push(u(this,n)):e.push(h(this,n))}return 1===e.length?e[0]:e},add:function(t){var e=t,i=this.tweens;return e instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),i.push(e.reset()),e},addMultiple:function(t){for(var e,i=[],n=this.tweens,s=0;s<t.length;s++)(e=t[s])instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),n.push(e.reset()),i.push(e);return i},chain:function(t){var e=u(this,t);return this.tweens.push(e.init()),e},getChainedTweens:function(t){return t.getChainedTweens()},has:function(t){return this.tweens.indexOf(t)>-1},existing:function(t){return this.has(t)||this.tweens.push(t.reset()),this},addCounter:function(t){var e=n(this,t);return this.tweens.push(e.reset()),e},stagger:function(t,e){return a(t,e)},setLagSmooth:function(t,e){return void 0===t&&(t=1/1e-8),void 0===e&&(e=0),this.maxLag=t,this.lagSkip=Math.min(e,this.maxLag),this},setFps:function(t){return void 0===t&&(t=240),this.gap=1e3/t,this.nextTime=1e3*this.time+this.gap,this},getDelta:function(t){var e=Date.now()-this.prevTime;e>this.maxLag&&(this.startTime+=e-this.lagSkip),this.prevTime+=e;var i=this.prevTime-this.startTime,n=i-this.nextTime,s=i-1e3*this.time;return n>0||t?(i/=1e3,this.time=i,this.nextTime+=n+(n>=this.gap?4:this.gap-n)):s=0,s},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(t){void 0===t&&(t=!1);var e=this.getDelta(t);if(!(e<=0)){var i,n;this.processing=!0;var s=[],r=this.tweens;for(i=0;i<r.length;i++)(n=r[i]).update(e)&&s.push(n);var a=s.length;if(a&&r.length>0){for(i=0;i<a;i++){n=s[i];var o=r.indexOf(n);o>-1&&(n.isPendingRemove()||n.isDestroyed())&&(r.splice(o,1),n.destroy())}s.length=0}this.processing=!1}},remove:function(e){return this.processing?e.setPendingRemoveState():(t(this.tweens,e),e.setRemovedState()),this},reset:function(t){return this.existing(t),t.seek(),t.setActiveState(),this},makeActive:function(t){return this.existing(t),t.setActiveState(),this},each:function(t,e){var i,n=[null];for(i=1;i<arguments.length;i++)n.push(arguments[i]);return this.tweens.forEach(function(i){n[0]=i,t.apply(e,n)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(t){for(var e=[],n=this.tweens,s=(t=Array.isArray(t)?i(t):[t]).length,r=0;r<n.length;r++)for(var a=n[r],o=0;o<s;o++)!a.isDestroyed()&&a.hasTarget(t[o])&&e.push(a);return e},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(t){return this.timeScale=t,this},isTweening:function(t){for(var e,i=this.tweens,n=0;n<i.length;n++)if((e=i[n]).isPlaying()&&e.hasTarget(t))return!0;return!1},killAll:function(){for(var t=this.processing?this.getTweens():this.tweens,e=0;e<t.length;e++)t[e].destroy();return this.processing||(t.length=0),this},killTweensOf:function(t){for(var e=this.getTweensOf(t),i=0;i<e.length;i++)e[i].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(r.UPDATE,this.update,this),this.events.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(r.START,this.start,this),this.scene=null,this.events=null}});return s.register("TweenManager",c,"tweens"),Zht=c}function Hlt(){if(Qht)return $ht;Qht=1;var t={States:Wu(),Builders:Hht?Wht:(Hht=1,Wht={GetBoolean:Gu(),GetEaseFunction:yD(),GetInterpolationFunction:fV(),GetNewValue:Mlt(),GetProps:Rlt(),GetTargets:Llt(),GetValueOp:Olt(),NumberTweenBuilder:zlt(),StaggerBuilder:Ylt(),TweenBuilder:Xlt()}),Events:Flt(),TweenManager:Wlt(),Tween:Ult(),TweenData:Blt(),TweenFrameData:Nlt(),BaseTween:Dlt(),TweenChain:Glt()};return $ht=t}function Vlt(){if(elt)return tlt;elt=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return tlt=function(e,i){for(var n=new Uint8Array(e),s=n.length,r=i?"data:"+i+";base64,":"",a=0;a<s;a+=3)r+=t[n[a]>>2],r+=t[(3&n[a])<<4|n[a+1]>>4],r+=t[(15&n[a+1])<<2|n[a+2]>>6],r+=t[63&n[a+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},tlt}function jlt(){if(nlt)return ilt;nlt=1;for(var t=new Uint8Array(256),e=0;e<64;e++)t["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;return ilt=function(e){var i,n,s,r,a=(e=e.substr(e.indexOf(",")+1)).length,o=.75*a,h=0;"="===e[a-1]&&(o--,"="===e[a-2]&&o--);for(var l=new ArrayBuffer(o),u=new Uint8Array(l),c=0;c<a;c+=4)i=t[e.charCodeAt(c)],n=t[e.charCodeAt(c+1)],s=t[e.charCodeAt(c+2)],r=t[e.charCodeAt(c+3)],u[h++]=i<<2|n>>4,u[h++]=(15&n)<<4|s>>2,u[h++]=(3&s)<<6|63&r;return l},ilt}function qlt(){if(olt)return alt;olt=1;var t=Ol(),e=Jh();return alt=function(i,n,s,r,a){void 0===a&&(a=s);var o=t(i,n,a);return e(o,s,r)}}var Klt=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(function(){if(Tlt)return wlt;Tlt=1,k||(k=1,"undefined"!=typeof HTMLVideoElement&&!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(t){const e=performance.now(),i=this.getVideoPlaybackQuality(),n=this.mozPresentedFrames||this.mozPaintedFrames||i.totalVideoFrames-i.droppedVideoFrames,s=(r,a)=>{const o=this.getVideoPlaybackQuality(),h=this.mozPresentedFrames||this.mozPaintedFrames||o.totalVideoFrames-o.droppedVideoFrames;if(h>n){const n=this.mozFrameDelay||o.totalFrameDelay-i.totalFrameDelay||0,s=a-r;t(a,{presentationTime:a+1e3*n,expectedDisplayTime:a+s,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+s/1e3,presentedFrames:h,processingDuration:n}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(a,t))};return this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(e,t)),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(t){cancelAnimationFrame(this._rvfcpolyfillmap[t]),delete this._rvfcpolyfillmap[t]}));var t=eh(),e=nh(),i={Actions:lI(),Animations:um?lm:(um=1,lm={Animation:dI(),AnimationFrame:cI(),AnimationManager:gI(),AnimationState:mI(),Events:uI()}),BlendModes:Qo(),Cache:bm?Tm:(bm=1,Tm={BaseCache:xI(),CacheManager:wI(),Events:yI()}),Cameras:bx?Tx:(bx=1,Tx={Controls:Pm?Am:(Pm=1,Am={FixedKeyControl:TI(),SmoothedKeyControl:bI()}),Scene2D:wx?xx:(wx=1,xx={Camera:HI(),BaseCamera:II(),CameraManager:jI(),Effects:GI(),Events:SI()})}),Core:EC?SC:(EC=1,SC={Config:Nk(),CreateRenderer:lN(),DebugHeader:uN(),Events:pI(),TimeStep:dN(),VisibilityHandler:fN()}),Class:Vh(),Create:zC?UC:(zC=1,UC={GenerateTexture:gN(),Palettes:NC?BC:(NC=1,BC={ARNE16:pN(),C64:RC?MC:(RC=1,MC={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}),CGA:OC?LC:(OC=1,LC={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}),JMP:DC?FC:(DC=1,FC={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}),MSX:kC?IC:(kC=1,IC={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"})})}),Curves:aA?rA:(aA=1,rA={Path:EN(),MoveTo:TN(),CubicBezier:yN(),Curve:mN(),Ellipse:xN(),Line:wN(),QuadraticBezier:bN(),Spline:SN()}),Data:uA?lA:(uA=1,lA={DataManager:hc(),DataManagerPlugin:_N(),Events:oc()}),Display:sP?nP:(sP=1,nP={Align:CN(),BaseShader:AN(),Bounds:CA?_A:(CA=1,_A={CenterOn:kh(),GetBottom:rh(),GetBounds:PN(),GetCenterX:ah(),GetCenterY:yh(),GetLeft:uh(),GetOffsetX:bA?TA:(bA=1,TA=function(t){return t.width*t.originX}),GetOffsetY:EA?SA:(EA=1,SA=function(t){return t.height*t.originY}),GetRight:fh(),GetTop:Th(),SetBottom:vh(),SetCenterX:oh(),SetCenterY:xh(),SetLeft:ch(),SetRight:ph(),SetTop:hh()}),Canvas:OA?LA:(OA=1,LA={CanvasInterpolation:Uk(),CanvasPool:Hl(),Smoothing:Wl(),TouchAction:(PA||(PA=1,AA=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t}),AA),UserSelect:(RA||(RA=1,MA=function(t,e){return void 0===e&&(e="none"),["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(i){t.style[i+"user-select"]=e}),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t}),MA)}),Color:LN(),ColorMatrix:lu(),Masks:tP?QA:(tP=1,QA={BitmapMask:Uu(),GeometryMask:zu()}),RGB:ON()}),DOM:HN(),Events:DP?FP:(DP=1,FP={EventEmitter:VN()}),FX:xu(),Game:RU(),GameObjects:i4(),Geom:Q4(),Input:v6(),Loader:Ctt(),Math:kk(),Physics:H9?W9:(H9=1,W9={Arcade:aet()}),Plugins:J9?Z9:(J9=1,Z9={BasePlugin:oet(),DefaultPlugins:qI(),PluginCache:ku(),PluginManager:nU(),ScenePlugin:het()}),Renderer:(wet||(wet=1,Drt.exports={Events:Yk(),Snapshot:cet?uet:(cet=1,uet={Canvas:zk(),WebGL:eN()})},Drt.exports.Canvas=fet?det:(fet=1,det={CanvasRenderer:Wk(),GetBlendModes:Xk(),SetTransform:YU()}),Drt.exports.WebGL=function(){if(xet)return yet;xet=1;var t=qk(),e=nh(),i={PipelineManager:tN(),Pipelines:Irt(),RenderTarget:Hk(),Utils:Zk(),WebGLPipeline:$k(),WebGLRenderer:hN(),WebGLShader:Jk(),Wrappers:krt()};return i=e(!1,i,t),yet=i}()),Drt.exports),Scale:Brt(),ScaleModes:th(),Scene:pU(),Scenes:Urt(),Structs:Met?Pet:(Met=1,Pet={Events:FU(),List:LU(),Map:fI(),ProcessQueue:DU(),RTree:qtt(),Set:lV(),Size:sU()}),Textures:zrt(),Tilemaps:Elt(),Time:jot?Vot:(jot=1,Vot={Clock:Clt(),Events:Alt(),Timeline:Plt(),TimerEvent:_lt()}),Tweens:Hlt(),Utils:xlt?ylt:(xlt=1,ylt={Array:tu(),Base64:rlt?slt:(rlt=1,slt={ArrayBufferToBase64:Vlt(),Base64ToArrayBuffer:jlt()}),Objects:llt?hlt:(llt=1,hlt={Clone:uU(),DeepCopy:Vu(),Extend:nh(),GetAdvancedValue:BU(),GetFastValue:Wh(),GetMinMaxValue:qlt(),GetValue:Ol(),HasAll:EV(),HasAny:_V(),HasValue:hV(),IsPlainObject:ih(),Merge:cU(),MergeRight:PV(),Pick:fot(),SetValue:DZ()}),String:mlt?vlt:(mlt=1,vlt={Format:(clt||(clt=1,ult=function(t,e){return t.replace(/%([0-9]+)/g,function(t,i){return e[Number(i)-1]})}),ult),Pad:ll(),RemoveAt:(flt||(flt=1,dlt=function(t,e){return 0===e?t.slice(1):t.slice(0,e)+t.slice(e+1)}),dlt),Reverse:(glt||(glt=1,plt=function(t){return t.split("").reverse().join("")}),plt),UppercaseFirst:mD(),UUID:zV()}),NOOP:Hh(),NULL:Cat()})};return i=e(!1,i,t),wlt=i,I.Phaser=i,wlt}());const Zlt=(t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},Jlt=t=>t*(Math.PI/180),$lt=t=>t*(180/Math.PI),Qlt=new Map,tut=t=>{Qlt.has(t)&&clearTimeout(Qlt.get(t)),Qlt.set(t,setTimeout(t,100))},eut=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent&&t.attachEvent(s,i)},iut=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.removeEventListener?t.removeEventListener(s,i):t.detachEvent&&t.detachEvent(s,i)},nut=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),sut=()=>({x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}),rut=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},aut=(t,e,i)=>{const n=out(t);for(let t in n)if(n.hasOwnProperty(t))if("string"==typeof e)n[t]=e+" "+i;else{let s="";for(let t=0,n=e.length;t<n;t+=1)s+=e[t]+" "+i+", ";n[t]=s.slice(0,-2)}return n},out=t=>{const e={};e[t]="";return["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},hut=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},lut=(t,e)=>{if(t.length)for(let i=0,n=t.length;i<n;i+=1)e(t[i]);else e(t)};var uut,cut=!!("ontouchstart"in window),dut=!!window.PointerEvent,fut=!!window.MSPointerEvent,put={start:"mousedown",move:"mousemove",end:"mouseup"},gut={};function vut(){}function mut(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=mut.id,mut.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function yut(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=yut.id,yut.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),"static"!==i.options.mode&&"semi"!==i.options.mode||(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);const n=getComputedStyle(i.options.zone.parentElement);return n&&"flex"===n.display&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}function xut(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=sut(),e.config(t),e.prepareCollections();var i=function(){var t;e.collections.forEach(function(i){i.forEach(function(i){t=i.el.getBoundingClientRect(),i.position={x:e.scroll.x+t.left,y:e.scroll.y+t.top}})})};eut(window,"resize",function(){tut(i)});var n=function(){e.scroll=sut()};return eut(window,"scroll",function(){tut(n)}),e.collections}dut?uut={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:fut?uut={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:cut?(uut={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},gut=put):uut=put,vut.prototype.on=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]=n._handlers_[i]||[],n._handlers_[i].push(e);return n},vut.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},void 0===t?i._handlers_={}:void 0===e?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i},vut.prototype.trigger=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]&&n._handlers_[i].length&&n._handlers_[i].forEach(function(t){t.call(n,{type:i,target:n},e)})},vut.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=((t,e)=>{const i={};for(let n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:t.hasOwnProperty(n)&&(i[n]=t[n]);return i})(e.options,t))},vut.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){"function"==typeof i["on"+e]?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},eut(t,uut[e],i._domHandlers_[e]),gut[e]&&eut(t,gut[e],i._domHandlers_[e]),i},vut.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},iut(t,uut[e],i._domHandlers_[e]),gut[e]&&iut(t,gut[e],i._domHandlers_[e]),delete i._domHandlers_[e],this},mut.prototype=new vut,mut.constructor=mut,mut.id=0,mut.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},mut.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=((t,e)=>{const i=out(t);for(let t in i)i.hasOwnProperty(t)&&(i[t]=e);return i})("borderRadius","50%"),i=aut("transition","opacity",t),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:100},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},hut(n.el,i),"circle"===this.options.shape&&hut(n.back,e),hut(n.front,e),this.applyStyles(n),this},mut.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this},mut.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},mut.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},mut.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},mut.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),"function"==typeof t&&t.call(this)},e.options.fadeTime)),e},mut.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i="dynamic"===e.options.mode?"none":"block";e.ui.el.style.display=i,"function"==typeof t&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const i=e.options.restJoystick,n={};n.x=!0===i||!1!==i.x?0:e.instance.frontPosition.x,n.y=!0===i||!1!==i.y?0:e.instance.frontPosition.y,e.setPosition(t,n)}return e},mut.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",s={};s.front=aut("transition",["transform"],n);var r={front:{}};r.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(s),i.applyStyles(r),i.restTimeout=setTimeout(function(){"function"==typeof t&&t.call(i),i.restCallback()},i.options.fadeTime)},mut.prototype.restCallback=function(){var t=this,e={};e.front=aut("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)},mut.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},mut.prototype.computeDirection=function(t){var e,i,n,s=t.angle.radian,r=Math.PI/4,a=Math.PI/2;if(s>r&&s<3*r&&!t.lockX?e="up":s>-r&&s<=r&&!t.lockY?e="left":s>3*-r&&s<=-r&&!t.lockX?e="down":t.lockY||(e="right"),t.lockY||(i=s>-a&&s<a?"left":"right"),t.lockX||(n=s>0?"up":"down"),t.force>this.options.threshold){var o,h={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(h[o]=this.direction[o]);var l={};for(o in this.direction={x:i,y:n,angle:e},t.direction=this.direction,h)h[o]===this.direction[o]&&(l[o]=!0);if(l.x&&l.y&&l.angle)return t;l.x&&l.y||this.trigger("plain",t),l.x||this.trigger("plain:"+i,t),l.y||this.trigger("plain:"+n,t),l.angle||this.trigger("dir dir:"+e,t)}else this.resetDirection();return t},yut.prototype=new vut,yut.constructor=yut,yut.id=0,yut.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(t){if(void 0===t)return e[0];for(var i=0,n=e.length;i<n;i+=1)if(e[i].identifier===t)return e[i];return!1}},yut.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"},yut.prototype.begin=function(){var t=this,e=t.options;if("static"===e.mode){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}},yut.prototype.createNipple=function(t,e){var i=this,n=i.manager.scroll,s={},r=i.options,a=i.parentIsFlex?n.x:n.x+i.box.left,o=i.parentIsFlex?n.y:n.y+i.box.top;if(t.x&&t.y)s={x:t.x-a,y:t.y-o};else if(t.top||t.right||t.bottom||t.left){var h=document.createElement("DIV");h.style.display="hidden",h.style.top=t.top,h.style.right=t.right,h.style.bottom=t.bottom,h.style.left=t.left,h.style.position="absolute",r.zone.appendChild(h);var l=h.getBoundingClientRect();r.zone.removeChild(h),s=t,t={x:l.left+n.x,y:l.top+n.y}}var u=new mut(i,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:e,position:t,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(rut(u.ui.el,s),rut(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u},yut.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},yut.prototype.bindNipple=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},yut.prototype.pressureFn=function(t,e,i){var n=this,s=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var i=t.force||t.pressure||t.webkitForce||0;i!==s&&(e.trigger("pressure",i),n.trigger("pressure "+e.identifier+":pressure",i),s=i)}.bind(n),100)},yut.prototype.onstart=function(t){var e=this,i=e.options,n=t;t=nut(t),e.updateBox();return lut(t,function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(i){if(Object.values(n.touches).findIndex(function(t){return t.identifier===i})<0){var s=[t[0]];s.identifier=i,e.processOnEnd(s)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))}),e.manager.bindDocument(),!1},yut.prototype.processOnStart=function(t){var e,i=this,n=i.options,s=i.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,a={x:t.pageX,y:t.pageY},o=i.getOrCreate(s,a);o.identifier!==s&&i.manager.removeIdentifier(o.identifier),o.identifier=s;var h=function(e){e.trigger("start",e),i.trigger("start "+e.id+":start",e),e.show(),r>0&&i.pressureFn(t,e,e.identifier),i.processOnMove(t)};if((e=i.idles.indexOf(o))>=0&&i.idles.splice(e,1),i.actives.push(o),i.ids.push(o.identifier),"semi"!==n.mode)h(o);else{if(!(Zlt(a,o.position)<=n.catchDistance))return o.destroy(),void i.processOnStart(t);h(o)}return o},yut.prototype.getOrCreate=function(t,e){var i,n=this,s=n.options;return/(semi|static)/.test(s.mode)?(i=n.idles[0])?(n.idles.splice(0,1),i):"semi"===s.mode?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1):i=n.createNipple(e,t)},yut.prototype.processOnMove=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.scroll;if((t=>isNaN(t.buttons)?0!==t.pressure:0!==t.buttons)(t)){if(!s)return console.error("Found zombie joystick with ID "+n),void e.manager.removeIdentifier(n);if(i.dynamicPage){var a=s.el.getBoundingClientRect();s.position={x:r.x+a.left,y:r.y+a.top}}s.identifier=n;var o=s.options.size/2,h={x:t.pageX,y:t.pageY};i.lockX&&(h.y=s.position.y),i.lockY&&(h.x=s.position.x);var l,u,c=Zlt(h,s.position),d=((t,e)=>{const i=e.x-t.x,n=e.y-t.y;return $lt(Math.atan2(n,i))})(h,s.position),f=Jlt(d),p=c/o,g={distance:c,position:h};if("circle"===s.options.shape?(l=Math.min(c,o),u=((t,e,i)=>{const n={x:0,y:0};return i=Jlt(i),n.x=t.x-e*Math.cos(i),n.y=t.y-e*Math.sin(i),n})(s.position,l,d)):(u=((t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)}))(h,s.position,o),l=Zlt(u,s.position)),i.follow){if(c>o){let t=h.x-u.x,i=h.y-u.y;s.position.x+=t,s.position.y+=i,s.el.style.top=s.position.y-(e.box.top+r.y)+"px",s.el.style.left=s.position.x-(e.box.left+r.x)+"px",c=Zlt(h,s.position)}}else h=u,c=l;var v=h.x-s.position.x,m=h.y-s.position.y;s.frontPosition={x:v,y:m},i.dataOnly||(s.ui.front.style.transform="translate("+v+"px,"+m+"px)");var y={identifier:s.identifier,position:h,force:p,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:f,degree:d},vector:{x:v/o,y:-m/o},raw:g,instance:s,lockX:i.lockX,lockY:i.lockY};(y=s.computeDirection(y)).angle={radian:Jlt(180-d),degree:180-d},s.trigger("move",y),e.trigger("move "+s.id+":move",y)}else this.processOnEnd(t)},yut.prototype.processOnEnd=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.removeIdentifier(s.identifier);s&&(i.dataOnly||s.hide(function(){"dynamic"===i.mode&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(i.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[r.id]=r.identifier))},yut.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()},yut.prototype.destroy=function(){var t=this;for(var e in t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(t){t.destroy()}),t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()},xut.prototype=new vut,xut.constructor=xut,xut.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(t){return!(i=t.get(e))}),i}},xut.prototype.create=function(t){return this.createCollection(t)},xut.prototype.createCollection=function(t){var e=this,i=new yut(e,t);return e.bindCollection(i),e.collections.push(i),i},xut.prototype.bindCollection=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},xut.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)},xut.prototype.unbindDocument=function(t){var e=this;Object.keys(e.ids).length&&!0!==t||(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)},xut.prototype.getIdentifier=function(t){var e;return t?void 0===(e=void 0===t.identifier?t.pointerId:t.identifier)&&(e=this.latest||0):e=this.index,void 0===this.ids[e]&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},xut.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e},xut.prototype.onmove=function(t){return this.onAny("move",t),!1},xut.prototype.onend=function(t){return this.onAny("end",t),!1},xut.prototype.oncancel=function(t){return this.onAny("end",t),!1},xut.prototype.onAny=function(t,e){var i,n=this,s="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=nut(e);var r=function(t,e,i){i.ids.indexOf(e)>=0&&(i[s](t),t._found_=!0)};return lut(e,function(t){i=n.getIdentifier(t),lut(n.collections,r.bind(null,t,i)),t._found_||n.removeIdentifier(i)}),!1},xut.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(t){t.destroy()}),t.off()},xut.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};const wut=new xut;var Tut=function(t){return wut.create(t)};class but{constructor(t){this.name=t,this.el=null}render(t){}toggle(){if(!this.el)return;const t="none"===this.el.style.display;this.el.style.display=t?"":"none"}close(){this.el.style.display=""}}class Sut{constructor(t){this.container=t,this.messages=[],this.maxMessages=10,this.displayTime=5e3}add(t){const e=document.createElement("div");if(e.className="live-chat-message",e.innerHTML=t,this.container.appendChild(e),this.messages.push(e),this.messages.length>this.maxMessages){const t=this.messages.shift();this._removeMessage(t)}setTimeout(()=>{this._removeMessage(e),this.messages=this.messages.filter(t=>t!==e)},this.displayTime)}_removeMessage(t){this.container.contains(t)&&this.container.removeChild(t)}}class Eut{static schema={topleftchatlog:{default:!1,name:"Top left Chat Log",type:"boolean",desc:"Enable or disable top-left chat log",category:"general"},use12hFormat:{default:!1,name:"12h time format",type:"boolean",desc:"Use 12h time format (AM/PM)",category:"general"},editorOneTimeClick:{default:!1,name:"One time click",type:"boolean",desc:"Click one time instead of clicking 2 times when editing a element",category:"development"},debug:{default:!1,name:"Debug mode",type:"boolean",desc:"Requires restart",category:"development"}};static store=Object.fromEntries(Object.entries(Eut.schema).map(([t,e])=>[t,e.default]));static loadFromLocalStorage(){const t=JSON.parse(localStorage.getItem("options"));if(t)for(const e in t)e in Eut.store&&(Eut.store[e]=t[e])}static saveToLocalStorage(){localStorage.setItem("options",JSON.stringify(Eut.store))}static get(t){if(!(t in Eut.store))throw new Error(`Option "${t}" is not defined.`);return Eut.store[t]}static put(t,e){const i=Eut.schema[t];if(!i)throw new Error(`Option "${t}" does not exist.`);switch(i.type){case"string":if("string"!=typeof e)throw new Error(`"${t}" must be a string.`);if(e.length<i.minLength||e.length>i.maxLength)throw new Error(`"${t}" length must be between ${i.minLength} and ${i.maxLength}.`);break;case"number":if("number"!=typeof e)throw new Error(`"${t}" must be a number.`);if(e<i.min||e>i.max)throw new Error(`"${t}" must be between ${i.min} and ${i.max}.`);break;case"boolean":if("boolean"!=typeof e)throw new Error(`"${t}" must be a boolean.`);break;case"array":if(!Array.isArray(e))throw new Error(`"${t}" must be an array.`);break;case"object":if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(`"${t}" must be an object.`);break;case"select":if(!i.options.includes(e))throw new Error(`"${t}" must be one of: ${i.options.join(", ")}.`);break;default:throw new Error(`Unsupported type for "${t}".`)}Eut.store[t]=e,Eut.saveToLocalStorage()}static resetAll(){Eut.store=Object.fromEntries(Object.entries(Eut.schema).map(([t,e])=>[t,e.default])),Eut.saveToLocalStorage()}}Eut.loadFromLocalStorage();class _ut{static commands=[{name:"rand",id:"/rand",description:"Random integer between two numbers: /rand min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /rand min max",!0);const n=Number(i[0]),s=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(s))return void e.send("Both min and max must be valid numbers.",!0);let r=Math.ceil(Math.min(n,s)),a=Math.floor(Math.max(n,s));const o=Math.floor(Math.random()*(a-r+1))+r;e.send("Random number between "+String(r)+" and "+String(a)+": "+String(o),!0)}},{name:"randf",id:"/randf",description:"Random float between two numbers: /randf min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /randf min max",!0);const n=Number(i[0]),s=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(s))return void e.send("Both min and max must be valid numbers.",!0);const r=Math.min(n,s),a=Math.max(n,s),o=Math.random()*(a-r)+r;e.send("Random float between "+String(r)+" and "+String(a)+": "+String(o),!0)}},{name:"choose",id:"/choose",description:"Choose one item from a list: /choose option1 option2 ...",execute:(t,e,i)=>{if(!i||0===i.length)return void e.send("Usage: /choose option1 option2 ...",!0);const n=i[Math.floor(Math.random()*i.length)];e.send('Choose "'+n+'"',!0)}},{name:"time",id:"/time",description:"Show current local date/time",execute:(t,e,i)=>{const n=new Date;e.send(n.toString(),!0)}}];static parseArgs(t){if(!t||"string"!=typeof t)return[];const e=t.trim().split(" ").slice(1).join(" "),i=[],n=/"([^"\\]*(\\.[^"\\]*)*)"|'([^'\\]*(\\.[^'\\]*)*)'|(\S+)/g;let s;for(;null!==(s=n.exec(e));)void 0!==s[1]?i.push(s[1].replace(/\\(["'\\])/g,"$1")):void 0!==s[3]?i.push(s[3].replace(/\\(["'\\])/g,"$1")):void 0!==s[5]&&i.push(s[5]);return i}static isCommand(t){if(!t||"string"!=typeof t)return!1;const e=t.trim();if(!e.startsWith("/"))return!1;const i=e.split(" ")[0];return _ut.commands.some(t=>t.id===i)}static handleCommand(t,e,i){if(!_ut.isCommand(t))return!1;const n=t.split(" ")[0],s=_ut.commands.find(t=>t.id===n);if(!s)return!1;const r=_ut.parseArgs(t);try{return s.execute(e,i,r),!0}catch(t){return console.error("Command error:",t),i.send("Command execution error.",!0),!1}}}class Cut extends but{constructor({scene:t,network:e,minChars:i=1,maxChars:n=75}){super("chatbox"),this.minChars=i,this.maxChars=n,this.visible=!1,this.logVisible=!1,this.scene=t,this.network=e,this.suggestIndex=-1,this.isTyping=!1,this.typingTimeout=null,this.TYPING_DELAY=5e3}render(t){this.el=document.createElement("div"),this.el.className="chatbox-container";const e=document.createElement("button");e.className="chatbox-button",e.innerHTML='<img src="'+a.getBlob("assets/icons/message.png").dataUrl+'" alt="Chat">',e.addEventListener("click",()=>this.toggleBox()),this.el.appendChild(e);const i=document.createElement("button");i.className="chatbox-log-button",i.innerHTML='<img src="'+a.getBlob("assets/icons/list.png").dataUrl+'" alt="Chat List">',i.addEventListener("click",()=>this.toggleLogBox()),this.el.appendChild(i),this.chatBox=document.createElement("div"),this.chatBox.className="chatbox-box",this.chatBox.style.display="none",this.chatBoxLog=document.createElement("div"),this.chatBoxLog.className="chatbox-log-box",this.chatBoxLog.style.display="none",this.textarea=document.createElement("input"),this.textarea.className="chatbox-input",this.textarea.setAttribute("placeholder","Write your message..."),this.textarea.setAttribute("maxlength",this.maxChars),this.chatBox.appendChild(this.textarea),this.suggestBox=document.createElement("div"),this.suggestBox.className="chatbox-suggest",this.suggestBox.style.display="none",this.suggestBox.setAttribute("role","listbox"),this.chatBox.appendChild(this.suggestBox),this.charCounter=document.createElement("div"),this.charCounter.className="chatbox-counter",this.updateCounter(),this.chatBox.appendChild(this.charCounter);const n=document.createElement("button");n.className="chatbox-send",n.innerHTML='<img src="'+a.getBlob("assets/icons/rightarrow.png").dataUrl+'">',n.disabled=!0,n.addEventListener("click",()=>this.handleSend()),this.chatBox.appendChild(n),this.textarea.addEventListener("input",()=>{const t=this.textarea.value.trim().length;n.disabled=t<this.minChars,this.updateCounter(),this.updateSuggestions(),this._onUserTyping()}),this.textarea.addEventListener("keydown",t=>{"Enter"===t.key&&this.handleSend()}),document.getElementById("chat-log"),this.lchatlog=new Sut(t),this.el.appendChild(this.chatBox),this.el.appendChild(this.chatBoxLog),t.appendChild(this.el)}_emitTyping(t){this.scene.networkManager.emitTyping(t)}_onUserTyping(){this.isTyping||(this.isTyping=!0,this._emitTyping(!0)),this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(()=>{this.isTyping=!1,this._emitTyping(!1),this.typingTimeout=null},this.TYPING_DELAY)}_stopTypingImmediate(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null),this.isTyping&&(this.isTyping=!1,this._emitTyping(!1))}toggleBox(){this.visible=!this.visible,this.chatBox.style.display=this.visible?"flex":"none",this.visible?this.textarea.focus():(this._stopTypingImmediate(),this.textarea.value=""),this.scene.inputManager.setKeysStatus(!this.visible)}toggleLogBox(){this.logVisible=!this.logVisible,this.chatBoxLog.style.display=this.logVisible?"flex":"none"}updateCounter(){const t=this.textarea.value.length;this.charCounter.textContent=`${t}/${this.maxChars}`}handleSend(){const t=this.textarea.value.trim();t.length>=this.minChars&&t.length<=this.maxChars&&(this.send(t),this.textarea.value="",this.updateCounter(),this.chatBox.style.display="none",this.visible=!1,this.hideSuggestions(),this._stopTypingImmediate())}send(t,e=!1){_ut.isCommand(t)?_ut.handleCommand(t,this.scene,this):this.scene.networkManager.emitChatMessage(t,e)}addMessage(t,e,i){const n=document.createElement("span");n.className="chatbox-log-message";const s=document.createElement("span");s.textContent=this.scene.lightManager.getTimeF(),s.className="timestamp";const r=document.createElement("span");r.textContent=t,r.className="name";const a=document.createElement("span");a.textContent=e,a.className="message",i&&(a.style.color="yellow"),n.appendChild(s),n.appendChild(r),n.appendChild(a),Eut.get("topleftchatlog")&&this.lchatlog.add(n.innerHTML),this.chatBoxLog.appendChild(n)}updateSuggestions(){const t=this.textarea.value;if(!t.startsWith("/"))return void this.hideSuggestions();const e=t.slice(1).toLowerCase(),i=(_ut.commands||[]).filter(t=>{const i=(t.name||"").toLowerCase(),n=(t.id||"").toLowerCase();return i.includes(e)||n.includes(e)});i.length?(this.suggestBox.innerHTML="",i.slice(0,8).forEach((t,e)=>{const i=document.createElement("div");i.className="chatbox-suggest-item",i.setAttribute("role","option"),i.textContent=`/${t.name} â ${t.description||""}`,i.addEventListener("click",e=>{e.preventDefault(),this.applySuggestion(t)}),this.suggestBox.appendChild(i)}),this.suggestIndex=-1,this.updateSuggestHighlight(),this.suggestBox.style.display="block"):this.hideSuggestions()}applySuggestion(t){this.textarea.value=`/${t.name} `,this.updateCounter(),this.hideSuggestions(),this.textarea.focus(),this._onUserTyping()}hideSuggestions(){this.suggestBox&&(this.suggestBox.style.display="none",this.suggestBox.innerHTML="",this.suggestIndex=-1)}updateSuggestHighlight(){Array.from(this.suggestBox.querySelectorAll(".chatbox-suggest-item")).forEach((t,e)=>{e===this.suggestIndex?(t.classList.add("active"),t.scrollIntoView({block:"nearest"})):t.classList.remove("active")})}}class Aut extends but{constructor({scene:t}){super("options"),this.options=[{execute:()=>{t.inputManager.optionsModal.toggle()},html:"<img src='"+a.getBlob("assets/icons/control.png").dataUrl+"'>Settings",name:"options"},{execute:()=>{window.location.reload()},html:"<img src='"+a.getBlob("assets/icons/leave.png").dataUrl+"'>Leave",name:"leave"}],t.dev&&this.options.push({execute:()=>{t.inputManager.editorModal.toggle()},html:"<img src='"+a.getBlob("assets/icons/box.png").dataUrl+"'>Map editor",name:"open_editor"}),this.scene=t,this.headerTime=null,this.scene.lightManager.onTimeChange(t=>{this.headerTime&&(this.headerTime.textContent=t.getTimeF())})}render(t){const e=document.createElement("button");e.innerHTML='<img src="'+a.getBlob("assets/icons/settings.png").dataUrl+'">',e.className="options-button",e.onclick=()=>this.toggle(),this.el=document.createElement("ul"),this.el.className="options-list",this.el.style.display="none";const i=document.createElement("div");i.innerHTML="<div class=\"header-brand\"><img src='/logo.png'>Hawk</div>",i.className="options-header",this.headerTime=document.createElement("div"),i.appendChild(this.headerTime),this.el.appendChild(i),this.options.forEach(t=>{const e=document.createElement("li");e.innerHTML=t.html,e.addEventListener("click",()=>{t.execute()}),this.el.appendChild(e)}),t.appendChild(e),t.appendChild(this.el)}}class Put extends but{constructor({onZoomIn:t,onZoomOut:e}){super("zoom"),this.onZoomIn=t,this.onZoomOut=e}render(t){this.el=document.createElement("div"),this.el.className="zoom-container";const e=document.createElement("button");e.innerHTML='<img src="'+a.getBlob("assets/icons/plus.png").dataUrl+'">',e.className="zoom-button",e.onclick=this.onZoomIn;const i=document.createElement("button");i.innerHTML='<img src="'+a.getBlob("assets/icons/hyphen.png").dataUrl+'">',i.className="zoom-button",i.onclick=this.onZoomOut,this.el.appendChild(e),this.el.appendChild(i),t.appendChild(this.el)}}class Mut extends but{constructor({scene:t,onClickMe:e,onClickPeople:i}){super("acc"),this.onClickMe=e,this.onClickPeople=i,this.scene=t,this.peopleVisible=!1}render(t){this.el=document.createElement("div"),this.el.className="acc-container";const e=document.createElement("button");e.innerHTML='<img src="'+a.getBlob("assets/icons/Person.png").dataUrl+'">',e.className="acc-button",e.onclick=this.onClickMe;const i=document.createElement("button");i.innerHTML='<img src="'+a.getBlob("assets/icons/people.png").dataUrl+'">',i.className="acc-button",i.onclick=()=>this.togglePeople(),this.peopleContainer=document.createElement("div"),this.peopleContainer.className="people-container",this.peopleContainer.style.display="none";const n=document.createElement("div");n.innerHTML='<div class="header-brand"><img src=\''+a.getBlob("assets/icons/people.png").dataUrl+"'>People</div><button class=\"header-button\"><img src='"+a.getBlob("assets/icons/friends.png").dataUrl+"'></button>",n.className="people-header",n.querySelector("button").addEventListener("click",()=>{this.scene.inputManager.peopleModal.toggle()}),this.peopleList=document.createElement("ul"),this.peopleList.className="people-list",this.peopleContainer.appendChild(n),this.peopleContainer.appendChild(this.peopleList),this.el.appendChild(e),this.el.appendChild(i),t.appendChild(this.el),t.appendChild(this.peopleContainer)}togglePeople(){if(this.peopleVisible=!this.peopleVisible,this.peopleContainer.style.display=this.peopleVisible?"block":"none",this.peopleVisible){const t=this.scene.networkManager.players;t!={}?(this.peopleList.innerHTML="",Object.values(t).forEach(t=>{const e=document.createElement("li"),i=document.createElement("div");i.className="people-user-header";const n=document.createElement("img");n.src=t.avatar||"logo.png";const s=document.createElement("p");s.innerText=t.display_name+(t.id==this.scene.player.id?" (you)":"");const r=document.createElement("p");r.className="accent",r.innerText="@"+t.username,i.appendChild(n),i.appendChild(s),e.appendChild(i),e.appendChild(r),this.peopleList.appendChild(e)})):this.peopleList.innerHTML="<small class='accent'>There are no people nearby.</small>"}}}class Rut{constructor(t,{components:e=[]}){this.container=document.createElement("div"),this.container.id="game-hud",this.container.style.display="none",Object.assign(this.container.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"});const i=document.createElement("p");i.innerText="FPS: 0",i.id="fps-text",this.container.appendChild(i);"static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(this.container),this.components=e.map(t=>{const e=new(0,t.type)(t.options||{});return e.render(this.container),e})}getComponent(t){return this.components.find(e=>e.name===t)}}class Lut{constructor(t,e,i=null,n={showHeader:!0}){this.scene=i,this.overlay=document.createElement("div"),this.overlay.className="modal-overlay",this.modal=document.createElement("div"),this.modal.className="modal-container";const s=document.createElement("div");s.className="modal-header";const r=document.createElement("p");r.textContent=e,s.appendChild(r),this.closeBtn=document.createElement("button"),this.closeBtn.className="modal-close",this.closeBtn.innerHTML="&times;",this.closeBtn.addEventListener("click",()=>this.toggle()),s.appendChild(this.closeBtn),this.body=document.createElement("div"),this.body.className="modal-body",n.showHeader?this.modal.append(s,this.body):this.modal.append(this.body),this.overlay.appendChild(this.modal),t.appendChild(this.overlay),this.isOpen=!1}toggle(){this.isOpen=!this.isOpen,this.overlay.style.display=this.isOpen?"flex":"none",this.scene&&this.scene.inputManager.joystickModalEnable(this.isOpen)}}class Out extends Lut{constructor(t,e){super(t,"Options",e,{showHeader:!1}),this.categories=this._groupByCategory(),this._categoriesInfo={general:{icon:"assets/icons/generalinfo.png",name:"General"},development:{icon:"assets/icons/control.png",name:"Development"}},this._originalValues={},this._buildTabs(),this._buildForms(),this._bindEvents(),this.scene=e}_groupByCategory(){const t={};for(const[e,i]of Object.entries(Eut.schema)){if("development"==i.category&&!this.scene.dev)continue;const n=i.category||"general";t[n]||(t[n]=[]),t[n].push({name:e,cfg:i})}return t}_buildTabs(){this.tabNav=document.createElement("ul"),this.tabNav.className="options-tabs",Object.keys(this.categories).forEach((t,e)=>{const i=document.createElement("li");i.innerHTML="<img src='"+this._categoriesInfo[t]?.icon+"'>",i.dataset.tab=t,0===e&&i.classList.add("active"),this.tabNav.append(i)}),this.body.append(this.tabNav)}_buildForms(){this.forms={},Object.entries(this.categories).forEach(([t,e],i)=>{const n=document.createElement("form");n.className="options-form",0!==i&&(n.style.display="none"),n.dataset.cat=t,e.forEach(({name:t,cfg:e})=>{const i=document.createElement("div");i.className="option-item";const s=document.createElement("label");let r;s.htmlFor=t,s.innerHTML=`${e.name}<br><span>${e.desc}</span>`,s.className="option-label",i.append(s);const a=Eut.get(t);switch(e.type){case"string":case"number":r=document.createElement("input"),r.type="string"===e.type?"text":"number",void 0!==e.min&&(r.min=e.min),void 0!==e.max&&(r.max=e.max),void 0!==e.minLength&&(r.minLength=e.minLength),void 0!==e.maxLength&&(r.maxLength=e.maxLength),r.value=a;break;case"boolean":r=document.createElement("div");const t=document.createElement("input");t.type="checkbox",t.className="ikxBAC",t.checked=a,r.appendChild(t),i.className="option-item-checkbox";break;case"select":r=document.createElement("select"),e.options.forEach(t=>{const e=document.createElement("option");e.value=t,e.innerText=t,t===a&&(e.selected=!0),r.append(e)});break;case"array":r=document.createElement("textarea"),r.value=JSON.stringify(a);break;case"object":r=document.createElement("textarea"),r.value=JSON.stringify(a,null,2)}r.id=t,i.append(r),n.append(i)}),this.forms[t]=n,this.body.append(n)});const t=document.createElement("div");t.className="options-footer";const e=document.createElement("button");e.type="button",e.textContent="Save",e.className="button-save button-green",e.disabled=!0;const i=document.createElement("button");i.type="button",i.textContent="Cancel",i.className="button-cancel button-gray",t.appendChild(e),t.appendChild(i),this.body.append(t),this._btnSave=e,this._btnCancel=i}toggle(){super.toggle(),this.visible&&(this._captureOriginalValues(),this._setSaveDisabled(!0))}_captureOriginalValues(){this._originalValues={};for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Eut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;if("object"===i.type||"array"===i.type)try{this._originalValues[t]=JSON.parse(JSON.stringify(n))}catch{this._originalValues[t]=n}else this._originalValues[t]=n}}_setSaveDisabled(t){this._btnSave.disabled=t}_bindEvents(){this.tabNav.addEventListener("click",t=>{if("LI"!==t.target.tagName)return;const e=t.target.dataset.tab;[...this.tabNav.children].forEach(t=>t.classList.toggle("active",t.dataset.tab===e)),Object.values(this.forms).forEach(t=>{t.style.display=t.dataset.cat===e?"":"none"})}),this._btnCancel.addEventListener("click",()=>{this._restoreOriginalValues(),this.toggle()}),this._btnSave.addEventListener("click",()=>{try{for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Eut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else n="number"===i.type?""===e.value?null:Number(e.value):"array"===i.type||"object"===i.type?JSON.parse(e.value||("array"===i.type?"[]":"{}")):e.value;Eut.put(t,n)}this._captureOriginalValues(),this._setSaveDisabled(!0),this.toggle()}catch(t){console.error(t),alert(t.message)}});for(const t of Object.values(this.forms))t.addEventListener("input",()=>this._checkForModifications()),t.addEventListener("change",()=>this._checkForModifications())}_checkForModifications(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Eut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;const s=(t,e)=>{try{return JSON.stringify(t)===JSON.stringify(e)}catch{return t===e}};if(!s(n,this._originalValues[t]))return void this._setSaveDisabled(!1)}this._setSaveDisabled(!0)}_restoreOriginalValues(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Eut.schema[t],n=this._originalValues[t];if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");t&&(t.checked=!!n)}else if("number"===i.type)e.value=null==n?"":String(n);else if("array"===i.type||"object"===i.type)try{e.value=JSON.stringify(n,null,"object"===i.type?2:0)}catch{e.value=n}else e.value=void 0===n?"":String(n)}this._setSaveDisabled(!0)}}function Fut(t,e=!1,i=!1){(t||document.getElementById("app")).innerHTML=`\n  <div class="auth" ${i?'style="margin: 0 0;"':""}>\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/people.png").dataUrl}"></canv-icon>People</h3>\n    <span class="description">Send, recieve, accept friend requests.</span>\n            <div class="friends-actions">\n              <button id="refreshBtn" class="friends-ghost">Refresh</button>\n              ${i?'<button id="closeBtn" class="friends-ghost">Close</button>':""}\n            </div>\n  </div>\n  <hr>\n      <aside class="friends-sidebar mini">\n        <div class="friends-card" style="padding-bottom:10px">\n          <div style="margin-top:10px">\n            <div class="small" style="color:rgba(255,255,255,0.7)">Send friend request by username</div>\n            <div class="friends-send-row">\n              <input id="sendUserId" class="friends-input" placeholder="Username, ex cheese72" />\n              <button id="sendByIdBtn" class="friends-primary">Send</button>\n            </div>\n            <div id="sendResult" class="friends-empty" style="margin-top:8px"></div>\n          </div>\n        </div>\n\n        <div class="friends-card">\n          <div id="accountInfo" style="margin-top:8px;color:rgba(255,255,255,0.8)"></div>\n        </div>\n      </aside>\n\n      <section>\n        <div style="margin-bottom:8px">\n          <div class="friends-tabs" id="tabs">\n            <button class="friends-tab active" data-tab="friends">Friends</button>\n            <button class="friends-tab" data-tab="incoming">Incoming</button>\n            <button class="friends-tab" data-tab="sent">Sent</button>\n          </div>\n        </div>\n\n        <div id="panelArea">\n          <div id="friendsPanel" class="friends-list friends-card"></div>\n          <div id="incomingPanel" class="friends-list friends-card" style="display:none"></div>\n          <div id="sentPanel" class="friends-list friends-card" style="display:none"></div>\n        </div>\n      </section>\n      </div>\n  `;const n=h(),s=document.getElementById("accountInfo");async function r(){if(document.getElementById("friendsPanel").innerHTML='<div class="friends-empty">Loading friends...</div>',document.getElementById("incomingPanel").innerHTML='<div class="friends-empty">Loading incoming...</div>',document.getElementById("sentPanel").innerHTML='<div class="friends-empty">Loading sent...</div>',!n.username||!n.password)return t="Not authenticated. Please log in.",document.getElementById("friendsPanel").innerHTML=`<div class="friends-empty">${o(t)}</div>`,document.getElementById("incomingPanel").innerHTML=`<div class="friends-empty">${o(t)}</div>`,void(document.getElementById("sentPanel").innerHTML=`<div class="friends-empty">${o(t)}</div>`);var t;const[e,i,s]=await Promise.allSettled([l(x,n),l(w,n),l(T,n)]),a="fulfilled"===e.status&&e.value&&e.value.friends?e.value.friends:[],h="fulfilled"===i.status&&i.value?i.value:null,u="fulfilled"===s.status&&s.value?s.value:null;let p=[],g=[];u&&(Array.isArray(u.incoming)?p=u.incoming:Array.isArray(u.pending)&&(p=u.pending)),h&&(Array.isArray(h.sent)?g=h.sent:Array.isArray(h.requests)&&(g=h.requests)),function(t){const e=document.getElementById("friendsPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No friends yet."));t.forEach(t=>e.append(function(t){const e=document.createElement("div");e.className="friends-row";const i=document.createElement("div");i.innerHTML=`<div class="friends-name">${o(t.display_name||t.username||"Unnamed")}</div><div class="friends-meta">@${o(t.username)} Â· ID ${o(String(t.id))}</div>`;const s=document.createElement("div");s.className="friends-controls";const a=document.createElement("button");return a.className="friends-ghost",a.textContent="Remove",a.addEventListener("click",async()=>{await async function(t){if(!t)return;await l(C,{...n,friendUsername:t}),await r()}(t.username)}),s.appendChild(a),e.appendChild(i),e.appendChild(s),e}(t)))}(a),async function(t){const e=document.getElementById("incomingPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No incoming requests."));for(const i of t)e.append(await d(i))}(p),async function(t){const e=document.getElementById("sentPanel");if(e.innerHTML="",!Array.isArray(t)||!t.length)return void e.append(c("No sent requests."));for(const i of t)e.append(await f(i))}(g)}function c(t){const e=document.createElement("div");return e.className="friends-empty",e.textContent=t,e}async function d(t){const e=document.createElement("div");e.className="friends-row";const i=document.createElement("div"),s=t.requesterId,a=(await l("/api/auth/profile",{id:s})).username||"Unknown";i.innerHTML=`<div class="friends-name">From ${o(String(a))}</div><div class="friends-meta">Request ID: ${o(String(t.id||""))}</div>`;const h=document.createElement("div");h.className="friends-controls";const u=document.createElement("button");u.className="friends-primary",u.textContent="Accept";const c=document.createElement("button");return c.className="friends-ghost",c.textContent="Deny",u.addEventListener("click",async()=>{await async function(t){if(!t)return;await l(E,{...n,requestId:t}),await r()}(t.id)}),c.addEventListener("click",async()=>{await async function(t){if(!t)return;await l(_,{...n,requestId:t}),await r()}(t.id)}),h.appendChild(u),h.appendChild(c),e.appendChild(i),e.appendChild(h),e}async function f(t){const e=document.createElement("div");e.className="friends-row";const i=document.createElement("div"),s=t.requestedId,a=(await l("/api/auth/profile",{id:s})).username||"Unknown";i.innerHTML=`<div class="friends-name">To ${o(String(a))}</div><div class="friends-meta">Request ID: ${o(String(t.id||""))}</div>`;const h=document.createElement("div");h.className="friends-controls";const u=document.createElement("button");return u.className="friends-ghost",u.textContent="Cancel",u.addEventListener("click",async()=>{await async function(t){if(!t)return;await l(S,{...n,requestId:t}),await r()}(t.id)}),h.appendChild(u),e.appendChild(i),e.appendChild(h),e}n.username&&n.password?s.innerHTML=`<div><strong>@${o(n.username)}</strong></div><div class="accent small">Your username</div>`:s.innerText="Not authenticated. Please log in.",u("#tabs .friends-tab").forEach(t=>{t.addEventListener("click",()=>{u("#tabs .friends-tab").forEach(t=>t.classList.remove("active")),t.classList.add("active");const e=t.dataset.tab;["friends","incoming","sent"].forEach(t=>{const i=document.getElementById(t+"Panel");i&&(i.style.display=t===e?"":"none")})})}),document.getElementById("sendByIdBtn").addEventListener("click",async()=>{const t=document.getElementById("sendUserId").value.trim();t&&await async function(t){if(!t)return alert("Enter a username.");const e={...n,targetUsername:t},i=await l(b,e),s=i&&(i.error||i.message||JSON.stringify(i));document.getElementById("sendResult").innerText=s||"Sent",await r()}(t)}),document.getElementById("refreshBtn").addEventListener("click",r),r()}class Dut extends Lut{constructor(t,e){super(t,"People",e,{showHeader:!1}),this.scene=e,Fut(this.body,!0,!0),this.body.querySelector("#closeBtn").addEventListener("click",t=>{this.toggle()})}toggle(){super.toggle()}}class Iut{static clickDelay=300;static states=new WeakMap;static current=null;static tooltip=null;static setEditable(t,e){const i=t.image;Iut.states.set(i,{editMode:!1,mode:"move",lastClickTime:0,raw:t,dragOffset:{x:0,y:0}}),i.setInteractive({draggable:!0}),Iut.tooltip||Iut._createTooltip(e),i.on("pointerdown",n=>{const s=Iut.states.get(i),r=e.time.now,a=r-s.lastClickTime,o="number"==typeof i.originX?i.originX:.5,h="number"==typeof i.originY?i.originY:.5,l=i.x-i.displayWidth*o,u=i.y-i.displayHeight*h;s.dragOffset.x=n.worldX-l,s.dragOffset.y=n.worldY-u,(Eut.get("editorOneTimeClick")||a<Iut.clickDelay)&&(Iut.current&&Iut.current!==i&&Iut._disableEdit(Iut.current,e),s.editMode?Iut._disableEdit(i,e,t):Iut._enableEdit(i,e,t)),s.lastClickTime=r}),i.on("drag",e=>{const n=Iut.states.get(i);if(!n.editMode||"move"!==n.mode)return;const s=e.worldX-n.dragOffset.x,r=e.worldY-n.dragOffset.y,a="number"==typeof i.originX?i.originX:.5,o="number"==typeof i.originY?i.originY:.5,h=s+i.displayWidth*a,l=r+i.displayHeight*o;t.setPosition(Math.floor(h),Math.floor(l)),Iut._updateTooltipPosition(i)})}static _createTooltip(t){const e=t.add.container(0,0),i=t.add.rectangle(0,0,102,20,0,.7).setOrigin(0),n=t.add.text(5,5,"Move",{fontSize:"12px",color:"#fff"}).setInteractive(),s=t.add.text(55,5,"Delete",{fontSize:"12px",color:"#f55"}).setInteractive();n.on("pointerdown",()=>{if(!Iut.current)return;Iut.states.get(Iut.current).mode="move",n.setStyle({backgroundColor:"#555"}),s.setStyle({backgroundColor:null})}),s.on("pointerdown",()=>{if(!Iut.current)return;const e=Iut.current,i=Iut.states.get(e).raw;Iut.tooltip.setVisible(!1),Iut.states.delete(e),t.networkManager.emitDeleteElement(i),t.mapObjects.destroy(i),Iut.current=null,t.inputManager.joystickSetEnabled(!0)}),e.add([i,n,s]),e.setDepth(1e8).setVisible(!1),Iut.tooltip=e}static _enableEdit(t,e,i){const n=Iut.states.get(t);n.editMode=!0,n.mode="move",t.setAlpha(.5),Iut.current=t,e.inputManager.joystickSetEnabled(!1),Iut.tooltip.setVisible(!0),Iut.tooltip.list[1].setStyle({backgroundColor:"#555"}),Iut.tooltip.list[2].setStyle({backgroundColor:null}),Iut._updateTooltipPosition(t)}static _disableEdit(t,e,i){const n=Iut.states.get(t);"delete"===n.mode&&t.emit("editableDelete",t),n.editMode=!1,t.setAlpha(1),Iut.current=null,e.inputManager.joystickSetEnabled(!0),Iut.tooltip.setVisible(!1),e.networkManager.emitMoveElement(i)}static _updateTooltipPosition(t){Iut.tooltip.x=t.x+0,Iut.tooltip.y=t.y+0-Iut.tooltip.list[0].height}}class kut{static _nextId=1;static textureCache=new Map;constructor(t,e,i,n,s,r,a,o=0){this.id=kut._nextId++,this.scene=t,this.width=r,this.height=a,this.zoffset=o,this.x=e,this.y=i;const h=kut.textureCache,l=`${n}|${s.u},${s.v}|${r}x${a}`;let u=h.get(l);if(u)u.refCount++;else{const e=t.textures.get(n).getSourceImage(),i=`crop-${n}-${s.u}-${s.v}-${r}x${a}`;if(!t.textures.exists(i)){t.textures.createCanvas(i,r,a);const n=t.textures.get(i);n.getSourceImage().getContext("2d").drawImage(e,s.u,s.v,r,a,0,0,r,a),n.refresh()}u={key:i,refCount:1},h.set(l,u)}this._cacheKey=l,this._textureKey=u.key,this.image=t.add.image(e,i,this._textureKey).setOrigin(0,0).setDepth(i),t.physics.add.existing(this.image),this.image.body.setSize(0,0).setBounce(1,1).setCollideWorldBounds(!0).setImmovable(!0),this.image.setData("id",this.id),t.dev&&Iut.setEditable(this,this.scene)}update(t,e){this.image.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){this.x=t,this.y=e,this.image.setPosition(t,e),this.image.setDepth(this.image.y+this.height-this.zoffset)}destroy(){this.image.body&&this.scene.physics.world.disableBody(this.image.body),this.image.destroy()}}class But extends kut{static texture="plants";static types=[{name:"1",uvStartPx:{u:19,v:76},widthPx:65,heightPx:108,zoffset:8,collision:{startx:25,starty:97,width:6,height:11}},{name:"2",uvStartPx:{u:104,v:59},widthPx:87,heightPx:124,zoffset:7,collision:{startx:35,starty:115,width:8,height:9}},{name:"3",uvStartPx:{u:196,v:42},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"4",uvStartPx:{u:319,v:21},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"5",uvStartPx:{u:445,v:5},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}},{name:"6",uvStartPx:{u:19,v:271},widthPx:65,heightPx:108,zoffset:10,collision:{startx:25,starty:97,width:6,height:11}},{name:"7",uvStartPx:{u:104,v:254},widthPx:87,heightPx:124,zoffset:8,collision:{startx:35,starty:115,width:8,height:9}},{name:"8",uvStartPx:{u:196,v:237},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"9",uvStartPx:{u:319,v:216},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"10",uvStartPx:{u:445,v:200},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(But.types.length),r=But.types[s];super(t,e,i,But.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Nut extends kut{static texture="props";static types=[{name:"1",uvStartPx:{u:683,v:1994},widthPx:14,heightPx:13,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"2",uvStartPx:{u:681,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"3",uvStartPx:{u:715,v:1994},widthPx:14,heightPx:13,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"4",uvStartPx:{u:713,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"5",uvStartPx:{u:740,v:1991},widthPx:22,heightPx:19,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"6",uvStartPx:{u:739,v:2028},widthPx:22,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"7",uvStartPx:{u:770,v:1990},widthPx:25,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"8",uvStartPx:{u:771,v:2021},widthPx:27,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"9",uvStartPx:{u:801,v:1991},widthPx:28,heightPx:19,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"10",uvStartPx:{u:847,v:1954},widthPx:28,heightPx:28,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"11",uvStartPx:{u:845,v:1990},widthPx:35,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"12",uvStartPx:{u:848,v:2016},widthPx:33,heightPx:27,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"13",uvStartPx:{u:904,v:1953},widthPx:41,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"14",uvStartPx:{u:909,v:1985},widthPx:36,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"15",uvStartPx:{u:912,v:2016},widthPx:34,heightPx:24,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"16",uvStartPx:{u:969,v:1965},widthPx:46,heightPx:36,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}},{name:"17",uvStartPx:{u:965,v:2016},widthPx:55,heightPx:30,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Nut.types.length),r=Nut.types[s];super(t,e,i,Nut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Uut extends kut{static texture="props";static types=[{name:"1",uvStartPx:{u:96,v:18},widthPx:39,heightPx:46,zoffset:20,collision:{startx:0,starty:26,width:32,height:20}},{name:"2",uvStartPx:{u:163,v:22},widthPx:31,heightPx:39,zoffset:10,collision:{startx:0,starty:25,width:26,height:14}},{name:"3",uvStartPx:{u:95,v:81},widthPx:41,heightPx:47,zoffset:20,collision:{startx:0,starty:27,width:32,height:20}},{name:"4",uvStartPx:{u:162,v:85},widthPx:33,heightPx:40,zoffset:10,collision:{startx:0,starty:25,width:26,height:24}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Uut.types.length),r=Uut.types[s];super(t,e,i,Uut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class zut extends kut{static texture="props";static types=[{name:"normal",uvStartPx:{u:225,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"without_cap",uvStartPx:{u:289,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_water",uvStartPx:{u:225,v:1178},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_plant",uvStartPx:{u:353,v:1104},widthPx:36,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"with_props",uvStartPx:{u:289,v:1168},widthPx:35,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"sided",uvStartPx:{u:225,v:1242},widthPx:32,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"pile",uvStartPx:{u:290,v:1225},widthPx:62,heightPx:54,zoffset:10,collision:{startx:0,starty:34,width:60,height:20}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(zut.types.length),r=zut.types[s];super(t,e,i,zut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Yut extends kut{static texture="props";static type={name:"1",uvStartPx:{u:491,v:1640},widthPx:13,heightPx:17,zoffset:3,collision:{startx:0,starty:11,width:9,height:6}};constructor(t,e,i,n={used:!1}){if(super(t,e,i,Yut.texture,Yut.type.uvStartPx,Yut.type.widthPx,Yut.type.heightPx,Yut.type.zoffset),this.type=Yut.type.name,this.light=t.lightManager.addLight(this.x+this.width/2,this.y+this.height/2,150,16777215,.9),n.used){const{startx:t,starty:e,width:i,height:n}=Yut.type.collision;this.image.body.setSize(i,n),this.image.body.setOffset(t,e)}}destroy(){this.scene.lightManager.removeLightObj(this.light),super.destroy()}}class Xut extends kut{static texture="props";static types=[{name:"1",uvStartPx:{u:391,v:1676},widthPx:64,heightPx:84,zoffset:9,collision:{startx:0,starty:74,width:17,height:10}},{name:"2",uvStartPx:{u:461,v:1676},widthPx:57,heightPx:84,zoffset:9,collision:{startx:28,starty:74,width:17,height:10}}];constructor(t,e,i,n=-1){const s={u:491,v:1640},r=9,a=17,o=Xut.texture,h=-1!=n?n:t.random.getNextInt(Xut.types.length),l=Xut.types[h];super(t,e,i,o,l.uvStartPx,l.widthPx,l.heightPx,l.zoffset),this.type=l.name;const{startx:u,starty:c,width:d,height:f}=l.collision;this.image.body.setSize(d,f),this.image.body.setOffset(u,c);const p=kut.textureCache,g=`${o}|${s.u},${s.v}|${r}x${a}`;let v=p.get(g);if(v)v.refCount++;else{const e=t.textures.get(o).getSourceImage(),i=`crop-${o}-${s.u}-${s.v}-${r}x${a}`;if(!t.textures.exists(i)){t.textures.createCanvas(i,r,a);const n=t.textures.get(i);n.getSourceImage().getContext("2d").drawImage(e,s.u,s.v,r,a,0,0,r,a),n.refresh()}v={key:i,refCount:1},p.set(g,v)}this.__cacheKey=g,this.__textureKey=v.key,this.lightXOffset=0==n?35:1,this.lightYOffset=22,this.lampImage=t.add.image(e+this.lightXOffset,i+this.lightYOffset,this.__textureKey).setOrigin(0,0).setDepth(i-1),this.light=t.lightManager.addLight(e+this.lightXOffset,i+this.lightYOffset,150,16777215,.9)}update(t,e){super.update(t,e),this.lampImage.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){super.setPosition(t,e),this.lampImage.setPosition(t+this.lightXOffset,e+this.lightYOffset),this.lampImage.setDepth(e-1),this.light.x=t+this.lightXOffset+4,this.light.y=e+this.lightYOffset+8}destroy(){super.destroy(),this.lampImage.body&&this.scene.physics.world.disableBody(this.lampImage.body),this.lampImage.destroy(),this.scene.lightManager.removeLightObj(this.light)}}class Gut extends kut{static texture="plants";static types=[{name:"1",uvStartPx:{u:34,v:899},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"2",uvStartPx:{u:93,v:896},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"3",uvStartPx:{u:153,v:887},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"4",uvStartPx:{u:217,v:890},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"5",uvStartPx:{u:293,v:886},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"6",uvStartPx:{u:379,v:886},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"7",uvStartPx:{u:472,v:872},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}},{name:"8",uvStartPx:{u:34,v:963},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"9",uvStartPx:{u:93,v:960},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"10",uvStartPx:{u:153,v:951},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"11",uvStartPx:{u:217,v:954},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"12",uvStartPx:{u:293,v:950},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"13",uvStartPx:{u:379,v:950},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"14",uvStartPx:{u:472,v:936},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Gut.types.length),r=Gut.types[s];super(t,e,i,Gut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Wut extends kut{static texture="plants";static types=[{name:"cabbage_1",uvStartPx:{u:867,v:646},widthPx:29,heightPx:22,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_2",uvStartPx:{u:931,v:648},widthPx:28,heightPx:19,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_3",uvStartPx:{u:999,v:652},widthPx:19,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_1",uvStartPx:{u:861,v:674},widthPx:38,heightPx:28,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_2",uvStartPx:{u:931,v:678},widthPx:31,heightPx:21,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_3",uvStartPx:{u:1e3,v:682},widthPx:18,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_1",uvStartPx:{u:869,v:707},widthPx:25,heightPx:24,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_2",uvStartPx:{u:935,v:711},widthPx:20,heightPx:18,zoffset:4,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_3",uvStartPx:{u:1e3,v:713},widthPx:16,heightPx:15,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Wut.types.length),r=Wut.types[s];super(t,e,i,Wut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Hut extends kut{static texture="building";static type={name:"1",uvStartPx:{u:569,v:425},widthPx:155,heightPx:279,zoffset:10,collision:{startx:0,starty:79,width:142,height:200}};constructor(t,e,i){super(t,e,i,Hut.texture,Hut.type.uvStartPx,Hut.type.widthPx,Hut.type.heightPx,Hut.type.zoffset),this.type=Hut.type.name;const{startx:n,starty:s,width:r,height:a}=Hut.type.collision;this.image.body.setSize(r,a),this.image.body.setOffset(n,s)}}class Vut extends kut{static texture="props";static types=[{name:"1",uvStartPx:{u:905,v:1728},widthPx:46,heightPx:32,zoffset:9,collision:{startx:0,starty:4,width:46,height:28}}];constructor(t,e,i){const n=Vut.types[0];super(t,e,i,Vut.texture,n.uvStartPx,n.widthPx,n.heightPx,n.zoffset),this.type=n.name;const{startx:s,starty:r,width:a,height:o}=n.collision;this.image.body.setSize(a,o),this.image.body.setOffset(s,r),this.lightXOffset=8,this.lightYOffset=-15,this.fireImage=t.add.image(e+this.lightXOffset,i+this.lightYOffset,"flame").setOrigin(0,0).setDepth(i-1),this.light=t.lightManager.addLight(e+this.lightXOffset+20,i+this.lightYOffset+20,150,16777215,.9),this.fireImage.tint=16742144,this.frame=0,this.frameTime=0}update(t,e){super.update(t,e),this.frameTime+=e,this.frameTime>=75&&(this.frameTime=0,this.frame=(this.frame+1)%25,this.fireImage.setFrame(this.frame)),this.fireImage.setDepth(this.image.y+this.height-this.zoffset)}setPosition(t,e){super.setPosition(t,e),this.fireImage.setPosition(t+this.lightXOffset,e+this.lightYOffset),this.fireImage.setDepth(e-1),this.light.x=t+this.lightXOffset+4,this.light.y=e+this.lightYOffset+8}destroy(){super.destroy(),this.fireImage.body&&this.scene.physics.world.disableBody(this.fireImage.body),this.fireImage.destroy(),this.scene.lightManager.removeLightObj(this.light)}}class jut extends kut{static texture="props";static types=[{name:"empty_h",uvStartPx:{u:224,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"empty_v",uvStartPx:{u:261,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"apple_h",uvStartPx:{u:224,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"apple_v",uvStartPx:{u:261,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"lemom_h",uvStartPx:{u:288,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"lemon_v",uvStartPx:{u:325,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"pear_h",uvStartPx:{u:288,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"pear_v",uvStartPx:{u:325,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"fish_h",uvStartPx:{u:352,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"fish_v",uvStartPx:{u:389,v:222},widthPx:25,heightPx:34,zoffset:10,collision:{startx:0,starty:11,width:23,height:23}},{name:"carrot_h",uvStartPx:{u:351,v:291},widthPx:36,heightPx:29,zoffset:4,collision:{startx:0,starty:19,width:33,height:10}},{name:"carrot_v",uvStartPx:{u:389,v:284},widthPx:25,heightPx:36,zoffset:10,collision:{startx:0,starty:13,width:23,height:23}},{name:"cabbage_h",uvStartPx:{u:415,v:290},widthPx:35,heightPx:30,zoffset:4,collision:{startx:0,starty:20,width:32,height:10}},{name:"cabbage_v",uvStartPx:{u:453,v:285},widthPx:25,heightPx:35,zoffset:10,collision:{startx:0,starty:12,width:23,height:23}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(jut.types.length),r=jut.types[s];super(t,e,i,jut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class qut extends kut{static texture="props";static types=[{name:"bench_1_h",uvStartPx:{u:537,v:920},widthPx:82,heightPx:40,zoffset:10,collision:{startx:0,starty:10,width:77,height:30}},{name:"bench_1_v_1",uvStartPx:{u:544,v:974},widthPx:34,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_1_v_2",uvStartPx:{u:608,v:974},widthPx:35,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_2_h_1",uvStartPx:{u:742,v:1030},widthPx:84,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:81,height:10}},{name:"bench_2_h_2",uvStartPx:{u:835,v:1030},widthPx:61,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:58,height:10}},{name:"bench_2_v_1",uvStartPx:{u:712,v:1053},widthPx:19,heightPx:67,zoffset:10,collision:{startx:0,starty:17,width:17,height:50}},{name:"bench_2_v_2",uvStartPx:{u:744,v:1070},widthPx:19,heightPx:50,zoffset:10,collision:{startx:0,starty:10,width:17,height:40}},{name:"table_1_h",uvStartPx:{u:551,v:1075},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_1_v",uvStartPx:{u:652,v:1045},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}},{name:"table_2_h",uvStartPx:{u:551,v:1139},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_2_v",uvStartPx:{u:652,v:1141},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(qut.types.length),r=qut.types[s];super(t,e,i,qut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}const Kut=500;class Zut{static objects=[{name:"Campfire",category:"props",create:(t,e,i,n)=>new Vut(t,e,i),id:"campfire",getType:()=>Vut.types?.[0],getTexture:()=>Vut.texture},{name:"House 1",category:"building",create:(t,e,i,n)=>new Hut(t,e,i),id:"house_1",getType:()=>Hut.type,getTexture:()=>Hut.texture},{name:"Tree Birch 0",category:"plants",create:(t,e,i,n)=>new But(t,e,i,0),id:"tree_0",getType:()=>But.types?.[0],getTexture:()=>But.texture},{name:"Tree Birch 1",category:"plants",create:(t,e,i,n)=>new But(t,e,i,1),id:"tree_1",getType:()=>But.types?.[1],getTexture:()=>But.texture},{name:"Tree Birch 2",category:"plants",create:(t,e,i,n)=>new But(t,e,i,2),id:"tree_2",getType:()=>But.types?.[2],getTexture:()=>But.texture},{name:"Tree Birch 3",category:"plants",create:(t,e,i,n)=>new But(t,e,i,3),id:"tree_3",getType:()=>But.types?.[3],getTexture:()=>But.texture},{name:"Tree Birch 4",category:"plants",create:(t,e,i,n)=>new But(t,e,i,4),id:"tree_4",getType:()=>But.types?.[4],getTexture:()=>But.texture},{name:"Autumn Tree Birch 0",category:"plants",create:(t,e,i,n)=>new But(t,e,i,5),id:"tree_5",getType:()=>But.types?.[5],getTexture:()=>But.texture},{name:"Autumn Tree Birch 1",category:"plants",create:(t,e,i,n)=>new But(t,e,i,6),id:"tree_6",getType:()=>But.types?.[6],getTexture:()=>But.texture},{name:"Autumn Tree Birch 2",category:"plants",create:(t,e,i,n)=>new But(t,e,i,7),id:"tree_7",getType:()=>But.types?.[7],getTexture:()=>But.texture},{name:"Autumn Tree Birch 3",category:"plants",create:(t,e,i,n)=>new But(t,e,i,8),id:"tree_8",getType:()=>But.types?.[8],getTexture:()=>But.texture},{name:"Autumn Tree Birch 4",category:"plants",create:(t,e,i,n)=>new But(t,e,i,9),id:"tree_9",getType:()=>But.types?.[9],getTexture:()=>But.texture},{name:"Rock 0",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,0),id:"rock_0",getType:()=>Nut.types?.[0],getTexture:()=>Nut.texture},{name:"Rock 1",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,1),id:"rock_1",getType:()=>Nut.types?.[1],getTexture:()=>Nut.texture},{name:"Rock 2",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,2),id:"rock_2",getType:()=>Nut.types?.[2],getTexture:()=>Nut.texture},{name:"Rock 3",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,3),id:"rock_3",getType:()=>Nut.types?.[3],getTexture:()=>Nut.texture},{name:"Rock 4",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,4),id:"rock_4",getType:()=>Nut.types?.[4],getTexture:()=>Nut.texture},{name:"Rock 5",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,5),id:"rock_5",getType:()=>Nut.types?.[5],getTexture:()=>Nut.texture},{name:"Rock 6",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,6),id:"rock_6",getType:()=>Nut.types?.[6],getTexture:()=>Nut.texture},{name:"Rock 7",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,7),id:"rock_7",getType:()=>Nut.types?.[7],getTexture:()=>Nut.texture},{name:"Rock 8",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,8),id:"rock_8",getType:()=>Nut.types?.[8],getTexture:()=>Nut.texture},{name:"Rock 9",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,9),id:"rock_9",getType:()=>Nut.types?.[9],getTexture:()=>Nut.texture},{name:"Rock 10",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,10),id:"rock_10",getType:()=>Nut.types?.[10],getTexture:()=>Nut.texture},{name:"Rock 11",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,11),id:"rock_11",getType:()=>Nut.types?.[11],getTexture:()=>Nut.texture},{name:"Rock 12",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,12),id:"rock_12",getType:()=>Nut.types?.[12],getTexture:()=>Nut.texture},{name:"Rock 13",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,13),id:"rock_13",getType:()=>Nut.types?.[13],getTexture:()=>Nut.texture},{name:"Rock 14",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,14),id:"rock_14",getType:()=>Nut.types?.[14],getTexture:()=>Nut.texture},{name:"Rock 15",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,15),id:"rock_15",getType:()=>Nut.types?.[15],getTexture:()=>Nut.texture},{name:"Rock 16",category:"props",create:(t,e,i,n)=>new Nut(t,e,i,16),id:"rock_16",getType:()=>Nut.types?.[16],getTexture:()=>Nut.texture},{name:"WoodBox Large",category:"props",create:(t,e,i,n)=>new Uut(t,e,i,0),id:"woodbox_0",getType:()=>Uut.types?.[0],getTexture:()=>Uut.texture},{name:"WoodBox Small",category:"props",create:(t,e,i,n)=>new Uut(t,e,i,1),id:"woodbox_1",getType:()=>Uut.types?.[1],getTexture:()=>Uut.texture},{name:"Covered WoodBox Large",category:"props",create:(t,e,i,n)=>new Uut(t,e,i,2),id:"woodbox_2",getType:()=>Uut.types?.[2],getTexture:()=>Uut.texture},{name:"Covered WoodBox Small",category:"props",create:(t,e,i,n)=>new Uut(t,e,i,3),id:"woodbox_3",getType:()=>Uut.types?.[3],getTexture:()=>Uut.texture},{name:"Empty Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,0),id:"crate_0",getType:()=>jut.types?.[0],getTexture:()=>jut.texture},{name:"Empty Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,1),id:"crate_1",getType:()=>jut.types?.[1],getTexture:()=>jut.texture},{name:"Apple Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,2),id:"crate_2",getType:()=>jut.types?.[2],getTexture:()=>jut.texture},{name:"Apple Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,3),id:"crate_3",getType:()=>jut.types?.[3],getTexture:()=>jut.texture},{name:"Lemon Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,4),id:"crate_4",getType:()=>jut.types?.[4],getTexture:()=>jut.texture},{name:"Lemon Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,5),id:"crate_5",getType:()=>jut.types?.[5],getTexture:()=>jut.texture},{name:"Pear Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,6),id:"crate_6",getType:()=>jut.types?.[6],getTexture:()=>jut.texture},{name:"Pear Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,7),id:"crate_7",getType:()=>jut.types?.[7],getTexture:()=>jut.texture},{name:"Fish Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,8),id:"crate_8",getType:()=>jut.types?.[8],getTexture:()=>jut.texture},{name:"Fish Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,9),id:"crate_9",getType:()=>jut.types?.[9],getTexture:()=>jut.texture},{name:"Carrot Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,10),id:"crate_10",getType:()=>jut.types?.[10],getTexture:()=>jut.texture},{name:"Carrot Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,11),id:"crate_11",getType:()=>jut.types?.[11],getTexture:()=>jut.texture},{name:"Cabbage Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new jut(t,e,i,12),id:"crate_12",getType:()=>jut.types?.[12],getTexture:()=>jut.texture},{name:"Cabbage Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new jut(t,e,i,13),id:"crate_13",getType:()=>jut.types?.[13],getTexture:()=>jut.texture},{name:"Lamp",category:"props",create:(t,e,i,n)=>new Yut(t,e,i,n),id:"lamp",getType:()=>Yut.type,getTexture:()=>Yut.texture},{name:"Road Lamp Left",category:"props",create:(t,e,i,n)=>new Xut(t,e,i,0),id:"roadlamp_left",getType:()=>Xut.types?.[0],getTexture:()=>Xut.texture},{name:"Road Lamp Right",category:"props",create:(t,e,i,n)=>new Xut(t,e,i,1),id:"roadlamp_right",getType:()=>Xut.types?.[1],getTexture:()=>Xut.texture},{name:"Autumn Bush 0",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,0),id:"bush_0",getType:()=>Gut.types?.[0],getTexture:()=>Gut.texture},{name:"Autumn Bush 1",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,1),id:"bush_1",getType:()=>Gut.types?.[1],getTexture:()=>Gut.texture},{name:"Autumn Bush 2",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,2),id:"bush_2",getType:()=>Gut.types?.[2],getTexture:()=>Gut.texture},{name:"Autumn Bush 3",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,3),id:"bush_3",getType:()=>Gut.types?.[3],getTexture:()=>Gut.texture},{name:"Autumn Bush 4",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,4),id:"bush_4",getType:()=>Gut.types?.[4],getTexture:()=>Gut.texture},{name:"Autumn Bush 5",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,5),id:"bush_5",getType:()=>Gut.types?.[5],getTexture:()=>Gut.texture},{name:"Autumn Bush 6",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,6),id:"bush_6",getType:()=>Gut.types?.[6],getTexture:()=>Gut.texture},{name:"Bush 0",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,7),id:"bush_7",getType:()=>Gut.types?.[7],getTexture:()=>Gut.texture},{name:"Bush 1",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,8),id:"bush_8",getType:()=>Gut.types?.[8],getTexture:()=>Gut.texture},{name:"Bush 2",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,9),id:"bush_9",getType:()=>Gut.types?.[9],getTexture:()=>Gut.texture},{name:"Bush 3",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,10),id:"bush_10",getType:()=>Gut.types?.[10],getTexture:()=>Gut.texture},{name:"Bush 4",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,11),id:"bush_11",getType:()=>Gut.types?.[11],getTexture:()=>Gut.texture},{name:"Bush 5",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,12),id:"bush_12",getType:()=>Gut.types?.[12],getTexture:()=>Gut.texture},{name:"Bush 6",category:"plants",create:(t,e,i,n)=>new Gut(t,e,i,13),id:"bush_13",getType:()=>Gut.types?.[13],getTexture:()=>Gut.texture},{name:"Large Cabbage",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,0),id:"morenature_0",getType:()=>Wut.types?.[0],getTexture:()=>Wut.texture},{name:"Medium Cabbage",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,1),id:"morenature_1",getType:()=>Wut.types?.[1],getTexture:()=>Wut.texture},{name:"Small Cabbage",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,2),id:"morenature_2",getType:()=>Wut.types?.[2],getTexture:()=>Wut.texture},{name:"Large Pumpkin",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,3),id:"morenature_3",getType:()=>Wut.types?.[3],getTexture:()=>Wut.texture},{name:"Medium Pumpkin",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,4),id:"morenature_4",getType:()=>Wut.types?.[4],getTexture:()=>Wut.texture},{name:"Small Pumpkin",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,5),id:"morenature_5",getType:()=>Wut.types?.[5],getTexture:()=>Wut.texture},{name:"Large Carrot",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,6),id:"morenature_6",getType:()=>Wut.types?.[6],getTexture:()=>Wut.texture},{name:"Medium Carrot",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,7),id:"morenature_7",getType:()=>Wut.types?.[7],getTexture:()=>Wut.texture},{name:"Small Carrot",category:"plants",create:(t,e,i,n)=>new Wut(t,e,i,8),id:"morenature_8",getType:()=>Wut.types?.[8],getTexture:()=>Wut.texture},{name:"Barrel",category:"props",create:(t,e,i,n)=>new zut(t,e,i,0),id:"barrel_0",getType:()=>zut.types?.[0],getTexture:()=>zut.texture},{name:"Barrel Without Cap",category:"props",create:(t,e,i,n)=>new zut(t,e,i,1),id:"barrel_1",getType:()=>zut.types?.[1],getTexture:()=>zut.texture},{name:"Barrel With Water",category:"props",create:(t,e,i,n)=>new zut(t,e,i,2),id:"barrel_2",getType:()=>zut.types?.[2],getTexture:()=>zut.texture},{name:"Barrel With Plants",category:"props",create:(t,e,i,n)=>new zut(t,e,i,3),id:"barrel_3",getType:()=>zut.types?.[3],getTexture:()=>zut.texture},{name:"Barrel With Props",category:"props",create:(t,e,i,n)=>new zut(t,e,i,4),id:"barrel_4",getType:()=>zut.types?.[4],getTexture:()=>zut.texture},{name:"Barrel Sided",category:"props",create:(t,e,i,n)=>new zut(t,e,i,5),id:"barrel_5",getType:()=>zut.types?.[5],getTexture:()=>zut.texture},{name:"Barrel Pile",category:"props",create:(t,e,i,n)=>new zut(t,e,i,6),id:"barrel_6",getType:()=>zut.types?.[6],getTexture:()=>zut.texture},{name:"Bench 1 Horizontal",category:"props",create:(t,e,i,n)=>new qut(t,e,i,0),id:"outdoor_0",getType:()=>qut.types?.[0],getTexture:()=>qut.texture},{name:"Bench 1 Vertical 1",category:"props",create:(t,e,i,n)=>new qut(t,e,i,1),id:"outdoor_1",getType:()=>qut.types?.[1],getTexture:()=>qut.texture},{name:"Bench 1 Vertical 2",category:"props",create:(t,e,i,n)=>new qut(t,e,i,2),id:"outdoor_2",getType:()=>qut.types?.[2],getTexture:()=>qut.texture},{name:"Bench 2 Horizontal Large",category:"props",create:(t,e,i,n)=>new qut(t,e,i,3),id:"outdoor_3",getType:()=>qut.types?.[3],getTexture:()=>qut.texture},{name:"Bench 2 Horizontal Small",category:"props",create:(t,e,i,n)=>new qut(t,e,i,4),id:"outdoor_4",getType:()=>qut.types?.[4],getTexture:()=>qut.texture},{name:"Bench 2 Vertical Large",category:"props",create:(t,e,i,n)=>new qut(t,e,i,5),id:"outdoor_5",getType:()=>qut.types?.[5],getTexture:()=>qut.texture},{name:"Bench 2 Vertical Small",category:"props",create:(t,e,i,n)=>new qut(t,e,i,6),id:"outdoor_6",getType:()=>qut.types?.[6],getTexture:()=>qut.texture},{name:"Table 1 Horizontal",category:"props",create:(t,e,i,n)=>new qut(t,e,i,7),id:"outdoor_7",getType:()=>qut.types?.[7],getTexture:()=>qut.texture},{name:"Table 1 Vertical",category:"props",create:(t,e,i,n)=>new qut(t,e,i,8),id:"outdoor_8",getType:()=>qut.types?.[8],getTexture:()=>qut.texture},{name:"Table 2 Horizontal",category:"props",create:(t,e,i,n)=>new qut(t,e,i,9),id:"outdoor_9",getType:()=>qut.types?.[9],getTexture:()=>qut.texture},{name:"Table 2 Vertical",category:"props",create:(t,e,i,n)=>new qut(t,e,i,10),id:"outdoor_10",getType:()=>qut.types?.[10],getTexture:()=>qut.texture}];constructor(t,e=[]){this.scene=t,this.list=e,this.allElementsByChunk=new Map,this.loadedChunks=new Set,this.serverIdIndex=new Map,this.playerChunk=null}loadJsonMap(t=[]){this.allElementsByChunk.clear(),t.forEach(t=>{if("number"!=typeof t.x||"number"!=typeof t.y||!t.id)return;const e=`${Math.floor(t.x/Kut)}:${Math.floor(t.y/Kut)}`;this.allElementsByChunk.has(e)||this.allElementsByChunk.set(e,[]),this.allElementsByChunk.get(e).push(t)}),this.playerChunk=null}_chunkKey(t,e){return`${t}:${e}`}create(t,e,i,n,s={}){const r=Zut.objects.find(e=>e.id===t);if(!r)throw new Error(`Unknown object id: ${t}`);const a=r.create(e,i,n,s);return a.typeId=t,a.typeOptions=s,a.serverId=s.serverId,a.idBase||(a.idBase=`${t}_${Date.now()}_${Math.floor(1e4*Math.random())}`),this.list.push(a),a.serverId&&this.serverIdIndex.set(a.serverId,a),a}exportElements(){return this.list.map(t=>({x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId}}))}exportElement(t){return{x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId}}}destroy(t){try{const e=this.list.findIndex(e=>e.idBase===t.idBase);if(e>-1){const t=this.list[e];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(e,1),t.serverId&&this.serverIdIndex.delete(t.serverId)}}catch(t){}}destroyByServerId(t){try{const e=this.list.findIndex(e=>e.serverId==t);if(e>-1){const t=this.list[e];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(e,1),t.serverId&&this.serverIdIndex.delete(t.serverId)}}catch(t){}}moveByServerId(t,e,i){try{const n=this.list.findIndex(e=>e.serverId==t);if(n>-1){this.list[n].setPosition(e,i)}}catch(t){}}destroyAll(){if(0===this.list.length)return;[...this.list].forEach(t=>this.destroy(t))}loadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(this.loadedChunks.has(i))return 0;const n=this.allElementsByChunk.get(i)||[],s=[];return n.forEach(t=>{try{if(t.options&&t.options.serverId&&this.serverIdIndex.has(t.options.serverId))return;const e=this.create(t.id,this.scene,t.x,t.y,t.options||{});s.push(e)}catch(t){}}),this.loadedChunks.add(i),s.length}unloadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(!this.loadedChunks.has(i))return 0;const n=t*Kut,s=(t+1)*Kut,r=e*Kut,a=(e+1)*Kut,o=this.list.filter(t=>t.x>=n&&t.x<s&&t.y>=r&&t.y<a);return o.forEach(t=>this.destroy(t)),this.loadedChunks.delete(i),o.length}_updateChunks(){const t=this.scene?.player?.sprite;if(!t||"number"!=typeof t.x||"number"!=typeof t.y)return;const e=Math.floor(t.x/Kut),i=Math.floor(t.y/Kut),n=`${e}:${i}`;if(n===this.playerChunk)return;const s=new Set,r=Math.round(this.scene.getCameraInfo().maxSize/500);for(let t=-r;t<=r;t++)for(let n=-r;n<=r;n++)s.add(this._chunkKey(e+t,i+n));for(const t of s)if(!this.loadedChunks.has(t)){const[e,i]=t.split(":").map(Number);this.loadChunkByCoords(e,i)}for(const t of Array.from(this.loadedChunks))if(!s.has(t)){const[e,i]=t.split(":").map(Number);this.unloadChunkByCoords(e,i)}this.playerChunk=n}update(t,e,i){this._updateChunks();const n=this.scene.cameras.main.worldView,s=new Klt.Geom.Rectangle(n.x-64,n.y-64,n.width+128,n.height+128);this.list.forEach(t=>{if(!t)return;const n=t.image||t.sprite||t;if(!n||!n.getBounds)return;const r=Klt.Geom.Intersects.RectangleToRectangle(s,n.getBounds());if("function"==typeof n.setVisible&&n.setVisible(r),n.body&&void 0!==n.body.enable&&(n.body.enable=r),t.active=r,r&&"function"==typeof t.update)try{t.update(e,i)}catch(t){}})}loadChunk({cx:t,cy:e}){return this.loadChunkByCoords(t,e)}unloadChunk({cx:t,cy:e}){return this.unloadChunkByCoords(t,e)}getChunkElements(t,e){return this.allElementsByChunk.get(this._chunkKey(t,e))||[]}}class Jut{static getTexture(t,e,i,n,s,r){const a=t.textures.get(e);if(!a)throw new Error(`Texture not found with id ${e}`);const o=document.createElement("canvas");o.width=s,o.height=r;return o.getContext("2d").drawImage(a.source[0].image,i,n,s,r,0,0,s,r),o.toDataURL()}}class $ut{constructor(t){this.scene=t,this.keys=t.input.keyboard.addKeys("W,A,S,D"),this.inputVector={x:0,y:0},this.lastJoystickValue=!0,this.joystickOptions={zone:document.getElementById("game-container"),mode:"dynamic",size:100,color:"black",fadeTime:120},this.categoryConfig={plants:{icon:"assets/icons/plant.png",description:"Trees, flowers, and natural things."},props:{icon:"assets/icons/fire.png",description:"Barrels, boxes, and more props."},building:{icon:"assets/icons/generalinfo.png",description:"Buildings, houses, and moee."}},this.inputVector={x:0,y:0},this._createJoystick(),this.optionsModal=new Out(document.getElementById("game-container"),this.scene),this.editorModal=new Lut(document.getElementById("game-container"),"Editor",this.scene),this.peopleModal=new Dut(document.getElementById("game-container"),this.scene),this.setupEditorModal(this.editorModal),this.hud=new Rut(document.getElementById("game-container"),{components:[{type:Cut,options:{scene:t,network:t.networkManager}},{type:Aut,options:{scene:t}},{type:Put,options:{onZoomIn:()=>t.zoomIn(),onZoomOut:()=>t.zoomOut()}},{type:Mut,options:{scene:t}}]})}_createJoystick(){this.joystick=Tut(this.joystickOptions),this.moveHandler=(t,e)=>{this.inputVector.x=e.vector.x,this.inputVector.y=-e.vector.y},this.endHandler=()=>{this.inputVector.x=0,this.inputVector.y=0},this.joystick.on("move",this.moveHandler),this.joystick.on("end",this.endHandler)}setKeysStatus(t){t?this.scene.input.keyboard.enableGlobalCapture():this.scene.input.keyboard.disableGlobalCapture();for(const e in this.keys)this.keys[e]&&(this.keys[e].enabled=t)}joystickSetEnabled(t,e=!0){e&&(this.lastJoystickValue=t),t?this.joystick||this._createJoystick():(this.joystick&&(this.joystick.destroy(),this.joystick=null,document.querySelectorAll(".nipple")[0]?.remove()),this.inputVector.x=0,this.inputVector.y=0)}joystickModalEnable(t){1==t?this.joystickSetEnabled(!1,!1):this.joystickSetEnabled(this.lastJoystickValue,!1)}setupEditorModal(t){const e=this;t.body.innerHTML="";const i=document.createElement("div");i.className="categories-container";const n={};Zut.objects.forEach(t=>{const i=t.getType(),s=t.category;if(!n[s]){const t=this.categoryConfig[s]||{icon:"",description:"",color:"#999"};n[s]={config:t,items:[]}}n[s].items.push({...t,icon:Jut.getTexture(e.scene,t.getTexture(),i.uvStartPx.u,i.uvStartPx.v,i.widthPx,i.heightPx)})}),Object.entries(n).forEach(([n,s])=>{const{icon:r,description:a,color:o}=s.config,h=s.items.length,l=document.createElement("div");l.className="category-card",l.style.borderColor=o,l.innerHTML=`\n        <div class="category-header">\n          <div class="title">\n            <img src="${r}" class="category-icon">\n            <h2>${n}</h2>\n          </div>\n        </div>\n        <p>${a}</p>\n        <p><b>Items:</b> ${h}</p>\n        <button class="open-category-btn">Open Category</button>\n      `,l.querySelector("button").addEventListener("click",()=>{!function(n,{config:s,items:r}){t.body.innerHTML="";const a=document.createElement("div");a.className="category-header",a.innerHTML=`\n        <div class="title">\n          <img src="${s.icon}" class="category-icon">\n          <h2>${n}</h2>\n        </div>\n      `,t.body.appendChild(a);const o=document.createElement("div");o.className="object-list",r.forEach(t=>{const i=document.createElement("div");i.className="object-card",i.innerHTML=`\n          <div class="object-header">\n            <img src="${t.icon}">\n          </div>\n          <div class="object-footer">\n            <h3>${t.name}</h3>\n            <button></button>\n          </div>\n        `;const n=i.querySelector("button");n.textContent="Create",n.addEventListener("click",i=>{const n=function(t){let e="";for(let i=0;i<t;i++)e+=Math.floor(10*Math.random()).toString();return e}(64);e.scene.mapObjects.create(t.id,e.scene,e.scene.player.sprite.x+100,e.scene.player.sprite.y,{serverId:n}),e.scene.networkManager.emitCreateElement(e.scene.mapObjects.list[e.scene.mapObjects.list.findIndex(t=>t.serverId==n)])}),o.appendChild(i)}),t.body.appendChild(o);const h=document.createElement("button");h.className="back-to-categories-btn",h.textContent="Back",h.addEventListener("click",()=>{t.body.innerHTML="",t.body.appendChild(i)}),a.appendChild(h)}(n,s)}),i.appendChild(l)}),t.body.appendChild(i)}getDirection(){let t=0,e=0;return this.keys.A.isDown&&(t=-1),this.keys.D.isDown&&(t=1),this.keys.W.isDown&&(e=-1),this.keys.S.isDown&&(e=1),t||e?{x:t,y:e}:this.inputVector}}class Qut{constructor(t,e,i,n={}){this.scene=t,this.getX=e,this.getY=i,this._bubbles=[],this._bubblePaddingX=n.bubblePaddingX??6,this._bubblePaddingY=n.bubblePaddingY??4,this._bubbleSeparation=n.bubbleSeparation??4,this._bubbleDuration=n.bubbleDuration??5e3,this._bubbleMaxWidth=n.bubbleMaxWidth??200,this._bubbleLimit=n.bubbleLimit??5,this.bubblePosFPlayer=n.bubblePosFPlayer??40,this._delayedCalls=new Set,this._typingBubble=null,this._typingTween=null,this._typingDelayedCall=null}say(t,e=!1,i=void 0){if(!t)return;const n="number"==typeof i&&i>=0?i:this._bubbleDuration;if(this._bubbles.length>=this._bubbleLimit){const t=this._bubbles.shift();if(t&&(t.container&&this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:150,onComplete:()=>{t.container.destroyed||t.container.destroy()}}),t._delayedCall&&!t._delayedCall.hasDispatched))try{t._delayedCall.remove(!1)}catch(t){}this._updateBubbleStack()}const s={fontFamily:"Hawk",fontSize:"16px",color:e?"yellow":"#aaaaaa"},r=this.scene.add.text(0,0,t,s).setDepth(10000001);r.setOrigin(0,0),r.setPadding(0),r.setWordWrapWidth(this._bubbleMaxWidth,!0);const a=r.getBounds(),o=Math.ceil(a.width),h=Math.ceil(a.height),l=o+2*this._bubblePaddingX,u=h+2*this._bubblePaddingY,c=this.scene.add.container(0,0).setDepth(10000002),d=this.scene.add.graphics();d.fillStyle(0,.6);d.fillRoundedRect(0,0,l,u,6);const f=this.scene.add.text(this._bubblePaddingX,this._bubblePaddingY,t,s).setDepth(10000003);f.setOrigin(0,0),f.setWordWrapWidth(this._bubbleMaxWidth,!0);const p=this.scene.add.graphics();p.fillStyle(0,.6),c.add([d,f,p]);const g=this._bubbles.length,v=Math.round(this.getX()),m=Math.round(this.getY()),y=Math.round(v-Math.floor(l/2)),x=Math.round(m-this.bubblePosFPlayer-(u+this._bubbleSeparation)*g-u);c.x=Math.floor(y),c.y=Math.floor(x);const w={container:c,bg:d,text:f,cloud:p,width:l,height:u,createdAt:Date.now(),_delayedCall:null};this._bubbles.push(w),this._updateBubbleStack(),r.destroy(),this._clampBubbleToCameraAndPoint(w);const T=this.scene.time.delayedCall(n,()=>{this._removeBubble(w),this._delayedCalls.delete(T)});return w._delayedCall=T,this._delayedCalls.add(T),w}setTyping(t,e=void 0){if(t){if(this._typingBubble){if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if("number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return}const t={fontFamily:"Hawk",fontSize:"16px",color:"#aaaaaa"},i="...",n=this.scene.add.text(0,0,i,t).setDepth(10000001);n.setOrigin(0,0),n.setPadding(0),n.setWordWrapWidth(this._bubbleMaxWidth,!0);const s=n.getBounds(),r=Math.ceil(s.width),a=Math.ceil(s.height);n.destroy();const o=r+2*this._bubblePaddingX,h=a+2*this._bubblePaddingY,l=this.scene.add.container(0,0).setDepth(10000010),u=this.scene.add.graphics();u.fillStyle(0,.6);const c=6;u.fillRoundedRect(0,0,o,h,c);const d=this._bubblePaddingX,f=this._bubblePaddingY,p=3,g=(o-2*this._bubblePaddingX)/(p+1),v=()=>{const t=Math.floor(170+86*Math.random()).toString(16).padStart(2,"0");return`#${t}${t}${t}`},m=[];for(let e=0;e<p;e++){const i=v(),n=this.scene.add.text(0,0,".",{fontFamily:"Hawk",fontSize:t.fontSize,color:i}).setDepth(10000011+e);n.setOrigin(.5,.5);const s=(d+g)*(e+1),r=f+Math.floor(a/2);n.x=s,n.y=r,n.setScale(1,1),n.setAlpha(1),l.add(n),m.push({text:n})}const y=this.scene.add.graphics();y.fillStyle(0,.6),l.add([u,y]),l.sendToBack(u);const x=Math.round(this.getX()),w=Math.round(this.getY()),T=Math.round(x-Math.floor(o/2)),b=Math.round(w-this.bubblePosFPlayer-h);l.x=Math.floor(T),l.y=Math.floor(b);const S={container:l,bg:u,dots:m,cloud:y,width:o,height:h};this._typingBubble=S,this._clampBubbleToCameraAndPoint(S);const E=[],_=500;for(let t=0;t<m.length;t++){const e=m[t],i=this.scene.tweens.add({targets:e.text,alpha:{from:.4,to:1},ease:"Sine.easeInOut",duration:_,yoyo:!0,repeat:-1,delay:t*(_/3)});E.push(i)}if(this._typingTween={tweens:E},"number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return void this._updateBubbleStack()}{if(!this._typingBubble)return;if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if(this._typingTween&&Array.isArray(this._typingTween.tweens)){for(const t of this._typingTween.tweens)try{t.remove(!1)}catch(t){}this._typingTween=null}const t=this._typingBubble;try{this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:120,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}})}catch(e){t.container&&!t.container.destroyed&&t.container.destroy()}return this._typingBubble=null,void this._updateBubbleStack()}}_clampBubbleToCameraAndPoint(t){if(!this.scene.cameras||!this.scene.cameras.main)return;const e=this.scene.cameras.main,i=e.worldView.x,n=e.worldView.y,s=e.worldView.x+e.worldView.width,r=e.worldView.y+e.worldView.height;let a=t.container.x;a<i+4&&(a=Math.floor(i+4)),a+t.width>s-4&&(a=Math.floor(s-t.width-4)),t.container.x=a;let o=t.container.y;o<n+4&&(o=Math.floor(n+4)),o+t.height>r-4&&(o=Math.floor(r-t.height-4)),t.container.y=o,this._drawCloudForBubble(t)}_drawCloudForBubble(t){if(!t.cloud)return;const e=t.cloud;e.clear(),e.fillStyle(0,.6);const i=t.container.x;let n=Math.round(this.getX())-i;n=Math.max(6,Math.min(t.width-6,n));const s=this._typingBubble===t,r=t.container.y+t.height<=this.getY()-8,a=r?t.height:-6,o=r?t.height+6:0,h=Math.floor(n-Math.floor(3)),l=Math.floor(n+Math.ceil(3));if(e.beginPath(),e.moveTo(h,a),e.lineTo(l,a),e.lineTo(n,o),e.closePath(),e.fillPath(),s)e.setVisible(!0);else{const e=this._bubbles.length?this._bubbles[this._bubbles.length-1]:null;e&&e.cloud&&e.cloud.setVisible(e===t)}}_repositionBubbles(){if(this._typingBubble){const t=this._typingBubble,e=Math.round(this.getX()),i=Math.round(this.getY()),n=Math.round(e-Math.floor(t.width/2)),s=Math.round(i-this.bubblePosFPlayer-t.height);t.container.x=Math.floor(n),t.container.y=Math.floor(s),this._clampBubbleToCameraAndPoint(t)}if(!this._bubbles.length)return;const t=Math.round(this.getX()),e=Math.round(this.getY());for(let i=0;i<this._bubbles.length;i++){const n=this._bubbles[i],s=n.width,r=n.height,a=i,o=this._typingBubble?1:0,h=Math.round(t-Math.floor(s/2)),l=Math.round(e-this.bubblePosFPlayer-(r+this._bubbleSeparation)*(this._bubbles.length-1-a+o)-r);n.container.x=Math.floor(h),n.container.y=Math.floor(l),this._clampBubbleToCameraAndPoint(n)}}_updateBubbleStack(){this._typingBubble&&(this._typingBubble.container.setDepth(10000020),this._typingBubble.cloud&&this._typingBubble.cloud.setVisible(!0));for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t],i=10000002;e.container.setDepth(i+t),e.cloud&&e.cloud.setVisible(!this._typingBubble&&t===this._bubbles.length-1)}this._repositionBubbles()}_removeBubble(t){const e=this._bubbles.indexOf(t);if(-1!==e){if(t._delayedCall){try{t._delayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(t._delayedCall),t._delayedCall=null}this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:200,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}}),this._bubbles.splice(e,1),this._updateBubbleStack()}}destroy(){for(const t of this._delayedCalls)try{t.remove(!1)}catch(t){}if(this._delayedCalls.clear(),this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._typingDelayedCall=null}if(this._typingTween){try{this._typingTween.remove(!1)}catch(t){}this._typingTween=null}if(this._typingBubble&&this._typingBubble.container&&!this._typingBubble.container.destroyed){try{this._typingBubble.container.destroy()}catch(t){}this._typingBubble=null}for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t];if(e&&e._delayedCall){try{e._delayedCall.remove(!1)}catch(t){}e._delayedCall=null}if(e&&e.container&&!e.container.destroyed)try{this.scene.tweens.add({targets:[e.container],alpha:{from:1,to:0},duration:100,onComplete:()=>{e.container&&!e.container.destroyed&&e.container.destroy()}})}catch(t){e.container&&!e.container.destroyed&&e.container.destroy()}}this._bubbles=[],this.scene=null,this.getX=null,this.getY=null}update(){this._repositionBubbles()}}class tct{constructor(t,e,i,n,s,r,a,o){this.id=e,this.scene=t,this.display_name=s,this.username=n,this.avatar=o,this.uuid=i;const h="avatar-"+i;if(this.sprite=t.add.image(r,a,"wah"),t.physics.add.existing(this.sprite),this.sprite.body.setCollideWorldBounds(!0),this.sprite.body.setSize(32,16).setOffset(0,16),this.sprite.body.debugShowBody=!1,this.sprite.body.roundPixels=!0,o){const t=new Image;t.onload=()=>{this.scene.textures.exists(h)&&this.scene.textures.remove(h),this.scene.textures.addImage(h,t),this.sprite.setTexture(h)},t.onerror=t=>{console.error("Error loading custom avatar",t)},t.src=o}this.nameText=t.add.text(Math.floor(r-16),Math.floor(a-32),s||"",{fontFamily:"Hawk",fontSize:"16px",color:"#ffffff"}).setDepth(10248),this._positionTween=null,this._smoothDuration=100,this.chat=new Qut(t,()=>this.sprite.x,()=>this.sprite.y,{bubblePaddingX:6,bubblePaddingY:4,bubbleSeparation:4,bubbleDuration:5e3,bubbleMaxWidth:200,bubbleLimit:5,bubblePosFPlayer:s&&""!=s?40:24})}update(){this.chat.update()}updateMovement(t){this.sprite.body.setVelocity(Math.floor(200*t.x),Math.floor(200*t.y)),this.nameText.setPosition(Math.floor(this.sprite.x-Math.floor(this.sprite.width/2)),Math.floor(this.sprite.y-30)),this.sprite.setDepth(this.sprite.y+16)}setPosition(t,e,i=!1){this._positionTween&&(this._positionTween.stop(),this._positionTween=null);const n=i?this._smoothDuration:0;if(!n)return this.sprite.setPosition(t,e),this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-25)),this.sprite.body&&this.sprite.body.reset(t,e),void this.chat.update();this._positionTween=this.scene.tweens.add({targets:[this.sprite,this.nameText],props:{x:{value:t,ease:"Linear"},y:{value:t=>t===this.nameText?e-20:e,ease:"Linear"}},duration:n,onUpdate:()=>{this.sprite.x=Math.round(this.sprite.x),this.sprite.y=Math.round(this.sprite.y),this.nameText.x=Math.round(this.nameText.x),this.nameText.y=Math.round(this.nameText.y),this.chat.update()},onComplete:()=>{this.sprite.setPosition(t,e),this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-20)),this.sprite.body&&this.sprite.body.reset(t,e),this._positionTween=null,this.chat.update()}})}setSmoothDuration(t){this._smoothDuration=Math.max(0,0|t)}say(t,e){return this.chat.say(t,e,function(t){const e=t.replace(/\s/g,"").length;return Math.min(12e4,Math.max(1e3,500*e))}(t))}destroy(){if(this._positionTween){try{this._positionTween.stop()}catch(t){}this._positionTween=null}if(this.chat){try{this.chat.destroy()}catch(t){}this.chat=null}if(this.sprite){try{this.sprite.destroy()}catch(t){}this.sprite=null}if(this.nameText){try{this.nameText.destroy()}catch(t){}this.nameText=null}this.scene=null}}var ect,ict,nct;try{ect=new TextDecoder}catch(t){}var sct,rct,act,oct,hct,lct=0,uct={},cct=0,dct=0,fct=[],pct={useRecords:!1,mapsAsObjects:!0};class gct{}const vct=new gct;vct.name="MessagePack 0xC1";var mct=!1,yct=2;try{new Function("")}catch(t){yct=1/0}class xct{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,e){if(ict)return qct(()=>(Kct(),this?this.unpack(t,e):xct.prototype.unpack.call(pct,t,e)));t.buffer||t.constructor!==ArrayBuffer||(t="undefined"!=typeof Buffer?Buffer.from(t):new Uint8Array(t)),"object"==typeof e?(nct=e.end||t.length,lct=e.start||0):(lct=0,nct=e>-1?e:t.length),dct=0,rct=null,act=null,ict=t;try{hct=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(ict=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof xct){if(uct=this,this.structures)return sct=this.structures,wct(e);(!sct||sct.length>0)&&(sct=[])}else uct=pct,(!sct||sct.length>0)&&(sct=[]);return wct(e)}unpackMultiple(t,e){let i,n=0;try{mct=!0;let s=t.length,r=this?this.unpack(t,s):Jct.unpack(t,s);if(!e){for(i=[r];lct<s;)n=lct,i.push(wct());return i}if(!1===e(r,n,lct))return;for(;lct<s;)if(n=lct,!1===e(wct(),n,lct))return}catch(t){throw t.lastPosition=n,t.values=i,t}finally{mct=!1,Kct()}}_mergeStructures(t,e){t=t||[],Object.isFrozen(t)&&(t=t.map(t=>t.slice(0)));for(let e=0,i=t.length;e<i;e++){let i=t[e];i&&(i.isShared=!0,e>=32&&(i.highByte=e-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let n=t[i],s=e[i];s&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[i]=n),t[i]=s)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function wct(t){try{if(!uct.trusted&&!mct){let t=sct.sharedLength||0;t<sct.length&&(sct.length=t)}let t;if(uct.randomAccessStructure&&ict[lct]<64&&ict[lct],t=bct(),act&&(lct=act.postBundlePosition,act=null),mct&&(sct.restoreStructures=null),lct==nct)sct&&sct.restoreStructures&&Tct(),sct=null,ict=null,oct&&(oct=null);else{if(lct>nct)throw new Error("Unexpected end of MessagePack data");if(!mct){let e;try{e=JSON.stringify(t,(t,e)=>"bigint"==typeof e?`${e}n`:e).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(t){throw sct&&sct.restoreStructures&&Tct(),Kct(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||lct>nct)&&(t.incomplete=!0),t}}function Tct(){for(let t in sct.restoreStructures)sct[t]=sct.restoreStructures[t];sct.restoreStructures=null}function bct(){let t=ict[lct++];if(t<160){if(t<128){if(t<64)return t;{let e=sct[63&t]||uct.getStructures&&Cct()[63&t];return e?(e.read||(e.read=Ect(e,63&t)),e.read()):t}}if(t<144){if(t-=128,uct.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=Yct();"__proto__"===t&&(t="__proto_"),e[t]=bct()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(bct(),bct());return e}}{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=bct();return uct.freezeData?Object.freeze(e):e}}if(t<192){let e=t-160;if(dct>=lct)return rct.slice(lct-cct,(lct+=e)-cct);if(0==dct&&nct<140){let t=e<16?kct(e):Ict(e);if(null!=t)return t}return Act(e)}{let e;switch(t){case 192:return null;case 193:return act?(e=bct(),e>0?act[1].slice(act.position1,act.position1+=e):act[0].slice(act.position0,act.position0-=e)):vct;case 194:return!1;case 195:return!0;case 196:if(e=ict[lct++],void 0===e)throw new Error("Unexpected end of buffer");return Nct(e);case 197:return e=hct.getUint16(lct),lct+=2,Nct(e);case 198:return e=hct.getUint32(lct),lct+=4,Nct(e);case 199:return Uct(ict[lct++]);case 200:return e=hct.getUint16(lct),lct+=2,Uct(e);case 201:return e=hct.getUint32(lct),lct+=4,Uct(e);case 202:if(e=hct.getFloat32(lct),uct.useFloat32>2){let t=Zct[(127&ict[lct])<<1|ict[lct+1]>>7];return lct+=4,(t*e+(e>0?.5:-.5)|0)/t}return lct+=4,e;case 203:return e=hct.getFloat64(lct),lct+=8,e;case 204:return ict[lct++];case 205:return e=hct.getUint16(lct),lct+=2,e;case 206:return e=hct.getUint32(lct),lct+=4,e;case 207:return"number"===uct.int64AsType?(e=4294967296*hct.getUint32(lct),e+=hct.getUint32(lct+4)):"string"===uct.int64AsType?e=hct.getBigUint64(lct).toString():"auto"===uct.int64AsType?(e=hct.getBigUint64(lct),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=hct.getBigUint64(lct),lct+=8,e;case 208:return hct.getInt8(lct++);case 209:return e=hct.getInt16(lct),lct+=2,e;case 210:return e=hct.getInt32(lct),lct+=4,e;case 211:return"number"===uct.int64AsType?(e=4294967296*hct.getInt32(lct),e+=hct.getUint32(lct+4)):"string"===uct.int64AsType?e=hct.getBigInt64(lct).toString():"auto"===uct.int64AsType?(e=hct.getBigInt64(lct),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=hct.getBigInt64(lct),lct+=8,e;case 212:if(e=ict[lct++],114==e)return Gct(63&ict[lct++]);{let t=fct[e];if(t)return t.read?(lct++,t.read(bct())):t.noBuffer?(lct++,t()):t(ict.subarray(lct,++lct));throw new Error("Unknown extension "+e)}case 213:return e=ict[lct],114==e?(lct++,Gct(63&ict[lct++],ict[lct++])):Uct(2);case 214:return Uct(4);case 215:return Uct(8);case 216:return Uct(16);case 217:return e=ict[lct++],dct>=lct?rct.slice(lct-cct,(lct+=e)-cct):Pct(e);case 218:return e=hct.getUint16(lct),dct>=(lct+=2)?rct.slice(lct-cct,(lct+=e)-cct):Mct(e);case 219:return e=hct.getUint32(lct),dct>=(lct+=4)?rct.slice(lct-cct,(lct+=e)-cct):Rct(e);case 220:return e=hct.getUint16(lct),lct+=2,Oct(e);case 221:return e=hct.getUint32(lct),lct+=4,Oct(e);case 222:return e=hct.getUint16(lct),lct+=2,Fct(e);case 223:return e=hct.getUint32(lct),lct+=4,Fct(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const Sct=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Ect(t,e){function i(){if(i.count++>yct){let i=t.read=new Function("r","return function(){return "+(uct.freezeData?"Object.freeze":"")+"({"+t.map(t=>"__proto__"===t?"__proto_:r()":Sct.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()").join(",")+"})}")(bct);return 0===t.highByte&&(t.read=_ct(e,t.read)),i()}let n={};for(let e=0,i=t.length;e<i;e++){let i=t[e];"__proto__"===i&&(i="__proto_"),n[i]=bct()}return uct.freezeData?Object.freeze(n):n}return i.count=0,0===t.highByte?_ct(e,i):i}const _ct=(t,e)=>function(){let i=ict[lct++];if(0===i)return e();let n=t<32?-(t+(i<<5)):t+(i<<5),s=sct[n]||Cct()[n];if(!s)throw new Error("Record id is not defined for "+n);return s.read||(s.read=Ect(s,t)),s.read()};function Cct(){let t=qct(()=>(ict=null,uct.getStructures()));return sct=uct._mergeStructures(t,sct)}var Act=Lct,Pct=Lct,Mct=Lct,Rct=Lct;function Lct(t){let e;if(t<16&&(e=kct(t)))return e;if(t>64&&ect)return ect.decode(ict.subarray(lct,lct+=t));const i=lct+t,n=[];for(e="";lct<i;){const t=ict[lct++];if(128&t)if(192==(224&t)){const e=63&ict[lct++];n.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&ict[lct++],i=63&ict[lct++];n.push((31&t)<<12|e<<6|i)}else if(240==(248&t)){let e=(7&t)<<18|(63&ict[lct++])<<12|(63&ict[lct++])<<6|63&ict[lct++];e>65535&&(e-=65536,n.push(e>>>10&1023|55296),e=56320|1023&e),n.push(e)}else n.push(t);else n.push(t);n.length>=4096&&(e+=Dct.apply(String,n),n.length=0)}return n.length>0&&(e+=Dct.apply(String,n)),e}function Oct(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=bct();return uct.freezeData?Object.freeze(e):e}function Fct(t){if(uct.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=Yct();"__proto__"===t&&(t="__proto_"),e[t]=bct()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(bct(),bct());return e}}var Dct=String.fromCharCode;function Ict(t){let e=lct,i=new Array(t);for(let n=0;n<t;n++){const t=ict[lct++];if((128&t)>0)return void(lct=e);i[n]=t}return Dct.apply(String,i)}function kct(t){if(t<4){if(t<2){if(0===t)return"";{let t=ict[lct++];return(128&t)>1?void(lct-=1):Dct(t)}}{let e=ict[lct++],i=ict[lct++];if((128&e)>0||(128&i)>0)return void(lct-=2);if(t<3)return Dct(e,i);let n=ict[lct++];return(128&n)>0?void(lct-=3):Dct(e,i,n)}}{let e=ict[lct++],i=ict[lct++],n=ict[lct++],s=ict[lct++];if((128&e)>0||(128&i)>0||(128&n)>0||(128&s)>0)return void(lct-=4);if(t<6){if(4===t)return Dct(e,i,n,s);{let t=ict[lct++];return(128&t)>0?void(lct-=5):Dct(e,i,n,s,t)}}if(t<8){let r=ict[lct++],a=ict[lct++];if((128&r)>0||(128&a)>0)return void(lct-=6);if(t<7)return Dct(e,i,n,s,r,a);let o=ict[lct++];return(128&o)>0?void(lct-=7):Dct(e,i,n,s,r,a,o)}{let r=ict[lct++],a=ict[lct++],o=ict[lct++],h=ict[lct++];if((128&r)>0||(128&a)>0||(128&o)>0||(128&h)>0)return void(lct-=8);if(t<10){if(8===t)return Dct(e,i,n,s,r,a,o,h);{let t=ict[lct++];return(128&t)>0?void(lct-=9):Dct(e,i,n,s,r,a,o,h,t)}}if(t<12){let l=ict[lct++],u=ict[lct++];if((128&l)>0||(128&u)>0)return void(lct-=10);if(t<11)return Dct(e,i,n,s,r,a,o,h,l,u);let c=ict[lct++];return(128&c)>0?void(lct-=11):Dct(e,i,n,s,r,a,o,h,l,u,c)}{let l=ict[lct++],u=ict[lct++],c=ict[lct++],d=ict[lct++];if((128&l)>0||(128&u)>0||(128&c)>0||(128&d)>0)return void(lct-=12);if(t<14){if(12===t)return Dct(e,i,n,s,r,a,o,h,l,u,c,d);{let t=ict[lct++];return(128&t)>0?void(lct-=13):Dct(e,i,n,s,r,a,o,h,l,u,c,d,t)}}{let f=ict[lct++],p=ict[lct++];if((128&f)>0||(128&p)>0)return void(lct-=14);if(t<15)return Dct(e,i,n,s,r,a,o,h,l,u,c,d,f,p);let g=ict[lct++];return(128&g)>0?void(lct-=15):Dct(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g)}}}}}function Bct(){let t,e=ict[lct++];if(e<192)t=e-160;else switch(e){case 217:t=ict[lct++];break;case 218:t=hct.getUint16(lct),lct+=2;break;case 219:t=hct.getUint32(lct),lct+=4;break;default:throw new Error("Expected string")}return Lct(t)}function Nct(t){return uct.copyBuffers?Uint8Array.prototype.slice.call(ict,lct,lct+=t):ict.subarray(lct,lct+=t)}function Uct(t){let e=ict[lct++];if(fct[e]){let i;return fct[e](ict.subarray(lct,i=lct+=t),t=>{lct=t;try{return bct()}finally{lct=i}})}throw new Error("Unknown extension type "+e)}var zct=new Array(4096);function Yct(){let t=ict[lct++];if(!(t>=160&&t<192))return lct--,Xct(bct());if(t-=160,dct>=lct)return rct.slice(lct-cct,(lct+=t)-cct);if(!(0==dct&&nct<180))return Act(t);let e,i=4095&(t<<5^(t>1?hct.getUint16(lct):t>0?ict[lct]:0)),n=zct[i],s=lct,r=lct+t-3,a=0;if(n&&n.bytes==t){for(;s<r;){if(e=hct.getUint32(s),e!=n[a++]){s=1879048192;break}s+=4}for(r+=3;s<r;)if(e=ict[s++],e!=n[a++]){s=1879048192;break}if(s===r)return lct=s,n.string;r-=3,s=lct}for(n=[],zct[i]=n,n.bytes=t;s<r;)e=hct.getUint32(s),n.push(e),s+=4;for(r+=3;s<r;)e=ict[s++],n.push(e);let o=t<16?kct(t):Ict(t);return n.string=null!=o?o:Act(t)}function Xct(t){if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t.toString();if(null==t)return t+"";if(uct.allowArraysInMapKeys&&Array.isArray(t)&&t.flat().every(t=>["string","number","boolean","bigint"].includes(typeof t)))return t.flat().toString();throw new Error("Invalid property type for record: "+typeof t)}const Gct=(t,e)=>{let i=bct().map(Xct),n=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let s=sct[t];return s&&(s.isShared||mct)&&((sct.restoreStructures||(sct.restoreStructures=[]))[t]=s),sct[t]=i,i.read=Ect(i,n),i.read()};fct[0]=()=>{},fct[0].noBuffer=!0,fct[66]=t=>{let e=t.byteLength%8||8,i=BigInt(128&t[0]?t[0]-256:t[0]);for(let n=1;n<e;n++)i<<=BigInt(8),i+=BigInt(t[n]);if(t.byteLength!==e){let n=new DataView(t.buffer,t.byteOffset,t.byteLength),s=(t,e)=>{let i=e-t;if(i<=40){let i=n.getBigUint64(t);for(let s=t+8;s<e;s+=8)i<<=BigInt(64n),i|=n.getBigUint64(s);return i}let r=t+(i>>4<<3),a=s(t,r),o=s(r,e);return a<<BigInt(8*(e-r))|o};i=i<<BigInt(8*(n.byteLength-e))|s(e,n.byteLength)}return i};let Wct={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,AggregateError:"function"==typeof AggregateError?AggregateError:null};fct[101]=()=>{let t=bct();if(!Wct[t[0]]){let e=Error(t[1],{cause:t[2]});return e.name=t[0],e}return Wct[t[0]](t[1],{cause:t[2]})},fct[105]=t=>{if(!1===uct.structuredClone)throw new Error("Structured clone extension is disabled");let e=hct.getUint32(lct-4);oct||(oct=new Map);let i,n=ict[lct];i=n>=144&&n<160||220==n||221==n?[]:n>=128&&n<144||222==n||223==n?new Map:(n>=199&&n<=201||n>=212&&n<=216)&&115===ict[lct+1]?new Set:{};let s={target:i};oct.set(e,s);let r=bct();if(!s.used)return s.target=r;if(Object.assign(i,r),i instanceof Map)for(let[t,e]of r.entries())i.set(t,e);if(i instanceof Set)for(let t of Array.from(r))i.add(t);return i},fct[112]=t=>{if(!1===uct.structuredClone)throw new Error("Structured clone extension is disabled");let e=hct.getUint32(lct-4),i=oct.get(e);return i.used=!0,i.target},fct[115]=()=>new Set(bct());const Hct=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let Vct="object"==typeof globalThis?globalThis:window;fct[116]=t=>{let e=t[0],i=Uint8Array.prototype.slice.call(t,1).buffer,n=Hct[e];if(!n){if(16===e)return i;if(17===e)return new DataView(i);throw new Error("Could not find typed array for code "+e)}return new Vct[n](i)},fct[120]=()=>{let t=bct();return new RegExp(t[0],t[1])};const jct=[];function qct(t){let e=nct,i=lct,n=cct,s=dct,r=rct,a=oct,o=act,h=new Uint8Array(ict.slice(0,nct)),l=sct,u=sct.slice(0,sct.length),c=uct,d=mct,f=t();return nct=e,lct=i,cct=n,dct=s,rct=r,oct=a,act=o,ict=h,mct=d,(sct=l).splice(0,sct.length,...u),uct=c,hct=new DataView(ict.buffer,ict.byteOffset,ict.byteLength),f}function Kct(){ict=null,oct=null,sct=null}fct[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=lct;return lct+=e-t.length,act=jct,(act=[Bct(),Bct()]).position0=0,act.position1=0,act.postBundlePosition=lct,lct=i,bct()},fct[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const Zct=new Array(147);for(let t=0;t<256;t++)Zct[t]=+("1e"+Math.floor(45.15-.30103*t));var Jct=new xct({useRecords:!1});const $ct=Jct.unpack;Jct.unpackMultiple,Jct.unpack;let Qct,tdt,edt,idt=new Float32Array(1);new Uint8Array(idt.buffer,0,4);try{Qct=new TextEncoder}catch(t){}const ndt="undefined"!=typeof Buffer,sdt=ndt?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,rdt=ndt?Buffer:Uint8Array,adt=ndt?4294967296:2144337920;let odt,hdt,ldt,udt,cdt=0,ddt=null;const fdt=/[\u0080-\uFFFF]/,pdt=Symbol("record-id");function gdt(t,e,i,n){let s=t.byteLength;if(s+1<256){var{target:r,position:a}=i(4+s);r[a++]=199,r[a++]=s+1}else if(s+1<65536){var{target:r,position:a}=i(5+s);r[a++]=200,r[a++]=s+1>>8,r[a++]=s+1&255}else{var{target:r,position:a,targetView:o}=i(7+s);r[a++]=201,o.setUint32(a,s+1),a+=4}r[a++]=116,r[a++]=e,t.buffer||(t=new Uint8Array(t)),r.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function vdt(t,e){let i=t.byteLength;var n,s;if(i<256){var{target:n,position:s}=e(i+2);n[s++]=196,n[s++]=i}else if(i<65536){var{target:n,position:s}=e(i+3);n[s++]=197,n[s++]=i>>8,n[s++]=255&i}else{var{target:n,position:s,targetView:r}=e(i+5);n[s++]=198,r.setUint32(s,i),s+=4}n.set(t,s)}function mdt(t,e,i,n){let s=t.length;switch(s){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:s<256?(e[i++]=199,e[i++]=s):s<65536?(e[i++]=200,e[i++]=s>>8,e[i++]=255&s):(e[i++]=201,e[i++]=s>>24,e[i++]=s>>16&255,e[i++]=s>>8&255,e[i++]=255&s)}return e[i++]=n,e.set(t,i),i+=s}function ydt(t,e,i){if(ddt.length>0){ldt.setUint32(ddt.position+t,cdt+i-ddt.position-t),ddt.stringsPosition=cdt-t;let n=ddt;ddt=null,e(n[0]),e(n[1])}}edt=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,gct],tdt=[{pack(t,e,i){let n=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296){let{target:t,targetView:i,position:s}=e(6);t[s++]=214,t[s++]=255,i.setUint32(s,n)}else if(n>0&&n<4294967296){let{target:i,targetView:s,position:r}=e(10);i[r++]=215,i[r++]=255,s.setUint32(r,4e6*t.getMilliseconds()+(n/1e3/4294967296|0)),s.setUint32(r+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:t,targetView:n,position:s}=e(3);t[s++]=212,t[s++]=255,t[s++]=255}else{let{target:i,targetView:s,position:r}=e(15);i[r++]=199,i[r++]=12,i[r++]=255,s.setUint32(r,1e6*t.getMilliseconds()),s.setBigInt64(r+4,BigInt(Math.floor(n)))}}},{pack(t,e,i){if(this.setAsEmptyObject)return e(0),i({});let n=Array.from(t),{target:s,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(s[r++]=212,s[r++]=115,s[r++]=0),i(n)}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=101,n[s++]=0),i([t.name,t.message,t.cause])}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=120,n[s++]=0),i([t.source,t.flags])}},{pack(t,e){this.moreTypes?gdt(t,16,e):vdt(ndt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==rdt&&this.moreTypes?gdt(t,Hct.indexOf(i.name),e):vdt(t,e)}},{pack(t,e){this.moreTypes?gdt(t,17,e):vdt(ndt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let{target:i,position:n}=e(1);i[n]=193}}];let xdt=new class extends xct{constructor(t){let e,i,n,s;super(t),this.offset=0;let r=rdt.prototype.utf8Write?function(t,e){return odt.utf8Write(t,e,odt.byteLength-e)}:!(!Qct||!Qct.encodeInto)&&function(t,e){return Qct.encodeInto(t,odt.subarray(e)).written},a=this;t||(t={});let o=t&&t.sequential,h=t.structures||t.saveStructures,l=t.maxSharedStructures;if(null==l&&(l=h?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(this.moreTypes=!0);let u=t.maxOwnStructures;null==u&&(u=h?32:64),this.structures||0==t.useRecords||(this.structures=[]);let c=l>32||u+l>64,d=l+64,f=l+u+64;if(f>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let p=[],g=0,v=0;this.pack=this.encode=function(t,r){if(odt||(odt=new sdt(8192),ldt=odt.dataView||(odt.dataView=new DataView(odt.buffer,0,8192)),cdt=0),udt=odt.length-10,udt-cdt<2048?(odt=new sdt(odt.length),ldt=odt.dataView||(odt.dataView=new DataView(odt.buffer,0,odt.length)),udt=odt.length-10,cdt=0):cdt=cdt+7&2147483640,e=cdt,r&Sdt&&(cdt+=255&r),s=a.structuredClone?new Map:null,a.bundleStrings&&"string"!=typeof t?(ddt=[],ddt.size=1/0):ddt=null,n=a.structures,n){n.uninitialized&&(n=a._mergeStructures(a.getStructures()));let t=n.sharedLength||0;if(t>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let e=0;e<t;e++){let t=n[e];if(!t)continue;let i,s=n.transitions;for(let e=0,n=t.length;e<n;e++){let n=t[e];i=s[n],i||(i=s[n]=Object.create(null)),s=i}s[pdt]=e+64}this.lastNamedStructuresLength=t}o||(n.nextId=t+64)}let h;i&&(i=!1);try{a.randomAccessStructure&&t&&t.constructor&&t.constructor===Object?A(t):x(t);let i=ddt;if(ddt&&ydt(e,x,0),s&&s.idsToInsert){let t=s.idsToInsert.sort((t,e)=>t.offset>e.offset?1:-1),n=t.length,r=-1;for(;i&&n>0;){let s=t[--n].offset+e;s<i.stringsPosition+e&&-1===r&&(r=0),s>i.position+e?r>=0&&(r+=6):(r>=0&&(ldt.setUint32(i.position+e,ldt.getUint32(i.position+e)+r),r=-1),i=i.previous,n++)}r>=0&&i&&ldt.setUint32(i.position+e,ldt.getUint32(i.position+e)+r),cdt+=6*t.length,cdt>udt&&E(cdt),a.offset=cdt;let o=function(t,e){let i,n=6*e.length,s=t.length-n;for(;i=e.pop();){let e=i.offset,r=i.id;t.copyWithin(e+n,e,s),n-=6;let a=e+n;t[a++]=214,t[a++]=105,t[a++]=r>>24,t[a++]=r>>16&255,t[a++]=r>>8&255,t[a++]=255&r,s=e}return t}(odt.subarray(e,cdt),t);return s=null,o}return a.offset=cdt,r&Tdt?(odt.start=e,odt.end=cdt,odt):odt.subarray(e,cdt)}catch(t){throw h=t,t}finally{if(n&&(m(),i&&a.saveStructures)){let i=n.sharedLength||0,s=odt.subarray(e,cdt),o=function(t,e){return t.isCompatible=t=>{let i=!t||(e.lastNamedStructuresLength||0)===t.length;return i||e._mergeStructures(t),i},t}(n,a);if(!h)return!1===a.saveStructures(o,o.isCompatible)?a.pack(t,r):(a.lastNamedStructuresLength=i,odt.length>1073741824&&(odt=null),s)}odt.length>1073741824&&(odt=null),r&bdt&&(cdt=e)}};const m=()=>{v<10&&v++;let t=n.sharedLength||0;if(n.length>t&&!o&&(n.length=t),g>1e4)n.transitions=null,v=0,g=0,p.length>0&&(p=[]);else if(p.length>0&&!o){for(let t=0,e=p.length;t<e;t++)p[t][pdt]=0;p=[]}},y=t=>{var e=t.length;e<16?odt[cdt++]=144|e:e<65536?(odt[cdt++]=220,odt[cdt++]=e>>8,odt[cdt++]=255&e):(odt[cdt++]=221,ldt.setUint32(cdt,e),cdt+=4);for(let i=0;i<e;i++)x(t[i])},x=t=>{cdt>udt&&(odt=E(cdt));var i,n=typeof t;if("string"===n){let n,s=t.length;if(ddt&&s>=4&&s<4096){if((ddt.size+=s)>21760){let t,i,n=(ddt[0]?3*ddt[0].length+ddt[1].length:0)+10;cdt+n>udt&&(odt=E(cdt+n)),ddt.position?(i=ddt,odt[cdt]=200,cdt+=3,odt[cdt++]=98,t=cdt-e,cdt+=4,ydt(e,x,0),ldt.setUint16(t+e-3,cdt-e-t)):(odt[cdt++]=214,odt[cdt++]=98,t=cdt-e,cdt+=4),ddt=["",""],ddt.previous=i,ddt.size=0,ddt.position=t}let i=fdt.test(t);return ddt[i?0:1]+=t,odt[cdt++]=193,void x(i?-s:s)}n=s<32?1:s<256?2:s<65536?3:5;let a=3*s;if(cdt+a>udt&&(odt=E(cdt+a)),s<64||!r){let e,r,a,o=cdt+n;for(e=0;e<s;e++)r=t.charCodeAt(e),r<128?odt[o++]=r:r<2048?(odt[o++]=r>>6|192,odt[o++]=63&r|128):55296==(64512&r)&&56320==(64512&(a=t.charCodeAt(e+1)))?(r=65536+((1023&r)<<10)+(1023&a),e++,odt[o++]=r>>18|240,odt[o++]=r>>12&63|128,odt[o++]=r>>6&63|128,odt[o++]=63&r|128):(odt[o++]=r>>12|224,odt[o++]=r>>6&63|128,odt[o++]=63&r|128);i=o-cdt-n}else i=r(t,cdt+n);i<32?odt[cdt++]=160|i:i<256?(n<2&&odt.copyWithin(cdt+2,cdt+1,cdt+1+i),odt[cdt++]=217,odt[cdt++]=i):i<65536?(n<3&&odt.copyWithin(cdt+3,cdt+2,cdt+2+i),odt[cdt++]=218,odt[cdt++]=i>>8,odt[cdt++]=255&i):(n<5&&odt.copyWithin(cdt+5,cdt+3,cdt+3+i),odt[cdt++]=219,ldt.setUint32(cdt,i),cdt+=4),cdt+=i}else if("number"===n)if(t>>>0===t)t<32||t<128&&!1===this.useRecords||t<64&&!this.randomAccessStructure?odt[cdt++]=t:t<256?(odt[cdt++]=204,odt[cdt++]=t):t<65536?(odt[cdt++]=205,odt[cdt++]=t>>8,odt[cdt++]=255&t):(odt[cdt++]=206,ldt.setUint32(cdt,t),cdt+=4);else if((t|0)===t)t>=-32?odt[cdt++]=256+t:t>=-128?(odt[cdt++]=208,odt[cdt++]=t+256):t>=-32768?(odt[cdt++]=209,ldt.setInt16(cdt,t),cdt+=2):(odt[cdt++]=210,ldt.setInt32(cdt,t),cdt+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let i;if(odt[cdt++]=202,ldt.setFloat32(cdt,t),e<4||((i=t*Zct[(127&odt[cdt])<<1|odt[cdt+1]>>7])|0)===i)return void(cdt+=4);cdt--}odt[cdt++]=203,ldt.setFloat64(cdt,t),cdt+=8}else if("object"===n||"function"===n)if(t){if(s){let i=s.get(t);if(i){if(!i.id){let t=s.idsToInsert||(s.idsToInsert=[]);i.id=t.push(i)}return odt[cdt++]=214,odt[cdt++]=112,ldt.setUint32(cdt,i.id),void(cdt+=4)}s.set(t,{offset:cdt-e})}let r=t.constructor;if(r===Object)S(t);else if(r===Array)y(t);else if(r===Map)if(this.mapAsEmptyObject)odt[cdt++]=128;else{(i=t.size)<16?odt[cdt++]=128|i:i<65536?(odt[cdt++]=222,odt[cdt++]=i>>8,odt[cdt++]=255&i):(odt[cdt++]=223,ldt.setUint32(cdt,i),cdt+=4);for(let[e,i]of t)x(e),x(i)}else{for(let e=0,i=tdt.length;e<i;e++){if(t instanceof edt[e]){let i=tdt[e];if(i.write){i.type&&(odt[cdt++]=212,odt[cdt++]=i.type,odt[cdt++]=0);let e=i.write.call(this,t);return void(e===t?Array.isArray(t)?y(t):S(t):x(e))}let n,s=odt,r=ldt,a=cdt;odt=null;try{n=i.pack.call(this,t,t=>(odt=s,s=null,cdt+=t,cdt>udt&&E(cdt),{target:odt,targetView:ldt,position:cdt-t}),x)}finally{s&&(odt=s,ldt=r,cdt=a,udt=odt.length-10)}return void(n&&(n.length+cdt>udt&&E(n.length+cdt),cdt=mdt(n,odt,cdt,i.type)))}}if(Array.isArray(t))y(t);else{if(t.toJSON){const e=t.toJSON();if(e!==t)return x(e)}if("function"===n)return x(this.writeFunction&&this.writeFunction(t));S(t)}}}else odt[cdt++]=192;else if("boolean"===n)odt[cdt++]=t?195:194;else if("bigint"===n){if(t<0x8000000000000000&&t>=-0x8000000000000000)odt[cdt++]=211,ldt.setBigInt64(cdt,t);else if(t<0x10000000000000000&&t>0)odt[cdt++]=207,ldt.setBigUint64(cdt,t);else{if(!this.largeBigIntToFloat){if(this.largeBigIntToString)return x(t.toString());if(this.useBigIntExtension||this.moreTypes){let e,i=t<0?BigInt(-1):BigInt(0);if(t>>BigInt(65536)===i){let n=BigInt(0x10000000000000000)-BigInt(1),s=[];for(;s.push(t&n),t>>BigInt(63)!==i;)t>>=BigInt(64);e=new Uint8Array(new BigUint64Array(s).buffer),e.reverse()}else{let i=t<0,n=(i?~t:t).toString(16);if(n.length%2?n="0"+n:parseInt(n.charAt(0),16)>=8&&(n="00"+n),ndt)e=Buffer.from(n,"hex");else{e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=parseInt(n.slice(2*t,2*t+2),16)}if(i)for(let t=0;t<e.length;t++)e[t]=~e[t]}return e.length+cdt>udt&&E(e.length+cdt),void(cdt=mdt(e,odt,cdt,66))}throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}odt[cdt++]=203,ldt.setFloat64(cdt,Number(t))}cdt+=8}else{if("undefined"!==n)throw new Error("Unknown type: "+n);this.encodeUndefinedAsNil?odt[cdt++]=192:(odt[cdt++]=212,odt[cdt++]=0,odt[cdt++]=0)}},w=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?t=>{let e;if(this.skipValues){e=[];for(let i in t)"function"==typeof t.hasOwnProperty&&!t.hasOwnProperty(i)||this.skipValues.includes(t[i])||e.push(i)}else e=Object.keys(t);let i,n=e.length;if(n<16?odt[cdt++]=128|n:n<65536?(odt[cdt++]=222,odt[cdt++]=n>>8,odt[cdt++]=255&n):(odt[cdt++]=223,ldt.setUint32(cdt,n),cdt+=4),this.coercibleKeyAsNumber)for(let s=0;s<n;s++){i=e[s];let n=Number(i);x(isNaN(n)?i:n),x(t[i])}else for(let s=0;s<n;s++)x(i=e[s]),x(t[i])}:t=>{odt[cdt++]=222;let i=cdt-e;cdt+=2;let n=0;for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(x(e),x(t[e]),n++);if(n>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');odt[i+++e]=n>>8,odt[i+e]=255&n},T=!1===this.useRecords?w:t.progressiveRecords&&!c?t=>{let i,s,r=n.transitions||(n.transitions=Object.create(null)),a=cdt++-e;for(let o in t)if("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(o)){if(i=r[o],i)r=i;else{let h=Object.keys(t),l=r;r=n.transitions;let u=0;for(let t=0,e=h.length;t<e;t++){let e=h[t];i=r[e],i||(i=r[e]=Object.create(null),u++),r=i}a+e+1==cdt?(cdt--,_(r,h,u)):C(r,h,a,u),s=!0,r=l[o]}x(t[o])}if(!s){let i=r[pdt];i?odt[a+e]=i:C(r,Object.keys(t),a,0)}}:t=>{let e,i=n.transitions||(n.transitions=Object.create(null)),s=0;for(let n in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(n))&&(e=i[n],e||(e=i[n]=Object.create(null),s++),i=e);let r=i[pdt];r?r>=96&&c?(odt[cdt++]=96+(31&(r-=96)),odt[cdt++]=r>>5):odt[cdt++]=r:_(i,i.__keys__||Object.keys(t),s);for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&x(t[e])},b="function"==typeof this.useRecords&&this.useRecords,S=b?t=>{b(t)?T(t):w(t)}:T,E=t=>{let i;if(t>16777216){if(t-e>adt)throw new Error("Packed buffer would be larger than maximum buffer size");i=Math.min(adt,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else i=1+(Math.max(t-e<<2,odt.length-1)>>12)<<12;let n=new sdt(i);return ldt=n.dataView||(n.dataView=new DataView(n.buffer,0,i)),t=Math.min(t,odt.length),odt.copy?odt.copy(n,0,e,t):n.set(odt.slice(e,t)),cdt-=e,e=0,udt=n.length-10,odt=n},_=(t,e,s)=>{let r=n.nextId;r||(r=64),r<d&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(r=n.nextOwnId,r<f||(r=d),n.nextOwnId=r+1):(r>=f&&(r=d),n.nextId=r+1);let a=e.highByte=r>=96&&c?r-96>>5:-1;t[pdt]=r,t.__keys__=e,n[r-64]=e,r<d?(e.isShared=!0,n.sharedLength=r-63,i=!0,a>=0?(odt[cdt++]=96+(31&r),odt[cdt++]=a):odt[cdt++]=r):(a>=0?(odt[cdt++]=213,odt[cdt++]=114,odt[cdt++]=96+(31&r),odt[cdt++]=a):(odt[cdt++]=212,odt[cdt++]=114,odt[cdt++]=r),s&&(g+=v*s),p.length>=u&&(p.shift()[pdt]=0),p.push(t),x(e))},C=(t,i,n,s)=>{let r=odt,a=cdt,o=udt,h=e;odt=hdt,cdt=0,e=0,odt||(hdt=odt=new sdt(8192)),udt=odt.length-10,_(t,i,s),hdt=odt;let l=cdt;if(odt=r,cdt=a,udt=o,e=h,l>1){let t=cdt+l-1;t>udt&&E(t);let i=n+e;odt.copyWithin(i+l,i+1,cdt),odt.set(hdt.slice(0,l),i),cdt=t}else odt[n+e]=hdt[0]},A=t=>{let s=undefined(t,odt,e,cdt,n,E,(t,e,n)=>{if(n)return i=!0;cdt=e;let s=odt;return x(t),m(),s!==odt?{position:cdt,targetView:ldt,target:odt}:cdt},this);if(0===s)return S(t);cdt=s}}useBuffer(t){odt=t,odt.dataView||(odt.dataView=new DataView(odt.buffer,odt.byteOffset,odt.byteLength)),ldt=odt.dataView,cdt=0}set position(t){cdt=t}get position(){return cdt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}({useRecords:!1});const wdt=xdt.pack;xdt.pack;const Tdt=512,bdt=1024,Sdt=2048;class Edt{constructor(t){this.scene=t,this.players={},this.ws=null,this.connect(),this.last={type:null,data:null}}buildPath(t){return`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}${t}`}connect(){this.server=JSON.parse(localStorage.getItem("server")),this.ws=new WebSocket(this.server.path),this.ws.addEventListener("open",()=>{}),this.ws.addEventListener("message",async t=>{let e,i;try{i=await event.data.arrayBuffer(),e=$ct(i)}catch(t){return}const{type:n,data:s}=e;switch(this.last={type:n,data:s},n){case"addPlayer":this.addPlayer(s);break;case"loggedIn":this.scene.connectingOverlay.remove(),this.scene.inputManager.hud.container.style.display="block",Object.values(s.players).forEach(t=>this.addPlayer(t)),this.scene.player=this.addPlayer(s.player),this.scene.physics.add.collider(this.scene.player.sprite,this.scene.collisionGroup),this.scene.cameras.main.startFollow(this.scene.player.sprite,!0,.1,.1,.5,.5),this.scene.cameras.main.roundPixels=!0;break;case"chatmessage":if(!this.players[s.id])return;this.players[s.id].say(s.message,s.isCommandResponse),this.scene.inputManager.hud.getComponent("chatbox").addMessage(s.user,s.message,s.isCommandResponse);break;case"localBubble":this.scene.player.say(s.message,s.isCommandResponse);break;case"playerMoved":if(!this.scene.player||s.id==this.scene.player.id)return;const t=this.players[s.id];t&&t.setPosition(s.x,s.y,!0);break;case"removePlayer":this.players[s]&&(this.players[s].destroy(),delete this.players[s]);break;case"time":this.scene.lightManager.timeSeconds=s.time;break;case"connected":this.send("login",{...h(),range:this.scene.getCameraInfo().maxSize});break;case"loginError":this.scene.errorModal.throwError(s.message);break;case"disconnect":this.scene.errorModal.throwError("Disconnected from server.");break;case"kick":this.scene.errorModal.throwError("You are kicked from this server.<br>"+s);break;case"typing":if(!this.players[s.id])return;this.players[s.id].chat.setTyping(s.status||!1);break;case"map":this.scene.mapObjects.loadJsonMap(s.map);break;case"createElement":this.scene.mapObjects.create(s.id,this.scene,s.x,s.y,s.options);break;case"deleteElement":this.scene.mapObjects.destroyByServerId(s.options?.serverId);break;case"moveElement":this.scene.mapObjects.moveByServerId(s.options?.serverId,s.x,s.y)}}),this.ws.addEventListener("close",()=>{this.scene.errorModal.throwError("Disconnected from server.")})}send(t,e){this.last={type:t,data:e};const i=wdt({type:t,data:e});this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(i)}addPlayer({id:t,uuid:e,username:i,display_name:n,x:s,y:r,avatar:a}){return this.players[t]=new tct(this.scene,t,e,i,n,s,r,a)}emitChatMessage(t,e=!1){this.send("chat",{message:t,isCommandResponse:e})}emitExportElements(t){this.send("exportElements",t)}emitRange(t){this.send("camerarange",t)}emitMovement(t,e){this.send("playerMovement",{x:t,y:e})}emitCreateElement(t){this.send("createElement",this.scene.mapObjects.exportElement(t))}emitDeleteElement(t){this.send("deleteElement",this.scene.mapObjects.exportElement(t))}emitMoveElement(t){this.send("moveElement",this.scene.mapObjects.exportElement(t))}emitTyping(t){this.send("typing",{status:t})}}class _dt{constructor(t,e={}){this.scene=t,this.textString=e.text||"Connecting...",this.fontSize=e.fontSize||32,this.fontFamily=e.fontFamily||"Hawk",this.color=e.color||"#ffffff",this.depth="number"==typeof e.depth?e.depth:10248,this.container=null,this.visible=!1}_createElements(){if(this.container)return;const t=this.scene.scale.width,e=this.scene.scale.height,i=this.scene.add.rectangle(0,0,t,e,2236962).setOrigin(0,0),n={fontFamily:this.fontFamily,fontSize:`${this.fontSize}px`,color:this.color},s=Math.floor(t/2),r=Math.floor(e/2),a=this.scene.add.text(s,r,this.textString,n).setOrigin(.5,.5);this.container=this.scene.add.container(0,0,[i,a]).setDepth(this.depth).setVisible(!1),this._bg=i,this._text=a,this._tween=this.scene.tweens.add({targets:this._text,alpha:{from:1,to:.4},duration:700,yoyo:!0,repeat:-1,paused:!0}),this._resizeHandler=()=>{const t=this.scene.scale.width,e=this.scene.scale.height;this._bg.setSize(t,e),this._text.setPosition(Math.floor(t/2),Math.floor(e/2))},this.scene.scale&&this.scene.scale.on&&this.scene.scale.on("resize",this._resizeHandler)}show(){this._createElements(),this.container&&!this.visible&&(this.container.setVisible(!0),this._tween&&this._tween.play(),this.visible=!0)}remove(){this.container&&(this._tween&&(this._tween.stop(),this._tween=null),this.scene.scale&&this.scene.scale.off&&this._resizeHandler&&(this.scene.scale.off("resize",this._resizeHandler),this._resizeHandler=null),this.container.removeAll(!0),this.container.destroy(),this.container=null,this._bg=null,this._text=null,this.visible=!1)}}class Cdt{constructor(t,e={}){this.scene=t,this.game=t.sys.game,this.totalMinutes=e.timeMinutes??24,this.totalSeconds=60*this.totalMinutes,this.running=e.startRunning??!0,this.timeSeconds=60*(e.startAtMinutes??12),this.nightColor=e.nightColor??132634,this.nightAlpha=e.nightAlpha??.7,this.totalMinutes,this.phasesMinutes=e.phasesMinutes??[{start:0,color:this.nightColor,alpha:this.nightAlpha},{start:4,color:this.nightColor,alpha:this.nightAlpha},{start:6,color:16777215,alpha:0},{start:16,color:16777215,alpha:0},{start:18,color:this.nightColor,alpha:this.nightAlpha},{start:20,color:this.nightColor,alpha:this.nightAlpha}],this.phases=this.phasesMinutes.slice().map((t,e)=>({start:Klt.Math.Clamp(60*(t.start??0),0,this.totalSeconds),color:void 0!==t.color?t.color>>>0:void 0,alpha:void 0!==t.alpha?Klt.Math.Clamp(t.alpha,0,1):void 0,index:e})).sort((t,e)=>t.start-e.start),this.lights=[],this._created=!1,this._rtKey="__light_manager_rt",this._rt=null,this._lightSprite=null,this._quad=null,this._camera=null,this._onResize=this._onResize.bind(this),this._lastPhase=null,this._phaseCallbacks=[],this._timeCallbacks=[],this.overlayEvaluator=e.overlayEvaluator??this._defaultOverlayEvaluator.bind(this)}create(t="lightRadial",e="imageMask"){if(this._created)return;const i=this.scene.cameras.main;this._camera=i;const n=i.width,s=i.height,r=`__light_manager_rt_${Date.now()}`;if(this.scene.textures.exists(this._rtKey))try{this.scene.textures.remove(this._rtKey)}catch(t){}this._rtKey=r,this._rt=this.scene.make.renderTexture({width:n,height:s,key:r}),this._quad=this.scene.add.image(0,0).setOrigin(0,0).setScrollFactor(0).setDepth(5e3),this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(r),this._quad.setDisplaySize(n,s),this.scene.textures.exists(t)||console.warn(`LightManager: radial texture "${t}" not found.`),this._lightSprite=this.scene.add.image(0,0,t).setVisible(!1).setOrigin(.5),this._maskKey=e,this.scene.scale.on("resize",this._onResize),this._created=!0}static _lerpColor(t,e,i){const n=Klt.Display.Color.IntegerToColor(t>>>0),s=Klt.Display.Color.IntegerToColor(e>>>0),r=Math.round(Klt.Math.Linear(n.red,s.red,i)),a=Math.round(Klt.Math.Linear(n.green,s.green,i)),o=Math.round(Klt.Math.Linear(n.blue,s.blue,i));return Klt.Display.Color.GetColor(r,a,o)}_defaultOverlayEvaluator(t){const e=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds;let i=-1;for(let t=this.phases.length-1;t>=0;t--)if(e>=this.phases[t].start){i=t;break}-1===i&&(i=this.phases.length-1);const n=this.phases[i],s=(i+1)%this.phases.length,r=this.phases[s];let a=r.start-n.start;a<=0&&(a+=this.totalSeconds);let o=e-n.start;o<0&&(o+=this.totalSeconds);const h=a>0?Klt.Math.Clamp(o/a,0,1):0,l=void 0!==n.color?n.color>>>0:this.nightColor,u=void 0!==n.alpha?n.alpha:this.nightAlpha,c=void 0!==r.color?r.color>>>0:this.nightColor,d=void 0!==r.alpha?r.alpha:this.nightAlpha;return{color:Cdt._lerpColor(l,c,h),alpha:Klt.Math.Clamp(Klt.Math.Linear(u,d,h),0,1),progress:h,phaseIndex:i}}update(t,e){if(!this._created)return;const i=(e??0)/1e3;this.running&&(this.timeSeconds+=i,this.timeSeconds>=this.totalSeconds&&(this.timeSeconds-=this.totalSeconds),this.timeSeconds<0&&(this.timeSeconds=(this.timeSeconds%this.totalSeconds+this.totalSeconds)%this.totalSeconds),this._timeCallbacks.forEach(t=>{try{t(this)}catch(t){}}));const n=this.overlayEvaluator(this.timeSeconds);n&&n.phaseIndex!==this._lastPhase&&(this._lastPhase=n.phaseIndex,this._phaseCallbacks.forEach(t=>{try{t(n,n.phaseIndex)}catch(t){}}));const s=this._camera||this.scene.cameras.main,r=s.width,a=s.height;if(!this._rt||!this._rt.texture)return void console.warn("LightManager.update: missing RenderTexture");if(!this._quad)return;this._rt.clear();const o=Klt.Display.Color.IntegerToColor(n.color??this.nightColor),h=Klt.Display.Color.GetColor(o.red,o.green,o.blue),l=Klt.Math.Clamp(n.alpha??this.nightAlpha,0,1);this._rt.fill(h,l);let u=1;if(this._lightSprite&&this._lightSprite.texture)try{const t=this._lightSprite.texture,e=t.getSourceImage&&t.getSourceImage()||this.scene.textures.exists(t.key)&&this.scene.textures.get(t.key).getSourceImage();e&&e.width&&(u=e.width)}catch(t){u=1}const c=Math.min(this.lights.length,64),d=s.worldView&&"number"==typeof s.worldView.x?s.worldView.x:s.scrollX||0,f=s.worldView&&"number"==typeof s.worldView.y?s.worldView.y:s.scrollY||0,p="number"==typeof s.x?s.x:0,g="number"==typeof s.y?s.y:0;for(let t=0;t<c;t++){const e=this.lights[t];if(!e)continue;const i=e.x-d+p,n=e.y-f+g,s=Klt.Math.Clamp(e.alpha*(e.intensity??1),0,1);this._lightSprite&&this._lightSprite.texture&&(this._lightSprite.setPosition(i,n).setAlpha(s).setTint(e.color),this._rt.draw(this._lightSprite))}this._rt&&this._rt.texture&&this._quad.texture!==this._rt.texture?(this._quad.setTexture(this._rt.texture),this._quad.setDisplaySize(r,a)):this._quad.setDisplaySize(r,a),this._quad.setBlendMode(Klt.BlendModes.MULTIPLY)}addLight(t,e,i=128,n=16777215,s=1,r=1,a=null){if(this.lights.length>=64)return null;const o={x:t??0,y:e??0,radius:i??128,color:n>>>0,alpha:Klt.Math.Clamp(s,0,1),intensity:r??1,mask:a??this._maskKey};return this.lights.push(o),o}removeLightObj(t){const e=this.lights.indexOf(t);-1!==e&&this.lights.splice(e,1)}clearLights(){this.lights.length=0}setNightAlpha(t){this.nightAlpha=Klt.Math.Clamp(t,0,1)}setNightColor(t){this.nightColor=t>>>0}start(){this.running=!0}pause(){this.running=!1}reset(){this.timeSeconds=0}setTime(t){this.timeSeconds=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds}getTime(){return this.timeSeconds}getTimeF(){const t=Eut.get("use12hFormat");let e=Math.floor(this.timeSeconds/60);const i=Math.floor(this.timeSeconds%60);if(t){const t=e>=12?"PM":"AM";return e%=12,0===e&&(e=12),e+":"+String(i).padStart(2,"0")+" "+t}return String(e).padStart(2,"0")+":"+String(i).padStart(2,"0")}setTimeMinutes(t){this.setTime(60*t)}getTimeMinutes(){return this.timeSeconds/60}onPhaseChange(t){"function"==typeof t&&this._phaseCallbacks.push(t)}onTimeChange(t){"function"==typeof t&&this._timeCallbacks.push(t)}_onResize(){const t=this.scene.cameras.main,e=t.width,i=t.height;this._rt&&(this._rt.destroy(),this._rt=this.scene.make.renderTexture({width:e,height:i,key:this._rtKey}),this._quad&&(this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(this._rtKey),this._quad.setDisplaySize(e,i)))}destroy(){this._quad&&(this._quad.destroy(),this._quad=null),this._lightSprite&&(this._lightSprite.destroy(),this._lightSprite=null),this._rt&&(this._rt.destroy(),this._rt=null),this.scene.scale.off("resize",this._onResize),this._created=!1}}class Adt extends Klt.GameObjects.Container{constructor(t,{textureKey:e="floor_dynamic",mapPixelWidth:i=2048,mapPixelHeight:n=2048,cellSize:s=32,tilemapWidth:r=null,tilemapHeight:a=null,baseTilemap:o=null}={}){super(t,0,0),this.scene=t,this.cellSize=s,this.textureKey=e,this.widthPx=i,this.heightPx=n,this.cols=r||Math.ceil(this.widthPx/this.cellSize),this.rows=a||Math.ceil(this.heightPx/this.cellSize),this.canvas=document.createElement("canvas"),this.canvas.width=this.widthPx,this.canvas.height=this.heightPx,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0});const h=t.textures.get("dirt"),l=t.textures.get("grass2");if(!h||!l)throw new Error("Require textures 'dirt' and 'grass2' loaded in scene.");this.dirtImage=h.getSourceImage(),this.grassImage=l.getSourceImage(),this.tilemapNames=Array.from({length:this.cols},()=>new Array(this.rows)),this.tilemapIds=Array.from({length:this.cols},()=>new Array(this.rows)),this.cells=Array.from({length:this.cols},()=>new Array(this.rows).fill(!1)),this.rules=[{name:"air",test:t=>!t.self},{name:"grass_isolated",test:t=>t.self&&0===t.totalAdjacent},{name:"grass_horizontal_interior",test:t=>t.self&&t.w&&t.e&&!t.n&&!t.s,out:"grass"},{name:"grass_left",test:t=>t.self&&t.w&&!t.e&&!t.n&&!t.s,out:"grass_left"},{name:"grass_right",test:t=>t.self&&t.e&&!t.w&&!t.n&&!t.s,out:"grass_right"},{name:"grass_vertical_interior",test:t=>t.self&&t.n&&t.s&&!t.w&&!t.e,out:"grass"},{name:"grass_top",test:t=>t.self&&t.n&&!t.s&&!t.w&&!t.e,out:"grass_top"},{name:"grass_bottom",test:t=>t.self&&t.s&&!t.n&&!t.w&&!t.e,out:"grass_bottom"},{name:"grass_bottom_edges",test:t=>t.self&&t.s&&!t.n&&t.w&&t.e,out:"grass_bottom"},{name:"grass_bottom_left",test:t=>t.self&&t.s&&!t.n&&t.w&&!t.e,out:"grass_bottom_left"},{name:"grass_bottom_right",test:t=>t.self&&t.s&&!t.n&&t.e&&!t.w,out:"grass_bottom_right"},{name:"grass_top_edges",test:t=>t.self&&t.n&&!t.s&&t.w&&t.e,out:"grass_top"},{name:"grass_top_left",test:t=>t.self&&t.n&&!t.s&&t.w&&!t.e,out:"grass_top_left"},{name:"grass_top_right",test:t=>t.self&&t.n&&!t.s&&t.e&&!t.w,out:"grass_top_right"},{name:"grass_left_mixed",test:t=>t.self&&t.w&&!t.e&&(t.n||t.s),out:"grass_left"},{name:"grass_right_mixed",test:t=>t.self&&t.e&&!t.w&&(t.n||t.s),out:"grass_right"},{name:"grass_topleft_min",test:t=>t.self&&!t.se&&(t.s||t.e),out:"grass_top_left_min"},{name:"grass_topright_min",test:t=>t.self&&!t.sw&&(t.s||t.w),out:"grass_top_right_min"},{name:"grass_bottomleft_min",test:t=>t.self&&!t.ne&&(t.n||t.e),out:"grass_bottom_left_min"},{name:"grass_bottomright_min",test:t=>t.self&&!t.nw&&(t.n||t.w),out:"grass_bottom_right_min"},{name:"grass_fallback",test:t=>t.self,out:"grass"}],this.types={grass:{rand:[{x:13,y:0},{x:14,y:0},{x:15,y:0},{x:12,y:1},{x:13,y:1},{x:14,y:1},{x:15,y:1},{x:12,y:2},{x:13,y:2},{x:14,y:2},{x:15,y:2},{x:12,y:3},{x:13,y:3},{x:14,y:3},{x:15,y:3}]},air:{x:11,y:0},grass_top_left_min:{x:0,y:3},grass_bottom_left_min:{x:0,y:5},grass_bottom_right_min:{x:2,y:5},grass_top_right_min:{x:2,y:3},grass_top:{rand:[{x:1,y:3},{x:1,y:2}]},grass_bottom:{rand:[{x:1,y:5},{x:1,y:0}]},grass_left:{rand:[{x:0,y:4},{x:2,y:1}]},grass_right:{rand:[{x:2,y:4},{x:0,y:1}]},grass_bottom_left:{x:2,y:0},grass_bottom_right:{x:0,y:0},grass_top_right:{x:0,y:2},grass_top_left:{x:2,y:2}},this.getRandomFrom=t=>t[Math.floor(Math.random()*t.length)],this.bitblt=(t,e,i,n,s,r,a,o=!1)=>{o?(this.ctx.save(),this.ctx.translate(r+n,a),this.ctx.scale(-1,1),this.ctx.drawImage(t,e,i,n,s,0,0,n,s),this.ctx.restore()):this.ctx.drawImage(t,e,i,n,s,r,a,n,s)};const u=t.textures.get("tilemap");if(u&&u.source&&u.source[0]){const t=u.getSourceImage(),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d",{willReadFrequently:!0});i.drawImage(t,0,0);const n=i.getImageData(0,0,e.width,e.height);this.refWidth=e.width,this.refHeight=e.height,this.refData=n.data}else this.refWidth=0,this.refHeight=0,this.refData=null;this.getPixelGrass=(t,e)=>{if(!this.refData)return null;if(t<0||t>=this.refWidth||e<0||e>=this.refHeight)return null;const i=e*this.refWidth+t<<2,n=this.refData[i],s=this.refData[i+1],r=this.refData[i+2];if(0===this.refData[i+3])return!1;return(n+s+r)/3<128},this.isGrass=(t,e,i=t,n=e)=>{const s=this.getPixelGrass(t,e);if(null!==s)return s;if(!this.refData)return!1;const r=Math.max(0,Math.min(this.refWidth-1,i)),a=Math.max(0,Math.min(this.refHeight-1,n));return!0===this.getPixelGrass(r,a)},this.neighbors4=(t,e)=>({n:this.isGrass(t,e-1,t,e),s:this.isGrass(t,e+1,t,e),w:this.isGrass(t-1,e,t,e),e:this.isGrass(t+1,e,t,e)}),this.neighbors8=(t,e)=>({nw:this.isGrass(t-1,e-1,t,e),ne:this.isGrass(t+1,e-1,t,e),sw:this.isGrass(t-1,e+1,t,e),se:this.isGrass(t+1,e+1,t,e)}),this.classify=(t,e)=>{const i=this.isGrass(t,e),n=this.neighbors4(t,e),s=this.neighbors8(t,e),r=n.n,a=n.s,o=n.w,h=n.e,l=s.nw,u=s.ne,c=s.sw,d=s.se,f=[r,a,o,h,l,u,c,d].filter(Boolean).length,p={self:i,n:r,s:a,w:o,e:h,nw:l,ne:u,sw:c,se:d,totalAdjacent:f};for(const t of this.rules)if(t.test(p))return(t.out||t.name).toLowerCase();return"grass"};const c=32;for(let t=0;t<this.heightPx/c;t++)for(let e=0;e<this.widthPx/c;e++){const i=e*c,n=t*c,s=Math.floor(4*Math.random())*c,r=Math.floor(4*Math.random())*c;this.bitblt(this.dirtImage,s,r,c,c,i,n)}for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++){const i=this.classify(t,e);this.tilemapNames[t][e]=i;const n=this.types[i];if(this.tilemapIds[t][e]={...n.rand?{rand:n.rand.slice()}:n},this.tilemapIds[t][e].rand){const i=this.getRandomFrom(this.tilemapIds[t][e].rand);this.tilemapIds[t][e].x=i.x,this.tilemapIds[t][e].y=i.y}const s=this.tilemapIds[t][e].x*this.cellSize,r=this.tilemapIds[t][e].y*this.cellSize,a=t*this.cellSize,o=e*this.cellSize;this.bitblt(this.grassImage,s,r,this.cellSize,this.cellSize,a,o)}t.textures.exists(this.textureKey)&&t.textures.remove(this.textureKey),t.textures.addCanvas(this.textureKey,this.canvas),this.sprite=t.add.image(0,0,this.textureKey).setOrigin(0),this.add(this.sprite),t.add.existing(this)}destroy(t){this.scene.textures.exists(this.textureKey)&&this.scene.textures.remove(this.textureKey),super.destroy(t)}}class Pdt{constructor(t=Date.now()){this._modulus=2**31,this._multiplier=1103515245,this._increment=12345,this._state=t%this._modulus}_nextState(){return this._state=(this._multiplier*this._state+this._increment)%this._modulus,this._state}getNextFloat(){return this._nextState()/this._modulus}getNextInt(t){if(t<=0)throw new Error("El parÃ¡metro max debe ser mayor que 0.");return Math.floor(this.getNextFloat()*t)}getNextIntRange(t,e){if(t>=e)throw new Error("min debe ser menor que max.");return t+this.getNextInt(e-t)}getNextBool(t=.5){if(t<0||t>1)throw new Error("p debe estar entre 0 y 1.");return this.getNextFloat()<t}}class Mdt extends Lut{constructor(t,e){super(t,"Error",e)}throwError(t,e=()=>window.location.reload()){this.body.innerHTML=t,this.closeBtn.addEventListener("click",e),this.toggle()}}class Rdt extends Klt.Scene{constructor(){super({key:"GameScene"}),this.zoom=1,this.minZoom=1,this.maxZoom=2,this.movementTimer=0,this.player=null,this.lastSentPos={x:null,y:null},this.errorModal=new Mdt(document.getElementById("game-container"),this),this.dev=false,this.floor=null,this.mapSize={width:2048,height:2048}}preload(){d(this,c())}create(){this._configureWorld(this.mapSize.width,this.mapSize.height),this.connectingOverlay=new _dt(this),this.connectingOverlay.show(),this.floor=new Adt(this,{mapPixelWidth:this.mapSize.width,mapPixelHeight:this.mapSize.height}),this.lightManager=new Cdt(this,{startAtMinutes:12}),this.inputManager=new $ut(this),this.networkManager=new Edt(this),this.fpsElement=document.getElementById("fps-text"),this.lightManager.create(),this.random=new Pdt(12344),this.mapObjects=new Zut(this),this.collisionGroup=this.physics.add.group({immovable:!0}),this.game.events.emit("gameLoad")}update(t,e){this.fpsElement.innerHTML="FPS - "+Math.floor(this.game.loop.actualFps)+"<br>"+this.game.renderer.constructor.name;const i=this.inputManager.getDirection();if(this.player){if(this.mapObjects.list.forEach(t=>{this.collisionGroup.contains(t.image)||this.collisionGroup.add(t.image),Klt.Geom.Rectangle.Overlaps(this.player.sprite.getBounds(),t.image.getBounds())&&this.player.sprite.depth<t.image.depth?t.isOverlapping||(t.isOverlapping=!0,this.tweens.add({targets:t.image,alpha:.5,duration:150,ease:"Linear"})):t.isOverlapping&&(t.isOverlapping=!1,this.tweens.add({targets:t.image,alpha:1,duration:150,ease:"Linear"}))}),this.player.update(),this.player.updateMovement(i),this.movementTimer+=e,this.movementTimer>=100){const t=Math.floor(this.player.sprite.x),e=Math.floor(this.player.sprite.y),i=this.lastSentPos.x,n=this.lastSentPos.y;(i!==t||n!==e)&&(this.networkManager.emitMovement(t,e),this.lastSentPos.x=t,this.lastSentPos.y=e),this.movementTimer-=100}}else this.lastSentPos.x=null,this.lastSentPos.y=null;this.lightManager.update(t,e),this.mapObjects.update(t,e)}zoomIn(){const t=this.cameras.main,e=Klt.Math.Clamp(this.zoom+1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}zoomOut(){const t=this.cameras.main,e=Klt.Math.Clamp(this.zoom-1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}getCameraInfo(t=this.cameras.main){const e=t.worldView.x,i=t.worldView.y,n=t.worldView.width,s=t.worldView.height;return{x:e,y:i,width:n,height:s,maxSize:Math.max(n,s)}}_configureWorld(t,e){this.physics.world.setBounds(0,0,t,e),this.cameras.main.setBounds(0,0,t,e)}isVisible(t,e){const i=t.worldView,n=e.getBounds();return Klt.Geom.Intersects.RectangleToRectangle(i,n)}}class Ldt{constructor(t){t.style.overflow="hidden",document.fonts.load("48px Hawk");const e={banner:!1,parent:t,width:window.innerWidth,height:window.innerHeight,pixelArt:!0,physics:{default:"arcade",arcade:{debug:Eut.get("debug")}},scene:[Rdt]};let i;this.game=new Klt.Game(e),window.addEventListener("resize",()=>{clearTimeout(i),i=setTimeout(()=>this._onResize(),200)})}_onResize(){const t=window.innerWidth,e=window.innerHeight;this.game.scale.resize(t,e),this.game.renderer.resize(t,e)}}class Odt extends Klt.Scene{constructor(){super({key:"DashScene"}),this.player=null,this.timed=6e3,this.messages=["WE REALLY NEED","WS FOR SUBDOMAINS","REALYYYYYYYYYY"],this.msgIndex=this.messages.length-1}preload(){d(this,c())}create(){this.floor=new Adt(this,{mapPixelWidth:128,mapPixelHeight:128}),(async()=>{const t=await l(A,h()),e=t.id||"000_000000";this.player=new tct(this,e+"_b",e,t.username||"___","",64,82,t.game.avatar||""),this.player.sprite.setInteractive({draggable:!0}),this.player.sprite.on("drag",(t,e,i)=>{this.player.setPosition(e,i)})})()}update(t,e){this.player&&(this.timed+=e,this.timed>=6e3&&(this.timed=0,this.msgIndex=(this.msgIndex+1)%this.messages.length,this.player.say(this.messages[this.msgIndex],!1)),this.player.update({x:0,y:0}))}}class Fdt{constructor(t){t.style.overflow="hidden",document.fonts.load("48px Hawk");const e={banner:!1,parent:t,pixelArt:!0,width:128,height:128,physics:{default:"arcade",arcade:{}},scene:[Odt]};this.game=new Klt.Game(e)}}function Ddt(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(String(n.result)),n.readAsDataURL(t)})}function Idt(t){return new Promise((e,i)=>{const n=new Image;n.onload=()=>e(n),n.onerror=()=>i(new Error("Could not load image")),n.src=t})}async function kdt(t,{maxBytes:e=5e6}={}){if(!t)throw new Error("No file provided");if("string"!=typeof t.type||!t.type.startsWith("image/"))throw new Error("File is not an image");if(t.size&&t.size>e)throw new Error(`File too large (max ${Math.round(e/1e6)} MB)`);const i=await Ddt(t);return function(t){const e=32,i=document.createElement("canvas");i.width=e,i.height=e;const n=i.getContext("2d");n.clearRect(0,0,e,e);const s=t.width/t.height;let r=e,a=e;s>1?a=e/s:s<1&&(r=e*s);const o=Math.round((e-r)/2),h=Math.round((e-a)/2);return n.drawImage(t,o,h,r,a),i.toDataURL("image/png")}(await Idt(i))}const Bdt={"/login":{...{auth:!1,title:"Login",description:"Sign in to your Hawk account."}||{},fn:function(){document.getElementById("app").innerHTML=`\n  <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Login</h3>\n    <span class="description">Log in into Hawk.</span>\n  </div>\n  <hr>\n  <form id="loginForm" class="gap">\n    <input type="text" id="username" placeholder="Username" required>\n    <input type="password" id="password" placeholder="Password" required>\n    <br>\n    <button class="btn" type="submit">Login</button>\n    <br>\n    <small class="accent">By logging in you accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n  </form>\n  <hr>\n  <p>New here? <a href="/register">Register</a></p>\n  </div>\n  `,document.getElementById("loginForm").addEventListener("submit",async t=>{t.preventDefault();const e=t.target.username.value,i=t.target.password.value,n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:i})}),s=await n.json();n.ok?(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",s.username),localStorage.setItem("password",s.password),window.location="/dashboard"):D.add("Login error",s.error)})}},"/register":{...{auth:!1,title:"Register",description:"Create a Hawk account and join the community."}||{},fn:function(){function t(t,e){switch(t){case"display_name":return e.length>=f&&e.length<=p;case"username":{const t=e.length>=g&&e.length<=v,i=/^[A-Za-z0-9_]+$/.test(e);return t&&i}case"password":return e.length>=m&&e.length<=y;default:return!1}}function e(t){switch(t){case"display_name":return`Display name must be between ${f} and ${p} characters.`;case"username":return`Username must be between ${g} and ${v} characters and contain only letters, numbers and underscores (a-zA-Z0-9_).`;case"password":return`Password must be between ${m} and ${y} characters.`;default:return"Invalid field."}}document.getElementById("app").innerHTML=`\n  <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/unbanmember.png").dataUrl}"></canv-icon>Register</h3>\n    <span class="description">Create a new account.</span>\n  </div>\n  <hr>\n  <form id="regForm" class="gap">\n    <input type="text" id="display_name" placeholder="Display Name" required>\n    <input type="text" id="username" placeholder="Username" required>\n    <input type="password" id="password" placeholder="Password" required>\n    <br>\n    <button class="btn" type="submit">Register</button>\n    <br>\n    <small class="accent">By creating a account your accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n  </form>\n  <hr>\n  <p>Already have a account? <a href="/login">Login</a></p>\n  </div>\n  `,document.getElementById("regForm").addEventListener("submit",async i=>{i.preventDefault();const n=i.target.display_name.value.trim(),s=i.target.username.value.trim(),r=i.target.password.value;if(t("display_name",n))if(t("username",s))if(t("password",r))try{const t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:n,username:s,password:r})}),e=await t.json();t.ok?D.add("Registered",'Succesfully registered.<br>Login by clicking <a href="/login">here</a>.'):D.add("Register error",e.error||"Unknown error.<br>This maybe is a mistake, please contact an administrator.")}catch(t){D.add("Network error",t.message)}else D.add("Validation error",e("password"));else D.add("Validation error",e("username"));else D.add("Validation error",e("display_name"))})}},"/dashboard":{...{auth:!0,title:"Dashboard",description:"Sign in, and play on the community."}||{},fn:function(){document.getElementById("app").innerHTML=`\n  <div class="main-header">\n    <button class="btn" id="discord">\n      <span><canv-icon src="${a.getBlob("assets/icons/flag.png").dataUrl}"></canv-icon>Join our <strong>Discord</strong> server</span>\n    </button>\n    <button class="btn" id="support">\n      <span><canv-icon src="${a.getBlob("assets/icons/kofi.png").dataUrl}"></canv-icon>Support us</span>\n    </button>\n  </div>\n  <hr>\n  <div style="margin-bottom: 10px;" id="preview"></div>\n  <button class="btn" id="play">\n    <div id="title">\n      <div class="btn-text" style="display:none">Play on <strong id="server-name"></strong></div>\n      <div class="btn-spinner">Loading... <span class="loader"></span></div>\n    </div>\n    <div id="server-dropdown">\n      <div class="hamburger-menu">\n        <span class="bar bar1"></span>\n        <span class="bar bar2"></span>\n        <span class="bar bar3"></span>\n      </div>\n    </div>\n  </button>\n  <div id="server-dropdown-menu"></div>\n  <hr>\n  <div class="card" style="margin-top:14px">\n    <div style="display:flex;justify-content:space-between;align-items:center">\n      <div>\n        <div style="font-size:13px;color:var(--muted)">Server rules</div>\n      </div>\n      <div style="color:var(--muted);font-size:13px">#rules</div>\n    </div>\n\n    <ul id="ruleList" style="margin:12px 0 0 0;padding:0;list-style:none;display:grid;gap:8px"></ul>\n  </div>\n  `;const t=document.getElementById("preview"),e=new Fdt(t),i=document.getElementById("discord"),n=document.getElementById("title"),s=n.querySelector(".btn-text"),r=n.querySelector(".btn-spinner"),h=document.querySelector("#ruleList"),l=document.querySelector("#server-dropdown"),u=document.querySelector("#server-dropdown-menu"),c=l.querySelector(".hamburger-menu"),d=document.querySelector("#server-name");let f=!0;function p(t){t?(n.classList.add("loading"),s.style.display="none",r.style.display="flex"):(n.classList.remove("loading"),s.style.display="flex",r.style.display="none")}function g(t){h.innerHTML="",t.forEach(t=>{h.innerHTML+=`<li style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)">\n        <div>\n          <div style="font-weight:600">${t.title}</div>\n          <div style="font-size:12px;color:var(--muted)">${t.description}</div>\n        </div>\n      </li>`})}var v;i.addEventListener("click",()=>{location.href=P}),n.addEventListener("click",()=>{f||function(){f=!0,p(!0);const t=document.createElement("div");t.id="game-container",t.style.display="none",document.body.appendChild(t),new Ldt(t).game.events.on("gameLoad",()=>{t.style.display="block",e.game.destroy(),p(!1);for(let e=document.body.children.length-1;e>=0;e--){const i=document.body.children[e];i!==t&&document.body.removeChild(i)}})}()}),l.addEventListener("click",t=>{t.stopPropagation(),function(){const t="block"===u.style.display;u.style.display=t?"none":"block",c.className=t?"hamburger-menu":"hamburger-menu open"}()}),document.addEventListener("click",function(){u.style.display="none",c.className="hamburger-menu"}),(v="/api/game/servers",fetch(v,{method:"GET"}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})).then(t=>{if(!t||0===t.length)return f=!0,void p(!1);const e=t[0];d.innerHTML=o(e.name),localStorage.setItem("server",JSON.stringify(e)),g(e.rules),t.forEach(t=>{const e=document.createElement("div");e.className="item",e.innerHTML=`\n        <div class="header">\n          <span class="name">${o(t.name)}</span>\n          <span class="players">${t.players} players online</span>\n        </div>\n        <div class="content">\n          <span class="description">${o(t.description||"")}</span>\n        </div>\n      `,e.addEventListener("click",()=>{d.innerHTML=o(t.name),localStorage.setItem("server",JSON.stringify(t)),g(t.rules)}),u.appendChild(e)}),f=!1,p(!1)}).catch(()=>{f=!0,p(!1)})}},"/avatar":{...{auth:!0,title:"Avatar",description:"Customize your in-game avatar with a custom image."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/createemoji.png").dataUrl}"></canv-icon>In-Game avatar</h3>\n    <span class="description">Modify your in-game avatar.</span>\n  </div>\n<hr>\n      <section class="avatar-section">\n        <div class="header-row">\n          <div>\n            <p id="avatar-desc" class="lead">Upload an avatar for your character.</p>\n            <p class="small accent">Accepted: images. Max 5 MB.</p>\n          </div>\n        </div>\n\n        <label for="avatarInput" class="file-label">\n          <input id="avatarInput" type="file" accept="image/*" class="visually-hidden" />\n        </label>\n\n        <div class="preview-row" aria-live="polite">\n          <canvas id="avatarPreview" width="32" height="32" class="avatar-canvas"></canvas>\n          <div class="preview-text">Preview</div>\n        </div>\n\n        <div class="controls">\n          <button id="uploadAvatarBtn" class="uploadBtn">Upload avatar</button>\n          <div id="avatarMessage" class="message"></div>\n        </div>\n      </section>\n    </div>\n  `;const t=document.getElementById("avatarInput"),e=document.getElementById("avatarPreview").getContext("2d"),i=document.getElementById("avatarMessage"),n=document.getElementById("uploadAvatarBtn");t.addEventListener("change",async t=>{i.textContent="";const n=t.target.files&&t.target.files[0];if(n)try{const t=await Ddt(n);(t=>{const i=32;e.clearRect(0,0,i,i);const n=t.width/t.height;let s=i,r=i;n>1?r=i/n:n<1&&(s=i*n);const a=Math.round((i-s)/2),o=Math.round((i-r)/2);e.drawImage(t,a,o,s,r)})(await Idt(t))}catch(t){i.textContent=t.message||"Error processing image",e.clearRect(0,0,32,32)}}),n.addEventListener("click",async()=>{i.textContent="",n.disabled=!0;try{const e=t.files&&t.files[0];if(!e)throw new Error("Please select an image first");const n=await kdt(e,{maxBytes:5e6});if(!n)throw new Error("Could not convert image");const s=localStorage.getItem("username"),r=localStorage.getItem("password");await async function(t,e=null,i=null,{timeoutMs:n=15e3}={}){if(!t)throw new Error("No image to upload");const s={image:t,username:e??null,password:i??null},r=new AbortController,a=setTimeout(()=>r.abort(),n);let o;try{o=await fetch("/api/avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),signal:r.signal})}catch(t){if("AbortError"===t.name)throw new Error("Upload timed out");throw new Error("Network error while uploading avatar")}finally{clearTimeout(a)}if(!o.ok){const t=await o.text().catch(()=>"");throw new Error(`Server error ${o.status}${t?`: ${t}`:""}`)}try{return await o.json()}catch{return null}}(n,s,r,{timeoutMs:15e3}),i.textContent="Avatar uploaded successfully"}catch(t){i.textContent=t.message||"Upload error"}finally{n.disabled=!1}})}},"/profile":{...{auth:!0,title:"Profile",description:"View and edit your public profile."}||{},fn:async function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Profile</h3>\n    <span class="description">Main profile.</span>\n  </div>\n  <hr>\n      <div class="profile-header" style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">\n        <img id="profileAvatar" src="/assets/generic-profile.png" width="64" height="64" style="border-radius:50%;object-fit:cover;background:#222;">\n        <div>\n          <div id="profileUsername" style="font-weight:700;font-size:18px"></div>\n          <div id="profileDisplayName" style="color:#666;margin-top:4px"></div>\n          <div id="profileId" style="color:#999;font-size:12px;margin-top:6px">ID: â</div>\n        </div>\n      </div>\n\n      <div>\n        <span id="profileFieldBio">No bio.</span>\n        <p id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n          <a class="btn mini" id="editProfileBtn" href="/profile-settings">Edit profile</a>\n          <a class="btn mini" id="editAvatarBtn" href="/avatar">Edit in-game avatar</a>\n        </p>\n      </div>\n    </div>\n  `;const t=document.getElementById("profileAvatar"),e=document.getElementById("profileUsername"),i=document.getElementById("profileDisplayName"),n=document.getElementById("profileId"),o=document.getElementById("profileFieldBio"),h=document.getElementById("profileActions");function l(t,s,a,h){e.textContent=r(t||"Username"),i.textContent=r(s||"Display name"),o.textContent=r(h||"No bio."),n.textContent=`ID: ${r(String(a||"â"))}`}function u(){h&&(h.style.display="none")}function c(){h&&(h.style.display="flex")}async function d(e){if(e)try{const i=await fetch(`/api/pavatar/${encodeURIComponent(e)}`);if(!i.ok)return void(t.src="");const n=await i.blob(),s=URL.createObjectURL(n);t.src=s,setTimeout(()=>URL.revokeObjectURL(s),6e4)}catch{t.src=""}else t.src=""}document.getElementById("editProfileBtn"),document.getElementById("editAvatarBtn"),(async()=>{const t=function(t){return new URLSearchParams(window.location.search).get(t)}("id"),e=await async function(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await s("/api/auth/check",{username:t,password:e})||null}catch{return null}}(),i=e&&e.id?String(e.id):null;if(t){const e=await async function(t){try{const e=await s("/api/auth/profile",{id:t});if(!e)return null;const i=e.username||"",n=e.displayName||e.display_name||"",r=e.bio||"";return l(i,n,e.id||t,r),(e.id||t)&&await d(e.id||t),e}catch(t){return null}}(t);if(e)return void(i&&String(e.id||t)===i?c():u())}if(e){l(e.username||localStorage.getItem("username")||"",e.displayName||localStorage.getItem("display_name")||"",e.id,e.bio),e.id&&await d(e.id),e.username&&localStorage.setItem("username",e.username),e.displayName&&localStorage.setItem("display_name",e.displayName),c()}else l("","","â",""),u()})()}},"/profile-settings":{...{auth:!0,title:"Profile Settings",description:"Manage data and security settings."}||{},fn:async function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/control.png").dataUrl}"></canv-icon>Profile Settings</h3>\n    <span class="description">Edit/Modify your profile with ease.</span>\n  </div>\n  <hr>\n\n      <div class="header-row" id="headerRow">\n        <div class="avatar-wrap"><canvas id="settingsAvatarPreview" width=128 height=128></canvas></div>\n        <div class="header-meta">\n          <div id="settingsUsername" class="username"></div>\n          <div id="settingsDisplayName" class="displayname"></div>\n          <div id="settingsId" class="id">ID: â</div>\n        </div>\n      </div>\n\n      <div class="profile-grid">\n        <div class="profile-section">\n          <label for="settingsDisplayNameInput">Display name</label>\n          <input id="settingsDisplayNameInput" type="text" />\n          <button id="settingsSaveDisplayName" class="btn mini">Save</button>\n          <div id="settingsDisplayNameMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsUsernameInput">Username</label>\n          <input id="settingsUsernameInput" type="text" />\n          <button id="settingsSaveUsername" class="btn mini">Save</button>\n          <div id="settingsUsernameMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsPasswordInput">Password</label>\n          <input id="settingsPasswordInput" type="password" />\n          <button id="settingsSavePassword" class="btn mini">Save</button>\n          <div id="settingsPasswordMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="profile-section">\n          <label for="settingsBioInput">Bio</label>\n          <input id="settingsBioInput" type="bio" />\n          <button id="settingsSaveBio" class="btn mini">Save</button>\n          <div id="settingsBioMsg" class="message" aria-live="polite"></div>\n        </div>\n\n        <div class="avatar-block">\n          <div class="avatar-row" style="margin-top:8px;">\n            <canvas id="settingsAvatarPreviewSmall" width="128" height="128"></canvas>\n            <div>\n              <input id="settingsAvatarInput" type="file" accept="image/*" />\n              <button id="settingsUploadAvatar" class="uploadBtn">Upload avatar</button>\n              <div id="settingsAvatarMsg" class="message" aria-live="polite"></div>\n            </div>\n          </div>\n        </div>\n\n        <div id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n          <a class="btn mini" href="/profile">Back to profile</a>\n        </div>\n      </div>\n    </div>\n  `;const t=t=>document.getElementById(t),o=t("settingsAvatarPreview"),h=t("settingsAvatarPreviewSmall"),l=t("settingsUsername"),u=t("settingsDisplayName"),c=t("settingsId"),d=t("settingsDisplayNameInput"),f=t("settingsSaveDisplayName"),p=t("settingsDisplayNameMsg"),g=t("settingsUsernameInput"),v=t("settingsSaveUsername"),m=t("settingsUsernameMsg"),y=t("settingsPasswordInput"),x=t("settingsSavePassword"),w=t("settingsPasswordMsg"),T=t("settingsBioInput"),b=t("settingsSaveBio"),S=t("settingsBioMsg"),E=t("settingsAvatarInput"),_=t("settingsUploadAvatar"),C=t("settingsAvatarMsg"),A=o.getContext("2d"),P=h.getContext("2d");function M(t,e,i=!1){t.textContent=e,t.style.color=i?"crimson":""}async function R(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await s("/api/auth/check",{username:t,password:e})||null}catch{return null}}async function L(t){if(!t)return;const e=t.id,i=t.username||localStorage.getItem("username")||"",s=t.displayName||localStorage.getItem("display_name")||"";if(l.textContent=r(i),u.textContent=r(s),c.textContent=`ID: ${r(String(e))}`,e)try{const t=await fetch(`/api/pavatar/${encodeURIComponent(e)}`);if(t.ok){const e=await t.blob(),i=URL.createObjectURL(e),s=new Image;s.src=i,s.onload=()=>{n(s,o,Math.min(o.width,o.height)),n(s,h,Math.min(h.width,h.height)),setTimeout(()=>URL.revokeObjectURL(i),6e4)}}else A.clearRect(0,0,o.width,o.height),P.clearRect(0,0,h.width,h.height)}catch{A.clearRect(0,0,o.width,o.height),P.clearRect(0,0,h.width,h.height)}}async function O({key:t,inputEl:e,msgEl:i,successLocalKey:n}){const r=localStorage.getItem("username"),a=localStorage.getItem("password"),o=e.value;if(r&&a)try{const e=await s("/api/user/edit",{username:r,password:a,key:t,value:o});M(i,e&&(e.message||e.success)||"Done"),n&&localStorage.setItem(n,o);const h=await R();h&&(h.displayName&&(d.value=h.displayName,localStorage.setItem("display_name",h.displayName)),h.username&&(g.value=h.username,localStorage.setItem("username",h.username)),await L(h))}catch(t){M(i,t.message||"Error",!0)}else M(i,"Credentials not stored locally.",!0)}A.clearRect(0,0,o.width,o.height),P.clearRect(0,0,h.width,h.height),f.addEventListener("click",()=>O({key:"displayName",inputEl:d,msgEl:p,successLocalKey:"display_name"})),v.addEventListener("click",()=>O({key:"username",inputEl:g,msgEl:m,successLocalKey:"username"})),x.addEventListener("click",()=>O({key:"password",inputEl:y,msgEl:w})),b.addEventListener("click",()=>O({key:"bio",inputEl:T,msgEl:S})),E.addEventListener("change",async t=>{C.textContent="";const s=t.target.files&&t.target.files[0];if(s)try{const t=await e(s),r=await i(t);n(r,o,Math.min(o.width,o.height)),n(r,h,Math.min(h.width,h.height))}catch(t){M(C,t.message||"Error processing image",!0)}}),_.addEventListener("click",async()=>{M(C,"Uploading..."),_.disabled=!0;try{const t=E.files&&E.files[0];if(!t)throw new Error("Please select an image first");const r=await async function(t){if(!t)throw new Error("No file provided");if(!t.type.startsWith("image/"))throw new Error("File is not an image");const s=await e(t),r=await i(s);if(128===r.width&&128===r.height)return s;const a=document.createElement("canvas");return a.width=128,a.height=128,n(r,a,128),a.toDataURL("image/png")}(t),a=localStorage.getItem("username"),o=localStorage.getItem("password"),h=await s("/api/pavatar",{image:r,username:a,password:o});M(C,h&&(h.message||"Avatar uploaded successfully")||"Avatar uploaded");const l=await R();l&&(l.displayName&&localStorage.setItem("display_name",l.displayName),l.username&&localStorage.setItem("username",l.username),await L(l))}catch(t){M(C,t.message||"Upload error",!0)}finally{_.disabled=!1}}),(async()=>{const t=await R();if(t)t.displayName&&(d.value=t.displayName,localStorage.setItem("display_name",t.displayName)),t.username&&(g.value=t.username,localStorage.setItem("username",t.username)),await L(t);else{const t=localStorage.getItem("display_name")||"",e=localStorage.getItem("username")||"";d.value=t,g.value=e,l.textContent=r(e||"Username"),u.textContent=r(t||"Display name")}})()}},"/people":{...{auth:!0,title:"People",description:"Manage friends, and send game invites."}||{},fn:Fut},"/about":{...{auth:!1,title:"About",description:"Overview of Hawk, its mission, and team."}||{},fn:function(){let t="";M.forEach(e=>{t+=`<div class="contributor">\n      <span>${e.name} <span class="accent">@${e.username}</span></span>\n      <br>\n      <small>Role: <span class="accent">${e.role}</span></small>\n    </div><br>`}),document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>About</h3>\n    <span class="description">About Hawk.</span>\n  </div>\n  <hr>\n    <p>A game written in <strong>Javascript</strong> using Hawk (based in <a href="https://phaser.io/">Phaser</a>) engine, check <a href="/help">help page</a> for controls and more.</p>\n    \n    <h2>Contact</h2>\n    <p>You can contact us on <strong>Discord</strong> <a href="${P}">here</a>.</p>\n    \n    <h2>Team</h2>\n    <p>Our team has <strong>${M.length}</strong> contributor(s). You can be one by joining our Discord Server and contributing!</p>\n    ${t}\n    </div>\n  `}},"/help":{...{auth:!1,title:"Help",description:"Controls, and some help."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>Help</h3>\n    <span class="description">Help and controls of Hawk.</span>\n  </div>\n  <hr>\n    <p>Our help page, check <a href="/about">about page</a> for more info.</p>\n    \n    <h2>Contact</h2>\n    <p>You can contact us on <strong>Discord</strong> <a href="${P}">here</a>.</p>\n    \n    <h2>Controls</h2>\n    <p>\n      <strong>PC:</strong> Use the <span class="highlight">W</span><span class="highlight">A</span><span class="highlight">S</span><span class="highlight">D</span> keys for movement.\n    </p>\n    <p>\n      <strong>Mobile:</strong> Use the dynamic joystick on the screen for movement.\n    </p>\n    </div>\n  `}},"/privacypolicy":{...{auth:!1,title:"Privacy Policy",description:"Details on how Hawk collects, uses, and protects data."}||{},fn:function(){document.getElementById("app").innerHTML=`\n<span>\n<strong>Privacy Policy (PRIVACY) - Hawk</strong>\n<br><br>\n1. <strong>Data collected</strong><br>\n- At registration we collect: <strong>username</strong>, <strong>password</strong>, and <strong>display name</strong>.\n<br><br>\n2. <strong>Purpose and use</strong><br>\n- <strong>username</strong> and <strong>password</strong>: validated and used exclusively for authentication and friend requests.<br>\n- <strong>display name</strong>: shown on the site to identify the user.\n<br><br>\n3. <strong>No cookies</strong><br>\n- <strong>We do not use cookies.</strong>\n<br><br>\n4. <strong>Sharing</strong><br>\n- We do not share personal data with third parties, except when required by law.\n<br><br>\n5. <strong>Retention</strong><br>\n- Account data is retained indefinitely and <strong>accounts cannot be deleted</strong>.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not intended for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update this Privacy Policy at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${P}">here</a>.\n</span>`}},"/termsofservice":{...{auth:!1,title:"Terms Of Service",description:"Rules and legal terms governing use of Hawk."}||{},fn:function(){document.getElementById("app").innerHTML=`\n<span>\n<strong>Terms of Service (TERMS) - Hawk</strong>\n<br><br>\n1. <strong>Acceptance</strong><br>\nBy using this site you accept these Terms. If you do not agree, do not use the service.\n<br><br>\n2. <strong>Registration and account</strong><br>\n- To create an account you must register with: <strong>username</strong>, <strong>password</strong> and <strong>display name</strong>.<br>\n- <strong>username</strong> and <strong>password</strong> are used to log in. <strong>display name</strong> is used only to identify you publicly within the site.<br>\n- You are responsible for keeping your <strong>username</strong> and <strong>password</strong> confidential and for all activities that occur under your account.\n<br><br>\n3. <strong>Permitted use</strong><br>\n- Do not use the service for illegal, fraudulent, defamatory activities, or to infringe the rights of others.<br>\n- We may suspend or delete accounts that violate these Terms.\n<br><br>\n4. <strong>User content</strong><br>\n- You retain ownership of content you publish.<br>\n- By posting content you agree the site may display it to other users according to the siteâs functionality.\n<br><br>\n5. <strong>Account status</strong><br>\n- Accounts remain on the system indefinitely.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.<br>\n- Use strong, unique passwords.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update these Terms at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${P}">here</a>.\n</span>`}},"/404":{...{auth:!1,title:"404",description:"This page has not found."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${a.getBlob("assets/icons/endstage.png").dataUrl}"></canv-icon>404 - Not Found</h3>\n    <span class="description">Not found</span>\n  </div>\n  <hr>\n    <p>This page was not found.</p>\n    <p>If you think this is a mistake, You can contact us on <strong>Discord</strong> <a href="${P}">here</a>.</p>\n    \n    <a class="btn" href="/dashboard">Go to dashboard</a>\n    </div>\n  `}},"/ping":{...{auth:!1,title:"Ping",description:"Check the ping between you and Hawk servers."}||{},fn:function(){document.getElementById("app").innerHTML=`\n    <div class="auth">\n      <div class="header">\n        <h3><canv-icon src="${a.getBlob("assets/icons/pings.png").dataUrl}"></canv-icon>Ping</h3>\n        <span class="description">Ping check</span>\n      </div>\n      <hr>\n      <p>Check your ping between you and <strong>Hawk</strong> servers.</p>\n      <br>\n      <p id="ping-result"><i>Your result will appear here.</i></p>\n      <br>\n      <button class="btn" id="ping-button">Check your ping</button>\n      <small>The result can not be same as play ping. It also depends of device speed.</small>\n    </div>\n  `;const t=document.getElementById("ping-button"),e=document.getElementById("ping-result");t.addEventListener("click",async()=>{const t=(new Date).getTime();try{if((await fetch("/api/game/servers")).ok){const i=(new Date).getTime()-t;let n;n=i<100?`<canv-icon src="${a.getBlob("assets/icons/goodping.png").dataUrl}"></canv-icon>`:i<300?`<canv-icon src="${a.getBlob("assets/icons/idelping.png").dataUrl}"></canv-icon>`:`<canv-icon src="${a.getBlob("assets/icons/badping.png").dataUrl}"></canv-icon>`,e.innerHTML=`${n} Ping: ${i} ms`}else e.innerText="Error checking your ping"}catch(t){e.innerText="Error checking your ping"}})}},"/":{...{}||{}}};let Ndt=null,Udt=null,zdt=!1;function Ydt(){if(!zdt){document.body.innerHTML="",Ndt=function(){const t=localStorage.getItem("loggedIn"),e=document.createElement("nav");e.className="main-nav",e.innerHTML=`\n    <div class="nav-icon">\n      <img src="${a.getBlob("logo.svg").dataUrl}" alt="Hawk" width="auto" height="25">\n    </div>\n    <p class="nav-title">Hawk</p>\n    <div class="nav-dropdown">\n      <button id="dropdownBtn">\n        ${t?'\n        <div id="user">\n          <img id="pavatar"></img>\n          <span class="accent" id="displayName"></span>\n        </div>\n        ':""}\n        <div class="hamburger-menu">\n          <span class="bar bar1"></span>\n          <span class="bar bar2"></span>\n          <span class="bar bar3"></span>\n        </div>\n      </button>\n      <div id="dropdownMenu" class="dropdown-menu">\n        ${t?'\n        <li><a href="/dashboard">Dashboard</a></li>\n        <hr>\n        <li><a href="/profile">Profile</a></li>\n        <li><a href="/people">People</a></li>\n        <hr>\n        <li><a id="logoutBtn">Logout</a></li>\n        ':'\n        <li><a href="/login">Login</a></li>\n        <li><a href="/register">Register</a></li>\n        '}\n        <hr>\n        <li><a href="/about">About</a></li>\n        <li><a href="/help">Help</a></li>\n      </div>\n    </div>\n  `;const i=e.querySelector("#dropdownBtn"),n=e.querySelector("#dropdownMenu"),s=i.querySelector(".hamburger-menu");return i.addEventListener("click",t=>{t.stopPropagation(),n.style.display="block"===n.style.display?"none":"block",s.className="block"===n.style.display?"hamburger-menu open":"hamburger-menu"}),document.addEventListener("click",()=>{n.style.display="none",s.className="block"===n.style.display?"hamburger-menu open":"hamburger-menu"}),t&&(e.querySelector("#logoutBtn").addEventListener("click",()=>{localStorage.removeItem("loggedIn"),localStorage.removeItem("username"),localStorage.removeItem("password"),window.location="/login"}),l(A,h()).then(t=>{const e=document.getElementById("displayName"),i=document.getElementById("pavatar");e.innerText=t.displayName,i.src="/api/pavatar/"+t.id})),e}(),document.body.appendChild(Ndt);const t=document.createElement("main");t.id="app",document.body.appendChild(t),Udt=document.createElement("footer"),Udt.className="site-footer",Udt.innerHTML=`\n  <div class="footer-top">\n    <div class="brand">\n      <img src="${a.getBlob("logo.svg").dataUrl}" alt="Logo" class="footer-logo">\n      <span class="brand-name">Hawk</span>\n    </div>\n    <div class="right-side">\n    </div>\n  </div>\n  <div class="footer-bottom">\n    <div class="authors">\n      Â© ${(new Date).getFullYear()} â ${F}\n    </div>\n    <div class="extras">\n      <p>${L} Â· assets-${O}</p>\n      <a href="/termsofservice">Terms Of Service</a> Â· <a href="/privacypolicy">Privacy Policy</a> Â· <a href="${P}">Discord</a>\n    </div>\n  </div>\n`,Udt.style.marginTop="170px",document.body.appendChild(Udt),document.body.addEventListener("click",Xdt),zdt=!0}}function Xdt(t){if(t.defaultPrevented)return;if(0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;let e=t.target;for(;e&&"A"!==e.nodeName;)e=e.parentElement;if(!e)return;const i=e.getAttribute("href");!i||i.startsWith("http")||i.startsWith("mailto:")||i.startsWith("tel:")||(t.preventDefault(),function(t){if(!t.startsWith("/")){t=window.location.pathname.replace(/\/+$/,"")+"/"+t}window.history.pushState({},"",t),Gdt()}(i))}function Gdt(){const t=function(){const t=window.location.pathname.split("/").filter(Boolean);return"/"+(t.length?t[t.length-1]:"")}(),e=Bdt[t]||{},i=!!localStorage.getItem("loggedIn");if("/"===t&&(i?window.history.replaceState({},"","/dashboard"):window.history.replaceState({},"","/login")),e.redirect)return window.history.replaceState({},"",e.redirect),Gdt();if(e.auth&&!i)return window.history.replaceState({},"","/login"),Gdt();if(!e.auth&&i&&("/login"===t||"/register"===t))return window.history.replaceState({},"","/dashboard"),Gdt();if(!e.fn)return window.history.replaceState({},"","/404"),Gdt();document.title="Hawk - "+e.title,localStorage.getItem("display_name");const n=document.getElementById("app");n&&n.classList.add("hidden"),setTimeout(()=>{Ydt(),function(){const t=document.getElementById("app");t&&(t.innerHTML="")}(),e.fn(),setTimeout(()=>{n&&n.classList.remove("hidden")},500)},500)}window.addEventListener("popstate",()=>{Gdt()});var Wdt={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function Hdt(){if("function"==typeof importScripts)return Wdt;var t=navigator.userAgent;/Windows/.test(t)?Wdt.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(Wdt.iOS=!0,Wdt.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),Wdt.iOSVersion=parseInt(RegExp.$1,10)):Wdt.macOS=!0:/Android/.test(t)?Wdt.android=!0:/Linux/.test(t)?Wdt.linux=!0:/iP[ao]d|iPhone/i.test(t)?(Wdt.iOS=!0,navigator.appVersion.match(/OS (\d+)/),Wdt.iOSVersion=parseInt(RegExp.$1,10),Wdt.iPhone=-1!==t.toLowerCase().indexOf("iphone"),Wdt.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?Wdt.kindle=!0:/CrOS/.test(t)&&(Wdt.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(Wdt.android=!1,Wdt.iOS=!1,Wdt.macOS=!1,Wdt.windows=!0,Wdt.windowsPhone=!0);var e=/Silk/.test(t);return(Wdt.windows||Wdt.macOS||Wdt.linux&&!e||Wdt.chromeOS)&&(Wdt.desktop=!0),(Wdt.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(Wdt.desktop=!1),navigator.standalone&&(Wdt.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(Wdt.cordova=!0),void 0!==window.ejecta&&(Wdt.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(Wdt.node=!0),Wdt.node&&"object"==typeof process.versions&&(Wdt.nodeWebkit=!!process.versions["node-webkit"],Wdt.electron=!!process.versions.electron),/Crosswalk/.test(t)&&(Wdt.crosswalk=!0),Wdt.pixelRatio=window.devicePixelRatio||1,Wdt}var Vdt={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function jdt(){var t=navigator.userAgent;return/Edg\/\d+/.test(t)?(Vdt.edge=!0,Vdt.es2019=!0):/OPR/.test(t)?(Vdt.opera=!0,Vdt.es2019=!0):/Chrome\/(\d+)/.test(t)&&!Hdt().windowsPhone?(Vdt.chrome=!0,Vdt.chromeVersion=parseInt(RegExp.$1,10),Vdt.es2019=Vdt.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(Vdt.firefox=!0,Vdt.firefoxVersion=parseInt(RegExp.$1,10),Vdt.es2019=Vdt.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&Hdt().iOS?(Vdt.mobileSafari=!0,Vdt.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(Vdt.ie=!0,Vdt.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!Hdt().windowsPhone?(Vdt.safari=!0,Vdt.safariVersion=parseInt(RegExp.$1,10),Vdt.es2019=Vdt.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(Vdt.ie=!0,Vdt.trident=!0,Vdt.tridentVersion=parseInt(RegExp.$1,10),Vdt.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(Vdt.silk=!0),Vdt}var qdt={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};function Kdt(){if("function"==typeof importScripts)return qdt;qdt.canvas=!!window.CanvasRenderingContext2D;try{qdt.localStorage=!!localStorage.getItem}catch(t){qdt.localStorage=!1}qdt.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),qdt.fileSystem=!!window.requestFileSystem;var t=!1;return qdt.webGL=function(){if(window.WebGLRenderingContext)try{var e=document.createElement("canvas"),i=e.getContext("webgl")||e.getContext("experimental-webgl"),n=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return t=n.data instanceof Uint8ClampedArray,!!i}catch(t){return!1}return!1}(),qdt.worker=!!window.Worker,qdt.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,qdt.getUserMedia=qdt.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,jdt().firefox&&jdt().firefoxVersion<21&&(qdt.getUserMedia=!1),!Hdt().iOS&&(jdt().ie||jdt().firefox||jdt().chrome)&&(qdt.canvasBitBltShift=!0),(jdt().safari||jdt().mobileSafari)&&(qdt.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(qdt.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(qdt.littleEndian=function(){var t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t);return e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===i[0]||2712847316!==i[0]&&null}()),qdt.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==qdt.littleEndian&&t,qdt}const Zdt=["assets/icons/0.png","assets/icons/1.png","assets/icons/10.png","assets/icons/18.png","assets/icons/2.png","assets/icons/3.png","assets/icons/4.png","assets/icons/5.png","assets/icons/6.png","assets/icons/7.png","assets/icons/8.png","assets/icons/9.png","assets/icons/Bugs.png","assets/icons/Correct.png","assets/icons/DAC.png","assets/icons/Discord.png                               ./public/assets/icons/Download.png","assets/icons/Female.png","assets/icons/Guardian.png","assets/icons/HSbalance.png","assets/icons/HSbravery.png","assets/icons/HSbrilliance.png","assets/icons/MSvisualcode.png","assets/icons/Male.png","assets/icons/New.png","assets/icons/OAuth2.png","assets/icons/Person.png","assets/icons/Wrong.png","assets/icons/a.png","assets/icons/activedevbadge.png","assets/icons/activities.png","assets/icons/addreactions.png","assets/icons/aka.png","assets/icons/amogus.png","assets/icons/announce.png","assets/icons/archive.png","assets/icons/audiodisable.png","assets/icons/audioenable.png","assets/icons/award.png","assets/icons/awardcup.png","assets/icons/b.png","assets/icons/backforward.png","assets/icons/badping.png","assets/icons/ban.png","assets/icons/bank.png","assets/icons/banmembers.png","assets/icons/bday.png","assets/icons/behance.png","assets/icons/beta.png","assets/icons/beta1.png","assets/icons/beta1A.png","assets/icons/beta2.png","assets/icons/beta2A.png","assets/icons/bigender.png","assets/icons/birdman.png","assets/icons/book.png","assets/icons/bookmark.png","assets/icons/bots.png","assets/icons/box.png","assets/icons/bright.png","assets/icons/bulb.png","assets/icons/busy.png","assets/icons/c.png","assets/icons/calendar1.png","assets/icons/calender.png","assets/icons/calenderdate.png","assets/icons/callconnect.png","assets/icons/calldecline.png","assets/icons/calldisconnect.png","assets/icons/camera.png","assets/icons/channel.png","assets/icons/channelfollowed.png","assets/icons/clean.png","assets/icons/clock.png","assets/icons/clouddown.png","assets/icons/cmd.png","assets/icons/code.png","assets/icons/coin.png","assets/icons/colorboostnitro.png","assets/icons/colornitro.png","assets/icons/colorserverpartner.png","assets/icons/colorserververified.png","assets/icons/colorstaff.png","assets/icons/connect.png","assets/icons/control.png","assets/icons/createcategory.png","assets/icons/createchannel.png","assets/icons/createchannels.png","assets/icons/createemoji.png","assets/icons/createintegration.png","assets/icons/createrole.png","assets/icons/createsticker.png","assets/icons/createthread.png","assets/icons/createwebhook.png","assets/icons/creditcard.png","assets/icons/customstaff.png","assets/icons/d.png","assets/icons/dblurple.png","assets/icons/defaultperms.png","assets/icons/delete.png","assets/icons/deletechannel.png","assets/icons/deleteemoji.png","assets/icons/deleteevent.png","assets/icons/deleteintegration.png","assets/icons/deleterole.png","assets/icons/deletesticker.png","assets/icons/deletethread.png","assets/icons/deletewebhook.png","assets/icons/dfuchsia.png","assets/icons/dgreen.png","assets/icons/disable.png","assets/icons/discordbotdev.png","assets/icons/discordbughunter.png","assets/icons/discordhypesquard.png","assets/icons/discordjs.png","assets/icons/discordmod.png","assets/icons/discordnitro.png","assets/icons/discordpartner.png","assets/icons/discordstaff.png","assets/icons/discover.png","assets/icons/dislike.png","assets/icons/djoin.png","assets/icons/dleave.png","assets/icons/dollar.png","assets/icons/downarrow.png","assets/icons/downvote.png","assets/icons/dred.png","assets/icons/dwhite.png","assets/icons/dyellow.png","assets/icons/e.png","assets/icons/earlysupporter.png","assets/icons/edit.png","assets/icons/education.png","assets/icons/emojiguardian.png","assets/icons/enable.png","assets/icons/endstage.png","assets/icons/eventcolour.png","assets/icons/exclamation.png","assets/icons/f.png","assets/icons/fb.png","assets/icons/figma.png","assets/icons/file.png","assets/icons/files.png","assets/icons/fingerprint.png","assets/icons/fire.png","assets/icons/flag.png","assets/icons/folder.png","assets/icons/forum.png","assets/icons/forumNFSW.png","assets/icons/friends.png","assets/icons/frontforward.png","assets/icons/fword.png","assets/icons/g.png","assets/icons/games.png","assets/icons/gay.png","assets/icons/gender.png","assets/icons/generalinfo.png","assets/icons/gif.png","assets/icons/gift.png","assets/icons/gitbranch.png","assets/icons/gitcommit.png","assets/icons/github.png","assets/icons/gitmerge.png","assets/icons/gitpullrequest.png","assets/icons/globe.png","assets/icons/goodping.png","assets/icons/growth.png","assets/icons/h.png","assets/icons/hammer.png","assets/icons/he_him.png","assets/icons/headphone.png","assets/icons/headphonedeafen.png","assets/icons/heart.png","assets/icons/hetero.png","assets/icons/hi.png","assets/icons/hoursglass.png","assets/icons/hyphen.png","assets/icons/i.png","assets/icons/id.png","assets/icons/idelping.png","assets/icons/idle.png","assets/icons/illustrator.png","assets/icons/image.png","assets/icons/info.png","assets/icons/instagram.png","assets/icons/invite.png","assets/icons/j.png","assets/icons/join.png","assets/icons/jpg.png","assets/icons/js.png","assets/icons/k.png","assets/icons/kick.png","assets/icons/kicking.png","assets/icons/kofi.png","assets/icons/l.png","assets/icons/leave.png","assets/icons/leftarrow.png","assets/icons/lesbian.png","assets/icons/library.png","assets/icons/like.png","assets/icons/link.png","assets/icons/linkadd.png","assets/icons/linked.png","assets/icons/linkrevoke.png","assets/icons/linkupdate.png","assets/icons/list.png","assets/icons/live.png","assets/icons/loading.png","assets/icons/loadingerror.png","assets/icons/locked.png","assets/icons/loop.png","assets/icons/m.png","assets/icons/magicwand.png","assets/icons/markasread.png","assets/icons/mashroomman.png","assets/icons/mentalhealth.png","assets/icons/menu.png","assets/icons/message.png","assets/icons/mic.png","assets/icons/micmute.png","assets/icons/moderationhig.png","assets/icons/moderationhighest.png","assets/icons/moderationlow.png","assets/icons/moderationmedium.png","assets/icons/moderationnone.png","assets/icons/monitor.png","assets/icons/music.png","assets/icons/musicstop.png","assets/icons/n.png","assets/icons/new1.png","assets/icons/new1A.png","assets/icons/new2.png","assets/icons/new2A.png","assets/icons/newmembers.png","assets/icons/news1.png","assets/icons/news2.png","assets/icons/night.png","assets/icons/nitro.png","assets/icons/nitroboost.png","assets/icons/nodejs.png","assets/icons/notificationsettings.png","assets/icons/notify.png","assets/icons/o.png","assets/icons/off.png","assets/icons/offline.png","assets/icons/on.png","assets/icons/online.png","assets/icons/outage.png","assets/icons/owner.png","assets/icons/p.png","assets/icons/paintpadbrush.png","assets/icons/partner.png","assets/icons/patreon.png","assets/icons/pause.png","assets/icons/paypal.png","assets/icons/pen.png","assets/icons/people.png","assets/icons/photoshop.png","assets/icons/pin.png","assets/icons/ping.png","assets/icons/pings.png","assets/icons/plant.png","assets/icons/play.png","assets/icons/plus.png","assets/icons/png.png","assets/icons/podcast.png","assets/icons/premium.png","assets/icons/premiumchannel.png","assets/icons/q.png","assets/icons/question.png","assets/icons/queue.png","assets/icons/quotes.png","assets/icons/r.png","assets/icons/rVIP.png","assets/icons/radmins.png","assets/icons/rartists.png","assets/icons/rboosters.png","assets/icons/rbots.png","assets/icons/rcamera.png","assets/icons/rdevelopers.png","assets/icons/reddit.png","assets/icons/reminder.png","assets/icons/repeat.png","assets/icons/repeatonce.png","assets/icons/reply.png","assets/icons/revents.png","assets/icons/rfire.png","assets/icons/rguardians.png","assets/icons/rhelpers.png","assets/icons/richpresence.png","assets/icons/rightarrow.png","assets/icons/rmembers.png","assets/icons/rmods.png","assets/icons/roles.png","assets/icons/rowner.png","assets/icons/rpodcast.png","assets/icons/rsdonator.png","assets/icons/rspartner.png","assets/icons/rsstaffs.png","assets/icons/rstaff.png","assets/icons/rules.png","assets/icons/rverification.png","assets/icons/rverified.png","assets/icons/s.png","assets/icons/saturn.png","assets/icons/scheduleevent.png","assets/icons/screenshare.png","assets/icons/search.png","assets/icons/sentry.png","assets/icons/serverinsight.png","assets/icons/servermute.png","assets/icons/serverpartner.png","assets/icons/serververified.png","assets/icons/settings.png","assets/icons/share.png","assets/icons/she_her.png","assets/icons/shine1.png","assets/icons/shine2.png","assets/icons/shine3.png","assets/icons/shuffle.png","assets/icons/slashcmd.png","assets/icons/snapchat.png","assets/icons/snowflake.png","assets/icons/spark.png","assets/icons/speaker.png","assets/icons/speakerlock.png","assets/icons/speakerlow.png","assets/icons/speakermute.png","assets/icons/splash.png","assets/icons/spotify.png","assets/icons/stageleave.png","assets/icons/stagelocked.png","assets/icons/stagemoderator.png","assets/icons/stagemoveaudience.png","assets/icons/stagemovespeaker.png","assets/icons/stagerequesttospeak.png","assets/icons/stagerequesttospeaklist.png","assets/icons/star.png","assets/icons/startstage.png","assets/icons/statsdown.png","assets/icons/stickers.png","assets/icons/store.png","assets/icons/stream.png","assets/icons/supportscommandsbadge.png","assets/icons/supportteam.png","assets/icons/swardx.png","assets/icons/t.png","assets/icons/tada.png","assets/icons/text1.png","assets/icons/text2.png","assets/icons/text3.png","assets/icons/text4.png","assets/icons/text5.png","assets/icons/text6.png","assets/icons/they_them.png","assets/icons/threadchannel.png","assets/icons/ticket.png","assets/icons/tiktok.png","assets/icons/tilde.png","assets/icons/timeout.png","assets/icons/todolist.png","assets/icons/topgg.png","assets/icons/transferownership.png","assets/icons/transgender.png","assets/icons/translate.png","assets/icons/twitch.png","assets/icons/twitter.png","assets/icons/u.png","assets/icons/unbanmember.png","assets/icons/unlock.png","assets/icons/uparrow.png","assets/icons/update.png","assets/icons/update1.png","assets/icons/update2.png","assets/icons/updatechannel.png","assets/icons/updateemoji.png","assets/icons/updateevent.png","assets/icons/updateintegration.png","assets/icons/updatemember.png","assets/icons/updaterole.png","assets/icons/updateserver.png","assets/icons/updatestage.png","assets/icons/updatesticker.png","assets/icons/updatethread.png","assets/icons/updatewebhook.png","assets/icons/upvote.png","assets/icons/v.png","assets/icons/verified.png","assets/icons/video.png","assets/icons/view.png","assets/icons/vip.png","assets/icons/vklogo.png","assets/icons/vpn.png","assets/icons/w.png","assets/icons/warning.png","assets/icons/wave.png","assets/icons/webp.png","assets/icons/wumpus.png","assets/icons/x.png","assets/icons/xmarkwhite.png","assets/icons/y.png","assets/icons/youtube.png","assets/icons/z.png"],Jdt=document.createElement("canvas"),$dt=Jdt.getContext("2d",{willReadFrequently:!0});class Qdt extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const t=this.getAttribute("src"),e=this.getAttribute("color"),i=document.createElement("img");i.src=t,i.style.width="2em",i.style.height="2em",i.style.verticalAlign="middle",i.style.marginRight="5px",i.onload=()=>{Jdt.width=128,Jdt.height=128,$dt.drawImage(i,0,0);const t=$dt.getImageData(0,0,Jdt.width,Jdt.height);for(let e=0;e<t.data.length;e+=4){const i=(t.data[e]+t.data[e+1]+t.data[e+2])/3;t.data[e+3]=i<64?0:255}if($dt.putImageData(t,0,0),e){const[t,i,n]=function(t){const e=t.replace("#",""),i=parseInt(e,16);return[i>>16&255,i>>8&255,255&i]}(e),s=$dt.getImageData(0,0,Jdt.width,Jdt.height);for(let e=0;e<s.data.length;e+=4)s.data[e+3]>0&&(s.data[e]=t,s.data[e+1]=i,s.data[e+2]=n);$dt.putImageData(s,0,0)}const n=document.createElement("img");n.src=Jdt.toDataURL(),n.style.width="2em",n.style.height="2em",n.style.verticalAlign="middle",n.style.marginRight="5px",this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(n)}}}window.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("loading");function e(){var e;t.querySelector("#tip").innerHTML=(e=R)[Math.floor(Math.random()*e.length)]}const i=setInterval(()=>e(),5e3);e(),customElements.define("canv-icon",Qdt);let n=[];const s=Kdt();if(s.canvas||n.push("2D_CONTEXT_ERROR"),s.localStorage||n.push("LOCAL_STORAGE_NOT_FOUND"),s.webGL||n.push("WEBGL_CONTEXT_ERROR"),s.file||n.push("FILE_SYSTEM_ERROR"),n.length){const e=document.createElement("main");e.id="app",e.className="when-error",e.innerHTML=`\n      <main class="main">\n        <div class="header">\n          <h3>Aw man :(</h3>\n        </div>\n        <p>Your browser is not compatible with <span class="highlight">Hawk Engine</span>.</p>\n        <div class="try-footer">\n          <p>You can try:</p>                                                                        \n          <p>- <a href="/assets/wah.png">View a cute cat</a>.</p>\n        </div>\n        <br>\n        <small class="accent">${n.join(", ")}</small>\n      </main>\n    `,document.body.appendChild(e),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(i),t.remove()})}else await a.load(O,["assets/entities/bee.png","assets/fonts/at01.ttf","assets/game/props.png","assets/game/plants.png","assets/game/building.png","assets/game/terrain.png","assets/game/animated.png","assets/game/grass2.png","assets/game/grass.png","assets/game/dirt.png","assets/masks/lightMask.png","assets/masks/flame.png","assets/masks/candle_flame.png","assets/masks/water_foam.png","assets/masks/smoke.png","assets/masks/smoke_ramp.png","assets/masks/lightMask_o.png","assets/tilemap.png","assets/ui/main.png","assets/wah.png","styles/main.css","logo.png","logo.svg","banner.png",...Zdt],e=>{t.querySelector("#loading-bar-percentage-int").innerText=e.percentage+"%",t.querySelector("#loading-bar div").style.width=e.percentage+"%"}),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(i),t.remove()}),Gdt()});
