function t(t){const e=t.split(","),i=e[0],n=e[1],s=-1!==i.indexOf(";base64"),r=i.match(/data:([^;]+)/),a=r?r[1]:"application/octet-stream";let o;if(s){const t=atob(n),e=t.length,i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.charCodeAt(n);o=i}else{const t=decodeURIComponent(e[1]),i=t.length,n=new Uint8Array(i);for(let e=0;e<i;e++)n[e]=t.charCodeAt(e);o=n}return new Blob([o],{type:a})}class e{static#t=null;static#e={};static#i=null;static#n=[];static#s=null;static#r="app-cache";static#a=1;static#o="files";static#h="meta";static#l={html:"text/html",htm:"text/html",js:"application/javascript",mjs:"application/javascript",css:"text/css",json:"application/json",svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",txt:"text/plain",xml:"application/xml"};constructor(){if(e.#t)return e.#t;e.#t=this}static async#u(){return this.#s?this.#s:new Promise((t,e)=>{const i=indexedDB.open(this.#r,this.#a);i.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this.#o)||e.createObjectStore(this.#o,{keyPath:"path"}),e.objectStoreNames.contains(this.#h)||e.createObjectStore(this.#h,{keyPath:"key"})},i.onsuccess=()=>{this.#s=i.result,t(this.#s)},i.onerror=()=>e(i.error),i.onblocked=()=>{}})}static async#c(t,e,i={}){const n=await this.#u();return new Promise((s,r)=>{const a=n.transaction(this.#o,"readwrite").objectStore(this.#o),o={path:t,value:e,meta:i},h=a.put(o);h.onsuccess=()=>s(!0),h.onerror=()=>r(h.error)})}static async#d(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#o,"readonly").objectStore(this.#o).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#f(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction(this.#o,"readonly").objectStore(this.#o).getAll();n.onsuccess=()=>{const t=n.result||[],i={};for(const e of t)i[e.path]=e.value;e(i)},n.onerror=()=>i(n.error)})}static async#p(t,e){const i=await this.#u();return new Promise((n,s)=>{const r=i.transaction(this.#h,"readwrite").objectStore(this.#h).put({key:t,value:e});r.onsuccess=()=>n(!0),r.onerror=()=>s(r.error)})}static async#g(t){const e=await this.#u();return new Promise((i,n)=>{const s=e.transaction(this.#h,"readonly").objectStore(this.#h).get(t);s.onsuccess=()=>i(s.result?s.result.value:void 0),s.onerror=()=>n(s.error)})}static async#m(){const t=await this.#u();return new Promise((e,i)=>{const n=t.transaction([this.#o,this.#h],"readwrite");n.objectStore(this.#o).clear(),n.objectStore(this.#h).clear(),n.oncomplete=()=>e(!0),n.onerror=()=>i(n.error)})}static#v(t){const e=new Uint8Array(t);let i="";for(let t=0;t<e.length;t+=32768){const n=e.subarray(t,t+32768);i+=String.fromCharCode.apply(null,n)}return btoa(i)}static#y(t){if("string"!=typeof t)return!1;const e=t.replace(/\s+/g,"");return-1===e.indexOf("ï¿½")&&e.length%4==0&&/^[A-Za-z0-9+/]+={0,2}$/.test(e)}static async load(t,e=[],i=null){if(this.#i!==t){this.#e={},this.#n=[...e];try{await this.#u()}catch(n){return console.warn("IndexedDB unavailable, falling back to memory-only cache.",n),void await this.#x(t,e,!1,i)}if(await this.#g("version")===t)try{const n=await this.#f();let s=0;const r=e.length;for(const t of e)Object.prototype.hasOwnProperty.call(n,t)?this.#e[t]=n[t]:this.#e[t]=null,s++,i&&i({percentage:Math.round(s/r*100),file:s,totalFiles:r});return void(this.#i=t)}catch(n){return console.warn("Failed to read cache from DB, reloading from network.",n),void await this.#x(t,e,!0,i)}else await this.#x(t,e,!0,i)}}static async#x(t,e,i=!0,n=null){let s=0;const r=e.length,a=e.map(async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const n=await e.arrayBuffer();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB:",t,e)}}catch(e){try{const e=await fetch(t);if(!e.ok)throw new Error("fallback failed");const n=await e.text();if(this.#e[t]=n,i)try{await this.#c(t,n,{fetchedAt:Date.now()})}catch(e){console.warn("Failed to write file to DB (text):",t,e)}}catch(e){this.#e[t]=null}}finally{if(s++,n){const t=Math.round(s/r*100);n({percentage:t,file:s,totalFiles:r})}}});if(await Promise.all(a),i)try{await this.#p("version",t)}catch(t){console.warn("Failed to write version meta to DB",t)}this.#i=t}static get(t){return t in this.#e?this.#e[t]:null}static getBlob(i,n={returnBlob:!1}){const s=this.#e[i];if(null==s)return{dataUrl:null,blob:null};const r=(i.split(".").pop()||"").toLowerCase(),a=this.#l[r]||"application/octet-stream";if("string"==typeof s&&s.startsWith("data:")){const e=s;return{dataUrl:e,blob:n.returnBlob?t(e):null}}if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)){const t=s instanceof ArrayBuffer?s:s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength);return{dataUrl:`data:${a};base64,${e.#v(t)}`,blob:n.returnBlob?new Blob([t],{type:a}):null}}if("string"==typeof s){const i=s.trim(),r=i.startsWith('"')&&i.endsWith('"')||i.startsWith("'")&&i.endsWith("'")?i.slice(1,-1):i;if(r.startsWith("data:")){const e=r;return{dataUrl:e,blob:n.returnBlob?t(e):null}}const o=r.replace(/\s+/g,"");if(this.#y(o)){const e=`data:${a};base64,${o}`;return{dataUrl:e,blob:n.returnBlob?t(e):null}}const h=(new TextEncoder).encode(r);return{dataUrl:`data:${a};base64,${e.#v(h.buffer)}`,blob:n.returnBlob?new Blob([h],{type:a+";charset=utf-8"}):null}}const o=JSON.stringify(s),h=(new TextEncoder).encode(o);return{dataUrl:`data:application/json;charset=utf-8;base64,${e.#v(h.buffer)}`,blob:n.returnBlob?new Blob([h],{type:"application/json;charset=utf-8"}):null}}static async clear(){this.#e={},this.#i=null,this.#n=[];try{await this.#m()}catch(t){console.warn("Failed to clear IndexedDB",t)}}static getVersion(){return this.#i}static getFileList(){return[...this.#n]}}function i(t){return String(t||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function n(){return{username:localStorage.getItem("username"),password:localStorage.getItem("password")}}function s(t,e){return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})}function r(t){return fetch(t,{method:"GET"}).then(async t=>{const e=await t.text();try{return JSON.parse(e)}catch(t){return{error:"Invalid JSON response",raw:e}}})}function a(){return[{type:"image",key:"lightRadial",url:e.getBlob("assets/masks/lightMask.png").dataUrl},{type:"image",key:"wah",url:e.getBlob("assets/wah.png").dataUrl},{type:"image",key:"props",url:e.getBlob("assets/game/props.png").dataUrl},{type:"image",key:"plants",url:e.getBlob("assets/game/plants.png").dataUrl},{type:"image",key:"building",url:e.getBlob("assets/game/building.png").dataUrl},{type:"image",key:"animated",url:e.getBlob("assets/game/animated.png").dataUrl},{type:"image",key:"tilemap",url:e.getBlob("assets/tilemap.png").dataUrl},{type:"spritesheet",key:"grass2",url:e.getBlob("assets/game/grass2.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"dirt",url:e.getBlob("assets/game/dirt.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"spritesheet",key:"flame",url:e.getBlob("assets/masks/flame.png").dataUrl,frameConfig:{frameWidth:32,frameHeight:32}},{type:"bitmapfont",key:"hawkpixelated",url:{image:e.getBlob("assets/fonts/at02.png").dataUrl,xml:e.getBlob("assets/fonts/at02.xml").dataUrl}}]}function o(t,e){const i=t.load;for(const t of e){const{type:e,key:n,url:s}=t;"image"===e?i.image(n,s):"spritesheet"===e?i.spritesheet(n,s,t.frameConfig||{}):"audio"===e?i.audio(n,s):"json"===e?i.json(n,s):"bitmapfont"===e?i.bitmapFont(n,s.image,s.xml):i.file(n,{type:e||"image",url:s})}}function h(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(n.result),n.readAsDataURL(t)})}async function l(t){const e=new Image;return await new Promise((i,n)=>{e.onerror=()=>n(new Error("Could not load image")),e.onload=()=>i(e),e.src=t})}function u(t,e,i=128){const n=e.getContext("2d");n.clearRect(0,0,i,i);const s=t.width/t.height;let r=i,a=i;s>1?a=i/s:s<1&&(r=i*s);const o=Math.round((i-r)/2),h=Math.round((i-a)/2);n.drawImage(t,o,h,r,a)}async function c(t,e){const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await i.text().catch(()=>"");let s=null;try{s=n?JSON.parse(n):null}catch{}if(!i.ok){const t=s&&s.error||n||`HTTP ${i.status}`;throw new Error(t)}return s}async function d(t=t=>{}){window.turnstileId&&window.turnstile.remove(window.turnstileId);const e=await r("/api/game/turnstile");await new Promise(t=>{if(window.turnstile)return t();const e=setInterval(()=>{window.turnstile&&(clearInterval(e),t())},50)}),window.turnstileId=window.turnstile.render("#turnstile-container",{sitekey:e.key,callback:t,theme:"dark"})}const f="/api/friends/send",p="/api/auth/check",g="/api/auth/login",m="/api/pavatar",v="https://discord.gg/P8yrhaeCgy",y=[{name:"zt3xdv2",username:"tsumugi_dev",role:"Main Development"},{name:"Asura",username:"asurawhite1",role:"Domain gifter :3"},{name:"Alexxx",username:"alexonvscode",role:"Caddy (reverse proxy) provider"},{name:"Axillux",username:"axillux",role:"Assets (non-official)"},{name:"Cainos",username:"cainos",role:"Assets (non-official)"}],x=["You can change your in-game avatar in profile page","You can change your username in profile page"],w="0.1.2-release";class b{static queue=[];static isShowing=!1;static add(t,e,i){this.queue.push({title:t,html:e,callback:i}),this.showNext()}static showNext(){if(this.isShowing||0===this.queue.length)return;const t=this.queue.shift();this.isShowing=!0;const e=document.createElement("div");e.className="alert",e.innerHTML=`\n            <h3 class="title">${t.title}</h3>\n            <div class="content">${t.html}</div>\n            <button class="btn close-btn">Accept</button>\n        `,document.body.appendChild(e),e.querySelector(".close-btn").addEventListener("click",()=>{t.callback?t.callback():this.closeAlert(e)})}static closeAlert(t){t.classList.add("fade-out"),t.addEventListener("transitionend",()=>{t.remove(),this.isShowing=!1,this.showNext()})}}const T=`\n<div class="auth">\n  <div id="welcome-screen" style="min-height:400px;display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity 0.6s ease">\n    <div style="text-align:center;font-size:28px;font-weight:600;color:#e5e5e5;letter-spacing:-0.5px;display:flex;gap:10px">\n      <span class="word-anim" style="opacity:0;transform:translateY(30px)">Welcome</span>\n      <span class="word-anim" style="opacity:0;transform:translateY(30px)">to</span>\n      <span class="word-anim" style="opacity:0;transform:translateY(30px)">Hawk</span>\n    </div>\n  </div>\n  <div id="auth-container" style="opacity:0;display:none;transition:opacity 0.6s ease">\n    <div class="header">\n      <h3><canv-icon id="auth-icon" src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon><span id="auth-title">Login</span></h3>\n      <span id="auth-description" class="description">Log in into Hawk.</span>\n    </div>\n    <hr>\n    <div id="oauth-buttons" style="display:none;margin-bottom:16px"></div>\n    <div id="oauth-divider" style="display:none;text-align:center;margin:16px 0;color:var(--muted);font-size:13px;position:relative">\n      <span style="background:var(--background-color);padding:0 12px;position:relative;z-index:1">OR</span>\n      <hr style="position:absolute;top:50%;left:0;right:0;margin:0;z-index:0">\n    </div>\n    <form id="authForm" class="gap">\n      <input type="text" id="display_name" placeholder="Display Name" style="display:none;width:100%;padding:12px 14px;background:var(--surface-color);border:1px solid var(--border-color);border-radius:8px;color:var(--text-color);font-size:14px;transition:all 0.2s">\n      <input type="text" id="username" placeholder="Username" required style="width:100%;padding:12px 14px;background:var(--surface-color);border:1px solid var(--border-color);border-radius:8px;color:var(--text-color);font-size:14px;transition:all 0.2s">\n      <input type="password" id="password" placeholder="Password" required style="width:100%;padding:12px 14px;background:var(--surface-color);border:1px solid var(--border-color);border-radius:8px;color:var(--text-color);font-size:14px;transition:all 0.2s">\n      <div id="turnstile-container"></div>\n      <button class="btn" type="submit" id="auth-submit" style="width:100%;padding:12px;background:var(--primary-color);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s;margin-top:8px">\n        <div id="auth-button" style="display:flex;align-items:center;justify-content:center;gap:8px">\n          <div class="btn-text" id="btn-text">Login</div>\n          <div class="btn-spinner" style="display:none;align-items:center;gap:8px">Loading... <span class="loader"></span></div>\n        </div>\n      </button>\n      <small class="accent" style="display:block;text-align:center;margin-top:12px">By <span id="auth-action-text">logging in</span> you accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n    </form>\n    <hr>\n    <p id="auth-switch" style="text-align:center;color:var(--muted);font-size:14px"><span id="switch-text">New here?</span> <a href="#" id="toggle-mode" style="color:var(--primary-color);font-weight:500">Register</a></p>\n  </div>\n</div>\n<style>\n  @keyframes slideUpWord {\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n  @keyframes slideInUp {\n    from {\n      opacity: 0;\n      transform: translateY(30px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n  .auth-slide-in {\n    animation: slideInUp 0.6s ease-out forwards;\n  }\n  input:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    background: var(--surface-hover);\n  }\n  button:hover {\n    background: var(--primary-hover);\n  }\n  .oauth-btn {\n    width: 100%;\n    padding: 12px;\n    border: 1px solid var(--border-color);\n    border-radius: 8px;\n    background: var(--surface-color);\n    color: var(--text-color);\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 10px;\n  }\n  .oauth-btn:hover {\n    background: var(--surface-hover);\n    border-color: var(--primary-color);\n  }\n  .oauth-btn svg {\n    width: 18px;\n    height: 18px;\n  }\n</style>\n`;var E,S,_,C,A,M,P,R,L,O,F,k,D,I,B,N,z,U,Y,X,G,H,W,V,j,q,K,Z,$,J,Q,tt,et,it,nt,st,rt,at,ot,ht,lt,ut,ct,dt,ft,pt,gt,mt,vt,yt,xt,wt,bt,Tt,Et,St,_t,Ct,At,Mt,Pt,Rt,Lt,Ot,Ft,kt,Dt,It,Bt,Nt,zt,Ut,Yt,Xt,Gt,Ht,Wt,Vt,jt,qt,Kt,Zt,$t,Jt,Qt,te,ee,ie,ne,se,re,ae,oe,he,le,ue,ce,de,fe,pe,ge,me,ve,ye,xe,we,be,Te,Ee,Se,_e,Ce,Ae,Me,Pe,Re,Le,Oe,Fe,ke,De,Ie,Be,Ne,ze,Ue,Ye,Xe,Ge,He,We,Ve,je,qe,Ke,Ze,$e,Je,Qe,ti,ei,ii,ni,si,ri,ai,oi,hi,li,ui,ci,di,fi,pi,gi,mi,vi,yi,xi,wi,bi,Ti,Ei,Si,_i,Ci,Ai,Mi,Pi,Ri,Li,Oi,Fi,ki,Di,Ii,Bi,Ni,zi,Ui,Yi,Xi,Gi,Hi,Wi,Vi,ji,qi,Ki,Zi,$i,Ji,Qi,tn,en,nn,sn,rn,an,on,hn,ln,un,cn,dn,fn,pn,gn,mn,vn,yn,xn,wn,bn,Tn,En,Sn,_n,Cn,An,Mn,Pn,Rn,Ln,On,Fn,kn,Dn,In,Bn,Nn,zn,Un,Yn,Xn,Gn,Hn,Wn,Vn,jn,qn,Kn,Zn,$n,Jn,Qn,ts,es,is,ns,ss,rs,as,os,hs,ls,us,cs,ds,fs,ps,gs,ms,vs,ys,xs,ws,bs,Ts,Es,Ss,_s,Cs,As,Ms,Ps,Rs,Ls,Os,Fs,ks,Ds,Is,Bs,Ns,zs,Us,Ys,Xs,Gs,Hs,Ws,Vs,js,qs,Ks,Zs,$s,Js,Qs,tr,er,ir,nr,sr,rr,ar,or,hr,lr,ur,cr,dr,fr,pr,gr,mr,vr,yr,xr,wr,br,Tr,Er,Sr,_r,Cr,Ar,Mr,Pr,Rr,Lr,Or,Fr,kr,Dr,Ir,Br,Nr,zr,Ur,Yr,Xr,Gr,Hr,Wr,Vr,jr,qr,Kr,Zr,$r,Jr,Qr,ta,ea,ia,na,sa,ra,aa,oa,ha,la,ua,ca,da,fa,pa,ga,ma,va,ya,xa,wa,ba,Ta,Ea,Sa,_a,Ca,Aa,Ma,Pa,Ra,La,Oa,Fa,ka,Da,Ia,Ba,Na,za,Ua,Ya,Xa,Ga,Ha,Wa,Va,ja,qa,Ka,Za,$a,Ja,Qa,to,eo,io,no,so,ro,ao,oo,ho,lo,uo,co,fo,po,go,mo,vo,yo,xo,wo,bo,To,Eo,So,_o,Co,Ao,Mo,Po,Ro,Lo,Oo,Fo,ko,Do,Io,Bo,No,zo,Uo=Object.freeze({__proto__:null,options:{title:"Auth",auth:!1,description:"Choose your authentication method."},html:T,render:function(){document.getElementById("app").innerHTML=T;const t=document.getElementById("welcome-screen"),i=document.getElementById("auth-container");document.querySelectorAll(".word-anim").forEach((t,e)=>{setTimeout(()=>{t.style.animation="slideUpWord 0.4s ease-out forwards"},150*e)}),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.style.display="none",i.style.display="block",i.classList.add("auth-slide-in"),setTimeout(()=>{i.style.opacity="1"},50)},600)},1500),async function(){try{const t=await fetch("/api/oauth/status"),e=await t.json(),i=document.getElementById("oauth-buttons"),n=document.getElementById("oauth-divider");let s=!1;if(e.google||e.discord){s=!0;let t='<div class="gap" style="display:flex;flex-direction:column;gap:10px">';e.google&&(t+='\n            <button type="button" class="oauth-btn" onclick="window.location.href=\'/api/auth/google\'">\n              <svg viewBox="0 0 24 24" fill="currentColor">\n                <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>\n                <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>\n                <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>\n                <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>\n              </svg>\n              Continue with Google\n            </button>\n          '),e.discord&&(t+='\n            <button type="button" class="oauth-btn" onclick="window.location.href=\'/api/auth/discord\'">\n              <svg viewBox="0 0 24 24" fill="#5865F2">\n                <path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"/>\n              </svg>\n              Continue with Discord\n            </button>\n          '),t+="</div>",i.innerHTML=t,i.style.display="block",n.style.display="block"}}catch(t){console.error("Error checking OAuth status:",t)}}();const n=new URLSearchParams(window.location.search);if("success"===n.get("oauth")){const t=n.get("username"),e=n.get("token");t&&e&&(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",t),localStorage.setItem("password",e),window.location="/dashboard")}else if(n.get("error")){const t=n.get("error"),e={google_auth_failed:"Google authentication failed. Please try again.",discord_auth_failed:"Discord authentication failed. Please try again."};b.add("OAuth Error",e[t]||"Authentication failed.")}let r=!0;const a=document.getElementById("display_name"),o=document.getElementById("auth-title"),h=document.getElementById("auth-description"),l=document.getElementById("auth-icon"),u=document.getElementById("btn-text"),c=document.getElementById("auth-action-text"),f=document.getElementById("switch-text"),p=document.getElementById("toggle-mode"),m=document.getElementById("authForm"),v=document.querySelector(".btn-spinner");function y(t){t?(u.style.display="none",v.style.display="flex"):(u.style.display="block",v.style.display="none")}function x(t){t&&t.preventDefault(),r=!r,r?(o.textContent="Login",h.textContent="Log in into Hawk.",l.setAttribute("src",e.getBlob("assets/icons/Person.png").dataUrl),u.textContent="Login",c.textContent="logging in",f.textContent="New here?",p.textContent="Register",a.style.display="none",a.removeAttribute("required")):(o.textContent="Register",h.textContent="Create a new account.",l.setAttribute("src",e.getBlob("assets/icons/unbanmember.png").dataUrl),u.textContent="Register",c.textContent="creating a account your",f.textContent="Already have a account?",p.textContent="Login",a.style.display="block",a.setAttribute("required","required")),m.reset(),window.turnstile&&window.turnstile.reset()}function w(t,e){switch(t){case"display_name":return e.length>=3&&e.length<=32;case"username":{const t=e.length>=3&&e.length<=16,i=/^[A-Za-z0-9_]+$/.test(e);return t&&i}case"password":return e.length>=8&&e.length<=16;default:return!1}}function E(t){switch(t){case"display_name":return"Display name must be between 3 and 32 characters.";case"username":return"Username must be between 3 and 16 characters and contain only letters, numbers and underscores (a-zA-Z0-9_).";case"password":return"Password must be between 8 and 16 characters.";default:return"Invalid field."}}p.addEventListener("click",x),d(t=>{window.turnstileToken=t}),m.addEventListener("submit",async t=>{t.preventDefault(),y(!0);const e=t.target.username.value.trim(),i=t.target.password.value;if(r)try{const t=await s(g,{username:e,password:i,turnstile:window.turnstileToken});t.error?(y(!1),b.add("Login error",t.error)):(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",t.username),localStorage.setItem("password",t.password),window.location="/dashboard")}catch(t){y(!1),b.add("Network error",t.message)}else{const n=t.target.display_name.value.trim();if(!window.turnstileToken)return y(!1),void b.add("Validation error","Please complete captcha");if(!w("display_name",n))return y(!1),void b.add("Validation error",E("display_name"));if(!w("username",e))return y(!1),void b.add("Validation error",E("username"));if(!w("password",i))return y(!1),void b.add("Validation error",E("password"));try{const t=await s("/api/auth/register",{display_name:n,username:e,password:i,turnstile:window.turnstileToken});if(t.error)y(!1),b.add("Register error",t.error||"Unknown error.<br>This maybe is a mistake, please contact an administrator.");else try{const t=await s(g,{username:e,password:i,turnstile:window.turnstileToken});t.error?(y(!1),b.add("Registered","Successfully registered! Please login."),setTimeout(()=>{x()},1500)):(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",t.username),localStorage.setItem("password",t.password),window.location="/dashboard")}catch(t){y(!1),b.add("Registered","Successfully registered! Please login."),setTimeout(()=>{x()},1500)}}catch(t){y(!1),b.add("Network error",t.message)}}})}}),Yo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Xo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Go(){return _?S:(_=1,S={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27})}function Ho(){return A?C:(A=1,C={DEFAULT:0,LINEAR:0,NEAREST:1})}function Wo(){if(P)return M;P=1;var t={VERSION:"3.90.0",LOG_VERSION:"v390",BlendModes:Go(),ScaleModes:Ho(),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};return M=t}function Vo(){return L?R:(L=1,R=function(t){if(!t||"object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0})}function jo(){if(F)return O;F=1;var t=Vo(),e=function(){var i,n,s,r,a,o,h=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof h&&(c=h,h=arguments[1]||{},l=2),u===l&&(h=this,--l);l<u;l++)if(null!=(i=arguments[l]))for(n in i)s=h[n],h!==(r=i[n])&&(c&&r&&(t(r)||(a=Array.isArray(r)))?(a?(a=!1,o=s&&Array.isArray(s)?s:[]):o=s&&t(s)?s:{},h[n]=e(c,o,r)):void 0!==r&&(h[n]=r));return h};return O=e}function qo(){return D?k:(D=1,k={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12})}function Ko(){return B?I:(B=1,I=function(t){return t.y+t.height-t.height*t.originY})}function Zo(){return z?N:(z=1,N=function(t){return t.x-t.width*t.originX+.5*t.width})}function $o(){return Y?U:(Y=1,U=function(t,e){var i=t.width*t.originX;return t.x=e+i-.5*t.width,t})}function Jo(){return G?X:(G=1,X=function(t,e){return t.y=e+t.height*t.originY,t})}function Qo(){if(W)return H;W=1;var t=Ko(),e=Zo(),i=$o(),n=Jo();return H=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function th(){return j?V:(j=1,V=function(t){return t.x-t.width*t.originX})}function eh(){return K?q:(K=1,q=function(t,e){return t.x=e+t.width*t.originX,t})}function ih(){if($)return Z;$=1;var t=Ko(),e=th(),i=eh(),n=Jo();return Z=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)-a),n(s,t(r)+o),s}}function nh(){return Q?J:(Q=1,J=function(t){return t.x+t.width-t.width*t.originX})}function sh(){return et?tt:(et=1,tt=function(t,e){return t.x=e-t.width+t.width*t.originX,t})}function rh(){if(nt)return it;nt=1;var t=Ko(),e=nh(),i=sh(),n=Jo();return it=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,e(r)+a),n(s,t(r)+o),s}}function ah(){return rt?st:(rt=1,st=function(t,e){return t.y=e-t.height+t.height*t.originY,t})}function oh(){if(ot)return at;ot=1;var t=Ko(),e=th(),i=ah(),n=sh();return at=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function hh(){return lt?ht:(lt=1,ht=function(t){return t.y-t.height*t.originY+.5*t.height})}function lh(){return ct?ut:(ct=1,ut=function(t,e){var i=t.height*t.originY;return t.y=e+i-.5*t.height,t})}function uh(){if(ft)return dt;ft=1;var t=hh(),e=th(),i=lh(),n=sh();return dt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function ch(){return gt?pt:(gt=1,pt=function(t){return t.y-t.height*t.originY})}function dh(){if(vt)return mt;vt=1;var t=th(),e=ch(),i=sh(),n=Jo();return mt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function fh(){if(xt)return yt;xt=1;var t=Ko(),e=nh(),i=ah(),n=eh();return yt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function ph(){if(bt)return wt;bt=1;var t=hh(),e=nh(),i=lh(),n=eh();return wt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function gh(){if(Et)return Tt;Et=1;var t=nh(),e=ch(),i=eh(),n=Jo();return Tt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function mh(){if(_t)return St;_t=1;var t=Zo(),e=ch(),i=ah(),n=$o();return St=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function vh(){if(At)return Ct;At=1;var t=th(),e=ch(),i=ah(),n=eh();return Ct=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)-a),i(s,e(r)-o),s}}function yh(){if(Pt)return Mt;Pt=1;var t=nh(),e=ch(),i=ah(),n=sh();return Mt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,t(r)+a),i(s,e(r)-o),s}}function xh(){if(Lt)return Rt;Lt=1;var t=qo(),e=[];return e[t.BOTTOM_CENTER]=Qo(),e[t.BOTTOM_LEFT]=ih(),e[t.BOTTOM_RIGHT]=rh(),e[t.LEFT_BOTTOM]=oh(),e[t.LEFT_CENTER]=uh(),e[t.LEFT_TOP]=dh(),e[t.RIGHT_BOTTOM]=fh(),e[t.RIGHT_CENTER]=ph(),e[t.RIGHT_TOP]=gh(),e[t.TOP_CENTER]=mh(),e[t.TOP_LEFT]=vh(),e[t.TOP_RIGHT]=yh(),Rt=function(t,i,n,s,r){return e[n](t,i,s,r)},Rt}function wh(){if(Ft)return Ot;Ft=1;var t=xh();return Ot=function(e,i,n,s){for(var r=e[0],a=1;a<e.length;a++){var o=e[a];t(o,r,i,n,s),r=o}return e},Ot}function bh(){return Dt?kt:(Dt=1,kt=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]+=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]+=i+o*n,o++;return t})}function Th(){if(Bt)return It;Bt=1;var t=bh();return It=function(e,i,n,s,r){return t(e,"angle",i,n,s,r)}}function Eh(){if(Wt)return Ht;Wt=1;var t=Ko(),e=Zo(),i=ah(),n=$o();return Ht=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Sh(){if(jt)return Vt;jt=1;var t=Ko(),e=th(),i=ah(),n=eh();return Vt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function _h(){if(Kt)return qt;Kt=1;var t=Ko(),e=nh(),i=ah(),n=sh();return qt=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Ch(){if($t)return Zt;$t=1;var t=$o(),e=lh();return Zt=function(i,n,s){return t(i,n),e(i,s)}}function Ah(){if(Qt)return Jt;Qt=1;var t=Ch(),e=Zo(),i=hh();return Jt=function(n,s,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t(n,e(s)+r,i(s)+a),n}}function Mh(){if(ee)return te;ee=1;var t=hh(),e=th(),i=lh(),n=eh();return te=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)-a),i(s,t(r)+o),s}}function Ph(){if(ne)return ie;ne=1;var t=hh(),e=nh(),i=lh(),n=sh();return ie=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),n(s,e(r)+a),i(s,t(r)+o),s}}function Rh(){if(re)return se;re=1;var t=Zo(),e=ch(),i=$o(),n=Jo();return se=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Lh(){if(oe)return ae;oe=1;var t=th(),e=ch(),i=eh(),n=Jo();return ae=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)-a),n(s,e(r)-o),s}}function Oh(){if(le)return he;le=1;var t=nh(),e=ch(),i=sh(),n=Jo();return he=function(s,r,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),i(s,t(r)+a),n(s,e(r)-o),s}}function Fh(){if(ce)return ue;ce=1;var t=qo(),e=[];return e[t.BOTTOM_CENTER]=Eh(),e[t.BOTTOM_LEFT]=Sh(),e[t.BOTTOM_RIGHT]=_h(),e[t.CENTER]=Ah(),e[t.LEFT_CENTER]=Mh(),e[t.RIGHT_CENTER]=Ph(),e[t.TOP_CENTER]=Rh(),e[t.TOP_LEFT]=Lh(),e[t.TOP_RIGHT]=Oh(),e[t.LEFT_BOTTOM]=e[t.BOTTOM_LEFT],e[t.LEFT_TOP]=e[t.TOP_LEFT],e[t.RIGHT_BOTTOM]=e[t.BOTTOM_RIGHT],e[t.RIGHT_TOP]=e[t.TOP_RIGHT],ue=function(t,i,n,s,r){return e[n](t,i,s,r)},ue}function kh(){return fe?de:(fe=1,de=function(t,e,i){var n=typeof t;return t&&"number"!==n&&"string"!==n&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:i})}function Dh(){return ge?pe:(ge=1,pe=function(){})}function Ih(){if(ve)return me;function t(t,e,i){var n=i?t[e]:Object.getOwnPropertyDescriptor(t,e);return!i&&n.value&&"object"==typeof n.value&&(n=n.value),!(!n||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(n))&&(void 0===n.enumerable&&(n.enumerable=!0),void 0===n.configurable&&(n.configurable=!0),n)}function e(t,e){var i=Object.getOwnPropertyDescriptor(t,e);return!!i&&(i.value&&"object"==typeof i.value&&(i=i.value),!1===i.configurable)}function i(i,n,r,a){for(var o in n)if(n.hasOwnProperty(o)){var h=t(n,o,r);if(!1!==h){if(e((a||i).prototype,o)){if(s.ignoreFinals)continue;throw new Error("cannot override final property '"+o+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(i.prototype,o,h)}else i.prototype[o]=n[o]}}function n(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)i(t,e[n].prototype||e[n])}}function s(t){var e,s;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var r=t.Extends;e=function(){r.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,s=t.Extends,delete t.Extends):e.prototype.constructor=e;var a=null;return t.Mixins&&(a=t.Mixins,delete t.Mixins),n(e,a),i(e,t,!0,s),e}return ve=1,s.extend=i,s.mixin=n,s.ignoreFinals=!1,me=s}function Bh(){return xe||(xe=1,ye=function(t,e,i){return t.radius>0&&e>=t.left&&e<=t.right&&i>=t.top&&i<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-i)*(t.y-i)<=t.radius*t.radius}),ye}function Nh(){return be?we:(be=1,we={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6})}function zh(){if(Ee)return Te;Ee=1;var t=Ih(),e=Nh(),i=new t({initialize:function(t,i){void 0===t&&(t=0),void 0===i&&(i=t),this.type=e.POINT,this.x=t,this.y=i},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});return Te=i}function Uh(){if(_e)return Se;_e=1;var t=zh();return Se=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x+e.radius*Math.cos(i),n.y=e.y+e.radius*Math.sin(i),n},Se}function Yh(){return Ae?Ce:(Ae=1,Ce=function(t,e,i){return Math.max(e,Math.min(i,t))})}function Xh(){if(Pe)return Me;Pe=1;var t=Yh();return Me=function(e,i,n){return(n-i)*(e=t(e,0,1))+i}}function Gh(){if(Le)return Re;Le=1;var t={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};return Re=t}function Hh(){if(Fe)return Oe;Fe=1;var t=Uh(),e=Xh(),i=Gh(),n=zh();return Oe=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},Oe}function Wh(){return De||(De=1,ke=function(t){return Math.PI*t.radius*2}),ke}function Vh(){if(Be)return Ie;Be=1;var t=Wh(),e=Uh(),i=Xh(),n=Gh();return Ie=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},Ie}function jh(){if(ze)return Ne;ze=1;var t=zh();return Ne=function(e,i){void 0===i&&(i=new t);var n=2*Math.PI*Math.random(),s=Math.random()+Math.random(),r=s>1?2-s:s,a=r*Math.cos(n),o=r*Math.sin(n);return i.x=e.x+a*e.radius,i.y=e.y+o*e.radius,i},Ne}function qh(){if(Ye)return Ue;Ye=1;var t=Ih(),e=Bh(),i=Hh(),n=Vh(),s=Nh(),r=jh(),a=new t({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.type=s.CIRCLE,this.x=t,this.y=e,this._radius=i,this._diameter=2*i},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i){return this.x=t,this.y=e,this._radius=i,this._diameter=2*i,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});return Ue=a}function Kh(){if(Ge)return Xe;Ge=1;var t=Yh();return Xe={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(e,i,n,s){return void 0===e&&(e=1),void 0===i?this.alpha=e:(this._alphaTL=t(e,0,1),this._alphaTR=t(i,0,1),this._alphaBL=t(n,0,1),this._alphaBR=t(s,0,1)),this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,this._alphaTL=i,this._alphaTR=i,this._alphaBL=i,this._alphaBR=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(e){var i=t(e,0,1);this._alphaTL=i,0!==i&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(e){var i=t(e,0,1);this._alphaTR=i,0!==i&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(e){var i=t(e,0,1);this._alphaBL=i,0!==i&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(e){var i=t(e,0,1);this._alphaBR=i,0!==i&&(this.renderFlags|=2)}}}}function Zh(){if(We)return He;We=1;var t=Yh();return He={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t){return void 0===t&&(t=1),this.alpha=t,this},alpha:{get:function(){return this._alpha},set:function(e){var i=t(e,0,1);this._alpha=i,0===i?this.renderFlags&=-3:this.renderFlags|=2}}}}function $h(){if(je)return Ve;je=1;var t=Go(),e={_blendMode:t.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(e){"string"==typeof e&&(e=t[e]),(e|=0)>=-1&&(this._blendMode=e)}},setBlendMode:function(t){return this.blendMode=t,this}};return Ve=e}function Jh(){return Qe||(Qe=1,Je=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))return!1;for(var e=t[0].length,i=1;i<t.length;i++)if(t[i].length!==e)return!1;return!0}),Je}function Qh(){return ei?ti:(ei=1,ti=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=" "),void 0===n&&(n=3);var s=0;if(e+1>=(t=t.toString()).length)switch(n){case 1:t=new Array(e+1-t.length).join(i)+t;break;case 3:var r=Math.ceil((s=e-t.length)/2);t=new Array(s-r+1).join(i)+t+new Array(r+1).join(i);break;default:t+=new Array(e+1-t.length).join(i)}return t})}function tl(){if(ni)return ii;ni=1;var t=Qh(),e=Jh();return ii=function(i){var n="";if(!e(i))return n;for(var s=0;s<i.length;s++){for(var r=0;r<i[s].length;r++){var a=i[s][r].toString();n+="undefined"!==a?t(a,2):"?",r<i[s].length-1&&(n+=" |")}if(s<i.length-1){n+="\n";for(var o=0;o<i[s].length;o++)n+="---",o<i[s].length-1&&(n+="+");n+="\n"}}return n},ii}function el(){return li||(li=1,hi=function(t){for(var e=t.length,i=t[0].length,n=new Array(i),s=0;s<i;s++){n[s]=new Array(e);for(var r=e-1;r>-1;r--)n[s][r]=t[r][s]}return n}),hi}function il(){if(ci)return ui;ci=1;var t=Jh(),e=el();return ui=function(i,n){if(void 0===n&&(n=90),!t(i))return null;if("string"!=typeof n&&(n=(n%360+360)%360),90===n||-270===n||"rotateLeft"===n)(i=e(i)).reverse();else if(-90===n||270===n||"rotateRight"===n)i.reverse(),i=e(i);else if(180===Math.abs(n)||"rotate180"===n){for(var s=0;s<i.length;s++)i[s].reverse();i.reverse()}return i},ui}function nl(){if(fi)return di;fi=1;var t=il();return di=function(e){return t(e,180)},di}function sl(){if(gi)return pi;gi=1;var t=il();return pi=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,90);return e},pi}function rl(){if(vi)return mi;vi=1;var t=il();return mi=function(e,i){void 0===i&&(i=1);for(var n=0;n<i;n++)e=t(e,-90);return e},mi}function al(){return xi||(xi=1,yi=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.shift(),t.push(i);return i}),yi}function ol(){return bi||(bi=1,wi=function(t,e){void 0===e&&(e=1);for(var i=null,n=0;n<e;n++)i=t.pop(),t.unshift(i);return i}),wi}function hl(){if(Ei)return Ti;Ei=1;var t=al(),e=ol();return Ti=function(i,n,s){if(void 0===n&&(n=0),void 0===s&&(s=0),0!==s&&(s<0?t(i,Math.abs(s)):e(i,s)),0!==n)for(var r=0;r<i.length;r++){var a=i[r];n<0?t(a,Math.abs(n)):e(a,n)}return i},Ti}function ll(){return Fi||(Fi=1,Oi=function(t,e,i,n){var s=t.length;if(e<0||e>=s||e>=i||i>s){if(n)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}),Oi}function ul(){if(Di)return ki;Di=1;var t=ll();return ki=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=0;if(t(e,s,r))for(var o=s;o<r;o++)e[o][i]===n&&a++;return a},ki}function cl(){return Bi||(Bi=1,Ii=function(t,e,i){var n,s=[null];for(n=3;n<arguments.length;n++)s.push(arguments[n]);for(n=0;n<t.length;n++)s[0]=t[n],e.apply(i,s);return t}),Ii}function dl(){if(zi)return Ni;zi=1;var t=ll();return Ni=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r)){var a,o=[null];for(a=5;a<arguments.length;a++)o.push(arguments[a]);for(a=s;a<r;a++)o[0]=e[a],i.apply(n,o)}return e},Ni}function fl(){return Yi||(Yi=1,Ui=function(t,e,i){if(!e.length)return NaN;if(1===e.length)return e[0];var n,s,r=1;if(i){if(t<e[0][i])return e[0];for(;e[r][i]<t;)r++}else for(;e[r]<t;)r++;return r>e.length&&(r=e.length),i?(n=e[r-1][i],(s=e[r][i])-t<=t-n?e[r]:e[r-1]):(n=e[r-1],(s=e[r])-t<=t-n?s:n)}),Ui}function pl(){if(Gi)return Xi;Gi=1;var t=function(e,i){void 0===i&&(i=[]);for(var n=0;n<e.length;n++)Array.isArray(e[n])?t(e[n],i):i.push(e[n]);return i};return Xi=t}function gl(){if(Wi)return Hi;Wi=1;var t=ll();return Hi=function(e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r=e.length);var a=[];if(t(e,s,r))for(var o=s;o<r;o++){var h=e[o];(!i||i&&void 0===n&&h.hasOwnProperty(i)||i&&void 0!==n&&h[i]===n)&&a.push(h)}return a},Hi}function ml(){if(ji)return Vi;ji=1;var t=ll();return Vi=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),-1!==s){if(t(e,s,r))for(var a=s;a<r;a++){var o=e[a];if(!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o}}else if(t(e,0,r))for(a=r;a>=0;a--)if(o=e[a],!i||i&&void 0===n&&o.hasOwnProperty(i)||i&&void 0!==n&&o[i]===n)return o;return null},Vi}function vl(){return Ki||(Ki=1,qi=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length);var n=e+Math.floor(Math.random()*i);return void 0===t[n]?null:t[n]}),qi}function yl(){return hn?on:(hn=1,on=function(t,e,i,n){var s,r=[],a=!1;if((i||n)&&(a=!0,i||(i=""),n||(n="")),e<t)for(s=t;s>=e;s--)a?r.push(i+s.toString()+n):r.push(s);else for(s=t;s<=e;s++)a?r.push(i+s.toString()+n):r.push(s);return r})}function xl(){return un?ln:(un=1,ln=function(t){return t>0?Math.ceil(t):Math.floor(t)})}function wl(){if(dn)return cn;dn=1;var t=xl();return cn=function(e,i,n){void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=1),null===i&&(i=e,e=0);for(var s=[],r=Math.max(t((i-e)/(n||1)),0),a=0;a<r;a++)s.push(e),e+=n;return s}}function bl(){if(pn)return fn;function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}pn=1;var i=function(n,s,r,a,o){for(void 0===r&&(r=0),void 0===a&&(a=n.length-1),void 0===o&&(o=e);a>r;){if(a-r>600){var h=a-r+1,l=s-r+1,u=Math.log(h),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(h-c)/h)*(l-h/2<0?-1:1),f=Math.max(r,Math.floor(s-l*c/h+d)),p=Math.min(a,Math.floor(s+(h-l)*c/h+d));i(n,s,f,p,o)}var g=n[s],m=r,v=a;for(t(n,r,s),o(n[a],g)>0&&t(n,r,a);m<v;){for(t(n,m,v),m++,v--;o(n[m],g)<0;)m++;for(;o(n[v],g)>0;)v--}0===o(n[r],g)?t(n,r,v):t(n,++v,a),v<=s&&(r=v+1),s<=v&&(a=v-1)}};return fn=i}function Tl(){return mn?gn:(mn=1,gn=function(t,e,i,n){if(!t&&!n||"number"==typeof t)return i;if(t&&t.hasOwnProperty(e))return t[e];if(n&&n.hasOwnProperty(e))return n[e];if(-1!==e.indexOf(".")){for(var s=e.split("."),r=t,a=n,o=i,h=i,l=!0,u=!0,c=0;c<s.length;c++)r&&r.hasOwnProperty(s[c])?(o=r[s[c]],r=r[s[c]]):l=!1,a&&a.hasOwnProperty(s[c])?(h=a[s[c]],a=a[s[c]]):u=!1;return l?o:u?h:i}return i})}function El(){return yn||(yn=1,vn=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t}),vn}function Sl(){if(wn)return xn;wn=1;var t=Tl(),e=El(),i=function(t,e,i){for(var n=[],s=0;s<t.length;s++)for(var r=0;r<e.length;r++)for(var a=0;a<i;a++)n.push({a:t[s],b:e[r]});return n};return xn=function(n,s,r){var a=t(r,"max",0),o=t(r,"qty",1),h=t(r,"random",!1),l=t(r,"randomB",!1),u=t(r,"repeat",0),c=t(r,"yoyo",!1),d=[];if(l&&e(s),-1===u)if(0===a)u=0;else{var f=n.length*s.length*o;c&&(f*=2),u=Math.ceil(a/f)}for(var p=0;p<=u;p++){var g=i(n,s,o);h&&e(g),d=d.concat(g),c&&(g.reverse(),d=d.concat(g))}return a&&d.splice(a),d}}function _l(){return Tn||(Tn=1,bn=function(t,e){if(!(e>=t.length)){for(var i=t.length-1,n=t[e],s=e;s<i;s++)t[s]=t[s+1];return t.length=i,n}}),bn}function Cl(){if(Sn)return En;Sn=1;var t=_l();return En=function(e,i,n,s){var r;if(void 0===s&&(s=e),!Array.isArray(i))return-1!==(r=e.indexOf(i))?(t(e,r),n&&n.call(s,i),i):null;for(var a=i.length-1,o=[];a>=0;){var h=i[a];-1!==(r=e.indexOf(h))&&(t(e,r),o.push(h),n&&n.call(s,h)),a--}return o},En}function Al(){if(Cn)return _n;Cn=1;var t=_l();return _n=function(e,i,n,s){if(void 0===s&&(s=e),i<0||i>e.length-1)throw new Error("Index out of bounds");var r=t(e,i);return n&&n.call(s,r),r},_n}function Ml(){if(Mn)return An;Mn=1;var t=ll();return An=function(e,i,n,s,r){if(void 0===i&&(i=0),void 0===n&&(n=e.length),void 0===r&&(r=e),t(e,i,n)){var a=n-i,o=e.splice(i,a);if(s)for(var h=0;h<o.length;h++){var l=o[h];s.call(r,l)}return o}return[]},An}function Pl(){if(Rn)return Pn;Rn=1;var t=_l();return Pn=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);var s=i+Math.floor(Math.random()*n);return t(e,s)},Pn}function Rl(){if(In)return Dn;In=1;var t=ll();return Dn=function(e,i,n,s,r){if(void 0===s&&(s=0),void 0===r&&(r=e.length),t(e,s,r))for(var a=s;a<r;a++){var o=e[a];o.hasOwnProperty(i)&&(o[i]=n)}return e},Dn}function Ll(){return Nn||(Nn=1,Bn=function(t){var e=/\D/g;return t.sort(function(t,i){return parseInt(t.replace(e,""),10)-parseInt(i.replace(e,""),10)}),t}),Bn}function Ol(){if(Un)return zn;Un=1;var t={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};return zn=function(){if("function"==typeof importScripts)return t;var e=navigator.userAgent;/Windows/.test(e)?t.windows=!0:/Mac OS/.test(e)&&!/like Mac OS/.test(e)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(t.iOS=!0,t.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),t.iOSVersion=parseInt(RegExp.$1,10)):t.macOS=!0:/Android/.test(e)?t.android=!0:/Linux/.test(e)?t.linux=!0:/iP[ao]d|iPhone/i.test(e)?(t.iOS=!0,navigator.appVersion.match(/OS (\d+)/),t.iOSVersion=parseInt(RegExp.$1,10),t.iPhone=-1!==e.toLowerCase().indexOf("iphone"),t.iPad=-1!==e.toLowerCase().indexOf("ipad")):/Kindle/.test(e)||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)?t.kindle=!0:/CrOS/.test(e)&&(t.chromeOS=!0),(/Windows Phone/i.test(e)||/IEMobile/i.test(e))&&(t.android=!1,t.iOS=!1,t.macOS=!1,t.windows=!0,t.windowsPhone=!0);var i=/Silk/.test(e);return(t.windows||t.macOS||t.linux&&!i||t.chromeOS)&&(t.desktop=!0),(t.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(t.desktop=!1),navigator.standalone&&(t.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(t.cordova=!0),void 0!==window.ejecta&&(t.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(t.node=!0),t.node&&"object"==typeof process.versions&&(t.nodeWebkit=!!process.versions["node-webkit"],t.electron=!!process.versions.electron),/Crosswalk/.test(e)&&(t.crosswalk=!0),t.pixelRatio=window.devicePixelRatio||1,t}()}function Fl(){if(Xn)return Yn;Xn=1;var t,e=Ol(),i={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};return t=navigator.userAgent,/Edg\/\d+/.test(t)?(i.edge=!0,i.es2019=!0):/OPR/.test(t)?(i.opera=!0,i.es2019=!0):/Chrome\/(\d+)/.test(t)&&!e.windowsPhone?(i.chrome=!0,i.chromeVersion=parseInt(RegExp.$1,10),i.es2019=i.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(i.firefox=!0,i.firefoxVersion=parseInt(RegExp.$1,10),i.es2019=i.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&e.iOS?(i.mobileSafari=!0,i.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(i.ie=!0,i.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!e.windowsPhone?(i.safari=!0,i.safariVersion=parseInt(RegExp.$1,10),i.es2019=i.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(i.ie=!0,i.trident=!0,i.tridentVersion=parseInt(RegExp.$1,10),i.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(i.silk=!0),Yn=i}function kl(){if(Hn)return Gn;Hn=1;var t,e="";return Gn={disable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!1),i},enable:function(i){return""===e&&(e=t(i)),e&&(i[e]=!0),i},getPrefix:t=function(t){for(var e=["i","webkitI","msI","mozI","oI"],i=0;i<e.length;i++){var n=e[i]+"mageSmoothingEnabled";if(n in t)return n}return null},isEnabled:function(t){return null!==e?t[e]:null}}}function Dl(){if(Vn)return Wn;Vn=1;var t=Wo(),e=kl(),i=[],n=!1;return Wn=function(){var s=function(s,a,o,h,l){var u;void 0===a&&(a=1),void 0===o&&(o=1),void 0===h&&(h=t.CANVAS),void 0===l&&(l=!1);var c=r(h);return null===c?(c={parent:s,canvas:document.createElement("canvas"),type:h},h===t.CANVAS&&i.push(c),u=c.canvas):(c.parent=s,u=c.canvas),l&&(c.parent=u),u.width=a,u.height=o,n&&h===t.CANVAS&&e.disable(u.getContext("2d",{willReadFrequently:!1})),u},r=function(e){if(void 0===e&&(e=t.CANVAS),e===t.WEBGL)return null;for(var n=0;n<i.length;n++){var s=i[n];if(!s.parent&&s.type===e)return s}return null},a=function(){var t=0;return i.forEach(function(e){e.parent&&t++}),t};return{create2D:function(e,i,n){return s(e,i,n,t.CANVAS)},create:s,createWebGL:function(e,i,n){return s(e,i,n,t.WEBGL)},disableSmoothing:function(){n=!0},enableSmoothing:function(){n=!1},first:r,free:function(){return i.length-a()},pool:i,remove:function(t){var e=t instanceof HTMLCanvasElement;i.forEach(function(i){(e&&i.canvas===t||!e&&i.parent===t)&&(i.parent=null,i.canvas.width=1,i.canvas.height=1)})},total:a}}(),Wn}function Il(){if(qn)return jn;qn=1;var t=Ol(),e=Fl(),i=Dl(),n={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};return jn=function(){if("function"==typeof importScripts)return n;n.canvas=!!window.CanvasRenderingContext2D;try{n.localStorage=!!localStorage.getItem}catch(t){n.localStorage=!1}n.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),n.fileSystem=!!window.requestFileSystem;var s,r,a,o=!1;return n.webGL=function(){if(window.WebGLRenderingContext)try{var t=i.createWebGL(this),e=t.getContext("webgl")||t.getContext("experimental-webgl"),n=i.create2D(this),s=n.getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return o=s.data instanceof Uint8ClampedArray,i.remove(t),i.remove(n),!!e}catch(t){return!1}return!1}(),n.worker=!!window.Worker,n.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,n.getUserMedia=n.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,e.firefox&&e.firefoxVersion<21&&(n.getUserMedia=!1),!t.iOS&&(e.ie||e.firefox||e.chrome)&&(n.canvasBitBltShift=!0),(e.safari||e.mobileSafari)&&(n.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(n.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(n.littleEndian=(s=new ArrayBuffer(4),r=new Uint8Array(s),a=new Uint32Array(s),r[0]=161,r[1]=178,r[2]=195,r[3]=212,3569595041===a[0]||2712847316!==a[0]&&null)),n.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==n.littleEndian&&o,n}(),jn}function Bl(){if(Zn)return Kn;Zn=1;var t=Fl(),e={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};return"function"==typeof importScripts||(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(e.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(e.mspointer=!0),navigator.getGamepads&&(e.gamepads=!0),"onwheel"in window||t.ie&&"WheelEvent"in window?e.wheelEvent="wheel":"onmousewheel"in window?e.wheelEvent="mousewheel":t.firefox&&"MouseScrollEvent"in window&&(e.wheelEvent="DOMMouseScroll")),Kn=e}function Nl(){if(Jn)return $n;Jn=1;var t=Fl(),e={flac:!1,aac:!1,audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};return $n=function(){if("function"==typeof importScripts)return e;e.audioData=!!window.Audio,e.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var i=document.createElement("audio"),n=!!i.canPlayType;try{if(n){var s=function(t,e){var n=i.canPlayType("audio/"+t).replace(/^no$/,"");return e?Boolean(n||i.canPlayType("audio/"+e).replace(/^no$/,"")):Boolean(n)};if(e.ogg=s('ogg; codecs="vorbis"'),e.opus=s('ogg; codecs="opus"',"opus"),e.mp3=s("mpeg"),e.wav=s("wav"),e.m4a=s("x-m4a"),e.aac=s("aac"),e.flac=s("flac","x-flac"),e.webm=s('webm; codecs="vorbis"'),""!==i.canPlayType('audio/mp4; codecs="ec-3"'))if(t.edge)e.dolby=!0;else if(t.safari&&t.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var r=parseInt(RegExp.$1,10),a=parseInt(RegExp.$2,10);(10===r&&a>=11||r>10)&&(e.dolby=!0)}}}catch(t){}return e}()}function zl(){if(ts)return Qn;ts=1;var t=kh(),e={h264:!1,hls:!1,mp4:!1,m4v:!1,ogg:!1,vp9:!1,webm:!1,hasRequestVideoFrame:!1};return Qn=function(){if("function"==typeof importScripts)return e;var i=document.createElement("video"),n=!!i.canPlayType,s=/^no$/;try{n&&(i.canPlayType('video/ogg; codecs="theora"').replace(s,"")&&(e.ogg=!0),i.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(s,"")&&(e.h264=!0,e.mp4=!0),i.canPlayType("video/x-m4v").replace(s,"")&&(e.m4v=!0),i.canPlayType('video/webm; codecs="vp8, vorbis"').replace(s,"")&&(e.webm=!0),i.canPlayType('video/webm; codecs="vp9"').replace(s,"")&&(e.vp9=!0),i.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(s,"")&&(e.hls=!0))}catch(t){}return i.parentNode&&i.parentNode.removeChild(i),e.getVideoURL=function(i){Array.isArray(i)||(i=[i]);for(var n=0;n<i.length;n++){var s,r=t(i[n],"url",i[n]);if(0===r.indexOf("blob:"))return{url:r,type:""};if(s=0===r.indexOf("data:")?r.split(",")[0].match(/\/(.*?);/):r.match(/\.([a-zA-Z0-9]+)($|\?)/),s=t(i[n],"type",s?s[1]:"").toLowerCase(),e[s])return{url:r,type:s}}return null},e}()}function Ul(){if(is)return es;is=1;var t={available:!1,cancel:"",keyboard:!1,request:""};return es=function(){if("function"==typeof importScripts)return t;var e,i="Fullscreen",n="FullScreen",s=["request"+i,"request"+n,"webkitRequest"+i,"webkitRequest"+n,"msRequest"+i,"msRequest"+n,"mozRequest"+n,"mozRequest"+i];for(e=0;e<s.length;e++)if(document.documentElement[s[e]]){t.available=!0,t.request=s[e];break}var r=["cancel"+n,"exit"+i,"webkitCancel"+n,"webkitExit"+i,"msCancel"+n,"msExit"+i,"mozCancel"+n,"mozExit"+i];if(t.available)for(e=0;e<r.length;e++)if(document[r[e]]){t.cancel=r[e];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(t.keyboard=!0),Object.defineProperty(t,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),t}()}function Yl(){if(ss)return ns;ss=1;var t,e,i,n=Dl(),s={supportInverseAlpha:!1,supportNewBlendModes:!1};return"function"!=typeof importScripts&&void 0!==document&&(s.supportNewBlendModes=(t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",(i=new Image).onload=function(){var r=new Image;r.onload=function(){var t=n.create2D(r,6).getContext("2d",{willReadFrequently:!0});if(t.globalCompositeOperation="multiply",t.drawImage(i,0,0),t.drawImage(r,2,0),!t.getImageData(2,0,1,1))return!1;var e=t.getImageData(2,0,1,1).data;n.remove(r),s.supportNewBlendModes=255===e[0]&&0===e[1]&&0===e[2]},r.src=t+"/wCKxvRF"+e},i.src=t+"AP804Oa6"+e,!1),s.supportInverseAlpha=function(){var t=n.create2D(this,2).getContext("2d",{willReadFrequently:!0});t.fillStyle="rgba(10, 20, 30, 0.5)",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1);if(null===e)return!1;t.putImageData(e,1,0);var i=t.getImageData(1,0,1,1),s=i.data[0]===e.data[0]&&i.data[1]===e.data[1]&&i.data[2]===e.data[2]&&i.data[3]===e.data[3];return n.remove(this),s}()),ns=s}function Xl(){return as?rs:(as=1,rs={os:Ol(),browser:Fl(),features:Il(),input:Bl(),audio:Nl(),video:zl(),fullscreen:Ul(),canvasFeatures:Yl()})}function Gl(){if(hs)return os;hs=1;var t=Xl();function e(t,e){return String(t).localeCompare(e)}function i(t,e,i,n){var s,r,a,o,h,l=t.length,u=0,c=2*i;for(s=0;s<l;s+=c)for(a=(r=s+i)+i,r>l&&(r=l),a>l&&(a=l),o=s,h=r;;)if(o<r&&h<a)e(t[o],t[h])<=0?n[u++]=t[o++]:n[u++]=t[h++];else if(o<r)n[u++]=t[o++];else{if(!(h<a))break;n[u++]=t[h++]}}return os=function(n,s){if(void 0===s&&(s=e),!n||n.length<2)return n;if(t.features.stableSort)return n.sort(s);var r=function(t,e){var n=t.length;if(n<=1)return t;for(var s=new Array(n),r=1;r<n;r*=2){i(t,e,r,s);var a=t;t=s,s=a}return t}(n,s);return r!==n&&i(r,null,n.length,n),n},os}function Hl(){return ds?cs:(ds=1,cs={Matrix:_i?Si:(_i=1,Si={CheckMatrix:Jh(),MatrixToString:tl(),ReverseColumns:(ri||(ri=1,si=function(t){return t.reverse()}),si),ReverseRows:(oi||(oi=1,ai=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t}),ai),Rotate180:nl(),RotateLeft:sl(),RotateMatrix:il(),RotateRight:rl(),Translate:hl(),TransposeMatrix:el()}),Add:(Ai||(Ai=1,Ci=function(t,e,i,n,s){if(void 0===s&&(s=t),i>0){var r=i-t.length;if(r<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),n&&n.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.splice(a,1),a--;if(0===(a=e.length))return null;i>0&&a>r&&(e.splice(r),a=r);for(var o=0;o<a;o++){var h=e[o];t.push(h),n&&n.call(s,h)}return e}),Ci),AddAt:(Pi||(Pi=1,Mi=function(t,e,i,n,s,r){if(void 0===i&&(i=0),void 0===r&&(r=t),n>0){var a=n-t.length;if(a<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(i,0,e),s&&s.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.pop(),o--;if(0===(o=e.length))return null;n>0&&o>a&&(e.splice(a),o=a);for(var h=o-1;h>=0;h--){var l=e[h];t.splice(i,0,l),s&&s.call(r,l)}return e}),Mi),BringToTop:(Li||(Li=1,Ri=function(t,e){var i=t.indexOf(e);return-1!==i&&i<t.length&&(t.splice(i,1),t.push(e)),e}),Ri),CountAllMatching:ul(),Each:cl(),EachInRange:dl(),FindClosestInSorted:fl(),Flatten:pl(),GetAll:gl(),GetFirst:ml(),GetRandom:vl(),MoveDown:($i||($i=1,Zi=function(t,e){var i=t.indexOf(e);if(i>0){var n=t[i-1],s=t.indexOf(n);t[i]=n,t[s]=e}return t}),Zi),MoveTo:(Qi||(Qi=1,Ji=function(t,e,i){var n=t.indexOf(e);if(-1===n||i<0||i>=t.length)throw new Error("Supplied index out of bounds");return n!==i&&(t.splice(n,1),t.splice(i,0,e)),e}),Ji),MoveUp:(en||(en=1,tn=function(t,e){var i=t.indexOf(e);if(-1!==i&&i<t.length-1){var n=t[i+1],s=t.indexOf(n);t[i]=n,t[s]=e}return t}),tn),MoveAbove:(sn||(sn=1,nn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n>s||(t.splice(n,1),s=t.indexOf(i),t.splice(s+1,0,e)),t}),nn),MoveBelow:(an||(an=1,rn=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return n<s||(t.splice(n,1),0===s?t.unshift(e):t.splice(s,0,e)),t}),rn),NumberArray:yl(),NumberArrayStep:wl(),QuickSelect:bl(),Range:Sl(),Remove:Cl(),RemoveAt:Al(),RemoveBetween:Ml(),RemoveRandomElement:Pl(),Replace:(On||(On=1,Ln=function(t,e,i){var n=t.indexOf(e),s=t.indexOf(i);return-1!==n&&-1===s&&(t[n]=i,!0)}),Ln),RotateLeft:al(),RotateRight:ol(),SafeRange:ll(),SendToBack:(kn||(kn=1,Fn=function(t,e){var i=t.indexOf(e);return-1!==i&&i>0&&(t.splice(i,1),t.unshift(e)),e}),Fn),SetAll:Rl(),Shuffle:El(),SortByDigits:Ll(),SpliceOne:_l(),StableSort:Gl(),Swap:(us||(us=1,ls=function(t,e,i){if(e===i)return t;var n=t.indexOf(e),s=t.indexOf(i);if(n<0||s<0)throw new Error("Supplied items must be elements of the same array");return t[n]=i,t[s]=e,t}),ls)})}function Wl(){if(ps)return fs;ps=1;var t=Hl(),e={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.displayList&&this.displayList.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this},setToTop:function(){var e=this.getDisplayList();return e&&t.BringToTop(e,this),this},setToBack:function(){var e=this.getDisplayList();return e&&t.SendToBack(e,this),this},setAbove:function(e){var i=this.getDisplayList();return i&&e&&t.MoveAbove(i,this,e),this},setBelow:function(e){var i=this.getDisplayList();return i&&e&&t.MoveBelow(i,this,e),this}};return fs=e}function Vl(){return ys?vs:(ys=1,vs={GLOW:4,SHADOW:5,PIXELATE:6,VIGNETTE:7,SHINE:8,BLUR:9,GRADIENT:12,BLOOM:13,COLOR_MATRIX:14,CIRCLE:15,BARREL:16,DISPLACEMENT:17,WIPE:18,BOKEH:19})}function jl(){if(ws)return xs;ws=1;var t=new(Ih())({initialize:function(t,e){this.type=t,this.gameObject=e,this.active=!0},setActive:function(t){return this.active=t,this},destroy:function(){this.gameObject=null,this.active=!1}});return xs=t}function ql(){if(Ts)return bs;Ts=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.BARREL,t),this.amount=n}});return bs=n}function Kl(){if(Ss)return Es;Ss=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=1),void 0===o&&(o=1),void 0===h&&(h=4),e.call(this,i.BLOOM,t),this.steps=h,this.offsetX=s,this.offsetY=r,this.blurStrength=a,this.strength=o,this.glcolor=[1,1,1],null!=n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Es=n}function Zl(){if(Cs)return _s;Cs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h){void 0===n&&(n=0),void 0===s&&(s=2),void 0===r&&(r=2),void 0===a&&(a=1),void 0===h&&(h=4),e.call(this,i.BLUR,t),this.quality=n,this.x=s,this.y=r,this.steps=h,this.strength=a,this.glcolor=[1,1,1],null!=o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return _s=n}function $l(){if(Ms)return As;Ms=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=.5),void 0===s&&(s=1),void 0===r&&(r=.2),void 0===a&&(a=!1),void 0===o&&(o=1),void 0===h&&(h=1),void 0===l&&(l=1),e.call(this,i.BOKEH,t),this.radius=n,this.amount=s,this.contrast=r,this.isTiltShift=a,this.strength=l,this.blurX=o,this.blurY=h}});return As=n}function Jl(){if(Rs)return Ps;Rs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o){void 0===n&&(n=8),void 0===a&&(a=1),void 0===o&&(o=.005),e.call(this,i.CIRCLE,t),this.scale=a,this.feather=o,this.thickness=n,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4],null!=s&&(this.color=s),null!=r&&(this.backgroundColor=r)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundColor:{get:function(){var t=this.glcolor2;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor2;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}},backgroundAlpha:{get:function(){return this.glcolor2[3]},set:function(t){this.glcolor2[3]=t}}});return Ps=n}function Ql(){if(Os)return Ls;Os=1;var t=Ih(),e=new Float32Array(20),i=new t({initialize:function(){this._matrix=new Float32Array(20),this.alpha=1,this._dirty=!0,this._data=new Float32Array(20),this.reset()},set:function(t){return this._matrix.set(t),this._dirty=!0,this},reset:function(){var t=this._matrix;return t.fill(0),t[0]=1,t[6]=1,t[12]=1,t[18]=1,this.alpha=1,this._dirty=!0,this},getData:function(){var t=this._data;return this._dirty&&(t.set(this._matrix),t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,this._dirty=!1),t},brightness:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t;return this.multiply([i,0,0,0,0,0,i,0,0,0,0,0,i,0,0,0,0,0,1,0],e)},saturate:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=2*t/3+1,n=-.5*(i-1);return this.multiply([i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0],e)},desaturate:function(t){return void 0===t&&(t=!1),this.saturate(-1,t)},hue:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),t=t/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),s=.213,r=.715,a=.072;return this.multiply([s+.787*i+n*-s,r+i*-r+n*-r,a+i*-a+.928*n,0,0,s+i*-s+.143*n,r+i*(1-r)+.14*n,a+i*-a+-.283*n,0,0,s+i*-s+-.787*n,r+i*-r+n*r,a+.928*i+n*a,0,0,0,0,0,1,0],e)},grayscale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!1),this.saturate(-t,e)},blackWhite:function(t){return void 0===t&&(t=!1),this.multiply(i.BLACK_WHITE,t)},contrast:function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1);var i=t+1,n=-.5*(i-1);return this.multiply([i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0],e)},negative:function(t){return void 0===t&&(t=!1),this.multiply(i.NEGATIVE,t)},desaturateLuminance:function(t){return void 0===t&&(t=!1),this.multiply(i.DESATURATE_LUMINANCE,t)},sepia:function(t){return void 0===t&&(t=!1),this.multiply(i.SEPIA,t)},night:function(t,e){return void 0===t&&(t=.1),void 0===e&&(e=!1),this.multiply([-2*t,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0],e)},lsd:function(t){return void 0===t&&(t=!1),this.multiply(i.LSD,t)},brown:function(t){return void 0===t&&(t=!1),this.multiply(i.BROWN,t)},vintagePinhole:function(t){return void 0===t&&(t=!1),this.multiply(i.VINTAGE,t)},kodachrome:function(t){return void 0===t&&(t=!1),this.multiply(i.KODACHROME,t)},technicolor:function(t){return void 0===t&&(t=!1),this.multiply(i.TECHNICOLOR,t)},polaroid:function(t){return void 0===t&&(t=!1),this.multiply(i.POLAROID,t)},shiftToBGR:function(t){return void 0===t&&(t=!1),this.multiply(i.SHIFT_BGR,t)},multiply:function(t,i){void 0===i&&(i=!1),i||this.reset();var n=this._matrix,s=e;return s.set(n),n.set([s[0]*t[0]+s[1]*t[5]+s[2]*t[10]+s[3]*t[15],s[0]*t[1]+s[1]*t[6]+s[2]*t[11]+s[3]*t[16],s[0]*t[2]+s[1]*t[7]+s[2]*t[12]+s[3]*t[17],s[0]*t[3]+s[1]*t[8]+s[2]*t[13]+s[3]*t[18],s[0]*t[4]+s[1]*t[9]+s[2]*t[14]+s[3]*t[19]+s[4],s[5]*t[0]+s[6]*t[5]+s[7]*t[10]+s[8]*t[15],s[5]*t[1]+s[6]*t[6]+s[7]*t[11]+s[8]*t[16],s[5]*t[2]+s[6]*t[7]+s[7]*t[12]+s[8]*t[17],s[5]*t[3]+s[6]*t[8]+s[7]*t[13]+s[8]*t[18],s[5]*t[4]+s[6]*t[9]+s[7]*t[14]+s[8]*t[19]+s[9],s[10]*t[0]+s[11]*t[5]+s[12]*t[10]+s[13]*t[15],s[10]*t[1]+s[11]*t[6]+s[12]*t[11]+s[13]*t[16],s[10]*t[2]+s[11]*t[7]+s[12]*t[12]+s[13]*t[17],s[10]*t[3]+s[11]*t[8]+s[12]*t[13]+s[13]*t[18],s[10]*t[4]+s[11]*t[9]+s[12]*t[14]+s[13]*t[19]+s[14],s[15]*t[0]+s[16]*t[5]+s[17]*t[10]+s[18]*t[15],s[15]*t[1]+s[16]*t[6]+s[17]*t[11]+s[18]*t[16],s[15]*t[2]+s[16]*t[7]+s[17]*t[12]+s[18]*t[17],s[15]*t[3]+s[16]*t[8]+s[17]*t[13]+s[18]*t[18],s[15]*t[4]+s[16]*t[9]+s[17]*t[14]+s[18]*t[19]+s[19]]),this._dirty=!0,this}});return i.BLACK_WHITE=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],i.NEGATIVE=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],i.DESATURATE_LUMINANCE=[.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,.2764723,.929708,.0938197,0,-37.1,0,0,0,1,0],i.SEPIA=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],i.LSD=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],i.BROWN=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],i.VINTAGE=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],i.KODACHROME=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],i.TECHNICOLOR=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],i.POLAROID=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],i.SHIFT_BGR=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],Ls=i}function tu(){if(ks)return Fs;ks=1;var t=Ih(),e=Ql(),i=Vl(),n=new t({Extends:e,initialize:function(t){e.call(this),this.type=i.COLOR_MATRIX,this.gameObject=t,this.active=!0},destroy:function(){this.gameObject=null,this._matrix=null,this._data=null}});return Fs=n}function eu(){if(Is)return Ds;Is=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r){void 0===n&&(n="__WHITE"),void 0===s&&(s=.005),void 0===r&&(r=.005),e.call(this,i.DISPLACEMENT,t),this.x=s,this.y=r,this.glTexture,this.setTexture(n)},setTexture:function(t){var e=this.gameObject.scene.sys.textures.getFrame(t);return e&&(this.glTexture=e.glTexture),this}});return Ds=n}function iu(){if(Ns)return Bs;Ns=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===s&&(s=4),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.GLOW,t),this.outerStrength=s,this.innerStrength=r,this.knockout=a,this.glcolor=[1,1,1,1],void 0!==n&&(this.color=n)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Bs=n}function nu(){if(Us)return zs;Us=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l,u){void 0===r&&(r=.2),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l=1),void 0===u&&(u=0),e.call(this,i.GRADIENT,t),this.alpha=r,this.size=u,this.fromX=a,this.fromY=o,this.toX=h,this.toY=l,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0],null!=n&&(this.color1=n),null!=s&&(this.color2=s)},color1:{get:function(){var t=this.glcolor1;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor1;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}},color2:{get:function(){var t=this.glcolor2;return(t[0]<<16)+(t[1]<<8)+(0|t[2])},set:function(t){var e=this.glcolor2;e[0]=t>>16&255,e[1]=t>>8&255,e[2]=255&t}}});return zs=n}function su(){if(Xs)return Ys;Xs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n){void 0===n&&(n=1),e.call(this,i.PIXELATE,t),this.amount=n}});return Ys=n}function ru(){if(Hs)return Gs;Hs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=.1),void 0===a&&(a=1),void 0===h&&(h=6),void 0===l&&(l=1),e.call(this,i.SHADOW,t),this.x=n,this.y=s,this.decay=r,this.power=a,this.glcolor=[0,0,0,1],this.samples=h,this.intensity=l,void 0!==o&&(this.color=o)},color:{get:function(){var t=this.glcolor;return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)},set:function(t){var e=this.glcolor;e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255}}});return Gs=n}function au(){if(Vs)return Ws;Vs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=3),void 0===a&&(a=!1),e.call(this,i.SHINE,t),this.speed=n,this.lineWidth=s,this.gradient=r,this.reveal=a}});return Ws=n}function ou(){if(qs)return js;qs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.5),void 0===s&&(s=.5),void 0===r&&(r=.5),void 0===a&&(a=.5),e.call(this,i.VIGNETTE,t),this.x=n,this.y=s,this.radius=r,this.strength=a}});return js=n}function hu(){if(Zs)return Ks;Zs=1;var t=Ih(),e=jl(),i=Vl(),n=new t({Extends:e,initialize:function(t,n,s,r,a){void 0===n&&(n=.1),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),e.call(this,i.WIPE,t),this.progress=0,this.wipeWidth=n,this.direction=s,this.axis=r,this.reveal=a}});return Ks=n}function lu(){if(Js)return $s;Js=1;var t=jo(),e=Vl(),i={Barrel:ql(),Controller:jl(),Bloom:Kl(),Blur:Zl(),Bokeh:$l(),Circle:Jl(),ColorMatrix:tu(),Displacement:eu(),Glow:iu(),Gradient:nu(),Pixelate:su(),Shadow:ru(),Shine:au(),Vignette:ou(),Wipe:hu()};return i=t(!1,i,e),$s=i}function uu(){if(tr)return Qs;tr=1;var t=Ih(),e=lu(),i=_l(),n=new t({initialize:function(t,e){this.gameObject=t,this.isPost=e,this.enabled=!1,this.list=[],this.padding=0},setPadding:function(t){return void 0===t&&(t=0),this.padding=t,this.gameObject},onFXCopy:function(){},onFX:function(){},enable:function(t){if(!this.isPost){var e=this.gameObject.scene.sys.renderer;e&&e.pipelines?(this.gameObject.pipeline=e.pipelines.FX_PIPELINE,void 0!==t&&(this.padding=t),this.enabled=!0):this.enabled=!1}},clear:function(){if(this.isPost)this.gameObject.resetPostPipeline(!0);else{for(var t=this.list,e=0;e<t.length;e++)t[e].destroy();this.list=[]}return this.enabled=!1,this.gameObject},remove:function(t){var e;if(this.isPost){var n=this.gameObject.getPostPipeline(String(t.type));for(Array.isArray(n)||(n=[n]),e=0;e<n.length;e++){var s=n[e];if(s.controller===t){this.gameObject.removePostPipeline(s),t.destroy();break}}}else{var r=this.list;for(e=0;e<r.length;e++)r[e]===t&&(i(r,e),t.destroy())}return this.gameObject},disable:function(t){return void 0===t&&(t=!1),this.isPost||this.gameObject.resetPipeline(),this.enabled=!1,t&&this.clear(),this.gameObject},add:function(t,e){if(!this.isPost)return this.enabled||this.enable(),this.list.push(t),t;var i=String(t.type);this.gameObject.setPostPipeline(i,e);var n=this.gameObject.getPostPipeline(i);return n?(Array.isArray(n)&&(n=n.pop()),n&&(n.controller=t),t):void 0},addGlow:function(t,i,n,s,r,a){return this.add(new e.Glow(this.gameObject,t,i,n,s),{quality:r,distance:a})},addShadow:function(t,i,n,s,r,a,o){return this.add(new e.Shadow(this.gameObject,t,i,n,s,r,a,o))},addPixelate:function(t){return this.add(new e.Pixelate(this.gameObject,t))},addVignette:function(t,i,n,s){return this.add(new e.Vignette(this.gameObject,t,i,n,s))},addShine:function(t,i,n,s){return this.add(new e.Shine(this.gameObject,t,i,n,s))},addBlur:function(t,i,n,s,r,a){return this.add(new e.Blur(this.gameObject,t,i,n,s,r,a))},addGradient:function(t,i,n,s,r,a,o,h){return this.add(new e.Gradient(this.gameObject,t,i,n,s,r,a,o,h))},addBloom:function(t,i,n,s,r,a){return this.add(new e.Bloom(this.gameObject,t,i,n,s,r,a))},addColorMatrix:function(){return this.add(new e.ColorMatrix(this.gameObject))},addCircle:function(t,i,n,s,r){return this.add(new e.Circle(this.gameObject,t,i,n,s,r))},addBarrel:function(t){return this.add(new e.Barrel(this.gameObject,t))},addDisplacement:function(t,i,n){return this.add(new e.Displacement(this.gameObject,t,i,n))},addWipe:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n))},addReveal:function(t,i,n){return this.add(new e.Wipe(this.gameObject,t,i,n,!0))},addBokeh:function(t,i,n){return this.add(new e.Bokeh(this.gameObject,t,i,n))},addTiltShift:function(t,i,n,s,r,a){return this.add(new e.Bokeh(this.gameObject,t,i,n,!0,s,r,a))},destroy:function(){this.clear(),this.gameObject=null}});return Qs=n}function cu(){return ir?er:(ir=1,er=function(t,e,i){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=i&&t.y+t.height>=i})}function du(){return sr?nr:(sr=1,nr=function(t){return 2*(t.width+t.height)})}function fu(){if(ar)return rr;ar=1;var t=du(),e=zh();return rr=function(i,n,s){if(void 0===s&&(s=new e),n<=0||n>=1)return s.x=i.x,s.y=i.y,s;var r=t(i)*n;return n>.5?(r-=i.width+i.height)<=i.width?(s.x=i.right-r,s.y=i.bottom):(s.x=i.x,s.y=i.bottom-(r-i.width)):r<=i.width?(s.x=i.x+r,s.y=i.y):(s.x=i.right,s.y=i.y+(r-i.width)),s},rr}function pu(){if(hr)return or;hr=1;var t=fu(),e=du();return or=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=e(i)/s);for(var a=0;a<n;a++){var o=a/n;r.push(t(i,o))}return r},or}function gu(){if(ur)return lr;ur=1;var t=zh();return lr=function(e,i,n){return void 0===n&&(n=new t),n.x=e.x1+(e.x2-e.x1)*i,n.y=e.y1+(e.y2-e.y1)*i,n},lr}function mu(){return dr||(dr=1,cr=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}),cr}function vu(){if(pr)return fr;pr=1;var t=mu(),e=zh();return fr=function(i,n,s,r){void 0===r&&(r=[]),!n&&s>0&&(n=t(i)/s);for(var a=i.x1,o=i.y1,h=i.x2,l=i.y2,u=0;u<n;u++){var c=u/n,d=a+(h-a)*c,f=o+(l-o)*c;r.push(new e(d,f))}return r},fr}function yu(){if(mr)return gr;mr=1;var t=zh();return gr=function(e,i){void 0===i&&(i=new t);var n=Math.random();return i.x=e.x1+n*(e.x2-e.x1),i.y=e.y1+n*(e.y2-e.y1),i},gr}function xu(){return yr?vr:(yr=1,vr=function(t,e,i){return void 0===i&&(i=1e-4),Math.abs(t-e)<i})}function wu(){if(wr)return xr;wr=1;var t=Ih(),e=xu(),i=new t({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new i(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},fuzzyEquals:function(t,i){return e(this.x,t.x,i)&&e(this.y,t.y,i)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},setAngle:function(t){return this.setToPolar(t,this.length())},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},setLength:function(t){return this.normalize().scale(t)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,i=t*t+e*e;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},normalizeLeftHand:function(){var t=this.x;return this.x=this.y,this.y=-1*t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this},transformMat3:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},transformMat4:function(t){var e=this.x,i=this.y,n=t.val;return this.x=n[0]*e+n[4]*i+n[12],this.y=n[1]*e+n[5]*i+n[13],this},reset:function(){return this.x=0,this.y=0,this},limit:function(t){var e=this.length();return e&&e>t&&this.scale(t/e),this},reflect:function(t){return t=t.clone().normalize(),this.subtract(t.scale(2*this.dot(t)))},mirror:function(t){return this.reflect(t).negate()},rotate:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e*this.x-i*this.y,i*this.x+e*this.y)},project:function(t){var e=this.dot(t)/t.dot(t);return this.copy(t).scale(e)}});return i.ZERO=new i,i.RIGHT=new i(1,0),i.LEFT=new i(-1,0),i.UP=new i(0,-1),i.DOWN=new i(0,1),i.ONE=new i(1,1),xr=i}function bu(){if(Tr)return br;Tr=1;var t=Ih(),e=gu(),i=vu(),n=Nh(),s=yu(),r=wu(),a=new t({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.type=n.LINE,this.x1=t,this.y1=e,this.x2=i,this.y2=s},getPoint:function(t,i){return e(this,t,i)},getPoints:function(t,e,n){return i(this,t,e,n)},getRandomPoint:function(t){return s(this,t)},setTo:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this},setFromObjects:function(t,e){return this.x1=t.x,this.y1=t.y,this.x2=e.x,this.y2=e.y,this},getPointA:function(t){return void 0===t&&(t=new r),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new r),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});return br=a}function Tu(){if(Sr)return Er;Sr=1;var t=zh();return Er=function(e,i){return void 0===i&&(i=new t),i.x=e.x+Math.random()*e.width,i.y=e.y+Math.random()*e.height,i}}function Eu(){if(Cr)return _r;Cr=1;var t=Ih(),e=cu(),i=fu(),n=pu(),s=Nh(),r=bu(),a=Tu(),o=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.RECTANGLE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new r),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){t>=this.right?this.width=0:this.width=this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x}},top:{get:function(){return this.y},set:function(t){t>=this.bottom?this.height=0:this.height=this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return _r=o}function Su(){return Mr||(Mr=1,Ar=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x-e,o=t.y-i;return t.x=a*s-o*r+e,t.y=a*r+o*s+i,t}),Ar}function _u(){if(Rr)return Pr;Rr=1;var t=Eu(),e=Su(),i=wu();return Pr={prepareBoundsOutput:function(t,i){return void 0===i&&(i=!1),0!==this.rotation&&e(t,this.x,this.y,this.rotation),i&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t,e){return void 0===t&&(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getTopLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new i),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(e){var i,n,s,r,a,o,h,l;if(void 0===e&&(e=new t),this.parentContainer){var u=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(e),u.transformPoint(e.x,e.y,e),i=e.x,n=e.y,this.getTopRight(e),u.transformPoint(e.x,e.y,e),s=e.x,r=e.y,this.getBottomLeft(e),u.transformPoint(e.x,e.y,e),a=e.x,o=e.y,this.getBottomRight(e),u.transformPoint(e.x,e.y,e),h=e.x,l=e.y}else this.getTopLeft(e),i=e.x,n=e.y,this.getTopRight(e),s=e.x,r=e.y,this.getBottomLeft(e),a=e.x,o=e.y,this.getBottomRight(e),h=e.x,l=e.y;return e.x=Math.min(i,s,a,h),e.y=Math.min(n,r,o,l),e.width=Math.max(i,s,a,h)-e.x,e.height=Math.max(n,r,o,l)-e.y,e}}}function Cu(){if(Or)return Lr;Or=1;var t={},e={},i={register:function(e,i,n,s){void 0===s&&(s=!1),t[e]={plugin:i,mapping:n,custom:s}},registerCustom:function(t,i,n,s){e[t]={plugin:i,mapping:n,data:s}},hasCore:function(e){return t.hasOwnProperty(e)},hasCustom:function(t){return e.hasOwnProperty(t)},getCore:function(e){return t[e]},getCustom:function(t){return e[t]},getCustomClass:function(t){return e.hasOwnProperty(t)?e[t].plugin:null},remove:function(e){t.hasOwnProperty(e)&&delete t[e]},removeCustom:function(t){e.hasOwnProperty(t)&&delete e[t]},destroyCorePlugins:function(){for(var e in t)t.hasOwnProperty(e)&&delete t[e]},destroyCustomPlugins:function(){for(var t in e)e.hasOwnProperty(t)&&delete e[t]}};return Lr=i}function Au(){return Sa?Ea:(Sa=1,Ea={ADDED_TO_SCENE:kr?Fr:(kr=1,Fr="addedtoscene"),BOOT:Ir?Dr:(Ir=1,Dr="boot"),CREATE:Nr?Br:(Nr=1,Br="create"),DESTROY:Ur?zr:(Ur=1,zr="destroy"),PAUSE:Xr?Yr:(Xr=1,Yr="pause"),POST_UPDATE:Hr?Gr:(Hr=1,Gr="postupdate"),PRE_RENDER:Vr?Wr:(Vr=1,Wr="prerender"),PRE_UPDATE:qr?jr:(qr=1,jr="preupdate"),READY:Zr?Kr:(Zr=1,Kr="ready"),REMOVED_FROM_SCENE:Jr?$r:(Jr=1,$r="removedfromscene"),RENDER:ta?Qr:(ta=1,Qr="render"),RESUME:ia?ea:(ia=1,ea="resume"),SHUTDOWN:sa?na:(sa=1,na="shutdown"),SLEEP:aa?ra:(aa=1,ra="sleep"),START:ha?oa:(ha=1,oa="start"),TRANSITION_COMPLETE:ua?la:(ua=1,la="transitioncomplete"),TRANSITION_INIT:da?ca:(da=1,ca="transitioninit"),TRANSITION_OUT:pa?fa:(pa=1,fa="transitionout"),TRANSITION_START:ma?ga:(ma=1,ga="transitionstart"),TRANSITION_WAKE:ya?va:(ya=1,va="transitionwake"),UPDATE:wa?xa:(wa=1,xa="update"),WAKE:Ta?ba:(Ta=1,ba="wake")})}function Mu(){if(Ca)return _a;Ca=1;var t=Ih(),e=Cu(),i=Au(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectFactory",n,"add"),_a=n}function Pu(){if(Ma)return Aa;Ma=1;var t=Ih(),e=Mu(),i=new t({initialize:function(t,e,i,n,s,r){e||(e=t.sys.make.image({x:i,y:n,key:s,frame:r,add:!1})),this.bitmapMask=e,this.invertAlpha=!1,this.isStencil=!1},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.beginMask(this,e,i)},postRenderWebGL:function(t,e,i){t.pipelines.BITMAPMASK_PIPELINE.endMask(this,e,i)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null}});return e.register("bitmapMask",function(t,e,n,s,r){return new i(this.scene,t,e,n,s,r)}),Aa=i}function Ru(){if(Ra)return Pa;Ra=1;var t=new(Ih())({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,i){var n=t.gl;t.flush(),0===t.maskStack.length&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:i}),this.applyStencil(t,i,!0),t.maskCount++},applyStencil:function(t,e,i){var n=t.gl,s=this.geometryMask,r=t.maskCount,a=255;n.colorMask(!1,!1,!1,!1),i?(n.stencilFunc(n.EQUAL,r,a),n.stencilOp(n.KEEP,n.KEEP,n.INCR),r++):(n.stencilFunc(n.EQUAL,r+1,a),n.stencilOp(n.KEEP,n.KEEP,n.DECR)),this.level=r,s.renderWebGL(t,s,e),t.flush(),n.colorMask(!0,!0,!0,!0),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),this.invertAlpha?n.stencilFunc(n.NOTEQUAL,r,a):n.stencilFunc(n.EQUAL,r,a)},postRenderWebGL:function(t){var e=t.gl;t.maskStack.pop(),t.maskCount--,t.flush();var i=t.currentMask;if(0===t.maskStack.length)i.mask=null,e.disable(e.STENCIL_TEST);else{var n=t.maskStack[t.maskStack.length-1];n.mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(i.mask=n.mask,i.camera=n.camera):i.mask=null}},preRenderCanvas:function(t,e,i){var n=this.geometryMask;t.currentContext.save(),n.renderCanvas(t,n,i,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});return Pa=t}function Lu(){if(Oa)return La;Oa=1;var t=Pu(),e=Ru(),i={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(e,i,n,s,r){return void 0===e&&(this.texture||this.shader||this.geom)&&(e=this),new t(this.scene,e,i,n,s,r)},createGeometryMask:function(t){return void 0!==t||"Graphics"!==this.type&&!this.geom||(t=this),new e(this.scene,t)}};return La=i}function Ou(){if(Ia)return Da;Ia=1;var t=Gh();return Da=function(e){return e*t.DEG_TO_RAD},Da}function Fu(){return Na?Ba:(Na=1,Ba=function(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i})}function ku(){return Ua?za:(Ua=1,za={CREATED:0,DELAY:2,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING:20,ACTIVE:21,LOOP_DELAY:22,COMPLETE_DELAY:23,START_DELAY:24,PENDING_REMOVE:25,REMOVED:26,FINISHED:27,DESTROYED:28,MAX:999999999999})}function Du(){if(Xa)return Ya;Xa=1;var t=Ou(),e=Fu(),i=Tl(),n=ku(),s=wu(),r={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:n.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var i=this.pathTween;return i&&i.isPlaying()&&i.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(r,a){void 0===r&&(r={}),void 0===a&&(a=0);var o=this.pathTween;o&&o.isPlaying()&&o.stop(),"number"==typeof r&&(r={duration:r}),r.from=i(r,"from",0),r.to=i(r,"to",1);var h=e(r,"positionOnPath",!1);this.rotateToPath=e(r,"rotateToPath",!1),this.pathRotationOffset=i(r,"rotationOffset",0);var l=i(r,"startAt",a);if(l&&(r.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var i=e.ease(e.progress);e.current=e.start+(e.end-e.start)*i,e.setTargetValue()}),this.pathOffset||(this.pathOffset=new s(this.x,this.y)),this.pathVector||(this.pathVector=new s),this.pathDelta||(this.pathDelta=new s),this.pathDelta.reset(),r.persist=!0,this.pathTween=this.scene.sys.tweens.addCounter(r),this.path.getStartPoint(this.pathOffset),h&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=n.PLAYING_FORWARD,this.rotateToPath){var u=this.path.getPoint(.1);this.rotation=Math.atan2(u.y-this.y,u.x-this.x)+t(this.pathRotationOffset)}return this.pathConfig=r,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var e=this.pathTween;if(e&&e.data){var i=e.data[0],s=this.pathDelta,r=this.pathVector;if(s.copy(r).negate(),i.state===n.COMPLETE)return this.path.getPoint(i.end,r),s.add(r),r.add(this.pathOffset),void this.setPosition(r.x,r.y);if(i.state!==n.PLAYING_FORWARD&&i.state!==n.PLAYING_BACKWARD)return;this.path.getPoint(e.getValue(),r),s.add(r),r.add(this.pathOffset);var a=this.x,o=this.y;this.setPosition(r.x,r.y);var h=this.x-a,l=this.y-o;if(0===h&&0===l)return;if(i.state!==this._prevDirection)return void(this._prevDirection=i.state);this.rotateToPath&&(this.rotation=Math.atan2(l,h)+t(this.pathRotationOffset))}}};return Ya=r}function Iu(){if(Ha)return Ga;Ha=1;var t=function(e){var i,n,s;if("object"!=typeof e||null===e)return e;for(s in i=Array.isArray(e)?[]:{},e)n=e[s],i[s]=t(n);return i};return Ga=t}function Bu(){if(Va)return Wa;Va=1;var t=Iu(),e={defaultPipeline:null,pipeline:null,pipelineData:null,initPipeline:function(t){this.pipelineData={};var e=this.scene.sys.renderer;if(!e)return!1;var i=e.pipelines;if(i){void 0===t&&(t=i.default);var n=i.get(t);if(n)return this.defaultPipeline=n,this.pipeline=n,!0}return!1},setPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){var a=r.get(e);a&&(this.pipeline=a),i&&(this.pipelineData=n?t(i):i)}return this},setPipelineData:function(t,e){var i=this.pipelineData;return void 0===e?delete i[t]:i[t]=e,this},resetPipeline:function(t){return void 0===t&&(t=!1),this.pipeline=this.defaultPipeline,t&&(this.pipelineData={}),null!==this.pipeline},getPipelineName:function(){return null===this.pipeline?null:this.pipeline.name}};return Wa=e}function Nu(){if(qa)return ja;qa=1;var t=Iu(),e=uu(),i=_l(),n={hasPostPipeline:!1,postPipelines:null,postPipelineData:null,preFX:null,postFX:null,initPostPipeline:function(t){this.postPipelines=[],this.postPipelineData={},this.postFX=new e(this,!0),t&&(this.preFX=new e(this,!1))},setPostPipeline:function(e,i,n){var s=this.scene.sys.renderer;if(!s)return this;var r=s.pipelines;if(r){Array.isArray(e)||(e=[e]);for(var a=0;a<e.length;a++){var o=r.getPostPipeline(e[a],this,i);o&&this.postPipelines.push(o)}i&&(this.postPipelineData=n?t(i):i)}return this.hasPostPipeline=this.postPipelines.length>0,this},setPostPipelineData:function(t,e){var i=this.postPipelineData;return void 0===e?delete i[t]:i[t]=e,this},getPostPipeline:function(t){for(var e="string"==typeof t,i=this.postPipelines,n=[],s=0;s<i.length;s++){var r=i[s];(e&&r.name===t||!e&&r instanceof t)&&n.push(r)}return 1===n.length?n[0]:n},resetPostPipeline:function(t){void 0===t&&(t=!1);for(var e=this.postPipelines,i=0;i<e.length;i++)e[i].destroy();this.postPipelines=[],this.hasPostPipeline=!1,t&&(this.postPipelineData={})},removePostPipeline:function(t){for(var e="string"==typeof t,n=this.postPipelines,s=n.length-1;s>=0;s--){var r=n[s];(e&&r.name===t||!e&&r===t)&&(r.destroy(),i(n,s))}return this.hasPostPipeline=this.postPipelines.length>0,this},clearFX:function(){return this.preFX&&this.preFX.clear(),this.postFX&&this.postFX.clear(),this}};return ja=n}function zu(){if(Ja)return $a;Ja=1;var t={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight;var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};return $a=t}function Uu(){if(to)return Qa;to=1;var t=Ih(),e=Yh(),i=jo(),n=new t({initialize:function(t,e,i,n,s,r,a){this.texture=t,this.name=e,this.source=t.source[i],this.sourceIndex=i,this.cutX,this.cutY,this.cutWidth,this.cutHeight,this.x=0,this.y=0,this.width,this.height,this.halfWidth,this.halfHeight,this.centerX,this.centerY,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0},is3Slice:!1,scale9:!1,scale9Borders:{x:0,y:0,w:0,h:0}},this.setSize(r,a,n,s)},setCutPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.cutX=t,this.cutY=e,this.updateUVs()},setCutSize:function(t,e){return this.cutWidth=t,this.cutHeight=e,this.updateUVs()},setSize:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.setCutPosition(i,n),this.setCutSize(t,e),this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var s=this.data,r=s.cut;r.x=i,r.y=n,r.w=t,r.h=e,r.r=i+t,r.b=n+e,s.sourceSize.w=t,s.sourceSize.h=e,s.spriteSourceSize.w=t,s.spriteSourceSize.h=e,s.radius=.5*Math.sqrt(t*t+e*e);var a=s.drawImage;return a.x=i,a.y=n,a.width=t,a.height=e,this.updateUVs()},setTrim:function(t,e,i,n,s,r){var a=this.data,o=a.spriteSourceSize;return a.trim=!0,a.sourceSize.w=t,a.sourceSize.h=e,o.x=i,o.y=n,o.w=s,o.h=r,o.r=i+s,o.b=n+r,this.x=i,this.y=n,this.width=s,this.height=r,this.halfWidth=.5*s,this.halfHeight=.5*r,this.centerX=Math.floor(s/2),this.centerY=Math.floor(r/2),this.updateUVs()},setScale9:function(t,e,i,n){var s=this.data;return s.scale9=!0,s.is3Slice=0===e&&n===this.height,s.scale9Borders.x=t,s.scale9Borders.y=e,s.scale9Borders.w=i,s.scale9Borders.h=n,this},setCropUVs:function(t,i,n,s,r,a,o){var h=this.cutX,l=this.cutY,u=this.cutWidth,c=this.cutHeight,d=this.realWidth,f=this.realHeight,p=h+(i=e(i,0,d)),g=l+(n=e(n,0,f)),m=s=e(s,0,d-i),v=r=e(r,0,f-n),y=this.data;if(y.trim){var x=y.spriteSourceSize,w=i+(s=e(s,0,x.x+u-i)),b=n+(r=e(r,0,x.y+c-n));if(x.r<i||x.b<n||x.x>w||x.y>b)p=0,g=0,m=0,v=0;else{var T=Math.max(x.x,i),E=Math.max(x.y,n),S=Math.min(x.r,w)-T,_=Math.min(x.b,b)-E;m=S,v=_,p=a?h+(u-(T-x.x)-S):h+(T-x.x),g=o?l+(c-(E-x.y)-_):l+(E-x.y),i=T,n=E,s=S,r=_}}else a&&(p=h+(u-i-s)),o&&(g=l+(c-n-r));var C=this.source.width,A=this.source.height;return t.u0=Math.max(0,p/C),t.v0=Math.max(0,g/A),t.u1=Math.min(1,(p+m)/C),t.v1=Math.min(1,(g+v)/A),t.x=i,t.y=n,t.cx=p,t.cy=g,t.cw=m,t.ch=v,t.width=s,t.height=r,t.flipX=a,t.flipY=o,t},updateCropUVs:function(t,e,i){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,i)},setUVs:function(t,e,i,n,s,r){var a=this.data.drawImage;return a.width=t,a.height=e,this.u0=i,this.v0=n,this.u1=s,this.v1=r,this},updateUVs:function(){var t=this.cutX,e=this.cutY,i=this.cutWidth,n=this.cutHeight,s=this.data.drawImage;s.width=i,s.height=n;var r=this.source.width,a=this.source.height;return this.u0=t/r,this.v0=e/a,this.u1=(t+i)/r,this.v1=(e+n)/a,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new n(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=i(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.texture=null,this.source=null,this.customData=null,this.data=null},glTexture:{get:function(){return this.source.glTexture}},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},scale9:{get:function(){return this.data.scale9}},is3Slice:{get:function(){return this.data.is3Slice}},canvasData:{get:function(){return this.data.drawImage}}});return Qa=n}function Yu(){if(io)return eo;io=1;var t=Uu();return eo={texture:null,frame:null,isCropped:!1,setTexture:function(t,e,i,n){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e,i,n)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}}function Xu(){if(so)return no;so=1;var t=Uu();return no={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(e,i,n){return void 0===i&&(i=!0),void 0===n&&(n=!0),e instanceof t?(this.texture=this.scene.sys.textures.get(e.texture.key),this.frame=e):this.frame=this.texture.get(e),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&i&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}}function Gu(){return ho?oo:(ho=1,oo=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e})}function Hu(){if(uo)return lo;uo=1;var t=Ih(),e=Gh(),i=wu(),n=new t({initialize:function(t,e,i,n,s,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=0),void 0===r&&(r=0),this.matrix=new Float32Array([t,e,i,n,s,r,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0},this.quad=new Float32Array(8)},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,i=t[0],n=t[1],s=t[2],r=t[3];return i||n?n>0?Math.acos(i/this.scaleX):-Math.acos(i/this.scaleX):s||r?e.TAU-(r>0?Math.acos(-s/this.scaleY):-Math.acos(s/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var i=this.matrix;return i[4]=i[0]*t+i[2]*e+i[4],i[5]=i[1]*t+i[3]*e+i[5],this},scale:function(t,e){var i=this.matrix;return i[0]*=t,i[1]*=t,i[2]*=e,i[3]*=e,this},rotate:function(t){var e=Math.sin(t),i=Math.cos(t),n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3];return n[0]=s*i+a*e,n[1]=r*i+o*e,n[2]=s*-e+a*i,n[3]=r*-e+o*i,this},multiply:function(t,e){var i=this.matrix,n=t.matrix,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=n[0],c=n[1],d=n[2],f=n[3],p=n[4],g=n[5],m=void 0===e?i:e.matrix;return m[0]=u*s+c*a,m[1]=u*r+c*o,m[2]=d*s+f*a,m[3]=d*r+f*o,m[4]=p*s+g*a+h,m[5]=p*r+g*o+l,m},multiplyWithOffset:function(t,e,i){var n=this.matrix,s=t.matrix,r=n[0],a=n[1],o=n[2],h=n[3],l=e*r+i*o+n[4],u=e*a+i*h+n[5],c=s[0],d=s[1],f=s[2],p=s[3],g=s[4],m=s[5];return n[0]=c*r+d*o,n[1]=c*a+d*h,n[2]=f*r+p*o,n[3]=f*a+p*h,n[4]=g*r+m*o+l,n[5]=g*a+m*h+u,this},transform:function(t,e,i,n,s,r){var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5];return a[0]=t*o+e*l,a[1]=t*h+e*u,a[2]=i*o+n*l,a[3]=i*h+n*u,a[4]=s*o+r*l+c,a[5]=s*h+r*u+d,this},transformPoint:function(t,e,i){void 0===i&&(i={x:0,y:0});var n=this.matrix,s=n[0],r=n[1],a=n[2],o=n[3],h=n[4],l=n[5];return i.x=t*s+e*a+h,i.y=t*r+e*o+l,i},invert:function(){var t=this.matrix,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=e*s-i*n;return t[0]=s/o,t[1]=-i/o,t[2]=-n/o,t[3]=e/o,t[4]=(n*a-s*r)/o,t[5]=-(e*a-i*r)/o,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,i,n,s,r){var a=this.matrix;return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=s,a[5]=r,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(t.translateX=e[4],t.translateY=e[5],i||n){var o=Math.sqrt(i*i+n*n);t.rotation=n>0?Math.acos(i/o):-Math.acos(i/o),t.scaleX=o,t.scaleY=a/o}else if(s||r){var h=Math.sqrt(s*s+r*r);t.rotation=.5*Math.PI-(r>0?Math.acos(-s/h):-Math.acos(s/h)),t.scaleX=a/h,t.scaleY=h}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,i,n,s){var r=this.matrix,a=Math.sin(i),o=Math.cos(i);return r[4]=t,r[5]=e,r[0]=o*n,r[1]=a*n,r[2]=-a*s,r[3]=o*s,this},applyInverse:function(t,e,n){void 0===n&&(n=new i);var s=this.matrix,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=1/(r*h+o*-a);return n.x=h*c*t+-o*c*e+(u*o-l*h)*c,n.y=r*c*e+-a*c*t+(-u*r+l*a)*c,n},setQuad:function(t,e,i,n,s,r){void 0===s&&(s=!1),void 0===r&&(r=this.quad);var a=this.matrix,o=a[0],h=a[1],l=a[2],u=a[3],c=a[4],d=a[5],f=t*o+e*l+c,p=t*h+e*u+d,g=t*o+n*l+c,m=t*h+n*u+d,v=i*o+n*l+c,y=i*h+n*u+d,x=i*o+e*l+c,w=i*h+e*u+d;if(s){var b=Math.floor(f+.5),T=Math.floor(p+.5),E=b-f,S=T-p;r[0]=b,r[1]=T,r[2]=g+E,r[3]=m+S,r[4]=v+E,r[5]=y+S,r[6]=x+E,r[7]=w+S}else r[0]=f,r[1]=p,r[2]=g,r[3]=m,r[4]=v,r[5]=y,r[6]=x,r[7]=w;return r},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getXRound:function(t,e,i){var n=this.getX(t,e);return i&&(n=Math.floor(n+.5)),n},getYRound:function(t,e,i){var n=this.getY(t,e);return i&&(n=Math.floor(n+.5)),n},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.quad=null,this.decomposedMatrix=null}});return lo=n}function Wu(){if(fo)return co;fo=1;var t=wu();return co=function(e,i,n,s,r,a,o,h){void 0===h&&(h=new t);var l=Math.sin(r),u=Math.cos(r),c=u*a,d=l*a,f=-l*o,p=u*o,g=1/(c*p+f*-d);return h.x=p*g*e+-f*g*i+(s*f-n*p)*g,h.y=c*g*i+-d*g*e+(-s*c+n*d)*g,h}}function Vu(){return go?po:(go=1,po=function(t,e,i){var n=i-e;return e+((t-e)%n+n)%n})}function ju(){if(vo)return mo;vo=1;var t=Vu();return mo=function(e){return t(e,-Math.PI,Math.PI)}}function qu(){if(xo)return yo;xo=1;var t=Vu();return yo=function(e){return t(e,-180,180)}}function Ku(){if(bo)return wo;bo=1;var t=Gh(),e=Hu(),i=Wu(),n=ju(),s=qu(),r=wu(),a={hasTransformComponent:!0,_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:0!==this._scaleY&&(this.renderFlags|=4)}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:0!==this._scaleX&&(this.renderFlags|=4)}},angle:{get:function(){return s(this._rotation*t.RAD_TO_DEG)},set:function(e){this.rotation=s(e)*t.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=n(t)}},setPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=i,this.w=n,this},copyPosition:function(t){return void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.z&&(this.z=t.z),void 0!==t.w&&(this.w=t.w),this},setRandomPosition:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.scene.sys.scale.width),void 0===n&&(n=this.scene.sys.scale.height),this.x=t+Math.random()*i,this.y=e+Math.random()*n,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new e),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,i){void 0===t&&(t=new e);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);var s=!1;for(i||(i=new e,s=!0),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)i.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),i.multiply(t,t),n=n.parentContainer;return s&&i.destroy(),t},getLocalPoint:function(t,e,n,s){n||(n=new r),s||(s=this.scene.sys.cameras.main);var a=s.scrollX,o=s.scrollY,h=t+a*this.scrollFactorX-a,l=e+o*this.scrollFactorY-o;return this.parentContainer?this.getWorldTransformMatrix().applyInverse(h,l,n):i(h,l,this.x,this.y,this.rotation,this.scaleX,this.scaleY,n),this._originComponent&&(n.x+=this._displayOriginX,n.y+=this._displayOriginY),n},getWorldPoint:function(t,e,i){if(void 0===t&&(t=new r),!this.parentContainer)return t.x=this.x,t.y=this.y,t;var n=this.getWorldTransformMatrix(e,i);return t.x=n.tx,t.y=n.ty,t},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};return wo=a}function Zu(){return _o?So:(_o=1,So={Alpha:Kh(),AlphaSingle:Zh(),BlendMode:$h(),ComputedSize:Ke?qe:(Ke=1,qe={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}),Crop:$e?Ze:($e=1,Ze={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,i,n){if(void 0===t)this.isCropped=!1;else if(this.frame){if("number"==typeof t)this.frame.setCropUVs(this._crop,t,e,i,n,this.flipX,this.flipY);else{var s=t;this.frame.setCropUVs(this._crop,s.x,s.y,s.width,s.height,this.flipX,this.flipY)}this.isCropped=!0}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}),Depth:Wl(),Flip:ms?gs:(ms=1,gs={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}),FX:uu(),GetBounds:_u(),Mask:Lu(),Origin:ka?Fa:(ka=1,Fa={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}),PathFollower:Du(),Pipeline:Bu(),PostPipeline:Nu(),ScrollFactor:Za?Ka:(Za=1,Ka={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}),Size:zu(),Texture:Yu(),TextureCrop:Xu(),Tint:ao?ro:(ao=1,ro={tintTopLeft:16777215,tintTopRight:16777215,tintBottomLeft:16777215,tintBottomRight:16777215,tintFill:!1,clearTint:function(){return this.setTint(16777215),this},setTint:function(t,e,i,n){return void 0===t&&(t=16777215),void 0===e&&(e=t,i=t,n=t),this.tintTopLeft=t,this.tintTopRight=e,this.tintBottomLeft=i,this.tintBottomRight=n,this.tintFill=!1,this},setTintFill:function(t,e,i,n){return this.setTint(t,e,i,n),this.tintFill=!0,this},tint:{get:function(){return this.tintTopLeft},set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){var t=16777215;return this.tintFill||this.tintTopLeft!==t||this.tintTopRight!==t||this.tintBottomLeft!==t||this.tintBottomRight!==t}}}),ToJSON:Gu(),Transform:Ku(),TransformMatrix:Hu(),Visible:Eo?To:(Eo=1,To={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}})})}function $u(){return Bo?Io:(Bo=1,Io={CHANGE_DATA:Ao?Co:(Ao=1,Co="changedata"),CHANGE_DATA_KEY:Po?Mo:(Po=1,Mo="changedata-"),DESTROY:Lo?Ro:(Lo=1,Ro="destroy"),REMOVE_DATA:Fo?Oo:(Fo=1,Oo="removedata"),SET_DATA:Do?ko:(Do=1,ko="setdata")})}function Ju(){if(zo)return No;zo=1;var t=Ih(),e=$u(),i=new t({initialize:function(t,i){this.parent=t,this.events=i,i||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once(e.DESTROY,this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var i=[],n=0;n<t.length;n++)i.push(e[t[n]]);return i}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var i in this.list)this.list.hasOwnProperty(i)&&i.match(t)&&(e[i]=this.list[i]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var i in t)this.setValue(i,t[i]);return this},inc:function(t,e){if(this._frozen)return this;void 0===e&&(e=1);var i=this.get(t);return void 0===i&&(i=0),this.set(t,i+e),this},toggle:function(t){return this._frozen||this.set(t,!this.get(t)),this},setValue:function(t,i){if(this._frozen)return this;if(this.has(t))this.values[t]=i;else{var n=this,s=this.list,r=this.events,a=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return s[t]},set:function(i){if(!n._frozen){var o=s[t];s[t]=i,r.emit(e.CHANGE_DATA,a,t,i,o),r.emit(e.CHANGE_DATA_KEY+t,a,i,o)}}}),s[t]=i,r.emit(e.SET_DATA,a,t,i)}return this},each:function(t,e){for(var i=[this.parent,null,void 0],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[1]=s,i[2]=this.list[s],t.apply(e,i);return this},merge:function(t,e){for(var i in void 0===e&&(e=!0),t)t.hasOwnProperty(i)&&(e||!e&&!this.has(i))&&this.setValue(i,t[i]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var i=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)}return this},pop:function(t){var i=void 0;return!this._frozen&&this.has(t)&&(i=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(e.REMOVE_DATA,this.parent,t,i)),i},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(e.CHANGE_DATA),this.events.off(e.SET_DATA),this.events.off(e.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});return No=i}var Qu,tc,ec,ic,nc,sc,rc,ac,oc,hc,lc,uc,cc,dc,fc,pc,gc,mc,vc,yc,xc,wc,bc,Tc,Ec,Sc,_c,Cc,Ac,Mc,Pc,Rc,Lc,Oc,Fc,kc,Dc,Ic,Bc,Nc,zc,Uc,Yc,Xc,Gc,Hc,Wc,Vc,jc,qc,Kc,Zc,$c,Jc,Qc,td,ed,id,nd,sd,rd,ad,od,hd,ld,ud,cd,dd,fd,pd,gd,md,vd,yd,xd,wd,bd,Td,Ed,Sd,_d,Cd,Ad,Md,Pd,Rd,Ld,Od,Fd,kd,Dd,Id,Bd,Nd,zd,Ud,Yd,Xd,Gd,Hd,Wd,Vd,jd,qd,Kd,Zd,$d,Jd,Qd,tf,ef,nf,sf,rf,af,of,hf,lf,uf,cf,df,ff,pf,gf,mf,vf,yf,xf,wf,bf,Tf,Ef,Sf,_f,Cf,Af,Mf,Pf,Rf,Lf,Of,Ff,kf,Df,If,Bf,Nf,zf,Uf,Yf,Xf,Gf,Hf,Wf,Vf,jf,qf,Kf,Zf,$f,Jf,Qf,tp,ep,ip,np,sp,rp,ap,op,hp,lp,up,cp,dp,fp,pp,gp,mp,vp,yp,xp,wp,bp,Tp,Ep,Sp,_p,Cp,Ap,Mp,Pp,Rp,Lp,Op,Fp,kp,Dp,Ip,Bp,Np,zp,Up,Yp,Xp,Gp,Hp,Wp,Vp,jp,qp,Kp,Zp,$p,Jp,Qp,tg,eg,ig,ng,sg,rg,ag,og,hg,lg,ug,cg,dg,fg,pg,gg,mg,vg,yg,xg,wg,bg,Tg,Eg,Sg,_g,Cg,Ag,Mg,Pg,Rg,Lg,Og,Fg,kg,Dg,Ig,Bg,Ng,zg,Ug,Yg,Xg,Gg,Hg,Wg,Vg,jg,qg,Kg,Zg,$g,Jg,Qg,tm,em,im,nm,sm,rm,am,om,hm,lm,um,cm,dm,fm,pm,gm,mm,vm,ym,xm,wm,bm,Tm,Em,Sm,_m,Cm,Am,Mm,Pm,Rm,Lm,Om,Fm,km,Dm,Im,Bm,Nm,zm,Um,Ym,Xm,Gm,Hm,Wm,Vm,jm,qm,Km,Zm,$m,Jm,Qm,tv,ev,iv,nv,sv,rv,av,ov,hv,lv,uv,cv,dv,fv,pv,gv,mv,vv,yv,xv,wv,bv,Tv,Ev,Sv,_v,Cv,Av,Mv,Pv,Rv,Lv,Ov,Fv,kv,Dv,Iv,Bv,Nv,zv,Uv,Yv,Xv,Gv,Hv,Wv,Vv,jv,qv,Kv,Zv,$v,Jv,Qv,ty,ey,iy,ny,sy,ry,ay,oy,hy,ly,uy,cy,dy,fy,py,gy,my,vy,yy,xy,wy,by,Ty,Ey,Sy,_y,Cy,Ay,My,Py,Ry,Ly,Oy,Fy,ky,Dy,Iy,By,Ny,zy,Uy,Yy,Xy,Gy,Hy,Wy,Vy,jy,qy,Ky,Zy,$y,Jy,Qy,tx,ex,ix,nx,sx,rx,ax,ox,hx,lx,ux,cx,dx,fx,px,gx,mx,vx,yx,xx,wx,bx,Tx,Ex,Sx,_x,Cx,Ax,Mx,Px,Rx,Lx,Ox,Fx,kx,Dx,Ix,Bx,Nx,zx,Ux,Yx,Xx,Gx,Hx,Wx,Vx,jx,qx,Kx,Zx,$x,Jx,Qx,tw,ew,iw,nw,sw,rw,aw,ow,hw,lw,uw,cw,dw,fw,pw,gw,mw,vw,yw,xw,ww,bw,Tw,Ew,Sw,_w,Cw,Aw,Mw,Pw,Rw,Lw,Ow,Fw,kw,Dw,Iw,Bw,Nw,zw,Uw,Yw,Xw,Gw,Hw,Ww,Vw,jw,qw,Kw,Zw,$w,Jw,Qw,tb,eb,ib,nb,sb,rb,ab,ob,hb,lb,ub,cb,db,fb,pb,gb,mb,vb,yb,xb,wb,bb,Tb,Eb,Sb,_b,Cb,Ab,Mb,Pb,Rb,Lb,Ob,Fb,kb,Db,Ib,Bb,Nb,zb,Ub,Yb,Xb,Gb,Hb,Wb,Vb,jb,qb,Kb,Zb,$b,Jb,Qb,tT,eT,iT,nT,sT,rT,aT,oT,hT,lT,uT,cT,dT,fT,pT,gT,mT,vT,yT,xT,wT,bT,TT,ET,ST,_T,CT,AT,MT,PT,RT,LT,OT,FT,kT,DT,IT,BT,NT,zT,UT,YT,XT,GT,HT,WT,VT,jT,qT,KT,ZT,$T,JT,QT,tE,eE,iE,nE,sE,rE,aE,oE,hE,lE,uE,cE,dE,fE,pE,gE,mE,vE,yE,xE,wE,bE,TE,EE,SE,_E,CE,AE,ME,PE,RE,LE,OE,FE,kE,DE,IE,BE,NE,zE,UE,YE,XE,GE,HE,WE,VE,jE,qE,KE,ZE,$E,JE,QE,tS,eS,iS,nS,sS,rS,aS,oS,hS,lS,uS,cS,dS,fS,pS,gS,mS,vS,yS,xS,wS,bS,TS,ES,SS,_S,CS,AS,MS,PS,RS,LS,OS,FS,kS,DS,IS,BS,NS,zS,US,YS,XS,GS,HS,WS,VS,jS,qS,KS,ZS,$S,JS,QS,t_,e_,i_,n_,s_,r_,a_,o_,h_,l_,u_,c_,d_,f_,p_,g_,m_,v_,y_,x_,w_,b_,T_,E_,S_,__,C_,A_,M_,P_,R_,L_,O_,F_,k_,D_,I_,B_,N_,z_,U_,Y_,X_,G_,H_,W_,V_,j_,q_,K_,Z_,$_,J_,Q_,tC,eC,iC,nC,sC,rC,aC,oC,hC,lC,uC,cC,dC,fC,pC,gC,mC,vC,yC,xC,wC,bC,TC,EC,SC,_C,CC,AC,MC,PC,RC,LC,OC,FC,kC,DC,IC,BC,NC,zC,UC,YC,XC,GC,HC,WC,VC,jC,qC,KC,ZC,$C,JC,QC,tA,eA,iA,nA,sA,rA,aA,oA,hA,lA,uA,cA,dA,fA,pA,gA,mA,vA,yA,xA,wA,bA,TA,EA,SA,_A,CA,AA,MA,PA,RA,LA,OA,FA,kA,DA,IA,BA,NA,zA,UA,YA,XA,GA,HA,WA,VA,jA,qA,KA,ZA,$A,JA,QA,tM,eM,iM,nM,sM,rM,aM,oM,hM,lM,uM,cM,dM,fM,pM,gM,mM,vM,yM,xM,wM,bM,TM,EM,SM,_M,CM,AM,MM,PM,RM,LM,OM,FM,kM,DM,IM,BM,NM,zM,UM,YM,XM,GM,HM,WM,VM,jM,qM,KM,ZM,$M,JM,QM,tP,eP,iP,nP,sP,rP,aP,oP,hP,lP,uP,cP,dP,fP,pP,gP,mP,vP,yP,xP,wP,bP,TP,EP,SP,_P,CP,AP,MP,PP,RP,LP,OP,FP,kP,DP,IP,BP,NP,zP,UP,YP,XP,GP,HP,WP,VP,jP,qP,KP,ZP,$P,JP,QP,tR,eR,iR,nR,sR,rR,aR,oR,hR,lR,uR,cR,dR,fR,pR,gR,mR,vR,yR,xR,wR,bR,TR,ER,SR,_R,CR,AR,MR,PR,RR,LR,OR,FR,kR,DR,IR,BR,NR,zR,UR,YR,XR,GR,HR,WR,VR,jR,qR,KR,ZR,$R,JR,QR,tL,eL,iL,nL,sL,rL,aL,oL,hL,lL,uL,cL,dL,fL,pL,gL,mL,vL,yL,xL,wL,bL,TL,EL,SL,_L,CL,AL,ML,PL,RL,LL,OL,FL,kL,DL,IL,BL,NL,zL,UL,YL,XL,GL,HL,WL,VL,jL,qL,KL,ZL,$L,JL,QL,tO,eO,iO,nO,sO,rO,aO,oO,hO,lO,uO,cO,dO,fO,pO,gO,mO,vO,yO,xO,wO,bO,TO,EO,SO,_O,CO,AO,MO,PO,RO,LO,OO,FO,kO,DO,IO,BO,NO,zO,UO,YO,XO,GO,HO,WO,VO,jO,qO,KO,ZO,$O,JO,QO,tF,eF,iF,nF,sF,rF,aF,oF,hF,lF,uF,cF,dF,fF,pF,gF,mF,vF,yF,xF,wF,bF,TF,EF,SF,_F,CF,AF,MF,PF,RF,LF,OF,FF,kF,DF,IF,BF,NF,zF,UF,YF,XF,GF,HF,WF,VF,jF,qF,KF,ZF,$F,JF,QF,tk,ek,ik,nk,sk,rk,ak,ok,hk,lk,uk,ck,dk,fk,pk,gk,mk,vk,yk,xk,wk,bk,Tk,Ek,Sk,_k,Ck,Ak,Mk,Pk,Rk,Lk,Ok,Fk,kk,Dk,Ik,Bk,Nk,zk,Uk,Yk,Xk,Gk,Hk,Wk,Vk,jk,qk,Kk,Zk,$k,Jk,Qk,tD,eD,iD,nD,sD,rD,aD,oD,hD,lD,uD,cD,dD,fD,pD,gD,mD,vD,yD,xD,wD,bD,TD,ED,SD,_D,CD,AD,MD,PD,RD,LD,OD,FD,kD,DD,ID,BD,ND,zD,UD,YD,XD,GD,HD,WD,VD,jD,qD,KD,ZD,$D,JD,QD,tI,eI,iI,nI,sI,rI,aI,oI,hI,lI,uI,cI,dI,fI,pI,gI,mI,vI,yI,xI,wI,bI,TI,EI,SI,_I,CI,AI,MI,PI,RI,LI,OI,FI,kI,DI,II,BI,NI,zI,UI,YI,XI,GI,HI,WI,VI,jI,qI,KI,ZI,$I,JI,QI,tB,eB,iB,nB,sB,rB,aB,oB,hB,lB,uB,cB,dB,fB,pB,gB,mB,vB,yB,xB,wB,bB,TB,EB,SB,_B,CB,AB,MB,PB,RB,LB,OB,FB,kB,DB,IB,BB,NB,zB,UB,YB,XB,GB,HB,WB,VB,jB,qB,KB,ZB,$B,JB,QB,tN,eN,iN,nN,sN,rN,aN,oN,hN,lN,uN,cN,dN,fN,pN,gN,mN,vN,yN,xN,wN,bN,TN,EN,SN,_N,CN,AN,MN,PN,RN,LN,ON,FN,kN,DN,IN,BN,NN,zN,UN,YN,XN,GN,HN,WN,VN,jN,qN,KN,ZN,$N,JN,QN,tz,ez,iz,nz,sz,rz,az,oz,hz,lz,uz,cz,dz,fz,pz,gz,mz,vz,yz,xz,wz,bz,Tz,Ez,Sz,_z,Cz,Az,Mz,Pz,Rz,Lz,Oz,Fz,kz,Dz={exports:{}};function Iz(){return Qu||(Qu=1,function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(t,e,n,r,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new s(n,r||t,a),h=i?i+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],o]:t._events[h].push(o):(t._events[h]=o,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new n:delete t._events[e]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var t,n,s=[];if(0===this._eventsCount)return s;for(n in t=this._events)e.call(t,n)&&s.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},o.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,r=n.length,a=new Array(r);s<r;s++)a[s]=n[s].fn;return a},o.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},o.prototype.emit=function(t,e,n,s,r,a){var o=i?i+t:t;if(!this._events[o])return!1;var h,l,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,s),!0;case 5:return u.fn.call(u.context,e,n,s,r),!0;case 6:return u.fn.call(u.context,e,n,s,r,a),!0}for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,n);break;case 4:u[l].fn.call(u[l].context,e,n,s);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},o.prototype.on=function(t,e,i){return r(this,t,e,i,!1)},o.prototype.once=function(t,e,i){return r(this,t,e,i,!0)},o.prototype.removeListener=function(t,e,n,s){var r=i?i+t:t;if(!this._events[r])return this;if(!e)return a(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||s&&!o.once||n&&o.context!==n||a(this,r);else{for(var h=0,l=[],u=o.length;h<u;h++)(o[h].fn!==e||s&&!o[h].once||n&&o[h].context!==n)&&l.push(o[h]);l.length?this._events[r]=1===l.length?l[0]:l:a(this,r)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,t.exports=o}(Dz)),Dz.exports}function Bz(){return Bc?Ic:(Bc=1,Ic={ADDED_TO_SCENE:ec?tc:(ec=1,tc="addedtoscene"),DESTROY:nc?ic:(nc=1,ic="destroy"),REMOVED_FROM_SCENE:rc?sc:(rc=1,sc="removedfromscene"),VIDEO_COMPLETE:oc?ac:(oc=1,ac="complete"),VIDEO_CREATED:lc?hc:(lc=1,hc="created"),VIDEO_ERROR:cc?uc:(cc=1,uc="error"),VIDEO_LOCKED:fc?dc:(fc=1,dc="locked"),VIDEO_LOOP:gc?pc:(gc=1,pc="loop"),VIDEO_METADATA:vc?mc:(vc=1,mc="metadata"),VIDEO_PLAY:xc?yc:(xc=1,yc="play"),VIDEO_PLAYING:bc?wc:(bc=1,wc="playing"),VIDEO_SEEKED:Ec?Tc:(Ec=1,Tc="seeked"),VIDEO_SEEKING:_c?Sc:(_c=1,Sc="seeking"),VIDEO_STALLED:Ac?Cc:(Ac=1,Cc="stalled"),VIDEO_STOP:Pc?Mc:(Pc=1,Mc="stop"),VIDEO_TEXTURE:Lc?Rc:(Lc=1,Rc="textureready"),VIDEO_UNLOCKED:Fc?Oc:(Fc=1,Oc="unlocked"),VIDEO_UNSUPPORTED:Dc?kc:(Dc=1,kc="unsupported")})}function Nz(){if(zc)return Nc;zc=1;var t=Ih(),e=Gu(),i=Ju(),n=Iz(),s=Bz(),r=Au(),a=new t({Extends:n,initialize:function(t,e){n.call(this),this.scene=t,this.displayList=null,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.on(s.ADDED_TO_SCENE,this.addedToScene,this),this.on(s.REMOVED_FROM_SCENE,this.removedFromScene,this),t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new i(this)),this},setData:function(t,e){return this.data||(this.data=new i(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new i(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new i(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new i(this)),this.data.get(t)},setInteractive:function(t,e,i){return this.scene.sys.input.enable(this,t,e,i),this},disableInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.disable(this,t),this},removeInteractive:function(t){return void 0===t&&(t=!1),this.scene.sys.input.clear(this),t&&this.scene.sys.input.resetCursor(),this.input=void 0,this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return e(this)},willRender:function(t){return!(this.displayList&&this.displayList.active&&!this.displayList.willRender(t)||a.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return this.displayList?i.unshift(this.displayList.getIndex(t)):i.unshift(this.scene.sys.displayList.getIndex(t)),i},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(s.ADDED_TO_SCENE,this,this.scene),t.events.emit(r.ADDED_TO_SCENE,this,this.scene)),this},addToUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.add(this),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t&&t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(s.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(r.REMOVED_FROM_SCENE,this,this.scene)),this},removeFromUpdateList:function(){return this.scene&&this.preUpdate&&this.scene.sys.updateList.remove(this),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){this.scene&&!this.ignoreDestroy&&(void 0===t&&(t=!1),this.preDestroy&&this.preDestroy.call(this),this.emit(s.DESTROY,this,t),this.removeAllListeners(),this.postPipelines&&this.resetPostPipeline(!0),this.removeFromDisplayList(),this.removeFromUpdateList(),this.input&&(this.scene.sys.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),this.preFX&&(this.preFX.destroy(),this.preFX=void 0),this.postFX&&(this.postFX.destroy(),this.postFX=void 0),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0)}});return a.RENDER_MASK=15,Nc=a}function zz(){if(Yc)return Uc;Yc=1;var t=Go(),e=qh(),i=Bh(),n=Ih(),s=Zu(),r=Nz(),a=Eu(),o=cu(),h=new n({Extends:r,Mixins:[s.Depth,s.GetBounds,s.Origin,s.Transform,s.ScrollFactor,s.Visible],initialize:function(e,i,n,s,a){void 0===s&&(s=1),void 0===a&&(a=s),r.call(this,e,"Zone"),this.setPosition(i,n),this.width=s,this.height=a,this.blendMode=t.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,i){void 0===i&&(i=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var n=this.input;return i&&n&&!n.customHitArea&&(n.hitArea.width=t,n.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new e(0,0,t),i)},setRectangleDropZone:function(t,e){return this.setDropZone(new a(0,0,t,e),o)},setDropZone:function(t,e){return this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(t,e,i){i.addToRenderList(e)},renderWebGL:function(t,e,i){i.addToRenderList(e)}});return Uc=h}function Uz(){if(Gc)return Xc;Gc=1;var t=Fh(),e=qo(),i=kh(),n=Dh(),s=new(zz())({sys:{queueDepthSort:n,events:{once:n}}},0,0,1,1).setOrigin(0,0);return Xc=function(n,r){void 0===r&&(r={});var a=r.hasOwnProperty("width"),o=r.hasOwnProperty("height"),h=i(r,"width",-1),l=i(r,"height",-1),u=i(r,"cellWidth",1),c=i(r,"cellHeight",u),d=i(r,"position",e.TOP_LEFT),f=i(r,"x",0),p=i(r,"y",0),g=0,m=0,v=h*u,y=l*c;s.setPosition(f,p),s.setSize(u,c);for(var x=0;x<n.length;x++)if(t(n[x],s,d),a&&-1===h)s.x+=u;else if(o&&-1===l)s.y+=c;else if(o&&!a){if(m+=c,s.y+=c,m===y&&(m=0,g+=u,s.y=p,s.x+=u,g===v))break}else if(g+=u,s.x+=u,g===v&&(g=0,m+=c,s.x=f,s.y+=c,m===y))break;return n},Xc}function Yz(){if(Wc)return Hc;Wc=1;var t=bh();return Hc=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function Xz(){if(jc)return Vc;jc=1;var t=bh();return Vc=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function Gz(){if(Kc)return qc;Kc=1;var t=bh();return qc=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function Hz(){if($c)return Zc;$c=1;var t=bh();return Zc=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function Wz(){return nd?id:(nd=1,id=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)})}function Vz(){return cd?ud:(cd=1,ud={In:rd?sd:(rd=1,sd=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}),Out:od?ad:(od=1,ad=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}),InOut:ld?hd:(ld=1,hd=function(t,e){void 0===e&&(e=1.70158);var i=1.525*e;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)})})}function jz(){return xd?yd:(xd=1,yd={In:fd?dd:(fd=1,dd=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),Out:gd?pd:(gd=1,pd=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),InOut:vd?md:(vd=1,md=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})})}function qz(){return Ad?Cd:(Ad=1,Cd={In:bd?wd:(bd=1,wd=function(t){return 1-Math.sqrt(1-t*t)}),Out:Ed?Td:(Ed=1,Td=function(t){return Math.sqrt(1- --t*t)}),InOut:_d?Sd:(_d=1,Sd=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})})}function Kz(){return Dd?kd:(Dd=1,kd={In:Pd?Md:(Pd=1,Md=function(t){return t*t*t}),Out:Ld?Rd:(Ld=1,Rd=function(t){return--t*t*t+1}),InOut:Fd?Od:(Fd=1,Od=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)})})}function Zz(){return Gd?Xd:(Gd=1,Xd={In:Bd?Id:(Bd=1,Id=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)}),Out:zd?Nd:(zd=1,Nd=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-n)*(2*Math.PI)/i)+1}),InOut:Yd?Ud:(Yd=1,Ud=function(t,e,i){if(void 0===e&&(e=.1),void 0===i&&(i=.1),0===t)return 0;if(1===t)return 1;var n=i/4;return e<1?e=1:n=i*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-n)*(2*Math.PI)/i)*.5+1})})}function $z(){return $d?Zd:($d=1,Zd={In:Wd?Hd:(Wd=1,Hd=function(t){return Math.pow(2,10*(t-1))-.001}),Out:jd?Vd:(jd=1,Vd=function(t){return 1-Math.pow(2,-10*t)}),InOut:Kd?qd:(Kd=1,qd=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})})}function Jz(){return ef?tf:(ef=1,tf=Qd?Jd:(Qd=1,Jd=function(t){return t}))}function Qz(){return uf?lf:(uf=1,lf={In:sf?nf:(sf=1,nf=function(t){return t*t}),Out:af?rf:(af=1,rf=function(t){return t*(2-t)}),InOut:hf?of:(hf=1,of=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)})})}function tU(){return yf?vf:(yf=1,vf={In:df?cf:(df=1,cf=function(t){return t*t*t*t}),Out:pf?ff:(pf=1,ff=function(t){return 1- --t*t*t*t}),InOut:mf?gf:(mf=1,gf=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)})})}function eU(){return Cf?_f:(Cf=1,_f={In:wf?xf:(wf=1,xf=function(t){return t*t*t*t*t}),Out:Tf?bf:(Tf=1,bf=function(t){return--t*t*t*t*t+1}),InOut:Sf?Ef:(Sf=1,Ef=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)})})}function iU(){return kf?Ff:(kf=1,Ff={In:Mf?Af:(Mf=1,Af=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}),Out:Rf?Pf:(Rf=1,Pf=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}),InOut:Of?Lf:(Of=1,Lf=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))})})}function nU(){return Nf?Bf:(Nf=1,Bf=If?Df:(If=1,Df=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}))}function sU(){if(Uf)return zf;Uf=1;var t=Vz(),e=jz(),i=qz(),n=Kz(),s=Zz(),r=$z(),a=Jz(),o=Qz(),h=tU(),l=eU(),u=iU(),c=nU();return zf={Power0:a,Power1:o.Out,Power2:n.Out,Power3:h.Out,Power4:l.Out,Linear:a,Quad:o.Out,Cubic:n.Out,Quart:h.Out,Quint:l.Out,Sine:u.Out,Expo:r.Out,Circ:i.Out,Elastic:s.Out,Back:t.Out,Bounce:e.Out,Stepped:c,"Quad.easeIn":o.In,"Cubic.easeIn":n.In,"Quart.easeIn":h.In,"Quint.easeIn":l.In,"Sine.easeIn":u.In,"Expo.easeIn":r.In,"Circ.easeIn":i.In,"Elastic.easeIn":s.In,"Back.easeIn":t.In,"Bounce.easeIn":e.In,"Quad.easeOut":o.Out,"Cubic.easeOut":n.Out,"Quart.easeOut":h.Out,"Quint.easeOut":l.Out,"Sine.easeOut":u.Out,"Expo.easeOut":r.Out,"Circ.easeOut":i.Out,"Elastic.easeOut":s.Out,"Back.easeOut":t.Out,"Bounce.easeOut":e.Out,"Quad.easeInOut":o.InOut,"Cubic.easeInOut":n.InOut,"Quart.easeInOut":h.InOut,"Quint.easeInOut":l.InOut,"Sine.easeInOut":u.InOut,"Expo.easeInOut":r.InOut,"Circ.easeInOut":i.InOut,"Elastic.easeInOut":s.InOut,"Back.easeInOut":t.InOut,"Bounce.easeInOut":e.InOut}}function rU(){return Xf?Yf:(Xf=1,Yf=function(t){return t&&t[0].toUpperCase()+t.slice(1)})}function aU(){if(Hf)return Gf;Hf=1;var t=sU(),e=rU();return Gf=function(i,n){var s=t.Power0;if("string"==typeof i)if(t.hasOwnProperty(i))s=t[i];else{var r="";if(i.indexOf(".")){var a=(r=i.substring(i.indexOf(".")+1)).toLowerCase();"in"===a?r="easeIn":"out"===a?r="easeOut":"inout"===a&&(r="easeInOut")}i=e(i.substring(0,i.indexOf(".")+1)+r),t.hasOwnProperty(i)&&(s=t[i])}else"function"==typeof i&&(s=i);if(!n)return s;var o=n.slice(0);return o.unshift(0),function(t){return o[0]=t,s.apply(this,o)}}}function oU(){if(Vf)return Wf;Vf=1;var t=Wz(),e=aU(),i=zh();return Wf=function(n,s,r,a,o){void 0===a&&(a=0),void 0===o&&(o=[]);var h,l,u=[],c=n.x1,d=n.y1,f=n.x2-c,p=n.y2-d,g=e(s,o),m=r-1;for(h=0;h<m;h++)l=g(h/m),u.push(new i(c+f*l,d+p*l));if(l=g(1),u.push(new i(c+f*l,d+p*l)),a>0){var v=u[0],y=[v];for(h=1;h<u.length-1;h++){var x=u[h];t(v,x)>=a&&(y.push(x),v=x)}var w=u[u.length-1];return t(v,w)<a&&y.pop(),y.push(w),y}return u},Wf}function hU(){if(qf)return jf;qf=1;var t=vu(),e=oU();return jf=function(i,n,s){var r;r=s?e(n,s,i.length):t(n,i.length);for(var a=0;a<i.length;a++){var o=i[a],h=r[a];o.x=h.x,o.y=h.y}return i},jf}function lU(){if(Zf)return Kf;Zf=1;var t=du(),e=zh();return Kf=function(i,n,s,r){if(void 0===r&&(r=[]),!n&&!s)return r;n?s=Math.round(t(i)/n):n=t(i)/s;for(var a=i.x,o=i.y,h=0,l=0;l<s;l++)switch(r.push(new e(a,o)),h){case 0:(a+=n)>=i.right&&(h=1,o+=a-i.right,a=i.right);break;case 1:(o+=n)>=i.bottom&&(h=2,a-=o-i.bottom,o=i.bottom);break;case 2:(a-=n)<=i.left&&(h=3,o-=i.left-a,a=i.left);break;case 3:(o-=n)<=i.top&&(h=0,o=i.top)}return r}}function uU(){if(Jf)return $f;Jf=1;var t=lU(),e=al(),i=ol();return $f=function(n,s,r){void 0===r&&(r=0);var a=t(s,!1,n.length);r>0?e(a,r):r<0&&i(a,Math.abs(r));for(var o=0;o<n.length;o++)n[o].x=a[o].x,n[o].y=a[o].y;return n}}function cU(){return tp||(tp=1,Qf=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=[]);var n=Math.round(t.x1),s=Math.round(t.y1),r=Math.round(t.x2),a=Math.round(t.y2),o=Math.abs(r-n),h=Math.abs(a-s),l=n<r?1:-1,u=s<a?1:-1,c=o-h;i.push({x:n,y:s});for(var d=1;n!==r||s!==a;){var f=c<<1;f>-h&&(c-=h,n+=l),f<o&&(c+=o,s+=u),d%e===0&&i.push({x:n,y:s}),d++}return i}),Qf}function dU(){if(ip)return ep;ip=1;var t=cU();return ep=function(e,i,n){var s=t({x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},n),r=t({x1:i.x2,y1:i.y2,x2:i.x3,y2:i.y3},n),a=t({x1:i.x3,y1:i.y3,x2:i.x1,y2:i.y1},n);s.pop(),r.pop(),a.pop();for(var o=(s=s.concat(r,a)).length/e.length,h=0,l=0;l<e.length;l++){var u=e[l],c=s[Math.floor(h)];u.x=c.x,u.y=c.y,h+=o}return e},ep}function fU(){return ap?rp:(ap=1,rp=function(t,e,i,n,s,r){var a;void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=1);var o=0,h=t.length;if(1===r)for(a=s;a<h;a++)t[a][e]=i+o*n,o++;else for(a=s;a>=0;a--)t[a][e]=i+o*n,o++;return t})}function pU(){if(hp)return op;hp=1;var t=jh();return op=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},op}function gU(){if(up)return lp;up=1;var t=zh();return lp=function(e,i){void 0===i&&(i=new t);var n=Math.random()*Math.PI*2,s=Math.sqrt(Math.random());return i.x=e.x+s*Math.cos(n)*e.width/2,i.y=e.y+s*Math.sin(n)*e.height/2,i},lp}function mU(){if(dp)return cp;dp=1;var t=gU();return cp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},cp}function vU(){if(pp)return fp;pp=1;var t=yu();return fp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},fp}function yU(){if(mp)return gp;mp=1;var t=Tu();return gp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e}}function xU(){if(yp)return vp;yp=1;var t=zh();return vp=function(e,i){void 0===i&&(i=new t);var n=e.x2-e.x1,s=e.y2-e.y1,r=e.x3-e.x1,a=e.y3-e.y1,o=Math.random(),h=Math.random();return o+h>=1&&(o=1-o,h=1-h),i.x=e.x1+(n*o+r*h),i.y=e.y1+(s*o+a*h),i},vp}function wU(){if(wp)return xp;wp=1;var t=xU();return xp=function(e,i){for(var n=0;n<e.length;n++)t(i,e[n]);return e},xp}function bU(){if(Tp)return bp;Tp=1;var t=bh();return bp=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function TU(){return Sp||(Sp=1,Ep=function(t,e,i,n,s){var r=n+Math.atan2(t.y-i,t.x-e);return t.x=e+s*Math.cos(r),t.y=i+s*Math.sin(r),t}),Ep}function EU(){return Cp?_p:(Cp=1,_p=function(t,e,i,n){var s=t-i,r=e-n;return Math.sqrt(s*s+r*r)})}function SU(){if(Mp)return Ap;Mp=1;var t=TU(),e=EU();return Ap=function(i,n,s){for(var r=n.x,a=n.y,o=0;o<i.length;o++){var h=i[o];t(h,r,a,s,Math.max(1,e(h.x,h.y,r,a)))}return i},Ap}function _U(){if(Rp)return Pp;Rp=1;var t=TU();return Pp=function(e,i,n,s){var r=i.x,a=i.y;if(0===s)return e;for(var o=0;o<e.length;o++)t(e[o],r,a,n,s);return e},Pp}function CU(){if(Op)return Lp;Op=1;var t=bh();return Lp=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function AU(){if(kp)return Fp;kp=1;var t=bh();return Fp=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function MU(){if(Ip)return Dp;Ip=1;var t=bh();return Dp=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function PU(){if(Np)return Bp;Np=1;var t=fU();return Bp=function(e,i,n,s,r){return t(e,"alpha",i,n,s,r)}}function RU(){if(Up)return zp;Up=1;var t=fU();return zp=function(e,i,n,s){return t(e,"blendMode",i,0,n,s)}}function LU(){if(Xp)return Yp;Xp=1;var t=fU();return Yp=function(e,i,n,s,r){return t(e,"depth",i,n,s,r)}}function OU(){if(Vp)return Wp;Vp=1;var t=fU();return Wp=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"originX",i,s,a,o),t(e,"originY",n,r,a,o),e.forEach(function(t){t.updateDisplayOrigin()}),e}}function FU(){if(qp)return jp;qp=1;var t=fU();return jp=function(e,i,n,s,r){return t(e,"rotation",i,n,s,r)}}function kU(){if(Zp)return Kp;Zp=1;var t=fU();return Kp=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scaleX",i,s,a,o),t(e,"scaleY",n,r,a,o)}}function DU(){if(Jp)return $p;Jp=1;var t=fU();return $p=function(e,i,n,s,r){return t(e,"scaleX",i,n,s,r)}}function IU(){if(tg)return Qp;tg=1;var t=fU();return Qp=function(e,i,n,s,r){return t(e,"scaleY",i,n,s,r)}}function BU(){if(ig)return eg;ig=1;var t=fU();return eg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"scrollFactorX",i,s,a,o),t(e,"scrollFactorY",n,r,a,o)}}function NU(){if(sg)return ng;sg=1;var t=fU();return ng=function(e,i,n,s,r){return t(e,"scrollFactorX",i,n,s,r)}}function zU(){if(ag)return rg;ag=1;var t=fU();return rg=function(e,i,n,s,r){return t(e,"scrollFactorY",i,n,s,r)}}function UU(){if(ug)return lg;ug=1;var t=fU();return lg=function(e,i,n,s){return t(e,"visible",i,0,n,s)}}function YU(){if(dg)return cg;dg=1;var t=fU();return cg=function(e,i,n,s,r){return t(e,"x",i,n,s,r)}}function XU(){if(pg)return fg;pg=1;var t=fU();return fg=function(e,i,n,s,r,a,o){return null==n&&(n=i),t(e,"x",i,s,a,o),t(e,"y",n,r,a,o)}}function GU(){if(mg)return gg;mg=1;var t=fU();return gg=function(e,i,n,s,r){return t(e,"y",i,n,s,r)}}function HU(){if(yg)return vg;yg=1;var t=wu();return vg=function(e,i,n,s,r){var a,o;void 0===s&&(s=0),void 0===r&&(r=new t);var h=e.length;if(1===h)a=e[0].x,o=e[0].y,e[0].x=i,e[0].y=n;else{var l=1,u=0;0===s&&(u=h-1,l=h-2),a=e[u].x,o=e[u].y,e[u].x=i,e[u].y=n;for(var c=0;c<h;c++)if(!(l>=h||-1===l)){var d=e[l],f=d.x,p=d.y;d.x=a,d.y=o,a=f,o=p,0===s?l--:l++}}return r.x=a,r.y=o,r}}function WU(){if(wg)return xg;wg=1;var t=El();return xg=function(e){return t(e)}}function VU(){return Tg?bg:(Tg=1,bg=function(t,e,i){return(t=Math.max(0,Math.min(1,(t-e)/(i-e))))*t*t*(t*(6*t-15)+10)})}function jU(){if(Sg)return Eg;Sg=1;var t=VU();return Eg=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function qU(){return Cg?_g:(Cg=1,_g=function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)})}function KU(){if(Mg)return Ag;Mg=1;var t=qU();return Ag=function(e,i,n,s,r){void 0===r&&(r=!1);var a,o=Math.abs(s-n)/e.length;if(r)for(a=0;a<e.length;a++)e[a][i]+=t(a*o,n,s);else for(a=0;a<e.length;a++)e[a][i]=t(a*o,n,s);return e}}function ZU(){if(kg)return Fg;kg=1;var t=Vu();return Fg=function(e,i,n){void 0===n&&(n=0);for(var s=0;s<e.length;s++){var r=e[s];r.x=t(r.x,i.left-n,i.right+n),r.y=t(r.y,i.top-n,i.bottom+n)}return e}}function $U(){return Ig?Dg:(Ig=1,Dg={AlignTo:wh(),Angle:Th(),Call:zt?Nt:(zt=1,Nt=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];e.call(i,s)}return t}),GetFirst:Yt?Ut:(Yt=1,Ut=function(t,e,i){void 0===i&&(i=0);for(var n=i;n<t.length;n++){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}),GetLast:Gt?Xt:(Gt=1,Xt=function(t,e,i){void 0===i&&(i=0);for(var n=t.length-1;n>=i;n--){var s=t[n],r=!0;for(var a in e)s[a]!==e[a]&&(r=!1);if(r)return s}return null}),GridAlign:Uz(),IncAlpha:Yz(),IncX:Xz(),IncXY:Gz(),IncY:Hz(),PlaceOnCircle:(Qc||(Qc=1,Jc=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.x,o=e.y,h=e.radius,l=0;l<t.length;l++)t[l].x=a+h*Math.cos(s),t[l].y=o+h*Math.sin(s),s+=r;return t}),Jc),PlaceOnEllipse:(ed||(ed=1,td=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=6.28);for(var s=i,r=(n-i)/t.length,a=e.width/2,o=e.height/2,h=0;h<t.length;h++)t[h].x=e.x+a*Math.cos(s),t[h].y=e.y+o*Math.sin(s),s+=r;return t}),td),PlaceOnLine:hU(),PlaceOnRectangle:uU(),PlaceOnTriangle:dU(),PlayAnimation:sp?np:(sp=1,np=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n];s.anims&&s.anims.play(e,i)}return t}),PropertyValueInc:bh(),PropertyValueSet:fU(),RandomCircle:pU(),RandomEllipse:mU(),RandomLine:vU(),RandomRectangle:yU(),RandomTriangle:wU(),Rotate:bU(),RotateAround:SU(),RotateAroundDistance:_U(),ScaleX:CU(),ScaleXY:AU(),ScaleY:MU(),SetAlpha:PU(),SetBlendMode:RU(),SetDepth:LU(),SetHitArea:Hp?Gp:(Hp=1,Gp=function(t,e,i){for(var n=0;n<t.length;n++)t[n].setInteractive(e,i);return t}),SetOrigin:OU(),SetRotation:FU(),SetScale:kU(),SetScaleX:DU(),SetScaleY:IU(),SetScrollFactor:BU(),SetScrollFactorX:NU(),SetScrollFactorY:zU(),SetTint:hg?og:(hg=1,og=function(t,e,i,n,s){for(var r=0;r<t.length;r++)t[r].setTint(e,i,n,s);return t}),SetVisible:UU(),SetX:YU(),SetXY:XU(),SetY:GU(),ShiftPosition:HU(),Shuffle:WU(),SmootherStep:jU(),SmoothStep:KU(),Spread:Rg?Pg:(Rg=1,Pg=function(t,e,i,n,s){if(void 0===s&&(s=!1),0===t.length)return t;if(1===t.length)return s?t[0][e]+=(n+i)/2:t[0][e]=(n+i)/2,t;var r,a=Math.abs(n-i)/(t.length-1);if(s)for(r=0;r<t.length;r++)t[r][e]+=r*a+i;else for(r=0;r<t.length;r++)t[r][e]=r*a+i;return t}),ToggleVisible:Og?Lg:(Og=1,Lg=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}),WrapInRectangle:ZU()})}function JU(){return am?rm:(am=1,rm={ADD_ANIMATION:Ng?Bg:(Ng=1,Bg="add"),ANIMATION_COMPLETE:Ug?zg:(Ug=1,zg="animationcomplete"),ANIMATION_COMPLETE_KEY:Xg?Yg:(Xg=1,Yg="animationcomplete-"),ANIMATION_REPEAT:Hg?Gg:(Hg=1,Gg="animationrepeat"),ANIMATION_RESTART:Vg?Wg:(Vg=1,Wg="animationrestart"),ANIMATION_START:qg?jg:(qg=1,jg="animationstart"),ANIMATION_STOP:Zg?Kg:(Zg=1,Kg="animationstop"),ANIMATION_UPDATE:Jg?$g:(Jg=1,$g="animationupdate"),PAUSE_ALL:tm?Qg:(tm=1,Qg="pauseall"),REMOVE_ANIMATION:im?em:(im=1,em="remove"),RESUME_ALL:sm?nm:(sm=1,nm="resumeall")})}function QU(){if(hm)return om;hm=1;var t=new(Ih())({initialize:function(t,e,i,n,s){void 0===s&&(s=!1),this.textureKey=t,this.textureFrame=e,this.index=i,this.frame=n,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0,this.isKeyFrame=s},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration,keyframe:this.isKeyFrame}},destroy:function(){this.frame=void 0}});return om=t}function tY(){if(um)return lm;um=1;var t=Yh(),e=Ih(),i=JU(),n=fl(),s=QU(),r=Tl(),a=Ll(),o=new e({initialize:function(t,e,n){this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,r(n,"frames",[]),r(n,"defaultTextureKey",null),r(n,"sortFrames",!0)),this.frameRate=r(n,"frameRate",null),this.duration=r(n,"duration",null),this.msPerFrame,this.skipMissedFrames=r(n,"skipMissedFrames",!0),this.delay=r(n,"delay",0),this.repeat=r(n,"repeat",0),this.repeatDelay=r(n,"repeatDelay",0),this.yoyo=r(n,"yoyo",!1),this.showBeforeDelay=r(n,"showBeforeDelay",!1),this.showOnStart=r(n,"showOnStart",!1),this.hideOnComplete=r(n,"hideOnComplete",!1),this.randomFrame=r(n,"randomFrame",!1),this.paused=!1,this.calculateDuration(this,this.getTotalFrames(),this.duration,this.frameRate),this.manager.on&&(this.manager.on(i.PAUSE_ALL,this.pause,this),this.manager.on(i.RESUME_ALL,this.resume,this))},getTotalFrames:function(){return this.frames.length},calculateDuration:function(t,e,i,n){null===i&&null===n?(t.frameRate=24,t.duration=24/e*1e3):i&&null===n?(t.duration=i,t.frameRate=e/(i/1e3)):(t.frameRate=n,t.duration=e/n*1e3),t.msPerFrame=1e3/t.frameRate},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var i=this.getFrames(this.manager.textureManager,e);if(i.length>0){if(0===t)this.frames=i.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(i);else{var n=this.frames.slice(0,t),s=this.frames.slice(t);this.frames=n.concat(i,s)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},getFirstTick:function(t){t.accumulator=0,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,i,n){void 0===n&&(n=!0);var o,h,l,u,c=[],d=1;if("string"==typeof e){if(u=e,!t.exists(u))return console.warn('Texture "%s" not found',u),c;var f=t.get(u).getFrameNames();n&&a(f),e=[],f.forEach(function(t){e.push({key:u,frame:t})})}if(!Array.isArray(e)||0===e.length)return c;for(l=0;l<e.length;l++){var p=e[l],g=r(p,"key",i);if(g){var m=r(p,"frame",0),v=t.getFrame(g,m);v?((h=new s(g,m,d,v)).duration=r(p,"duration",0),h.isFirst=!o,o&&(o.nextFrame=h,h.prevFrame=o),c.push(h),o=h,d++):console.warn('Texture "%s" not found',g)}}if(c.length>0){h.isLast=!0,h.nextFrame=c[0],c[0].prevFrame=h;var y=1/(c.length-1);for(l=0;l<c.length;l++)c[l].progress=l*y}return c},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.frameRate===t.currentAnim.frameRate&&t.currentFrame.duration||t.msPerFrame},getFrameByProgress:function(e){return e=t(e,0,1),n(e,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t.yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t.inReverse&&t.forward?t.forward=!1:this.repeatAnimation(t):t.complete():this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t.inReverse===!e&&t.repeatCounter>0)return(0===t.repeatDelay||t.pendingRepeat)&&(t.forward=e),void this.repeatAnimation(t);if(t.inReverse===e||0!==t.repeatCounter){t.forward=e;var i=e?t.currentFrame.nextFrame:t.currentFrame.prevFrame;this.updateAndGetNextTick(t,i)}else t.complete()},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t.yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?(t.inReverse&&!t.forward||(t.forward=!0),this.repeatAnimation(t)):t.complete():this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.setCurrentFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop){if(0===t._pendingStopValue)return t.stop();t._pendingStopValue--}t.repeatDelay>0&&!t.pendingRepeat?(t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t.repeatDelay):(t.repeatCounter--,t.forward?t.setCurrentFrame(t.currentFrame.nextFrame):t.setCurrentFrame(t.currentFrame.prevFrame),t.isPlaying&&(this.getNextTick(t),t.handleRepeat()))},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showBeforeDelay:this.showBeforeDelay,showOnStart:this.showOnStart,randomFrame:this.randomFrame,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(e){t.frames.push(e.toJSON())}),t},updateFrameSequence:function(){for(var t,e=this.frames.length,i=1/(e-1),n=0;n<e;n++)(t=this.frames[n]).index=n+1,t.isFirst=!1,t.isLast=!1,t.progress=n*i,0===n?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[n+1])):n===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[n-1],t.nextFrame=this.frames[n+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.manager.off&&(this.manager.off(i.PAUSE_ALL,this.pause,this),this.manager.off(i.RESUME_ALL,this.resume,this)),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});return lm=o}function eY(){if(dm)return cm;dm=1;var t=new(Ih())({initialize:function(t){this.entries={},this.size=0,this.setAll(t)},setAll:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1]);return this},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(t){delete this.entries[t]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var i in e)t.push(e[i]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var i in e)if(!1===t(i,e[i]))break;return this},contains:function(t){var e=this.entries;for(var i in e)if(e[i]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var i=this.entries,n=t.entries;for(var s in n)i.hasOwnProperty(s)&&e?i[s]=n[s]:this.set(s,n[s]);return this}});return cm=t}function iY(){return Vm?Wm:(Vm=1,Wm={BLUR:pm?fm:(pm=1,fm="blur"),BOOT:mm?gm:(mm=1,gm="boot"),CONTEXT_LOST:ym?vm:(ym=1,vm="contextlost"),DESTROY:wm?xm:(wm=1,xm="destroy"),FOCUS:Tm?bm:(Tm=1,bm="focus"),HIDDEN:Sm?Em:(Sm=1,Em="hidden"),PAUSE:Cm?_m:(Cm=1,_m="pause"),POST_RENDER:Mm?Am:(Mm=1,Am="postrender"),POST_STEP:Rm?Pm:(Rm=1,Pm="poststep"),PRE_RENDER:Om?Lm:(Om=1,Lm="prerender"),PRE_STEP:km?Fm:(km=1,Fm="prestep"),READY:Im?Dm:(Im=1,Dm="ready"),RESUME:Nm?Bm:(Nm=1,Bm="resume"),STEP:Um?zm:(Um=1,zm="step"),SYSTEM_READY:Xm?Ym:(Xm=1,Ym="systemready"),VISIBLE:Hm?Gm:(Hm=1,Gm="visible")})}function nY(){if(qm)return jm;qm=1;var t=tY(),e=Ih(),i=eY(),n=Iz(),s=JU(),r=iY(),a=kh(),o=Tl(),h=Gh(),l=yl(),u=Qh(),c=new e({Extends:n,initialize:function(t){n.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new i,this.mixes=new i,this.paused=!1,this.name="AnimationManager",t.events.once(r.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(r.DESTROY,this.destroy,this)},addMix:function(t,e,i){var n=this.anims,s=this.mixes,r="string"==typeof t?t:t.key,a="string"==typeof e?e:e.key;if(n.has(r)&&n.has(a)){var o=s.get(r);o||(o={}),o[a]=i,s.set(r,o)}return this},removeMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s=i.get(n);if(s)if(e){var r="string"==typeof e?e:e.key;s.hasOwnProperty(r)&&delete s[r]}else e||i.delete(n);return this},getMix:function(t,e){var i=this.mixes,n="string"==typeof t?t:t.key,s="string"==typeof e?e:e.key,r=i.get(n);return r&&r.hasOwnProperty(s)?r[s]:0},add:function(t,e){return this.anims.has(t)?(console.warn("Animation key exists: "+t),this):(e.key=t,this.anims.set(t,e),this.emit(s.ADD_ANIMATION,t,e),this)},exists:function(t){return this.anims.has(t)},createFromAseprite:function(t,e,i){var n=[],s=this.game.cache.json.get(t);if(!s)return console.warn("No Aseprite data found for: "+t),n;var r=this,l=o(s,"meta",null),u=o(s,"frames",null);return l&&u&&o(l,"frameTags",[]).forEach(function(s){var o=[],l=a(s,"name",null),c=a(s,"from",0),d=a(s,"to",0),f=a(s,"direction","forward");if(l&&(!e||e&&e.indexOf(l)>-1)){for(var p=0,g=c;g<=d;g++){var m=g.toString(),v=u[m];if(v){var y=a(v,"duration",h.MAX_SAFE_INTEGER);o.push({key:t,frame:m,duration:y}),p+=y}}"reverse"===f&&(o=o.reverse());var x,w={key:l,frames:o,duration:p,yoyo:"pingpong"===f};i?i.anims&&(x=i.anims.create(w)):x=r.create(w),x&&n.push(x)}}),n},create:function(e){var i=e.key,n=!1;return i&&((n=this.get(i))?console.warn("AnimationManager key already exists: "+i):(n=new t(this,i,e),this.anims.set(i,n),this.emit(s.ADD_ANIMATION,i,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"==typeof t&&(t=JSON.parse(t));var i=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var n=0;n<t.anims.length;n++)i.push(this.create(t.anims[n]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&i.push(this.create(t));return i},generateFrameNames:function(t,e){var i=o(e,"prefix",""),n=o(e,"start",0),s=o(e,"end",0),r=o(e,"suffix",""),a=o(e,"zeroPad",0),h=o(e,"outputArray",[]),c=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),h;var d,f=this.textureManager.get(t);if(!f)return h;if(e)for(c||(c=l(n,s)),d=0;d<c.length;d++){var p=i+u(c[d],a,"0",1)+r;f.has(p)?h.push({key:t,frame:p}):console.warn('Frame "%s" not found in texture "%s"',p,t)}else for(c=f.getFrameNames(),d=0;d<c.length;d++)h.push({key:t,frame:c[d]});return h},generateFrameNumbers:function(t,e){var i=o(e,"start",0),n=o(e,"end",-1),s=o(e,"first",!1),r=o(e,"outputArray",[]),a=o(e,"frames",!1);if(!this.textureManager.exists(t))return console.warn('Texture "%s" not found',t),r;var h=this.textureManager.get(t);if(!h)return r;s&&h.has(s)&&r.push({key:t,frame:s}),a||(-1===n&&(n=h.frameTotal-2),a=l(i,n));for(var u=0;u<a.length;u++){var c=a[u];h.has(c)?r.push({key:t,frame:c}):console.warn('Frame "%s" not found in texture "%s"',c,t)}return r},get:function(t){return this.anims.get(t)},getAnimsFromTexture:function(t){for(var e=this.textureManager.get(t).key,i=this.anims.getArray(),n=[],s=0;s<i.length;s++)for(var r=i[s],a=r.frames,o=0;o<a.length;o++)if(a[o].textureKey===e){n.push(r.key);break}return n},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(s.PAUSE_ALL)),this},play:function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)e[i].anims.play(t);return this},staggerPlay:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var s=e.length;n||s--;for(var r=0;r<e.length;r++){var a=i<0?Math.abs(i)*(s-r):i*r;e[r].anims.playAfterDelay(t,a)}return this},remove:function(t){var e=this.get(t);return e&&(this.emit(s.REMOVE_ANIMATION,t,e),this.anims.delete(t),this.removeMix(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(s.RESUME_ALL)),this},toJSON:function(t){var e={anims:[],globalTimeScale:this.globalTimeScale};return void 0!==t&&""!==t?e.anims.push(this.anims.get(t).toJSON()):this.anims.each(function(t,i){e.anims.push(i.toJSON())}),e},destroy:function(){this.anims.clear(),this.mixes.clear(),this.textureManager=null,this.game=null}});return jm=c}function sY(){return Zm?Km:(Zm=1,Km=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)})}function rY(){if(Jm)return $m;Jm=1;var t=tY(),e=sY(),i=Ih(),n=eY(),s=JU(),r=kh(),a=new i({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.on(s.REMOVE_ANIMATION,this.globalRemove,this),this.textureManager=this.animationManager.textureManager,this.anims=null,this.isPlaying=!1,this.hasStarted=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this.nextAnimsQueue=[],this.timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this.randomFrame=!1,this.delay=0,this.repeat=0,this.repeatDelay=0,this.yoyo=!1,this.showBeforeDelay=!1,this.showOnStart=!1,this.hideOnComplete=!1,this.forward=!0,this.inReverse=!1,this.accumulator=0,this.nextTick=0,this.delayCounter=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0,this._pendingStopValue},chain:function(t){var e=this.parent;if(void 0===t)return this.nextAnimsQueue.length=0,this.nextAnim=null,e;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];this.nextAnim?this.nextAnimsQueue.push(n):this.nextAnim=n}return this.parent},getName:function(){return this.currentAnim?this.currentAnim.key:""},getFrameName:function(){return this.currentFrame?this.currentFrame.textureFrame:""},load:function(t){this.isPlaying&&this.stop();var i=this.animationManager,n="string"==typeof t?t:r(t,"key",null),s=this.exists(n)?this.get(n):i.get(n);if(s){this.currentAnim=s;var a=s.getTotalFrames(),o=r(t,"frameRate",s.frameRate),h=r(t,"duration",s.duration);s.calculateDuration(this,a,h,o),this.delay=r(t,"delay",s.delay),this.repeat=r(t,"repeat",s.repeat),this.repeatDelay=r(t,"repeatDelay",s.repeatDelay),this.yoyo=r(t,"yoyo",s.yoyo),this.showBeforeDelay=r(t,"showBeforeDelay",s.showBeforeDelay),this.showOnStart=r(t,"showOnStart",s.showOnStart),this.hideOnComplete=r(t,"hideOnComplete",s.hideOnComplete),this.skipMissedFrames=r(t,"skipMissedFrames",s.skipMissedFrames),this.randomFrame=r(t,"randomFrame",s.randomFrame),this.timeScale=r(t,"timeScale",this.timeScale);var l=r(t,"startFrame",0);l>a&&(l=0),this.randomFrame&&(l=e(0,a-1));var u=s.frames[l];0!==l||this.forward||(u=s.getLastFrame()),this.currentFrame=u}else console.warn("Missing animation: "+n);return this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.setCurrentFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.setCurrentFrame(t),this.parent},playAfterDelay:function(t,e){if(this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),this.nextAnim=t,this._pendingStop=1,this._pendingStopValue=e}else this.delayCounter=e,this.play(t,!0);return this.parent},playAfterRepeat:function(t,e){if(void 0===e&&(e=1),this.isPlaying){var i=this.nextAnim,n=this.nextAnimsQueue;i&&n.unshift(i),-1!==this.repeatCounter&&e>this.repeatCounter&&(e=this.repeatCounter),this.nextAnim=t,this._pendingStop=2,this._pendingStopValue=e}else this.play(t);return this.parent},play:function(t,e){void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent,s="string"==typeof t?t:t.key;if(e&&this.isPlaying&&i.key===s)return n;if(i&&this.isPlaying){var r=this.animationManager.getMix(i.key,t);if(r>0)return this.playAfterDelay(t,r)}return this.forward=!0,this.inReverse=!1,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t)},playReverse:function(t,e){void 0===e&&(e=!1);var i="string"==typeof t?t:t.key;return e&&this.isPlaying&&this.currentAnim.key===i?this.parent:(this.forward=!1,this.inReverse=!0,this._paused=!1,this._wasPlaying=!0,this.startAnimation(t))},startAnimation:function(t){this.load(t);var e=this.currentAnim,i=this.parent;return e?(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat,e.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!1,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.delayCounter+=this.delay,0===this.delayCounter?this.handleStart():this.showBeforeDelay&&this.setCurrentFrame(this.currentFrame),i):i},handleStart:function(){this.showOnStart&&this.parent.setVisible(!0),this.setCurrentFrame(this.currentFrame),this.hasStarted=!0,this.emitEvents(s.ANIMATION_START)},handleRepeat:function(){this.pendingRepeat=!1,this.emitEvents(s.ANIMATION_REPEAT)},handleStop:function(){this._pendingStop=0,this.isPlaying=!1,this.emitEvents(s.ANIMATION_STOP)},handleComplete:function(){this._pendingStop=0,this.isPlaying=!1,this.hideOnComplete&&this.parent.setVisible(!1),this.emitEvents(s.ANIMATION_COMPLETE,s.ANIMATION_COMPLETE_KEY)},emitEvents:function(t,e){var i=this.currentAnim;if(i){var n=this.currentFrame,s=this.parent,r=n.textureFrame;s.emit(t,i,n,s,r),e&&s.emit(e+i.key,i,n,s,r)}},reverse:function(){return this.isPlaying&&(this.inReverse=!this.inReverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame;if(!t)return 0;var e=t.progress;return this.inReverse&&(e*=-1),e},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},setRepeat:function(t){return this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},globalRemove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},restart:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var i=this.currentAnim,n=this.parent;return i?(e&&(this.repeatCounter=-1===this.repeat?Number.MAX_VALUE:this.repeat),i.getFirstTick(this),this.emitEvents(s.ANIMATION_RESTART),this.isPlaying=!0,this.pendingRepeat=!1,this.hasStarted=!t,this._pendingStop=0,this._pendingStopValue=0,this._paused=!1,this.setCurrentFrame(i.frames[0]),this.parent):n},complete:function(){if(this._pendingStop=0,this.isPlaying=!1,this.currentAnim&&this.handleComplete(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.length>0?this.nextAnimsQueue.shift():null,this.play(t)}return this.parent},stop:function(){if(this._pendingStop=0,this.isPlaying=!1,this.delayCounter=0,this.currentAnim&&this.handleStop(),this.nextAnim){var t=this.nextAnim;this.nextAnim=this.nextAnimsQueue.shift(),this.play(t)}return this.parent},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopAfterRepeat:function(t){return void 0===t&&(t=1),-1!==this.repeatCounter&&t>this.repeatCounter&&(t=this.repeatCounter),this._pendingStop=2,this._pendingStopValue=t,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},getTotalFrames:function(){return this.currentAnim?this.currentAnim.getTotalFrames():0},update:function(t,e){var i=this.currentAnim;if(this.isPlaying&&i&&!i.paused){if(this.accumulator+=e*this.timeScale*this.animationManager.globalTimeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.stop();if(this.hasStarted){if(this.accumulator>=this.nextTick&&(this.forward?i.nextFrame(this):i.previousFrame(this),this.isPlaying&&0===this._pendingStop&&this.skipMissedFrames&&this.accumulator>this.nextTick)){var n=0;do{this.forward?i.nextFrame(this):i.previousFrame(this),n++}while(this.isPlaying&&this.accumulator>this.nextTick&&n<60)}}else this.accumulator>=this.delayCounter&&(this.accumulator-=this.delayCounter,this.handleStart())}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),t.setAlpha&&(e.alpha=t.alpha),e.setSizeToFrame(),e._originComponent&&(t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin()),this.isPlaying&&this.hasStarted&&(this.emitEvents(s.ANIMATION_UPDATE),3===this._pendingStop&&this._pendingStopValue===t&&this.stop()),e},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},get:function(t){return this.anims?this.anims.get(t):null},exists:function(t){return!!this.anims&&this.anims.has(t)},create:function(e){var i=e.key,s=!1;return i&&((s=this.get(i))?console.warn("Animation key already exists: "+i):(s=new t(this,i,e),this.anims||(this.anims=new n),this.anims.set(i,s))),s},createFromAseprite:function(t,e){return this.animationManager.createFromAseprite(t,e,this.parent)},generateFrameNames:function(t,e){return this.animationManager.generateFrameNames(t,e)},generateFrameNumbers:function(t,e){return this.animationManager.generateFrameNumbers(t,e)},remove:function(t){var e=this.get(t);return e&&(this.currentAnim===e&&this.stop(),this.anims.delete(t)),e},destroy:function(){this.animationManager.off(s.REMOVE_ANIMATION,this.globalRemove,this),this.anims&&this.anims.clear(),this.animationManager=null,this.parent=null,this.nextAnim=null,this.nextAnimsQueue.length=0,this.currentAnim=null,this.currentFrame=null},isPaused:{get:function(){return this._paused}}});return $m=a}function aY(){return av?rv:(av=1,rv={ADD:iv?ev:(iv=1,ev="add"),REMOVE:sv?nv:(sv=1,nv="remove")})}function oY(){if(hv)return ov;hv=1;var t=Ih(),e=eY(),i=Iz(),n=aY(),s=new t({initialize:function(){this.entries=new e,this.events=new i},add:function(t,e){return this.entries.set(t,e),this.events.emit(n.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(n.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});return ov=s}function hY(){if(uv)return lv;uv=1;var t=oY(),e=Ih(),i=iY(),n=new e({initialize:function(e){this.game=e,this.binary=new t,this.bitmapFont=new t,this.json=new t,this.physics=new t,this.shader=new t,this.audio=new t,this.video=new t,this.text=new t,this.html=new t,this.obj=new t,this.tilemap=new t,this.xml=new t,this.custom={},this.game.events.once(i.DESTROY,this.destroy,this)},addCustom:function(e){return this.custom.hasOwnProperty(e)||(this.custom[e]=new t),this.custom[e]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var i in this.custom)this.custom[i].destroy();this.custom=null,this.game=null}});return lv=n}function lY(){if(pv)return fv;pv=1;var t=Ih(),e=Tl(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.speedX=0,this.speedY=0;var i=e(t,"speed",null);"number"==typeof i?(this.speedX=i,this.speedY=i):(this.speedX=e(t,"speed.x",0),this.speedY=e(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<this.minZoom&&(e.zoom=this.minZoom)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed,e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return fv=i}function uY(){if(mv)return gv;mv=1;var t=Ih(),e=Tl(),i=new t({initialize:function(t){this.camera=e(t,"camera",null),this.left=e(t,"left",null),this.right=e(t,"right",null),this.up=e(t,"up",null),this.down=e(t,"down",null),this.zoomIn=e(t,"zoomIn",null),this.zoomOut=e(t,"zoomOut",null),this.zoomSpeed=e(t,"zoomSpeed",.01),this.minZoom=e(t,"minZoom",.001),this.maxZoom=e(t,"maxZoom",1e3),this.accelX=0,this.accelY=0;var i=e(t,"acceleration",null);"number"==typeof i?(this.accelX=i,this.accelY=i):(this.accelX=e(t,"acceleration.x",0),this.accelY=e(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=e(t,"drag",null);"number"==typeof n?(this.dragX=n,this.dragY=n):(this.dragX=e(t,"drag.x",0),this.dragY=e(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var s=e(t,"maxSpeed",null);"number"==typeof s?(this.maxSpeedX=s,this.maxSpeedY=s):(this.maxSpeedX=e(t,"maxSpeed.x",0),this.maxSpeedY=e(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this.zoomIn&&this.zoomIn.isDown?this._zoom=-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this._zoom=this.zoomSpeed:this._zoom=0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<this.minZoom?e.zoom=this.minZoom:e.zoom>this.maxZoom&&(e.zoom=this.maxZoom))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});return gv=i}function cY(){return iy?ey:(iy=1,ey={DESTROY:wv?xv:(wv=1,xv="cameradestroy"),FADE_IN_COMPLETE:Tv?bv:(Tv=1,bv="camerafadeincomplete"),FADE_IN_START:Sv?Ev:(Sv=1,Ev="camerafadeinstart"),FADE_OUT_COMPLETE:Cv?_v:(Cv=1,_v="camerafadeoutcomplete"),FADE_OUT_START:Mv?Av:(Mv=1,Av="camerafadeoutstart"),FLASH_COMPLETE:Rv?Pv:(Rv=1,Pv="cameraflashcomplete"),FLASH_START:Ov?Lv:(Ov=1,Lv="cameraflashstart"),FOLLOW_UPDATE:kv?Fv:(kv=1,Fv="followupdate"),PAN_COMPLETE:Iv?Dv:(Iv=1,Dv="camerapancomplete"),PAN_START:Nv?Bv:(Nv=1,Bv="camerapanstart"),POST_RENDER:Uv?zv:(Uv=1,zv="postrender"),PRE_RENDER:Xv?Yv:(Xv=1,Yv="prerender"),ROTATE_COMPLETE:Hv?Gv:(Hv=1,Gv="camerarotatecomplete"),ROTATE_START:Vv?Wv:(Vv=1,Wv="camerarotatestart"),SHAKE_COMPLETE:qv?jv:(qv=1,jv="camerashakecomplete"),SHAKE_START:Zv?Kv:(Zv=1,Kv="camerashakestart"),ZOOM_COMPLETE:Jv?$v:(Jv=1,$v="camerazoomcomplete"),ZOOM_START:ty?Qv:(ty=1,Qv="camerazoomstart")})}function dY(){return sy?ny:(sy=1,ny=function(t,e,i){return t<<16|e<<8|i})}function fY(){return ay?ry:(ay=1,ry=function(t,e,i,n){return n<<24|t<<16|e<<8|i})}function pY(){if(hy)return oy;hy=1;var t=dY();function e(t,e,i,n){var s=(t+6*e)%6,r=Math.min(s,4-s,1);return Math.round(255*(n-n*i*Math.max(0,r)))}return oy=function(i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=1);var a=e(5,i,n,s),o=e(3,i,n,s),h=e(1,i,n,s);return r?r.setTo?r.setTo(a,o,h,r.alpha,!0):(r.r=a,r.g=o,r.b=h,r.color=t(a,o,h),r):{r:a,g:o,b:h,color:t(a,o,h)}}}function gY(){return uy?ly:(uy=1,ly=function(t,e,i,n){void 0===n&&(n={h:0,s:0,v:0}),t/=255,e/=255,i/=255;var s=Math.min(t,e,i),r=Math.max(t,e,i),a=r-s,o=0,h=0===r?0:a/r,l=r;return r!==s&&(r===t?o=(e-i)/a+(e<i?6:0):r===e?o=(i-t)/a+2:r===i&&(o=(t-e)/a+4),o/=6),n.hasOwnProperty("_h")?(n._h=o,n._s=h,n._v=l):(n.h=o,n.s=h,n.v=l),n})}function mY(){if(dy)return cy;dy=1;var t=Ih(),e=dY(),i=fY(),n=pY(),s=gY(),r=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,i,n)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,i,n,s){return void 0===n&&(n=255),void 0===s&&(s=!0),this._locked=!0,this.red=t,this.green=e,this.blue=i,this.alpha=n,this._locked=!1,this.update(s)},setGLTo:function(t,e,i,n){return void 0===n&&(n=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=i,this.alphaGL=n,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,i){return n(t,e,i,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var n=this.r,r=this.g,a=this.b,o=this.a;return this._color=e(n,r,a),this._color32=i(n,r,a,o),this._rgba="rgba("+n+","+r+","+a+","+o/255+")",t&&s(n,r,a,this),this},updateHSV:function(){var t=this.r,e=this.g,i=this.b;return s(t,e,i,this),this},clone:function(){return new r(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t)),n=Math.floor(t+Math.random()*(e-t)),s=Math.floor(t+Math.random()*(e-t));return this.setTo(i,n,s)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var i=Math.floor(t+Math.random()*(e-t));return this.setTo(i,i,i)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,i=this.g,n=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),this.setTo(e,i,n)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,n(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,n(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,n(this._h,this._s,t,this)}}});return cy=r}function vY(){if(py)return fy;py=1;var t=mY();return fy=function(e){var i=new t;e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(n){var s=parseInt(n[1],16),r=parseInt(n[2],16),a=parseInt(n[3],16);i.setTo(s,r,a)}return i},fy}function yY(){return my||(my=1,gy=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}}),gy}function xY(){if(yy)return vy;yy=1;var t=mY(),e=yY();return vy=function(i){var n=e(i);return new t(n.r,n.g,n.b,n.a)},vy}function wY(){if(wy)return xy;wy=1;var t=mY();return xy=function(e){return new t(e.r,e.g,e.b,e.a)},xy}function bY(){if(Ty)return by;Ty=1;var t=mY();return by=function(e){var i=new t,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase());if(n){var s=parseInt(n[1],10),r=parseInt(n[2],10),a=parseInt(n[3],10),o=void 0!==n[4]?parseFloat(n[4]):1;i.setTo(s,r,a,255*o)}return i},by}function TY(){if(Sy)return Ey;Sy=1;var t=vY(),e=xY(),i=wY(),n=bY();return Ey=function(s){switch(typeof s){case"string":return"rgb"===s.substr(0,3).toLowerCase()?n(s):t(s);case"number":return e(s);case"object":return i(s)}},Ey}function EY(){if(Cy)return _y;Cy=1;var t=Ih(),e=Zu(),i=Ou(),n=Iz(),s=cY(),r=Eu(),a=Hu(),o=TY(),h=wu(),l=new t({Extends:n,Mixins:[e.AlphaSingle,e.Visible],initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),n.call(this),this.scene,this.sceneManager,this.scaleManager,this.cameraManager,this.id=0,this.name="",this.roundPixels=!1,this.useBounds=!1,this.worldView=new r,this.dirty=!0,this._x=t,this._y=e,this._width=i,this._height=s,this._bounds=new r,this._scrollX=0,this._scrollY=0,this._zoomX=1,this._zoomY=1,this._rotation=0,this.matrix=new a,this.transparent=!0,this.backgroundColor=o("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new h(i/2,s/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null,this.renderList=[],this.isSceneCamera=!0,this.renderRoundPixels=!0},addToRenderList:function(t){this.renderList.push(t)},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,i){void 0===i&&(i=new h);var n=.5*this.width,s=.5*this.height;return i.x=t-n,i.y=e-s,this.useBounds&&(i.x=this.clampX(i.x),i.y=this.clampY(i.y)),i},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,i=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-i}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,i=e[0],n=e[1],s=e[2],r=e[3],a=i*r-n*s;if(!a)return t;var o=e[4],h=e[5],l=this.scrollX,u=this.scrollY,c=this.width,d=this.height,f=this.y,p=f+d,g=this.x,m=g+c,v=this.culledObjects,y=t.length;a=1/a,v.length=0;for(var x=0;x<y;++x){var w=t[x];if(w.hasOwnProperty("width")&&!w.parentContainer){var b=w.width,T=w.height,E=w.x-l*w.scrollFactorX-b*w.originX,S=w.y-u*w.scrollFactorY-T*w.originY;(E+b)*i+(S+T)*s+o>g&&E*i+S*s+o<m&&(E+b)*n+(S+T)*r+h>f&&E*n+S*r+h<p&&v.push(w)}else v.push(w)}return v},getWorldPoint:function(t,e,i){void 0===i&&(i=new h);var n=this.matrix.matrix,s=n[0],r=n[1],a=n[2],o=n[3],l=n[4],u=n[5],c=s*o-r*a;if(!c)return i.x=t,i.y=e,i;var d=o*(c=1/c),f=-r*c,p=-a*c,g=s*c,m=(a*u-o*l)*c,v=(r*l-s*u)*c,y=Math.cos(this.rotation),x=Math.sin(this.rotation),w=this.zoomX,b=this.zoomY,T=this.scrollX,E=this.scrollY,S=t+(T*y-E*x)*w,_=e+(T*x+E*y)*b;return i.x=S*d+_*p+m,i.y=S*f+_*g+v,i},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];Array.isArray(n)?this.ignore(n):n.isParent?this.ignore(n.getChildren()):n.cameraFilter|=e}return this},clampX:function(t){var e=this._bounds,i=this.displayWidth,n=e.x+(i-this.width)/2,s=Math.max(n,n+e.width-i);return t<n?t=n:t>s&&(t=s),t},clampY:function(t){var e=this._bounds,i=this.displayHeight,n=e.y+(i-this.height)/2,s=Math.max(n,n+e.height-i);return t<n?t=n:t>s&&(t=s),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=i(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=o(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,i,n,s){return void 0===s&&(s=!1),this._bounds.setTo(t,e,i,n),this.dirty=!0,this.useBounds=!0,s?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new r);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t,e){void 0===e&&(e=!0),this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t,this.isSceneCamera=e;var i=t.sys;return this.sceneManager=i.game.scene,this.scaleManager=i.scale,this.cameraManager=i.cameras,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setZoom:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),0===t&&(t=.001),0===e&&(e=.001),this.zoomX=t,this.zoomY=e,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},setIsSceneCamera:function(t){return this.isSceneCamera=t,this},updateSystem:function(){if(this.scaleManager&&this.isSceneCamera){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(s.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this.renderList=[],this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){t!==this._scrollX&&(this._scrollX=t,this.dirty=!0)}},scrollY:{get:function(){return this._scrollY},set:function(t){t!==this._scrollY&&(this._scrollY=t,this.dirty=!0)}},zoom:{get:function(){return(this._zoomX+this._zoomY)/2},set:function(t){this._zoomX=t,this._zoomY=t,this.dirty=!0}},zoomX:{get:function(){return this._zoomX},set:function(t){this._zoomX=t,this.dirty=!0}},zoomY:{get:function(){return this._zoomY},set:function(t){this._zoomY=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoomX}},displayHeight:{get:function(){return this.height/this.zoomY}}});return _y=l}function SY(){return My?Ay:(My=1,Ay=function(t,e,i){return t.x=e-t.width/2,t.y=i-t.height/2,t})}function _Y(){if(Ry)return Py;Ry=1;var t=Yh(),e=Ih(),i=cY(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o,h){if(void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),!a&&this.isRunning)return this.camera;this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=s,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h;var l=t?i.FADE_OUT_START:i.FADE_IN_START;return this.camera.emit(l,this.camera,this,e,n,s,r),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0;var t=this.direction?i.FADE_OUT_COMPLETE:i.FADE_IN_COMPLETE;this.camera.emit(t,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return Py=n}function CY(){if(Oy)return Ly;Oy=1;var t=Yh(),e=Ih(),i=cY(),n=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=1,this.progress=0,this._elapsed=0,this._alpha,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r,a,o){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===s&&(s=255),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=s,this._alpha=this.alpha,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(i.FLASH_START,this.camera,this,t,e,n,s)),this.camera},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this._alpha*(1-this.progress):this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e.x,e.y,e.width,e.height),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var i=this.camera,n=this.red/255,s=this.green/255,r=this.blue/255;return t.drawFillRect(i.x,i.y,i.width,i.height,e(r,s,n,1),this.alpha),!0},effectComplete:function(){this.alpha=this._alpha,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return Ly=n}function AY(){if(ky)return Fy;ky=1;var t=Yh(),e=Ih(),i=sU(),n=cY(),s=wu(),r=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new s,this.current=new s,this.destination=new s,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=i.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene);var l=this.camera;return!a&&this.isRunning||(this.isRunning=!0,this.duration=s,this.progress=0,this.source.set(l.scrollX,l.scrollY),this.destination.set(t,e),l.getScroll(t,e,this.current),"string"==typeof r&&i.hasOwnProperty(r)?this.ease=i[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.camera.emit(n.PAN_START,this.camera,this,s,t,e)),l},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);s.getScroll(this.destination.x,this.destination.y,this.current);var a=this.source.x+(this.current.x-this.source.x)*r,o=this.source.y+(this.current.y-this.source.y)*r;s.setScroll(a,o),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,a,o)}else s.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,s.scrollX,s.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return Fy=r}function MY(){if(Iy)return Dy;Iy=1;var t=Yh(),e=Ih(),i=cY(),n=wu(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new n,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate,this._onUpdateScope},start:function(t,e,n,s,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===s&&(s=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"==typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=s,this._onUpdateScope=r,this.camera.emit(i.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(e,i){if(this.isRunning)if(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,s=this.camera.width,r=this.camera.height,a=this.camera.zoom;this._offsetX=(Math.random()*n.x*s*2-n.x*s)*a,this._offsetY=(Math.random()*n.y*r*2-n.y*r)*a,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});return Dy=s}function PY(){if(Ny)return By;Ny=1;var t=Yh(),e=Ih(),i=cY(),n=sU(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=0,this.current=0,this.destination=0,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope,this.clockwise=!0,this.shortestPath=!1},start:function(t,e,s,r,a,o,h){void 0===s&&(s=1e3),void 0===r&&(r=n.Linear),void 0===a&&(a=!1),void 0===o&&(o=null),void 0===h&&(h=this.camera.scene),void 0===e&&(e=!1),this.shortestPath=e;var l=t;t<0?(l=-1*t,this.clockwise=!1):this.clockwise=!0;var u=360*Math.PI/180;l-=Math.floor(l/u)*u;var c=this.camera;if(!a&&this.isRunning)return c;if(this.isRunning=!0,this.duration=s,this.progress=0,this.source=c.rotation,this.destination=l,"string"==typeof r&&n.hasOwnProperty(r)?this.ease=n[r]:"function"==typeof r&&(this.ease=r),this._elapsed=0,this._onUpdate=o,this._onUpdateScope=h,this.shortestPath){var d,f;(d=this.destination>this.source?Math.abs(this.destination-this.source):Math.abs(this.destination+u)-this.source)<(f=this.source>this.destination?Math.abs(this.source-this.destination):Math.abs(this.source+u)-this.destination)?this.clockwise=!0:d>f&&(this.clockwise=!1)}return this.camera.emit(i.ROTATE_START,this.camera,this,s,l),c},update:function(e,i){if(this.isRunning){this._elapsed+=i;var n=t(this._elapsed/this.duration,0,1);this.progress=n;var s=this.camera;if(this._elapsed<this.duration){var r=this.ease(n);this.current=s.rotation;var a,o=360*Math.PI/180,h=this.destination,l=this.current;!1===this.clockwise&&(h=this.current,l=this.destination),a=h>=l?Math.abs(h-l):Math.abs(h+o)-l;var u;u=this.clockwise?s.rotation+a*r:s.rotation-a*r,s.rotation=u,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,u)}else s.rotation=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,s,n,this.destination),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(i.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});return By=s}function RY(){if(Uy)return zy;Uy=1;var t=Yh(),e=Ih(),i=sU(),n=cY(),s=new e({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.ease,this.progress=0,this._elapsed=0,this._onUpdate,this._onUpdateScope},start:function(t,e,s,r,a,o){void 0===e&&(e=1e3),void 0===s&&(s=i.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===o&&(o=this.camera.scene);var h=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=h.zoom,this.destination=t,"string"==typeof s&&i.hasOwnProperty(s)?this.ease=i[s]:"function"==typeof s&&(this.ease=s),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=o,this.camera.emit(n.ZOOM_START,this.camera,this,e,t)),h},update:function(e,i){this.isRunning&&(this._elapsed+=i,this.progress=t(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(n.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});return zy=s}function LY(){return Xy?Yy:(Xy=1,Yy={Fade:_Y(),Flash:CY(),Pan:AY(),Shake:MY(),RotateTo:PY(),Zoom:RY()})}function OY(){return Hy?Gy:(Hy=1,Gy=function(t,e,i){return(e-t)*i+t})}function FY(){if(Vy)return Wy;Vy=1;var t=EY(),e=SY(),i=Yh(),n=Ih(),s=Zu(),r=LY(),a=cY(),o=OY(),h=Eu(),l=wu(),u=new n({Extends:t,Mixins:[s.PostPipeline],initialize:function(e,i,n,s){t.call(this,e,i,n,s),this.initPostPipeline(),this.inputEnabled=!0,this.fadeEffect=new r.Fade(this),this.flashEffect=new r.Flash(this),this.shakeEffect=new r.Shake(this),this.panEffect=new r.Pan(this),this.rotateToEffect=new r.RotateTo(this),this.zoomEffect=new r.Zoom(this),this.lerp=new l(1,1),this.followOffset=new l,this.deadzone=null,this._follow=null},setDeadzone:function(t,i){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=i):this.deadzone=new h(0,0,t,i),this._follow){var n=this.width/2,s=this.height/2,r=this._follow.x-this.followOffset.x,a=this._follow.y-this.followOffset.y;this.midPoint.set(r,a),this.scrollX=r-n,this.scrollY=a-s}e(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,i,n,s,r){return this.fadeEffect.start(!1,t,e,i,n,!0,s,r)},fadeOut:function(t,e,i,n,s,r){return this.fadeEffect.start(!0,t,e,i,n,!0,s,r)},fadeFrom:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!1,t,e,i,n,s,r,a)},fade:function(t,e,i,n,s,r,a){return this.fadeEffect.start(!0,t,e,i,n,s,r,a)},flash:function(t,e,i,n,s,r,a){return this.flashEffect.start(t,e,i,n,s,r,a)},shake:function(t,e,i,n,s){return this.shakeEffect.start(t,e,i,n,s)},pan:function(t,e,i,n,s,r,a){return this.panEffect.start(t,e,i,n,s,r,a)},rotateTo:function(t,e,i,n,s,r,a){return this.rotateToEffect.start(t,e,i,n,s,r,a)},zoomTo:function(t,e,i,n,s,r){return this.zoomEffect.start(t,e,i,n,s,r)},preRender:function(){this.renderList.length=0;var t=this.width,i=this.height,n=.5*t,s=.5*i,r=this.zoomX,h=this.zoomY,l=this.matrix;this.renderRoundPixels=this.roundPixels&&Number.isInteger(r)&&Number.isInteger(h);var u=t*this.originX,c=i*this.originY,d=this._follow,f=this.deadzone,p=this.scrollX,g=this.scrollY;f&&e(f,this.midPoint.x,this.midPoint.y);var m=!1;if(d&&!this.panEffect.isRunning){var v=this.lerp,y=d.x-this.followOffset.x,x=d.y-this.followOffset.y;f?(y<f.x?p=o(p,p-(f.x-y),v.x):y>f.right&&(p=o(p,p+(y-f.right),v.x)),x<f.y?g=o(g,g-(f.y-x),v.y):x>f.bottom&&(g=o(g,g+(x-f.bottom),v.y))):(p=o(p,y-u,v.x),g=o(g,x-c,v.y)),m=!0}this.roundPixels&&(p=Math.floor(p),g=Math.floor(g)),this.useBounds&&(p=this.clampX(p),g=this.clampY(g)),this.scrollX=p,this.scrollY=g;var w=p+n,b=g+s;this.midPoint.set(w,b);var T=Math.floor(t/r+.5),E=Math.floor(i/h+.5),S=Math.floor(w-T/2+.5),_=Math.floor(b-E/2+.5);this.worldView.setTo(S,_,T,E),l.applyITRS(Math.floor(this.x+u+.5),Math.floor(this.y+c+.5),this.rotation,r,h),l.translate(-u,-c),this.shakeEffect.preRender(),m&&this.emit(a.FOLLOW_UPDATE,this,d)},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,s,r,a){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===s&&(s=n),void 0===r&&(r=0),void 0===a&&(a=r),this._follow=t,this.roundPixels=e,n=i(n,0,1),s=i(s,0,1),this.lerp.set(n,s),this.followOffset.set(r,a);var o=this.width/2,h=this.height/2,l=t.x-r,u=t.y-a;return this.midPoint.set(l,u),this.scrollX=l-o,this.scrollY=u-h,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.rotateToEffect.reset(),this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.rotateToEffect.update(t,e),this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.resetFX(),t.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});return Wy=u}function kY(){return ax?rx:(ax=1,rx={ENTER_FULLSCREEN:qy?jy:(qy=1,jy="enterfullscreen"),FULLSCREEN_FAILED:Zy?Ky:(Zy=1,Ky="fullscreenfailed"),FULLSCREEN_UNSUPPORTED:Jy?$y:(Jy=1,$y="fullscreenunsupported"),LEAVE_FULLSCREEN:tx?Qy:(tx=1,Qy="leavefullscreen"),ORIENTATION_CHANGE:ix?ex:(ix=1,ex="orientationchange"),RESIZE:sx?nx:(sx=1,nx="resize")})}function DY(){if(hx)return ox;hx=1;var t=FY(),e=Ih(),i=kh(),n=Cu(),s=cu(),r=kY(),a=Au(),o=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],this.main,this.default,t.sys.events.once(a.BOOT,this.boot,this),t.sys.events.on(a.START,this.start,this)},boot:function(){var e=this.systems;e.settings.cameras?this.fromJSON(e.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new t(0,0,e.scale.width,e.scale.height).setScene(this.scene),e.game.scale.on(r.RESIZE,this.onResize,this),this.systems.events.once(a.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(a.UPDATE,this.update,this),e.once(a.SHUTDOWN,this.shutdown,this)},add:function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===s&&(s=this.scene.sys.scale.height),void 0===r&&(r=!1),void 0===a&&(a="");var o=new t(e,i,n,s);return o.setName(a),o.setScene(this.scene),o.setRoundPixels(this.roundPixels),o.id=this.getNextID(),this.cameras.push(o),r&&(this.main=o),o},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,i=0;i<32;i++){for(var n=!1,s=0;s<t.length;s++){var r=t[s];r&&r.id===e&&(n=!0)}if(!n)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,i=this.cameras,n=0;n<i.length;n++){var s=i[n];(!t||t&&s.visible)&&e++}return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,s=0;s<t.length;s++){var r=t[s],a=i(r,"x",0),o=i(r,"y",0),h=i(r,"width",e),l=i(r,"height",n),u=this.add(a,o,h,l);u.name=i(r,"name",""),u.zoom=i(r,"zoom",1),u.rotation=i(r,"rotation",0),u.scrollX=i(r,"scrollX",0),u.scrollY=i(r,"scrollY",0),u.roundPixels=i(r,"roundPixels",!1),u.visible=i(r,"visible",!0);var c=i(r,"backgroundColor",!1);c&&u.setBackgroundColor(c);var d=i(r,"bounds",null);if(d){var f=i(d,"x",0),p=i(d,"y",0),g=i(d,"width",e),m=i(d,"height",n);u.setBounds(f,p,g,m)}}return this},getCamera:function(t){for(var e=this.cameras,i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,i=t.x,n=t.y,r=[],a=0;a<e.length;a++){var o=e[a];o.visible&&o.inputEnabled&&s(o,i,n)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0,n=this.cameras,s=0;s<t.length;s++){var r=n.indexOf(t[s]);-1!==r&&(e?n[r].destroy():n[r].renderList=[],n.splice(r,1),i++)}return!this.main&&n[0]&&(this.main=n[0]),i},render:function(t,e){for(var i=this.scene,n=this.cameras,s=0;s<n.length;s++){var r=n[s];if(r.visible&&r.alpha>0){r.preRender();var a=this.getVisibleChildren(e.getChildren(),r);t.render(i,a,r)}}},getVisibleChildren:function(t,e){return t.filter(function(t){return t.willRender(e)})},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].update(t,e)},onResize:function(t,e,i,n,s){for(var r=0;r<this.cameras.length;r++){var a=this.cameras[r];0===a._x&&0===a._y&&a._width===n&&a._height===s&&a.setSize(e.width,e.height)}},resize:function(t,e){for(var i=0;i<this.cameras.length;i++)this.cameras[i].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(a.UPDATE,this.update,this),e.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.systems.events.off(a.START,this.start,this),this.systems.events.off(a.DESTROY,this.destroy,this),this.systems.game.scale.off(r.RESIZE,this.onResize,this),this.scene=null,this.systems=null}});return n.register("CameraManager",o,"cameras"),ox=o}function IY(){if(px)return fx;px=1;var t={Global:["game","anims","cache","plugins","registry","scale","sound","textures","renderer"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]};return t.DefaultScene.push("CameraManager3D"),t.Global.push("facebook"),fx=t}function BY(){return mx?gx:(mx=1,gx=function(t,e,i,n){return Math.atan2(n-e,i-t)})}function NY(){return yx?vx:(yx=1,vx=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)})}function zY(){if(Sx)return Ex;Sx=1;var t=Gh();return Ex=function(e){return e>Math.PI&&(e-=t.PI2),Math.abs(((e+t.TAU)%t.PI2-t.PI2)%t.PI2)}}function UY(){return Cx?_x:(Cx=1,_x=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI})}function YY(){if(Mx)return Ax;Mx=1;var t=UY();return Ax=function(e,i){return t(i-e)}}function XY(){if(Rx)return Px;Rx=1;var t=UY(),e=2*Math.PI;return Px=function(i,n){var s=t(n-i);return s>0&&(s-=e),s},Px}function GY(){if(Ox)return Lx;Ox=1;var t=ju();return Lx=function(e,i){return t(i-e)}}function HY(){return kx?Fx:(kx=1,Fx=function(t,e){return Math.random()*(e-t)+t})}function WY(){if(Ix)return Dx;Ix=1;var t=HY();return Dx=function(){return t(-Math.PI,Math.PI)}}function VY(){if(Nx)return Bx;Nx=1;var t=HY();return Bx=function(){return t(-180,180)}}function jY(){if(Ux)return zx;Ux=1;var t=UY();return zx=function(e){return t(e+Math.PI)}}function qY(){if(Xx)return Yx;Xx=1;var t=Gh();return Yx=function(e,i,n){return void 0===n&&(n=.05),e===i||(Math.abs(i-e)<=n||Math.abs(i-e)>=t.PI2-n?e=i:(Math.abs(i-e)>Math.PI&&(i<e?i+=t.PI2:i-=t.PI2),i>e?e+=n:i<e&&(e-=n))),e}}function KY(){return iw?ew:(iw=1,ew=function(t,e,i,n){var s=t-i,r=e-n;return s*s+r*r})}function ZY(){return dw?cw:(dw=1,cw=function(t,e,i){return void 0===i&&(i=1e-4),t>e-i})}function $Y(){return pw?fw:(pw=1,fw=function(t,e,i){return void 0===i&&(i=1e-4),t<e+i})}function JY(){return yw?vw:(yw=1,vw=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e})}function QY(){if(ww)return xw;ww=1;var t=JY();return xw=function(e,i){return t(e)/t(i)/t(e-i)}}function tX(){if(Tw)return bw;Tw=1;var t=QY();return bw=function(e,i){for(var n=0,s=e.length-1,r=0;r<=s;r++)n+=Math.pow(1-i,s-r)*Math.pow(i,r)*e[r]*t(s,r);return n}}function eX(){return Sw?Ew:(Sw=1,Ew=function(t,e,i,n,s){var r=.5*(n-e),a=.5*(s-i),o=t*t;return(2*i-2*n+r+a)*(t*o)+(-3*i+3*n-2*r-a)*o+r*t+i})}function iX(){if(Cw)return _w;Cw=1;var t=eX();return _w=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return e[0]===e[n]?(i<0&&(r=Math.floor(s=n*(1+i))),t(s-r,e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n])):i<0?e[0]-(t(-s,e[0],e[0],e[1],e[1])-e[0]):i>1?e[n]-(t(s-n,e[n],e[n],e[n-1],e[n-1])-e[n]):t(s-r,e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2])}}function nX(){return Mw?Aw:(Mw=1,Aw=function(t,e,i,n,s){return function(t,e){var i=1-t;return i*i*i*e}(t,e)+function(t,e){var i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,s)})}function sX(){if(Rw)return Pw;Rw=1;var t=OY();return Pw=function(e,i){var n=e.length-1,s=n*i,r=Math.floor(s);return i<0?t(e[0],e[1],s):i>1?t(e[n],e[n-1],n-s):t(e[r],e[r+1>n?n:r+1],s-r)}}function rX(){return Ow?Lw:(Ow=1,Lw=function(t,e,i,n){return function(t,e){var i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)})}function aX(){if(kw)return Fw;kw=1;var t=qU();return Fw=function(e,i,n){return i+(n-i)*t(e,0,1)}}function oX(){if(Iw)return Dw;Iw=1;var t=VU();return Dw=function(e,i,n){return i+(n-i)*t(e,0,1)}}function hX(){return Uw?zw:(Uw=1,zw=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)})}function lX(){return Xw?Yw:(Xw=1,Yw=function(t,e){return t>0&&!(t&t-1)&&e>0&&!(e&e-1)})}function uX(){return qw?jw:(qw=1,jw=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.ceil(t/e),n?(i+t)/e:i+t)})}function cX(){return Zw?Kw:(Zw=1,Kw=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.floor(t/e),n?(i+t)/e:i+t)})}function dX(){return Jw?$w:(Jw=1,$w=function(t,e,i,n){return void 0===i&&(i=0),0===e?t:(t-=i,t=e*Math.round(t/e),n?(i+t)/e:i+t)})}function fX(){if(ib)return eb;ib=1;var t=new(Ih())({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,i=this.n;t=t.toString();for(var n=0;n<t.length;n++)e=.02519603282416938*(i+=t.charCodeAt(n)),e-=i=e>>>0,i=(e*=i)>>>0,i+=4294967296*(e-=i);return this.n=i,2.3283064365386963e-10*(i>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var i=t[e];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-.5)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(this.frac()*(e+1)),n=t[i];t[i]=t[e],t[e]=n}return t}});return eb=t}function pX(){if(ub)return lb;ub=1;var t=new(Ih())({initialize:function(t,e,i){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clone:function(){return new t(this.x,this.y,this.z)},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},crossVectors:function(t,e){var i=t.x,n=t.y,s=t.z,r=e.x,a=e.y,o=e.z;return this.x=n*o-s*a,this.y=s*r-i*o,this.z=i*a-n*r,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=i||0),this},setFromMatrixPosition:function(t){return this.fromArray(t.val,12)},setFromMatrixColumn:function(t,e){return this.fromArray(t.val,4*e)},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addScale:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return Math.sqrt(e*e+i*i+n*n)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0;return e*e+i*i+n*n},length:function(){var t=this.x,e=this.y,i=this.z;return Math.sqrt(t*t+e*e+i*i)},lengthSq:function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},normalize:function(){var t=this.x,e=this.y,i=this.z,n=t*t+e*e+i*i;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n,this.z=i*n),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z;return this.x=i*a-n*r,this.y=n*s-e*a,this.z=e*r-i*s,this},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*r,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*r,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*r,this},transformMat3:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=e*s[0]+i*s[3]+n*s[6],this.y=e*s[1]+i*s[4]+n*s[7],this.z=e*s[2]+i*s[5]+n*s[8],this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=t.val;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12],this.y=s[1]*e+s[5]*i+s[9]*n+s[13],this.z=s[2]*e+s[6]*i+s[10]*n+s[14],this},transformCoordinates:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=e*s[0]+i*s[4]+n*s[8]+s[12],a=e*s[1]+i*s[5]+n*s[9]+s[13],o=e*s[2]+i*s[6]+n*s[10]+s[14],h=e*s[3]+i*s[7]+n*s[11]+s[15];return this.x=r/h,this.y=a/h,this.z=o/h,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},project:function(t){var e=this.x,i=this.y,n=this.z,s=t.val,r=s[0],a=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],d=s[7],f=s[8],p=s[9],g=s[10],m=s[11],v=s[12],y=s[13],x=s[14],w=1/(e*h+i*d+n*m+s[15]);return this.x=(e*r+i*l+n*f+v)*w,this.y=(e*a+i*u+n*p+y)*w,this.z=(e*o+i*c+n*g+x)*w,this},projectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unprojectViewMatrix:function(t,e){return this.applyMatrix4(t).applyMatrix4(e)},unproject:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=this.x-i,o=r-this.y-1-n,h=this.z;return this.x=2*a/s-1,this.y=2*o/r-1,this.z=2*h-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});return t.ZERO=new t,t.RIGHT=new t(1,0,0),t.LEFT=new t(-1,0,0),t.UP=new t(0,-1,0),t.DOWN=new t(0,1,0),t.FORWARD=new t(0,0,1),t.BACK=new t(0,0,-1),t.ONE=new t(1,1,1),lb=t}function gX(){if(db)return cb;db=1;var t=Ih(),e=pX(),i=1e-6,n=new t({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new n(this)},set:function(t){return this.copy(t)},setValues:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g){var m=this.val;return m[0]=t,m[1]=e,m[2]=i,m[3]=n,m[4]=s,m[5]=r,m[6]=a,m[7]=o,m[8]=h,m[9]=l,m[10]=u,m[11]=c,m[12]=d,m[13]=f,m[14]=p,m[15]=g,this},copy:function(t){var e=t.val;return this.setValues(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},fromArray:function(t){return this.setValues(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},zero:function(){return this.setValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},transform:function(t,e,i){var n=s.fromQuat(i).val,r=e.x,a=e.y,o=e.z;return this.setValues(n[0]*r,n[1]*r,n[2]*r,0,n[4]*a,n[5]*a,n[6]*a,0,n[8]*o,n[9]*o,n[10]*o,0,t.x,t.y,t.z,1)},xyz:function(t,e,i){this.identity();var n=this.val;return n[12]=t,n[13]=e,n[14]=i,this},scaling:function(t,e,i){this.zero();var n=this.val;return n[0]=t,n[5]=e,n[10]=i,n[15]=1,this},identity:function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[3],s=t[6],r=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=s,t[11]=t[14],t[12]=n,t[13]=r,t[14]=a,this},getInverse:function(t){return this.copy(t),this.invert()},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15],v=e*a-i*r,y=e*o-n*r,x=e*h-s*r,w=i*o-n*a,b=i*h-s*a,T=n*h-s*o,E=l*p-u*f,S=l*g-c*f,_=l*m-d*f,C=u*g-c*p,A=u*m-d*p,M=c*m-d*g,P=v*M-y*A+x*C+w*_-b*S+T*E;return P?(P=1/P,this.setValues((a*M-o*A+h*C)*P,(n*A-i*M-s*C)*P,(p*T-g*b+m*w)*P,(c*b-u*T-d*w)*P,(o*_-r*M-h*S)*P,(e*M-n*_+s*S)*P,(g*x-f*T-m*y)*P,(l*T-c*x+d*y)*P,(r*A-a*_+h*E)*P,(i*_-e*A-s*E)*P,(f*b-p*x+m*v)*P,(u*x-l*b-d*v)*P,(a*S-r*C-o*E)*P,(e*C-i*S+n*E)*P,(p*y-f*w-g*v)*P,(l*w-u*y+c*v)*P)):this},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return this.setValues(a*(c*m-d*g)-u*(o*m-h*g)+p*(o*d-h*c),-(i*(c*m-d*g)-u*(n*m-s*g)+p*(n*d-s*c)),i*(o*m-h*g)-a*(n*m-s*g)+p*(n*h-s*o),-(i*(o*d-h*c)-a*(n*d-s*c)+u*(n*h-s*o)),-(r*(c*m-d*g)-l*(o*m-h*g)+f*(o*d-h*c)),e*(c*m-d*g)-l*(n*m-s*g)+f*(n*d-s*c),-(e*(o*m-h*g)-r*(n*m-s*g)+f*(n*h-s*o)),e*(o*d-h*c)-r*(n*d-s*c)+l*(n*h-s*o),r*(u*m-d*p)-l*(a*m-h*p)+f*(a*d-h*u),-(e*(u*m-d*p)-l*(i*m-s*p)+f*(i*d-s*u)),e*(a*m-h*p)-r*(i*m-s*p)+f*(i*h-s*a),-(e*(a*d-h*u)-r*(i*d-s*u)+l*(i*h-s*a)),-(r*(u*g-c*p)-l*(a*g-o*p)+f*(a*c-o*u)),e*(u*g-c*p)-l*(i*g-n*p)+f*(i*c-n*u),-(e*(a*g-o*p)-r*(i*g-n*p)+f*(i*o-n*a)),e*(a*c-o*u)-r*(i*c-n*u)+l*(i*o-n*a))},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=t[9],c=t[10],d=t[11],f=t[12],p=t[13],g=t[14],m=t[15];return(e*a-i*r)*(c*m-d*g)-(e*o-n*r)*(u*m-d*p)+(e*h-s*r)*(u*g-c*p)+(i*o-n*a)*(l*m-d*f)-(i*h-s*a)*(l*g-c*f)+(n*h-s*o)*(l*p-u*f)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=e[9],d=e[10],f=e[11],p=e[12],g=e[13],m=e[14],v=e[15],y=t.val,x=y[0],w=y[1],b=y[2],T=y[3];return e[0]=x*i+w*a+b*u+T*p,e[1]=x*n+w*o+b*c+T*g,e[2]=x*s+w*h+b*d+T*m,e[3]=x*r+w*l+b*f+T*v,x=y[4],w=y[5],b=y[6],T=y[7],e[4]=x*i+w*a+b*u+T*p,e[5]=x*n+w*o+b*c+T*g,e[6]=x*s+w*h+b*d+T*m,e[7]=x*r+w*l+b*f+T*v,x=y[8],w=y[9],b=y[10],T=y[11],e[8]=x*i+w*a+b*u+T*p,e[9]=x*n+w*o+b*c+T*g,e[10]=x*s+w*h+b*d+T*m,e[11]=x*r+w*l+b*f+T*v,x=y[12],w=y[13],b=y[14],T=y[15],e[12]=x*i+w*a+b*u+T*p,e[13]=x*n+w*o+b*c+T*g,e[14]=x*s+w*h+b*d+T*m,e[15]=x*r+w*l+b*f+T*v,this},multiplyLocal:function(t){var e=this.val,i=t.val;return this.setValues(e[0]*i[0]+e[1]*i[4]+e[2]*i[8]+e[3]*i[12],e[0]*i[1]+e[1]*i[5]+e[2]*i[9]+e[3]*i[13],e[0]*i[2]+e[1]*i[6]+e[2]*i[10]+e[3]*i[14],e[0]*i[3]+e[1]*i[7]+e[2]*i[11]+e[3]*i[15],e[4]*i[0]+e[5]*i[4]+e[6]*i[8]+e[7]*i[12],e[4]*i[1]+e[5]*i[5]+e[6]*i[9]+e[7]*i[13],e[4]*i[2]+e[5]*i[6]+e[6]*i[10]+e[7]*i[14],e[4]*i[3]+e[5]*i[7]+e[6]*i[11]+e[7]*i[15],e[8]*i[0]+e[9]*i[4]+e[10]*i[8]+e[11]*i[12],e[8]*i[1]+e[9]*i[5]+e[10]*i[9]+e[11]*i[13],e[8]*i[2]+e[9]*i[6]+e[10]*i[10]+e[11]*i[14],e[8]*i[3]+e[9]*i[7]+e[10]*i[11]+e[11]*i[15],e[12]*i[0]+e[13]*i[4]+e[14]*i[8]+e[15]*i[12],e[12]*i[1]+e[13]*i[5]+e[14]*i[9]+e[15]*i[13],e[12]*i[2]+e[13]*i[6]+e[14]*i[10]+e[15]*i[14],e[12]*i[3]+e[13]*i[7]+e[14]*i[11]+e[15]*i[15])},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.val,n=e.val,s=i[0],r=i[4],a=i[8],o=i[12],h=i[1],l=i[5],u=i[9],c=i[13],d=i[2],f=i[6],p=i[10],g=i[14],m=i[3],v=i[7],y=i[11],x=i[15],w=n[0],b=n[4],T=n[8],E=n[12],S=n[1],_=n[5],C=n[9],A=n[13],M=n[2],P=n[6],R=n[10],L=n[14],O=n[3],F=n[7],k=n[11],D=n[15];return this.setValues(s*w+r*S+a*M+o*O,h*w+l*S+u*M+c*O,d*w+f*S+p*M+g*O,m*w+v*S+y*M+x*O,s*b+r*_+a*P+o*F,h*b+l*_+u*P+c*F,d*b+f*_+p*P+g*F,m*b+v*_+y*P+x*F,s*T+r*C+a*R+o*k,h*T+l*C+u*R+c*k,d*T+f*C+p*R+g*k,m*T+v*C+y*R+x*k,s*E+r*A+a*L+o*D,h*E+l*A+u*L+c*D,d*E+f*A+p*L+g*D,m*E+v*A+y*L+x*D)},translate:function(t){return this.translateXYZ(t.x,t.y,t.z)},translateXYZ:function(t,e,i){var n=this.val;return n[12]=n[0]*t+n[4]*e+n[8]*i+n[12],n[13]=n[1]*t+n[5]*e+n[9]*i+n[13],n[14]=n[2]*t+n[6]*e+n[10]*i+n[14],n[15]=n[3]*t+n[7]*e+n[11]*i+n[15],this},scale:function(t){return this.scaleXYZ(t.x,t.y,t.z)},scaleXYZ:function(t,e,i){var n=this.val;return n[0]=n[0]*t,n[1]=n[1]*t,n[2]=n[2]*t,n[3]=n[3]*t,n[4]=n[4]*e,n[5]=n[5]*e,n[6]=n[6]*e,n[7]=n[7]*e,n[8]=n[8]*i,n[9]=n[9]*i,n[10]=n[10]*i,n[11]=n[11]*i,this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),s=1-i,r=t.x,a=t.y,o=t.z,h=s*r,l=s*a;return this.setValues(h*r+i,h*a-n*o,h*o+n*a,0,h*a+n*o,l*a+i,l*o-n*r,0,h*o-n*a,l*o+n*r,s*o*o+i,0,0,0,0,1)},rotate:function(t,e){var n=this.val,s=e.x,r=e.y,a=e.z,o=Math.sqrt(s*s+r*r+a*a);if(Math.abs(o)<i)return this;s*=o=1/o,r*=o,a*=o;var h=Math.sin(t),l=Math.cos(t),u=1-l,c=n[0],d=n[1],f=n[2],p=n[3],g=n[4],m=n[5],v=n[6],y=n[7],x=n[8],w=n[9],b=n[10],T=n[11],E=n[12],S=n[13],_=n[14],C=n[15],A=s*s*u+l,M=r*s*u+a*h,P=a*s*u-r*h,R=s*r*u-a*h,L=r*r*u+l,O=a*r*u+s*h,F=s*a*u+r*h,k=r*a*u-s*h,D=a*a*u+l;return this.setValues(c*A+g*M+x*P,d*A+m*M+w*P,f*A+v*M+b*P,p*A+y*M+T*P,c*R+g*L+x*O,d*R+m*L+w*O,f*R+v*L+b*O,p*R+y*L+T*O,c*F+g*k+x*D,d*F+m*k+w*D,f*F+v*k+b*D,p*F+y*k+T*D,E,S,_,C)},rotateX:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[4],r=e[5],a=e[6],o=e[7],h=e[8],l=e[9],u=e[10],c=e[11];return e[4]=s*n+h*i,e[5]=r*n+l*i,e[6]=a*n+u*i,e[7]=o*n+c*i,e[8]=h*n-s*i,e[9]=l*n-r*i,e[10]=u*n-a*i,e[11]=c*n-o*i,this},rotateY:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[8],l=e[9],u=e[10],c=e[11];return e[0]=s*n-h*i,e[1]=r*n-l*i,e[2]=a*n-u*i,e[3]=o*n-c*i,e[8]=s*i+h*n,e[9]=r*i+l*n,e[10]=a*i+u*n,e[11]=o*i+c*n,this},rotateZ:function(t){var e=this.val,i=Math.sin(t),n=Math.cos(t),s=e[0],r=e[1],a=e[2],o=e[3],h=e[4],l=e[5],u=e[6],c=e[7];return e[0]=s*n+h*i,e[1]=r*n+l*i,e[2]=a*n+u*i,e[3]=o*n+c*i,e[4]=h*n-s*i,e[5]=l*n-r*i,e[6]=u*n-a*i,e[7]=c*n-o*i,this},fromRotationTranslation:function(t,e){var i=t.x,n=t.y,s=t.z,r=t.w,a=i+i,o=n+n,h=s+s,l=i*a,u=i*o,c=i*h,d=n*o,f=n*h,p=s*h,g=r*a,m=r*o,v=r*h;return this.setValues(1-(d+p),u+v,c-m,0,u-v,1-(l+p),f+g,0,c+m,f-g,1-(l+d),0,e.x,e.y,e.z,1)},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,m=s*o;return this.setValues(1-(c+f),l+m,u-g,0,l-m,1-(h+f),d+p,0,u+g,d-p,1-(h+c),0,0,0,0,1)},frustum:function(t,e,i,n,s,r){var a=1/(e-t),o=1/(n-i),h=1/(s-r);return this.setValues(2*s*a,0,0,0,0,2*s*o,0,0,(e+t)*a,(n+i)*o,(r+s)*h,-1,0,0,r*s*2*h,0)},perspective:function(t,e,i,n){var s=1/Math.tan(t/2),r=1/(i-n);return this.setValues(s/e,0,0,0,0,s,0,0,0,0,(n+i)*r,-1,0,0,2*n*i*r,0)},perspectiveLH:function(t,e,i,n){return this.setValues(2*i/t,0,0,0,0,2*i/e,0,0,0,0,-n/(i-n),1,0,0,i*n/(i-n),0)},ortho:function(t,e,i,n,s,r){var a=t-e,o=i-n,h=s-r;return a=0===a?a:1/a,o=0===o?o:1/o,h=0===h?h:1/h,this.setValues(-2*a,0,0,0,0,-2*o,0,0,0,0,2*h,0,(t+e)*a,(n+i)*o,(r+s)*h,1)},lookAtRH:function(t,e,i){var n=this.val;return h.subVectors(t,e),0===h.lengthSq()&&(h.z=1),h.normalize(),a.crossVectors(i,h),0===a.lengthSq()&&(1===Math.abs(i.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),a.crossVectors(i,h)),a.normalize(),o.crossVectors(h,a),n[0]=a.x,n[1]=a.y,n[2]=a.z,n[4]=o.x,n[5]=o.y,n[6]=o.z,n[8]=h.x,n[9]=h.y,n[10]=h.z,this},lookAt:function(t,e,n){var s=t.x,r=t.y,a=t.z,o=n.x,h=n.y,l=n.z,u=e.x,c=e.y,d=e.z;if(Math.abs(s-u)<i&&Math.abs(r-c)<i&&Math.abs(a-d)<i)return this.identity();var f=s-u,p=r-c,g=a-d,m=1/Math.sqrt(f*f+p*p+g*g),v=h*(g*=m)-l*(p*=m),y=l*(f*=m)-o*g,x=o*p-h*f;(m=Math.sqrt(v*v+y*y+x*x))?(v*=m=1/m,y*=m,x*=m):(v=0,y=0,x=0);var w=p*x-g*y,b=g*v-f*x,T=f*y-p*v;return(m=Math.sqrt(w*w+b*b+T*T))?(w*=m=1/m,b*=m,T*=m):(w=0,b=0,T=0),this.setValues(v,w,f,0,y,b,p,0,x,T,g,0,-(v*s+y*r+x*a),-(w*s+b*r+T*a),-(f*s+p*r+g*a),1)},yawPitchRoll:function(t,e,i){this.zero(),s.zero(),r.zero();var n=this.val,a=s.val,o=r.val,h=Math.sin(i),l=Math.cos(i);return n[10]=1,n[15]=1,n[0]=l,n[1]=h,n[4]=-h,n[5]=l,h=Math.sin(e),l=Math.cos(e),a[0]=1,a[15]=1,a[5]=l,a[10]=l,a[9]=-h,a[6]=h,h=Math.sin(t),l=Math.cos(t),o[5]=1,o[15]=1,o[0]=l,o[2]=-h,o[8]=h,o[10]=l,this.multiplyLocal(s),this.multiplyLocal(r),this},setWorldMatrix:function(t,e,i,n,a){return this.yawPitchRoll(t.y,t.x,t.z),s.scaling(i.x,i.y,i.z),r.xyz(e.x,e.y,e.z),this.multiplyLocal(s),this.multiplyLocal(r),n&&this.multiplyLocal(n),a&&this.multiplyLocal(a),this},multiplyToMat4:function(t,e){var i=this.val,n=t.val,s=i[0],r=i[1],a=i[2],o=i[3],h=i[4],l=i[5],u=i[6],c=i[7],d=i[8],f=i[9],p=i[10],g=i[11],m=i[12],v=i[13],y=i[14],x=i[15],w=n[0],b=n[1],T=n[2],E=n[3],S=n[4],_=n[5],C=n[6],A=n[7],M=n[8],P=n[9],R=n[10],L=n[11],O=n[12],F=n[13],k=n[14],D=n[15];return e.setValues(w*s+b*h+T*d+E*m,b*r+b*l+T*f+E*v,T*a+b*u+T*p+E*y,E*o+b*c+T*g+E*x,S*s+_*h+C*d+A*m,S*r+_*l+C*f+A*v,S*a+_*u+C*p+A*y,S*o+_*c+C*g+A*x,M*s+P*h+R*d+L*m,M*r+P*l+R*f+L*v,M*a+P*u+R*p+L*y,M*o+P*c+R*g+L*x,O*s+F*h+k*d+D*m,O*r+F*l+k*f+D*v,O*a+F*u+k*p+D*y,O*o+F*c+k*g+D*x)},fromRotationXYTranslation:function(t,e,i){var n=e.x,s=e.y,r=e.z,a=Math.sin(t.x),o=Math.cos(t.x),h=Math.sin(t.y),l=Math.cos(t.y),u=n,c=s,d=r,f=-a,p=0-f*h,g=0-o*h,m=f*l,v=o*l;return i||(u=l*n+h*r,c=p*n+o*s+m*r,d=g*n+a*s+v*r),this.setValues(l,p,g,0,0,o,a,0,h,m,v,0,u,c,d,1)},getMaxScaleOnAxis:function(){var t=this.val,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}}),s=new n,r=new n,a=new e,o=new e,h=new e;return cb=n}function mX(){if(pb)return fb;pb=1;var t=Yh(),e=Ih(),i=gX(),n=Dh(),s=new i,r=new e({initialize:function t(e,i,s,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===r&&(r=t.DefaultOrder),this._x=e,this._y=i,this._z=s,this._order=r,this.onChangeCallback=n},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback(this)}},set:function(t,e,i,n){return void 0===n&&(n=this._order),this._x=t,this._y=e,this._z=i,this._order=n,this.onChangeCallback(this),this},copy:function(t){return this.set(t.x,t.y,t.z,t.order)},setFromQuaternion:function(t,e,i){return void 0===e&&(e=this._order),void 0===i&&(i=!1),s.fromQuat(t),this.setFromRotationMatrix(s,e,i)},setFromRotationMatrix:function(e,i,n){void 0===i&&(i=this._order),void 0===n&&(n=!1);var s=e.val,r=s[0],a=s[4],o=s[8],h=s[1],l=s[5],u=s[9],c=s[2],d=s[6],f=s[10],p=0,g=0,m=0,v=.99999;switch(i){case"XYZ":g=Math.asin(t(o,-1,1)),Math.abs(o)<v?(p=Math.atan2(-u,f),m=Math.atan2(-a,r)):p=Math.atan2(d,l);break;case"YXZ":p=Math.asin(-t(u,-1,1)),Math.abs(u)<v?(g=Math.atan2(o,f),m=Math.atan2(h,l)):g=Math.atan2(-c,r);break;case"ZXY":p=Math.asin(t(d,-1,1)),Math.abs(d)<v?(g=Math.atan2(-c,f),m=Math.atan2(-a,l)):m=Math.atan2(h,r);break;case"ZYX":g=Math.asin(-t(c,-1,1)),Math.abs(c)<v?(p=Math.atan2(d,f),m=Math.atan2(h,r)):m=Math.atan2(-a,l);break;case"YZX":m=Math.asin(t(h,-1,1)),Math.abs(h)<v?(p=Math.atan2(-u,l),g=Math.atan2(-c,r)):g=Math.atan2(o,f);break;case"XZY":m=Math.asin(-t(a,-1,1)),Math.abs(a)<v?(p=Math.atan2(d,l),g=Math.atan2(o,r)):p=Math.atan2(-u,f)}return this._x=p,this._y=g,this._z=m,this._order=i,n&&this.onChangeCallback(this),this}});return r.RotationOrders=["XYZ","YXZ","ZXY","ZYX","YZX","XZY"],r.DefaultOrder="XYZ",fb=r}function vX(){if(kb)return Fb;kb=1;var t=Gh();return Fb=function(e){return e*t.RAD_TO_DEG},Fb}function yX(){return Xb||(Xb=1,Yb=function(t,e){var i=t.x,n=t.y;return t.x=i*Math.cos(e)-n*Math.sin(e),t.y=i*Math.sin(e)+n*Math.cos(e),t}),Yb}function xX(){if(Zb)return Kb;Zb=1;var t=wu();return Kb=function(e,i,n,s){void 0===s&&(s=new t);var r=0,a=0;return e>0&&e<=i*n&&(r=e>i-1?e-(a=Math.floor(e/i))*i:e),s.set(r,a)}}function wX(){if(tT)return Qb;tT=1;var t=new(Ih())({initialize:function(t,e,i,n){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0)},clone:function(){return new t(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,i,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this.x=t*s,this.y=e*s,this.z=i*s,this.w=n*s),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=s+e*(t.z-s),this.w=r+e*(t.w-r),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return Math.sqrt(e*e+i*i+n*n+s*s)},distanceSq:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z||0,s=t.w-this.w||0;return e*e+i*i+n*n+s*s},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.val;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*s,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*s,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*s,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*s,this},transformQuat:function(t){var e=this.x,i=this.y,n=this.z,s=t.x,r=t.y,a=t.z,o=t.w,h=o*e+r*n-a*i,l=o*i+a*e-s*n,u=o*n+s*i-r*e,c=-s*e-r*i-a*n;return this.x=h*o+c*-s+l*-a-u*-r,this.y=l*o+c*-r+u*-s-h*-a,this.z=u*o+c*-a+h*-r-l*-s,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});return t.prototype.sub=t.prototype.subtract,t.prototype.mul=t.prototype.multiply,t.prototype.div=t.prototype.divide,t.prototype.dist=t.prototype.distance,t.prototype.distSq=t.prototype.distanceSq,t.prototype.len=t.prototype.length,t.prototype.lenSq=t.prototype.lengthSq,Qb=t}function bX(){if(iT)return eT;iT=1;var t=new(Ih())({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new t(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,i=t.val;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},fromMat4:function(t){var e=t.val,i=this.val;return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],i=t[2],n=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=i,t[7]=n,this},invert:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8],u=l*r-a*h,c=-l*s+a*o,d=h*s-r*o,f=e*u+i*c+n*d;return f?(f=1/f,t[0]=u*f,t[1]=(-l*i+n*h)*f,t[2]=(a*i-n*r)*f,t[3]=c*f,t[4]=(l*e-n*o)*f,t[5]=(-a*e+n*s)*f,t[6]=d*f,t[7]=(-h*e+i*o)*f,t[8]=(r*e-i*s)*f,this):null},adjoint:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return t[0]=r*l-a*h,t[1]=n*h-i*l,t[2]=i*a-n*r,t[3]=a*o-s*l,t[4]=e*l-n*o,t[5]=n*s-e*a,t[6]=s*h-r*o,t[7]=i*o-e*h,t[8]=e*r-i*s,this},determinant:function(){var t=this.val,e=t[0],i=t[1],n=t[2],s=t[3],r=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return e*(l*r-a*h)+i*(-l*s+a*o)+n*(h*s-r*o)},multiply:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=t.val,d=c[0],f=c[1],p=c[2],g=c[3],m=c[4],v=c[5],y=c[6],x=c[7],w=c[8];return e[0]=d*i+f*r+p*h,e[1]=d*n+f*a+p*l,e[2]=d*s+f*o+p*u,e[3]=g*i+m*r+v*h,e[4]=g*n+m*a+v*l,e[5]=g*s+m*o+v*u,e[6]=y*i+x*r+w*h,e[7]=y*n+x*a+w*l,e[8]=y*s+x*o+w*u,this},translate:function(t){var e=this.val,i=t.x,n=t.y;return e[6]=i*e[0]+n*e[3]+e[6],e[7]=i*e[1]+n*e[4]+e[7],e[8]=i*e[2]+n*e[5]+e[8],this},rotate:function(t){var e=this.val,i=e[0],n=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=Math.sin(t),l=Math.cos(t);return e[0]=l*i+h*r,e[1]=l*n+h*a,e[2]=l*s+h*o,e[3]=l*r-h*i,e[4]=l*a-h*n,e[5]=l*o-h*s,this},scale:function(t){var e=this.val,i=t.x,n=t.y;return e[0]=i*e[0],e[1]=i*e[1],e[2]=i*e[2],e[3]=n*e[3],e[4]=n*e[4],e[5]=n*e[5],this},fromQuat:function(t){var e=t.x,i=t.y,n=t.z,s=t.w,r=e+e,a=i+i,o=n+n,h=e*r,l=e*a,u=e*o,c=i*a,d=i*o,f=n*o,p=s*r,g=s*a,m=s*o,v=this.val;return v[0]=1-(c+f),v[3]=l+m,v[6]=u-g,v[1]=l-m,v[4]=1-(h+f),v[7]=d+p,v[2]=u+g,v[5]=d-p,v[8]=1-(h+c),this},normalFromMat4:function(t){var e=t.val,i=this.val,n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],l=e[6],u=e[7],c=e[8],d=e[9],f=e[10],p=e[11],g=e[12],m=e[13],v=e[14],y=e[15],x=n*h-s*o,w=n*l-r*o,b=n*u-a*o,T=s*l-r*h,E=s*u-a*h,S=r*u-a*l,_=c*m-d*g,C=c*v-f*g,A=c*y-p*g,M=d*v-f*m,P=d*y-p*m,R=f*y-p*v,L=x*R-w*P+b*M+T*A-E*C+S*_;return L?(L=1/L,i[0]=(h*R-l*P+u*M)*L,i[1]=(l*A-o*R-u*C)*L,i[2]=(o*P-h*A+u*_)*L,i[3]=(r*P-s*R-a*M)*L,i[4]=(n*R-r*A+a*C)*L,i[5]=(s*A-n*P-a*_)*L,i[6]=(m*S-v*E+y*T)*L,i[7]=(v*b-g*S-y*w)*L,i[8]=(g*E-m*b+y*x)*L,this):null}});return eT=t}function TX(){if(sT)return nT;sT=1;var t=Ih(),e=bX(),i=Dh(),n=pX(),s=1e-6,r=new Int8Array([1,2,0]),a=new Float32Array([0,0,0]),o=new n(1,0,0),h=new n(0,1,0),l=new n,u=new e,c=new t({initialize:function(t,e,n,s){this.onChangeCallback=i,this.set(t,e,n,s)},x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback(this)}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback(this)}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback(this)}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback(this)}},copy:function(t){return this.set(t)},set:function(t,e,i,n,s){return void 0===s&&(s=!0),"object"==typeof t?(this._x=t.x||0,this._y=t.y||0,this._z=t.z||0,this._w=t.w||0):(this._x=t||0,this._y=e||0,this._z=i||0,this._w=n||0),s&&this.onChangeCallback(this),this},add:function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.onChangeCallback(this),this},subtract:function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.onChangeCallback(this),this},scale:function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.onChangeCallback(this),this},length:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},lengthSq:function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},normalize:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),this._x=t*s,this._y=e*s,this._z=i*s,this._w=n*s),this.onChangeCallback(this),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var i=this.x,n=this.y,s=this.z,r=this.w;return this.set(i+e*(t.x-i),n+e*(t.y-n),s+e*(t.z-s),r+e*(t.w-r))},rotationTo:function(t,e){var i=t.x*e.x+t.y*e.y+t.z*e.z;return i<-.999999?(l.copy(o).cross(t).length()<s&&l.copy(h).cross(t),l.normalize(),this.setAxisAngle(l,Math.PI)):i>.999999?this.set(0,0,0,1):(l.copy(t).cross(e),this._x=l.x,this._y=l.y,this._z=l.z,this._w=1+i,this.normalize())},setAxes:function(t,e,i){var n=u.val;return n[0]=e.x,n[3]=e.y,n[6]=e.z,n[1]=i.x,n[4]=i.y,n[7]=i.z,n[2]=-t.x,n[5]=-t.y,n[8]=-t.z,this.fromMat3(u).normalize()},identity:function(){return this.set(0,0,0,1)},setAxisAngle:function(t,e){e*=.5;var i=Math.sin(e);return this.set(i*t.x,i*t.y,i*t.z,Math.cos(e))},multiply:function(t){var e=this.x,i=this.y,n=this.z,s=this.w,r=t.x,a=t.y,o=t.z,h=t.w;return this.set(e*h+s*r+i*o-n*a,i*h+s*a+n*r-e*o,n*h+s*o+e*a-i*r,s*h-e*r-i*a-n*o)},slerp:function(t,e){var i=this.x,n=this.y,r=this.z,a=this.w,o=t.x,h=t.y,l=t.z,u=t.w,c=i*o+n*h+r*l+a*u;c<0&&(c=-c,o=-o,h=-h,l=-l,u=-u);var d=1-e,f=e;if(1-c>s){var p=Math.acos(c),g=Math.sin(p);d=Math.sin((1-e)*p)/g,f=Math.sin(e*p)/g}return this.set(d*i+f*o,d*n+f*h,d*r+f*l,d*a+f*u)},invert:function(){var t=this.x,e=this.y,i=this.z,n=this.w,s=t*t+e*e+i*i+n*n,r=s?1/s:0;return this.set(-t*r,-e*r,-i*r,n*r)},conjugate:function(){return this._x=-this.x,this._y=-this.y,this._z=-this.z,this.onChangeCallback(this),this},rotateX:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+s*r,i*a+n*r,n*a-i*r,s*a-e*r)},rotateY:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a-n*r,i*a+s*r,n*a+e*r,s*a-i*r)},rotateZ:function(t){t*=.5;var e=this.x,i=this.y,n=this.z,s=this.w,r=Math.sin(t),a=Math.cos(t);return this.set(e*a+i*r,i*a-e*r,n*a+s*r,s*a-n*r)},calculateW:function(){var t=this.x,e=this.y,i=this.z;return this.w=-Math.sqrt(1-t*t-e*e-i*i),this},setFromEuler:function(t,e){var i=t.x/2,n=t.y/2,s=t.z/2,r=Math.cos(i),a=Math.cos(n),o=Math.cos(s),h=Math.sin(i),l=Math.sin(n),u=Math.sin(s);switch(t.order){case"XYZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"YXZ":this.set(h*a*o+r*l*u,r*l*o-h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"ZXY":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u+h*l*o,r*a*o-h*l*u,e);break;case"ZYX":this.set(h*a*o-r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o+h*l*u,e);break;case"YZX":this.set(h*a*o+r*l*u,r*l*o+h*a*u,r*a*u-h*l*o,r*a*o-h*l*u,e);break;case"XZY":this.set(h*a*o-r*l*u,r*l*o-h*a*u,r*a*u+h*l*o,r*a*o+h*l*u,e)}return this},setFromRotationMatrix:function(t){var e,i=t.val,n=i[0],s=i[4],r=i[8],a=i[1],o=i[5],h=i[9],l=i[2],u=i[6],c=i[10],d=n+o+c;return d>0?(e=.5/Math.sqrt(d+1),this.set((u-h)*e,(r-l)*e,(a-s)*e,.25/e)):n>o&&n>c?(e=2*Math.sqrt(1+n-o-c),this.set(.25*e,(s+a)/e,(r+l)/e,(u-h)/e)):o>c?(e=2*Math.sqrt(1+o-n-c),this.set((s+a)/e,.25*e,(h+u)/e,(r-l)/e)):(e=2*Math.sqrt(1+c-n-o),this.set((r+l)/e,(h+u)/e,.25*e,(a-s)/e)),this},fromMat3:function(t){var e,i=t.val,n=i[0]+i[4]+i[8];if(n>0)e=Math.sqrt(n+1),this.w=.5*e,e=.5/e,this._x=(i[7]-i[5])*e,this._y=(i[2]-i[6])*e,this._z=(i[3]-i[1])*e;else{var s=0;i[4]>i[0]&&(s=1),i[8]>i[3*s+s]&&(s=2);var o=r[s],h=r[o];e=Math.sqrt(i[3*s+s]-i[3*o+o]-i[3*h+h]+1),a[s]=.5*e,e=.5/e,a[o]=(i[3*o+s]+i[3*s+o])*e,a[h]=(i[3*h+s]+i[3*s+h])*e,this._x=a[0],this._y=a[1],this._z=a[2],this._w=(i[3*h+o]-i[3*o+h])*e}return this.onChangeCallback(this),this}});return nT=c}function EX(){if(aT)return rT;aT=1;var t=pX(),e=gX(),i=TX(),n=new e,s=new i,r=new t;return rT=function(t,e,i){return s.setAxisAngle(e,i),n.fromRotationTranslation(s,r.set(0,0,0)),t.transformMat4(n)},rT}function SX(){if(hT)return oT;hT=1;var t=Gh(),e=jo(),i={Angle:Vx?Wx:(Vx=1,Wx={Between:BY(),BetweenPoints:NY(),BetweenPointsY:wx?xx:(wx=1,xx=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}),BetweenY:Tx?bx:(Tx=1,bx=function(t,e,i,n){return Math.atan2(i-t,n-e)}),CounterClockwise:zY(),GetClockwiseDistance:YY(),GetCounterClockwiseDistance:XY(),GetShortestDistance:GY(),Normalize:UY(),Random:WY(),RandomDegrees:VY(),Reverse:jY(),RotateTo:qY(),ShortestBetween:Hx?Gx:(Hx=1,Gx=function(t,e){var i=e-t;return 0===i?0:i-360*Math.floor((i- -180)/360)}),Wrap:ju(),WrapDegrees:qu()}),Distance:sw?nw:(sw=1,nw={Between:EU(),BetweenPoints:Wz(),BetweenPointsSquared:qx?jx:(qx=1,jx=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}),Chebyshev:Zx?Kx:(Zx=1,Kx=function(t,e,i,n){return Math.max(Math.abs(t-i),Math.abs(e-n))}),Power:Jx?$x:(Jx=1,$x=function(t,e,i,n,s){return void 0===s&&(s=2),Math.sqrt(Math.pow(i-t,s)+Math.pow(n-e,s))}),Snake:tw?Qx:(tw=1,Qx=function(t,e,i,n){return Math.abs(t-i)+Math.abs(e-n)}),Squared:KY()}),Easing:aw?rw:(aw=1,rw={Back:Vz(),Bounce:jz(),Circular:qz(),Cubic:Kz(),Elastic:Zz(),Expo:$z(),Linear:Jz(),Quadratic:Qz(),Quartic:tU(),Quintic:eU(),Sine:iU(),Stepped:nU()}),Fuzzy:mw?gw:(mw=1,gw={Ceil:hw?ow:(hw=1,ow=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}),Equal:xu(),Floor:uw?lw:(uw=1,lw=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}),GreaterThan:ZY(),LessThan:$Y()}),Interpolation:Nw?Bw:(Nw=1,Bw={Bezier:tX(),CatmullRom:iX(),CubicBezier:nX(),Linear:sX(),QuadraticBezier:rX(),SmoothStep:aX(),SmootherStep:oX()}),Pow2:Vw?Ww:(Vw=1,Ww={GetNext:hX(),IsSize:lX(),IsValue:Hw?Gw:(Hw=1,Gw=function(t){return t>0&&!(t&t-1)})}),Snap:tb?Qw:(tb=1,Qw={Ceil:uX(),Floor:cX(),To:dX()}),RandomDataGenerator:fX(),Average:sb?nb:(sb=1,nb=function(t){for(var e=0,i=0;i<t.length;i++)e+=+t[i];return e/t.length}),Bernstein:QY(),Between:sY(),CatmullRom:eX(),CeilTo:ab?rb:(ab=1,rb=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.ceil(t*n)/n}),Clamp:Yh(),DegToRad:Ou(),Difference:hb?ob:(hb=1,ob=function(t,e){return Math.abs(t-e)}),Euler:mX(),Factorial:JY(),FloatBetween:HY(),FloorTo:mb?gb:(mb=1,gb=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.floor(t*n)/n}),FromPercent:Xh(),GetSpeed:(yb||(yb=1,vb=function(t,e){return t/e/1e3}),vb),IsEven:wb?xb:(wb=1,xb=function(t){return t==parseFloat(t)?!(t%2):void 0}),IsEvenStrict:Tb?bb:(Tb=1,bb=function(t){return t===parseFloat(t)?!(t%2):void 0}),Linear:OY(),LinearXY:Sb?Eb:(Sb=1,Eb=function(t,e,i){return void 0===i&&(i=0),t.clone().lerp(e,i)}),MaxAdd:Cb?_b:(Cb=1,_b=function(t,e,i){return Math.min(t+e,i)}),Median:Mb?Ab:(Mb=1,Ab=function(t){var e=t.length;if(0===e)return 0;t.sort(function(t,e){return t-e});var i=Math.floor(e/2);return e%2==0?(t[i]+t[i-1])/2:t[i]}),MinSub:Rb?Pb:(Rb=1,Pb=function(t,e,i){return Math.max(t-e,i)}),Percent:Ob?Lb:(Ob=1,Lb=function(t,e,i,n){void 0===i&&(i=e+1);var s=(t-e)/(i-e);return s>1?void 0!==n?(s=(n-t)/(n-i))<0&&(s=0):s=1:s<0&&(s=0),s}),RadToDeg:vX(),RandomXY:(Ib||(Ib=1,Db=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI;return t.x=Math.cos(i)*e,t.y=Math.sin(i)*e,t}),Db),RandomXYZ:Nb?Bb:(Nb=1,Bb=function(t,e){void 0===e&&(e=1);var i=2*Math.random()*Math.PI,n=2*Math.random()-1,s=Math.sqrt(1-n*n)*e;return t.x=Math.cos(i)*s,t.y=Math.sin(i)*s,t.z=n*e,t}),RandomXYZW:(Ub||(Ub=1,zb=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}),zb),Rotate:yX(),RotateAround:Su(),RotateAroundDistance:TU(),RotateTo:(Hb||(Hb=1,Gb=function(t,e,i,n,s){return t.x=e+s*Math.cos(n),t.y=i+s*Math.sin(n),t}),Gb),RoundAwayFromZero:xl(),RoundTo:Vb?Wb:(Vb=1,Wb=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var n=Math.pow(i,-e);return Math.round(t*n)/n}),SinCosTableGenerator:qb?jb:(qb=1,jb=function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=1),n*=Math.PI/t;for(var s=[],r=[],a=0;a<t;a++)e+=(i-=e*n)*n,s[a]=i,r[a]=e;return{sin:r,cos:s,length:t}}),SmootherStep:VU(),SmoothStep:qU(),ToXY:xX(),TransformXY:Wu(),Within:Jb?$b:(Jb=1,$b=function(t,e,i){return Math.abs(t-e)<=i}),Wrap:Vu(),Vector2:wu(),Vector3:pX(),Vector4:wX(),Matrix3:bX(),Matrix4:gX(),Quaternion:TX(),RotateVec3:EX()};return i=e(!1,i,t),oT=i}function _X(){return uT?lT:(uT=1,lT={BITMAPMASK_PIPELINE:"BitmapMaskPipeline",LIGHT_PIPELINE:"Light2D",POINTLIGHT_PIPELINE:"PointLightPipeline",SINGLE_PIPELINE:"SinglePipeline",MULTI_PIPELINE:"MultiPipeline",ROPE_PIPELINE:"RopePipeline",GRAPHICS_PIPELINE:"GraphicsPipeline",POSTFX_PIPELINE:"PostFXPipeline",UTILITY_PIPELINE:"UtilityPipeline",MOBILE_PIPELINE:"MobilePipeline",FX_PIPELINE:"FxPipeline"})}function CX(){if(dT)return cT;dT=1;var t=Ih(),e=Wo(),i=IY(),n=Xl(),s=kh(),r=Tl(),a=Vo(),o=Dh(),h=SX(),l=_X(),u=TY(),c=new t({initialize:function(t){void 0===t&&(t={});var c=r(t,"scale",null);this.width=r(c,"width",1024,t),this.height=r(c,"height",768,t),this.zoom=r(c,"zoom",1,t),this.parent=r(c,"parent",void 0,t),this.scaleMode=r(c,c?"mode":"scaleMode",0,t),this.expandParent=r(c,"expandParent",!0,t),this.autoRound=r(c,"autoRound",!1,t),this.autoCenter=r(c,"autoCenter",0,t),this.resizeInterval=r(c,"resizeInterval",500,t),this.fullscreenTarget=r(c,"fullscreenTarget",null,t),this.minWidth=r(c,"min.width",0,t),this.maxWidth=r(c,"max.width",0,t),this.minHeight=r(c,"min.height",0,t),this.maxHeight=r(c,"max.height",0,t),this.snapWidth=r(c,"snap.width",0,t),this.snapHeight=r(c,"snap.height",0,t),this.renderType=e.WEBGL,this.canvas=r(t,"canvas",null),this.context=r(t,"context",null),this.canvasStyle=r(t,"canvasStyle",null),this.customEnvironment=r(t,"customEnvironment",!1),this.sceneConfig=r(t,"scene",null),this.seed=r(t,"seed",[(Date.now()*Math.random()).toString()]),h.RND=new h.RandomDataGenerator(this.seed),this.gameTitle=r(t,"title",""),this.gameURL=r(t,"url",""),this.gameVersion=r(t,"version",""),this.autoFocus=r(t,"autoFocus",!0),this.stableSort=r(t,"stableSort",-1),-1===this.stableSort&&(this.stableSort=n.browser.es2019?1:0),n.features.stableSort=this.stableSort,this.domCreateContainer=r(t,"dom.createContainer",!1),this.domPointerEvents=r(t,"dom.pointerEvents","none"),this.inputKeyboard=r(t,"input.keyboard",!0),this.inputKeyboardEventTarget=r(t,"input.keyboard.target",window),this.inputKeyboardCapture=r(t,"input.keyboard.capture",[]),this.inputMouse=r(t,"input.mouse",!0),this.inputMouseEventTarget=r(t,"input.mouse.target",null),this.inputMousePreventDefaultDown=r(t,"input.mouse.preventDefaultDown",!0),this.inputMousePreventDefaultUp=r(t,"input.mouse.preventDefaultUp",!0),this.inputMousePreventDefaultMove=r(t,"input.mouse.preventDefaultMove",!0),this.inputMousePreventDefaultWheel=r(t,"input.mouse.preventDefaultWheel",!0),this.inputTouch=r(t,"input.touch",n.input.touch),this.inputTouchEventTarget=r(t,"input.touch.target",null),this.inputTouchCapture=r(t,"input.touch.capture",!0),this.inputActivePointers=r(t,"input.activePointers",1),this.inputSmoothFactor=r(t,"input.smoothFactor",0),this.inputWindowEvents=r(t,"input.windowEvents",!0),this.inputGamepad=r(t,"input.gamepad",!1),this.inputGamepadEventTarget=r(t,"input.gamepad.target",window),this.disableContextMenu=r(t,"disableContextMenu",!1),this.audio=r(t,"audio",{}),this.bannerTextColor=r(t,"banner.text","#ffffff"),this.bannerBackgroundColor=r(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),this.fps=r(t,"fps",null),this.disablePreFX=r(t,"disablePreFX",!1),this.disablePostFX=r(t,"disablePostFX",!1);var d=r(t,"render",null);this.pipeline=r(d,"pipeline",null,t),this.autoMobilePipeline=r(d,"autoMobilePipeline",!0,t),this.defaultPipeline=r(d,"defaultPipeline",l.MULTI_PIPELINE,t),this.antialias=r(d,"antialias",!0,t),this.antialiasGL=r(d,"antialiasGL",!0,t),this.mipmapFilter=r(d,"mipmapFilter","",t),this.desynchronized=r(d,"desynchronized",!1,t),this.roundPixels=r(d,"roundPixels",!1,t),this.pixelArt=r(d,"pixelArt",1!==this.zoom,t),this.pixelArt&&(this.antialias=!1,this.antialiasGL=!1,this.roundPixels=!0),this.transparent=r(d,"transparent",!1,t),this.clearBeforeRender=r(d,"clearBeforeRender",!0,t),this.preserveDrawingBuffer=r(d,"preserveDrawingBuffer",!1,t),this.premultipliedAlpha=r(d,"premultipliedAlpha",!0,t),this.failIfMajorPerformanceCaveat=r(d,"failIfMajorPerformanceCaveat",!1,t),this.powerPreference=r(d,"powerPreference","default",t),this.batchSize=r(d,"batchSize",4096,t),this.maxTextures=r(d,"maxTextures",-1,t),this.maxLights=r(d,"maxLights",10,t);var f=r(t,"backgroundColor",0);this.backgroundColor=u(f),this.transparent&&(this.backgroundColor=u(0),this.backgroundColor.alpha=0),this.preBoot=r(t,"callbacks.preBoot",o),this.postBoot=r(t,"callbacks.postBoot",o),this.physics=r(t,"physics",{}),this.defaultPhysicsSystem=r(this.physics,"default",!1),this.loaderBaseURL=r(t,"loader.baseURL",""),this.loaderPath=r(t,"loader.path",""),this.loaderMaxParallelDownloads=r(t,"loader.maxParallelDownloads",n.os.android?6:32),this.loaderCrossOrigin=r(t,"loader.crossOrigin",void 0),this.loaderResponseType=r(t,"loader.responseType",""),this.loaderAsync=r(t,"loader.async",!0),this.loaderUser=r(t,"loader.user",""),this.loaderPassword=r(t,"loader.password",""),this.loaderTimeout=r(t,"loader.timeout",0),this.loaderMaxRetries=r(t,"loader.maxRetries",2),this.loaderWithCredentials=r(t,"loader.withCredentials",!1),this.loaderImageLoadType=r(t,"loader.imageLoadType","XHR"),this.loaderLocalScheme=r(t,"loader.localScheme",["file://","capacitor://"]),this.glowFXQuality=r(t,"fx.glow.quality",.1),this.glowFXDistance=r(t,"fx.glow.distance",10),this.installGlobalPlugins=[],this.installScenePlugins=[];var p=r(t,"plugins",null),g=i.DefaultScene;p&&(Array.isArray(p)?this.defaultPlugins=p:a(p)&&(this.installGlobalPlugins=s(p,"global",[]),this.installScenePlugins=s(p,"scene",[]),Array.isArray(p.default)?g=p.default:Array.isArray(p.defaultMerge)&&(g=g.concat(p.defaultMerge)))),this.defaultPlugins=g;var m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=r(t,"images.default",m+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=r(t,"images.missing",m+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),this.whiteImage=r(t,"images.white","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMMMDEgAdwcgAADAJZuAwXJYZOzAAAAAElFTkSuQmCC")}});return cT=c}function AX(){return pT||(pT=1,fT={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach(function(e){t.style["image-rendering"]=e}),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}}),fT}function MX(){if(mT)return gT;mT=1;var t=Dl(),e=mY(),i=kh();return gT=function(n,s){var r=i(s,"callback"),a=i(s,"type","image/png"),o=i(s,"encoder",.92),h=Math.abs(Math.round(i(s,"x",0))),l=Math.abs(Math.round(i(s,"y",0))),u=Math.floor(i(s,"width",n.width)),c=Math.floor(i(s,"height",n.height));if(i(s,"getPixel",!1)){var d=n.getContext("2d",{willReadFrequently:!1}).getImageData(h,l,1,1).data;r.call(null,new e(d[0],d[1],d[2],d[3]))}else if(0!==h||0!==l||u!==n.width||c!==n.height){var f=t.createWebGL(this,u,c),p=f.getContext("2d",{willReadFrequently:!0});u>0&&c>0&&p.drawImage(n,h,l,u,c,0,0,u,c);var g=new Image;g.onerror=function(){r.call(null),t.remove(f)},g.onload=function(){r.call(null,g),t.remove(f)},g.src=f.toDataURL(a,o)}else{var m=new Image;m.onerror=function(){r.call(null)},m.onload=function(){r.call(null,m)},m.src=n.toDataURL(a,o)}},gT}function PX(){return RT?PT:(RT=1,PT={LOSE_WEBGL:yT?vT:(yT=1,vT="losewebgl"),POST_RENDER:wT?xT:(wT=1,xT="postrender"),PRE_RENDER:TT?bT:(TT=1,bT="prerender"),RENDER:ST?ET:(ST=1,ET="render"),RESIZE:CT?_T:(CT=1,_T="resize"),RESTORE_WEBGL:MT?AT:(MT=1,AT="restorewebgl")})}function RX(){if(OT)return LT;OT=1;var t=Go(),e=Yl();return LT=function(){var i=[],n=e.supportNewBlendModes,s="source-over";return i[t.NORMAL]=s,i[t.ADD]="lighter",i[t.MULTIPLY]=n?"multiply":s,i[t.SCREEN]=n?"screen":s,i[t.OVERLAY]=n?"overlay":s,i[t.DARKEN]=n?"darken":s,i[t.LIGHTEN]=n?"lighten":s,i[t.COLOR_DODGE]=n?"color-dodge":s,i[t.COLOR_BURN]=n?"color-burn":s,i[t.HARD_LIGHT]=n?"hard-light":s,i[t.SOFT_LIGHT]=n?"soft-light":s,i[t.DIFFERENCE]=n?"difference":s,i[t.EXCLUSION]=n?"exclusion":s,i[t.HUE]=n?"hue":s,i[t.SATURATION]=n?"saturation":s,i[t.COLOR]=n?"color":s,i[t.LUMINOSITY]=n?"luminosity":s,i[t.ERASE]="destination-out",i[t.SOURCE_IN]="source-in",i[t.SOURCE_OUT]="source-out",i[t.SOURCE_ATOP]="source-atop",i[t.DESTINATION_OVER]="destination-over",i[t.DESTINATION_IN]="destination-in",i[t.DESTINATION_OUT]="destination-out",i[t.DESTINATION_ATOP]="destination-atop",i[t.LIGHTER]="lighter",i[t.COPY]="copy",i[t.XOR]="xor",i}}function LX(){return qT?jT:(qT=1,jT={ADD:kT?FT:(kT=1,FT="addtexture"),ADD_KEY:IT?DT:(IT=1,DT="addtexture-"),ERROR:NT?BT:(NT=1,BT="onerror"),LOAD:UT?zT:(UT=1,zT="onload"),READY:XT?YT:(XT=1,YT="ready"),REMOVE:HT?GT:(HT=1,GT="removetexture"),REMOVE_KEY:VT?WT:(VT=1,WT="removetexture-")})}function OX(){if(ZT)return KT;ZT=1;var t=cY(),e=MX(),i=Ih(),n=Wo(),s=Iz(),r=PX(),a=RX(),o=kY(),h=LX(),l=iY(),u=Hu(),c=new i({Extends:s,initialize:function(t){s.call(this);var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,backgroundColor:e.backgroundColor,antialias:e.antialias,roundPixels:e.roundPixels,transparent:e.transparent},this.game=t,this.type=n.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.gameCanvas=t.canvas;var i={alpha:e.transparent,desynchronized:e.desynchronized,willReadFrequently:!1};this.gameContext=e.context?e.context:this.gameCanvas.getContext("2d",i),this.currentContext=this.gameContext,this.antialias=e.antialias,this.blendModes=a(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new u,this._tempMatrix2=new u,this._tempMatrix3=new u,this.isBooted=!1,this.init()},init:function(){var t=this.game;t.events.once(l.BOOT,function(){var t=this.config;if(!t.transparent){var e=this.gameContext,i=this.gameCanvas;e.fillStyle=t.backgroundColor.rgba,e.fillRect(0,0,i.width,i.height)}},this),t.textures.once(h.READY,this.boot,this)},boot:function(){var t=this.game,e=t.scale.baseSize;this.width=e.width,this.height=e.height,this.isBooted=!0,t.scale.on(o.RESIZE,this.onResize,this),this.resize(e.width,e.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e,this.emit(r.RESIZE,t,e)},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,i=this.width,n=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),this.emit(r.PRE_RENDER_CLEAR),e.clearBeforeRender&&(t.clearRect(0,0,i,n),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,i,n))),t.save(),this.drawCount=0,this.emit(r.PRE_RENDER)},render:function(e,i,n){var s=i.length;this.emit(r.RENDER,e,n);var a=n.x,o=n.y,h=n.width,l=n.height,u=n.renderToTexture?n.context:e.sys.context;u.save(),this.game.scene.customViewports&&(u.beginPath(),u.rect(a,o,h,l),u.clip()),n.emit(t.PRE_RENDER,n),this.currentContext=u;var c=n.mask;c&&c.preRenderCanvas(this,null,n._maskCamera),n.transparent||(u.fillStyle=n.backgroundColor.rgba,u.fillRect(a,o,h,l)),u.globalAlpha=n.alpha,u.globalCompositeOperation="source-over",this.drawCount+=s,n.renderToTexture&&n.emit(t.PRE_RENDER,n),n.matrix.copyToContext(u);for(var d=0;d<s;d++){var f=i[d];f.mask&&f.mask.preRenderCanvas(this,f,n),f.renderCanvas(this,f,n),f.mask&&f.mask.postRenderCanvas(this,f,n)}u.setTransform(1,0,0,1,0,0),u.globalCompositeOperation="source-over",u.globalAlpha=1,n.flashEffect.postRenderCanvas(u),n.fadeEffect.postRenderCanvas(u),n.dirty=!1,c&&c.postRenderCanvas(this),u.restore(),n.renderToTexture&&(n.emit(t.POST_RENDER,n),n.renderToGame&&e.sys.context.drawImage(n.canvas,a,o)),n.emit(t.POST_RENDER,n)},postRender:function(){this.gameContext.restore(),this.emit(r.POST_RENDER);var t=this.snapshotState;t.callback&&(e(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,i,n,s,r,a,o,h,l){void 0===n&&(n=!1),this.snapshotArea(s,r,a,o,i,h,l);var u=this.snapshotState;return u.getPixel=n,e(t,u),u.callback=null,this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=Math.min(i,this.gameCanvas.width),o.height=Math.min(n,this.gameCanvas.height),this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,i,n){var s=i.alpha*t.alpha;if(0!==s){var r=this.currentContext,a=this._tempMatrix1,o=this._tempMatrix2,h=e.canvasData,l=h.x,u=h.y,c=e.cutWidth,d=e.cutHeight,f=e.customPivot,p=e.source.resolution,g=t.displayOriginX,m=t.displayOriginY,v=-g+e.x,y=-m+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),c=x.cw,d=x.ch,l=x.cx,u=x.cy,v=-g+x.x,y=-m+x.y,t.flipX&&(v>=0?v=-(v+c):v<0&&(v=Math.abs(v)-c)),t.flipY&&(y>=0?y=-(y+d):y<0&&(y=Math.abs(y)-d))}var w=1,b=1;t.flipX&&(f||(v+=-e.realWidth+2*g),w=-1),t.flipY&&(f||(y+=-e.realHeight+2*m),b=-1);var T=t.x,E=t.y;if(i.roundPixels&&(T=Math.floor(T),E=Math.floor(E)),o.applyITRS(T,E,t.rotation,t.scaleX*w,t.scaleY*b),a.copyFrom(i.matrix),n?(a.multiplyWithOffset(n,-i.scrollX*t.scrollFactorX,-i.scrollY*t.scrollFactorY),o.e=T,o.f=E):(o.e-=i.scrollX*t.scrollFactorX,o.f-=i.scrollY*t.scrollFactorY),a.multiply(o),i.renderRoundPixels&&(a.e=Math.floor(a.e+.5),a.f=Math.floor(a.f+.5)),r.save(),a.setToContext(r),r.globalCompositeOperation=this.blendModes[t.blendMode],r.globalAlpha=s,r.imageSmoothingEnabled=!e.source.scaleMode,t.mask&&t.mask.preRenderCanvas(this,t,i),c>0&&d>0){var S=c/p,_=d/p;i.roundPixels&&(v=Math.floor(v+.5),y=Math.floor(y+.5),S+=.5,_+=.5),r.drawImage(e.source.image,l,u,c,d,v,y,S,_)}t.mask&&t.mask.postRenderCanvas(this,t,i),r.restore()}},destroy:function(){this.removeAllListeners(),this.game=null,this.gameCanvas=null,this.gameContext=null}});return KT=c}function FX(){if(JT)return $T;JT=1;var t=Ih(),e=PX(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){void 0===s&&(s=1),void 0===r&&(r=0),void 0===a&&(a=!0),void 0===o&&(o=!1),void 0===h&&(h=!0),void 0===l&&(l=!0),this.renderer=t,this.framebuffer=null,this.texture=null,this.width=0,this.height=0,this.scale=s,this.minFilter=r,this.autoClear=a,this.autoResize=!0,this.hasDepthBuffer=h,this.forceClamp=l,this.init(i,n),o?this.renderer.on(e.RESIZE,this.resize,this):this.autoResize=!1},init:function(t,e){var i=this.renderer;this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e},setAutoResize:function(t){return t&&!this.autoResize?(this.renderer.on(e.RESIZE,this.resize,this),this.autoResize=!0):!t&&this.autoResize&&(this.renderer.off(e.RESIZE,this.resize,this),this.autoResize=!1),this},resize:function(t,e){if(this.autoResize&&this.willResize(t,e)){var i=this.renderer;i.deleteFramebuffer(this.framebuffer),i.deleteTexture(this.texture),this.texture=i.createTextureFromSource(null,t,e,this.minFilter,this.forceClamp),this.framebuffer=i.createFramebuffer(t,e,this.texture,this.hasDepthBuffer),this.width=t,this.height=e}return this},willResize:function(t,e){return"number"==typeof t&&"number"==typeof e&&(t=Math.round(t*this.scale),e=Math.round(e*this.scale),t=Math.max(t,1),e=Math.max(e,1),t!==this.width||e!==this.height)},bind:function(t,e,i){void 0===t&&(t=!1);var n=this.renderer;if(t&&n.flush(),e&&i&&this.resize(e,i),n.pushFramebuffer(this.framebuffer,!1,!1),t&&this.adjustViewport(),this.autoClear){var s=this.renderer.gl;s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT)}n.clearStencilMask()},adjustViewport:function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),t.disable(t.SCISSOR_TEST)},clear:function(t,e,i,n){var s=this.renderer,r=s.gl;s.pushFramebuffer(this.framebuffer),void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?(r.enable(r.SCISSOR_TEST),r.scissor(t,e,i,n)):r.disable(r.SCISSOR_TEST),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),s.popFramebuffer(),s.resetScissor()},unbind:function(t){void 0===t&&(t=!1);var e=this.renderer;return t&&e.flush(),e.popFramebuffer()},destroy:function(){var t=this.renderer;t.off(e.RESIZE,this.resize,this),t.deleteFramebuffer(this.framebuffer),t.deleteTexture(this.texture),this.renderer=null,this.framebuffer=null,this.texture=null}});return $T=i}function kX(){return tE?QT:(tE=1,QT=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","precision mediump float;","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","void main ()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    if (!uInvertMaskAlpha)","    {","        mainColor *= maskColor.a;","    }","    else","    {","        mainColor *= (1.0 - maskColor.a);","    }","    gl_FragColor = mainColor;","}"].join("\n"))}function DX(){return iE?eE:(iE=1,eE=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","precision mediump float;","attribute vec2 inPosition;","void main ()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}"].join("\n"))}function IX(){return sE?nE:(sE=1,nE={BYTE:{enum:5120,size:1},UNSIGNED_BYTE:{enum:5121,size:1},SHORT:{enum:5122,size:2},UNSIGNED_SHORT:{enum:5123,size:2},INT:{enum:5124,size:4},UNSIGNED_INT:{enum:5125,size:4},FLOAT:{enum:5126,size:4}})}function BX(){return wE?xE:(wE=1,xE={AFTER_FLUSH:aE?rE:(aE=1,rE="pipelineafterflush"),BEFORE_FLUSH:hE?oE:(hE=1,oE="pipelinebeforeflush"),BIND:uE?lE:(uE=1,lE="pipelinebind"),BOOT:dE?cE:(dE=1,cE="pipelineboot"),DESTROY:pE?fE:(pE=1,fE="pipelinedestroy"),REBIND:mE?gE:(mE=1,gE="pipelinerebind"),RESIZE:yE?vE:(yE=1,vE="pipelineresize")})}function NX(){return TE||(TE=1,bE={getTintFromFloats:function(t,e,i,n){return((255*n&255)<<24|(255*t&255)<<16|(255*e&255)<<8|255*i&255)>>>0},getTintAppendFloatAlpha:function(t,e){return((255*e&255)<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255*e&255)<<24|(255&t)<<16|(t>>8&255)<<8|t>>16&255)>>>0},getFloatsFromUintRGB:function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},checkShaderMax:function(t,e){var i=Math.min(16,t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));return e&&-1!==e?Math.min(i,e):i},parseFragmentShaderMaxTextures:function(t,e){if(!t)return"";for(var i="",n=0;n<e;n++)n>0&&(i+="\n\telse "),n<e-1&&(i+="if (outTexId < "+n+".5)"),i+="\n\t{",i+="\n\t\ttexture = texture2D(uMainSampler["+n+"], outTexCoord);",i+="\n\t}";return(t=t.replace(/%count%/gi,e.toString())).replace(/%forloop%/gi,i)},setGlowQuality:function(t,e,i,n){return void 0===i&&(i=e.config.glowFXQuality),void 0===n&&(n=e.config.glowFXDistance),(t=t.replace(/__SIZE__/gi,(1/i/n).toFixed(7))).replace(/__DIST__/gi,n.toFixed(0)+".0")}}),bE}function zX(){if(SE)return EE;SE=1;var t=Ih(),e=cl(),i=kh(),n=IX(),s=new t({initialize:function(t,e,i,n,s){this.pipeline=t,this.name=e,this.renderer=t.renderer,this.gl=this.renderer.gl,this.fragSrc=n,this.vertSrc=i,this.program=this.renderer.createProgram(i,n),this.attributes,this.vertexComponentCount=0,this.vertexSize=0,this.uniforms={},this.createAttributes(s),this.createUniforms()},createAttributes:function(t){var e=0,s=0,r=[];this.vertexComponentCount=0;for(var a=0;a<t.length;a++){var o=t[a],h=o.name,l=i(o,"size",1),u=i(o,"type",n.FLOAT),c=u.enum,d=u.size,f=!!o.normalized;r.push({name:h,size:l,type:c,normalized:f,offset:s,enabled:!1,location:-1}),4===d?e+=l:e++,s+=l*d}this.vertexSize=s,this.vertexComponentCount=e,this.attributes=r},bind:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),e&&this.pipeline.flush(),this.renderer.setProgram(this.program),t&&this.setAttribPointers(),this},rebind:function(){return this.renderer.setProgram(this.program),this.setAttribPointers(!0),this},setAttribPointers:function(t){void 0===t&&(t=!1);for(var e=this.gl,i=this.renderer,n=this.vertexSize,s=this.attributes,r=this.program,a=0;a<s.length;a++){var o=s[a],h=o.size,l=o.type,u=o.offset,c=o.enabled,d=o.location,f=!!o.normalized;if(t){-1!==d&&i.deleteAttribLocation(d);var p=this.renderer.createAttribLocation(r,o.name);p.webGLAttribLocation>=0?(e.enableVertexAttribArray(p.webGLAttribLocation),e.vertexAttribPointer(p.webGLAttribLocation,h,l,f,n,u),o.enabled=!0,o.location=p):-1!==p.webGLAttribLocation&&e.disableVertexAttribArray(p.webGLAttribLocation)}else c?e.vertexAttribPointer(d.webGLAttribLocation,h,l,f,n,u):!c&&-1!==d&&d.webGLAttribLocation>-1&&(e.disableVertexAttribArray(d.webGLAttribLocation),o.location=-1)}return this},createUniforms:function(){var t,e,i,n=this.gl,s=this.program,r=this.uniforms,a=n.getProgramParameter(s.webGLProgram,n.ACTIVE_UNIFORMS);for(t=0;t<a;t++){var o=n.getActiveUniform(s.webGLProgram,t);if(o){e=o.name,null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null});var h=e.indexOf("[");h>0&&(e=e.substr(0,h),r.hasOwnProperty(e)||null!==(i=this.renderer.createUniformLocation(s,e))&&(r[e]={name:e,location:i,setter:null,value1:null,value2:null,value3:null,value4:null}))}}return this},syncUniforms:function(){var t=this.gl;for(var e in this.renderer.setProgram(this.program),this.uniforms){var i=this.uniforms[e];i.setter&&i.setter.call(t,i.location.webGLUniformLocation,i.value1,i.value2,i.value3,i.value4)}},hasUniform:function(t){return this.uniforms.hasOwnProperty(t)},resetUniform:function(t){var e=this.uniforms[t];return e&&(e.value1=null,e.value2=null,e.value3=null,e.value4=null),this},setUniform1:function(t,e,i,n){var s=this.uniforms[e];return s?((n||s.value1!==i)&&(s.setter||(s.setter=t),s.value1=i,this.renderer.setProgram(this.program),t.call(this.gl,s.location.webGLUniformLocation,i),this.pipeline.currentShader=this),this):this},setUniform2:function(t,e,i,n,s){var r=this.uniforms[e];return r?((s||r.value1!==i||r.value2!==n)&&(r.setter||(r.setter=t),r.value1=i,r.value2=n,this.renderer.setProgram(this.program),t.call(this.gl,r.location.webGLUniformLocation,i,n),this.pipeline.currentShader=this),this):this},setUniform3:function(t,e,i,n,s,r){var a=this.uniforms[e];return a?((r||a.value1!==i||a.value2!==n||a.value3!==s)&&(a.setter||(a.setter=t),a.value1=i,a.value2=n,a.value3=s,this.renderer.setProgram(this.program),t.call(this.gl,a.location.webGLUniformLocation,i,n,s),this.pipeline.currentShader=this),this):this},setUniform4:function(t,e,i,n,s,r,a){var o=this.uniforms[e];return o?((a||o.value1!==i||o.value2!==n||o.value3!==s||o.value4!==r)&&(o.setter||(o.setter=t),o.value1=i,o.value2=n,o.value3=s,o.value4=r,this.renderer.setProgram(this.program),t.call(this.gl,o.location.webGLUniformLocation,i,n,s,r),this.pipeline.currentShader=this),this):this},setBoolean:function(t,e){return this.setUniform1(this.gl.uniform1i,t,Number(e))},set1f:function(t,e){return this.setUniform1(this.gl.uniform1f,t,e)},set2f:function(t,e,i){return this.setUniform2(this.gl.uniform2f,t,e,i)},set3f:function(t,e,i,n){return this.setUniform3(this.gl.uniform3f,t,e,i,n)},set4f:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4f,t,e,i,n,s)},set1fv:function(t,e){return this.setUniform1(this.gl.uniform1fv,t,e,!0)},set2fv:function(t,e){return this.setUniform1(this.gl.uniform2fv,t,e,!0)},set3fv:function(t,e){return this.setUniform1(this.gl.uniform3fv,t,e,!0)},set4fv:function(t,e){return this.setUniform1(this.gl.uniform4fv,t,e,!0)},set1iv:function(t,e){return this.setUniform1(this.gl.uniform1iv,t,e,!0)},set2iv:function(t,e){return this.setUniform1(this.gl.uniform2iv,t,e,!0)},set3iv:function(t,e){return this.setUniform1(this.gl.uniform3iv,t,e,!0)},set4iv:function(t,e){return this.setUniform1(this.gl.uniform4iv,t,e,!0)},set1i:function(t,e){return this.setUniform1(this.gl.uniform1i,t,e)},set2i:function(t,e,i){return this.setUniform2(this.gl.uniform2i,t,e,i)},set3i:function(t,e,i,n){return this.setUniform3(this.gl.uniform3i,t,e,i,n)},set4i:function(t,e,i,n,s){return this.setUniform4(this.gl.uniform4i,t,e,i,n,s)},setMatrix2fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix2fv,t,e,i,!0)},setMatrix3fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix3fv,t,e,i,!0)},setMatrix4fv:function(t,e,i){return this.setUniform2(this.gl.uniformMatrix4fv,t,e,i,!0)},createProgram:function(t,e){return void 0===t&&(t=this.vertSrc),void 0===e&&(e=this.fragSrc),this.program&&this.renderer.deleteProgram(this.program),this.vertSrc=t,this.fragSrc=e,this.program=this.renderer.createProgram(t,e),this.createUniforms(),this.rebind()},destroy:function(){var t=this.renderer;e(this.uniforms,function(e){t.deleteUniformLocation(e.location)}),this.uniforms=null,e(this.attributes,function(e){t.deleteAttribLocation(e.location)}),this.attributes=null,t.deleteProgram(this.program),this.pipeline=null,this.renderer=null,this.gl=null,this.program=null}});return EE=s}function UX(){if(CE)return _E;CE=1;var t=Ih(),e=Iu(),i=Iz(),n=BX(),s=kh(),r=gX(),a=PX(),o=FX(),h=NX(),l=zX(),u=new t({Extends:i,initialize:function(t){i.call(this);var e=t.game,n=e.renderer,r=n.gl;this.name=s(t,"name","WebGLPipeline"),this.game=e,this.renderer=n,this.manager,this.gl=r,this.view=e.canvas,this.width=0,this.height=0,this.vertexCount=0,this.vertexCapacity=0,this.vertexData,this.vertexBuffer,this.activeBuffer,this.topology=s(t,"topology",r.TRIANGLES),this.bytes,this.vertexViewF32,this.vertexViewU32,this.active=!0,this.forceZero=s(t,"forceZero",!1),this.hasBooted=!1,this.isPostFX=!1,this.isPreFX=!1,this.renderTargets=[],this.currentRenderTarget,this.shaders=[],this.currentShader,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.config=t,this.glReset=!1,this.batch=[],this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.activeTextures=[],this.resizeUniform=s(t,"resizeUniform","")},boot:function(){var t,e=this.gl,i=this.config,h=this.renderer;this.isPostFX||(this.projectionMatrix=(new r).identity());var l=this.renderTargets,u=s(i,"renderTarget",!1);"boolean"==typeof u&&u&&(u=1);var c=h.width,d=h.height;if("number"==typeof u)for(t=0;t<u;t++)l.push(new o(h,c,d,1,0,!0));else if(Array.isArray(u))for(t=0;t<u.length;t++){var f=s(u[t],"scale",1),p=s(u[t],"minFilter",0),g=s(u[t],"autoClear",1),m=s(u[t],"autoResize",!1),v=s(u[t],"width",null),y=s(u[t],"height",v);v?l.push(new o(h,v,y,1,p,g,m)):l.push(new o(h,c,d,f,p,g,m))}l.length&&(this.currentRenderTarget=l[0]),this.setShadersFromConfig(i);var x=this.shaders,w=0;for(t=0;t<x.length;t++)x[t].vertexSize>w&&(w=x[t].vertexSize);var b=s(i,"batchSize",h.config.batchSize);this.vertexCapacity=6*b;var T=new ArrayBuffer(this.vertexCapacity*w);this.vertexData=T,this.bytes=new Uint8Array(T),this.vertexViewF32=new Float32Array(T),this.vertexViewU32=new Uint32Array(T);var E=s(i,"vertices",null);for(E?(this.vertexViewF32.set(E),this.vertexBuffer=h.createVertexBuffer(T,e.STATIC_DRAW)):this.vertexBuffer=h.createVertexBuffer(T.byteLength,e.DYNAMIC_DRAW),this.setVertexBuffer(),t=x.length-1;t>=0;t--)x[t].rebind();this.hasBooted=!0,h.on(a.RESIZE,this.resize,this),h.on(a.PRE_RENDER,this.onPreRender,this),h.on(a.RENDER,this.onRender,this),h.on(a.POST_RENDER,this.onPostRender,this),this.emit(n.BOOT,this),this.onBoot()},onBoot:function(){},onResize:function(){},setShader:function(t,e,i){var n=this.renderer;return t===this.currentShader&&n.currentProgram===this.currentShader.program||(this.flush(),this.setVertexBuffer(i)&&!e&&(e=!0),t.bind(e,!1),this.currentShader=t),this},getShaderByName:function(t){for(var e=this.shaders,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},setShadersFromConfig:function(t){var i,n=this.shaders,r=this.renderer;for(i=0;i<n.length;i++)n[i].destroy();var a="vertShader",o="fragShader",u="attributes",c=s(t,a,null),d=h.parseFragmentShaderMaxTextures(s(t,o,null),r.maxTextures),f=s(t,u,null),p=s(t,"shaders",[]),g=p.length;if(0===g)c&&d&&(this.shaders=[new l(this,"default",c,d,e(f))]);else{var m=[];for(i=0;i<g;i++){var v,y,x,w,b=p[i];if("string"==typeof b?(v="default",y=c,x=h.parseFragmentShaderMaxTextures(b,r.maxTextures),w=f):(v=s(b,"name","default"),y=s(b,a,c),x=h.parseFragmentShaderMaxTextures(s(b,o,d),r.maxTextures),w=s(b,u,f)),"default"===v){var T=x.split("\n")[0].trim();T.indexOf("#define SHADER_NAME")>-1&&(v=T.substring(20))}y&&x&&m.push(new l(this,v,y,x,e(w)))}this.shaders=m}return 0===this.shaders.length?console.warn("Pipeline: "+this.name+" - Invalid shader config"):this.currentShader=this.shaders[0],this},createBatch:function(t){return this.currentBatch={start:this.vertexCount,count:0,texture:[t],unit:0,maxUnit:0},this.currentUnit=0,this.currentTexture=t,this.batch.push(this.currentBatch),0},addTextureToBatch:function(t){var e=this.currentBatch;e&&(e.texture.push(t),e.unit++,e.maxUnit++)},pushBatch:function(t){if(!this.currentBatch||this.forceZero&&t!==this.currentTexture)return this.createBatch(t);if(t===this.currentTexture)return this.currentUnit;var e=this.currentBatch,i=e.texture.indexOf(t);return-1===i?e.texture.length===this.renderer.maxTextures?this.createBatch(t):(e.unit++,e.maxUnit++,e.texture.push(t),this.currentUnit=e.unit,this.currentTexture=t,e.unit):(this.currentUnit=i,this.currentTexture=t,i)},setGameObject:function(t,e){return void 0===e&&(e=t.frame),this.pushBatch(e.source.glTexture)},shouldFlush:function(t){return void 0===t&&(t=0),this.vertexCount+t>this.vertexCapacity},vertexAvailable:function(){return this.vertexCapacity-this.vertexCount},resize:function(t,e){t===this.width&&e===this.height||this.flush(),this.width=t,this.height=e;for(var i=this.renderTargets,s=0;s<i.length;s++)i[s].resize(t,e);return this.setProjectionMatrix(t,e),this.resizeUniform&&this.set2f(this.resizeUniform,t,e),this.emit(n.RESIZE,t,e,this),this.onResize(t,e),this},setProjectionMatrix:function(t,e){var i=this.projectionMatrix;if(!i)return this;this.projectionWidth=t,this.projectionHeight=e,i.ortho(0,t,e,0,-1e3,1e3);for(var n=this.shaders,s="uProjectionMatrix",r=0;r<n.length;r++){var a=n[r];a.hasUniform(s)&&(a.resetUniform(s),a.setMatrix4fv(s,!1,i.val,a))}return this},flipProjectionMatrix:function(t){void 0===t&&(t=!0);var e=this.projectionMatrix;if(!e)return this;var i=this.projectionWidth,n=this.projectionHeight;t?e.ortho(0,i,0,n,-1e3,1e3):e.ortho(0,i,n,0,-1e3,1e3),this.setMatrix4fv("uProjectionMatrix",!1,e.val)},updateProjectionMatrix:function(){if(this.projectionMatrix){var t=this.renderer.projectionWidth,e=this.renderer.projectionHeight;this.projectionWidth===t&&this.projectionHeight===e||this.setProjectionMatrix(t,e)}},bind:function(t){if(void 0===t&&(t=this.currentShader),this.glReset)return this.rebind(t);var e=!1,i=this.gl;return i.getParameter(i.ARRAY_BUFFER_BINDING)!==this.vertexBuffer&&(i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer.webGLBuffer),this.activeBuffer=this.vertexBuffer,e=!0),t.bind(e),this.currentShader=t,this.activeTextures.length=0,this.emit(n.BIND,this,t),this.onActive(t),this},rebind:function(t){this.activeBuffer=null,this.setVertexBuffer();for(var e=this.shaders,i=e.length-1;i>=0;i--){var s=e[i].rebind();t&&s!==t||(this.currentShader=s)}return this.activeTextures.length=0,this.emit(n.REBIND,this.currentShader),this.onActive(this.currentShader),this.onRebind(),this.glReset=!1,this},restoreContext:function(){var t=this.shaders,e=!!this.vertexBuffer;this.activeBuffer=null,this.activeTextures.length=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,e&&this.setVertexBuffer();for(var i=0;i<t.length;i++){var n=t[i];n.syncUniforms(),e&&n.rebind()}},setVertexBuffer:function(t){if(void 0===t&&(t=this.vertexBuffer),t!==this.activeBuffer){var e=this.gl;return this.gl.bindBuffer(e.ARRAY_BUFFER,t.webGLBuffer),this.activeBuffer=t,!0}return!1},preBatch:function(t){return this.currentRenderTarget&&this.currentRenderTarget.bind(),this.onPreBatch(t),this},postBatch:function(t){return this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(){},unbind:function(){this.currentRenderTarget&&this.currentRenderTarget.unbind()},flush:function(t){if(void 0===t&&(t=!1),this.vertexCount>0){this.emit(n.BEFORE_FLUSH,this,t),this.onBeforeFlush(t);var e=this.gl,i=this.vertexCount,s=this.currentShader.vertexSize,r=this.topology;if(this.active){var a,o,h;this.setVertexBuffer(),i===this.vertexCapacity?e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,this.bytes.subarray(0,i*s));var l=this.batch,u=this.activeTextures;if(this.forceZero)for(u[0]||e.activeTexture(e.TEXTURE0),a=0;a<l.length;a++)h=(o=l[a]).texture[0],u[0]!==h&&(e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[0]=h),e.drawArrays(r,o.start,o.count);else for(a=0;a<l.length;a++){o=l[a];for(var c=0;c<=o.maxUnit;c++)h=o.texture[c],u[c]!==h&&(e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,h.webGLTexture),u[c]=h);e.drawArrays(r,o.start,o.count)}}this.vertexCount=0,this.batch.length=0,this.currentBatch=null,this.currentTexture=null,this.currentUnit=0,this.emit(n.AFTER_FLUSH,this,t),this.onAfterFlush(t)}return this},onActive:function(){},onBind:function(){},onRebind:function(){},onBatch:function(){},onPreBatch:function(){},onPostBatch:function(){},onPreRender:function(){},onRender:function(){},onPostRender:function(){},onBeforeFlush:function(){},onAfterFlush:function(){},batchVert:function(t,e,i,n,s,r,a){var o=this.vertexViewF32,h=this.vertexViewU32,l=this.vertexCount*this.currentShader.vertexComponentCount-1;o[++l]=t,o[++l]=e,o[++l]=i,o[++l]=n,o[++l]=s,o[++l]=r,h[++l]=a,this.vertexCount++,this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchQuad:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m,v,y,x){void 0===x&&(x=this.currentUnit);var w=!1;this.shouldFlush(6)&&(this.flush(),w=!0),this.currentBatch||(x=this.setTexture2D(y));var b=this.vertexViewF32,T=this.vertexViewU32,E=this.vertexCount*this.currentShader.vertexComponentCount-1;return b[++E]=e,b[++E]=i,b[++E]=l,b[++E]=u,b[++E]=x,b[++E]=v,T[++E]=f,b[++E]=n,b[++E]=s,b[++E]=l,b[++E]=d,b[++E]=x,b[++E]=v,T[++E]=g,b[++E]=r,b[++E]=a,b[++E]=c,b[++E]=d,b[++E]=x,b[++E]=v,T[++E]=m,b[++E]=e,b[++E]=i,b[++E]=l,b[++E]=u,b[++E]=x,b[++E]=v,T[++E]=f,b[++E]=r,b[++E]=a,b[++E]=c,b[++E]=d,b[++E]=x,b[++E]=v,T[++E]=m,b[++E]=o,b[++E]=h,b[++E]=c,b[++E]=u,b[++E]=x,b[++E]=v,T[++E]=p,this.vertexCount+=6,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),w},batchTri:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m){void 0===m&&(m=this.currentUnit);var v=!1;this.shouldFlush(3)&&(this.flush(),v=!0),this.currentBatch||(m=this.setTexture2D(g));var y=this.vertexViewF32,x=this.vertexViewU32,w=this.vertexCount*this.currentShader.vertexComponentCount-1;return y[++w]=e,y[++w]=i,y[++w]=o,y[++w]=h,y[++w]=m,y[++w]=p,x[++w]=c,y[++w]=n,y[++w]=s,y[++w]=o,y[++w]=u,y[++w]=m,y[++w]=p,x[++w]=d,y[++w]=r,y[++w]=a,y[++w]=l,y[++w]=u,y[++w]=m,y[++w]=p,x[++w]=f,this.vertexCount+=3,this.currentBatch.count=this.vertexCount-this.currentBatch.start,this.onBatch(t),v},drawFillRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=this.renderer.whiteTexture),void 0===o&&(o=!0),t=Math.floor(t),e=Math.floor(e);var l=Math.floor(t+i),u=Math.floor(e+n),c=this.setTexture2D(a),d=h.getTintAppendFloatAlphaAndSwap(s,r),f=0,p=1;o&&(f=1,p=0),this.batchQuad(null,t,e,t,u,l,u,l,e,0,f,1,p,d,d,d,d,0,a,c)},setTexture2D:function(t){return void 0===t&&(t=this.renderer.whiteTexture),this.pushBatch(t)},bindTexture:function(t,e){void 0===e&&(e=0);var i=this.gl;return i.activeTexture(i.TEXTURE0+e),i.bindTexture(i.TEXTURE_2D,t.webGLTexture),this},bindRenderTarget:function(t,e){return this.bindTexture(t.texture,e)},setTime:function(t,e){return this.set1f(t,this.game.loop.getDuration(),e),this},setBoolean:function(t,e,i){return void 0===i&&(i=this.currentShader),i.setBoolean(t,e),this},set1f:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1f(t,e),this},set2f:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2f(t,e,i),this},set3f:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3f(t,e,i,n),this},set4f:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4f(t,e,i,n,s),this},set1fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1fv(t,e),this},set2fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2fv(t,e),this},set3fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3fv(t,e),this},set4fv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4fv(t,e),this},set1iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1iv(t,e),this},set2iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set2iv(t,e),this},set3iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set3iv(t,e),this},set4iv:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set4iv(t,e),this},set1i:function(t,e,i){return void 0===i&&(i=this.currentShader),i.set1i(t,e),this},set2i:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.set2i(t,e,i),this},set3i:function(t,e,i,n,s){return void 0===s&&(s=this.currentShader),s.set3i(t,e,i,n),this},set4i:function(t,e,i,n,s,r){return void 0===r&&(r=this.currentShader),r.set4i(t,e,i,n,s),this},setMatrix2fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix2fv(t,e,i),this},setMatrix3fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix3fv(t,e,i),this},setMatrix4fv:function(t,e,i,n){return void 0===n&&(n=this.currentShader),n.setMatrix4fv(t,e,i),this},destroy:function(){var t;this.emit(n.DESTROY,this);var e=this.shaders;for(t=0;t<e.length;t++)e[t].destroy();var i=this.renderTargets;for(t=0;t<i.length;t++)i[t].destroy();var s=this.renderer;return s.deleteBuffer(this.vertexBuffer),s.off(a.RESIZE,this.resize,this),s.off(a.PRE_RENDER,this.onPreRender,this),s.off(a.RENDER,this.onRender,this),s.off(a.POST_RENDER,this.onPostRender,this),this.removeAllListeners(),this.game=null,this.renderer=null,this.manager=null,this.gl=null,this.view=null,this.shaders=null,this.renderTargets=null,this.bytes=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexData=null,this.vertexBuffer=null,this.currentShader=null,this.currentRenderTarget=null,this.activeTextures=null,this}});return _E=u}function YX(){if(ME)return AE;ME=1;var t=Ih(),e=kh(),i=kX(),n=DX(),s=IX(),r=UX(),a=new t({Extends:r,initialize:function(t){t.fragShader=e(t,"fragShader",i),t.vertShader=e(t,"vertShader",n),t.batchSize=e(t,"batchSize",1),t.vertices=e(t,"vertices",[-1,1,-1,-7,7,1]),t.attributes=e(t,"attributes",[{name:"inPosition",size:2,type:s.FLOAT}]),r.call(this,t)},boot:function(){r.prototype.boot.call(this),this.set1i("uMainSampler",0),this.set1i("uMaskSampler",1)},resize:function(t,e){r.prototype.resize.call(this,t,e),this.set2f("uResolution",t,e)},beginMask:function(t,e,i){this.renderer.beginBitmapMask(t,i)},endMask:function(t,e,i){var n=this.gl,s=this.renderer,r=t.bitmapMask;r&&n&&(s.drawBitmapMask(r,e,this),i&&this.set2f("uResolution",i.width,i.height),this.set1i("uInvertMaskAlpha",t.invertAlpha),n.drawArrays(this.topology,0,3),i&&this.set2f("uResolution",this.width,this.height),n.bindTexture(n.TEXTURE_2D,null))}});return AE=a}function XX(){return RE?PE:(RE=1,PE=["#define SHADER_NAME BARREL_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float amount;","varying vec2 outTexCoord;","vec2 Distort(vec2 p)","{","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, amount);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * (p + 1.0);","}","void main()","{","    vec2 xy = 2.0 * outTexCoord - 1.0;","    vec2 texCoord = outTexCoord;","    if (length(xy) < 1.0)","    {","        texCoord = Distort(xy);","    }","    gl_FragColor = texture2D(uMainSampler, texCoord);","}"].join("\n"))}function GX(){return OE?LE:(OE=1,LE=["#define SHADER_NAME PHASER_POSTFX_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord);","}"].join("\n"))}function HX(){return kE?FE:(kE=1,FE=["#define SHADER_NAME PHASER_QUAD_VS","precision mediump float;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","varying vec2 outFragCoord;","varying vec2 outTexCoord;","void main ()","{","    outFragCoord = inPosition.xy * 0.5 + 0.5;","    outTexCoord = inTexCoord;","    gl_Position = vec4(inPosition, 0, 1);","}"].join("\n"))}function WX(){if(IE)return DE;IE=1;var t=Ih(),e=Ql(),i=kh(),n=GX(),s=HX(),r=UX(),a=new t({Extends:r,initialize:function(t){t.renderTarget=i(t,"renderTarget",1),t.fragShader=i(t,"fragShader",n),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),t.batchSize=1,t.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],r.call(this,t),this.isPostFX=!0,this.gameObject,this.controller,this.colorMatrix=new e,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderer.isBooted&&(this.manager=this.renderer.pipelines)},bootFX:function(){r.prototype.boot.call(this);var t=this.manager.UTILITY_PIPELINE;this.fullFrame1=t.fullFrame1,this.fullFrame2=t.fullFrame2,this.halfFrame1=t.halfFrame1,this.halfFrame2=t.halfFrame2;var e=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",e.width,e.height);for(var i=this.renderTargets,n=0;n<i.length;n++)i[n].autoResize=!0},postBatch:function(t){return this.hasBooted||(this.bootFX(),this.currentRenderTarget&&this.currentRenderTarget.bind()),this.onDraw(this.currentRenderTarget),this.onPostBatch(t),this},onDraw:function(t){this.bindAndDraw(t)},getController:function(t){return void 0!==t?t:this.controller?this.controller:this},copySprite:function(t,e,i){void 0===i&&(i=!1);var n=this.gl;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.texture.webGLTexture);var s=n.getParameter(n.FRAMEBUFFER_BINDING);n.bindFramebuffer(n.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e.texture.webGLTexture,0),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.bufferData(n.ARRAY_BUFFER,this.vertexData,n.STATIC_DRAW),n.drawArrays(n.TRIANGLES,0,6),i&&(n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,s))},copyFrame:function(t,e,i,n,s){this.manager.copyFrame(t,e,i,n,s)},copyToGame:function(t){this.manager.copyToGame(t)},drawFrame:function(t,e,i){this.manager.drawFrame(t,e,i,this.colorMatrix)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},clearFrame:function(t,e){this.manager.clearFrame(t,e)},blitFrame:function(t,e,i,n,s,r){this.manager.blitFrame(t,e,i,n,s,r)},copyFrameRect:function(t,e,i,n,s,r,a,o){this.manager.copyFrameRect(t,e,i,n,s,r,a,o)},bindAndDraw:function(t,e,i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);var r=this.gl,a=this.renderer;this.bind(s),this.set1i("uMainSampler",0),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0),i&&(n?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT))):(a.popFramebuffer(!1,!1),a.currentFramebuffer||r.viewport(0,0,a.width,a.height)),a.restoreStencilMask(),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),e&&(r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,a.currentFramebuffer.webGLFramebuffer))},destroy:function(){return this.controller&&this.controller.destroy(),this.gameObject=null,this.controller=null,this.colorMatrix=null,this.fullFrame1=null,this.fullFrame2=null,this.halfFrame1=null,this.halfFrame2=null,this.manager.removePostPipeline(this),r.prototype.destroy.call(this),this}});return DE=a}function VX(){if(NE)return BE;NE=1;var t=Ih(),e=XX(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e){t=this.getController(t),this.set1f("amount",t.amount,e)}});return BE=n}function jX(){return UE?zE:(UE=1,zE=["#define SHADER_NAME BLOOM_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec4 sum = texture2D(uMainSampler, outTexCoord) * 0.204164 * strength;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord - offset * 1.407333) * 0.304005;","    sum = sum + texture2D(uMainSampler, outTexCoord + offset * 3.294215) * 0.093913;","    gl_FragColor = (sum + texture2D(uMainSampler, outTexCoord - offset * 3.294215) * 0.093913) * vec4(color, 1);","}"].join("\n"))}function qX(){if(XE)return YE;XE=1;var t=Ih(),e=jX(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.steps=4,this.offsetX=1,this.offsetY=1,this.blurStrength=1,this.strength=1,this.glcolor=[1,1,1]},onPreRender:function(t){t=this.getController(t),this.set1f("strength",t.blurStrength),this.set3fv("color",t.glcolor)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1,n=this.fullFrame2;this.copyFrame(t,n);for(var s=2/t.width*e.offsetX,r=2/t.height*e.offsetY,a=0;a<e.steps;a++)this.set2f("offset",s,0),this.copySprite(t,i),this.set2f("offset",0,r),this.copySprite(i,t);this.blendFrames(n,t,i,e.strength),this.copyToGame(i)}});return YE=n}function KX(){return HE?GE:(HE=1,GE=["#define SHADER_NAME BLUR_LOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 offset = vec2(1.333) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.29411764705882354;","    col += texture2D(uMainSampler, uv + (offset / resolution)) * 0.35294117647058826;","    col += texture2D(uMainSampler, uv - (offset / resolution)) * 0.35294117647058826;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function ZX(){return VE?WE:(VE=1,WE=["#define SHADER_NAME BLUR_MED_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.3846153846) * offset * strength;","    vec2 off2 = vec2(3.2307692308) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.2270270270;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.3162162162;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.0702702703;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.0702702703;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function $X(){return qE?jE:(qE=1,jE=["#define SHADER_NAME BLUR_HIGH_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec2 offset;","uniform float strength;","uniform vec3 color;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 col = vec4(0.0);","    vec2 off1 = vec2(1.411764705882353) * offset * strength;","    vec2 off2 = vec2(3.2941176470588234) * offset * strength;","    vec2 off3 = vec2(5.176470588235294) * offset * strength;","    col += texture2D(uMainSampler, uv) * 0.1964825501511404;","    col += texture2D(uMainSampler, uv + (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv - (off1 / resolution)) * 0.2969069646728344;","    col += texture2D(uMainSampler, uv + (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv - (off2 / resolution)) * 0.09447039785044732;","    col += texture2D(uMainSampler, uv + (off3 / resolution)) * 0.010381362401148057;","    col += texture2D(uMainSampler, uv - (off3 / resolution)) * 0.010381362401148057;","    gl_FragColor = col * vec4(color, 1.0);","}"].join("\n"))}function JX(){if(ZE)return KE;ZE=1;var t=Ih(),e=KX(),i=ZX(),n=$X(),s=WX(),r=new t({Extends:s,initialize:function(t){s.call(this,{game:t,shaders:[{name:"Gaussian5",fragShader:e},{name:"Gaussian9",fragShader:i},{name:"Gaussian13",fragShader:n}]}),this.activeShader=this.shaders[0],this.x=2,this.y=2,this.steps=4,this.strength=1,this.glcolor=[1,1,1]},setQualityLow:function(){return this.activeShader=this.shaders[0],this},setQualityMedium:function(){return this.activeShader=this.shaders[1],this},setQualityHigh:function(){return this.activeShader=this.shaders[2],this},onDraw:function(t){var e=this.getController(),i=this.gl,n=this.fullFrame1,s=i.getParameter(i.FRAMEBUFFER_BINDING);this.bind(this.shaders[e.quality]),i.activeTexture(i.TEXTURE0),i.viewport(0,0,t.width,t.height),this.set1i("uMainSampler",0),this.set2f("resolution",t.width,t.height),this.set1f("strength",e.strength),this.set3fv("color",e.glcolor);for(var r=0;r<e.steps;r++)this.set2f("offset",e.x,0),this.copySprite(t,n),this.set2f("offset",0,e.y),this.copySprite(n,t);i.bindFramebuffer(i.FRAMEBUFFER,s),i.bindTexture(i.TEXTURE_2D,null),this.copyToGame(t)}});return KE=r}function QX(){return JE?$E:(JE=1,$E=["#define SHADER_NAME BOKEH_FS","precision mediump float;","#define ITERATIONS 100.0","#define ONEOVER_ITR 1.0 / ITERATIONS","#define PI 3.141596","#define GOLDEN_ANGLE 2.39996323","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float radius;","uniform float amount;","uniform float contrast;","uniform bool isTiltShift;","uniform float strength;","uniform vec2 blur;","varying vec2 outTexCoord;","vec2 Sample (in float theta, inout float r)","{","    r += 1.0 / r;","    return (r - 1.0) * vec2(cos(theta), sin(theta)) * 0.06;","}","vec3 Bokeh (sampler2D tex, vec2 uv, float radius)","{","    vec3 acc = vec3(0.0);","    vec3 div = vec3(0.0);","    vec2 pixel = vec2(resolution.y / resolution.x, 1.0) * radius * .025;","    float r = 1.0;","    for (float j = 0.0; j < GOLDEN_ANGLE * ITERATIONS; j += GOLDEN_ANGLE)","    {","        vec3 col = texture2D(tex, uv + pixel * Sample(j, r)).xyz;","        col = contrast > 0.0 ? col * col * (1.0 + contrast) : col;","        vec3 bokeh = vec3(0.5) + pow(col, vec3(10.0)) * amount;","        acc += col * bokeh;","        div += bokeh;","    }","    return acc / div;","}","void main ()","{","    float shift = 1.0;","    if (isTiltShift)","    {","        vec2 uv = vec2(gl_FragCoord.xy / resolution + vec2(-0.5, -0.5)) * 2.0;","        float centerStrength = 1.0;","        shift = length(uv * blur * strength) * centerStrength;","    }","    gl_FragColor = vec4(Bokeh(uMainSampler, outTexCoord * vec2(1.0, 1.0), radius * shift), 0.0);","}"].join("\n"))}function tG(){if(tS)return QE;tS=1;var t=Ih(),e=QX(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.isTiltShift=!1,this.strength=1,this.blurX=1,this.blurY=1,this.radius=.5,this.amount=1,this.contrast=.2},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("amount",t.amount,e),this.set1f("contrast",t.contrast,e),this.set1f("strength",t.strength,e),this.set2f("blur",t.blurX,t.blurY,e),this.setBoolean("isTiltShift",t.isTiltShift,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return QE=n}function eG(){return iS?eS:(iS=1,eS=["#define SHADER_NAME CIRCLE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform vec3 color;","uniform vec4 backgroundColor;","uniform float thickness;","uniform float scale;","uniform float feather;","varying vec2 outTexCoord;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 position = (gl_FragCoord.xy / resolution.xy) * 2.0 - 1.0;","    float aspectRatio = resolution.x / resolution.y;","    position.x *= aspectRatio;","    float grad = length(position);","    float outer = aspectRatio;","    float inner = outer - (thickness * 2.0 / resolution.y);","    if (aspectRatio >= 1.0)","    {","        float f = 2.0 + (resolution.y / resolution.x);","        outer = 1.0;","        inner = 1.0 - (thickness * f / resolution.x);","    }","    outer *= scale;","    inner *= scale;","    float circle = smoothstep(outer, outer - 0.01, grad);","    float ring = circle - smoothstep(inner, inner - feather, grad);","    texture = mix(backgroundColor * backgroundColor.a, texture, texture.a);","    texture = (texture * (circle - ring));","    gl_FragColor = vec4(texture.rgb + (ring * color), texture.a);","}"].join("\n"))}function iG(){if(sS)return nS;sS=1;var t=Ih(),e=eG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.scale=1,this.feather=.005,this.thickness=8,this.glcolor=[1,.2,.7],this.glcolor2=[1,0,0,.4]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("scale",t.scale,e),this.set1f("feather",t.feather,e),this.set1f("thickness",t.thickness,e),this.set3fv("color",t.glcolor,e),this.set4fv("backgroundColor",t.glcolor2,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return nS=n}function nG(){if(aS)return rS;aS=1;var t=Ih(),e=WX(),i=new t({Extends:e,initialize:function(t){e.call(this,{game:t})},onDraw:function(t){var e=this.fullFrame1;this.controller?this.manager.drawFrame(t,e,!0,this.controller):this.drawFrame(t,e),this.copyToGame(e)}});return rS=i}function sG(){return hS?oS:(hS=1,oS=["#define SHADER_NAME DISPLACEMENT_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform sampler2D uDisplacementSampler;","uniform vec2 amount;","varying vec2 outTexCoord;","void main ()","{","    vec2 disp = (-vec2(0.5, 0.5) + texture2D(uDisplacementSampler, outTexCoord).rr) * amount;","    gl_FragColor = texture2D(uMainSampler, outTexCoord + disp).rgba;","}"].join("\n"))}function rG(){if(uS)return lS;uS=1;var t=Ih(),e=sG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.005,this.y=.005,this.glTexture},onBoot:function(){this.setTexture("__WHITE")},setTexture:function(t){var e=this.game.textures.getFrame(t);e&&(this.glTexture=e.glTexture)},onDraw:function(t){var e=this.getController(),i=this.fullFrame1;this.bind(),this.set1i("uMainSampler",0),this.set1i("uDisplacementSampler",1),this.set2f("amount",e.x,e.y),this.bindTexture(e.glTexture,1),this.copySprite(t,i),this.copyToGame(i)}});return lS=n}function aG(){return dS?cS:(dS=1,cS=["#define SHADER_NAME GLOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform float outerStrength;","uniform float innerStrength;","uniform vec2 resolution;","uniform vec4 glowColor;","uniform bool knockout;","const float PI = 3.14159265358979323846264;","const float DIST = __DIST__;","const float SIZE = min(__SIZE__, PI * 2.0);","const float STEP = ceil(PI * 2.0 / SIZE);","const float MAX_ALPHA = STEP * DIST * (DIST + 1.0) / 2.0;","void main ()","{","    vec2 px = vec2(1.0 / resolution.x, 1.0 / resolution.y);","    float totalAlpha = 0.0;","    vec2 direction;","    vec2 displaced;","    vec4 color;","    for (float angle = 0.0; angle < PI * 2.0; angle += SIZE)","    {","        direction = vec2(cos(angle), sin(angle)) * px;","        for (float curDistance = 0.0; curDistance < DIST; curDistance++)","        {","            displaced = outTexCoord + direction * (curDistance + 1.0);","            color = texture2D(uMainSampler, displaced);","            totalAlpha += (DIST - curDistance) * color.a;","        }","    }","    color = texture2D(uMainSampler, outTexCoord);","    float alphaRatio = (totalAlpha / MAX_ALPHA);","    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * color.a;","    float innerGlowStrength = min(1.0, innerGlowAlpha);","    vec4 innerColor = mix(color, glowColor, innerGlowStrength);","    float outerGlowAlpha = alphaRatio * outerStrength * (1.0 - color.a);","    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);","    vec4 outerGlowColor = outerGlowStrength * glowColor.rgba;","    if (knockout)","    {","        float resultAlpha = outerGlowAlpha + innerGlowAlpha;","        gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);","    }","    else","    {","        gl_FragColor = innerColor + outerGlowColor;","    }","}"].join("\n"))}function oG(){if(pS)return fS;pS=1;var t=Ih(),e=kh(),i=aG(),n=WX(),s=NX(),r=new t({Extends:n,initialize:function(t,r){var a=e(r,"quality",.1),o=e(r,"distance",10);n.call(this,{game:t,fragShader:s.setGlowQuality(i,t,a,o)}),this.outerStrength=4,this.innerStrength=0,this.knockout=!1,this.glcolor=[1,1,1,1]},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("outerStrength",t.outerStrength,e),this.set1f("innerStrength",t.innerStrength,e),this.set4fv("glowColor",t.glcolor,e),this.setBoolean("knockout",t.knockout,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return fS=r}function hG(){return mS?gS:(mS=1,gS=["#define SHADER_NAME GRADIENT_FS","#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))","#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))","#define SRGB(r, g, b) SRGB_TO_LINEAR(vec3(float(r), float(g), float(b)) / 255.0)","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 positionFrom;","uniform vec2 positionTo;","uniform vec3 color1;","uniform vec3 color2;","uniform float alpha;","uniform int size;","varying vec2 outTexCoord;","float gradientNoise(in vec2 uv)","{","    const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);","    return fract(magic.z * fract(dot(uv, magic.xy)));","}","float stepped (in float s, in float scale, in int steps)","{","    return steps > 0 ? floor( s / ((1.0 * scale) / float(steps))) * 1.0 / float(steps - 1) : s;","}","void main ()","{","    vec2 a = positionFrom;","    vec2 b = positionTo;","    vec2 ba = b - a;","    float d = dot(outTexCoord - a, ba) / dot(ba, ba);","    float t = size > 0 ? stepped(d, 1.0, size) : d;","    t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));","    vec3 color = mix(SRGB(color1.r, color1.g, color1.b), SRGB(color2.r, color2.g, color2.b), t);","    color = LINEAR_TO_SRGB(color);","    color += (1.0 / 255.0) * gradientNoise(outTexCoord) - (0.5 / 255.0);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = vec4(mix(color.rgb, texture.rgb, alpha), 1.0) * texture.a;","}"].join("\n"))}function lG(){if(yS)return vS;yS=1;var t=Ih(),e=hG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.alpha=.2,this.size=0,this.fromX=0,this.fromY=0,this.toX=0,this.toY=1,this.glcolor1=[255,0,0],this.glcolor2=[0,255,0]},onPreRender:function(t,e){t=this.getController(t),this.set1f("alpha",t.alpha,e),this.set1i("size",t.size,e),this.set3fv("color1",t.glcolor1,e),this.set3fv("color2",t.glcolor2,e),this.set2f("positionFrom",t.fromX,t.fromY,e),this.set2f("positionTo",t.toX,t.toY,e)}});return vS=n}function uG(){return wS?xS:(wS=1,xS=["#define SHADER_NAME PIXELATE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform float amount;","varying vec2 outTexCoord;","void main ()","{","    float pixelSize = floor(2.0 + amount);","    vec2 center = pixelSize * floor(outTexCoord * resolution / pixelSize) + pixelSize * vec2(0.5, 0.5);","    vec2 corner1 = center + pixelSize * vec2(-0.5, -0.5);","    vec2 corner2 = center + pixelSize * vec2(+0.5, -0.5);","    vec2 corner3 = center + pixelSize * vec2(+0.5, +0.5);","    vec2 corner4 = center + pixelSize * vec2(-0.5, +0.5);","    vec4 pixel = 0.4 * texture2D(uMainSampler, center / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner1 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner2 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner3 / resolution);","    pixel += 0.15 * texture2D(uMainSampler, corner4 / resolution);","    gl_FragColor = pixel;","}"].join("\n"))}function cG(){if(TS)return bS;TS=1;var t=Ih(),e=uG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.amount=1},onPreRender:function(t,e,i,n){t=this.getController(t),this.set1f("amount",t.amount,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return bS=n}function dG(){return SS?ES:(SS=1,ES=["#define SHADER_NAME SHADOW_FS","precision mediump float;","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","uniform vec2 lightPosition;","uniform vec4 color;","uniform float decay;","uniform float power;","uniform float intensity;","uniform int samples;","const int MAX = 12;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec2 pc = (lightPosition - outTexCoord) * intensity;","    float shadow = 0.0;","    float limit = max(float(MAX), float(samples));","    for (int i = 0; i < MAX; ++i)","    {","        if (i >= samples)","        {","            break;","        }","        shadow += texture2D(uMainSampler, outTexCoord + float(i) * decay / limit * pc).a * power;","    }","    float mask = 1.0 - texture.a;","    gl_FragColor = mix(texture, color, shadow * mask);","}"].join("\n"))}function fG(){if(CS)return _S;CS=1;var t=Ih(),e=dG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=0,this.y=0,this.decay=.1,this.power=1,this.glcolor=[0,0,0,1],this.samples=6,this.intensity=1},onPreRender:function(t,e){var i=(t=this.getController(t)).samples;this.set1i("samples",i,e),this.set1f("intensity",t.intensity,e),this.set1f("decay",t.decay,e),this.set1f("power",t.power/i,e),this.set2f("lightPosition",t.x,t.y,e),this.set4fv("color",t.glcolor,e)}});return _S=n}function pG(){return MS?AS:(MS=1,AS=["#define SHADER_NAME SHINE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec2 resolution;","uniform bool reveal;","uniform float speed;","uniform float time;","uniform float lineWidth;","uniform float gradient;","varying vec2 outTexCoord;","void main ()","{","\tvec2 uv = gl_FragCoord.xy / resolution.xy;","    vec4 tex = texture2D(uMainSampler, outTexCoord);","    vec4 col1 = vec4(0.3, 0.0, 0.0, 1.0);","    vec4 col2 = vec4(0.85, 0.85, 0.85, 1.0);","    uv.x = uv.x - mod(time * speed, 2.0) + 0.5;","    float y = uv.x * gradient;","    float s = smoothstep(y - lineWidth, y, uv.y) - smoothstep(y, y + lineWidth, uv.y);","    gl_FragColor = (((s * col1) + (s * col2)) * tex);","    if (!reveal)","    {","        gl_FragColor += tex;","    }","}"].join("\n"))}function gG(){if(RS)return PS;RS=1;var t=Ih(),e=pG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.speed=.5,this.lineWidth=.5,this.gradient=3,this.reveal=!1},onPreRender:function(t,e,i,n){t=this.getController(t),this.setTime("time",e),this.set1f("speed",t.speed,e),this.set1f("lineWidth",t.lineWidth,e),this.set1f("gradient",t.gradient,e),this.setBoolean("reveal",t.reveal,e),i&&n&&this.set2f("resolution",i,n,e)},onDraw:function(t){this.set2f("resolution",t.width,t.height),this.bindAndDraw(t)}});return PS=n}function mG(){return OS?LS:(OS=1,LS=["#define SHADER_NAME VIGNETTE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float radius;","uniform float strength;","uniform vec2 position;","varying vec2 outTexCoord;","void main ()","{","    vec4 col = vec4(1.0);","    float d = length(outTexCoord - position);","    if (d <= radius)","    {","        float g = d / radius;","        g = sin(g * 3.14 * strength);","    \tcol = vec4(g * g * g);","    }","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    gl_FragColor = texture * (1.0 - col);","}"].join("\n"))}function vG(){if(kS)return FS;kS=1;var t=Ih(),e=mG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.x=.5,this.y=.5,this.radius=.5,this.strength=.5},onPreRender:function(t,e){t=this.getController(t),this.set1f("radius",t.radius,e),this.set1f("strength",t.strength,e),this.set2f("position",t.x,t.y,e)}});return FS=n}function yG(){return IS?DS:(IS=1,DS=["#define SHADER_NAME WIPE_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform vec4 config;","uniform bool reveal;","varying vec2 outTexCoord;","void main ()","{","    vec2 uv = outTexCoord;","    vec4 color0;","    vec4 color1;","    if (reveal)","    {","        color0 = vec4(0);","        color1 = texture2D(uMainSampler, uv);","    }","    else","    {","        color0 = texture2D(uMainSampler, uv);","        color1 = vec4(0);","    }","    float distance = config.x;","    float width = config.y;","    float direction = config.z;","    float axis = uv.x;","    if (config.w == 1.0)","    {","        axis = uv.y;","    }","    float adjust = mix(width, -width, distance);","    float value = smoothstep(distance - width, distance + width, abs(direction - axis) + adjust);","    gl_FragColor = mix(color1, color0, value);","}"].join("\n"))}function xG(){if(NS)return BS;NS=1;var t=Ih(),e=yG(),i=WX(),n=new t({Extends:i,initialize:function(t){i.call(this,{game:t,fragShader:e}),this.progress=0,this.wipeWidth=.1,this.direction=0,this.axis=0,this.reveal=!1},onPreRender:function(t,e){var i=(t=this.getController(t)).progress,n=t.wipeWidth,s=t.direction,r=t.axis;this.set4f("config",i,n,s,r,e),this.setBoolean("reveal",t.reveal,e)}});return BS=n}function wG(){if(US)return zS;US=1;var t={Barrel:VX(),Bloom:qX(),Blur:JX(),Bokeh:tG(),Circle:iG(),ColorMatrix:nG(),Displacement:rG(),Glow:oG(),Gradient:lG(),Pixelate:cG(),Shadow:fG(),Shine:gG(),Vignette:vG(),Wipe:xG()};return zS=t}function bG(){return XS?YS:(XS=1,YS=["#define SHADER_NAME PHASER_COLORMATRIX_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uColorMatrix[20];","uniform float uAlpha;","varying vec2 outTexCoord;","void main ()","{","    vec4 c = texture2D(uMainSampler, outTexCoord);","    if (uAlpha == 0.0)","    {","        gl_FragColor = c;","        return;","    }","    if (c.a > 0.0)","    {","        c.rgb /= c.a;","    }","    vec4 result;","    result.r = (uColorMatrix[0] * c.r) + (uColorMatrix[1] * c.g) + (uColorMatrix[2] * c.b) + (uColorMatrix[3] * c.a) + uColorMatrix[4];","    result.g = (uColorMatrix[5] * c.r) + (uColorMatrix[6] * c.g) + (uColorMatrix[7] * c.b) + (uColorMatrix[8] * c.a) + uColorMatrix[9];","    result.b = (uColorMatrix[10] * c.r) + (uColorMatrix[11] * c.g) + (uColorMatrix[12] * c.b) + (uColorMatrix[13] * c.a) + uColorMatrix[14];","    result.a = (uColorMatrix[15] * c.r) + (uColorMatrix[16] * c.g) + (uColorMatrix[17] * c.b) + (uColorMatrix[18] * c.a) + uColorMatrix[19];","    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);","    rgb *= result.a;","    gl_FragColor = vec4(rgb, result.a);","}"].join("\n"))}function TG(){if(HS)return GS;function t(t,i,s){s=s||2;var r,a,o,u,c,f,p,g=i&&i.length,m=g?i[0]*s:t.length,v=e(t,0,m,s,!0),y=[];if(!v||v.next===v.prev)return y;if(g&&(v=function(t,i,n,s){var r,a,o,u=[];for(r=0,a=i.length;r<a;r++)(o=e(t,i[r]*s,r<a-1?i[r+1]*s:t.length,s,!1))===o.next&&(o.steiner=!0),u.push(d(o));for(u.sort(h),r=0;r<u.length;r++)n=l(u[r],n);return n}(t,i,v,s)),t.length>80*s){r=o=t[0],a=u=t[1];for(var x=s;x<m;x+=s)(c=t[x])<r&&(r=c),(f=t[x+1])<a&&(a=f),c>o&&(o=c),f>u&&(u=f);p=0!==(p=Math.max(o-r,u-a))?32767/p:0}return n(v,y,s,r,a,p,0),y}function e(t,e,i,n,s){var r,a;if(s===_(t,e,i,n)>0)for(r=e;r<i;r+=n)a=T(r,t[r],t[r+1],a);else for(r=i-n;r>=e;r-=n)a=T(r,t[r],t[r+1],a);return a&&m(a,a.next)&&(E(a),a=a.next),a}function i(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!m(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(E(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function n(t,e,h,l,u,d,f){if(t){!f&&d&&function(t,e,i,n){var s=t;do{0===s.z&&(s.z=c(s.x,s.y,e,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==t);s.prevZ.nextZ=null,s.prevZ=null,function(t){var e,i,n,s,r,a,o,h,l=1;do{for(i=t,t=null,r=null,a=0;i;){for(a++,n=i,o=0,e=0;e<l&&(o++,n=n.nextZ);e++);for(h=l;o>0||h>0&&n;)0!==o&&(0===h||!n||i.z<=n.z)?(s=i,i=i.nextZ,o--):(s=n,n=n.nextZ,h--),r?r.nextZ=s:t=s,s.prevZ=r,r=s;i=n}r.nextZ=null,l*=2}while(a>1)}(s)}(t,l,u,d);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,d?r(t,l,u,d):s(t))e.push(p.i/h|0),e.push(t.i/h|0),e.push(g.i/h|0),E(t),t=g.next,m=g.next;else if((t=g)===m){f?1===f?n(t=a(i(t),e,h),e,h,l,u,d,2):2===f&&o(t,e,h,l,u,d):n(i(t),e,h,l,u,d,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(g(e,i,n)>=0)return!1;for(var s=e.x,r=i.x,a=n.x,o=e.y,h=i.y,l=n.y,u=s<r?s<a?s:a:r<a?r:a,c=o<h?o<l?o:l:h<l?h:l,d=s>r?s>a?s:a:r>a?r:a,p=o>h?o>l?o:l:h>l?h:l,m=n.next;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=c&&m.y<=p&&f(s,o,r,h,a,l,m.x,m.y)&&g(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function r(t,e,i,n){var s=t.prev,r=t,a=t.next;if(g(s,r,a)>=0)return!1;for(var o=s.x,h=r.x,l=a.x,u=s.y,d=r.y,p=a.y,m=o<h?o<l?o:l:h<l?h:l,v=u<d?u<p?u:p:d<p?d:p,y=o>h?o>l?o:l:h>l?h:l,x=u>d?u>p?u:p:d>p?d:p,w=c(m,v,e,i,n),b=c(y,x,e,i,n),T=t.prevZ,E=t.nextZ;T&&T.z>=w&&E&&E.z<=b;){if(T.x>=m&&T.x<=y&&T.y>=v&&T.y<=x&&T!==s&&T!==a&&f(o,u,h,d,l,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;if(T=T.prevZ,E.x>=m&&E.x<=y&&E.y>=v&&E.y<=x&&E!==s&&E!==a&&f(o,u,h,d,l,p,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;T&&T.z>=w;){if(T.x>=m&&T.x<=y&&T.y>=v&&T.y<=x&&T!==s&&T!==a&&f(o,u,h,d,l,p,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;E&&E.z<=b;){if(E.x>=m&&E.x<=y&&E.y>=v&&E.y<=x&&E!==s&&E!==a&&f(o,u,h,d,l,p,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function a(t,e,n){var s=t;do{var r=s.prev,a=s.next.next;!m(r,a)&&v(r,s,s.next,a)&&w(r,a)&&w(a,r)&&(e.push(r.i/n|0),e.push(s.i/n|0),e.push(a.i/n|0),E(s),E(s.next),s=t=a),s=s.next}while(s!==t);return i(s)}function o(t,e,s,r,a,o){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&p(h,l)){var u=b(h,l);return h=i(h,h.next),u=i(u,u.next),n(h,e,s,r,a,o,0),void n(u,e,s,r,a,o,0)}l=l.next}h=h.next}while(h!==t)}function h(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var i,n=e,s=t.x,r=t.y,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var o=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=s&&o>a&&(a=o,i=n.x<n.next.x?n:n.next,o===s))return i}n=n.next}while(n!==e);if(!i)return null;var h,l=i,c=i.x,d=i.y,p=1/0;n=i;do{s>=n.x&&n.x>=c&&s!==n.x&&f(r<d?s:a,r,c,d,r<d?a:s,r,n.x,n.y)&&(h=Math.abs(r-n.y)/(s-n.x),w(n,t)&&(h<p||h===p&&(n.x>i.x||n.x===i.x&&u(i,n)))&&(i=n,p=h)),n=n.next}while(n!==l);return i}(t,e);if(!n)return e;var s=b(n,t);return i(s,s.next),i(n,n.next)}function u(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function c(t,e,i,n,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,n,s,r,a,o){return(s-a)*(e-o)>=(t-a)*(r-o)&&(t-a)*(n-o)>=(i-a)*(e-o)&&(i-a)*(r-o)>=(s-a)*(n-o)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&v(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var i=t,n=!1,s=(t.x+e.x)/2,r=(t.y+e.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||m(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,i,n){var s=x(g(t,e,i)),r=x(g(t,e,n)),a=x(g(i,n,t)),o=x(g(i,n,e));return s!==r&&a!==o||!(0!==s||!y(t,i,e))||!(0!==r||!y(t,n,e))||!(0!==a||!y(i,t,n))||!(0!==o||!y(i,e,n))}function y(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function x(t){return t>0?1:t<0?-1:0}function w(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function b(t,e){var i=new S(t.i,t.x,t.y),n=new S(e.i,e.x,e.y),s=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function T(t,e,i,n){var s=new S(t,e,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(t,e,i,n){for(var s=0,r=e,a=i-n;r<i;r+=n)s+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return s}return HS=1,t.deviation=function(t,e,i,n){var s=e&&e.length,r=s?e[0]*i:t.length,a=Math.abs(_(t,0,r,i));if(s)for(var o=0,h=e.length;o<h;o++){var l=e[o]*i,u=o<h-1?e[o+1]*i:t.length;a-=Math.abs(_(t,l,u,i))}var c=0;for(o=0;o<n.length;o+=3){var d=n[o]*i,f=n[o+1]*i,p=n[o+2]*i;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},t.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,s=0;s<t.length;s++){for(var r=0;r<t[s].length;r++)for(var a=0;a<e;a++)i.vertices.push(t[s][r][a]);s>0&&(n+=t[s-1].length,i.holes.push(n))}return i},GS=t}function EG(){return VS?WS:(VS=1,WS=["#define SHADER_NAME PHASER_MULTI_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler[%count%];","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture;","    %forloop%","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function SG(){return qS?jS:(qS=1,jS=["#define SHADER_NAME PHASER_MULTI_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTexId = inTexId;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function _G(){if(ZS)return KS;ZS=1;var t=Ih(),e=TG(),i=kh(),n=EG(),s=SG(),r=Hu(),a=NX(),o=IX(),h=UX(),l=new t({Extends:h,initialize:function(t){var e=t.game.renderer,l=i(t,"fragShader",n);t.fragShader=a.parseFragmentShaderMaxTextures(l,e.maxTextures),t.vertShader=i(t,"vertShader",s),t.attributes=i(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:o.UNSIGNED_BYTE,normalized:!0}]),t.resizeUniform="uResolution",h.call(this,t),this._tempMatrix1=new r,this._tempMatrix2=new r,this._tempMatrix3=new r,this.calcMatrix=new r,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[]},boot:function(){h.prototype.boot.call(this);var t=this.renderer;this.set1iv("uMainSampler",t.textureIndexes),this.set2f("uResolution",t.width,t.height)},batchSprite:function(t,e,i){this.manager.set(this,t);var n=this._tempMatrix1,s=this._tempMatrix2,r=this._tempMatrix3,o=t.frame,h=o.glTexture,l=o.u0,u=o.v0,c=o.u1,d=o.v1,f=o.x,p=o.y,g=o.cutWidth,m=o.cutHeight,v=o.customPivot,y=t.displayOriginX,x=t.displayOriginY,w=-y+f,b=-x+p;if(t.isCropped){var T=t._crop;T.flipX===t.flipX&&T.flipY===t.flipY||o.updateCropUVs(T,t.flipX,t.flipY),l=T.u0,u=T.v0,c=T.u1,d=T.v1,g=T.width,m=T.height,w=-y+(f=T.x),b=-x+(p=T.y)}var E=1,S=1;t.flipX&&(v||(w+=-o.realWidth+2*y),E=-1),t.flipY&&(v||(b+=-o.realHeight+2*x),S=-1);var _=t.x,C=t.y;e.roundPixels&&(_=Math.floor(_),C=Math.floor(C)),s.applyITRS(_,C,t.rotation,t.scaleX*E,t.scaleY*S),n.copyFrom(e.matrix),i?(n.multiplyWithOffset(i,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),s.e=_,s.f=C):(s.e-=e.scrollX*t.scrollFactorX,s.f-=e.scrollY*t.scrollFactorY),n.multiply(s,r);var A=r.setQuad(w,b,w+g,b+m,e.renderRoundPixels),M=a.getTintAppendFloatAlpha,P=e.alpha,R=M(t.tintTopLeft,P*t._alphaTL),L=M(t.tintTopRight,P*t._alphaTR),O=M(t.tintBottomLeft,P*t._alphaBL),F=M(t.tintBottomRight,P*t._alphaBR);this.shouldFlush(6)&&this.flush();var k=this.setGameObject(t,o);this.manager.preBatch(t),this.batchQuad(t,A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],l,u,c,d,R,L,O,F,t.tintFill,h,k),this.manager.postBatch(t)},batchTexture:function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m,v,y,x,w,b,T,E,S,_,C,A,M,P,R,L,O){void 0===O&&(O=!1),this.manager.set(this,t);var F=this._tempMatrix1,k=this._tempMatrix2,D=this._tempMatrix3,I=v/i+C,B=y/n+A,N=(v+x)/i+C,z=(y+w)/n+A,U=a,Y=o,X=-g,G=-m;if(t.isCropped){var H=t._crop,W=H.width,V=H.height;U=W,Y=V,a=W,o=V;var j=v=H.x,q=y=H.y;c&&(j=x-H.x-W),d&&(q=w-H.y-V),I=j/i+C,B=q/n+A,N=(j+W)/i+C,z=(q+V)/n+A,X=-g+v,G=-m+y}c&&(U*=-1,X+=a),(d^=!R&&e.isRenderTexture?1:0)&&(Y*=-1,G+=o),M.roundPixels&&(s=Math.floor(s),r=Math.floor(r)),k.applyITRS(s,r,u,h,l),F.copyFrom(M.matrix),P?(F.multiplyWithOffset(P,-M.scrollX*f,-M.scrollY*p),k.e=s,k.f=r):(k.e-=M.scrollX*f,k.f-=M.scrollY*p),F.multiply(k,D);var K=D.setQuad(X,G,X+U,G+Y,M.renderRoundPixels);null==L&&(L=this.setTexture2D(e)),t&&!O&&this.manager.preBatch(t),this.batchQuad(t,K[0],K[1],K[2],K[3],K[4],K[5],K[6],K[7],I,B,N,z,b,T,E,S,_,e,L),t&&!O&&this.manager.postBatch(t)},batchTextureFrame:function(t,e,i,n,s,r,o){this.manager.set(this);var h=this._tempMatrix1.copyFrom(r),l=this._tempMatrix2;o?h.multiply(o,l):l=h;var u=l.setQuad(e,i,e+t.width,i+t.height),c=this.setTexture2D(t.source.glTexture);n=a.getTintAppendFloatAlpha(n,s),this.batchQuad(null,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],t.u0,t.v0,t.u1,t.v1,n,n,n,n,0,t.glTexture,c)},batchFillRect:function(t,e,i,n,s,r){this.renderer.pipelines.set(this);var a=this.calcMatrix;r&&r.multiply(s,a);var o=a.setQuad(t,e,t+i,e+n),h=this.fillTint;this.batchQuad(null,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],0,0,1,1,h.TL,h.TR,h.BL,h.BR,2)},batchFillTriangle:function(t,e,i,n,s,r,a,o){this.renderer.pipelines.set(this);var h=this.calcMatrix;o&&o.multiply(a,h);var l=h.getX(t,e),u=h.getY(t,e),c=h.getX(i,n),d=h.getY(i,n),f=h.getX(s,r),p=h.getY(s,r),g=this.fillTint;this.batchTri(null,l,u,c,d,f,p,0,0,1,1,g.TL,g.TR,g.BL,2)},batchStrokeTriangle:function(t,e,i,n,s,r,a,o,h){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=a,l[1].x=i,l[1].y=n,l[1].width=a,l[2].x=s,l[2].y=r,l[2].width=a,l[3].x=t,l[3].y=e,l[3].width=a,this.batchStrokePath(l,a,!1,o,h)},batchFillPath:function(t,i,n){this.renderer.pipelines.set(this);var s=this.calcMatrix;n&&n.multiply(i,s);for(var r,a,o=t.length,h=this.polygonCache,l=this.fillTint.TL,u=this.fillTint.TR,c=this.fillTint.BL,d=0;d<o;++d)a=t[d],h.push(a.x,a.y);o=(r=e(h)).length;for(var f=0;f<o;f+=3){var p=2*r[f+0],g=2*r[f+1],m=2*r[f+2],v=h[p+0],y=h[p+1],x=h[g+0],w=h[g+1],b=h[m+0],T=h[m+1],E=s.getX(v,y),S=s.getY(v,y),_=s.getX(x,w),C=s.getY(x,w),A=s.getX(b,T),M=s.getY(b,T);this.batchTri(null,E,S,_,C,A,M,0,0,1,1,l,u,c,2)}h.length=0},batchStrokePath:function(t,e,i,n,s){this.renderer.pipelines.set(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var r=t.length-1,a=0;a<r;a++){var o=t[a],h=t[a+1];this.batchLine(o.x,o.y,h.x,h.y,o.width/2,h.width/2,e,a,!i&&a===r-1,n,s)}},batchLine:function(t,e,i,n,s,r,a,o,h,l,u){this.renderer.pipelines.set(this);var c=this.calcMatrix;u&&u.multiply(l,c);var d=i-t,f=n-e,p=Math.sqrt(d*d+f*f);if(0!==p){var g=s*(n-e)/p,m=s*(t-i)/p,v=r*(n-e)/p,y=r*(t-i)/p,x=i-v,w=n-y,b=t-g,T=e-m,E=i+v,S=n+y,_=t+g,C=e+m,A=c.getX(x,w),M=c.getY(x,w),P=c.getX(b,T),R=c.getY(b,T),L=c.getX(E,S),O=c.getY(E,S),F=c.getX(_,C),k=c.getY(_,C),D=this.strokeTint,I=D.TL,B=D.TR,N=D.BL,z=D.BR;if(this.batchQuad(null,F,k,P,R,A,M,L,O,0,0,1,1,I,B,N,z,2),!(a<=2)){var U=this.prevQuad,Y=this.firstQuad;o>0&&U[4]?this.batchQuad(null,F,k,P,R,U[0],U[1],U[2],U[3],0,0,1,1,I,B,N,z,2):(Y[0]=F,Y[1]=k,Y[2]=P,Y[3]=R,Y[4]=1),h&&Y[4]?this.batchQuad(null,A,M,L,O,Y[0],Y[1],Y[2],Y[3],0,0,1,1,I,B,N,z,2):(U[0]=A,U[1]=M,U[2]=L,U[3]=O,U[4]=1)}}},destroy:function(){return this._tempMatrix1.destroy(),this._tempMatrix2.destroy(),this._tempMatrix3.destroy(),this._tempMatrix1=null,this._tempMatrix1=null,this._tempMatrix1=null,h.prototype.destroy.call(this),this}});return KS=l}function CG(){return JS?$S:(JS=1,$S=["#define SHADER_NAME PHASER_SINGLE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n"))}function AG(){return t_?QS:(t_=1,QS=["#define SHADER_NAME PHASER_SINGLE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n"))}function MG(){if(i_)return e_;i_=1;var t=Go(),e=SY(),i=Ih(),n=bG(),s=kh(),r=_G(),a=GX(),o=Eu(),h=FX(),l=CG(),u=AG(),c=UX(),d=new i({Extends:r,initialize:function(t){var e=s(t,"fragShader",a),i=s(t,"vertShader",u),h=s(t,"drawShader",a),c=[{name:"DrawSprite",fragShader:l,vertShader:u},{name:"CopySprite",fragShader:e,vertShader:i},{name:"DrawGame",fragShader:h,vertShader:u},{name:"ColorMatrix",fragShader:n}],d=s(t,"shaders",[]);t.shaders=c.concat(d),t.vertShader||(t.vertShader=i),t.batchSize=1,r.call(this,t),this.isPreFX=!0,this.customMainSampler=null,this.drawSpriteShader,this.copyShader,this.gameShader,this.colorMatrixShader,this.quadVertexData,this.quadVertexBuffer,this.quadVertexViewF32,this.spriteBounds=new o,this.targetBounds=new o,this.fsTarget,this.tempSprite,this.renderer.isBooted&&(this.manager=this.renderer.pipelines,this.boot())},boot:function(){c.prototype.boot.call(this);var t=this.shaders,e=this.renderer;this.drawSpriteShader=t[0],this.copyShader=t[1],this.gameShader=t[2],this.colorMatrixShader=t[3],this.fsTarget=new h(e,e.width,e.height,1,0,!0,!0),this.renderTargets=this.manager.renderTargets.concat(this.fsTarget);var i=new ArrayBuffer(168);this.quadVertexData=i,this.quadVertexViewF32=new Float32Array(i),this.quadVertexBuffer=e.createVertexBuffer(i,this.gl.STATIC_DRAW),this.onResize(e.width,e.height),this.currentShader=this.copyShader,this.set2f("uResolution",e.width,e.height)},onResize:function(t,e){var i=this.quadVertexViewF32;i[1]=e,i[22]=e,i[14]=t,i[28]=t,i[35]=t,i[36]=e},batchQuad:function(t,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m,v,y,x){var w=Math.min(i,s,a,h),b=Math.min(n,r,o,l),T=Math.max(i,s,a,h)-w,E=Math.max(n,r,o,l)-b,S=this.spriteBounds.setTo(w,b,T,E),_=t?t.preFX.padding:0,C=T+2*_,A=E+2*_,M=Math.abs(Math.max(C,A)),P=this.manager.getRenderTarget(M),R=this.targetBounds.setTo(0,0,P.width,P.height);e(R,Math.round(S.centerX),Math.round(S.centerY)),this.tempSprite=t;var L=this.gl,O=this.renderer;O.clearStencilMask(),this.setShader(this.drawSpriteShader),this.set1i("uMainSampler",0),this.set2f("uResolution",O.width,O.height),this.flipProjectionMatrix(!0),t&&(this.onDrawSprite(t,P),t.preFX.onFX(this));var F=this.fsTarget;return this.flush(),L.viewport(0,0,O.width,O.height),L.bindFramebuffer(L.FRAMEBUFFER,F.framebuffer.webGLFramebuffer),L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_2D,F.texture.webGLTexture,0),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),this.setTexture2D(x),this.batchVert(i,n,u,c,0,y,p),this.batchVert(s,r,u,f,0,y,m),this.batchVert(a,o,d,f,0,y,v),this.batchVert(i,n,u,c,0,y,p),this.batchVert(a,o,d,f,0,y,v),this.batchVert(h,l,d,c,0,y,g),this.flush(),this.flipProjectionMatrix(!1),L.activeTexture(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,P.texture.webGLTexture),L.copyTexSubImage2D(L.TEXTURE_2D,0,0,0,R.x,R.y,R.width,R.height),L.bindFramebuffer(L.FRAMEBUFFER,null),L.bindTexture(L.TEXTURE_2D,null),this.onBatch(t),this.currentShader=this.copyShader,this.onDraw(P,this.manager.getSwapRenderTarget(),this.manager.getAltSwapRenderTarget()),!0},onDrawSprite:function(){},onCopySprite:function(){},copySprite:function(e,i,n,s,r,a,o){void 0===n&&(n=!0),void 0===s&&(s=!0),void 0===r&&(r=!1),void 0===o&&(o=this.copyShader);var h=this.gl,l=this.tempSprite;a&&(o=this.colorMatrixShader),this.currentShader=o;var u=this.setVertexBuffer(this.quadVertexBuffer);o.bind(u,!1);var c=this.renderer;if(this.set1i("uMainSampler",0),this.set2f("uResolution",c.width,c.height),l.preFX.onFXCopy(this),this.onCopySprite(e,i,l),a&&(this.set1fv("uColorMatrix",a.getData()),this.set1f("uAlpha",a.alpha)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),e.height>i.height)h.viewport(0,0,e.width,e.height),this.setTargetUVs(e,i);else{var d=i.height-e.height;h.viewport(0,d,e.width,e.height),this.resetUVs()}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),n&&(h.clearColor(0,0,0,Number(!s)),h.clear(h.COLOR_BUFFER_BIT)),r){var f=this.renderer.currentBlendMode;this.renderer.setBlendMode(t.ERASE)}h.bufferData(h.ARRAY_BUFFER,this.quadVertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),r&&this.renderer.setBlendMode(f),h.bindFramebuffer(h.FRAMEBUFFER,null)},copy:function(t,e){var i=this.gl;this.set1i("uMainSampler",0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.webGLTexture),i.viewport(0,0,t.width,t.height),this.setUVs(0,0,0,1,1,1,1,0),i.bindFramebuffer(i.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.texture.webGLTexture,0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.bufferData(i.ARRAY_BUFFER,this.quadVertexData,i.STATIC_DRAW),i.drawArrays(i.TRIANGLES,0,6),i.bindFramebuffer(i.FRAMEBUFFER,null)},blendFrames:function(t,e,i,n,s){this.manager.blendFrames(t,e,i,n,s)},blendFramesAdditive:function(t,e,i,n,s){this.manager.blendFramesAdditive(t,e,i,n,s)},drawToGame:function(t){this.currentShader=null,this.setShader(this.copyShader),this.bindAndDraw(t)},copyToGame:function(t){this.currentShader=null,this.setShader(this.gameShader),this.bindAndDraw(t)},bindAndDraw:function(t){var e=this.gl,i=this.renderer;this.set1i("uMainSampler",0),this.customMainSampler?this.setTexture2D(this.customMainSampler):this.setTexture2D(t.texture);var n=this._tempMatrix1.loadIdentity(),s=this.targetBounds.x,r=this.targetBounds.y,a=s+t.width,o=r+t.height,h=n.getX(s,r),l=n.getX(s,o),u=n.getX(a,o),c=n.getX(a,r),d=n.getY(s,r),f=n.getY(s,o),p=n.getY(a,o),g=n.getY(a,r),m=16777215;this.batchVert(h,d,0,0,0,0,m),this.batchVert(l,f,0,1,0,0,m),this.batchVert(u,p,1,1,0,0,m),this.batchVert(h,d,0,0,0,0,m),this.batchVert(u,p,1,1,0,0,m),this.batchVert(c,g,1,0,0,0,m),i.restoreFramebuffer(!1,!0),i.currentFramebuffer||e.viewport(0,0,i.width,i.height),i.restoreStencilMask(),this.flush(),this.tempSprite=null},onDraw:function(t){this.drawToGame(t)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.quadVertexViewF32;h[2]=t,h[3]=e,h[9]=i,h[10]=n,h[16]=s,h[17]=r,h[23]=t,h[24]=e,h[30]=s,h[31]=r,h[37]=a,h[38]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)},destroy:function(){return this.renderer.deleteBuffer(this.quadVertexBuffer),this.drawSpriteShader=null,this.copyShader=null,this.gameShader=null,this.colorMatrixShader=null,this.quadVertexData=null,this.quadVertexBuffer=null,this.quadVertexViewF32=null,this.fsTarget=null,this.tempSprite=null,r.prototype.destroy.call(this),this}});return e_=d}function PG(){return s_?n_:(s_=1,n_=["#define SHADER_NAME PHASER_ADD_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = frame1 + frame2 * uStrength;","}"].join("\n"))}function RG(){return a_?r_:(a_=1,r_=["#define SHADER_NAME PHASER_COPY_FS","precision mediump float;","uniform sampler2D uMainSampler;","uniform float uBrightness;","varying vec2 outTexCoord;","void main ()","{","    gl_FragColor = texture2D(uMainSampler, outTexCoord) * uBrightness;","}"].join("\n"))}function LG(){return h_?o_:(h_=1,o_=["#define SHADER_NAME PHASER_LIGHT_FS","precision mediump float;","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","const int kMaxLights = %LIGHT_COUNT%;","uniform vec4 uCamera; ","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","uniform int uLightCount;","varying vec2 outTexCoord;","varying float outTexId;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","    for (int index = 0; index < kMaxLights; ++index)","    {","        if (index < uLightCount)","        {","            Light light = uLights[index];","            vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","            vec3 lightNormal = normalize(lightDir);","            float distToSurf = length(lightDir) * uCamera.w;","            float diffuseFactor = max(dot(normal, lightNormal), 0.0);","            float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","            float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","            vec3 diffuse = light.color * diffuseFactor;","            finalColor += (attenuation * diffuse) * light.intensity;","        }","    }","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","}"].join("\n"))}function OG(){return u_?l_:(u_=1,l_=["#define SHADER_NAME PHASER_LINEAR_BLEND_FS","precision mediump float;","uniform sampler2D uMainSampler1;","uniform sampler2D uMainSampler2;","uniform float uStrength;","varying vec2 outTexCoord;","void main ()","{","    vec4 frame1 = texture2D(uMainSampler1, outTexCoord);","    vec4 frame2 = texture2D(uMainSampler2, outTexCoord);","    gl_FragColor = mix(frame1, frame2 * uStrength, 0.5);","}"].join("\n"))}function FG(){return w_?x_:(w_=1,x_=["#define SHADER_NAME PHASER_POINTLIGHT_FS","precision mediump float;","uniform vec2 uResolution;","uniform float uCameraZoom;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    vec2 center = (lightPosition.xy + 1.0) * (uResolution.xy * 0.5);","    float distToSurf = length(center - gl_FragCoord.xy);","    float radius = 1.0 - distToSurf / (lightRadius * uCameraZoom);","    float intensity = smoothstep(0.0, 1.0, radius * lightAttenuation);","    vec4 color = vec4(intensity, intensity, intensity, 0.0) * lightColor;","    gl_FragColor = vec4(color.rgb * lightColor.a, color.a);","}"].join("\n"))}function kG(){return T_?b_:(T_=1,b_=["#define SHADER_NAME PHASER_POINTLIGHT_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","attribute vec2 inPosition;","attribute vec2 inLightPosition;","attribute vec4 inLightColor;","attribute float inLightRadius;","attribute float inLightAttenuation;","varying vec4 lightPosition;","varying vec4 lightColor;","varying float lightRadius;","varying float lightAttenuation;","void main ()","{","    lightColor = inLightColor;","    lightRadius = inLightRadius;","    lightAttenuation = inLightAttenuation;","    lightPosition = uProjectionMatrix * vec4(inLightPosition, 1.0, 1.0);","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","}"].join("\n"))}function DG(){if(C_)return __;C_=1;var t=Ih(),e=wG(),i=Vl(),n=kh(),s=MG(),r=S_?E_:(S_=1,E_={AddBlendFrag:PG(),BitmapMaskFrag:kX(),BitmapMaskVert:DX(),ColorMatrixFrag:bG(),CopyFrag:RG(),FXBarrelFrag:XX(),FXBloomFrag:jX(),FXBlurHighFrag:$X(),FXBlurLowFrag:KX(),FXBlurMedFrag:ZX(),FXBokehFrag:QX(),FXCircleFrag:eG(),FXDisplacementFrag:sG(),FXGlowFrag:aG(),FXGradientFrag:hG(),FXPixelateFrag:uG(),FXShadowFrag:dG(),FXShineFrag:pG(),FXVignetteFrag:mG(),FXWipeFrag:yG(),LightFrag:LG(),LinearBlendFrag:OG(),MeshFrag:d_?c_:(d_=1,c_=["#define SHADER_NAME PHASER_MESH_FS","precision mediump float;","uniform vec3 uLightPosition;","uniform vec3 uLightAmbient;","uniform vec3 uLightDiffuse;","uniform vec3 uLightSpecular;","uniform vec3 uFogColor;","uniform float uFogNear;","uniform float uFogFar;","uniform vec3 uMaterialAmbient;","uniform vec3 uMaterialDiffuse;","uniform vec3 uMaterialSpecular;","uniform float uMaterialShine;","uniform vec3 uCameraPosition;","uniform sampler2D uTexture;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main (void)","{","    vec4 color = texture2D(uTexture, vTextureCoord);","    vec3 ambient = uLightAmbient * uMaterialAmbient;","    vec3 norm = normalize(vNormal);","    vec3 lightDir = normalize(uLightPosition - vPosition);","    float diff = max(dot(norm, lightDir), 0.0);","    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);","    vec3 viewDir = normalize(uCameraPosition - vPosition);","    vec3 reflectDir = reflect(-lightDir, norm);","    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);","    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);","    vec3 result = (ambient + diffuse + specular) * color.rgb;","    float depth = gl_FragCoord.z / gl_FragCoord.w;","    float fogFactor = smoothstep(uFogNear, uFogFar, depth);","    gl_FragColor.rgb = mix(result.rgb, uFogColor, fogFactor);","    gl_FragColor.a = color.a;","}"].join("\n")),MeshVert:p_?f_:(p_=1,f_=["#define SHADER_NAME PHASER_MESH_VS","precision mediump float;","attribute vec3 aVertexPosition;","attribute vec3 aVertexNormal;","attribute vec2 aTextureCoord;","uniform mat4 uViewProjectionMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uNormalMatrix;","varying vec2 vTextureCoord;","varying vec3 vNormal;","varying vec3 vPosition;","void main ()","{","    vTextureCoord = aTextureCoord;","    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));","    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));","    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);","}"].join("\n")),MobileFrag:m_?g_:(m_=1,g_=["#define SHADER_NAME PHASER_MOBILE_FS","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","uniform sampler2D uMainSampler;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    vec4 texel = vec4(outTint.bgr * outTint.a, outTint.a);","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 color = texture * texel;","    if (outTintEffect == 1.0)","    {","        color.rgb = mix(texture.rgb, outTint.bgr * outTint.a, texture.a);","    }","    else if (outTintEffect == 2.0)","    {","        color = texel;","    }","    gl_FragColor = color;","}"].join("\n")),MobileVert:y_?v_:(y_=1,v_=["#define SHADER_NAME PHASER_MOBILE_VS","precision mediump float;","uniform mat4 uProjectionMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTexId;","attribute float inTintEffect;","attribute vec4 inTint;","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","void main ()","{","    gl_Position = uProjectionMatrix * vec4(inPosition, 1.0, 1.0);","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}"].join("\n")),MultiFrag:EG(),MultiVert:SG(),PointLightFrag:FG(),PointLightVert:kG(),PostFXFrag:GX(),QuadVert:HX(),SingleFrag:CG(),SingleVert:AG()}),a=NX(),o=new t({Extends:s,initialize:function(t){t.shaders=[a.setGlowQuality(r.FXGlowFrag,t.game),r.FXShadowFrag,r.FXPixelateFrag,r.FXVignetteFrag,r.FXShineFrag,r.FXBlurLowFrag,r.FXBlurMedFrag,r.FXBlurHighFrag,r.FXGradientFrag,r.FXBloomFrag,r.ColorMatrixFrag,r.FXCircleFrag,r.FXBarrelFrag,r.FXDisplacementFrag,r.FXWipeFrag,r.FXBokehFrag],s.call(this,t);var n=this.game;this.glow=new e.Glow(n),this.shadow=new e.Shadow(n),this.pixelate=new e.Pixelate(n),this.vignette=new e.Vignette(n),this.shine=new e.Shine(n),this.gradient=new e.Gradient(n),this.circle=new e.Circle(n),this.barrel=new e.Barrel(n),this.wipe=new e.Wipe(n),this.bokeh=new e.Bokeh(n);var o=[];o[i.GLOW]=this.onGlow,o[i.SHADOW]=this.onShadow,o[i.PIXELATE]=this.onPixelate,o[i.VIGNETTE]=this.onVignette,o[i.SHINE]=this.onShine,o[i.BLUR]=this.onBlur,o[i.GRADIENT]=this.onGradient,o[i.BLOOM]=this.onBloom,o[i.COLOR_MATRIX]=this.onColorMatrix,o[i.CIRCLE]=this.onCircle,o[i.BARREL]=this.onBarrel,o[i.DISPLACEMENT]=this.onDisplacement,o[i.WIPE]=this.onWipe,o[i.BOKEH]=this.onBokeh,this.fxHandlers=o,this.source,this.target,this.swap},onDraw:function(t,e,i){this.source=t,this.target=e,this.swap=i;var n=t.width,s=t.height,r=this.tempSprite,a=this.fxHandlers;if(r&&r.preFX)for(var o=r.preFX.list,h=0;h<o.length;h++){var l=o[h];l.active&&a[l.type].call(this,l,n,s)}this.drawToGame(this.source)},runDraw:function(){var t=this.source,e=this.target;this.copy(t,e),this.source=e,this.target=t},onGlow:function(t,e,n){var s=this.shaders[i.GLOW];this.setShader(s),this.glow.onPreRender(t,s,e,n),this.runDraw()},onShadow:function(t){var e=this.shaders[i.SHADOW];this.setShader(e),this.shadow.onPreRender(t,e),this.runDraw()},onPixelate:function(t,e,n){var s=this.shaders[i.PIXELATE];this.setShader(s),this.pixelate.onPreRender(t,s,e,n),this.runDraw()},onVignette:function(t){var e=this.shaders[i.VIGNETTE];this.setShader(e),this.vignette.onPreRender(t,e),this.runDraw()},onShine:function(t,e,n){var s=this.shaders[i.SHINE];this.setShader(s),this.shine.onPreRender(t,s,e,n),this.runDraw()},onBlur:function(t,e,s){var r=n(t,"quality"),a=this.shaders[i.BLUR+r];this.setShader(a),this.set1i("uMainSampler",0),this.set2f("resolution",e,s),this.set1f("strength",n(t,"strength")),this.set3fv("color",n(t,"glcolor"));for(var o=n(t,"x"),h=n(t,"y"),l=n(t,"steps"),u=0;u<l;u++)this.set2f("offset",o,0),this.runDraw(),this.set2f("offset",0,h),this.runDraw()},onGradient:function(t){var e=this.shaders[i.GRADIENT];this.setShader(e),this.gradient.onPreRender(t,e),this.runDraw()},onBloom:function(t,e,s){var r=this.shaders[i.BLOOM];this.copySprite(this.source,this.swap),this.setShader(r),this.set1i("uMainSampler",0),this.set1f("strength",n(t,"blurStrength")),this.set3fv("color",n(t,"glcolor"));for(var a=2/e*n(t,"offsetX"),o=2/s*n(t,"offsetY"),h=n(t,"steps"),l=0;l<h;l++)this.set2f("offset",a,0),this.runDraw(),this.set2f("offset",0,o),this.runDraw();this.blendFrames(this.swap,this.source,this.target,n(t,"strength")),this.copySprite(this.target,this.source)},onColorMatrix:function(t){this.setShader(this.colorMatrixShader),this.set1fv("uColorMatrix",t.getData()),this.set1f("uAlpha",t.alpha),this.runDraw()},onCircle:function(t,e,n){var s=this.shaders[i.CIRCLE];this.setShader(s),this.circle.onPreRender(t,s,e,n),this.runDraw()},onBarrel:function(t){var e=this.shaders[i.BARREL];this.setShader(e),this.barrel.onPreRender(t,e),this.runDraw()},onDisplacement:function(t){this.setShader(this.shaders[i.DISPLACEMENT]),this.set1i("uDisplacementSampler",1),this.set2f("amount",t.x,t.y),this.bindTexture(t.glTexture,1),this.runDraw()},onWipe:function(t){var e=this.shaders[i.WIPE];this.setShader(e),this.wipe.onPreRender(t,e),this.runDraw()},onBokeh:function(t,e,n){var s=this.shaders[i.BOKEH];this.setShader(s),this.bokeh.onPreRender(t,s,e,n),this.runDraw()},destroy:function(){return this.glow.destroy(),this.shadow.destroy(),this.pixelate.destroy(),this.vignette.destroy(),this.shine.destroy(),this.gradient.destroy(),this.circle.destroy(),this.barrel.destroy(),this.wipe.destroy(),this.bokeh.destroy(),this.fxHandlers=null,this.source=null,this.target=null,this.swap=null,s.prototype.destroy.call(this),this}});return __=o}function IG(){if(M_)return A_;M_=1;var t=Ih(),e=kh(),i=LG(),n=_G(),s=Hu(),r=wu(),a=UX(),o=new t({Extends:n,initialize:function(t){var a=e(t,"fragShader",i);t.fragShader=a.replace("%LIGHT_COUNT%",t.game.renderer.config.maxLights),n.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1]),this.currentNormalMap,this.lightsActive=!0,this.tempVec2=new r,this._tempMatrix=new s,this._tempMatrix2=new s},boot:function(){a.prototype.boot.call(this)},onRender:function(t,e){var i=t.sys.lights;if(this.lightsActive=!1,i&&i.active){var n,s=i.getLights(e),r=s.length;this.lightsActive=!0;var a=this.renderer.height,o=e.matrix,h=this.tempVec2;for(this.set1i("uMainSampler",0),this.set1i("uNormSampler",1),this.set2f("uResolution",this.width/2,this.height/2),this.set4f("uCamera",e.x,e.y,e.rotation,e.zoom),this.set3f("uAmbientLightColor",i.ambientColor.r,i.ambientColor.g,i.ambientColor.b),this.set1i("uLightCount",r),n=0;n<r;n++){var l=s[n].light,u=l.color,c="uLights["+n+"].";o.transformPoint(l.x,l.y,h),this.set2f(c+"position",h.x-e.scrollX*l.scrollFactorX*e.zoom,a-(h.y-e.scrollY*l.scrollFactorY*e.zoom)),this.set3f(c+"color",u.r,u.g,u.b),this.set1f(c+"intensity",l.intensity),this.set1f(c+"radius",l.radius)}this.currentNormalMapRotation=null}},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.vertexCount){this.vertexCount>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var i=-t,n=Math.cos(i),s=Math.sin(i);e[1]=s,e[3]=-s,e[0]=e[4]=n}else e[0]=e[4]=1,e[1]=e[3]=0;this.setMatrix3fv("uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},setTexture2D:function(t,e){var i=this.renderer;void 0===t&&(t=i.whiteTexture);var n=this.getNormalMap(e);this.isNewNormalMap(t,n)&&(this.flush(),this.createBatch(t),this.addTextureToBatch(n),this.currentNormalMap=n);var s=0;return e&&e.parentContainer?s=e.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2).rotationNormalized:e&&(s=e.rotation),null===this.currentBatch&&(this.createBatch(t),this.addTextureToBatch(n)),this.setNormalMapRotation(s),0},setGameObject:function(t,e){void 0===e&&(e=t.frame);var i=e.glTexture,n=this.getNormalMap(t);if(this.isNewNormalMap(i,n)&&(this.flush(),this.createBatch(i),this.addTextureToBatch(n),this.currentNormalMap=n),t.parentContainer){var s=t.getWorldTransformMatrix(this._tempMatrix,this._tempMatrix2);this.setNormalMapRotation(s.rotationNormalized)}else this.setNormalMapRotation(t.rotation);return null===this.currentBatch&&(this.createBatch(i),this.addTextureToBatch(n)),0},isNewNormalMap:function(t,e){return this.currentTexture!==t||this.currentNormalMap!==e},getNormalMap:function(t){var e;return t?(t.displayTexture?e=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?e=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(e=Array.isArray(t.tileset)?t.tileset[0].image.dataSource[0]:t.tileset.image.dataSource[0]),e?e.glTexture:this.renderer.normalTexture):this.renderer.normalTexture},batchSprite:function(t,e,i){this.lightsActive&&n.prototype.batchSprite.call(this,t,e,i)},batchTexture:function(t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,m,v,y,x,w,b,T,E,S,_,C,A,M,P,R,L,O){this.lightsActive&&n.prototype.batchTexture.call(this,t,e,i,s,r,a,o,h,l,u,c,d,f,p,g,m,v,y,x,w,b,T,E,S,_,C,A,M,P,R,L,O)},batchTextureFrame:function(t,e,i,s,r,a,o){this.lightsActive&&n.prototype.batchTextureFrame.call(this,t,e,i,s,r,a,o)}});return A_=o}function BG(){if(R_)return P_;R_=1;var t=Ih(),e=kh(),i=_G(),n=CG(),s=AG(),r=IX(),a=UX(),o=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2},{name:"inTexId"},{name:"inTintEffect"},{name:"inTint",size:4,type:r.UNSIGNED_BYTE,normalized:!0}]),t.forceZero=!0,t.resizeUniform="uResolution",i.call(this,t)},boot:function(){a.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return P_=o}function NG(){if(O_)return L_;O_=1;var t=Ih(),e=kh(),i=FG(),n=kG(),s=UX(),r=new t({Extends:s,initialize:function(t){t.vertShader=e(t,"vertShader",n),t.fragShader=e(t,"fragShader",i),t.attributes=e(t,"attributes",[{name:"inPosition",size:2},{name:"inLightPosition",size:2},{name:"inLightRadius"},{name:"inLightAttenuation"},{name:"inLightColor",size:4}]),s.call(this,t)},onRender:function(t,e){this.set2f("uResolution",this.width,this.height),this.set1f("uCameraZoom",e.zoom)},batchPointLight:function(t,e,i,n,s,r,a,o,h,l,u,c){var d=t.color,f=t.intensity,p=t.radius,g=t.attenuation,m=d.r*f,v=d.g*f,y=d.b*f,x=e.alpha*t.alpha;this.shouldFlush(6)&&this.flush(),this.currentBatch||this.setTexture2D(),this.batchLightVert(i,n,u,c,p,g,m,v,y,x),this.batchLightVert(s,r,u,c,p,g,m,v,y,x),this.batchLightVert(a,o,u,c,p,g,m,v,y,x),this.batchLightVert(i,n,u,c,p,g,m,v,y,x),this.batchLightVert(a,o,u,c,p,g,m,v,y,x),this.batchLightVert(h,l,u,c,p,g,m,v,y,x),this.currentBatch.count=this.vertexCount-this.currentBatch.start},batchLightVert:function(t,e,i,n,s,r,a,o,h,l){var u=this.vertexViewF32,c=this.vertexCount*this.currentShader.vertexComponentCount-1;u[++c]=t,u[++c]=e,u[++c]=i,u[++c]=n,u[++c]=s,u[++c]=r,u[++c]=a,u[++c]=o,u[++c]=h,u[++c]=l,this.vertexCount++}});return L_=r}function zG(){if(k_)return F_;k_=1;var t=Ih(),e=kh(),i=_G(),n=new t({Extends:i,initialize:function(t){t.topology=5,t.batchSize=e(t,"batchSize",256),i.call(this,t)}});return F_=n}function UG(){if(I_)return D_;I_=1;var t=Ih(),e=kh(),i=_G(),n=CG(),s=AG(),r=UX(),a=new t({Extends:i,initialize:function(t){t.fragShader=e(t,"fragShader",n),t.vertShader=e(t,"vertShader",s),t.forceZero=!0,i.call(this,t)},boot:function(){r.prototype.boot.call(this);var t=this.renderer;this.set1i("uMainSampler",0),this.set2f("uResolution",t.width,t.height)}});return D_=a}function YG(){if(N_)return B_;N_=1;var t=PG(),e=Go(),i=Ih(),n=Ql(),s=bG(),r=RG(),a=kh(),o=OG(),h=HX(),l=UX(),u=new i({Extends:l,initialize:function(e){e.renderTarget=a(e,"renderTarget",[{scale:1,autoResize:!0},{scale:1,autoResize:!0},{scale:.5,autoResize:!0},{scale:.5,autoResize:!0}]),e.vertShader=a(e,"vertShader",h),e.shaders=a(e,"shaders",[{name:"Copy",fragShader:r},{name:"AddBlend",fragShader:t},{name:"LinearBlend",fragShader:o},{name:"ColorMatrix",fragShader:s}]),e.attributes=a(e,"attributes",[{name:"inPosition",size:2},{name:"inTexCoord",size:2}]),e.vertices=[-1,-1,0,0,-1,1,0,1,1,1,1,1,-1,-1,0,0,1,1,1,1,1,-1,1,0],e.batchSize=1,l.call(this,e),this.colorMatrix=new n,this.copyShader,this.addShader,this.linearShader,this.colorMatrixShader,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2},boot:function(){l.prototype.boot.call(this);var t=this.shaders,e=this.renderTargets;this.copyShader=t[0],this.addShader=t[1],this.linearShader=t[2],this.colorMatrixShader=t[3],this.fullFrame1=e[0],this.fullFrame2=e[1],this.halfFrame1=e[2],this.halfFrame2=e[3]},copyFrame:function(t,e,i,n,s){void 0===i&&(i=1),void 0===n&&(n=!0),void 0===s&&(s=!0);var r=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",i),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t.texture.webGLTexture),e?(r.viewport(0,0,e.width,e.height),r.bindFramebuffer(r.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e.texture.webGLTexture,0)):r.viewport(0,0,t.width,t.height),n&&(s?r.clearColor(0,0,0,0):r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT)),r.bufferData(r.ARRAY_BUFFER,this.vertexData,r.STATIC_DRAW),r.drawArrays(r.TRIANGLES,0,6),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null)},blitFrame:function(t,i,n,s,r,a,o){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===a&&(a=!1),void 0===o&&(o=!1);var h=this.gl;if(this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",n),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,t.texture.webGLTexture),t.height>i.height)h.viewport(0,0,t.width,t.height),this.setTargetUVs(t,i);else{var l=i.height-t.height;h.viewport(0,l,t.width,t.height)}if(h.bindFramebuffer(h.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i.texture.webGLTexture,0),s&&(r?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),a){var u=this.renderer.currentBlendMode;this.renderer.setBlendMode(e.ERASE)}o&&this.flipY(),h.bufferData(h.ARRAY_BUFFER,this.vertexData,h.STATIC_DRAW),h.drawArrays(h.TRIANGLES,0,6),a&&this.renderer.setBlendMode(u),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null),this.resetUVs()},copyFrameRect:function(t,e,i,n,s,r,a,o){void 0===a&&(a=!0),void 0===o&&(o=!0);var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,t.texture.webGLTexture,0),a&&(o?h.clearColor(0,0,0,0):h.clearColor(0,0,0,1),h.clear(h.COLOR_BUFFER_BIT)),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,e.texture.webGLTexture),h.copyTexSubImage2D(h.TEXTURE_2D,0,0,0,i,n,s,r),h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null)},copyToGame:function(t){var e=this.gl;this.setShader(this.copyShader),this.set1i("uMainSampler",0),this.set1f("uBrightness",1),this.renderer.popFramebuffer(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture.webGLTexture),e.bufferData(e.ARRAY_BUFFER,this.vertexData,e.STATIC_DRAW),e.drawArrays(e.TRIANGLES,0,6)},drawFrame:function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=this.colorMatrix);var s=this.gl;this.setShader(this.colorMatrixShader),this.set1i("uMainSampler",0),this.set1fv("uColorMatrix",n.getData()),this.set1f("uAlpha",n.alpha),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,t.texture.webGLTexture),e?(s.viewport(0,0,e.width,e.height),s.bindFramebuffer(s.FRAMEBUFFER,e.framebuffer.webGLFramebuffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e.texture.webGLTexture,0)):s.viewport(0,0,t.width,t.height),i?s.clearColor(0,0,0,0):s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT),s.bufferData(s.ARRAY_BUFFER,this.vertexData,s.STATIC_DRAW),s.drawArrays(s.TRIANGLES,0,6),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D,null)},blendFrames:function(t,e,i,n,s,r){void 0===n&&(n=1),void 0===s&&(s=!0),void 0===r&&(r=this.linearShader);var a=this.gl;this.setShader(r),this.set1i("uMainSampler1",0),this.set1i("uMainSampler2",1),this.set1f("uStrength",n),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t.texture.webGLTexture),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,e.texture.webGLTexture),i?(a.bindFramebuffer(a.FRAMEBUFFER,i.framebuffer.webGLFramebuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i.texture.webGLTexture,0),a.viewport(0,0,i.width,i.height)):a.viewport(0,0,t.width,t.height),s?a.clearColor(0,0,0,0):a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT),a.bufferData(a.ARRAY_BUFFER,this.vertexData,a.STATIC_DRAW),a.drawArrays(a.TRIANGLES,0,6),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindTexture(a.TEXTURE_2D,null)},blendFramesAdditive:function(t,e,i,n,s){this.blendFrames(t,e,i,n,s,this.addShader)},clearFrame:function(t,e){void 0===e&&(e=!0);var i=this.gl;i.viewport(0,0,t.width,t.height),i.bindFramebuffer(i.FRAMEBUFFER,t.framebuffer.webGLFramebuffer),e?i.clearColor(0,0,0,0):i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);var n=this.renderer.currentFramebuffer;i.bindFramebuffer(i.FRAMEBUFFER,n.webGLFramebuffer)},setUVs:function(t,e,i,n,s,r,a,o){var h=this.vertexViewF32;h[2]=t,h[3]=e,h[6]=i,h[7]=n,h[10]=s,h[11]=r,h[14]=t,h[15]=e,h[18]=s,h[19]=r,h[22]=a,h[23]=o},setTargetUVs:function(t,e){var i=e.height/t.height;i=i>.5?.5-(i-.5):.5-i+.5,this.setUVs(0,i,0,1+i,1,1+i,1,i)},flipX:function(){this.setUVs(1,0,1,1,0,1,0,0)},flipY:function(){this.setUVs(0,1,0,0,1,0,1,1)},resetUVs:function(){this.setUVs(0,0,0,1,1,1,1,0)}});return B_=u}function XG(){if(U_)return z_;U_=1;var t=Ih(),e=_X(),i=eY(),n=Xl(),s=kh(),r=FX(),a=uX(),o=YX(),h=wG(),l=Vl(),u=DG(),c=IG(),d=BG(),f=_G(),p=NG(),g=zG(),m=UG(),v=YG(),y=cl(),x=Cl(),w=new t({initialize:function(t){this.game=t.game,this.renderer=t,this.classes=new i([[e.UTILITY_PIPELINE,v],[e.MULTI_PIPELINE,f],[e.BITMAPMASK_PIPELINE,o],[e.SINGLE_PIPELINE,m],[e.ROPE_PIPELINE,g],[e.LIGHT_PIPELINE,c],[e.POINTLIGHT_PIPELINE,p],[e.MOBILE_PIPELINE,d]]),this.postPipelineClasses=new i,this.pipelines=new i,this.postPipelineInstances=[],this.default=null,this.current=null,this.previous=null,this.MULTI_PIPELINE=null,this.BITMAPMASK_PIPELINE=null,this.UTILITY_PIPELINE=null,this.MOBILE_PIPELINE=null,this.FX_PIPELINE=null,this.fullFrame1,this.fullFrame2,this.halfFrame1,this.halfFrame2,this.renderTargets=[],this.maxDimension=0,this.frameInc=32,this.targetIndex=0},boot:function(t,i,a){var o=this.renderer,c=this.renderTargets;this.frameInc=Math.floor(s(t,"frameInc",32));var d,f,p=o.width,g=o.height,m=this.game.config.disablePreFX;if(this.game.config.disablePostFX||this.postPipelineClasses.setAll([[String(l.BARREL),h.Barrel],[String(l.BLOOM),h.Bloom],[String(l.BLUR),h.Blur],[String(l.BOKEH),h.Bokeh],[String(l.CIRCLE),h.Circle],[String(l.COLOR_MATRIX),h.ColorMatrix],[String(l.DISPLACEMENT),h.Displacement],[String(l.GLOW),h.Glow],[String(l.GRADIENT),h.Gradient],[String(l.PIXELATE),h.Pixelate],[String(l.SHADOW),h.Shadow],[String(l.SHINE),h.Shine],[String(l.VIGNETTE),h.Vignette],[String(l.WIPE),h.Wipe]]),!m){this.classes.set(e.FX_PIPELINE,u);for(var v=Math.min(p,g),y=Math.ceil(v/this.frameInc),x=1;x<y;x++){var w=x*this.frameInc;c.push(new r(o,w,w)),c.push(new r(o,w,w)),c.push(new r(o,w,w)),this.maxDimension=w}c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0)),c.push(new r(o,p,g,1,0,!0,!0))}var b=this,T=this.game;if(this.classes.each(function(t,i){d=b.add(t,new i({game:T})),t===e.UTILITY_PIPELINE&&(b.UTILITY_PIPELINE=d,b.fullFrame1=d.fullFrame1,b.fullFrame2=d.fullFrame2,b.halfFrame1=d.halfFrame1,b.halfFrame2=d.halfFrame2)}),this.MULTI_PIPELINE=this.get(e.MULTI_PIPELINE),this.BITMAPMASK_PIPELINE=this.get(e.BITMAPMASK_PIPELINE),this.MOBILE_PIPELINE=this.get(e.MOBILE_PIPELINE),m||(this.FX_PIPELINE=this.get(e.FX_PIPELINE)),t)for(f in t){var E=t[f];(d=new E(T)).name=f,d.isPostFX?this.postPipelineClasses.set(f,E):this.has(f)||(this.classes.set(f,E),this.add(f,d))}this.default=this.get(i),a&&!n.os.desktop&&(this.default=this.MOBILE_PIPELINE)},setDefaultPipeline:function(t){var e=this.get(t);return e&&(this.default=e),e},add:function(t,e){if(!e.isPostFX){var i=this.pipelines,n=this.renderer;return i.has(t)?console.warn("Pipeline exists: "+t):(e.name=t,e.manager=this,i.set(t,e)),e.hasBooted||e.boot(),0===n.width||0===n.height||e.isPreFX||e.resize(n.width,n.height),e}console.warn(t+" is a Post Pipeline. Use `addPostPipeline` instead")},addPostPipeline:function(t,e){this.postPipelineClasses.has(t)||this.postPipelineClasses.set(t,e)},flush:function(){this.current&&this.current.flush()},has:function(t){var e=this.pipelines;return"string"==typeof t?e.has(t):!!e.contains(t)},get:function(t){var e=this.pipelines;return"string"==typeof t?e.get(t):e.contains(t)?t:void 0},getPostPipeline:function(t,e,i){var n,s=this.postPipelineClasses,r="",a=typeof t;if("string"===a||"number"===a?(n=s.get(t),r=t):"function"===a?(s.contains(t)&&(n=t),r=t.name):"object"===a&&(n=s.get(t.name),r=t.name),n){var o=new n(this.game,i);return o.name=r,e&&(o.gameObject=e),this.postPipelineInstances.push(o),o}},removePostPipeline:function(t){x(this.postPipelineInstances,t)},remove:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),this.pipelines.delete(t),e&&this.classes.delete(t),i&&this.postPipelineClasses.delete(t)},set:function(t,e,i){if(!t.isPostFX)return this.isCurrent(t,i)||(this.flush(),this.current&&this.current.unbind(),this.current=t,t.bind(i)),t.updateProjectionMatrix(),t.onBind(e),t},preBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatch:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},preBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=e.length-1;i>=0;i--){var n=e[i];n.active&&n.preBatch(t)}}},postBatchCamera:function(t){if(t.hasPostPipeline){this.flush();for(var e=t.postPipelines,i=0;i<e.length;i++){var n=e[i];n.active&&n.postBatch(t)}}},isCurrent:function(t,e){var i=this.renderer,n=this.current;return n&&!e&&(e=n.currentShader),!(n!==t||e.program!==i.currentProgram)},copyFrame:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyFrame(t,e,i,n,s),this},copyToGame:function(t){return this.setUtility(this.UTILITY_PIPELINE.copyShader).copyToGame(t),this},drawFrame:function(t,e,i,n){return this.setUtility(this.UTILITY_PIPELINE.colorMatrixShader).drawFrame(t,e,i,n),this},blendFrames:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.linearShader).blendFrames(t,e,i,n,s),this},blendFramesAdditive:function(t,e,i,n,s){return this.setUtility(this.UTILITY_PIPELINE.addShader).blendFramesAdditive(t,e,i,n,s),this},clearFrame:function(t,e){return this.UTILITY_PIPELINE.clearFrame(t,e),this},blitFrame:function(t,e,i,n,s,r){return this.setUtility(this.UTILITY_PIPELINE.copyShader).blitFrame(t,e,i,n,s,r),this},copyFrameRect:function(t,e,i,n,s,r,a,o){return this.UTILITY_PIPELINE.copyFrameRect(t,e,i,n,s,r,a,o),this},forceZero:function(){return this.current&&this.current.forceZero},setMulti:function(){return this.set(this.MULTI_PIPELINE)},setUtility:function(t){return this.UTILITY_PIPELINE.bind(t)},setFX:function(){return this.set(this.FX_PIPELINE)},restoreContext:function(){this.rebind(),this.pipelines.each(function(t,e){e.restoreContext()}),y(this.postPipelineInstances,function(t){t.restoreContext()})},rebind:function(t){void 0===t&&this.previous&&(t=this.previous);var e=this.renderer,i=e.gl;i.disable(i.DEPTH_TEST),i.disable(i.CULL_FACE),e.hasActiveStencilMask()?i.clear(i.DEPTH_BUFFER_BIT):(i.disable(i.STENCIL_TEST),i.clear(i.DEPTH_BUFFER_BIT|i.STENCIL_BUFFER_BIT)),i.viewport(0,0,e.width,e.height),e.currentProgram=null,e.setBlendMode(0,!0);var n=e.vaoExtension;n&&n.bindVertexArrayOES(null);var s=this.pipelines.entries;for(var r in s)s[r].glReset=!0;t&&(this.current=t,t.rebind())},clear:function(){var t=this.renderer;this.flush(),this.current?(this.current.unbind(),this.previous=this.current,this.current=null):this.previous=null,t.currentProgram=null,t.setBlendMode(0,!0);var e=t.vaoExtension;e&&e.bindVertexArrayOES(null)},getRenderTarget:function(t){var e=this.renderTargets;if(t>this.maxDimension)return this.targetIndex=e.length-3,e[this.targetIndex];var i=3*(a(t,this.frameInc,0,!0)-1);return this.targetIndex=i,e[i]},getSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+1]},getAltSwapRenderTarget:function(){return this.renderTargets[this.targetIndex+2]},destroy:function(){this.flush(),this.classes.clear(),this.postPipelineClasses.clear(),this.pipelines.clear(),this.renderer=null,this.game=null,this.classes=null,this.postPipelineClasses=null,this.pipelines=null,this.default=null,this.current=null,this.previous=null}});return z_=w}function GG(){if(X_)return Y_;X_=1;var t=Dl(),e=mY(),i=kh();return Y_=function(n,s){var r=n,a=i(s,"callback"),o=i(s,"type","image/png"),h=i(s,"encoder",.92),l=Math.abs(Math.round(i(s,"x",0))),u=Math.abs(Math.round(i(s,"y",0))),c=i(s,"getPixel",!1),d=i(s,"isFramebuffer",!1),f=d?i(s,"bufferWidth",1):r.drawingBufferWidth,p=d?i(s,"bufferHeight",1):r.drawingBufferHeight;if(c){var g=new Uint8Array(4),m=d?u:p-u;r.readPixels(l,m,1,1,r.RGBA,r.UNSIGNED_BYTE,g),a.call(null,new e(g[0],g[1],g[2],g[3]))}else{var v=Math.floor(i(s,"width",f)),y=Math.floor(i(s,"height",p)),x=v*y*4,w=new Uint8Array(x);r.readPixels(l,p-u-y,v,y,r.RGBA,r.UNSIGNED_BYTE,w);for(var b=t.createWebGL(this,v,y),T=b.getContext("2d",{willReadFrequently:!0}),E=T.getImageData(0,0,v,y),S=E.data,_=0;_<y;_++)for(var C=0;C<v;C++){var A=4*((y-_-1)*v+C),M=d?x-4*(_*v+(v-C)):4*(_*v+C);S[M+0]=w[A+0],S[M+1]=w[A+1],S[M+2]=w[A+2],S[M+3]=w[A+3]}T.putImageData(E,0,0);var P=new Image;P.onerror=function(){a.call(null),t.remove(b)},P.onload=function(){a.call(null,P),t.remove(b)},P.src=b.toDataURL(o,h)}},Y_}function HG(){if(H_)return G_;H_=1;var t=new(Ih())({initialize:function(t,e,i,n){this.webGLBuffer=null,this.gl=t,this.initialDataOrSize=e,this.bufferType=i,this.bufferUsage=n,this.createResource()},createResource:function(){if(null!==this.initialDataOrSize){var t=this.gl;if(!t.isContextLost()){var e=this.bufferType,i=t.createBuffer();this.webGLBuffer=i,t.bindBuffer(e,this.webGLBuffer),t.bufferData(e,this.initialDataOrSize,this.bufferUsage),t.bindBuffer(e,null)}}},destroy:function(){var t=this.gl;t.isContextLost()||t.deleteBuffer(this.webGLBuffer),this.webGLBuffer=null,this.initialDataOrSize=null,this.gl=null}});return G_=t}function WG(){if(V_)return W_;V_=1;var t=new(Ih())({initialize:function(t,e,i){this.webGLProgram=null,this.gl=t,this.vertexSource=e,this.fragmentSource=i,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var e=t.createProgram(),i=t.createShader(t.VERTEX_SHADER),n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,this.vertexSource),t.shaderSource(n,this.fragmentSource),t.compileShader(i),t.compileShader(n);var s="Shader failed:\n";if(!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex "+s+t.getShaderInfoLog(i));if(!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error("Fragment "+s+t.getShaderInfoLog(n));if(t.attachShader(e,i),t.attachShader(e,n),t.linkProgram(e),!t.getProgramParameter(e,t.LINK_STATUS))throw new Error("Link "+s+t.getProgramInfoLog(e));t.useProgram(e),this.webGLProgram=e}},destroy:function(){this.webGLProgram&&(this.gl.isContextLost()||this.gl.deleteProgram(this.webGLProgram),this.webGLProgram=null,this.gl=null)}});return W_=t}function VG(){if(q_)return j_;q_=1;var t=Ih(),e=lX(),i=new t({initialize:function(t,e,i,n,s,r,a,o,h,l,u,c,d){this.webGLTexture=null,this.isRenderTexture=!1,this.gl=t,this.mipLevel=e,this.minFilter=i,this.magFilter=n,this.wrapT=s,this.wrapS=r,this.format=a,this.pixels=o,this.width=h,this.height=l,this.pma=null==u||u,this.forceSize=!!c,this.flipY=!!d,this.__SPECTOR_Metadata={},this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost())if(this.pixels instanceof i)this.webGLTexture=this.pixels.webGLTexture;else{var e=t.createTexture();e.__SPECTOR_Metadata=this.__SPECTOR_Metadata,this.webGLTexture=e,this._processTexture()}},update:function(t,e,i,n,s,r,a,o,h){0!==e&&0!==i&&(this.pixels=t,this.width=e,this.height=i,this.flipY=n,this.wrapS=s,this.wrapT=r,this.minFilter=a,this.magFilter=o,this.format=h,this.gl.isContextLost()||this._processTexture())},_processTexture:function(){var t=this.gl;t.activeTexture(t.TEXTURE0);var i=t.getParameter(t.TEXTURE_BINDING_2D);t.bindTexture(t.TEXTURE_2D,this.webGLTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.minFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.magFilter),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapT),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.pma),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY);var n=this.pixels,s=this.mipLevel,r=this.width,a=this.height,o=this.format,h=!1;if(null==n)t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,null),h=e(r,a);else if(n.compressed){r=n.width,a=n.height,h=n.generateMipmap;for(var l=0;l<n.mipmaps.length;l++)t.compressedTexImage2D(t.TEXTURE_2D,l,n.internalFormat,n.mipmaps[l].width,n.mipmaps[l].height,0,n.mipmaps[l].data)}else n instanceof Uint8Array?(t.texImage2D(t.TEXTURE_2D,s,o,r,a,0,o,t.UNSIGNED_BYTE,n),h=e(r,a)):(this.forceSize||(r=n.width,a=n.height),t.texImage2D(t.TEXTURE_2D,s,o,o,t.UNSIGNED_BYTE,n),h=e(r,a));h&&t.generateMipmap(t.TEXTURE_2D),i?t.bindTexture(t.TEXTURE_2D,i):t.bindTexture(t.TEXTURE_2D,null)},spectorMetadata:{get:function(){return this.__SPECTOR_Metadata},set:function(t){this.__SPECTOR_Metadata=t,this.gl.isContextLost()||(this.webGLTexture.__SPECTOR_Metadata=t)}},destroy:function(){null!==this.webGLTexture&&(this.gl.isContextLost()||this.pixels instanceof i||this.gl.deleteTexture(this.webGLTexture),this.pixels=null,this.webGLTexture=null,this.gl=null)}});return j_=i}function jG(){if(Z_)return K_;Z_=1;var t=Ih(),e={36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"},i=new t({initialize:function(t,e,i,n,s){this.webGLFramebuffer=null,this.gl=t,this.width=e,this.height=i,this.renderTexture=n,this.addDepthStencilBuffer=!!s,this.createResource()},createResource:function(){var t=this.gl;if(!t.isContextLost()){var i,n=this.renderTexture,s=t.createFramebuffer();if(this.webGLFramebuffer=s,t.bindFramebuffer(t.FRAMEBUFFER,s),n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.webGLTexture,0),(i=t.checkFramebufferStatus(t.FRAMEBUFFER))!==t.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer status: "+(e[i]||i));if(this.addDepthStencilBuffer){var r=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r)}t.bindFramebuffer(t.FRAMEBUFFER,null)}},destroy:function(){if(null!==this.webGLFramebuffer){var t=this.gl;if(!t.isContextLost()){t.bindFramebuffer(t.FRAMEBUFFER,this.webGLFramebuffer);var e=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==e&&(t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.deleteTexture(e));var i=t.getFramebufferAttachmentParameter(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);null!==i&&t.deleteRenderbuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(this.webGLFramebuffer)}this.renderTexture=null,this.webGLFramebuffer=null,this.gl=null}}});return K_=i}function qG(){if(J_)return $_;J_=1;var t=new(Ih())({initialize:function(t,e,i){this.webGLAttribLocation=-1,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLAttribLocation=t.getAttribLocation(this.program.webGLProgram,this.name))}else this.webGLAttribLocation=-1},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLAttribLocation=-1}});return $_=t}function KG(){if(tC)return Q_;tC=1;var t=new(Ih())({initialize:function(t,e,i){this.webGLUniformLocation=null,this.gl=t,this.program=e,this.name=i,this.createResource()},createResource:function(){if(null!==this.program.webGLProgram){var t=this.gl;t.isContextLost()||(this.webGLUniformLocation=t.getUniformLocation(this.program.webGLProgram,this.name))}else this.webGLUniformLocation=null},destroy:function(){this.gl=null,this.program=null,this.name=null,this.webGLUniformLocation=null}});return Q_=t}function ZG(){if(iC)return eC;iC=1;var t=cl(),e=Cl(),i=cY(),n=Ih(),s=Wo(),r=Iz(),a=PX(),o=lX(),h=gX(),l=Dh(),u=XG(),c=FX(),d=kY(),f=LX(),p=NX(),g=GG(),m=HG(),v=WG(),y=VG(),x=jG(),w=qG(),b=KG(),T=new n({Extends:r,initialize:function(t){r.call(this);var e=t.config,i={alpha:e.transparent,desynchronized:e.desynchronized,depth:!0,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference,preserveDrawingBuffer:e.preserveDrawingBuffer,willReadFrequently:!1};this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:i,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights,mipmapFilter:e.mipmapFilter},this.game=t,this.type=s.WEBGL,this.pipelines=null,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.contextLost=!1,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.maxTextures=0,this.textureIndexes,this.glBufferWrappers=[],this.glProgramWrappers=[],this.glTextureWrappers=[],this.glFramebufferWrappers=[],this.glAttribLocationWrappers=[],this.glUniformLocationWrappers=[],this.currentFramebuffer=null,this.fboStack=[],this.currentProgram=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=l,this.contextRestoredHandler=l,this.previousContextLostHandler=l,this.previousContextRestoredHandler=l,this.gl=null,this.supportedExtensions=null,this.instancedArraysExtension=null,this.vaoExtension=null,this.extensions={},this.glFormats,this.compression,this.drawingBufferHeight=0,this.blankTexture=null,this.normalTexture=null,this.whiteTexture=null,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.finalType=!1,this.mipmapFilter=null,this.defaultScissor=[0,0,0,0],this.isBooted=!1,this.renderTarget=null,this.projectionMatrix,this.projectionWidth=0,this.projectionHeight=0,this.maskSource=null,this.maskTarget=null,this.spector=null,this._debugCapture=!1,this.init(this.config)},init:function(t){var e,i=this.game,n=this.canvas,r=t.backgroundColor;if(!(e=i.config.context?i.config.context:n.getContext("webgl",t.contextCreation)||n.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e,this.setExtensions(),this.setContextHandlers(),i.context=e;for(var a=0;a<=27;a++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});return this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats=[e.BYTE,e.SHORT,e.UNSIGNED_BYTE,e.UNSIGNED_SHORT,e.FLOAT],this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}},t.maxTextures&&-1!==t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)),this.compression=this.getCompressedTextures(),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL),e.clear(e.COLOR_BUFFER_BIT),-1!==["NEAREST","LINEAR","NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR"].indexOf(t.mipmapFilter)&&(this.mipmapFilter=e[t.mipmapFilter]),this.maxTextures=p.checkShaderMax(e,t.maxTextures),this.textureIndexes=[],this.createTemporaryTextures(),this.pipelines=new u(this),this.setBlendMode(s.BlendModes.NORMAL),this.projectionMatrix=(new h).identity(),i.textures.once(f.READY,this.boot,this),this},boot:function(){var t=this.game,e=this.pipelines,i=t.scale.baseSize,n=i.width,s=i.height;this.width=n,this.height=s,this.isBooted=!0,this.renderTarget=new c(this,n,s,1,0,!0,!0),this.maskTarget=new c(this,n,s,1,0,!0,!0),this.maskSource=new c(this,n,s,1,0,!0,!0);var r=t.config;e.boot(r.pipeline,r.defaultPipeline,r.autoMobilePipeline),this.blankTexture=t.textures.getFrame("__DEFAULT").glTexture,this.normalTexture=t.textures.getFrame("__NORMAL").glTexture,this.whiteTexture=t.textures.getFrame("__WHITE").glTexture;var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),t.scale.on(d.RESIZE,this.onResize,this),this.resize(n,s)},setExtensions:function(){var t=this.gl,e=t.getSupportedExtensions();this.supportedExtensions=e;var i="ANGLE_instanced_arrays";this.instancedArraysExtension=e.indexOf(i)>-1?t.getExtension(i):null;var n="OES_vertex_array_object";this.vaoExtension=e.indexOf(n)>-1?t.getExtension(n):null},setContextHandlers:function(t,e){this.previousContextLostHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextLostHandler,!1),this.previousContextRestoredHandler&&this.canvas.removeEventListener("webglcontextlost",this.previousContextRestoredHandler,!1),this.contextLostHandler="function"==typeof t?t.bind(this):this.dispatchContextLost.bind(this),this.contextRestoredHandler="function"==typeof e?e.bind(this):this.dispatchContextRestored.bind(this),this.canvas.addEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.previousContextLostHandler=this.contextLostHandler,this.previousContextRestoredHandler=this.contextRestoredHandler},dispatchContextLost:function(t){this.contextLost=!0,console&&console.warn("WebGL Context lost. Renderer disabled"),this.emit(a.LOSE_WEBGL,this),t.preventDefault()},dispatchContextRestored:function(e){var i=this.gl;if(i.isContextLost())console&&console.log("WebGL Context restored, but context is still lost");else{this.currentProgram=null,this.currentFramebuffer=null,this.setBlendMode(s.BlendModes.NORMAL),i.disable(i.BLEND),i.disable(i.DEPTH_TEST),i.enable(i.CULL_FACE),this.compression=this.getCompressedTextures();var n=function(t){t.createResource()};t(this.glTextureWrappers,n),t(this.glBufferWrappers,n),t(this.glFramebufferWrappers,n),t(this.glProgramWrappers,n),t(this.glAttribLocationWrappers,n),t(this.glUniformLocationWrappers,n),this.createTemporaryTextures(),this.pipelines.restoreContext(),this.resize(this.game.scale.baseSize.width,this.game.scale.baseSize.height),this.setExtensions(),this.contextLost=!1,console&&console.warn("WebGL Context restored. Renderer running again."),this.emit(a.RESTORE_WEBGL,this),e.preventDefault()}},createTemporaryTextures:function(){for(var t=this.gl,e=0;e<this.maxTextures;e++){var i=t.createTexture();t.activeTexture(t.TEXTURE0+e),t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),this.textureIndexes.push(e)}},captureFrame:function(t,e){},captureNextFrame:function(){},getFps:function(){},log:function(){},startCapture:function(t,e,i){},stopCapture:function(){},onCapture:function(t){},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},beginCapture:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.renderTarget.bind(!0,t,e),this.setProjectionMatrix(t,e)},endCapture:function(){return this.renderTarget.unbind(!0),this.resetProjectionMatrix(),this.renderTarget},resize:function(t,e){var i=this.gl;return this.width=t,this.height=e,this.setProjectionMatrix(t,e),i.viewport(0,0,t,e),this.drawingBufferHeight=i.drawingBufferHeight,i.scissor(0,i.drawingBufferHeight-e,t,e),this.defaultScissor[2]=t,this.defaultScissor[3]=e,this.emit(a.RESIZE,t,e),this},getCompressedTextures:function(){var t="WEBGL_compressed_texture_",e="WEBKIT_"+t,i=function(i,n){var s=i.getExtension(t+n)||i.getExtension(e+n)||i.getExtension("EXT_texture_compression_"+n);if(s){var r={};for(var a in s)r[s[a]]=a;return r}},n=this.gl;return{ETC:i(n,"etc"),ETC1:i(n,"etc1"),ATC:i(n,"atc"),ASTC:i(n,"astc"),BPTC:i(n,"bptc"),RGTC:i(n,"rgtc"),PVRTC:i(n,"pvrtc"),S3TC:i(n,"s3tc"),S3TCSRGB:i(n,"s3tc_srgb"),IMG:!0}},getCompressedTextureName:function(t,e){var i=this.compression[t.toUpperCase()];if(e in i)return i[e]},supportsCompressedTexture:function(t,e){var i=this.compression[t.toUpperCase()];return!!i&&(!e||e in i)},getAspectRatio:function(){return this.width/this.height},setProjectionMatrix:function(t,e){return t===this.projectionWidth&&e===this.projectionHeight||(this.projectionWidth=t,this.projectionHeight=e,this.projectionMatrix.ortho(0,t,e,0,-1e3,1e3)),this},resetProjectionMatrix:function(){return this.setProjectionMatrix(this.width,this.height)},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.pipelines.flush()},pushScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=[t,e,i,n];return this.scissorStack.push(r),this.setScissor(t,e,i,n,s),this.currentScissor=r,r},setScissor:function(t,e,i,n,s){void 0===s&&(s=this.drawingBufferHeight);var r=this.gl,a=this.currentScissor,o=i>0&&n>0;if(a&&o){var h=a[0],l=a[1],u=a[2],c=a[3];o=h!==t||l!==e||u!==i||c!==n}o&&(this.flush(),r.scissor(t,s-e-n,i,n))},resetScissor:function(){var t=this.gl;t.enable(t.SCISSOR_TEST);var e=this.currentScissor;if(e){var i=e[0],n=e[1],s=e[2],r=e[3];s>0&&r>0&&t.scissor(i,this.drawingBufferHeight-n-r,s,r)}},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},resetViewport:function(){var t=this.gl;t.viewport(0,0,this.width,this.height),this.drawingBufferHeight=t.drawingBufferHeight},setBlendMode:function(t,e){void 0===e&&(e=!1);var i=this.gl,n=this.blendModes[t];return!!(e||t!==s.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),i.enable(i.BLEND),i.blendEquation(n.equation),n.func.length>2?i.blendFuncSeparate(n.func[0],n.func[1],n.func[2],n.func[3]):i.blendFunc(n.func[0],n.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,i){return this.blendModes[t]&&(this.blendModes[t].func=e,i&&(this.blendModes[t].equation=i)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},pushFramebuffer:function(t,e,i,n,s){return t===this.currentFramebuffer?this:(this.fboStack.push(t),this.setFramebuffer(t,e,i,n,s))},setFramebuffer:function(t,e,i,n,s){if(void 0===e&&(e=!1),void 0===i&&(i=!0),void 0===n&&(n=null),void 0===s&&(s=!1),t===this.currentFramebuffer)return this;var r=this.gl,a=this.width,o=this.height;return t&&t.renderTexture&&i?(a=t.renderTexture.width,o=t.renderTexture.height):this.flush(),t?r.bindFramebuffer(r.FRAMEBUFFER,t.webGLFramebuffer):r.bindFramebuffer(r.FRAMEBUFFER,null),i&&r.viewport(0,0,a,o),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n.webGLTexture,0),s&&(r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)),e&&(t?(this.drawingBufferHeight=o,this.pushScissor(0,0,a,o)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t,this},popFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack;i.pop();var n=i[i.length-1];return n||(n=null),this.setFramebuffer(n,t,e),n},restoreFramebuffer:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0);var i=this.fboStack,n=i[i.length-1];n||(n=null),this.currentFramebuffer=null,this.setFramebuffer(n,t,e)},setProgram:function(t){return t!==this.currentProgram&&(this.flush(),this.gl.useProgram(t.webGLProgram),this.currentProgram=t,!0)},resetProgram:function(){return this.gl.useProgram(this.currentProgram.webGLProgramWrapper),this},createTextureFromSource:function(t,e,i,n,r){void 0===r&&(r=!1);var a=this.gl,h=a.NEAREST,l=a.NEAREST,u=a.CLAMP_TO_EDGE;e=t?t.width:e,i=t?t.height:i;var c=o(e,i);if(c&&!r&&(u=a.REPEAT),n===s.ScaleModes.LINEAR&&this.config.antialias){var d=t&&t.compressed,f=!d&&c||d&&t.mipmaps.length>1;h=this.mipmapFilter&&f?this.mipmapFilter:a.LINEAR,l=a.LINEAR}return t||"number"!=typeof e||"number"!=typeof i?this.createTexture2D(0,h,l,u,u,a.RGBA,t):this.createTexture2D(0,h,l,u,u,a.RGBA,null,e,i)},createTexture2D:function(t,e,i,n,s,r,a,o,h,l,u,c){"number"!=typeof o&&(o=a?a.width:1),"number"!=typeof h&&(h=a?a.height:1);var d=new y(this.gl,t,e,i,n,s,r,a,o,h,l,u,c);return this.glTextureWrappers.push(d),d},createFramebuffer:function(t,e,i,n){this.currentFramebuffer=null;var s=new x(this.gl,t,e,i,n);return this.glFramebufferWrappers.push(s),s},beginBitmapMask:function(t,e){this.gl&&(this.flush(),this.maskTarget.bind(!0),this.currentCameraMask.mask!==t&&(this.currentMask.mask=t,this.currentMask.camera=e))},drawBitmapMask:function(t,e,i){this.flush(),this.maskSource.bind(),this.setBlendMode(0,!0),t.renderWebGL(this,t,e),this.maskSource.unbind(!0),this.maskTarget.unbind();var n=this.gl,s=this.getCurrentStencilMask();s?(n.enable(n.STENCIL_TEST),s.mask.applyStencil(this,s.camera,!0)):this.currentMask.mask=null,this.pipelines.set(i),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.maskTarget.texture.webGLTexture),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this.maskSource.texture.webGLTexture)},createProgram:function(t,e){var i=new v(this.gl,t,e);return this.glProgramWrappers.push(i),i},createVertexBuffer:function(t,e){var i=this.gl,n=new m(i,t,i.ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},createAttribLocation:function(t,e){var i=new w(this.gl,t,e);return this.glAttribLocationWrappers.push(i),i},createUniformLocation:function(t,e){var i=new b(this.gl,t,e);return this.glUniformLocationWrappers.push(i),i},createIndexBuffer:function(t,e){var i=this.gl,n=new m(i,t,i.ELEMENT_ARRAY_BUFFER,e);return this.glBufferWrappers.push(n),n},deleteTexture:function(t){if(t)return e(this.glTextureWrappers,t),t.destroy(),this},deleteFramebuffer:function(t){return t?(e(this.fboStack,t),e(this.glFramebufferWrappers,t),t.destroy(),this):this},deleteProgram:function(t){return t&&(e(this.glProgramWrappers,t),t.destroy()),this},deleteAttribLocation:function(t){return t&&(e(this.glAttribLocationWrappers,t),t.destroy()),this},deleteUniformLocation:function(t){return t&&(e(this.glUniformLocationWrappers,t),t.destroy()),this},deleteBuffer:function(t){return t?(e(this.glBufferWrappers,t),t.destroy(),this):this},preRenderCamera:function(t){var e=t.x,n=t.y,s=t.width,r=t.height,a=t.backgroundColor;t.emit(i.PRE_RENDER,t),this.pipelines.preBatchCamera(t),this.pushScissor(e,n,s,r),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),a.alphaGL>0&&this.pipelines.setMulti().drawFillRect(e,n,s,r,p.getTintFromFloats(a.blueGL,a.greenGL,a.redGL,1),a.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,i=this.currentCameraMask;return e.length>0?t=e[e.length-1]:i.mask&&i.mask.isStencil&&(t=i),t},postRenderCamera:function(t){var e=t.flashEffect,n=t.fadeEffect;if(e.isRunning||n.isRunning||n.isComplete){var s=this.pipelines.setMulti();e.postRenderWebGL(s,p.getTintFromFloats),n.postRenderWebGL(s,p.getTintFromFloats)}t.dirty=!1,this.popScissor(),t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera)),this.pipelines.postBatchCamera(t),t.emit(i.POST_RENDER,t)},preRender:function(){if(!this.contextLost){var t=this.gl;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.emit(a.PRE_RENDER_CLEAR),this.config.clearBeforeRender){var e=this.config.backgroundColor;t.clearColor(e.redGL,e.greenGL,e.blueGL,e.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}t.enable(t.SCISSOR_TEST),this.currentScissor=this.defaultScissor,this.scissorStack.length=0,this.scissorStack.push(this.currentScissor),this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.emit(a.PRE_RENDER)}},render:function(t,e,i){if(!this.contextLost){var n=e.length;if(this.emit(a.RENDER,t,i),this.preRenderCamera(i),0===n)return this.setBlendMode(s.BlendModes.NORMAL),void this.postRenderCamera(i);this.currentType="";for(var r=this.currentMask,o=0;o<n;o++){this.finalType=o===n-1;var h=e[o],l=h.mask;(r=this.currentMask).mask&&r.mask!==l&&r.mask.postRenderWebGL(this,r.camera),l&&r.mask!==l&&l.preRenderWebGL(this,h,i),h.blendMode!==this.currentBlendMode&&this.setBlendMode(h.blendMode);var u=h.type;u!==this.currentType&&(this.newType=!0,this.currentType=u),this.finalType?this.nextTypeMatch=!1:this.nextTypeMatch=e[o+1].type===this.currentType,h.renderWebGL(this,h,i),this.newType=!1}(r=this.currentMask).mask&&r.mask.postRenderWebGL(this,r.camera),this.setBlendMode(s.BlendModes.NORMAL),this.postRenderCamera(i)}},postRender:function(){if(!this.contextLost){this.flush(),this.emit(a.POST_RENDER);var t=this.snapshotState;t.callback&&(g(this.gl,t),t.callback=null)}},clearStencilMask:function(){this.gl.disable(this.gl.STENCIL_TEST)},restoreStencilMask:function(){var t=this.gl,e=this.getCurrentStencilMask();if(e){var i=e.mask;t.enable(t.STENCIL_TEST),i.invertAlpha?t.stencilFunc(t.NOTEQUAL,i.level,255):t.stencilFunc(t.EQUAL,i.level,255)}},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,i)},snapshotArea:function(t,e,i,n,s,r,a){var o=this.snapshotState;return o.callback=s,o.type=r,o.encoder=a,o.getPixel=!1,o.x=t,o.y=e,o.width=i,o.height=n,this},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,i,n,s,r,a,o,h,l,u){void 0===s&&(s=!1),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=e),void 0===h&&(h=i),"pixel"===l&&(s=!0,l="image/png");var c=this.currentFramebuffer;this.snapshotArea(r,a,o,h,n,l,u);var d=this.snapshotState;return d.getPixel=s,d.isFramebuffer=!0,d.bufferWidth=e,d.bufferHeight=i,d.width=Math.min(d.width,e),d.height=Math.min(d.height,i),this.setFramebuffer(t),g(this.gl,d),this.setFramebuffer(c),d.callback=null,d.isFramebuffer=!1,this},canvasToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.width,l=t.height,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!1,n)},createCanvasTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.canvasToTexture(t,null,e,i)},updateCanvasTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.canvasToTexture(t,e,n,i)},videoToTexture:function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var s=this.gl,r=s.NEAREST,a=s.NEAREST,h=t.videoWidth,l=t.videoHeight,u=s.CLAMP_TO_EDGE,c=o(h,l);return!i&&c&&(u=s.REPEAT),this.config.antialias&&(r=c&&this.mipmapFilter?this.mipmapFilter:s.LINEAR,a=s.LINEAR),e?(e.update(t,h,l,n,u,u,r,a,e.format),e):this.createTexture2D(0,r,a,u,u,s.RGBA,t,h,l,!0,!0,n)},createVideoTexture:function(t,e,i){return void 0===e&&(e=!1),void 0===i&&(i=!1),this.videoToTexture(t,null,e,i)},updateVideoTexture:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),this.videoToTexture(t,e,n,i)},createUint8ArrayTexture:function(t,e,i){var n=this.gl,s=n.NEAREST,r=n.NEAREST,a=n.CLAMP_TO_EDGE;return o(e,i)&&(a=n.REPEAT),this.createTexture2D(0,s,r,a,a,n.RGBA,t,e,i)},setTextureFilter:function(t,e){var i=this.gl,n=0===e?i.LINEAR:i.NEAREST;i.activeTexture(i.TEXTURE0);var s=i.getParameter(i.TEXTURE_BINDING_2D);return i.bindTexture(i.TEXTURE_2D,t.webGLTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n),t.minFilter=n,t.magFilter=n,s&&i.bindTexture(i.TEXTURE_2D,s),this},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1);var e=function(t){t.destroy()};t(this.glAttribLocationWrappers,e),t(this.glBufferWrappers,e),t(this.glFramebufferWrappers,e),t(this.glProgramWrappers,e),t(this.glTextureWrappers,e),t(this.glUniformLocationWrappers,e),this.maskTarget.destroy(),this.maskSource.destroy(),this.pipelines.destroy(),this.removeAllListeners(),this.fboStack=[],this.maskStack=[],this.extensions={},this.textureIndexes=[],this.gl=null,this.game=null,this.canvas=null,this.contextLost=!0,this.currentMask=null,this.currentCameraMask=null}});return eC=T}function $G(){if(sC)return nC;sC=1;var t=AX(),e=Dl(),i=Wo(),n=Il();return nC=function(s){var r=s.config;if((r.customEnvironment||r.canvas)&&r.renderType===i.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!r.customEnvironment&&!r.canvas&&r.renderType!==i.HEADLESS)if(r.renderType===i.AUTO&&(r.renderType=n.webGL?i.WEBGL:i.CANVAS),r.renderType===i.WEBGL){if(!n.webGL)throw new Error("Cannot create WebGL context, aborting.")}else{if(r.renderType!==i.CANVAS)throw new Error("Unknown value for renderer type: "+r.renderType);if(!n.canvas)throw new Error("Cannot create Canvas context, aborting.")}r.antialias||e.disableSmoothing();var a,o,h=s.scale.baseSize,l=h.width,u=h.height;r.canvas?(s.canvas=r.canvas,s.canvas.width=l,s.canvas.height=u):s.canvas=e.create(s,l,u,r.renderType),r.canvasStyle&&(s.canvas.style=r.canvasStyle),r.antialias||t.setCrisp(s.canvas),r.renderType!==i.HEADLESS&&(a=OX(),o=ZG(),r.renderType===i.WEBGL?s.renderer=new o(s):(s.renderer=new a(s),s.context=s.renderer.gameContext))}}function JG(){if(aC)return rC;aC=1;var t=Ih(),e=Dh(),i=new t({initialize:function(){this.isRunning=!1,this.callback=e,this.isSetTimeOut=!1,this.timeOutID=null,this.delay=0;var t=this;this.step=function e(i){t.callback(i),t.isRunning&&(t.timeOutID=window.requestAnimationFrame(e))},this.stepTimeout=function e(){t.isRunning&&(t.timeOutID=window.setTimeout(e,t.delay)),t.callback(window.performance.now())}},start:function(t,e,i){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.delay=i,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=e}});return rC=i}function QG(){if(hC)return oC;hC=1;var t=Ih();Tl();var e=Dh();JG();var i=new t({initialize:function(t,i){this.game=t,this.rafId=null,this.started=!1,this.running=!1,this.callback=e,this.lastTime=0},start:function(t){if(this.started)return this;this.started=!0,this.running=!0,this.callback=t,this.lastTime=performance.now(),this.rafId=requestAnimationFrame(this.tick.bind(this))},tick:function(t){var e=t-this.lastTime;this.callback(t,e),this.lastTime=t,this.rafId=requestAnimationFrame(this.tick.bind(this))},stop:function(){this.running&&(cancelAnimationFrame(this.rafId),this.running=!1)},destroy:function(){this.stop()}});return oC=i}function tH(){if(uC)return lC;uC=1;var t=iY();return lC=function(e){var i,n=e.events;void 0!==document.hidden?i="visibilitychange":["webkit","moz","ms"].forEach(function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},i=t+"visibilitychange")}),i&&document.addEventListener(i,function(e){document.hidden||"pause"===e.type?n.emit(t.HIDDEN):n.emit(t.VISIBLE)},!1),window.onblur=function(){n.emit(t.BLUR)},window.onfocus=function(){n.emit(t.FOCUS)},window.focus&&e.config.autoFocus&&window.focus()}}function eH(){return pC?fC:(pC=1,fC={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"})}function iH(){if(mC)return gC;mC=1;var t=eH(),e=Dl(),i=Tl();return gC=function(n){var s=i(n,"data",[]),r=i(n,"canvas",null),a=i(n,"palette",t),o=i(n,"pixelWidth",1),h=i(n,"pixelHeight",o),l=i(n,"resizeCanvas",!0),u=i(n,"clearCanvas",!0),c=i(n,"preRender",null),d=i(n,"postRender",null),f=Math.floor(Math.abs(s[0].length*o)),p=Math.floor(Math.abs(s.length*h));r||(r=e.create2D(this,f,p),l=!1,u=!1),l&&(r.width=f,r.height=p);var g=r.getContext("2d",{willReadFrequently:!0});u&&g.clearRect(0,0,f,p),c&&c(r,g);for(var m=0;m<s.length;m++)for(var v=s[m],y=0;y<v.length;y++){var x=v[y];"."!==x&&" "!==x&&(g.fillStyle=a[x],g.fillRect(y*o,m*h,o,h))}return d&&d(r,g),r},gC}function nH(){if(RC)return PC;RC=1;var t=Eu(),e=Gh();return PC=function(i,n){if(void 0===n&&(n=new t),0===i.length)return n;for(var s,r,a,o=Number.MAX_VALUE,h=Number.MAX_VALUE,l=e.MIN_SAFE_INTEGER,u=e.MIN_SAFE_INTEGER,c=0;c<i.length;c++)s=i[c],Array.isArray(s)?(r=s[0],a=s[1]):(r=s.x,a=s.y),o=Math.min(o,r),h=Math.min(h,a),l=Math.max(l,r),u=Math.max(u,a);return n.x=o,n.y=h,n.width=l-o,n.height=u-h,n}}function sH(){if(OC)return LC;OC=1;var t=Ih(),e=nH(),i=Eu(),n=wu(),s=new t({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new n,this._tmpVec2B=new n},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,n){t||(t=new i),void 0===n&&(n=16);var s=this.getLength();n>s&&(n=s/2);var r=Math.max(1,Math.round(s/n));return e(this.getSpacedPoints(r),t)},getDistancePoints:function(t){var e=this.getLength(),i=Math.max(1,e/t);return this.getSpacedPoints(i)},getEndPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i=[],n=this.getPoint(0,this._tmpVec2A),s=0;i.push(0);for(var r=1;r<=t;r++)s+=(e=this.getPoint(r/t,this._tmpVec2B)).distance(n),i.push(s),n.copy(e);return this.cacheArcLengths=i,i},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++)i.push(this.getPoint(n/t));return i},getRandomPoint:function(t){return void 0===t&&(t=new n),this.getPoint(Math.random(),t)},getSpacedPoints:function(t,e,i){void 0===i&&(i=[]),t||(t=e?this.getLength()/e:this.defaultDivisions);for(var n=0;n<=t;n++){var s=this.getUtoTmapping(n/t,null,t);i.push(this.getPoint(s))}return i},getStartPoint:function(t){return void 0===t&&(t=new n),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new n);var i=1e-4,s=t-i,r=t+i;return s<0&&(s=0),r>1&&(r=1),this.getPoint(s,this._tmpVec2A),this.getPoint(r,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var i=this.getUtoTmapping(t);return this.getTangent(i,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,i){var n,s=this.getLengths(i),r=0,a=s.length;n=e?Math.min(e,s[a-1]):t*s[a-1];for(var o,h=0,l=a-1;h<=l;)if((o=s[r=Math.floor(h+(l-h)/2)]-n)<0)h=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(s[r=l]===n)return r/(a-1);var u=s[r];return(r+(n-u)/(s[r+1]-u))/(a-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});return LC=s}function rH(){if(kC)return FC;kC=1;var t=Ih(),e=nX(),i=sH(),n=wu(),s=new t({Extends:i,initialize:function(t,e,s,r){i.call(this,"CubicBezierCurve"),Array.isArray(t)&&(r=new n(t[6],t[7]),s=new n(t[4],t[5]),e=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=e,this.p2=s,this.p3=r},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,i){void 0===i&&(i=new n);var s=this.p0,r=this.p1,a=this.p2,o=this.p3;return i.set(e(t,s.x,r.x,a.x,o.x),e(t,s.y,r.y,a.y,o.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]),o=new n(e[6],e[7]);return new s(i,r,a,o)},FC=s}function aH(){if(IC)return DC;IC=1;var t=Ih(),e=sH(),i=Ou(),n=Tl(),s=vX(),r=wu(),a=new t({Extends:e,initialize:function(t,s,a,o,h,l,u,c){if("object"==typeof t){var d=t;t=n(d,"x",0),s=n(d,"y",0),a=n(d,"xRadius",0),o=n(d,"yRadius",a),h=n(d,"startAngle",0),l=n(d,"endAngle",360),u=n(d,"clockwise",!1),c=n(d,"rotation",0)}else void 0===o&&(o=a),void 0===h&&(h=0),void 0===l&&(l=360),void 0===u&&(u=!1),void 0===c&&(c=0);e.call(this,"EllipseCurve"),this.p0=new r(t,s),this._xRadius=a,this._yRadius=o,this._startAngle=i(h),this._endAngle=i(l),this._clockwise=u,this._rotation=i(c)},getStartPoint:function(t){return void 0===t&&(t=new r),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new r);for(var i=2*Math.PI,n=this._endAngle-this._startAngle,s=Math.abs(n)<Number.EPSILON;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(n=s?0:i),this._clockwise&&!s&&(n===i?n=-i:n-=i);var a=this._startAngle+t*n,o=this.p0.x+this._xRadius*Math.cos(a),h=this.p0.y+this._yRadius*Math.sin(a);if(0!==this._rotation){var l=Math.cos(this._rotation),u=Math.sin(this._rotation),c=o-this.p0.x,d=h-this.p0.y;o=c*l-d*u+this.p0.x,h=c*u+d*l+this.p0.y}return e.set(o,h)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=t/2,this},setHeight:function(t){return this.yRadius=t/2,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return s(this._startAngle)},set:function(t){this._startAngle=i(t)}},endAngle:{get:function(){return s(this._endAngle)},set:function(t){this._endAngle=i(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return s(this._rotation)},set:function(t){this._rotation=i(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:s(this._startAngle),endAngle:s(this._endAngle),clockwise:this._clockwise,rotation:s(this._rotation)}}});return a.fromJSON=function(t){return new a(t)},DC=a}function oH(){if(NC)return BC;NC=1;var t=Ih(),e=sH(),i=nH(),n=Eu(),s=wu(),r=new t({Extends:e,initialize:function(t,i){e.call(this,"LineCurve"),Array.isArray(t)&&(i=new s(t[2],t[3]),t=new s(t[0],t[1])),this.p0=t,this.p1=i,this.arcLengthDivisions=1},getBounds:function(t){return void 0===t&&(t=new n),i([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new s),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new s),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(t,e){return void 0===e&&(e=new s),e.copy(this.p1).subtract(this.p0).normalize(),e},getUtoTmapping:function(t,e,i){var n;if(e){var s=this.getLengths(i),r=s[s.length-1];n=Math.min(e,r)/r}else n=t;return n},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});return r.fromJSON=function(t){var e=t.points,i=new s(e[0],e[1]),n=new s(e[2],e[3]);return new r(i,n)},BC=r}function hH(){if(UC)return zC;UC=1;var t=Ih(),e=wu(),i=new t({initialize:function(t,i){this.active=!1,this.p0=new e(t,i)},getPoint:function(t,i){return void 0===i&&(i=new e),i.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});return zC=i}function lH(){if(XC)return YC;XC=1;var t=Ih(),e=sH(),i=rX(),n=wu(),s=new t({Extends:e,initialize:function(t,i,s){e.call(this,"QuadraticBezierCurve"),Array.isArray(t)&&(s=new n(t[4],t[5]),i=new n(t[2],t[3]),t=new n(t[0],t[1])),this.p0=t,this.p1=i,this.p2=s},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new n);var s=this.p0,r=this.p1,a=this.p2;return e.set(i(t,s.x,r.x,a.x),i(t,s.y,r.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var i=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var n=1;n<i.length;n++)t.lineTo(i[n].x,i[n].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});return s.fromJSON=function(t){var e=t.points,i=new n(e[0],e[1]),r=new n(e[2],e[3]),a=new n(e[4],e[5]);return new s(i,r,a)},YC=s}function uH(){if(HC)return GC;HC=1;var t=eX(),e=Ih(),i=sH(),n=wu(),s=new e({Extends:i,initialize:function(t){void 0===t&&(t=[]),i.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var i=new n;"number"==typeof t[e]?(i.x=t[e],i.y=t[e+1],e++):Array.isArray(t[e])?(i.x=t[e][0],i.y=t[e][1]):(i.x=t[e].x,i.y=t[e].y),this.points.push(i)}return this},addPoint:function(t,e){var i=new n(t,e);return this.points.push(i),i},getStartPoint:function(t){return void 0===t&&(t=new n),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(e,i){void 0===i&&(i=new n);var s=this.points,r=(s.length-1)*e,a=Math.floor(r),o=r-a,h=s[0===a?a:a-1],l=s[a],u=s[a>s.length-2?s.length-1:a+1],c=s[a>s.length-3?s.length-1:a+2];return i.set(t(o,h.x,l.x,u.x,c.x),t(o,h.y,l.y,u.y,c.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});return s.fromJSON=function(t){return new s(t.points)},GC=s}function cH(){if(VC)return WC;VC=1;var t=Ih(),e=rH(),i=aH(),n=Mu(),s=oH(),r=hH(),a=lH(),o=Eu(),h=uH(),l=wu(),u=Gh(),c=new t({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.defaultDivisions=12,this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new l,this._tmpVec2A=new l,this._tmpVec2B=new l,"object"==typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,i){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,i)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new s(e,t)),this},cubicBezierTo:function(t,i,n,s,r,a){var o,h,u,c=this.getEndPoint();return t instanceof l?(o=t,h=i,u=n):(o=new l(n,s),h=new l(r,a),u=new l(t,i)),this.add(new e(c,o,h,u))},quadraticBezierTo:function(t,e,i,n){var s,r,o=this.getEndPoint();return t instanceof l?(s=t,r=e):(s=new l(i,n),r=new l(t,e)),this.add(new a(o,s,r))},draw:function(t,e){for(var i=0;i<this.curves.length;i++){var n=this.curves[i];n.active&&n.draw(t,e)}return t},ellipseTo:function(t,e,n,s,r,a){var o=new i(0,0,t,e,n,s,r,a),h=this.getEndPoint(this._tmpVec2A),l=o.getStartPoint(this._tmpVec2B);return h.subtract(l),o.x=h.x,o.y=h.y,this.add(o)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var n=0;n<t.curves.length;n++){var r=t.curves[n];switch(r.type){case"LineCurve":this.add(s.fromJSON(r));break;case"EllipseCurve":this.add(i.fromJSON(r));break;case"SplineCurve":this.add(h.fromJSON(r));break;case"CubicBezierCurve":this.add(e.fromJSON(r));break;case"QuadraticBezierCurve":this.add(a.fromJSON(r))}}return this},getBounds:function(t,e){void 0===t&&(t=new o),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var i=new o,n=u.MIN_SAFE_INTEGER,s=u.MIN_SAFE_INTEGER,r=0;r<this.curves.length;r++){var a=this.curves[r];a.active&&(a.getBounds(i,e),t.x=Math.min(t.x,i.x),t.y=Math.min(t.y,i.y),n=Math.max(n,i.right),s=Math.max(s,i.bottom))}return t.right=n,t.bottom=s,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0;i<this.curves.length;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getCurveAt:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e)return this.curves[n];n++}return null},getEndPoint:function(t){return void 0===t&&(t=new l),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getPointAt(h,e)}s++}return null},getPoints:function(t,e){t||e||(t=this.defaultDivisions);for(var i,n=[],s=0;s<this.curves.length;s++){var r=this.curves[s];if(r.active)for(var a=r.getResolution(t),o=r.getPoints(a,e),h=0;h<o.length;h++){var l=o[h];i&&i.equals(l)||(n.push(l),i=l)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},getRandomPoint:function(t){return void 0===t&&(t=new l),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new l),t.copy(this.startPoint)},getTangent:function(t,e){void 0===e&&(e=new l);for(var i=t*this.getLength(),n=this.getCurveLengths(),s=0;s<n.length;){if(n[s]>=i){var r=n[s]-i,a=this.curves[s],o=a.getLength(),h=0===o?0:1-r/o;return a.getTangentAt(h,e)}s++}return null},lineTo:function(t,e){t instanceof l?this._tmpVec2B.copy(t):"object"==typeof t?this._tmpVec2B.setFromObject(t):this._tmpVec2B.set(t,e);var i=this.getEndPoint(this._tmpVec2A);return this.add(new s([i.x,i.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new h(t))},moveTo:function(t,e){return t instanceof l?this.add(new r(t.x,t.y)):this.add(new r(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});return n.register("path",function(t,e){return new c(t,e)}),WC=c}function dH(){if(ZC)return KC;ZC=1;var t=Ih(),e=Ju(),i=Cu(),n=Au(),s=new t({Extends:e,initialize:function(t){e.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(n.DESTROY,this.destroy,this)},start:function(){this.events.once(n.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){e.prototype.destroy.call(this),this.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("DataManagerPlugin",s,"data"),KC=s}function fH(){if(sA)return nA;sA=1;var t=qo(),e=jo(),i={In:tA?QC:(tA=1,QC={BottomCenter:Eh(),BottomLeft:Sh(),BottomRight:_h(),Center:Ah(),LeftCenter:Mh(),QuickSet:Fh(),RightCenter:Ph(),TopCenter:Rh(),TopLeft:Lh(),TopRight:Oh()}),To:iA?eA:(iA=1,eA={BottomCenter:Qo(),BottomLeft:ih(),BottomRight:rh(),LeftBottom:oh(),LeftCenter:uh(),LeftTop:dh(),QuickSet:xh(),RightBottom:fh(),RightCenter:ph(),RightTop:gh(),TopCenter:mh(),TopLeft:vh(),TopRight:yh()})};return i=e(!1,i,t),nA=i}function pH(){if(aA)return rA;aA=1;var t=new(Ih())({initialize:function(t,e,i,n){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),i&&""!==i||(i=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","varying vec2 outTexCoord;","void main () {","   gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","   fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","   outTexCoord = vec2(inPosition.x / uResolution.x, fragCoord.y / uResolution.y);","}"].join("\n")),void 0===n&&(n=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=i,this.uniforms=n}});return rA=t}function gH(){if(hA)return oA;hA=1;var t=Ko(),e=th(),i=nh(),n=ch(),s=Eu();return oA=function(r,a){void 0===a&&(a=new s);var o=e(r),h=n(r);return a.x=o,a.y=h,a.width=i(r)-o,a.height=t(r)-h,a}}function mH(){return CA||(CA=1,_A=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}),_A}function vH(){return MA?AA:(MA=1,AA=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t})}function yH(){if(UA)return zA;UA=1;var t=mY();return t.ColorSpectrum=function(){if(TA)return bA;TA=1;var t=dY();return bA=function(e){void 0===e&&(e=1024);var i,n=[],s=255,r=255,a=0,o=0;for(i=0;i<=s;i++)n.push({r:r,g:i,b:o,color:t(r,i,o)});for(a=255,i=s;i>=0;i--)n.push({r:i,g:a,b:o,color:t(i,a,o)});for(r=0,i=0;i<=s;i++,a--)n.push({r:r,g:a,b:i,color:t(r,a,i)});for(a=0,o=255,i=0;i<=s;i++,o--,r++)n.push({r:r,g:a,b:o,color:t(r,a,o)});if(1024===e)return n;var h=[],l=0,u=1024/e;for(i=0;i<e;i++)h.push(n[Math.floor(l)]),l+=u;return h}}(),t.ColorToRGBA=(SA||(SA=1,EA=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}),EA),t.ComponentToHex=mH(),t.GetColor=dY(),t.GetColor32=fY(),t.HexStringToColor=vY(),t.HSLToColor=function(){if(RA)return PA;RA=1;var t=mY(),e=vH();return PA=function(i,n,s){var r=s,a=s,o=s;if(0!==n){var h=s<.5?s*(1+n):s+n-s*n,l=2*s-h;r=e(l,h,i+1/3),a=e(l,h,i),o=e(l,h,i-1/3)}return(new t).setGLTo(r,a,o,1)}}(),t.HSVColorWheel=function(){if(OA)return LA;OA=1;var t=pY();return LA=function(e,i){void 0===e&&(e=1),void 0===i&&(i=1);for(var n=[],s=0;s<=359;s++)n.push(t(s/359,e,i));return n}}(),t.HSVToRGB=pY(),t.HueToComponent=vH(),t.IntegerToColor=xY(),t.IntegerToRGB=yY(),t.Interpolate=function(){if(kA)return FA;kA=1;var t=OY(),e=dY(),i=function(i,n,s,r,a,o,h,l){void 0===h&&(h=100),void 0===l&&(l=0);var u=l/h,c=t(i,r,u),d=t(n,a,u),f=t(s,o,u);return{r:c,g:d,b:f,a:255,color:e(c,d,f)}};return FA={RGBWithRGB:i,ColorWithRGB:function(t,e,n,s,r,a){return void 0===r&&(r=100),void 0===a&&(a=0),i(t.r,t.g,t.b,e,n,s,r,a)},ColorWithColor:function(t,e,n,s){return void 0===n&&(n=100),void 0===s&&(s=0),i(t.r,t.g,t.b,e.r,e.g,e.b,n,s)}},FA}(),t.ObjectToColor=wY(),t.RandomRGB=function(){if(IA)return DA;IA=1;var t=sY(),e=mY();return DA=function(i,n){return void 0===i&&(i=0),void 0===n&&(n=255),new e(t(i,n),t(i,n),t(i,n))}}(),t.RGBStringToColor=bY(),t.RGBToHSV=gY(),t.RGBToString=function(){if(NA)return BA;NA=1;var t=mH();return BA=function(e,i,n,s,r){return void 0===s&&(s=255),void 0===r&&(r="#"),"#"===r?"#"+((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1,7):"0x"+t(s)+t(e)+t(i)+t(n)}}(),t.ValueToColor=TY(),zA=t}function xH(){if(HA)return GA;HA=1;var t=Ih(),e=Dh(),i=new t({initialize:function(t,i,n){this._rgb=[0,0,0],this.onChangeCallback=e,this.dirty=!1,this.set(t,i,n)},set:function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._rgb=[t,e,i],this.onChange(),this},equals:function(t,e,i){var n=this._rgb;return n[0]===t&&n[1]===e&&n[2]===i},onChange:function(){this.dirty=!0;var t=this._rgb;this.onChangeCallback.call(this,t[0],t[1],t[2])},r:{get:function(){return this._rgb[0]},set:function(t){this._rgb[0]=t,this.onChange()}},g:{get:function(){return this._rgb[1]},set:function(t){this._rgb[1]=t,this.onChange()}},b:{get:function(){return this._rgb[2]},set:function(t){this._rgb[2]=t,this.onChange()}},destroy:function(){this.onChangeCallback=null}});return GA=i}function wH(){return qA||(qA=1,jA=function(t,e){var i;if(e)"string"==typeof e?i=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(i=e);else if(t.parentElement||null===e)return t;return i||(i=document.body),i.appendChild(t),t}),jA}function bH(){if(ZA)return KA;ZA=1;var t=Ol();return KA=function(e){if("complete"!==document.readyState&&"interactive"!==document.readyState){var i=function(){document.removeEventListener("deviceready",i,!0),document.removeEventListener("DOMContentLoaded",i,!0),window.removeEventListener("load",i,!0),e()};document.body?t.cordova?document.addEventListener("deviceready",i,!1):(document.addEventListener("DOMContentLoaded",i,!0),window.addEventListener("load",i,!0)):window.setTimeout(i,20)}else e()}}function TH(){return JA?$A:(JA=1,$A=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),i={w:0,h:0},n=document.createElement("div");return n.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(n),i.w=90===e?n.offsetHeight:window.innerWidth,i.h=90===e?window.innerWidth:n.offsetHeight,document.documentElement.removeChild(n),n=null,90!==Math.abs(window.orientation)?i.h:i.w})}function EH(){return tM?QA:(tM=1,QA={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3})}function SH(){return iM?eM:(iM=1,eM={LANDSCAPE:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary",PORTRAIT:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary"})}function _H(){return sM?nM:(sM=1,nM={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5,EXPAND:6})}function CH(){return aM?rM:(aM=1,rM={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1})}function AH(){if(hM)return oM;hM=1;var t={CENTER:EH(),ORIENTATION:SH(),SCALE_MODE:_H(),ZOOM:CH()};return oM=t}function MH(){if(uM)return lM;uM=1;var t=AH();return lM=function(e,i){var n=window.screen,s=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);return s&&"string"==typeof s.type?s.type:"string"==typeof s?s:"number"==typeof window.orientation?0===window.orientation||180===window.orientation?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE:window.matchMedia?window.matchMedia("(orientation: portrait)").matches?t.ORIENTATION.PORTRAIT:window.matchMedia("(orientation: landscape)").matches?t.ORIENTATION.LANDSCAPE:void 0:i>e?t.ORIENTATION.PORTRAIT:t.ORIENTATION.LANDSCAPE}}function PH(){return dM||(dM=1,cM=function(t){var e;return""!==t&&("string"==typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e}),cM}function RH(){return pM||(pM=1,fM=function(t){var e="";try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}),fM}function LH(){return mM?gM:(mM=1,gM=function(t){t.parentNode&&t.parentNode.removeChild(t)})}function OH(){if(yM)return vM;yM=1;var t={AddToDOM:wH(),DOMContentLoaded:bH(),GetInnerHeight:TH(),GetScreenOrientation:MH(),GetTarget:PH(),ParseXML:RH(),RemoveFromDOM:LH(),RequestAnimationFrame:JG()};return vM=t}function FH(){if(wM)return xM;wM=1;var t=Ih(),e=Iz(),i=Cu(),n=new t({Extends:e,initialize:function(){e.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});return i.register("EventEmitter",n,"events"),xM=n}function kH(){return CM?_M:(CM=1,_M={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8})}function DH(){return dR?cR:(dR=1,cR={BOOT:MM?AM:(MM=1,AM="boot"),DESTROY:RM?PM:(RM=1,PM="destroy"),DRAG_END:OM?LM:(OM=1,LM="dragend"),DRAG_ENTER:kM?FM:(kM=1,FM="dragenter"),DRAG:IM?DM:(IM=1,DM="drag"),DRAG_LEAVE:NM?BM:(NM=1,BM="dragleave"),DRAG_OVER:UM?zM:(UM=1,zM="dragover"),DRAG_START:XM?YM:(XM=1,YM="dragstart"),DROP:HM?GM:(HM=1,GM="drop"),GAME_OUT:VM?WM:(VM=1,WM="gameout"),GAME_OVER:qM?jM:(qM=1,jM="gameover"),GAMEOBJECT_DOWN:ZM?KM:(ZM=1,KM="gameobjectdown"),GAMEOBJECT_DRAG_END:JM?$M:(JM=1,$M="dragend"),GAMEOBJECT_DRAG_ENTER:tP?QM:(tP=1,QM="dragenter"),GAMEOBJECT_DRAG:iP?eP:(iP=1,eP="drag"),GAMEOBJECT_DRAG_LEAVE:sP?nP:(sP=1,nP="dragleave"),GAMEOBJECT_DRAG_OVER:aP?rP:(aP=1,rP="dragover"),GAMEOBJECT_DRAG_START:hP?oP:(hP=1,oP="dragstart"),GAMEOBJECT_DROP:uP?lP:(uP=1,lP="drop"),GAMEOBJECT_MOVE:dP?cP:(dP=1,cP="gameobjectmove"),GAMEOBJECT_OUT:pP?fP:(pP=1,fP="gameobjectout"),GAMEOBJECT_OVER:mP?gP:(mP=1,gP="gameobjectover"),GAMEOBJECT_POINTER_DOWN:yP?vP:(yP=1,vP="pointerdown"),GAMEOBJECT_POINTER_MOVE:wP?xP:(wP=1,xP="pointermove"),GAMEOBJECT_POINTER_OUT:TP?bP:(TP=1,bP="pointerout"),GAMEOBJECT_POINTER_OVER:SP?EP:(SP=1,EP="pointerover"),GAMEOBJECT_POINTER_UP:CP?_P:(CP=1,_P="pointerup"),GAMEOBJECT_POINTER_WHEEL:MP?AP:(MP=1,AP="wheel"),GAMEOBJECT_UP:RP?PP:(RP=1,PP="gameobjectup"),GAMEOBJECT_WHEEL:OP?LP:(OP=1,LP="gameobjectwheel"),MANAGER_BOOT:kP?FP:(kP=1,FP="boot"),MANAGER_PROCESS:IP?DP:(IP=1,DP="process"),MANAGER_UPDATE:NP?BP:(NP=1,BP="update"),POINTER_DOWN:UP?zP:(UP=1,zP="pointerdown"),POINTER_DOWN_OUTSIDE:XP?YP:(XP=1,YP="pointerdownoutside"),POINTER_MOVE:HP?GP:(HP=1,GP="pointermove"),POINTER_OUT:VP?WP:(VP=1,WP="pointerout"),POINTER_OVER:qP?jP:(qP=1,jP="pointerover"),POINTER_UP:ZP?KP:(ZP=1,KP="pointerup"),POINTER_UP_OUTSIDE:JP?$P:(JP=1,$P="pointerupoutside"),POINTER_WHEEL:tR?QP:(tR=1,QP="wheel"),POINTERLOCK_CHANGE:iR?eR:(iR=1,eR="pointerlockchange"),PRE_UPDATE:sR?nR:(sR=1,nR="preupdate"),SHUTDOWN:aR?rR:(aR=1,rR="shutdown"),START:hR?oR:(hR=1,oR="start"),UPDATE:uR?lR:(uR=1,lR="update")})}function IH(){return pR?fR:(pR=1,fR={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175})}function BH(){if(mR)return gR;mR=1;var t=Cl(),e=Ih(),i=iY(),n=DH(),s=IH(),r=Dh(),a=new e({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.target,this.onKeyDown=r,this.onKeyUp=r,t.events.once(n.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(i.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}},this.onKeyUp=function(e){if(!e.defaultPrevented&&t.enabled&&t.manager){t.queue.push(e),t.manager.events.emit(n.MANAGER_PROCESS);var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;t.preventDefault&&!i&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault()}};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,i=0;i<t.length;i++){var n=t[i];"string"==typeof n&&(n=s[n.trim().toUpperCase()]),-1===e.indexOf(n)&&e.push(n)}this.preventDefault=e.length>0},removeCapture:function(e){"string"==typeof e&&(e=e.split(",")),Array.isArray(e)||(e=[e]);for(var i=this.captures,n=0;n<e.length;n++){var r=e[n];"string"==typeof r&&(r=s[r.toUpperCase()]),t(i,r)}this.preventDefault=i.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(i.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});return gR=a}function NH(){if(yR)return vR;yR=1;var t=Ih(),e=Il(),i=DH(),n=Dh(),s=new t({initialize:function(t){this.manager=t,this.preventDefaultDown=!0,this.preventDefaultUp=!0,this.preventDefaultMove=!0,this.preventDefaultWheel=!1,this.enabled=!1,this.target,this.locked=!1,this.onMouseMove=n,this.onMouseDown=n,this.onMouseUp=n,this.onMouseDownWindow=n,this.onMouseUpWindow=n,this.onMouseOver=n,this.onMouseOut=n,this.onMouseWheel=n,this.pointerLockChange=n,this.isTop=!0,t.events.once(i.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.passive=t.inputMousePassive,this.preventDefaultDown=t.inputMousePreventDefaultDown,this.preventDefaultUp=t.inputMousePreventDefaultUp,this.preventDefaultMove=t.inputMousePreventDefaultMove,this.preventDefaultWheel=t.inputMousePreventDefaultWheel,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},requestPointerLock:function(){if(e.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){e.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this.target;if(t){var i=this,n=this.manager,s=n.canvas,r=window&&window.focus&&n.game.config.autoFocus;this.onMouseMove=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseMove(t),i.preventDefaultMove&&t.preventDefault())},this.onMouseDown=function(t){r&&window.focus(),!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseDown(t),i.preventDefaultDown&&t.target===s&&t.preventDefault())},this.onMouseDownWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseDown(t)},this.onMouseUp=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&(n.onMouseUp(t),i.preventDefaultUp&&t.target===s&&t.preventDefault())},this.onMouseUpWindow=function(t){t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||!t.defaultPrevented&&i.enabled&&n&&n.enabled&&t.target!==s&&n.onMouseUp(t)},this.onMouseOver=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOver(t)},this.onMouseOut=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.setCanvasOut(t)},this.onMouseWheel=function(t){!t.defaultPrevented&&i.enabled&&n&&n.enabled&&n.onMouseWheel(t),i.preventDefaultWheel&&t.target===s&&t.preventDefault()};var a={passive:!0};if(t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",this.onMouseOver,a),t.addEventListener("mouseout",this.onMouseOut,a),this.preventDefaultWheel?t.addEventListener("wheel",this.onMouseWheel,{passive:!1}):t.addEventListener("wheel",this.onMouseWheel,a),window&&n.game.config.inputWindowEvents)try{window.top.addEventListener("mousedown",this.onMouseDownWindow,a),window.top.addEventListener("mouseup",this.onMouseUpWindow,a)}catch(t){window.addEventListener("mousedown",this.onMouseDownWindow,a),window.addEventListener("mouseup",this.onMouseUpWindow,a),this.isTop=!1}e.pointerLock&&(this.pointerLockChange=function(t){var e=i.target;i.locked=document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e,n.onPointerLockChange(t)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&((t=this.isTop?window.top:window).removeEventListener("mousedown",this.onMouseDownWindow),t.removeEventListener("mouseup",this.onMouseUpWindow)),e.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return vR=s}function zH(){if(wR)return xR;wR=1;var t=BY(),e=Ih(),i=EU(),n=xu(),s=aX(),r=wu(),a=Ol(),o=new e({initialize:function(t,e){this.manager=t,this.id=e,this.event,this.downElement,this.upElement,this.camera=null,this.button=0,this.buttons=0,this.position=new r,this.prevPosition=new r,this.midPoint=new r(-1,-1),this.velocity=new r,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=t.getWorldPoint(this.x,this.y);return this.worldX=e.x,this.worldY=e.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var e=this.position.x,i=this.position.y,r=this.midPoint.x,a=this.midPoint.y;if(e!==r||i!==a){var o=s(this.motionFactor,r,e),h=s(this.motionFactor,a,i);n(o,e,.1)&&(o=e),n(h,i,.1)&&(h=i),this.midPoint.set(o,h);var l=e-o,u=i-h;this.velocity.set(l,u),this.angle=t(o,h,e,i),this.distance=Math.sqrt(l*l+u*u)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y),0===this.buttons&&(this.isDown=!1,this.upTime=t.timeStamp,this.wasTouch=!1)},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y),a.macOS&&t.ctrlKey&&(this.buttons=2,this.primaryDown=!1),this.isDown||(this.isDown=!0,this.downTime=t.timeStamp),this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.buttons?0===this.button&&!this.isDown:0===this.button},rightButtonReleased:function(){return 0===this.buttons?2===this.button&&!this.isDown:2===this.button},middleButtonReleased:function(){return 0===this.buttons?1===this.button&&!this.isDown:1===this.button},backButtonReleased:function(){return 0===this.buttons?3===this.button&&!this.isDown:3===this.button},forwardButtonReleased:function(){return 0===this.buttons?4===this.button&&!this.isDown:4===this.button},getDistance:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?t(this.downX,this.downY,this.x,this.y):t(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var i=this.prevPosition.x,n=this.prevPosition.y,r=this.position.x,a=this.position.y,o=0;o<t;o++){var h=1/t*o;e[o]={x:s(h,i,r),y:s(h,n,a)}}return e},reset:function(){this.event=null,this.downElement=null,this.upElement=null,this.button=0,this.buttons=0,this.position.set(0,0),this.prevPosition.set(0,0),this.midPoint.set(-1,-1),this.velocity.set(0,0),this.angle=0,this.distance=0,this.worldX=0,this.worldY=0,this.downX=0,this.downY=0,this.upX=0,this.upY=0,this.moveTime=0,this.upTime=0,this.downTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.active=0===this.id},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});return xR=o}function UH(){if(TR)return bR;TR=1;var t=Ih(),e=DH(),i=Dh(),n=new t({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.target,this.onTouchStart=i,this.onTouchStartWindow=i,this.onTouchMove=i,this.onTouchEnd=i,this.onTouchEndWindow=i,this.onTouchCancel=i,this.onTouchCancelWindow=i,this.isTop=!0,t.events.once(e.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return this.target.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},startListeners:function(){var t=this.target;if(t){var e=this,i=this.manager,n=i.canvas,s=window&&window.focus&&i.game.config.autoFocus;this.onTouchMove=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchMove(t),e.capture&&t.cancelable&&t.preventDefault())},this.onTouchStart=function(t){s&&window.focus(),!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchStart(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchStartWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchStart(t)},this.onTouchEnd=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchEnd(t),e.capture&&t.cancelable&&t.target===n&&t.preventDefault())},this.onTouchEndWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&t.target!==n&&i.onTouchEnd(t)},this.onTouchCancel=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&(i.onTouchCancel(t),e.capture&&t.preventDefault())},this.onTouchCancelWindow=function(t){!t.defaultPrevented&&e.enabled&&i&&i.enabled&&i.onTouchCancel(t)};var r=this.capture,a={passive:!0},o={passive:!1};if(t.addEventListener("touchstart",this.onTouchStart,r?o:a),t.addEventListener("touchmove",this.onTouchMove,r?o:a),t.addEventListener("touchend",this.onTouchEnd,r?o:a),t.addEventListener("touchcancel",this.onTouchCancel,r?o:a),window&&i.game.config.inputWindowEvents)try{window.top.addEventListener("touchstart",this.onTouchStartWindow,o),window.top.addEventListener("touchend",this.onTouchEndWindow,o),window.top.addEventListener("touchcancel",this.onTouchCancelWindow,o)}catch(t){window.addEventListener("touchstart",this.onTouchStartWindow,o),window.addEventListener("touchend",this.onTouchEndWindow,o),window.addEventListener("touchcancel",this.onTouchCancelWindow,o),this.isTop=!1}this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),window&&((t=this.isTop?window.top:window).removeEventListener("touchstart",this.onTouchStartWindow),t.removeEventListener("touchend",this.onTouchEndWindow),t.removeEventListener("touchcancel",this.onTouchCancelWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});return bR=n}function YH(){if(SR)return ER;SR=1;var t=Ih(),e=kH(),i=Iz(),n=DH(),s=iY(),r=BH(),a=NH(),o=zH(),h=UH(),l=Hu(),u=Wu(),c=new t({initialize:function(t,e){this.game=t,this.scaleManager,this.canvas,this.config=e,this.enabled=!0,this.events=new i,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new r(this):null,this.mouse=e.inputMouse?new a(this):null,this.touch=e.inputTouch?new h(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers;for(var n=0;n<=this.pointersTotal;n++){var u=new o(this,n);u.smoothFactor=e.inputSmoothFactor,this.pointers.push(u)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new l,this._tempMatrix2=new l,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(s.BOOT,this.boot,this)},boot:function(){var t=this.game,e=t.events;this.canvas=t.canvas,this.scaleManager=t.scale,this.events.emit(n.MANAGER_BOOT),e.on(s.PRE_RENDER,this.preRender,this),e.once(s.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(n.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(n.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,i=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(n.MANAGER_UPDATE);for(var s=0;s<i.length;s++){var r=i[s];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t,e){(e||t&&t.cursor)&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var i=0;i<t;i++){var n=this.pointers.length,s=new o(this,n);s.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(s),this.pointersTotal++,e.push(s)}return e},updateInputPlugins:function(t,e){var i=this.game.scene.getScenes(!1,!0);this._tempSkip=!1;for(var n=0;n<i.length;n++){var s=i[n];if(s.sys.input&&(s.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip))return}},onTouchStart:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(!o.active){o.touchstart(r,t),this.activePointer=o,n.push(o);break}}this.updateInputPlugins(e.TOUCH_START,n)},onTouchMove:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){var h=document.elementFromPoint(r.clientX,r.clientY)===this.canvas;!this.isOver&&h?this.setCanvasOver(t):this.isOver&&!h&&this.setCanvasOut(t),this.isOver&&(o.touchmove(r,t),this.activePointer=o,n.push(o));break}}this.updateInputPlugins(e.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchend(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_END,n)},onTouchCancel:function(t){for(var i=this.pointers,n=[],s=0;s<t.changedTouches.length;s++)for(var r=t.changedTouches[s],a=1;a<i.length;a++){var o=i[a];if(o.active&&o.identifier===r.identifier){o.touchcancel(r,t),n.push(o);break}}this.updateInputPlugins(e.TOUCH_CANCEL,n)},onMouseDown:function(t){var i=this.mousePointer;i.down(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){var i=this.mousePointer;i.move(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){var i=this.mousePointer;i.up(t),i.updateMotion(),this.activePointer=i,this.updateInputPlugins(e.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){var i=this.mousePointer;i.wheel(t),this.activePointer=i,this.updateInputPlugins(e.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(n.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var i=t.input;if(!i||!i.enabled||!t.willRender(e))return!1;var n=!0,s=t.parentContainer;if(s)do{if(!s.willRender(e)){n=!1;break}s=s.parentContainer}while(s);return n},hitTest:function(t,e,i,n){void 0===n&&(n=this._tempHitTest);var s=this._tempPoint,r=i.scrollX,a=i.scrollY;n.length=0;var o=t.x,h=t.y;i.getWorldPoint(o,h,s),t.worldX=s.x,t.worldY=s.y;for(var l={x:0,y:0},c=this._tempMatrix,d=this._tempMatrix2,f=0;f<e.length;f++){var p=e[f];if(this.inputCandidate(p,i)){var g=s.x+r*p.scrollFactorX-r,m=s.y+a*p.scrollFactorY-a;p.parentContainer?(p.getWorldTransformMatrix(c,d),c.applyInverse(g,m,l)):u(g,m,p.x,p.y,p.rotation,p.scaleX,p.scaleY,l),this.pointWithinHitArea(p,l.x,l.y)&&n.push(p)}}return n},pointWithinHitArea:function(t,e,i){e+=t.displayOriginX,i+=t.displayOriginY;var n=t.input;return!(!n||!n.hitAreaCallback(n.hitArea,e,i,t)||(n.localX=e,n.localY=i,0))},pointWithinInteractiveObject:function(t,e,i){return!!t.hitArea&&(e+=t.gameObject.displayOriginX,i+=t.gameObject.displayOriginY,t.localX=e,t.localY=i,t.hitAreaCallback(t.hitArea,e,i,t))},transformPointer:function(t,e,i,n){var s=t.position,r=t.prevPosition;r.x=s.x,r.y=s.y;var a=this.scaleManager.transformX(e),o=this.scaleManager.transformY(i),h=t.smoothFactor;n&&0!==h?(s.x=a*h+r.x*(1-h),s.y=o*h+r.y*(1-h)):(s.x=a,s.y=o)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(s.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});return ER=c}function XH(){if(CR)return _R;CR=1;var t={},e={install:function(e){for(var i in t)e[i]=t[i]},register:function(e,i){t[e]=i},destroy:function(){t={}}};return _R=e}function GH(){if(MR)return AR;MR=1;var t=Ih(),e=Cu(),i=Au(),n=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.displayList,this.updateList,this.events.once(i.BOOT,this.boot,this),this.events.on(i.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.events.once(i.DESTROY,this.destroy,this)},start:function(){this.events.once(i.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.events.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.events=null,this.displayList=null,this.updateList=null}});return n.register=function(t,e){n.prototype.hasOwnProperty(t)||(n.prototype[t]=e)},n.remove=function(t){n.prototype.hasOwnProperty(t)&&delete n.prototype[t]},e.register("GameObjectCreator",n,"make"),AR=n}function HH(){if(RR)return PR;RR=1;var t=Ih(),e=iY(),i=Iz(),n=XH(),s=GH(),r=Mu(),a=kh(),o=Cu(),h=Cl(),l=Wo(),u=new t({Extends:i,initialize:function(t){i.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted||t.config.renderType===l.HEADLESS?this.boot():t.events.once(e.BOOT,this.boot,this)},boot:function(){var t,i,n,s,r,o,h,l=this.game.config,u=l.installGlobalPlugins;for(u=u.concat(this._pendingGlobal),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),r=a(i,"start",!1),o=a(i,"mapping",null),h=a(i,"data",null),n&&(s?this.install(n,s,r,o,h):console.warn("Missing `plugin` for key: "+n));for(u=(u=l.installScenePlugins).concat(this._pendingScene),t=0;t<u.length;t++)i=u[t],n=a(i,"key",null),s=a(i,"plugin",null),o=a(i,"mapping",null),n&&(s?this.installScenePlugin(n,s,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(e.DESTROY,this.destroy,this)},addToScene:function(t,e,i){var n,s,r,a=this.game,h=t.scene,l=t.settings.map,u=t.settings.isBooted;for(n=0;n<e.length;n++)a[s=e[n]]?(t[s]=a[s],l.hasOwnProperty(s)&&(h[l[s]]=t[s])):"game"===s&&l.hasOwnProperty(s)&&(h[l[s]]=a);for(var c=0;c<i.length;c++)for(r=i[c],n=0;n<r.length;n++)if(s=r[n],o.hasCore(s)){var d=o.getCore(s),f=d.mapping,p=new d.plugin(h,this,f);t[f]=p,d.custom?h[f]=p:l.hasOwnProperty(f)&&(h[l[f]]=p),u&&p.boot()}for(r=this.plugins,n=0;n<r.length;n++){var g=r[n];g.mapping&&(h[g.mapping]=g.plugin)}},getDefaultScenePlugins:function(){var t=this.game.config.defaultPlugins;return t.concat(this.scenePlugins)},installScenePlugin:function(t,e,i,n,s){if(void 0===s&&(s=!1),"function"==typeof e){if(o.hasCore(t)||o.register(t,e,i,!0),-1===this.scenePlugins.indexOf(t))this.scenePlugins.push(t);else if(!s&&o.hasCore(t))return void console.warn("Scene Plugin key in use: "+t);if(n){var r=new e(n,this,t);n.sys[t]=r,i&&""!==i&&(n[i]=r),r.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,i,n,s){if(void 0===i&&(i=!1),void 0===n&&(n=null),void 0===s&&(s=null),"function"!=typeof e)return console.warn("Invalid Plugin: "+t),null;if(o.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==n&&(i=!0),this.game.isBooted){if(o.registerCustom(t,e,n,s),i)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:i,mapping:n,data:s});return null},getIndex:function(t){for(var e=this.plugins,i=0;i<e.length;i++)if(e[i].key===t)return i;return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var i=this.getEntry(e);return i&&!i.active?(i.active=!0,i.plugin.start()):i||(i=this.createEntry(t,e)),i?i.plugin:null},createEntry:function(t,e){var i=o.getCustom(t);if(i){var n=new i.plugin(this);i={key:e,plugin:n,active:!0,mapping:i.mapping,data:i.data},this.plugins.push(i),n.init(i.data),n.start()}return i},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var i=this.getEntry(t);if(i)return i.plugin;var n=this.getClass(t);return n&&e?(i=this.createEntry(t,t))?i.plugin:null:n||null},getClass:function(t){return o.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&h(this.plugins,e),o.removeCustom(t)},removeScenePlugin:function(t){h(this.scenePlugins,t),o.remove(t)},registerGameObject:function(t,e,i){return e&&r.register(t,e),i&&s.register(t,i),this},removeGameObject:function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=!0),e&&r.remove(t),i&&s.remove(t),this},registerFileType:function(t,e,i){n.register(t,e),i&&i.sys.load&&(i.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();o.destroyCustomPlugins(),this.game.noReturn&&o.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});return PR=u}function WH(){if(OR)return LR;OR=1;var t=Yh(),e=Ih(),i=cX(),n=wu(),s=new e({initialize:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===s&&(s=null),this._width=t,this._height=e,this._parent=s,this.aspectMode=i,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new n},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(e,i){return void 0===e&&(e=0),void 0===i&&(i=e),this.minWidth=t(e,0,this.maxWidth),this.minHeight=t(i,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(e,i){return void 0===e&&(e=Number.MAX_VALUE),void 0===i&&(i=e),this.maxWidth=t(e,this.minWidth,Number.MAX_VALUE),this.maxHeight=t(i,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case s.NONE:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case s.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case s.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(i(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case s.FIT:this.constrain(t,e,!0);break;case s.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(i(t,this.snapTo.x)),this._height=this.getNewHeight(i(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minWidth,this.maxWidth),i&&this._parent&&e>this._parent.width&&(e=Math.max(this.minWidth,this._parent.width)),e},getNewHeight:function(e,i){return void 0===i&&(i=!0),e=t(e,this.minHeight,this.maxHeight),i&&this._parent&&e>this._parent.height&&(e=Math.max(this.minHeight,this._parent.height)),e},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var s=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=i(t,s.x))/this.aspectRatio,s.y>0&&(t=(e=i(e,s.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=i(e,s.y))*this.aspectRatio,s.x>0&&(e=(t=i(t,s.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});return s.NONE=0,s.WIDTH_CONTROLS_HEIGHT=1,s.HEIGHT_CONTROLS_WIDTH=2,s.FIT=3,s.ENVELOP=4,LR=s}function VH(){if(kR)return FR;kR=1;var t=AH(),e=Ih(),i=Yh(),n=Iz(),s=kY(),r=iY(),a=TH(),o=PH(),h=MH(),l=Dh(),u=Eu(),c=WH(),d=cX(),f=wu(),p=FY(),g=new e({Extends:n,initialize:function(e){n.call(this),this.game=e,this.canvas,this.canvasBounds=new u,this.parent=null,this.parentIsWindow=!1,this.parentSize=new c,this.gameSize=new c,this.baseSize=new c,this.displaySize=new c,this.scaleMode=t.SCALE_MODE.NONE,this.zoom=1,this._resetZoom=!1,this.displayScale=new f(1,1),this.autoRound=!1,this.autoCenter=t.CENTER.NO_CENTER,this.orientation=t.ORIENTATION.LANDSCAPE,this.fullscreen,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.domlisteners={orientationChange:l,windowResize:l,fullScreenChange:l,fullScreenError:l}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once(r.BOOT,this.boot,this)},boot:function(){var e=this.game;this.canvas=e.canvas,this.fullscreen=e.device.fullscreen;var i=this.scaleMode;i!==t.SCALE_MODE.RESIZE&&i!==t.SCALE_MODE.EXPAND&&this.displaySize.setAspectMode(i),i===t.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),e.events.on(r.PRE_STEP,this.step,this),e.events.once(r.READY,this.refresh,this),e.events.once(r.DESTROY,this.destroy,this),this.startListeners()},parseConfig:function(e){this.getParent(e),this.getParentBounds();var i=e.width,n=e.height,s=e.scaleMode,r=e.zoom,a=e.autoRound;if("string"==typeof i)if("%"!==i.substr(-1))i=parseInt(i,10);else{var o=this.parentSize.width;0===o&&(o=window.innerWidth);var l=parseInt(i,10)/100;i=Math.floor(o*l)}if("string"==typeof n)if("%"!==n.substr(-1))n=parseInt(n,10);else{var u=this.parentSize.height;0===u&&(u=window.innerHeight);var c=parseInt(n,10)/100;n=Math.floor(u*c)}this.scaleMode=s,this.autoRound=a,this.autoCenter=e.autoCenter,this.resizeInterval=e.resizeInterval,a&&(i=Math.floor(i),n=Math.floor(n)),this.gameSize.setSize(i,n),r===t.ZOOM.MAX_ZOOM&&(r=this.getMaxZoom()),this.zoom=r,1!==r&&(this._resetZoom=!0),this.baseSize.setSize(i,n),a&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),e.minWidth>0&&this.displaySize.setMin(e.minWidth*r,e.minHeight*r),e.maxWidth>0&&this.displaySize.setMax(e.maxWidth*r,e.maxHeight*r),this.displaySize.setSize(i,n),(e.snapWidth>0||e.snapHeight>0)&&this.displaySize.setSnap(e.snapWidth,e.snapHeight),this.orientation=h(i,n)},getParent:function(e){var i=e.parent;if(null!==i){if(this.parent=o(i),this.parentIsWindow=this.parent===document.body,e.expandParent&&e.scaleMode!==t.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}e.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=o(e.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=a(!0));var i=e.width,n=e.height;if(t.width!==i||t.height!==n)return t.setSize(i,n),!0;if(this.canvas){var s=this.canvasBounds,r=this.canvas.getBoundingClientRect();if(r.x!==s.x||r.y!==s.y)return!0}return!1},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e.call(screen,t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var i=this.autoRound;i&&(t=Math.floor(t),e=Math.floor(e));var n=this.width,s=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t,e),i&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setAspectRatio(t/e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(n,s)},resize:function(t,e){var i=this.zoom,n=this.autoRound;n&&(t=Math.floor(t),e=Math.floor(e));var s=this.width,r=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t,e),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*i,e*i),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var a=this.canvas.style,o=t*i,h=e*i;return n&&(o=Math.floor(o),h=Math.floor(h)),o===t&&h===e||(a.width=o+"px",a.height=h+"px"),this.refresh(s,r)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displaySize.setSnap(t,e),this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var i=this.game.domContainer;if(i){this.baseSize.setCSS(i);var n=this.canvas.style,r=i.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=n.marginLeft,r.marginTop=n.marginTop}return this.emit(s.RESIZE,this.gameSize,this.baseSize,this.displaySize,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=h(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(s.ORIENTATION_CHANGE,t))}},updateScale:function(){var e,n,s=this.canvas.style,r=this.gameSize.width,a=this.gameSize.height,o=this.zoom,h=this.autoRound;if(this.scaleMode===t.SCALE_MODE.NONE)this.displaySize.setSize(r*o,a*o),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this._resetZoom&&(s.width=e+"px",s.height=n+"px",this._resetZoom=!1);else if(this.scaleMode===t.SCALE_MODE.RESIZE)this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(this.displaySize.width,this.displaySize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),this.canvas.width=e,this.canvas.height=n;else if(this.scaleMode===t.SCALE_MODE.EXPAND){var l,u,c=this.game.config.width,d=this.game.config.height,f=this.parentSize.width,p=this.parentSize.height,g=f/c,m=p/d;g<m?(l=c,u=0!==g?p/g:d):(l=0!==m?f/m:c,u=d);var v=i(l,this.displaySize.minWidth,this.displaySize.maxWidth),y=i(u,this.displaySize.minHeight,this.displaySize.maxHeight);this.baseSize.setSize(v,y),this.gameSize.setSize(v,y),h&&(v=Math.floor(v),y=Math.floor(y)),this.canvas.width=v,this.canvas.height=y;var x=f*(v/l),w=p*(y/u);this.displaySize.setSize(x,w),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px"}else this.displaySize.setSize(this.parentSize.width,this.parentSize.height),e=this.displaySize.width,n=this.displaySize.height,h&&(e=Math.floor(e),n=Math.floor(n)),s.width=e+"px",s.height=n+"px";this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=d(this.parentSize.width,this.gameSize.width,0,!0),e=d(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var e=this.autoCenter;if(e!==t.CENTER.NO_CENTER){var i=this.canvas,n=i.style,s=i.getBoundingClientRect(),r=s.width,a=s.height,o=Math.floor((this.parentSize.width-r)/2),h=Math.floor((this.parentSize.height-a)/2);e===t.CENTER.CENTER_HORIZONTALLY?h=0:e===t.CENTER.CENTER_VERTICALLY&&(o=0),n.marginLeft=o+"px",n.marginTop=h+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var i=this.getFullscreenTarget();e.keyboard?i[e.request](Element.ALLOW_KEYBOARD_INPUT):i[e.request](t)}}else this.emit(s.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(s.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(s.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}return this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(s.FULLSCREEN_UNSUPPORTED),!1;t.active&&document[t.cancel](),this.removeFullscreenTarget()},leaveFullScreenSuccessHandler:function(){this.getParentBounds(),this.emit(s.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.domlisteners;e.orientationChange=function(){t.updateBounds(),t._checkOrientation=!0,t.dirty=!0,t.refresh()},e.windowResize=function(){t.updateBounds(),t.dirty=!0},screen.orientation&&screen.orientation.addEventListener?screen.orientation.addEventListener("change",e.orientationChange,!1):window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available&&(e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)},["webkit","moz",""].forEach(function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1))},onFullScreenChange:function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement?this.fullscreenSuccessHandler():(this.stopFullscreen(),this.leaveFullScreenSuccessHandler())},onFullScreenError:function(){this.removeFullscreenTarget()},getViewPort:function(t,e){t instanceof p||(e=t,t=void 0),void 0===e&&(e=new u);var i,n,s=this.baseSize,r=this.parentSize,a=this.canvasBounds,o=this.displayScale,h=a.x>=0?0:-a.x*o.x,l=a.y>=0?0:-a.y*o.y;return i=r.width>=a.width?s.width:s.width-(a.width-r.width)*o.x,n=r.height>=a.height?s.height:s.height-(a.height-r.height)*o.y,e.setTo(h,l,i,n),t&&(e.width/=t.zoomX,e.height/=t.zoomY,e.centerX=t.centerX+t.scrollX,e.centerY=t.centerY+t.scrollY),e},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.domlisteners;screen.orientation&&screen.orientation.addEventListener?screen.orientation.removeEventListener("change",t.orientationChange,!1):window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1),["webkit","moz",""].forEach(function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===t.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===t.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});return FR=g}function jH(){return IR?DR:(IR=1,DR={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9})}function qH(){return sL?nL:(sL=1,nL={ADD:NR?BR:(NR=1,BR="addfile"),COMPLETE:UR?zR:(UR=1,zR="complete"),FILE_COMPLETE:XR?YR:(XR=1,YR="filecomplete"),FILE_KEY_COMPLETE:HR?GR:(HR=1,GR="filecomplete-"),FILE_LOAD_ERROR:VR?WR:(VR=1,WR="loaderror"),FILE_LOAD:qR?jR:(qR=1,jR="load"),FILE_PROGRESS:ZR?KR:(ZR=1,KR="fileprogress"),POST_PROCESS:JR?$R:(JR=1,$R="postprocess"),PROGRESS:tL?QR:(tL=1,QR="progress"),START:iL?eL:(iL=1,eL="start")})}function KH(){if(aL)return rL;aL=1;var t=kh(),e=rU();return rL=function(i){var n=i.game.config.defaultPhysicsSystem,s=t(i.settings,"physics",!1);if(n||s){var r=[];if(n&&r.push(e(n+"Physics")),s)for(var a in s)a=e(a.concat("Physics")),-1===r.indexOf(a)&&r.push(a);return r}}}function ZH(){if(hL)return oL;hL=1;var t=kh();return oL=function(e){var i=e.plugins.getDefaultScenePlugins(),n=t(e.settings,"plugins",!1);return Array.isArray(n)?n:i||[]}}function $H(){return uL?lL:(uL=1,lL=function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i]=t[i].slice(0):e[i]=t[i];return e})}function JH(){if(dL)return cL;dL=1;var t=$H();return cL=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)||(n[s]=i[s]);return n}}function QH(){if(mL)return gL;mL=1;var t=jH(),e=Tl(),i=JH(),n=function(){if(pL)return fL;pL=1;return fL={game:"game",renderer:"renderer",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter",cameras3d:"cameras3d",facebook:"facebook"}}();return gL={create:function(s){return"string"==typeof s?s={key:s}:void 0===s&&(s={}),{status:t.PENDING,key:e(s,"key",""),active:e(s,"active",!1),visible:e(s,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:e(s,"pack",!1),cameras:e(s,"cameras",null),map:e(s,"map",i(n,e(s,"mapAdd",{}))),physics:e(s,"physics",{}),loader:e(s,"loader",{}),plugins:e(s,"plugins",!1),input:e(s,"input",{})}}}}function tW(){if(yL)return vL;yL=1;var t=Ih(),e=jH(),i=IY(),n=Au(),s=KH(),r=ZH(),a=Dh(),o=QH(),h=new t({initialize:function(t,e){this.scene=t,this.game,this.renderer,this.facebook,this.config=e,this.settings=o.create(e),this.canvas,this.context,this.anims,this.cache,this.plugins,this.registry,this.scale,this.sound,this.textures,this.add,this.cameras,this.displayList,this.events,this.make,this.scenePlugin,this.updateList,this.sceneUpdate=a},init:function(t){this.settings.status=e.INIT,this.sceneUpdate=a,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var o=t.plugins;this.plugins=o,o.addToScene(this,i.Global,[i.CoreScene,r(this),s(this)]),this.events.emit(n.BOOT,this),this.settings.isBooted=!0},step:function(t,e){var i=this.events;i.emit(n.PRE_UPDATE,t,e),i.emit(n.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),i.emit(n.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.events.emit(n.PRE_RENDER,t),this.cameras.render(t,e),this.events.emit(n.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot pause non-running Scene",i.key):this.settings.active&&(i.status=e.PAUSED,i.active=!1,this.events.emit(n.PAUSE,this,t)),this},resume:function(t){var i=this.events,s=this.settings;return this.settings.active||(s.status=e.RUNNING,s.active=!0,i.emit(n.RESUME,this,t)),this},sleep:function(t){var i=this.settings,s=this.getStatus();return s!==e.CREATING&&s!==e.RUNNING?console.warn("Cannot sleep non-running Scene",i.key):(i.status=e.SLEEPING,i.active=!1,i.visible=!1,this.events.emit(n.SLEEP,this,t)),this},wake:function(t){var i=this.events,s=this.settings;return s.status=e.RUNNING,s.active=!0,s.visible=!0,i.emit(n.WAKE,this,t),s.isTransition&&i.emit(n.TRANSITION_WAKE,s.transitionFrom,s.transitionDuration),this},getData:function(){return this.settings.data},getStatus:function(){return this.settings.status},canInput:function(){var t=this.settings.status;return t>e.PENDING&&t<=e.RUNNING},isSleeping:function(){return this.settings.status===e.SLEEPING},isActive:function(){return this.settings.status===e.RUNNING},isPaused:function(){return this.settings.status===e.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){var i=this.events,s=this.settings;t&&(s.data=t),s.status=e.START,s.active=!0,s.visible=!0,i.emit(n.START,this),i.emit(n.READY,this,t)},shutdown:function(t){var i=this.events,s=this.settings;i.off(n.TRANSITION_INIT),i.off(n.TRANSITION_START),i.off(n.TRANSITION_COMPLETE),i.off(n.TRANSITION_OUT),s.status=e.SHUTDOWN,s.active=!1,s.visible=!1,i.emit(n.SHUTDOWN,this,t)},destroy:function(){var t=this.events,i=this.settings;i.status=e.DESTROYED,i.active=!1,i.visible=!1,t.emit(n.DESTROY,this),t.removeAllListeners();for(var s=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],r=0;r<s.length;r++)this[s[r]]=null}});return vL=h}function eW(){if(wL)return xL;wL=1;var t=Ih(),e=tW(),i=new t({initialize:function(t){this.sys=new e(this,t),this.game,this.anims,this.cache,this.registry,this.sound,this.textures,this.events,this.cameras,this.add,this.make,this.scene,this.children,this.lights,this.data,this.input,this.load,this.time,this.tweens,this.physics,this.matter,this.facebook,this.scale,this.plugins,this.renderer},update:function(){}});return xL=i}function iW(){if(TL)return bL;TL=1;var t=Ih(),e=jH(),i=Au(),n=iY(),s=Tl(),r=qH(),a=Dh(),o=eW(),h=tW(),l=new t({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,this.systemScene,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++)this._pending.push({key:"default",scene:e[i],autoStart:0===i,data:{}})}t.events.once(n.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,i,s;for(this.systemScene=this.createSceneFromInstance("__SYSTEM",new o),this.game.events.emit(n.SYSTEM_READY,this.systemScene,this),t=0;t<this._pending.length;t++){var r;i=(e=this._pending[t]).key,(s=e.scene)instanceof o?r=this.createSceneFromInstance(i,s):"object"==typeof s?r=this.createSceneFromObject(i,s):"function"==typeof s&&(r=this.createSceneFromFunction(i,s)),i=r.sys.settings.key,this.keys[i]=r,this.scenes.push(r),this._data[i]&&(r.sys.settings.data=this._data[i].data,this._data[i].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(i)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)e=this._start[t],this.start(e);this._start.length=0}},processQueue:function(){var t=this._pending.length,e=this._queue.length;if(0!==t||0!==e){var i,n;if(t){for(i=0;i<t;i++)n=this._pending[i],this.add(n.key,n.scene,n.autoStart,n.data);for(i=0;i<this._start.length;i++)n=this._start[i],this.start(n);this._start.length=0,this._pending.length=0}for(i=0;i<this._queue.length;i++)this[(n=this._queue[i]).op](n.keyA,n.keyB,n.data);this._queue.length=0}},add:function(t,e,i,n){return void 0===i&&(i=!1),void 0===n&&(n={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:i,data:n}),this.isBooted||(this._data[t]={data:n}),null):(t=this.getKey(t,e),e instanceof o?s=this.createSceneFromInstance(t,e):"object"==typeof e?(e.key=t,s=this.createSceneFromObject(t,e)):"function"==typeof e&&(s=this.createSceneFromFunction(t,e)),s.sys.settings.data=n,t=s.sys.settings.key,this.keys[t]=s,this.scenes.push(s),(i||s.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),s);var s},remove:function(t){if(this.isProcessing)return this.queueOp("remove",t);var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var i=this.scenes.indexOf(e),n=e.sys.settings.key;return i>-1&&(delete this.keys[n],this.scenes.splice(i,1),this._start.indexOf(n)>-1&&(i=this._start.indexOf(n),this._start.splice(i,1)),e.sys.destroy()),this},bootScene:function(t){var n,s=t.sys,o=s.settings;s.sceneUpdate=a,t.init&&(t.init.call(t,o.data),o.status=e.INIT,o.isTransition&&s.events.emit(i.TRANSITION_INIT,o.transitionFrom,o.transitionDuration)),s.load&&(n=s.load).reset(),n&&t.preload?(t.preload.call(t),o.status=e.LOADING,n.once(r.COMPLETE,this.loadComplete,this),n.start()):this.create(t)},loadComplete:function(t){this.create(t.scene)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,i){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var s=this.scenes[n].sys;s.settings.status>e.START&&s.settings.status<=e.RUNNING&&s.step(t,i),s.scenePlugin&&s.scenePlugin._target&&s.scenePlugin.step(t,i)}},render:function(t){for(var i=0;i<this.scenes.length;i++){var n=this.scenes[i].sys;n.settings.visible&&n.settings.status>=e.LOADING&&n.settings.status<e.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var n=t.sys,s=n.settings;t.create&&(s.status=e.CREATING,t.create.call(t,s.data),s.status===e.DESTROYED)||(s.isTransition&&n.events.emit(i.TRANSITION_START,s.transitionFrom,s.transitionDuration),t.update&&(n.sceneUpdate=t.update),s.status=e.RUNNING,n.events.emit(i.CREATE,t))},createSceneFromFunction:function(t,e){var i=new e;if(i instanceof o){var n=i.sys.settings.key;if(""!==n&&(t=n),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return this.createSceneFromInstance(t,i)}return i.sys=new h(i),i.sys.settings.key=t,i.sys.init(this.game),i},createSceneFromInstance:function(t,e){return""===e.sys.settings.key&&(e.sys.settings.key=t),e.sys.init(this.game),e},createSceneFromObject:function(t,e){var i=new o(e),n=i.sys.settings.key;""!==n?t=n:i.sys.settings.key=t,i.sys.init(this.game);for(var r=["init","preload","create","update","render"],a=0;a<r.length;a++){var h=s(e,r[a],null);h&&(i[r[a]]=h)}if(e.hasOwnProperty("extend"))for(var l in e.extend)if(e.extend.hasOwnProperty(l)){var u=e.extend[l];"data"===l&&i.hasOwnProperty("data")&&"object"==typeof u?i.data.merge(u):"sys"!==l&&(i[l]=u)}return i},getKey:function(t,e){if(t||(t="default"),"function"==typeof e)return t;if(e instanceof o?t=e.sys.settings.key:"object"==typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var i=[],n=this.scenes,s=0;s<n.length;s++){var r=n[s];r&&(!t||t&&r.sys.isActive())&&i.push(r)}return e?i.reverse():i},getScene:function(t){if("string"==typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var i=this.getScene(t);return i&&i.sys.pause(e),this},resume:function(t,e){var i=this.getScene(t);return i&&i.sys.resume(e),this},sleep:function(t,e){var i=this.getScene(t);return i&&!i.sys.isTransitioning()&&i.sys.sleep(e),this},wake:function(t,e){var i=this.getScene(t);return i&&i.sys.wake(e),this},run:function(t,e){var i=this.getScene(t);if(!i){for(var n=0;n<this._pending.length;n++)if(this._pending[n].key===t){this.queueOp("start",t,e);break}return this}i.sys.isSleeping()?i.sys.wake(e):i.sys.isPaused()?i.sys.resume(e):this.start(t,e)},start:function(t,i){if(!this.isBooted)return this._data[t]={autoStart:!0,data:i},this;var n=this.getScene(t);if(!n)return console.warn("Scene key not found: "+t),this;var s,o=n.sys,h=o.settings.status;if(h>=e.START&&h<=e.CREATING)return this;if(h>=e.RUNNING&&h<=e.SLEEPING)o.shutdown(),o.sceneUpdate=a,o.start(i);else if(o.sceneUpdate=a,o.start(i),o.load&&(s=o.load),s&&o.settings.hasOwnProperty("pack")&&(s.reset(),s.addPack({payload:o.settings.pack})))return o.settings.status=e.LOADING,s.once(r.COMPLETE,this.payloadComplete,this),s.start(),this;return this.bootScene(n),this},stop:function(t,i){var n=this.getScene(t);if(n&&!n.sys.isTransitioning()&&n.sys.settings.status!==e.SHUTDOWN){var s=n.sys.load;s&&(s.off(r.COMPLETE,this.loadComplete,this),s.off(r.COMPLETE,this.payloadComplete,this)),n.sys.shutdown(i)}return this},switch:function(t,e,i){var n=this.getScene(t),s=this.getScene(e);return n&&s&&n!==s&&(this.sleep(t),this.isSleeping(e)?this.wake(e,i):this.start(e,i)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)return this.queueOp("bringToTop",t);var e=this.getIndex(t),i=this.scenes;if(-1!==e&&e<i.length){var n=this.getScene(t);i.splice(e,1),i.push(n)}return this},sendToBack:function(t){if(this.isProcessing)return this.queueOp("sendToBack",t);var e=this.getIndex(t);if(-1!==e&&e>0){var i=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(i)}return this},moveDown:function(t){if(this.isProcessing)return this.queueOp("moveDown",t);var e=this.getIndex(t);if(e>0){var i=e-1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveUp:function(t){if(this.isProcessing)return this.queueOp("moveUp",t);var e=this.getIndex(t);if(e<this.scenes.length-1){var i=e+1,n=this.getScene(t),s=this.getAt(i);this.scenes[e]=s,this.scenes[i]=n}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveAbove",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n<i){var s=this.getAt(n);this.scenes.splice(n,1),this.scenes.splice(i+(n>i),0,s)}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("moveBelow",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(-1!==i&&-1!==n&&n>i){var s=this.getAt(n);this.scenes.splice(n,1),0===i?this.scenes.unshift(s):this.scenes.splice(i-(n<i),0,s)}return this},queueOp:function(t,e,i,n){return this._queue.push({op:t,keyA:e,keyB:i,data:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)return this.queueOp("swapPosition",t,e);var i=this.getIndex(t),n=this.getIndex(e);if(i!==n&&-1!==i&&-1!==n){var s=this.getAt(i);this.scenes[i]=this.scenes[n],this.scenes[n]=s}return this},dump:function(){for(var t=[],i=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var s=this.scenes[n].sys,r=!s.settings.visible||s.settings.status!==e.RUNNING&&s.settings.status!==e.PAUSED?"[-] ":"[*] ";r+=s.settings.key+" ("+i[s.settings.status]+")",t.push(r)}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++)this.scenes[t].sys.destroy();this.systemScene.sys.destroy(),this.update=a,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null,this.systemScene=null}});return bL=l}function nW(){if(SL)return EL;SL=1;var t=Dl(),e=Ih(),i=lX(),n=Ho(),s=VG(),r=new e({initialize:function(t,e,r,a,o){void 0===o&&(o=!1);var h=t.manager.game;this.renderer=h.renderer,this.texture=t,this.source=e,this.image=e.compressed?null:e,this.compressionAlgorithm=e.compressed?e.format:null,this.resolution=1,this.width=r||e.naturalWidth||e.videoWidth||e.width||0,this.height=a||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=n.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=window.hasOwnProperty("HTMLVideoElement")&&e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type||"DynamicTexture"===e.type,this.isGLTexture=e instanceof s,this.isPowerOf2=i(this.width,this.height),this.glTexture=null,this.flipY=o,this.init(h)},init:function(t){var e=this.renderer;if(e){var i=this.source;if(e.gl){var n=this.image,s=this.flipY,r=this.width,a=this.height,o=this.scaleMode;this.isCanvas?this.glTexture=e.createCanvasTexture(n,!1,s):this.isVideo?this.glTexture=e.createVideoTexture(n,!1,s):this.isRenderTexture?this.glTexture=e.createTextureFromSource(null,r,a,o):this.isGLTexture?this.glTexture=i:this.compressionAlgorithm?this.glTexture=e.createTextureFromSource(i,void 0,void 0,o):i instanceof Uint8Array?this.glTexture=e.createUint8ArrayTexture(i,r,a,o):this.glTexture=e.createTextureFromSource(n,r,a,o),this.glTexture.spectorMetadata={textureKey:this.texture.key}}else this.isRenderTexture&&(this.image=i.canvas)}t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer&&this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),t===this.flipY||(this.flipY=t,this.update()),this},update:function(){var t=this.renderer,e=this.image,i=this.flipY,n=t.gl;n&&this.isCanvas?t.updateCanvasTexture(e,this.glTexture,i):n&&this.isVideo&&t.updateVideoTexture(e,this.glTexture,i)},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&t.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});return EL=r}function sW(){if(CL)return _L;CL=1;var t=Ih(),e=Uu(),i=nW(),n='Texture "%s" has no frame "%s"',s=new t({initialize:function(t,e,n,s,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var a=0;a<n.length;a++)this.source.push(new i(this,n[a],s,r))},add:function(t,i,n,s,r,a){if(this.has(t))return null;var o=new e(this,t,i,n,s,r,a);return this.frames[t]=o,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,o},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames.hasOwnProperty(t)},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn(n,this.key,t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var i=[];for(var n in this.frames)if("__BASE"!==n||e){var s=this.frames[n];s.sourceIndex===t&&i.push(s)}return i},getFrameBounds:function(t){void 0===t&&(t=0);for(var e=this.getFramesFromTextureSource(t,!0),i=e[0],n=i.cutX,s=i.cutY,r=i.cutX+i.cutWidth,a=i.cutY+i.cutHeight,o=1;o<e.length;o++){var h=e[o];h.cutX<n&&(n=h.cutX),h.cutY<s&&(s=h.cutY),h.cutX+h.cutWidth>r&&(r=h.cutX+h.cutWidth),h.cutY+h.cutHeight>a&&(a=h.cutY+h.cutHeight)}return{x:n,y:s,width:r-n,height:a-s}},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var i=e.indexOf("__BASE");-1!==i&&e.splice(i,1)}return e},getSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn(n,this.key,t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e,i=this.frames[t];return i?e=i.sourceIndex:(console.warn(n,this.key,t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new i(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t,e=this.source,i=this.dataSource;for(t=0;t<e.length;t++)e[t]&&e[t].destroy();for(t=0;t<i.length;t++)i[t]&&i[t].destroy();for(var n in this.frames){var s=this.frames[n];s&&s.destroy()}this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});return _L=s}function rW(){if(ML)return AL;ML=1;var t=Ih(),e=Yh(),i=mY(),n=Wo(),s=lX(),r=sW(),a=new t({Extends:r,initialize:function(t,e,i,n,s){r.call(this,t,e,i,n,s),this.add("__BASE",0,0,0,n,s),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d",{willReadFrequently:!0}),this.width=n,this.height=s,this.imageData=this.context.getImageData(0,0,n,s),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.buffer,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===n.WEBGL&&this.refresh(),this},draw:function(t,e,i,n){return void 0===n&&(n=!0),this.context.drawImage(i,t,e),n&&this.update(),this},drawFrame:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=!0);var r=this.manager.getFrame(t,e);if(r){var a=r.canvasData,o=r.cutWidth,h=r.cutHeight,l=r.source.resolution;this.context.drawImage(r.source.image,a.x,a.y,o,h,i,n,o/l,h/l),s&&this.update()}return this},setPixel:function(t,e,i,n,s,r){if(void 0===r&&(r=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var a=this.context.getImageData(t,e,1,1);a.data[0]=i,a.data[1]=n,a.data[2]=s,a.data[3]=r,this.context.putImageData(a,t,e)}return this},putData:function(t,e,i,n,s,r,a){return void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=t.width),void 0===a&&(a=t.height),this.context.putImageData(t,e,i,n,s,r,a),this},getData:function(t,i,n,s){return t=e(Math.floor(t),0,this.width-1),i=e(Math.floor(i),0,this.height-1),n=e(n,1,this.width-t),s=e(s,1,this.height-i),this.context.getImageData(t,i,n,s)},getPixel:function(t,e,n){n||(n=new i);var s=this.getIndex(t,e);if(s>-1){var r=this.data,a=r[s+0],o=r[s+1],h=r[s+2],l=r[s+3];n.setTo(a,o,h,l)}return n},getPixels:function(t,n,s,r){void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=s),t=Math.abs(Math.round(t)),n=Math.abs(Math.round(n));for(var a=e(t,0,this.width),o=e(t+s,0,this.width),h=e(n,0,this.height),l=e(n+r,0,this.height),u=new i,c=[],d=h;d<l;d++){for(var f=[],p=a;p<o;p++)u=this.getPixel(p,d,u),f.push({x:p,y:d,color:u.color,alpha:u.alphaGL});c.push(f)}return c},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,i,n,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=!0),this.context.clearRect(t,e,i,n),s&&this.update(),this},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=s(t,e),this.frames.__BASE.setSize(t,e,0,0),this.width=t,this.height=e,this.refresh()),this},destroy:function(){r.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});return AL=a}function aW(){if(RL)return PL;RL=1;var t=Go(),e=FY(),i=Dl(),n=Ih(),s=Wo(),r=Uu(),a=kh(),o=_X(),h=FX(),l=sW(),u=NX(),c=new n({Extends:l,initialize:function(t,n,r,a,u){void 0===r&&(r=256),void 0===a&&(a=256),void 0===u&&(u=!0),this.type="DynamicTexture";var c=t.game.renderer,d=c&&c.type===s.CANVAS,f=d?i.create2D(this,r,a):[this];l.call(this,t,n,f,r,a),this.add("__BASE",0,0,0,r,a),this.renderer=c,this.width=-1,this.height=-1,this.isDrawing=!1,this.canvas=d?f:null,this.context=d?f.getContext("2d",{willReadFrequently:!0}):null,this.dirty=!1,this.isSpriteTexture=!0,this._eraseMode=!1,this.camera=new e(0,0,r,a).setScene(t.game.scene.systemScene,!1),this.renderTarget=d?null:new h(c,r,a,1,0,!1,!1,!0,!1),this.pipeline=d?null:c.pipelines.get(o.SINGLE_PIPELINE),this.setSize(r,a,u)},setSize:function(t,e,i){void 0===e&&(e=t),void 0===i&&(i=!0),i&&((t=Math.floor(t))%2!=0&&t++,(e=Math.floor(e))%2!=0&&e++);var n=this.get(),s=n.source;if(t!==this.width||e!==this.height){this.canvas&&(this.canvas.width=t,this.canvas.height=e);var r=this.renderTarget;r&&(r.willResize(t,e)&&r.resize(t,e),r.texture!==s.glTexture&&this.renderer.deleteTexture(s.glTexture),this.setFromRenderTarget()),this.camera.setSize(t,e),s.width=t,s.height=e,n.setSize(t,e),this.width=t,this.height=e}else{var a=this.getSourceImage();n.cutX+t>a.width&&(t=a.width-n.cutX),n.cutY+e>a.height&&(e=a.height-n.cutY),n.setSize(t,e,n.cutX,n.cutY)}return this},setFromRenderTarget:function(){var t=this.get().source,e=this.renderTarget;return t.isRenderTexture=!0,t.isGLTexture=!0,t.glTexture=e.texture,this},setIsSpriteTexture:function(t){return this.isSpriteTexture=t,this},fill:function(t,e,i,n,s,r){var a=this.camera,o=this.renderer;void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===r&&(r=this.height);var h=t>>16&255,l=t>>8&255,c=255&t,d=this.renderTarget;if(a.preRender(),d){d.bind(!0);var f=this.pipeline.manager.set(this.pipeline),p=o.width/d.width,g=o.height/d.height,m=d.height-(n+r);f.drawFillRect(i*p,m*g,s*p,r*g,u.getTintFromFloats(c/255,l/255,h/255,1),e),d.unbind(!0)}else{var v=this.context;o.setContext(v),v.globalCompositeOperation="source-over",v.fillStyle="rgba("+h+","+l+","+c+","+e+")",v.fillRect(i,n,s,r),o.setContext()}return this.dirty=!0,this},clear:function(t,e,i,n){if(this.dirty){var s=this.context,r=this.renderTarget;r?r.clear(t,e,i,n):s&&(void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n?s.clearRect(t,e,i,n):(s.save(),s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,this.width,this.height),s.restore())),this.dirty=!1}return this},stamp:function(t,e,i,n,s){void 0===i&&(i=0),void 0===n&&(n=0);var r=a(s,"alpha",1),o=a(s,"tint",16777215),h=a(s,"angle",0),l=a(s,"rotation",0),u=a(s,"scale",1),c=a(s,"scaleX",u),d=a(s,"scaleY",u),f=a(s,"originX",.5),p=a(s,"originY",.5),g=a(s,"blendMode",0),m=a(s,"erase",!1),v=a(s,"skipBatch",!1),y=this.manager.resetStamp(r,o);return y.setAngle(0),0!==h?y.setAngle(h):0!==l&&y.setRotation(l),y.setScale(c,d),y.setTexture(t,e),y.setOrigin(f,p),y.setBlendMode(g),m&&(this._eraseMode=!0),v?this.batchGameObject(y,i,n):this.draw(y,i,n),m&&(this._eraseMode=!1),this},erase:function(t,e,i){return this._eraseMode=!0,this.draw(t,e,i),this._eraseMode=!1,this},draw:function(t,e,i,n,s){return this.beginDraw(),this.batchDraw(t,e,i,n,s),this.endDraw(),this},drawFrame:function(t,e,i,n,s,r){return this.beginDraw(),this.batchDrawFrame(t,e,i,n,s,r),this.endDraw(),this},repeat:function(t,e,i,n,s,a,o,h,l){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=1),void 0===h&&(h=16777215),void 0===l&&(l=!1),!(e=t instanceof r?t:this.manager.getFrame(t,e)))return this;var u=this.manager.resetStamp(o,h);u.setFrame(e),u.setOrigin(0);var c=e.width,d=e.height;s=Math.floor(s),a=Math.floor(a);var f=Math.ceil(s/c),p=Math.ceil(a/d),g=f*c-s,m=p*d-a;g>0&&(g=c-g),m>0&&(m=d-m),i<0&&(f+=Math.ceil(Math.abs(i)/c)),n<0&&(p+=Math.ceil(Math.abs(n)/d));var v=i,y=n,x=!1,w=this.manager.stampCrop.setTo(0,0,c,d);l||this.beginDraw();for(var b=0;b<p;b++)if(y+d<0)y+=d;else{for(var T=0;T<f;T++)x=!1,v+c<0||(v<0&&(x=!0,w.width=c+v,w.x=c-w.width),y<0&&(x=!0,w.height=d+y,w.y=d-w.height),g>0&&T===f-1&&(x=!0,w.width=g),m>0&&b===p-1&&(x=!0,w.height=m),x&&u.setCrop(w),this.batchGameObject(u,v,y),u.isCropped=!1,w.setTo(0,0,c,d)),v+=c;v=i,y+=d}return l||this.endDraw(),this},beginDraw:function(){if(!this.isDrawing){var t=this.camera,e=this.renderer,i=this.renderTarget;t.preRender(),i?e.beginCapture(i.width,i.height):e.setContext(this.context),this.isDrawing=!0}return this},batchDraw:function(t,e,i,n,s){return Array.isArray(t)||(t=[t]),this.batchList(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=1),void 0===r&&(r=16777215);var a=this.manager.getFrame(t,e);return a&&(this.renderTarget?this.pipeline.batchTextureFrame(a,i,n,r,s,this.camera.matrix,null):this.batchTextureFrame(a,i,n,s,r)),this},endDraw:function(t){if(void 0===t&&(t=this._eraseMode),this.isDrawing){var e=this.renderer,i=this.renderTarget;if(i){var n=e.endCapture();e.pipelines.setUtility().blitFrame(n,i,1,!1,!1,t,this.isSpriteTexture),e.resetScissor(),e.resetViewport()}else e.setContext();this.dirty=!0,this.isDrawing=!1}return this},batchList:function(t,e,i,n,s){var a=t.length;if(0!==a)for(var o=0;o<a;o++){var h=t[o];h&&h!==this&&(h.renderWebGL||h.renderCanvas?this.batchGameObject(h,e,i):h.isParent||h.list?this.batchGroup(h.getChildren(),e,i):"string"==typeof h?this.batchTextureFrameKey(h,null,e,i,n,s):h instanceof r?this.batchTextureFrame(h,e,i,n,s):Array.isArray(h)&&this.batchList(h,e,i,n,s))}},batchGroup:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var n=0;n<t.length;n++){var s=t[n];s.willRender(this.camera)&&this.batchGameObject(s,s.x+e,s.y+i)}},batchGameObject:function(e,i,n){void 0===i&&(i=e.x),void 0===n&&(n=e.y);var s=e.x,r=e.y,a=this.camera,o=this.renderer,h=this._eraseMode,l=e.mask;if(e.setPosition(i,n),this.canvas){if(h){var u=e.blendMode;e.blendMode=t.ERASE}l&&l.preRenderCanvas(o,e,a),e.renderCanvas(o,e,a,null),l&&l.postRenderCanvas(o,e,a),h&&(e.blendMode=u)}else o&&(l&&l.preRenderWebGL(o,e,a),h||o.setBlendMode(e.blendMode),e.renderWebGL(o,e,a),l&&l.postRenderWebGL(o,a,this.renderTarget));e.setPosition(s,r)},batchTextureFrameKey:function(t,e,i,n,s,r){var a=this.manager.getFrame(t,e);a&&this.batchTextureFrame(a,i,n,s,r)},batchTextureFrame:function(t,e,i,n,s){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=16777215);var r=this.camera.matrix;if(this.renderTarget)this.pipeline.batchTextureFrame(t,e,i,s,n,r,null);else{var a=this.context,o=t.canvasData,h=t.source.image;a.save(),a.globalCompositeOperation=this._eraseMode?"destination-out":"source-over",a.globalAlpha=n,r.setToContext(a),o.width>0&&o.height>0&&a.drawImage(h,o.x,o.y,o.width,o.height,e,i,o.width,o.height),a.restore()}},snapshotArea:function(t,e,i,n,s,r,a){return this.renderTarget?this.renderer.snapshotFramebuffer(this.renderTarget.framebuffer,this.width,this.height,s,!1,t,e,i,n,r,a):this.renderer.snapshotCanvas(this.canvas,s,!1,t,e,i,n,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},getWebGLTexture:function(){if(this.renderTarget)return this.renderTarget.texture},renderWebGL:function(t,e,i,n){var s=this.manager.resetStamp();s.setTexture(this),s.setOrigin(0),s.renderWebGL(t,s,i,n)},renderCanvas:function(){},destroy:function(){var t=this.manager.stamp;t&&t.texture===this&&this.manager.resetStamp(),l.prototype.destroy.call(this),i.remove(this.canvas),this.renderTarget&&this.renderTarget.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.renderer=null}});return PL=c}function oW(){return IL?DL:(IL=1,Dh(),OL||(OL=1,LL=function(t,e,i,n){i.addToRenderList(e),this.pipeline.batchSprite(e,i,n)}),kL||(kL=1,FL=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),DL={renderWebGL:LL,renderCanvas:FL})}function hW(){if(NL)return BL;NL=1;var t=Ih(),e=Zu(),i=Nz(),n=oW(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.TextureCrop,e.Tint,e.Transform,e.Visible,n],initialize:function(t,e,n,s,r){i.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(s,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)}});return BL=s}function lW(){if(VL)return WL;VL=1;var t=$H();return WL=function(e,i,n){if(n.frames||n.textures){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);for(var r,a=Array.isArray(n.textures)?n.textures[i].frames:n.frames,o=0;o<a.length;o++){var h=a[o];if(r=e.add(h.filename,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+h.filename)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Array")},WL}function uW(){if(qL)return jL;qL=1;var t=$H();return jL=function(e,i,n){if(n.frames){var s=e.source[i];e.add("__BASE",i,0,0,s.width,s.height);var r,a=n.frames;for(var o in a)if(a.hasOwnProperty(o)){var h=a[o];if(r=e.add(o,i,h.frame.x,h.frame.y,h.frame.w,h.frame.h)){h.trimmed&&r.setTrim(h.sourceSize.w,h.sourceSize.h,h.spriteSourceSize.x,h.spriteSourceSize.y,h.spriteSourceSize.w,h.spriteSourceSize.h),h.rotated&&(r.rotated=!0,r.updateUVsInverted());var l=h.anchor||h.pivot;l&&(r.customPivot=!0,r.pivotX=l.x,r.pivotY=l.y),h.scale9Borders&&r.setScale9(h.scale9Borders.x,h.scale9Borders.y,h.scale9Borders.w,h.scale9Borders.h),r.customData=t(h)}else console.warn("Invalid atlas json, frame already exists: "+o)}for(var u in n)"frames"!==u&&(Array.isArray(n[u])?e.customData[u]=n[u].slice(0):e.customData[u]=n[u]);return e}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")},jL}function cW(){return ZL||(ZL=1,KL=function(t){var e,i=[171,75,84,88,32,49,49,187,13,10,26,10],n=new Uint8Array(t,0,12);for(e=0;e<n.length;e++)if(n[e]!==i[e])return void console.warn("KTXParser - Invalid file format");var s=Uint32Array.BYTES_PER_ELEMENT,r=new DataView(t,12,13*s),a=67305985===r.getUint32(0,!0);if(0===r.getUint32(1*s,a)){var o=r.getUint32(4*s,a),h=r.getUint32(6*s,a),l=r.getUint32(7*s,a),u=Math.max(1,r.getUint32(11*s,a)),c=r.getUint32(12*s,a),d=new Array(u),f=64+c,p=h,g=l;for(e=0;e<u;e++){var m=new Int32Array(t,f,1)[0];f+=4,d[e]={data:new Uint8Array(t,f,m),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=m}return{mipmaps:d,width:h,height:l,internalFormat:o,compressed:!0,generateMipmap:!1}}console.warn("KTXParser - Only compressed formats supported")}),KL}function dW(){if(JL)return $L;function t(t,e,i,n,s,r,a){return void 0===a&&(a=16),Math.floor((t+i)/s)*Math.floor((e+n)/r)*a}function e(t,e){return(t=Math.max(t,16))*(e=Math.max(e,8))/4}function i(t,e){return(t=Math.max(t,8))*(e=Math.max(e,8))/2}function n(t,e){return Math.ceil(t/4)*Math.ceil(e/4)*16}function s(e,i){return t(e,i,3,3,4,4,8)}function r(e,i){return t(e,i,3,3,4,4)}JL=1;var a={0:{sizeFunc:e,glFormat:[35841]},1:{sizeFunc:e,glFormat:[35843]},2:{sizeFunc:i,glFormat:[35840]},3:{sizeFunc:i,glFormat:[35842]},6:{sizeFunc:s,glFormat:[36196]},7:{sizeFunc:s,glFormat:[33776,35916]},8:{sizeFunc:r,glFormat:[33777,35917]},9:{sizeFunc:r,glFormat:[33778,35918]},11:{sizeFunc:r,glFormat:[33779,35919]},14:{sizeFunc:n,glFormat:[36494,36495]},15:{sizeFunc:n,glFormat:[36492,36493]},22:{sizeFunc:s,glFormat:[37492,37493]},23:{sizeFunc:r,glFormat:[37496,37497]},24:{sizeFunc:s,glFormat:[37494,37495]},25:{sizeFunc:s,glFormat:[37488]},26:{sizeFunc:r,glFormat:[37490]},27:{sizeFunc:r,glFormat:[37808,37840]},28:{sizeFunc:function(e,i){return t(e,i,4,3,5,4)},glFormat:[37809,37841]},29:{sizeFunc:function(e,i){return t(e,i,4,4,5,5)},glFormat:[37810,37842]},30:{sizeFunc:function(e,i){return t(e,i,5,4,6,5)},glFormat:[37811,37843]},31:{sizeFunc:function(e,i){return t(e,i,5,5,6,6)},glFormat:[37812,37844]},32:{sizeFunc:function(e,i){return t(e,i,7,4,8,5)},glFormat:[37813,37845]},33:{sizeFunc:function(e,i){return t(e,i,7,5,8,6)},glFormat:[37814,37846]},34:{sizeFunc:function(e,i){return t(e,i,7,7,8,8)},glFormat:[37815,37847]},35:{sizeFunc:function(e,i){return t(e,i,9,4,10,5)},glFormat:[37816,37848]},36:{sizeFunc:function(e,i){return t(e,i,9,5,10,6)},glFormat:[37817,37849]},37:{sizeFunc:function(e,i){return t(e,i,9,7,10,8)},glFormat:[37818,37850]},38:{sizeFunc:function(e,i){return t(e,i,9,9,10,10)},glFormat:[37819,37851]},39:{sizeFunc:function(e,i){return t(e,i,11,9,12,10)},glFormat:[37820,37852]},40:{sizeFunc:function(e,i){return t(e,i,11,11,12,12)},glFormat:[37821,37853]}};return $L=function(t){for(var e=new Uint32Array(t,0,13),i=55727696===e[0]?e[2]:e[3],n=e[4],s=a[i].glFormat[n],r=a[i].sizeFunc,o=e[11],h=e[7],l=e[6],u=52+e[12],c=new Uint8Array(t,u),d=new Array(o),f=0,p=h,g=l,m=0;m<o;m++){var v=r(p,g);d[m]={data:new Uint8Array(c.buffer,c.byteOffset+f,v),width:p,height:g},p=Math.max(1,p>>1),g=Math.max(1,g>>1),f+=v}return{mipmaps:d,width:h,height:l,internalFormat:s,compressed:!0,generateMipmap:!1}},$L}function fW(){if(tO)return QL;tO=1;var t=kh();return QL=function(e,i,n,s,r,a,o){var h=t(o,"frameWidth",null),l=t(o,"frameHeight",h);if(null===h)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var u=e.source[i];e.add("__BASE",i,0,0,u.width,u.height);var c=t(o,"startFrame",0),d=t(o,"endFrame",-1),f=t(o,"margin",0),p=t(o,"spacing",0),g=Math.floor((r-f+p)/(h+p))*Math.floor((a-f+p)/(l+p));0===g&&console.warn("SpriteSheet frame dimensions will result in zero frames for texture:",e.key),(c>g||c<-g)&&(c=0),c<0&&(c=g+c),(-1===d||d>g||d<c)&&(d=g);for(var m=f,v=f,y=0,x=0,w=0,b=0;b<g;b++){y=0,x=0;var T=m+h,E=v+l;T>r&&(y=T-r),E>a&&(x=E-a),b>=c&&b<=d&&(e.add(w,i,n+m,s+v,h-y,l-x),w++),(m+=h+p)+h>r&&(m=f,v+=l+p)}return e},QL}function pW(){if(iO)return eO;iO=1;var t=kh();return eO=function(e,i,n){var s=t(n,"frameWidth",null),r=t(n,"frameHeight",s);if(!s)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var a=e.source[0];e.add("__BASE",0,0,0,a.width,a.height),t(n,"startFrame",0),t(n,"endFrame",-1);for(var o,h=t(n,"margin",0),l=t(n,"spacing",0),u=i.cutX,c=i.cutY,d=i.cutWidth,f=i.cutHeight,p=i.realWidth,g=i.realHeight,m=Math.floor((p-h+l)/(s+l)),v=Math.floor((g-h+l)/(r+l)),y=i.x,x=s-y,w=s-(p-d-y),b=i.y,T=r-b,E=r-(g-f-b),S=h,_=h,C=0,A=0;A<v;A++){for(var M=0===A,P=A===v-1,R=0;R<m;R++){var L=0===R,O=R===m-1;if(o=e.add(C,0,u+S,c+_,s,r),L||M||O||P){var F=L?y:0,k=M?b:0,D=0,I=0;L&&(D+=s-x),O&&(D+=s-w),M&&(I+=r-T),P&&(I+=r-E);var B=s-D,N=r-I;o.cutWidth=B,o.cutHeight=N,o.setTrim(s,r,F,k,B,N)}S+=l,S+=L?x:O?w:s,C++}S=h,_+=l,_+=M?T:P?E:r}return e}}function gW(){if(sO)return nO;sO=1;var t=0,e=function(e,i,n,s){var r=t-s.y-s.height;e.add(n,i,s.x,r,s.width,s.height)};return nO=function(i,n,s){var r=i.source[n];i.add("__BASE",n,0,0,r.width,r.height),t=r.height;for(var a=s.split("\n"),o=/^[ ]*(- )*(\w+)+[: ]+(.*)/,h="",l="",u={x:0,y:0,width:0,height:0},c=0;c<a.length;c++){var d=a[c].match(o);if(d){var f="- "===d[1],p=d[2],g=d[3];if(f&&(l!==h&&(e(i,n,l,u),h=l),u={x:0,y:0,width:0,height:0}),"name"!==p)switch(p){case"x":case"y":case"width":case"height":u[p]=parseInt(g,10)}else l=g}}return l!==h&&e(i,n,l,u),i},nO}function mW(){return aO?rO:(aO=1,rO={AtlasXML:UL?zL:(UL=1,zL=function(t,e,i){if(i.getElementsByTagName("TextureAtlas")){var n=t.source[e];t.add("__BASE",e,0,0,n.width,n.height);for(var s,r=i.getElementsByTagName("SubTexture"),a=0;a<r.length;a++){var o=r[a].attributes,h=o.name.value,l=parseInt(o.x.value,10),u=parseInt(o.y.value,10),c=parseInt(o.width.value,10),d=parseInt(o.height.value,10);if(s=t.add(h,e,l,u,c,d),o.frameX){var f=Math.abs(parseInt(o.frameX.value,10)),p=Math.abs(parseInt(o.frameY.value,10)),g=parseInt(o.frameWidth.value,10),m=parseInt(o.frameHeight.value,10);s.setTrim(c,d,f,p,g,m)}}return t}console.warn("Invalid Texture Atlas XML given")}),Canvas:XL?YL:(XL=1,YL=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}),Image:HL?GL:(HL=1,GL=function(t,e){var i=t.source[e];return t.add("__BASE",e,0,0,i.width,i.height),t}),JSONArray:lW(),JSONHash:uW(),KTXParser:cW(),PVRParser:dW(),SpriteSheet:fW(),SpriteSheetFromAtlas:pW(),UnityYAML:gW()})}function vW(){if(hO)return oO;hO=1;var t=Dl(),e=rW(),i=Ih(),n=mY(),s=Wo(),r=aW(),a=Iz(),o=LX(),h=Uu(),l=iY(),u=iH(),c=Tl(),d=hW(),f=Vo(),p=mW(),g=Eu(),m=sW(),v=new i({Extends:a,initialize:function(e){a.call(this),this.game=e,this.name="TextureManager",this.list={},this._tempCanvas=t.create2D(this),this._tempContext=this._tempCanvas.getContext("2d",{willReadFrequently:!0}),this._pending=0,this.stamp,this.stampCrop=new g,this.silentWarnings=!1,e.events.once(l.BOOT,this.boot,this)},boot:function(){this._pending=3,this.on(o.LOAD,this.updatePending,this),this.on(o.ERROR,this.updatePending,this);var t=this.game.config;null!==t.defaultImage&&this.addBase64("__DEFAULT",t.defaultImage),null!==t.missingImage&&this.addBase64("__MISSING",t.missingImage),null!==t.whiteImage&&this.addBase64("__WHITE",t.whiteImage),this.game.renderer&&this.game.renderer.gl&&this.addUint8Array("__NORMAL",new Uint8Array([127,127,255,255]),1,1),this.game.events.once(l.DESTROY,this.destroy,this),this.game.events.once(l.SYSTEM_READY,function(t){this.stamp=new d(t).setOrigin(0)},this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(o.LOAD),this.off(o.ERROR),this.emit(o.READY))},checkKey:function(t){return!(!t||"string"!=typeof t||this.exists(t))||(this.silentWarnings||console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"==typeof t){if(!this.exists(t))return this.silentWarnings||console.warn("No texture found matching key: "+t),this;t=this.get(t)}var e=t.key;return this.list.hasOwnProperty(e)&&(t.destroy(),this.emit(o.REMOVE,e),this.emit(o.REMOVE_KEY+e)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var i=this,n=new Image;n.onerror=function(){i.emit(o.ERROR,t)},n.onload=function(){var e=i.create(t,n);e&&(p.Image(e,0),i.emit(o.ADD,t,e),i.emit(o.ADD_KEY+t,e),i.emit(o.LOAD,t,e))},n.src=e}return this},getBase64:function(e,i,n,s){void 0===n&&(n="image/png"),void 0===s&&(s=.92);var r="",a=this.getFrame(e,i);if(a&&(a.source.isRenderTexture||a.source.isGLTexture))this.silentWarnings||console.warn("Cannot getBase64 from WebGL Texture");else if(a){var o=a.canvasData,h=t.create2D(this,o.width,o.height),l=h.getContext("2d",{willReadFrequently:!0});o.width>0&&o.height>0&&l.drawImage(a.source.image,o.x,o.y,o.width,o.height,0,0,o.width,o.height),r=h.toDataURL(n,s),t.remove(h)}return r},addImage:function(t,e,i){var n=null;return this.checkKey(t)&&(n=this.create(t,e),p.Image(n,0),i&&n.setDataSource(i),this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)),n},addGLTexture:function(t,e){var i=null;if(this.checkKey(t)){var n=e.width,s=e.height;(i=this.create(t,e,n,s)).add("__BASE",0,0,0,n,s),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)}return i},addCompressedTexture:function(t,e,i){var n=null;if(this.checkKey(t)){if((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),i){var s=function(t,e,i){Array.isArray(i.textures)||Array.isArray(i.frames)?p.JSONArray(t,e,i):p.JSONHash(t,e,i)};if(Array.isArray(i))for(var r=0;r<i.length;r++)s(n,r,i[r]);else s(n,0,i)}this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)}return n},addRenderTexture:function(t,e){var i=null;return this.checkKey(t)&&((i=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(o.ADD,t,i),this.emit(o.ADD_KEY+t,i)),i},generate:function(e,i){if(this.checkKey(e)){var n=t.create(this,1,1);return i.canvas=n,u(i),this.addCanvas(e,n)}return null},createCanvas:function(e,i,n){if(void 0===i&&(i=256),void 0===n&&(n=256),this.checkKey(e)){var r=t.create(this,i,n,s.CANVAS,!0);return this.addCanvas(e,r)}return null},addCanvas:function(t,i,n){void 0===n&&(n=!1);var s=null;return n?s=new e(this,t,i,i.width,i.height):this.checkKey(t)&&(s=new e(this,t,i,i.width,i.height),this.list[t]=s,this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addDynamicTexture:function(t,e,i){var n=null;return"string"!=typeof t||this.exists(t)?t=(n=t).key:n=new r(this,t,e,i),this.checkKey(t)?(this.list[t]=n,this.emit(o.ADD,t,n),this.emit(o.ADD_KEY+t,n)):n=null,n},addAtlas:function(t,e,i,n){return Array.isArray(i.textures)||Array.isArray(i.frames)?this.addAtlasJSONArray(t,e,i,n):this.addAtlasJSONHash(t,e,i,n)},addAtlasJSONArray:function(t,e,i,n){var s=null;if(e instanceof m?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=1===i.length,a=0;a<s.source.length;a++){var h=r?i[0]:i[a];p.JSONArray(s,a,h)}else p.JSONArray(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasJSONHash:function(t,e,i,n){var s=null;if(e instanceof m?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){if(Array.isArray(i))for(var r=0;r<i.length;r++)p.JSONHash(s,r,i[r]);else p.JSONHash(s,0,i);n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addAtlasXML:function(t,e,i,n){var s=null;return e instanceof m?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.AtlasXML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addUnityAtlas:function(t,e,i,n){var s=null;return e instanceof m?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s&&(p.UnityYAML(s,0,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)),s},addSpriteSheet:function(t,e,i,n){var s=null;if(e instanceof m?(t=e.key,s=e):this.checkKey(t)&&(s=this.create(t,e)),s){var r=s.source[0].width,a=s.source[0].height;p.SpriteSheet(s,0,0,0,r,a,i),n&&s.setDataSource(n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s)}return s},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var i=c(e,"atlas",null),n=c(e,"frame",null);if(i&&n){var s=this.get(i).get(n);if(s){var r=s.source.image;r||(r=s.source.glTexture);var a=this.create(t,r);return s.trimmed?p.SpriteSheetFromAtlas(a,s,e):p.SpriteSheet(a,0,s.cutX,s.cutY,s.cutWidth,s.cutHeight,e),this.emit(o.ADD,t,a),this.emit(o.ADD_KEY+t,a),a}}},addUint8Array:function(t,e,i,n){if(!this.checkKey(t)||e.length/4!==i*n)return null;var s=this.create(t,e,i,n);return s.add("__BASE",0,0,0,i,n),this.emit(o.ADD,t,s),this.emit(o.ADD_KEY+t,s),s},create:function(t,e,i,n){var s=null;return this.checkKey(t)&&(s=new m(this,t,e,i,n),this.list[t]=s),s},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof m?t:t instanceof h?t.texture:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},parseFrame:function(t){if(t)return"string"==typeof t?this.getFrame(t):Array.isArray(t)&&2===t.length?this.getFrame(t[0],t[1]):f(t)?this.getFrame(t.key,t.frame):t instanceof m?t.get():t instanceof h?t:void 0},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&"__WHITE"!==e&&"__NORMAL"!==e&&t.push(e);return t},getPixel:function(t,e,i,s){var r=this.getFrame(i,s);if(r){t-=r.x,e-=r.y;var a=r.data.cut;if(t+=a.x,e+=a.y,t>=a.x&&t<a.r&&e>=a.y&&e<a.b){var o=this._tempContext;o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1);var h=o.getImageData(0,0,1,1);return new n(h.data[0],h.data[1],h.data[2],h.data[3])}}return null},getPixelAlpha:function(t,e,i,n){var s=this.getFrame(i,n);if(s){t-=s.x,e-=s.y;var r=s.data.cut;if(t+=r.x,e+=r.y,t>=r.x&&t<r.r&&e>=r.y&&e<r.b){var a=this._tempContext;return a.clearRect(0,0,1,1),a.drawImage(s.source.image,t,e,1,1,0,0,1,1),a.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,i){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(i)),t},renameTexture:function(t,e){var i=this.get(t);return!(!i||t===e||(i.key=e,this.list[e]=i,delete this.list[t],0))},each:function(t,e){for(var i=[null],n=1;n<arguments.length;n++)i.push(arguments[n]);for(var s in this.list)i[0]=this.list[s],t.apply(e,i)},resetStamp:function(t,e){void 0===t&&(t=1),void 0===e&&(e=16777215);var i=this.stamp;return i.setCrop(),i.setPosition(0),i.setAngle(0),i.setScale(1),i.setAlpha(t),i.setTint(e),i.setTexture("__WHITE"),i},destroy:function(){for(var e in this.list)this.list[e].destroy();this.list={},this.stamp.destroy(),this.game=null,this.stamp=null,t.remove(this._tempCanvas)}});return oO=v}function yW(){if(uO)return lO;uO=1;var t=wH(),e=nY(),i=hY(),n=Dl(),s=Ih(),r=CX(),a=function(){if(SM)return EM;SM=1;var t=wH();return EM=function(e){var i=e.config;if(i.parent&&i.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+e.scale.width+"px;","height: "+e.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: "+i.domPointerEvents+";","transform: scale(1);","transform-origin: left top;"].join(" "),e.domContainer=n,t(n,i.parent)}}}(),o=$G(),h=Ju(),l=Xl(),u=bH(),c=Iz(),d=iY(),f=YH(),p=Cu(),g=HH(),m=VH(),v=iW(),y=LX(),x=vW(),w=QG(),b=tH(),T=new s({initialize:function(t){this.config=new r(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new c,this.anims=new e(this),this.textures=new x(this),this.cache=new i(this),this.registry=new h(this,new c),this.input=new f(this,this.config),this.scene=new v(this,this.config.sceneConfig),this.device=l,this.scale=new m(this,this.config),this.sound=null,this.loop=new w(this,this.config.fps),this.plugins=new g(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,this.isPaused=!1,u(this.boot.bind(this))},boot:function(){p.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),o(this),a(this),t(this.canvas,this.config.parent),this.textures.once(y.READY,this.texturesReady,this),this.events.emit(d.BOOT),window&&(window.PHASER_GAME=this)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(d.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.renderer?this.loop.start(this.step.bind(this)):this.loop.start(this.headlessStep.bind(this)),b(this);var t=this.events;t.on(d.HIDDEN,this.onHidden,this),t.on(d.VISIBLE,this.onVisible,this),t.on(d.BLUR,this.onBlur,this),t.on(d.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(d.PRE_STEP,t,e),i.emit(d.STEP,t,e),this.scene.update(t,e),i.emit(d.POST_STEP,t,e);var n=this.renderer;n.preRender(),i.emit(d.PRE_RENDER,n,t,e),this.scene.render(n),n.postRender(),i.emit(d.POST_RENDER,n,t,e)}},headlessStep:function(t,e){if(this.pendingDestroy)return this.runDestroy();if(!this.isPaused){var i=this.events;i.emit(d.PRE_STEP,t,e),i.emit(d.STEP,t,e),this.scene.update(t,e),i.emit(d.POST_STEP,t,e),this.scene.isProcessing=!1,i.emit(d.PRE_RENDER,null,t,e),i.emit(d.POST_RENDER,null,t,e)}},onHidden:function(){this.loop.pause(),this.events.emit(d.PAUSE)},pause:function(){var t=this.isPaused;this.isPaused=!0,t||this.events.emit(d.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(d.RESUME,this.loop.pauseDuration)},resume:function(){var t=this.isPaused;this.isPaused=!1,t&&this.events.emit(d.RESUME,0)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.scene.destroy(),this.events.emit(d.DESTROY),this.events.removeAllListeners(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(n.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});return lO=T}function xW(){if(dO)return cO;dO=1;var t=Hl(),e=Ih(),i=Dh(),n=Gl(),s=new e({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=i,this.removeCallback=i,this._sortKey=""},add:function(e,i){return i?t.Add(this.list,e):t.Add(this.list,e,0,this.addCallback,this)},addAt:function(e,i,n){return n?t.AddAt(this.list,e,i):t.AddAt(this.list,e,i,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,i){return e[t]-i[t]}),n(this.list,e),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i){return t.CountAllMatching(this.list,e,i)},swap:function(e,i){t.Swap(this.list,e,i)},moveTo:function(e,i){return t.MoveTo(this.list,e,i)},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i)},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i)},remove:function(e,i){return i?t.Remove(this.list,e):t.Remove(this.list,e,this.removeCallback,this)},removeAt:function(e,i){return i?t.RemoveAt(this.list,e):t.RemoveAt(this.list,e,this.removeCallback,this)},removeBetween:function(e,i,n){return n?t.RemoveBetween(this.list,e,i):t.RemoveBetween(this.list,e,i,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(e){return t.BringToTop(this.list,e)},sendToBack:function(e){return t.SendToBack(this.list,e)},moveUp:function(e){return t.MoveUp(this.list,e),e},moveDown:function(e){return t.MoveDown(this.list,e),e},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i){return t.Replace(this.list,e,i)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){for(var i=[null],n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});return cO=s}function wW(){if(pO)return fO;pO=1;var t=Ih(),e=xW(),i=Cu(),n=Bz(),s=Au();Gl();var r=new t({Extends:e,initialize:function(t){e.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,this.events=t.sys.events,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.events.once(s.BOOT,this.boot,this),this.events.on(s.START,this.start,this)},boot:function(){this.events.once(s.DESTROY,this.destroy,this)},addChildCallback:function(t){t.displayList&&t.displayList!==this&&t.removeFromDisplayList(),t.parentContainer&&t.parentContainer.remove(t),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(n.ADDED_TO_SCENE,t,this.scene),this.events.emit(s.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(n.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(s.REMOVED_FROM_SCENE,t,this.scene)},start:function(){this.events.once(s.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&this.list.sort(this.sortByDepth)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list,e=t.length;e--;)t[e]&&t[e].destroy(!0);t.length=0,this.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.events=null}});return i.register("DisplayList",r,"displayList"),fO=r}function bW(){return wO?xO:(wO=1,xO={PROCESS_QUEUE_ADD:mO?gO:(mO=1,gO="add"),PROCESS_QUEUE_REMOVE:yO?vO:(yO=1,vO="remove")})}function TW(){if(TO)return bO;TO=1;var t=Ih(),e=Iz(),i=bW(),n=new t({Extends:e,initialize:function(){e.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,this.checkQueue=!1},isActive:function(t){return this._active.indexOf(t)>-1},isPending:function(t){return this._toProcess>0&&this._pending.indexOf(t)>-1},isDestroying:function(t){return this._destroy.indexOf(t)>-1},add:function(t){return this.checkQueue&&this.isActive(t)&&!this.isDestroying(t)||this.isPending(t)||(this._pending.push(t),this._toProcess++),t},remove:function(t){if(this.isPending(t)){var e=this._pending,i=e.indexOf(t);-1!==i&&e.splice(i,1)}else this.isActive(t)&&(this._destroy.push(t),this._toProcess++);return t},removeAll:function(){for(var t=this._active,e=this._destroy,i=t.length;i--;)e.push(t[i]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,s=this._active;for(t=0;t<n.length;t++){e=n[t];var r=s.indexOf(e);-1!==r&&(s.splice(r,1),this.emit(i.PROCESS_QUEUE_REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)e=n[t],(!this.checkQueue||this.checkQueue&&-1===s.indexOf(e))&&(s.push(e),this.emit(i.PROCESS_QUEUE_ADD,e));return n.length=0,this._toProcess=0,s},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});return bO=n}function EW(){if(SO)return EO;SO=1;var t=Ih(),e=TW(),i=Cu(),n=Au(),s=new t({Extends:e,initialize:function(t){e.call(this),this.checkQueue=!0,this.scene=t,this.systems=t.sys,t.sys.events.once(n.BOOT,this.boot,this),t.sys.events.on(n.START,this.start,this)},boot:function(){this.systems.events.once(n.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(n.PRE_UPDATE,this.update,this),t.on(n.UPDATE,this.sceneUpdate,this),t.once(n.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var i=this._active,n=i.length,s=0;s<n;s++){var r=i[s];r.active&&r.preUpdate.call(r,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(n.PRE_UPDATE,this.update,this),e.off(n.UPDATE,this.sceneUpdate,this),e.off(n.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(n.START,this.start,this),this.scene=null,this.systems=null}});return i.register("UpdateList",s,"updateList"),EO=s}function SW(){if(CO)return _O;CO=1;var t=Hu(),e=new t,i=new t,n=new t,s={camera:e,sprite:i,calc:n};return _O=function(t,r,a){var o=e,h=i,l=n;return h.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),o.copyFrom(r.matrix),a?(o.multiplyWithOffset(a,-r.scrollX*t.scrollFactorX,-r.scrollY*t.scrollFactorY),h.e=t.x,h.f=t.y):(h.e-=r.scrollX*t.scrollFactorX,h.f-=r.scrollY*t.scrollFactorY),o.multiply(h,l),s},_O}function _W(){if(MO)return AO;MO=1;var t=SX(),e=Tl();return AO=function(i,n,s){var r=e(i,n,null);if(null===r)return s;if(Array.isArray(r))return t.RND.pick(r);if("object"==typeof r){if(r.hasOwnProperty("randInt"))return t.RND.integerInRange(r.randInt[0],r.randInt[1]);if(r.hasOwnProperty("randFloat"))return t.RND.realInRange(r.randFloat[0],r.randFloat[1])}else if("function"==typeof r)return r(n);return r}}function CW(){if(RO)return PO;RO=1;var t=Go(),e=_W();return PO=function(i,n,s){n.x=e(s,"x",0),n.y=e(s,"y",0),n.depth=e(s,"depth",0),n.flipX=e(s,"flipX",!1),n.flipY=e(s,"flipY",!1);var r=e(s,"scale",null);"number"==typeof r?n.setScale(r):null!==r&&(n.scaleX=e(r,"x",1),n.scaleY=e(r,"y",1));var a=e(s,"scrollFactor",null);"number"==typeof a?n.setScrollFactor(a):null!==a&&(n.scrollFactorX=e(a,"x",1),n.scrollFactorY=e(a,"y",1)),n.rotation=e(s,"rotation",0);var o=e(s,"angle",null);null!==o&&(n.angle=o),n.alpha=e(s,"alpha",1);var h=e(s,"origin",null);if("number"==typeof h)n.setOrigin(h);else if(null!==h){var l=e(h,"x",.5),u=e(h,"y",.5);n.setOrigin(l,u)}return n.blendMode=e(s,"blendMode",t.NORMAL),n.visible=e(s,"visible",!0),e(s,"add",!0)&&i.sys.displayList.add(n),n.preUpdate&&i.sys.updateList.add(n),n},PO}function AW(){if(OO)return LO;OO=1;var t=_W();return LO=function(e,i){var n=t(i,"anims",null);if(null===n)return e;if("string"==typeof n)e.anims.play(n);else if("object"==typeof n){var s=e.anims,r=t(n,"key",void 0);if(r){var a=t(n,"startFrame",void 0),o=t(n,"delay",0),h=t(n,"repeat",0),l=t(n,"repeatDelay",0),u=t(n,"yoyo",!1),c=t(n,"play",!1),d=t(n,"delayedPlay",0),f={key:r,delay:o,repeat:h,repeatDelay:l,yoyo:u,startFrame:a};c?s.play(f):d>0?s.playAfterDelay(f,d):s.load(f)}}return e}}function MW(){if(IO)return DO;function t(t,e){return parseInt(t.getAttribute(e),10)}return IO=1,DO=function(e,i,n,s,r){void 0===n&&(n=0),void 0===s&&(s=0);var a=i.cutX,o=i.cutY,h=i.source.width,l=i.source.height,u=i.sourceIndex,c={},d=e.getElementsByTagName("info")[0],f=e.getElementsByTagName("common")[0];c.font=d.getAttribute("face"),c.size=t(d,"size"),c.lineHeight=t(f,"lineHeight")+s,c.chars={};var p=e.getElementsByTagName("char"),g=void 0!==i&&i.trimmed;if(g)var m=i.height,v=i.width;for(var y=0;y<p.length;y++){var x=p[y],w=t(x,"id"),b=String.fromCharCode(w),T=t(x,"x"),E=t(x,"y"),S=t(x,"width"),_=t(x,"height");g&&(T<v&&(v=T),E<m&&(m=E)),g&&0!==m&&0!==v&&(T-=i.x,E-=i.y);var C=(a+T)/h,A=(o+E)/l,M=(a+T+S)/h,P=(o+E+_)/l;if(c.chars[w]={x:T,y:E,width:S,height:_,centerX:Math.floor(S/2),centerY:Math.floor(_/2),xOffset:t(x,"xoffset"),yOffset:t(x,"yoffset"),xAdvance:t(x,"xadvance")+n,data:{},kerning:{},u0:C,v0:A,u1:M,v1:P},r&&0!==S&&0!==_){var R=r.add(b,u,T,E,S,_);R&&R.setUVs(S,_,C,A,M,P)}}var L=e.getElementsByTagName("kerning");for(y=0;y<L.length;y++){var O=L[y],F=t(O,"first"),k=t(O,"second"),D=t(O,"amount");c.chars[k].kerning[F]=D}return c},DO}function PW(){if(HO)return GO;HO=1;var t=SW();return GO=function(e,i,n,s,r){var a=s.alpha*n.alpha;if(a<=0)return!1;var o=t(n,s,r).calc;return i.globalCompositeOperation=e.blendModes[n.blendMode],i.globalAlpha=a,i.save(),o.setToContext(i),i.imageSmoothingEnabled=n.frame?!n.frame.source.scaleMode:e.antialias,!0},GO}function RW(){if(qO)return jO;qO=1;var t,e,i=Dh();return t=function(){if(XO)return YO;XO=1;var t=(UO||(UO=1,zO=function(t,e,i,n,s,r,a,o,h,l,u,c,d,f,p){var g=i.x-e.displayOriginX+s,m=i.y-e.displayOriginY+r,v=g+i.w,y=m+i.h,x=a.a,w=a.b,b=a.c,T=a.d,E=a.e,S=a.f,_=g*x+m*b+E,C=g*w+m*T+S,A=g*x+y*b+E,M=g*w+y*T+S,P=v*x+y*b+E,R=v*w+y*T+S,L=v*x+m*b+E,O=v*w+m*T+S;o&&(_=Math.round(_),C=Math.round(C),A=Math.round(A),M=Math.round(M),P=Math.round(P),R=Math.round(R),L=Math.round(L),O=Math.round(O)),t.batchQuad(e,_,C,A,M,P,R,L,O,n.u0,n.v0,n.u1,n.v1,h,l,u,c,d,f,p)}),zO),e=SW(),i=NX();return YO=function(n,s,r,a){if(0!==s._text.length){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline,s),h=e(s,r,a).calc;n.pipelines.preBatch(s);var l,u,c,d=r.roundPixels,f=r.alpha,p=s.charColors,g=s.tintFill,m=i.getTintAppendFloatAlpha,v=m(s.tintTopLeft,f*s._alphaTL),y=m(s.tintTopRight,f*s._alphaTR),x=m(s.tintBottomLeft,f*s._alphaBL),w=m(s.tintBottomRight,f*s._alphaBR),b=s.frame.glTexture,T=o.setGameObject(s),E=s.getTextBounds(!1).characters,S=s.dropShadowX,_=s.dropShadowY;if(0!==S||0!==_){var C=s.dropShadowColor,A=s.dropShadowAlpha,M=m(C,f*A*s._alphaTL),P=m(C,f*A*s._alphaTR),R=m(C,f*A*s._alphaBL),L=m(C,f*A*s._alphaBR);for(l=0;l<E.length;l++)c=(u=E[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height&&t(o,s,u,c,S,_,h,d,M,P,R,L,1,b,T)}for(l=0;l<E.length;l++)if(c=(u=E[l]).glyph,32!==u.code&&0!==c.width&&0!==c.height)if(o.shouldFlush(6)&&(o.flush(),T=o.setGameObject(s)),p[u.i]){var O=p[u.i],F=O.tintEffect,k=m(O.tintTL,f*s._alphaTL),D=m(O.tintTR,f*s._alphaTR),I=m(O.tintBL,f*s._alphaBL),B=m(O.tintBR,f*s._alphaBR);t(o,s,u,c,0,0,h,d,k,D,I,B,F,b,T)}else t(o,s,u,c,0,0,h,d,v,y,x,w,g,b,T);n.pipelines.postBatch(s)}},YO}(),e=function(){if(VO)return WO;VO=1;var t=PW();return WO=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.fontData.chars,u=i.fontData.lineHeight,c=i._letterSpacing,d=i._lineSpacing,f=0,p=0,g=0,m=null,v=0,y=0,x=0,w=0,b=0,T=0,E=null,S=0,_=h.source.image,C=h.cutX,A=h.cutY,M=i._fontSize/i.fontData.size,P=i._align,R=0,L=0,O=i.getTextBounds(!1);i.maxWidth>0&&(a=(r=O.wrappedText).length);var F=i._bounds.lines;1===P?L=(F.longest-F.lengths[0])/2:2===P&&(L=F.longest-F.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);for(var k=n.roundPixels,D=0;D<a;D++)if(10!==(g=r.charCodeAt(D))){if(m=l[g]){if(v=C+m.x,y=A+m.y,x=m.width,w=m.height,b=m.xOffset+f,T=m.yOffset+p,null!==E){var I=m.kerning[S];b+=void 0!==I?I:0}b*=M,T*=M,b+=L,f+=m.xAdvance+c+(void 0!==I?I:0),E=m,S=g,0!==x&&0!==w&&32!==g&&(k&&(b=Math.round(b),T=Math.round(T)),o.save(),o.translate(b,T),o.scale(M,M),o.drawImage(_,v,y,x,w,0,0,x,w),o.restore())}}else R++,1===P?L=(F.longest-F.lengths[R])/2:2===P&&(L=F.longest-F.lengths[R]),f=0,p+=u+d,E=null;o.restore()}},WO}(),jO={renderWebGL:t,renderCanvas:e}}function LW(){if(ZO)return KO;ZO=1;var t=Ih(),e=Yh(),i=Zu(),n=Nz(),s=(kO||(kO=1,FO=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n)return{local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:"",words:[],characters:[],scaleX:0,scaleY:0};var s,r,a,o=t.text,h=o.length,l=t.maxWidth,u=t.wordWrapCharCode,c=Number.MAX_VALUE,d=Number.MAX_VALUE,f=0,p=0,g=t.fontData.chars,m=t.fontData.lineHeight,v=t.letterSpacing,y=t.lineSpacing,x=0,w=0,b=0,T=null,E=t._align,S=0,_=0,C=t.fontSize/t.fontData.size,A=C*t.scaleX,M=C*t.scaleY,P=null,R=0,L=[],O=Number.MAX_VALUE,F=0,k=0,D=0,I=[],B=[],N=null,z=function(t,e){for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n),r=e.chars[s];r&&(i+=r.xAdvance)}return i*A};if(l>0){a=o.split("\n");var U=[];for(s=0;s<a.length;s++){var Y=a[s],X="",G="",H="",W="";for(r=0;r<Y.length;r++)b=Y.charCodeAt(r),X+=Y[r],(b===u||r===Y.length-1)&&(z(W=H+X,t.fontData)<=l?H=W:(G=G.slice(0,-1),G+=(G?"\n":"")+H,H=X),X="");G=G.slice(0,-1),G+=(G?"\n":"")+H,U.push(G)}o=U.join("\n"),n.wrappedText=o,h=o.length}var V=0;for(s=0;s<h;s++)if(10!==(b=o.charCodeAt(s))){if(T=g[b]){if(S=x,_=w,null!==P){var j=T.kerning[R];S+=void 0!==j?j:0}c>S&&(c=S),d>_&&(d=_);var q=S+T.xAdvance,K=_+m;f<q&&(f=q),p<K&&(p=K);var Z=T.xOffset+T.xAdvance+(void 0!==j?j:0);b===u?null!==N&&(I.push({word:N.word,i:N.i,x:N.x*A,y:N.y*M,w:N.w*A,h:N.h*M}),N=null):(null===N&&(N={word:"",i:V,x:x,y:w,w:0,h:m}),N.word=N.word.concat(o[s]),N.w+=Z),B.push({i:V,idx:s,char:o[s],code:b,x:(T.xOffset+S)*C,y:(T.yOffset+w)*C,w:T.width*C,h:T.height*C,t:w*C,r:q*C,b:m*C,line:k,glyph:T}),x+=T.xAdvance+v+(void 0!==j?j:0),P=T,R=b,D=q*C,V++}}else null!==N&&(I.push({word:N.word,i:N.i,x:N.x*A,y:N.y*M,w:N.w*A,h:N.h*M}),N=null),P=null,L[k]=D,D>F&&(F=D),D<O&&(O=D),D=0,x=0,w=(m+y)*++k;if(null!==N&&I.push({word:N.word,i:N.i,x:N.x*A,y:N.y*M,w:N.w*A,h:N.h*M}),L[k]=D,D>F&&(F=D),D<O&&(O=D),E>0)for(var $=0;$<B.length;$++){var J=B[$];if(1===E){var Q=(F-L[J.line])/2;J.x+=Q,J.r+=Q}else if(2===E){var tt=F-L[J.line];J.x+=tt,J.r+=tt}}var et=n.local,it=n.global;return a=n.lines,et.x=c*C,et.y=d*C,et.width=f*C,et.height=p*C,it.x=t.x-t._displayOriginX+c*A,it.y=t.y-t._displayOriginY+d*M,it.width=f*A,it.height=p*M,a.shortest=O,a.longest=F,a.lengths=L,e&&(et.x=Math.ceil(et.x),et.y=Math.ceil(et.y),et.width=Math.ceil(et.width),et.height=Math.ceil(et.height),it.x=Math.ceil(it.x),it.y=Math.ceil(it.y),it.width=Math.ceil(it.width),it.height=Math.ceil(it.height),a.shortest=Math.ceil(O),a.longest=Math.ceil(F)),i&&(t._displayOriginX=t.originX*et.width,t._displayOriginY=t.originY*et.height,it.x=t.x-t._displayOriginX*t.scaleX,it.y=t.y-t._displayOriginY*t.scaleY,e&&(it.x=Math.ceil(it.x),it.y=Math.ceil(it.y))),n.words=I,n.characters=B,n.lines.height=m,n.scale=C,n.scaleX=t.scaleX,n.scaleY=t.scaleY,n}),FO),r=function(){if(NO)return BO;NO=1;var t=MW();return BO=function(e,i,n,s,r,a,o){var h=e.sys.textures.get(n),l=h.get(s),u=e.sys.cache.xml.get(r);if(l&&u){var c=t(u,l,a,o,h);return e.sys.cache.bitmapFont.add(i,{data:c,texture:n,frame:s,fromAtlas:!0}),!0}return!1},BO}(),a=MW(),o=Eu(),h=RW(),l=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Texture,i.Tint,i.Transform,i.Visible,h],initialize:function(t,e,i,r,a,o,h){void 0===a&&(a=""),void 0===h&&(h=0),n.call(this,t,"BitmapText"),this.font=r;var l=this.scene.sys.cache.bitmapFont.get(r);if(!l)throw new Error("Invalid BitmapText key: "+r);this.fontData=l.data,this._text="",this._fontSize=o||this.fontData.size,this._letterSpacing=0,this._lineSpacing=0,this._align=h,this._bounds=s(),this._dirty=!0,this._maxWidth=0,this.wordWrapCharCode=32,this.charColors=[],this.dropShadowX=0,this.dropShadowY=0,this.dropShadowColor=0,this.dropShadowAlpha=.5,this.fromAtlas=l.fromAtlas,this.setTexture(l.texture,l.frame),this.setPosition(e,i),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(),this.setText(a)},setLeftAlign:function(){return this._align=l.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=l.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=l.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setLineSpacing:function(t){return void 0===t&&(t=0),this.lineSpacing=t,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},setDropShadow:function(t,e,i,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=.5),this.dropShadowX=t,this.dropShadowY=e,this.dropShadowColor=i,this.dropShadowAlpha=n,this},setCharacterTint:function(t,i,n,s,r,a,o){void 0===t&&(t=0),void 0===i&&(i=1),void 0===n&&(n=!1),void 0===s&&(s=-1),void 0===r&&(r=s,a=s,o=s);var h=this.text.length;-1===i&&(i=h),t<0&&(t=h+t),t=e(t,0,h-1);for(var l=e(t+i,t,h),u=this.charColors,c=t;c<l;c++){var d=u[c];if(-1===s)u[c]=null;else{var f=n?1:0;d?(d.tintEffect=f,d.tintTL=s,d.tintTR=r,d.tintBL=a,d.tintBR=o):u[c]={tintEffect:f,tintTL:s,tintTR:r,tintBL:a,tintBR:o}}}return this},setWordTint:function(t,e,i,n,s,r,a){void 0===e&&(e=1);for(var o=this.getTextBounds().words,h="number"==typeof t,l=0,u=0;u<o.length;u++){var c=o[u];if((h&&u===t||!h&&c.word===t)&&(this.setCharacterTint(c.i,c.word.length,i,n,s,r,a),++l===e))return this}return this},getTextBounds:function(t){var e=this._bounds;return(this._dirty||t||this.scaleX!==e.scaleX||this.scaleY!==e.scaleY)&&(s(this,t,!0,e),this._dirty=!1),e},getCharacterAt:function(t,e,i){for(var n=this.getLocalPoint(t,e,null,i),s=this.getTextBounds().characters,r=new o,a=0;a<s.length;a++){var h=s[a];if(r.setTo(h.x,h.t,h.r-h.x,h.b),r.contains(n.x,n.y))return h}return null},updateDisplayOrigin:function(){return this._dirty=!0,this.getTextBounds(!1),this},setFont:function(t,e,i){void 0===e&&(e=this._fontSize),void 0===i&&(i=this._align);var n=this.scene.sys.cache.bitmapFont.get(t);return n&&(this.font=t,this.fontData=n.data,this._fontSize=e,this._align=i,this.fromAtlas=!0===n.fromAtlas,this.setTexture(n.texture,n.frame),s(this,!1,!0,this._bounds)),this},setMaxWidth:function(t,e){return this._maxWidth=t,this._dirty=!0,void 0!==e&&(this.wordWrapCharCode=e),this},setDisplaySize:function(t,e){this.setScale(1,1),this.getTextBounds(!1);var i=t/this.width,n=e/this.height;return this.setScale(i,n),this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},lineSpacing:{set:function(t){this._lineSpacing=t,this._dirty=!0},get:function(){return this._lineSpacing}},maxWidth:{set:function(t){this._maxWidth=t,this._dirty=!0},get:function(){return this._maxWidth}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},displayWidth:{set:function(t){this.setScaleX(1),this.getTextBounds(!1);var e=t/this.width;this.setScaleX(e)},get:function(){return this.width}},displayHeight:{set:function(t){this.setScaleY(1),this.getTextBounds(!1);var e=t/this.height;this.setScaleY(e)},get:function(){return this.height}},toJSON:function(){var t=i.ToJSON(this),e={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineSpacing:this.lineSpacing,align:this.align};return t.data=e,t},preDestroy:function(){this.charColors.length=0,this._bounds=null,this.fontData=null}});return l.ALIGN_LEFT=0,l.ALIGN_CENTER=1,l.ALIGN_RIGHT=2,l.ParseFromAtlas=r,l.ParseXMLBitmapFont=a,KO=l}function OW(){if(iF)return eF;iF=1;var t=Dh();return t=function(){if(JO)return $O;JO=1;var t=Hu(),e=NX(),i=new t;return $O=function(t,n,s,r){var a=n.getRenderList(),o=s.alpha*n.alpha;if(0!==a.length&&0!==o){s.addToRenderList(n);var h=t.pipelines.set(this.pipeline,n),l=s.scrollX*n.scrollFactorX,u=s.scrollY*n.scrollFactorY,c=i.copyFrom(s.matrix);r&&(c.multiplyWithOffset(r,-l,-u),l=0,u=0);var d=n.x-l,f=n.y-u,p=-1,g=s.roundPixels;t.pipelines.preBatch(n);for(var m=0;m<a.length;m++){var v=a[m],y=v.frame,x=v.alpha*o;if(0!==x){var w=y.width,b=y.height,T=d+v.x+y.x,E=f+v.y+y.y;v.flipX&&(w*=-1,T+=y.width),v.flipY&&(b*=-1,E+=y.height);var S=c.setQuad(T,E,T+w,E+b,g),_=e.getTintAppendFloatAlpha(v.tint,x);if(y.sourceIndex!==p){var C=h.setGameObject(n,y);p=y.sourceIndex}h.batchQuad(n,S[0],S[1],S[2],S[3],S[4],S[5],S[6],S[7],y.u0,y.v0,y.u1,y.v1,_,_,_,_,!1,y.glTexture,C)&&(p=-1)}}t.pipelines.postBatch(n)}},$O}(),tF||(tF=1,QO=function(t,e,i,n){var s=e.getRenderList();if(0!==s.length){var r=t.currentContext,a=i.alpha*e.alpha;if(0!==a){i.addToRenderList(e),r.globalCompositeOperation=t.blendModes[e.blendMode],r.imageSmoothingEnabled=!e.frame.source.scaleMode;var o=e.x-i.scrollX*e.scrollFactorX,h=e.y-i.scrollY*e.scrollFactorY;r.save(),n&&n.copyToContext(r);for(var l=i.roundPixels,u=0;u<s.length;u++){var c=s[u],d=c.flipX||c.flipY,f=c.frame,p=f.canvasData,g=f.x,m=f.y,v=1,y=1,x=c.alpha*a;0!==x&&(r.globalAlpha=x,d?(c.flipX&&(v=-1,g-=p.width),c.flipY&&(y=-1,m-=p.height),p.width>0&&p.height>0&&(r.save(),r.translate(c.x+o,c.y+h),r.scale(v,y),r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g,m,p.width,p.height),r.restore())):(l&&(g=Math.round(g),m=Math.round(m)),p.width>0&&p.height>0&&r.drawImage(f.source.image,p.x,p.y,p.width,p.height,g+c.x+o,m+c.y+h,p.width,p.height)))}r.restore()}}}),eF={renderWebGL:t,renderCanvas:QO}}function FW(){if(sF)return nF;sF=1;var t=Ih(),e=Uu(),i=new t({initialize:function(t,e,i,n,s){this.parent=t,this.x=e,this.y=i,this.frame=n,this.data={},this.tint=16777215,this._visible=s,this._alpha=1,this.flipX=!1,this.flipY=!1,this.hasTransformComponent=!0},setFrame:function(t){return void 0===t?this.frame=this.parent.frame:t instanceof e&&t.texture===this.parent.texture?this.frame=t:this.frame=this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,i){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,i&&this.setFrame(i),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!=t>0,this._alpha=t}}});return nF=i}function kW(){if(aF)return rF;aF=1;var t=OW(),e=FW(),i=Ih(),n=Zu(),s=Uu(),r=Nz(),a=xW(),o=new i({Extends:r,Mixins:[n.Alpha,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Size,n.Texture,n.Transform,n.Visible,t],initialize:function(t,e,i,n,s){r.call(this,t,"Blitter"),this.setTexture(n,s),this.setPosition(e,i),this.initPipeline(),this.initPostPipeline(),this.children=new a,this.renderList=[],this.dirty=!1},create:function(t,i,n,r,a){void 0===r&&(r=!0),void 0===a&&(a=this.children.length),void 0===n?n=this.frame:n instanceof s||(n=this.texture.get(n));var o=new e(this,t,i,n,r);return this.children.addAt(o,a,!1),this.dirty=!0,o},createFromCallback:function(t,e,i,n){for(var s=this.createMultiple(e,i,n),r=0;r<s.length;r++){var a=s[r];t.call(this,a,r)}return s},createMultiple:function(t,e,i){void 0===e&&(e=this.frame.name),void 0===i&&(i=!0),Array.isArray(e)||(e=[e]);var n=[],s=this;return e.forEach(function(e){for(var r=0;r<t;r++)n.push(s.create(0,0,e,i))}),n},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});return rF=o}function DW(){if(pF)return fF;pF=1;var t=Eu();return fF=function(e,i,n){void 0===n&&(n=new t);var s=Math.min(e.x,i.x),r=Math.min(e.y,i.y),a=Math.max(e.right,i.right)-s,o=Math.max(e.bottom,i.bottom)-r;return n.setTo(s,r,a,o)}}function IW(){if(mF)return gF;mF=1;var t=Hl(),e=Go(),i=Ih(),n=Zu(),s=Bz(),r=Nz(),a=Eu(),o=dF?cF:(dF=1,Dh(),hF||(hF=1,oF=function(t,e,i,n){i.addToRenderList(e);var s=e.list,r=s.length;if(0!==r){var a=e.localTransform;n?(a.loadIdentity(),a.multiply(n),a.translate(e.x,e.y),a.rotate(e.rotation),a.scale(e.scaleX,e.scaleY)):a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),t.pipelines.preBatch(e);var o=-1!==e.blendMode;o||t.setBlendMode(0);for(var h=e.alpha,l=e.scrollFactorX,u=e.scrollFactorY,c=0;c<r;c++){var d=s[c];if(d.willRender(i)){var f,p,g,m;if(void 0!==d.alphaTopLeft)f=d.alphaTopLeft,p=d.alphaTopRight,g=d.alphaBottomLeft,m=d.alphaBottomRight;else{var v=d.alpha;f=v,p=v,g=v,m=v}var y=d.scrollFactorX,x=d.scrollFactorY;o||d.blendMode===t.currentBlendMode||t.setBlendMode(d.blendMode);var w=d.mask;w&&w.preRenderWebGL(t,d,i);var b=d.type;b!==t.currentType&&(t.newType=!0,t.currentType=b),t.nextTypeMatch=c<r-1&&s[c+1].type===t.currentType,d.setScrollFactor(y*l,x*u),d.setAlpha(f*h,p*h,g*h,m*h),d.renderWebGL(t,d,i,a,e),d.setAlpha(f,p,g,m),d.setScrollFactor(y,x),w&&w.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),uF||(uF=1,lF=function(t,e,i,n){i.addToRenderList(e);var s=e.list;if(0!==s.length){var r=e.localTransform;n?(r.loadIdentity(),r.multiply(n),r.translate(e.x,e.y),r.rotate(e.rotation),r.scale(e.scaleX,e.scaleY)):r.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var a=-1!==e.blendMode;a||t.setBlendMode(0);var o=e._alpha,h=e.scrollFactorX,l=e.scrollFactorY;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var u=0;u<s.length;u++){var c=s[u];if(c.willRender(i)){var d=c.alpha,f=c.scrollFactorX,p=c.scrollFactorY;a||c.blendMode===t.currentBlendMode||t.setBlendMode(c.blendMode),c.setScrollFactor(f*h,p*l),c.setAlpha(d*o),c.renderCanvas(t,c,i,r),c.setAlpha(d),c.setScrollFactor(f,p)}}e.mask&&e.mask.postRenderCanvas(t)}}),cF={renderWebGL:oF,renderCanvas:lF}),h=DW(),l=wu(),u=new n.TransformMatrix,c=new i({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.ComputedSize,n.Depth,n.Mask,n.PostPipeline,n.Transform,n.Visible,o],initialize:function(t,i,s,a){r.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new n.TransformMatrix,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.initPostPipeline(),this.setPosition(i,s),this.setBlendMode(e.SKIP_CHECK),a&&this.add(a)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new a),t.setTo(this.x,this.y,0,0),this.parentContainer){var e=this.parentContainer.getBoundsTransformMatrix().transformPoint(this.x,this.y);t.setTo(e.x,e.y,0,0)}if(this.list.length>0){var i=this.list,n=new a,s=!1;t.setEmpty();for(var r=0;r<i.length;r++){var o=i[r];o.getBounds&&(o.getBounds(n),s?h(n,t,t):(t.setTo(n.x,n.y,n.width,n.height),s=!0))}}return t},addHandler:function(t){t.once(s.DESTROY,this.onChildDestroyed,this),this.exclusive&&(t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this,t.removeFromDisplayList(),t.addedToScene())},removeHandler:function(t){t.off(s.DESTROY,this.remove,this),this.exclusive&&(t.parentContainer=null,t.removedFromScene(),t.addToDisplayList())},pointToContainer:function(t,e){void 0===e&&(e=new l),this.parentContainer?this.parentContainer.pointToContainer(t,e):(e.x=t.x,e.y=t.y);var i=u;return i.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),i.invert(),i.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(u,this.localTransform)},add:function(e){return t.Add(this.list,e,this.maxSize,this.addHandler,this),this},addAt:function(e,i){return t.AddAt(this.list,e,i,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(e,i){return e?(void 0===i&&(i=function(t,i){return t[e]-i[e]}),t.StableSort(this.list,i),this):this},getByName:function(e){return t.GetFirst(this.list,"name",e)},getRandom:function(e,i){return t.GetRandom(this.list,e,i)},getFirst:function(e,i,n,s){return t.GetFirst(this.list,e,i,n,s)},getAll:function(e,i,n,s){return t.GetAll(this.list,e,i,n,s)},count:function(e,i,n,s){return t.CountAllMatching(this.list,e,i,n,s)},swap:function(e,i){return t.Swap(this.list,e,i),this},moveTo:function(e,i){return t.MoveTo(this.list,e,i),this},moveAbove:function(e,i){return t.MoveAbove(this.list,e,i),this},moveBelow:function(e,i){return t.MoveBelow(this.list,e,i),this},remove:function(e,i){var n=t.Remove(this.list,e,this.removeHandler,this);if(i&&n){Array.isArray(n)||(n=[n]);for(var s=0;s<n.length;s++)n[s].destroy()}return this},removeAt:function(e,i){var n=t.RemoveAt(this.list,e,this.removeHandler,this);return i&&n&&n.destroy(),this},removeBetween:function(e,i,n){var s=t.RemoveBetween(this.list,e,i,this.removeHandler,this);if(n)for(var r=0;r<s.length;r++)s[r].destroy();return this},removeAll:function(e){var i=this.list;if(e){for(var n=0;n<i.length;n++)i[n]&&i[n].scene&&(i[n].off(s.DESTROY,this.onChildDestroyed,this),i[n].destroy());this.list=[]}else t.RemoveBetween(i,0,i.length,this.removeHandler,this);return this},bringToTop:function(e){return t.BringToTop(this.list,e),this},sendToBack:function(e){return t.SendToBack(this.list,e),this},moveUp:function(e){return t.MoveUp(this.list,e),this},moveDown:function(e){return t.MoveDown(this.list,e),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return t.Shuffle(this.list),this},replace:function(e,i,n){return t.Replace(this.list,e,i)&&(this.addHandler(i),this.removeHandler(e),n&&e.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(e,i,n,s){return t.SetAll(this.list,e,i,n,s),this},each:function(t,e){var i,n=[null],s=this.list.slice(),r=s.length;for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<r;i++)n[0]=s[i],t.apply(e,n);return this},iterate:function(t,e){var i,n=[null];for(i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n);return this},setScrollFactor:function(e,i,n){return void 0===i&&(i=e),void 0===n&&(n=!1),this.scrollFactorX=e,this.scrollFactorY=i,n&&(t.SetAll(this.list,"scrollFactorX",e),t.SetAll(this.list,"scrollFactorY",i)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.list=[]},onChildDestroyed:function(e){t.Remove(this.list,e),this.exclusive&&(e.parentContainer=null,e.removedFromScene())}});return gF=c}function BW(){return yF?vF:(yF=1,vF=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"])}function NW(){if(wF)return xF;wF=1;var t=BW(),e=Nz(),i=Hu(),n=new i,s=new i,r=new i;return xF=function(i,a,o,h){if(a.node){var l=a.node.style,u=a.scene.sys.settings;if(!l||!u.visible||e.RENDER_MASK!==a.renderFlags||0!==a.cameraFilter&&a.cameraFilter&o.id||a.parentContainer&&!a.parentContainer.willRender())l.display="none";else{var c=a.parentContainer,d=o.alpha*a.alpha;c&&(d*=c.alpha);var f=n,p=s,g=r,m=0,v=0,y="0%",x="0%";h?(m=a.width*a.scaleX*a.originX,v=a.height*a.scaleY*a.originY,p.applyITRS(a.x-m,a.y-v,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),f.multiplyWithOffset(h,-o.scrollX*a.scrollFactorX,-o.scrollY*a.scrollFactorY),p.e=a.x-m,p.f=a.y-v,f.multiply(p,g)):(m=a.width*a.originX,v=a.height*a.originY,p.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY),f.copyFrom(o.matrix),y=100*a.originX+"%",x=100*a.originY+"%",p.e-=o.scrollX*a.scrollFactorX,p.f-=o.scrollY*a.scrollFactorY,f.multiply(p,g),g.e-=m,g.f-=v),a.transformOnly||(l.display="block",l.opacity=d,l.zIndex=a._depth,l.pointerEvents=a.pointerEvents,l.mixBlendMode=t[a._blendMode]),l.transform=g.getCSSMatrix()+" skew("+a.skewX+"rad, "+a.skewY+"rad) rotate3d("+a.rotate3d.x+","+a.rotate3d.y+","+a.rotate3d.z+","+a.rotate3d.w+a.rotate3dAngle+")",l.transformOrigin=y+" "+x}}},xF}function zW(){if(TF)return bF;TF=1;var t,e,i=Dh();return t=NW(),e=NW(),bF={renderWebGL:t,renderCanvas:e}}function UW(){if(SF)return EF;SF=1;var t=Ih(),e=Zu(),i=zW(),n=Nz(),s=Vo(),r=LH(),a=Au(),o=wX(),h=new t({Extends:n,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Origin,e.ScrollFactor,e.Transform,e.Visible,i],initialize:function(t,e,i,s,r,h){if(n.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,!this.parent)throw new Error("No DOM Container set in game config");this.cache=t.sys.cache.html,this.node,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new o,this.rotate3dAngle="deg",this.pointerEvents="auto",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,i),"string"==typeof s?"#"===s[0]?this.setElement(s.substr(1),r,h):this.createElement(s,r,h):s&&this.setElement(s,r,h),t.sys.events.on(a.SLEEP,this.handleSceneEvent,this),t.sys.events.on(a.WAKE,this.handleSceneEvent,this),t.sys.events.on(a.PRE_RENDER,this.preRender,this)},handleSceneEvent:function(t){var e=this.node,i=e.style;e&&(i.display=t.settings.visible?"block":"none")},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,i){return this.setElement(document.createElement(t),e,i)},setElement:function(t,e,i){var n;if(this.removeElement(),"string"==typeof t?("#"===t[0]&&(t=t.substr(1)),n=document.getElementById(t)):"object"==typeof t&&1===t.nodeType&&(n=t),!n)return this;if(this.node=n,e&&s(e))for(var r in e)n.style[r]=e[r];else"string"==typeof e&&(n.style=e);return n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent.appendChild(n),i&&(n.innerText=i),this.updateSize()},createFromCache:function(t,e){var i=this.cache.get(t);return i&&this.createFromHTML(i,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var i=document.createElement(e);return this.node=i,i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent.appendChild(i),i.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(r(this.node),this.node=null),this},updateSize:function(){var t=this.node;return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=this.width*this.scaleX,this.displayHeight=this.height*this.scaleY,this},getChildByProperty:function(t,e){if(this.node)for(var i=this.node.querySelectorAll("*"),n=0;n<i.length;n++)if(i[n][t]===e)return i[n];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preRender:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement(),this.scene.sys.events.off(a.SLEEP,this.handleSceneEvent,this),this.scene.sys.events.off(a.WAKE,this.handleSceneEvent,this),this.scene.sys.events.off(a.PRE_RENDER,this.preRender,this)}});return EF=h}function YW(){if(OF)return LF;OF=1;var t=LW(),e=Ih(),i=function(){if(RF)return PF;RF=1;var t,e;Dh();return t=function(){if(CF)return _F;CF=1;var t=SW(),e=Hu(),i=NX(),n=new e;return _F=function(e,s,r,a){var o=s.text,h=o.length;if(0!==h){r.addToRenderList(s);var l=e.pipelines.set(s.pipeline,s),u=t(s,r,a);e.pipelines.preBatch(s);var c=u.sprite,d=u.calc,f=n,p=s.cropWidth>0||s.cropHeight>0;p&&(l.flush(),e.pushScissor(d.tx,d.ty,s.cropWidth*d.scaleX,s.cropHeight*d.scaleY));var g,m,v=s.frame.glTexture,y=s.tintFill,x=i.getTintAppendFloatAlpha(s.tintTopLeft,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(s.tintTopRight,r.alpha*s._alphaTR),b=i.getTintAppendFloatAlpha(s.tintBottomLeft,r.alpha*s._alphaBL),T=i.getTintAppendFloatAlpha(s.tintBottomRight,r.alpha*s._alphaBR),E=l.setGameObject(s),S=0,_=0,C=0,A=0,M=s.letterSpacing,P=0,R=0,L=s.scrollX,O=s.scrollY,F=s.fontData,k=F.chars,D=F.lineHeight,I=s.fontSize/F.size,B=0,N=s._align,z=0,U=0,Y=s.getTextBounds(!1);s.maxWidth>0&&(h=(o=Y.wrappedText).length);var X=s._bounds.lines;1===N?U=(X.longest-X.lengths[0])/2:2===N&&(U=X.longest-X.lengths[0]);for(var G=r.roundPixels,H=s.displayCallback,W=s.callbackData,V=0;V<h;V++)if(10!==(C=o.charCodeAt(V))){if(g=k[C]){P=g.width,R=g.height;var j=g.xOffset+S-L,q=g.yOffset+_-O;if(null!==m){var K=g.kerning[A]||0;j+=K,S+=K}if(S+=g.xAdvance+M,m=g,A=C,0!==P&&0!==R&&32!==C){if(I=s.fontSize/s.fontData.size,B=0,H){W.color=0,W.tint.topLeft=x,W.tint.topRight=w,W.tint.bottomLeft=b,W.tint.bottomRight=T,W.index=V,W.charCode=C,W.x=j,W.y=q,W.scale=I,W.rotation=B,W.data=g.data;var Z=H(W);j=Z.x,q=Z.y,I=Z.scale,B=Z.rotation,Z.color?(x=Z.color,w=Z.color,b=Z.color,T=Z.color):(x=Z.tint.topLeft,w=Z.tint.topRight,b=Z.tint.bottomLeft,T=Z.tint.bottomRight),x=i.getTintAppendFloatAlpha(x,r.alpha*s._alphaTL),w=i.getTintAppendFloatAlpha(w,r.alpha*s._alphaTR),b=i.getTintAppendFloatAlpha(b,r.alpha*s._alphaBL),T=i.getTintAppendFloatAlpha(T,r.alpha*s._alphaBR)}j*=I,q*=I,j-=s.displayOriginX,q-=s.displayOriginY,j+=U,f.applyITRS(j,q,B,I,I),d.multiply(f,c);var $=g.u0,J=g.v0,Q=g.u1,tt=g.v1,et=P,it=R,nt=c.e,st=c.f,rt=it*c.c+c.e,at=it*c.d+c.f,ot=et*c.a+it*c.c+c.e,ht=et*c.b+it*c.d+c.f,lt=et*c.a+c.e,ut=et*c.b+c.f;G&&(nt=Math.round(nt),st=Math.round(st),rt=Math.round(rt),at=Math.round(at),ot=Math.round(ot),ht=Math.round(ht),lt=Math.round(lt),ut=Math.round(ut)),l.shouldFlush(6)&&(l.flush(),E=l.setGameObject(s)),l.batchQuad(s,nt,st,rt,at,ot,ht,lt,ut,$,J,Q,tt,x,w,b,T,y,v,E)}}}else z++,1===N?U=(X.longest-X.lengths[z])/2:2===N&&(U=X.longest-X.lengths[z]),S=0,_+=D,m=null;p&&(l.flush(),e.popScissor()),e.pipelines.postBatch(s)}},_F}(),e=function(){if(MF)return AF;MF=1;var t=PW();return AF=function(e,i,n,s){var r=i._text,a=r.length,o=e.currentContext;if(0!==a&&t(e,o,i,n,s)){n.addToRenderList(i);var h=i.fromAtlas?i.frame:i.texture.frames.__BASE,l=i.displayCallback,u=i.callbackData,c=i.fontData.chars,d=i.fontData.lineHeight,f=i._letterSpacing,p=0,g=0,m=0,v=null,y=0,x=0,w=0,b=0,T=0,E=0,S=null,_=0,C=i.frame.source.image,A=h.cutX,M=h.cutY,P=0,R=0,L=i._fontSize/i.fontData.size,O=i._align,F=0,k=0;i.getTextBounds(!1);var D=i._bounds.lines;1===O?k=(D.longest-D.lengths[0])/2:2===O&&(k=D.longest-D.lengths[0]),o.translate(-i.displayOriginX,-i.displayOriginY);var I=n.roundPixels;i.cropWidth>0&&i.cropHeight>0&&(o.beginPath(),o.rect(0,0,i.cropWidth,i.cropHeight),o.clip());for(var B=0;B<a;B++)if(R=L,P=0,10!==(m=r.charCodeAt(B))){if(v=c[m]){if(y=A+v.x,x=M+v.y,w=v.width,b=v.height,T=v.xOffset+p-i.scrollX,E=v.yOffset+g-i.scrollY,null!==S){var N=v.kerning[_];T+=void 0!==N?N:0}if(l){u.index=B,u.charCode=m,u.x=T,u.y=E,u.scale=R,u.rotation=P,u.data=v.data;var z=l(u);T=z.x,E=z.y,R=z.scale,P=z.rotation}T*=R,E*=R,T+=k,p+=v.xAdvance+f+(void 0!==N?N:0),S=v,_=m,0!==w&&0!==b&&32!==m&&(I&&(T=Math.round(T),E=Math.round(E)),o.save(),o.translate(T,E),o.rotate(P),o.scale(R,R),o.drawImage(C,y,x,w,b,0,0,w,b),o.restore())}}else F++,1===O?k=(D.longest-D.lengths[F])/2:2===O&&(k=D.longest-D.lengths[F]),p=0,g+=d,S=null;o.restore()}},AF}(),PF={renderWebGL:t,renderCanvas:e}}(),n=new e({Extends:t,Mixins:[i],initialize:function(e,i,n,s,r,a,o){t.call(this,e,i,n,s,r,a,o),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.displayCallback,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});return LF=n}function XW(){if(IF)return DF;IF=1;var t=Dh();return t=function(){if(kF)return FF;kF=1;var t=SW();return FF=function(e,i,n,s){e.pipelines.clear();var r=t(i,n,s).calc;i.render.call(i,e,n,r),e.pipelines.rebind()},FF}(),DF={renderWebGL:t}}function GW(){if(NF)return BF;NF=1;var t=Ih(),e=Zu(),i=Nz(),n=XW(),s=new t({Extends:i,Mixins:[e.Alpha,e.BlendMode,e.Depth,e.Flip,e.Origin,e.ScrollFactor,e.Size,e.Texture,e.Tint,e.Transform,e.Visible,n],initialize:function(t){i.call(this,t,"Extern")},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(){},render:function(){}});return BF=s}function HW(){return UF?zF:(UF=1,zF={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22})}function WW(){return XF||(XF=1,YF=function(t,e,i){if(t.width<=0||t.height<=0)return!1;var n=(e-t.x)/t.width,s=(i-t.y)/t.height;return(n*=n)+(s*=s)<.25}),YF}function VW(){if(HF)return GF;HF=1;var t=zh();return GF=function(e,i,n){void 0===n&&(n=new t);var s=e.width/2,r=e.height/2;return n.x=e.x+s*Math.cos(i),n.y=e.y+r*Math.sin(i),n},GF}function jW(){if(VF)return WF;VF=1;var t=VW(),e=Xh(),i=Gh(),n=zh();return WF=function(s,r,a){void 0===a&&(a=new n);var o=e(r,0,i.PI2);return t(s,o,a)},WF}function qW(){return qF||(qF=1,jF=function(t){var e=t.width/2,i=t.height/2,n=Math.pow(e-i,2)/Math.pow(e+i,2);return Math.PI*(e+i)*(1+3*n/(10+Math.sqrt(4-3*n)))}),jF}function KW(){if(ZF)return KF;ZF=1;var t=qW(),e=VW(),i=Xh(),n=Gh();return KF=function(s,r,a,o){void 0===o&&(o=[]),!r&&a>0&&(r=t(s)/a);for(var h=0;h<r;h++){var l=i(h/r,0,n.PI2);o.push(e(s,l))}return o},KF}function ZW(){if(JF)return $F;JF=1;var t=Ih(),e=WW(),i=jW(),n=KW(),s=Nh(),r=gU(),a=new t({initialize:function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.type=s.ELLIPSE,this.x=t,this.y=e,this.width=i,this.height=n},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return r(this,t)},setTo:function(t,e,i,n){return this.x=t,this.y=e,this.width=i,this.height=n,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});return $F=a}function $W(){if(ik)return ek;ik=1;var t=HW(),e=PW();return ek=function(i,n,s,r,a,o){var h=n.commandBuffer,l=h.length,u=a||i.currentContext;if(0!==l&&e(i,u,n,s,r)){s.addToRenderList(n);var c=1,d=1,f=0,p=0,g=1,m=0,v=0,y=0;u.beginPath();for(var x=0;x<l;++x)switch(h[x]){case t.ARC:u.arc(h[x+1],h[x+2],h[x+3],h[x+4],h[x+5],h[x+6]),x+=7;break;case t.LINE_STYLE:g=h[x+1],f=h[x+2],c=h[x+3],m=(16711680&f)>>>16,v=(65280&f)>>>8,y=255&f,u.strokeStyle="rgba("+m+","+v+","+y+","+c+")",u.lineWidth=g,x+=3;break;case t.FILL_STYLE:p=h[x+1],d=h[x+2],m=(16711680&p)>>>16,v=(65280&p)>>>8,y=255&p,u.fillStyle="rgba("+m+","+v+","+y+","+d+")",x+=2;break;case t.BEGIN_PATH:u.beginPath();break;case t.CLOSE_PATH:u.closePath();break;case t.FILL_PATH:o||u.fill();break;case t.STROKE_PATH:o||u.stroke();break;case t.FILL_RECT:o?u.rect(h[x+1],h[x+2],h[x+3],h[x+4]):u.fillRect(h[x+1],h[x+2],h[x+3],h[x+4]),x+=4;break;case t.FILL_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.fill(),x+=6;break;case t.STROKE_TRIANGLE:u.beginPath(),u.moveTo(h[x+1],h[x+2]),u.lineTo(h[x+3],h[x+4]),u.lineTo(h[x+5],h[x+6]),u.closePath(),o||u.stroke(),x+=6;break;case t.LINE_TO:u.lineTo(h[x+1],h[x+2]),x+=2;break;case t.MOVE_TO:u.moveTo(h[x+1],h[x+2]),x+=2;break;case t.LINE_FX_TO:u.lineTo(h[x+1],h[x+2]),x+=5;break;case t.MOVE_FX_TO:u.moveTo(h[x+1],h[x+2]),x+=5;break;case t.SAVE:u.save();break;case t.RESTORE:u.restore();break;case t.TRANSLATE:u.translate(h[x+1],h[x+2]),x+=2;break;case t.SCALE:u.scale(h[x+1],h[x+2]),x+=2;break;case t.ROTATE:u.rotate(h[x+1]),x+=1;break;case t.GRADIENT_FILL_STYLE:x+=5;break;case t.GRADIENT_LINE_STYLE:x+=6}u.restore()}},ek}function JW(){if(ak)return rk;ak=1;var t=EY(),e=Ih(),i=HW(),n=Zu(),s=ZW(),r=Nz(),a=kh(),o=Tl(),h=Gh(),l=function(){if(sk)return nk;sk=1;var t,e;Dh();return t=function(){if(tk)return QF;tk=1;var t=HW(),e=SW(),i=Hu(),n=NX(),s=function(t,e,i){this.x=t,this.y=e,this.width=i},r=function(t,e,i){this.points=[],this.pointsLength=1,this.points[0]=new s(t,e,i)},a=[],o=new i;return QF=function(i,h,l,u){if(0!==h.commandBuffer.length){l.addToRenderList(h);var c=i.pipelines.set(h.pipeline,h);i.pipelines.preBatch(h);for(var d=e(h,l,u).calc,f=o.loadIdentity(),p=h.commandBuffer,g=l.alpha*h.alpha,m=1,v=c.fillTint,y=c.strokeTint,x=0,w=0,b=0,T=2*Math.PI,E=[],S=0,_=!0,C=null,A=n.getTintAppendFloatAlpha,M=0;M<p.length;M++)switch(p[M]){case t.BEGIN_PATH:E.length=0,C=null,_=!0;break;case t.CLOSE_PATH:_=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case t.FILL_PATH:for(S=0;S<E.length;S++)c.batchFillPath(E[S].points,f,d);break;case t.STROKE_PATH:for(S=0;S<E.length;S++)c.batchStrokePath(E[S].points,m,_,f,d);break;case t.LINE_STYLE:m=p[++M];var P=A(p[++M],p[++M]*g);y.TL=P,y.TR=P,y.BL=P,y.BR=P;break;case t.FILL_STYLE:var R=A(p[++M],p[++M]*g);v.TL=R,v.TR=R,v.BL=R,v.BR=R;break;case t.GRADIENT_FILL_STYLE:var L=p[++M]*g,O=p[++M]*g,F=p[++M]*g,k=p[++M]*g;v.TL=A(p[++M],L),v.TR=A(p[++M],O),v.BL=A(p[++M],F),v.BR=A(p[++M],k);break;case t.GRADIENT_LINE_STYLE:m=p[++M];var D=p[++M]*g;y.TL=A(p[++M],D),y.TR=A(p[++M],D),y.BL=A(p[++M],D),y.BR=A(p[++M],D);break;case t.ARC:var I=0,B=p[++M],N=p[++M],z=p[++M],U=p[++M],Y=p[++M],X=p[++M],G=p[++M];for(Y-=U,X?Y<-T?Y=-T:Y>0&&(Y=Y%T-T):Y>T?Y=T:Y<0&&(Y=T+Y%T),null===C&&(C=new r(B+Math.cos(U)*z,N+Math.sin(U)*z,m),E.push(C),I+=.01);I<1+G;)b=Y*I+U,x=B+Math.cos(b)*z,w=N+Math.sin(b)*z,C.points.push(new s(x,w,m)),I+=.01;b=Y+U,x=B+Math.cos(b)*z,w=N+Math.sin(b)*z,C.points.push(new s(x,w,m));break;case t.FILL_RECT:c.batchFillRect(p[++M],p[++M],p[++M],p[++M],f,d);break;case t.FILL_TRIANGLE:c.batchFillTriangle(p[++M],p[++M],p[++M],p[++M],p[++M],p[++M],f,d);break;case t.STROKE_TRIANGLE:c.batchStrokeTriangle(p[++M],p[++M],p[++M],p[++M],p[++M],p[++M],m,f,d);break;case t.LINE_TO:null!==C?C.points.push(new s(p[++M],p[++M],m)):(C=new r(p[++M],p[++M],m),E.push(C));break;case t.MOVE_TO:C=new r(p[++M],p[++M],m),E.push(C);break;case t.SAVE:a.push(f.copyToArray());break;case t.RESTORE:f.copyFromArray(a.pop());break;case t.TRANSLATE:B=p[++M],N=p[++M],f.translate(B,N);break;case t.SCALE:B=p[++M],N=p[++M],f.scale(B,N);break;case t.ROTATE:f.rotate(p[++M])}i.pipelines.postBatch(h)}},QF}(),$W(),e=$W(),nk={renderWebGL:t,renderCanvas:e}}(),u=new e({Extends:r,Mixins:[n.AlphaSingle,n.BlendMode,n.Depth,n.Mask,n.Pipeline,n.PostPipeline,n.Transform,n.Visible,n.ScrollFactor,l],initialize:function(t,e){var i=o(e,"x",0),n=o(e,"y",0);r.call(this,t,"Graphics"),this.setPosition(i,n),this.initPipeline(),this.initPostPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this.lineStyle(1,0,0),this.fillStyle(0,0),this.setDefaultStyles(e)},setDefaultStyles:function(t){return o(t,"lineStyle",null)&&(this.defaultStrokeWidth=o(t,"lineStyle.width",1),this.defaultStrokeColor=o(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=o(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),o(t,"fillStyle",null)&&(this.defaultFillColor=o(t,"fillStyle.color",16777215),this.defaultFillAlpha=o(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(i.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(i.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,s,r,a,o,h){return void 0===r&&(r=1),void 0===a&&(a=r),void 0===o&&(o=r),void 0===h&&(h=r),this.commandBuffer.push(i.GRADIENT_FILL_STYLE,r,a,o,h,t,e,n,s),this},lineGradientStyle:function(t,e,n,s,r,a){return void 0===a&&(a=1),this.commandBuffer.push(i.GRADIENT_LINE_STYLE,t,a,e,n,s,r),this},beginPath:function(){return this.commandBuffer.push(i.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(i.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(i.FILL_PATH),this},fill:function(){return this.commandBuffer.push(i.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(i.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(i.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.fillPath(),this},strokeCircle:function(t,e,i){return this.beginPath(),this.arc(t,e,i,0,h.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,s){return this.commandBuffer.push(i.FILL_RECT,t,e,n,s),this},strokeRect:function(t,e,i,n){var s=this._lineWidth/2,r=t-s,a=t+s;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+n),this.strokePath(),this.beginPath(),this.moveTo(t+i,e),this.lineTo(t+i,e+n),this.strokePath(),this.beginPath(),this.moveTo(r,e),this.lineTo(a+i,e),this.strokePath(),this.beginPath(),this.moveTo(r,e+n),this.lineTo(a+i,e+n),this.strokePath(),this},fillRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var c=r>=0,d=o>=0,f=l>=0,p=u>=0;return r=Math.abs(r),o=Math.abs(o),l=Math.abs(l),u=Math.abs(u),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),d?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),p?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),f?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),c?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.fillPath(),this},strokeRoundedRect:function(t,e,i,n,s){void 0===s&&(s=20);var r=s,o=s,l=s,u=s,c=Math.min(i,n)/2;"number"!=typeof s&&(r=a(s,"tl",20),o=a(s,"tr",20),l=a(s,"bl",20),u=a(s,"br",20));var d=r>=0,f=o>=0,p=l>=0,g=u>=0;return r=Math.min(Math.abs(r),c),o=Math.min(Math.abs(o),c),l=Math.min(Math.abs(l),c),u=Math.min(Math.abs(u),c),this.beginPath(),this.moveTo(t+r,e),this.lineTo(t+i-o,e),this.moveTo(t+i-o,e),f?this.arc(t+i-o,e+o,o,-h.TAU,0):this.arc(t+i,e,o,Math.PI,h.TAU,!0),this.lineTo(t+i,e+n-u),this.moveTo(t+i,e+n-u),g?this.arc(t+i-u,e+n-u,u,0,h.TAU):this.arc(t+i,e+n,u,-h.TAU,Math.PI,!0),this.lineTo(t+l,e+n),this.moveTo(t+l,e+n),p?this.arc(t+l,e+n-l,l,h.TAU,Math.PI):this.arc(t,e+n,l,0,-h.TAU,!0),this.lineTo(t,e+r),this.moveTo(t,e+r),d?this.arc(t+r,e+r,r,-Math.PI,-h.TAU):this.arc(t,e,r,h.TAU,0,!0),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(i.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.FILL_TRIANGLE,t,e,n,s,r,a),this},strokeTriangle:function(t,e,n,s,r,a){return this.commandBuffer.push(i.STROKE_TRIANGLE,t,e,n,s,r,a),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,i,n){return this.beginPath(),this.moveTo(t,e),this.lineTo(i,n),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(i.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(i.MOVE_TO,t,e),this},strokePoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var s=1;s<n;s++)this.lineTo(t[s].x,t[s].y);return e&&this.lineTo(t[0].x,t[0].y),i&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.strokePoints(i,!0)},strokeEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.strokePoints(a,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var i=t.getPoints(e);return this.fillPoints(i,!0)},fillEllipse:function(t,e,i,n,r){void 0===r&&(r=32);var a=new s(t,e,i,n).getPoints(r);return this.fillPoints(a,!0)},arc:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this},slice:function(t,e,n,s,r,a,o){return void 0===a&&(a=!1),void 0===o&&(o=0),this.commandBuffer.push(i.BEGIN_PATH),this.commandBuffer.push(i.MOVE_TO,t,e),this.commandBuffer.push(i.ARC,t,e,n,s,r,a,o),this.commandBuffer.push(i.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(i.SAVE),this},restore:function(){return this.commandBuffer.push(i.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(i.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(i.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(i.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,i){var n,s,r=this.scene.sys,a=r.game.renderer;void 0===e&&(e=r.scale.width),void 0===i&&(i=r.scale.height),u.TargetCamera.setScene(this.scene),u.TargetCamera.setViewport(0,0,e,i),u.TargetCamera.scrollX=this.x,u.TargetCamera.scrollY=this.y;var o={willReadFrequently:!0};if("string"==typeof t)if(r.textures.exists(t)){var h=(n=r.textures.get(t)).getSourceImage();h instanceof HTMLCanvasElement&&(s=h.getContext("2d",o))}else s=(n=r.textures.createCanvas(t,e,i)).getSourceImage().getContext("2d",o);else t instanceof HTMLCanvasElement&&(s=t.getContext("2d",o));return s&&(this.renderCanvas(a,this,u.TargetCamera,null,s,!1),n&&n.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});return u.TargetCamera=new t,rk=u}function QW(){return hk?ok:(hk=1,ok=function(t,e){return t.hasOwnProperty(e)})}function tV(){if(uk)return lk;uk=1;var t=new(Ih())({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var i=0;i<this.entries.length;i++){var n=this.entries[i];if(n[t]===e)return n}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++){var e=this.entries[t];console.log(e)}console.groupEnd()},each:function(t,e){var i,n=this.entries.slice(),s=n.length;if(e)for(i=0;i<s&&!1!==t.call(e,n[i],i);i++);else for(i=0;i<s&&!1!==t(n[i],i);i++);return this},iterate:function(t,e){var i,n=this.entries.length;if(e)for(i=0;i<n&&!1!==t.call(e,this.entries[i],i);i++);else for(i=0;i<n&&!1!==t(this.entries[i],i);i++);return this},iterateLocal:function(t){var e,i=[];for(e=1;e<arguments.length;e++)i.push(arguments[e]);var n=this.entries.length;for(e=0;e<n;e++){var s=this.entries[e];s[t].apply(s,i)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(e){var i=new t;return e.entries.forEach(function(t){i.set(t)}),this.entries.forEach(function(t){i.set(t)}),i},intersect:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)&&i.set(t)}),i},difference:function(e){var i=new t;return this.entries.forEach(function(t){e.contains(t)||i.set(t)}),i},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});return lk=t}function eV(){return mk?gk:(mk=1,Dh(),dk||(dk=1,ck=function(t,e,i,n){i.addToRenderList(e),e.pipeline.batchSprite(e,i,n)}),pk||(pk=1,fk=function(t,e,i,n){i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),gk={renderWebGL:ck,renderCanvas:fk})}function iV(){if(yk)return vk;yk=1;var t=rY(),e=Ih(),i=Zu(),n=Nz(),s=eV(),r=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Size,i.TextureCrop,i.Tint,i.Transform,i.Visible,s],initialize:function(e,i,s,r,a){n.call(this,e,"Sprite"),this._crop=this.resetCropObject(),this.anims=new t(this),this.setTexture(r,a),this.setPosition(i,s),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},chain:function(t){return this.anims.chain(t)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},toJSON:function(){return i.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});return vk=r}function nV(){if(wk)return xk;wk=1;var t=$U(),e=Ih(),i=Bz(),n=Iz(),s=gl(),r=kh(),a=Tl(),o=QW(),h=Vo(),l=Sl(),u=tV(),c=iV(),d=new e({Extends:n,initialize:function(t,e,s){n.call(this),s?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?h(e[0])&&(s=e,e=null):h(e)&&(s=e,e=null),this.scene=t,this.children=new u,this.isParent=!0,this.type="Group",this.classType=r(s,"classType",c),this.name=r(s,"name",""),this.active=r(s,"active",!0),this.maxSize=r(s,"maxSize",-1),this.defaultKey=r(s,"defaultKey",null),this.defaultFrame=r(s,"defaultFrame",null),this.runChildUpdate=r(s,"runChildUpdate",!1),this.createCallback=r(s,"createCallback",null),this.removeCallback=r(s,"removeCallback",null),this.createMultipleCallback=r(s,"createMultipleCallback",null),this.internalCreateCallback=r(s,"internalCreateCallback",null),this.internalRemoveCallback=r(s,"internalRemoveCallback",null),e&&this.addMultiple(e),s&&this.createMultiple(s),this.on(i.ADDED_TO_SCENE,this.addedToScene,this),this.on(i.REMOVED_FROM_SCENE,this.removedFromScene,this)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},create:function(t,e,i,n,s,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.defaultKey),void 0===n&&(n=this.defaultFrame),void 0===s&&(s=!0),void 0===r&&(r=!0),this.isFull())return null;var a=new this.classType(this.scene,t,e,i,n);return a.addToDisplayList(this.scene.sys.displayList),a.addToUpdateList(),a.visible=s,a.setActive(r),this.add(a),a},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var i=0;i<t.length;i++){var n=this.createFromConfig(t[i]);e=e.concat(n)}return e},createFromConfig:function(e){if(this.isFull())return[];this.classType=r(e,"classType",this.classType);var i=r(e,"key",void 0),n=r(e,"frame",null),s=r(e,"visible",!0),h=r(e,"active",!0),u=[];if(void 0===i)return u;Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n]);var c=r(e,"repeat",0),d=r(e,"randomKey",!1),f=r(e,"randomFrame",!1),p=r(e,"yoyo",!1),g=r(e,"quantity",!1),m=r(e,"frameQuantity",1),v=r(e,"max",0),y=l(i,n,{max:v,qty:g||m,random:d,randomB:f,repeat:c,yoyo:p});e.createCallback&&(this.createCallback=e.createCallback),e.removeCallback&&(this.removeCallback=e.removeCallback),e.internalCreateCallback&&(this.internalCreateCallback=e.internalCreateCallback),e.internalRemoveCallback&&(this.internalRemoveCallback=e.internalRemoveCallback);for(var x=0;x<y.length;x++){var w=this.create(0,0,y[x].a,y[x].b,s,h);if(!w)break;u.push(w)}if(o(e,"setXY")){var b=a(e,"setXY.x",0),T=a(e,"setXY.y",0),E=a(e,"setXY.stepX",0),S=a(e,"setXY.stepY",0);t.SetXY(u,b,T,E,S)}if(o(e,"setRotation")){var _=a(e,"setRotation.value",0),C=a(e,"setRotation.step",0);t.SetRotation(u,_,C)}if(o(e,"setScale")){var A=a(e,"setScale.x",1),M=a(e,"setScale.y",A),P=a(e,"setScale.stepX",0),R=a(e,"setScale.stepY",0);t.SetScale(u,A,M,P,R)}if(o(e,"setOrigin")){var L=a(e,"setOrigin.x",.5),O=a(e,"setOrigin.y",L),F=a(e,"setOrigin.stepX",0),k=a(e,"setOrigin.stepY",0);t.SetOrigin(u,L,O,F,k)}if(o(e,"setAlpha")){var D=a(e,"setAlpha.value",1),I=a(e,"setAlpha.step",0);t.SetAlpha(u,D,I)}if(o(e,"setDepth")){var B=a(e,"setDepth.value",0),N=a(e,"setDepth.step",0);t.SetDepth(u,B,N)}if(o(e,"setScrollFactor")){var z=a(e,"setScrollFactor.x",1),U=a(e,"setScrollFactor.y",z),Y=a(e,"setScrollFactor.stepX",0),X=a(e,"setScrollFactor.stepY",0);t.SetScrollFactor(u,z,U,Y,X)}var G=r(e,"hitArea",null),H=r(e,"hitAreaCallback",null);G&&t.SetHitArea(u,G,H);var W=r(e,"gridAlign",!1);return W&&t.GridAlign(u,W),this.createMultipleCallback&&this.createMultipleCallback.call(this,u),u},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var i=this.children.entries.slice(),n=0;n<i.length;n++){var s=i[n];s.active&&s.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.internalCreateCallback&&this.internalCreateCallback.call(this,t),this.createCallback&&this.createCallback.call(this,t),e&&(t.addToDisplayList(this.scene.sys.displayList),t.addToUpdateList()),t.on(i.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var i=0;i<t.length;i++)this.add(t[i],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.internalRemoveCallback&&this.internalRemoveCallback.call(this,t),this.removeCallback&&this.removeCallback.call(this,t),t.off(i.DESTROY,this.remove,this),n?t.destroy():e&&(t.removeFromDisplayList(),t.removeFromUpdateList()),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,s=0;s<n.size;s++){var r=n.entries[s];r.off(i.DESTROY,this.remove,this),e?r.destroy():t&&(r.removeFromDisplayList(),r.removeFromUpdateList())}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getMatching:function(t,e,i,n){return s(this.children.entries,t,e,i,n)},getFirst:function(t,e,i,n,s,r,a){return this.getHandler(!0,1,t,e,i,n,s,r,a)},getFirstNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!0,t,e,i,n,s,r,a,o)},getLast:function(t,e,i,n,s,r,a){return this.getHandler(!1,1,t,e,i,n,s,r,a)},getLastNth:function(t,e,i,n,s,r,a,o){return this.getHandler(!1,t,e,i,n,s,r,a,o)},getHandler:function(t,e,i,n,s,r,a,o,h){var l,u;void 0===i&&(i=!1),void 0===n&&(n=!1);var c=0,d=this.children.entries;if(t)for(u=0;u<d.length;u++)if((l=d[u]).active===i){if(++c===e)break}else l=null;else for(u=d.length-1;u>=0;u--)if((l=d[u]).active===i){if(++c===e)break}else l=null;return l?("number"==typeof s&&(l.x=s),"number"==typeof r&&(l.y=r),l):n?this.create(s,r,a,o,h):null},get:function(t,e,i,n,s){return this.getFirst(!1,!0,t,e,i,n,s)},getFirstAlive:function(t,e,i,n,s,r){return this.getFirst(!0,t,e,i,n,s,r)},getFirstDead:function(t,e,i,n,s,r){return this.getFirst(!1,t,e,i,n,s,r)},playAnimation:function(e,i){return t.PlayAnimation(this.children.entries,e,i),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,i=0;i<this.children.size;i++)this.children.entries[i].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},propertyValueSet:function(e,i,n,s,r){return t.PropertyValueSet(this.children.entries,e,i,n,s,r),this},propertyValueInc:function(e,i,n,s,r){return t.PropertyValueInc(this.children.entries,e,i,n,s,r),this},setX:function(e,i){return t.SetX(this.children.entries,e,i),this},setY:function(e,i){return t.SetY(this.children.entries,e,i),this},setXY:function(e,i,n,s){return t.SetXY(this.children.entries,e,i,n,s),this},incX:function(e,i){return t.IncX(this.children.entries,e,i),this},incY:function(e,i){return t.IncY(this.children.entries,e,i),this},incXY:function(e,i,n,s){return t.IncXY(this.children.entries,e,i,n,s),this},shiftPosition:function(e,i,n){return t.ShiftPosition(this.children.entries,e,i,n),this},angle:function(e,i){return t.Angle(this.children.entries,e,i),this},rotate:function(e,i){return t.Rotate(this.children.entries,e,i),this},rotateAround:function(e,i){return t.RotateAround(this.children.entries,e,i),this},rotateAroundDistance:function(e,i,n){return t.RotateAroundDistance(this.children.entries,e,i,n),this},setAlpha:function(e,i){return t.SetAlpha(this.children.entries,e,i),this},setTint:function(e,i,n,s){return t.SetTint(this.children.entries,e,i,n,s),this},setOrigin:function(e,i,n,s){return t.SetOrigin(this.children.entries,e,i,n,s),this},scaleX:function(e,i){return t.ScaleX(this.children.entries,e,i),this},scaleY:function(e,i){return t.ScaleY(this.children.entries,e,i),this},scaleXY:function(e,i,n,s){return t.ScaleXY(this.children.entries,e,i,n,s),this},setDepth:function(e,i){return t.SetDepth(this.children.entries,e,i),this},setBlendMode:function(e){return t.SetBlendMode(this.children.entries,e),this},setHitArea:function(e,i){return t.SetHitArea(this.children.entries,e,i),this},shuffle:function(){return t.Shuffle(this.children.entries),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},setVisible:function(e,i,n){return t.SetVisible(this.children.entries,e,i,n),this},toggleVisible:function(){return t.ToggleVisible(this.children.entries),this},destroy:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this.scene&&!this.ignoreDestroy&&(this.emit(i.DESTROY,this),this.removeAllListeners(),this.scene.sys.updateList.remove(this),this.clear(e,t),this.scene=void 0,this.children=void 0)}});return xk=d}function sV(){if(Mk)return Ak;Mk=1;var t=Go(),e=Ih(),i=Zu(),n=Gu(),s=Ju(),r=Iz(),a=Bz(),o=xW(),h=Ck?_k:(Ck=1,Dh(),Tk||(Tk=1,bk=function(t,e,i){var n=e.list,s=n.length;if(0!==s){e.depthSort(),t.pipelines.preBatch(e);var r=-1!==e.blendMode;r||t.setBlendMode(0);for(var a=e.alpha,o=0;o<s;o++){var h=n[o];if(h.willRender(i)){var l,u,c,d;if(void 0!==h.alphaTopLeft)l=h.alphaTopLeft,u=h.alphaTopRight,c=h.alphaBottomLeft,d=h.alphaBottomRight;else{var f=h.alpha;l=f,u=f,c=f,d=f}r||h.blendMode===t.currentBlendMode||t.setBlendMode(h.blendMode);var p=h.mask;p&&p.preRenderWebGL(t,h,i);var g=h.type;g!==t.currentType&&(t.newType=!0,t.currentType=g),t.nextTypeMatch=o<s-1&&n[o+1].type===t.currentType,h.setAlpha(l*a,u*a,c*a,d*a),h.renderWebGL(t,h,i),h.setAlpha(l,u,c,d),p&&p.postRenderWebGL(t,i),t.newType=!1}}t.pipelines.postBatch(e)}}),Sk||(Sk=1,Ek=function(t,e,i){var n=e.list;if(0!==n.length){e.depthSort();var s=-1!==e.blendMode;s||t.setBlendMode(0);var r=e._alpha;e.mask&&e.mask.preRenderCanvas(t,null,i);for(var a=0;a<n.length;a++){var o=n[a];if(o.willRender(i)){var h=o.alpha;s||o.blendMode===t.currentBlendMode||t.setBlendMode(o.blendMode),o.setAlpha(h*r),o.renderCanvas(t,o,i),o.setAlpha(h)}}e.mask&&e.mask.postRenderCanvas(t)}}),_k={renderWebGL:bk,renderCanvas:Ek}),l=Au(),u=Gl(),c=new e({Extends:o,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Mask,i.PostPipeline,i.Visible,r,h],initialize:function(e,i){o.call(this,e),r.call(this),this.scene=e,this.displayList=null,this.type="Layer",this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,this.systems=e.sys,this.events=e.sys.events,this.sortChildrenFlag=!1,this.addCallback=this.addChildCallback,this.removeCallback=this.removeChildCallback,this.initPostPipeline(),this.clearAlpha(),this.setBlendMode(t.SKIP_CHECK),i&&this.add(i),e.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},incData:function(t,e){return this.data||(this.data=new s(this)),this.data.inc(t,e),this},toggleData:function(t){return this.data||(this.data=new s(this)),this.data.toggle(t),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(){return this},disableInteractive:function(){return this},removeInteractive:function(){return this},addedToScene:function(){},removedFromScene:function(){},update:function(){},toJSON:function(){return n(this)},willRender:function(t){return!(15!==this.renderFlags||0===this.list.length||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,i=[];e&&(i.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return i.unshift(this.displayList.getIndex(t)),i},addChildCallback:function(t){var e=t.displayList;e&&e!==this&&t.removeFromDisplayList(),t.displayList||(this.queueDepthSort(),t.displayList=this,t.emit(a.ADDED_TO_SCENE,t,this.scene),this.events.emit(l.ADDED_TO_SCENE,t,this.scene))},removeChildCallback:function(t){this.queueDepthSort(),t.displayList=null,t.emit(a.REMOVED_FROM_SCENE,t,this.scene),this.events.emit(l.REMOVED_FROM_SCENE,t,this.scene)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(u(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},addToDisplayList:function(t){return void 0===t&&(t=this.scene.sys.displayList),this.displayList&&this.displayList!==t&&this.removeFromDisplayList(),t.exists(this)||(this.displayList=t,t.add(this,!0),t.queueDepthSort(),this.emit(a.ADDED_TO_SCENE,this,this.scene),t.events.emit(l.ADDED_TO_SCENE,this,this.scene)),this},removeFromDisplayList:function(){var t=this.displayList||this.scene.sys.displayList;return t.exists(this)&&(t.remove(this,!0),t.queueDepthSort(),this.displayList=null,this.emit(a.REMOVED_FROM_SCENE,this,this.scene),t.events.emit(l.REMOVED_FROM_SCENE,this,this.scene)),this},getDisplayList:function(){var t=null;return this.parentContainer?t=this.parentContainer.list:this.displayList&&(t=this.displayList.list),t},destroy:function(t){if(this.scene&&!this.ignoreDestroy){this.emit(a.DESTROY,this);for(var e=this.list;e.length;)e[0].destroy(t);this.removeAllListeners(),this.resetPostPipeline(!0),this.displayList&&(this.displayList.remove(this,!0,!1),this.displayList.queueDepthSort()),this.data&&(this.data.destroy(),this.data=void 0),this.active=!1,this.visible=!1,this.list=void 0,this.scene=void 0,this.displayList=void 0,this.systems=void 0,this.events=void 0}}});return Ak=c}function rV(){if(Rk)return Pk;Rk=1;var t=tX(),e=iX(),i={bezier:t,catmull:e,catmullrom:e,linear:sX()};return Pk=function(t){if(null===t)return null;var e=i.linear;return"string"==typeof t?i.hasOwnProperty(t)&&(e=i[t]):"function"==typeof t&&(e=t),e},Pk}function aV(){if(Ok)return Lk;Ok=1;var t=sY(),e=Yh(),i=Ih(),n=HY(),s=aU(),r=kh(),a=rV(),o=dX(),h=Vu(),l=new i({initialize:function(t,e,i){void 0===i&&(i=!1),this.propertyKey=t,this.propertyValue=e,this.defaultValue=e,this.steps=0,this.counter=0,this.yoyo=!1,this.direction=0,this.start=0,this.current=0,this.end=0,this.ease=null,this.interpolation=null,this.emitOnly=i,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.active=!0,this.method=0,this._onEmit,this._onUpdate},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=r(t,this.propertyKey,this.defaultValue),this.method=this.getMethod(),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return JSON.stringify(this.propertyValue)},onChange:function(t){var i;switch(this.method){case 1:case 3:case 8:i=t;break;case 2:this.propertyValue.indexOf(t)>=0&&(i=t);break;case 4:var n=(this.end-this.start)/this.steps;i=o(t,n),this.counter=i;break;case 5:case 6:case 7:i=e(t,this.start,this.end);break;case 9:i=this.start[0]}return this.current=i,this},getMethod:function(){var t=this.propertyValue;if(null===t)return 0;var e=typeof t;if("number"===e)return 1;if(Array.isArray(t))return 2;if("function"===e)return 3;if("object"===e){if(this.hasBoth(t,"start","end"))return this.has(t,"steps")?4:5;if(this.hasBoth(t,"min","max"))return 6;if(this.has(t,"random"))return 7;if(this.hasEither(t,"onEmit","onUpdate"))return 8;if(this.hasEither(t,"values","interpolation"))return 9}return 0},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,n=this.defaultUpdate;switch(this.method){case 1:i=this.staticValueEmit;break;case 2:i=this.randomStaticValueEmit,e=t[0];break;case 3:this._onEmit=t,i=this.proxyEmit,e=this.defaultValue;break;case 4:this.start=t.start,this.end=t.end,this.steps=t.steps,this.counter=this.start,this.yoyo=!!this.has(t,"yoyo")&&t.yoyo,this.direction=0,i=this.steppedEmit,e=this.start;break;case 5:this.start=t.start,this.end=t.end;var r=this.has(t,"ease")?t.ease:"Linear";this.ease=s(r,t.easeParams),i=this.has(t,"random")&&t.random?this.randomRangedValueEmit:this.easedValueEmit,n=this.easeValueUpdate,e=this.start;break;case 6:this.start=t.min,this.end=t.max,i=this.has(t,"int")&&t.int?this.randomRangedIntEmit:this.randomRangedValueEmit,e=this.start;break;case 7:var o=t.random;Array.isArray(o)&&(this.start=o[0],this.end=o[1]),i=this.randomRangedIntEmit,e=this.start;break;case 8:this._onEmit=this.has(t,"onEmit")?t.onEmit:this.defaultEmit,this._onUpdate=this.has(t,"onUpdate")?t.onUpdate:this.defaultUpdate,i=this.proxyEmit,n=this.proxyUpdate,e=this.defaultValue;break;case 9:this.start=t.values;var h=this.has(t,"ease")?t.ease:"Linear";this.ease=s(h,t.easeParams),this.interpolation=a(t.interpolation),i=this.easedValueEmit,n=this.easeValueUpdate,e=this.start[0]}return this.onEmit=i,this.onUpdate=n,this.current=e,this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,i){return t.hasOwnProperty(e)&&t.hasOwnProperty(i)},hasEither:function(t,e,i){return t.hasOwnProperty(e)||t.hasOwnProperty(i)},defaultEmit:function(){return this.defaultValue},defaultUpdate:function(t,e,i,n){return n},proxyEmit:function(t,e,i){var n=this._onEmit(t,e,i);return this.current=n,n},proxyUpdate:function(t,e,i,n){var s=this._onUpdate(t,e,i,n);return this.current=s,s},staticValueEmit:function(){return this.current},staticValueUpdate:function(){return this.current},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.current=this.propertyValue[t],this.current},randomRangedValueEmit:function(t,e){var i=n(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=i,t.data[e].max=this.end),this.current=i,i},randomRangedIntEmit:function(e,i){var n=t(this.start,this.end);return e&&e.data[i]&&(e.data[i].min=n,e.data[i].max=this.end),this.current=n,n},steppedEmit:function(){var t,e=this.counter,i=e,n=(this.end-this.start)/this.steps;return this.yoyo?(0===this.direction?(i+=n)>=this.end&&(t=i-this.end,i=this.end-t,this.direction=1):(i-=n)<=this.start&&(t=this.start-i,i=this.start+t,this.direction=0),this.counter=i):this.counter=h(i+n,this.start,this.end),this.current=e,e},easedValueEmit:function(t,e){if(t&&t.data[e]){var i=t.data[e];i.min=this.start,i.max=this.end}return this.current=this.start,this.start},easeValueUpdate:function(t,e,i){var n,s=t.data[e],r=this.ease(i);return n=this.interpolation?this.interpolation(this.start,r):(s.max-s.min)*r+s.min,this.current=n,n},destroy:function(){this.propertyValue=null,this.defaultValue=null,this.ease=null,this.interpolation=null,this._onEmit=null,this._onUpdate=null}});return Lk=l}function oV(){if(kk)return Fk;kk=1;var t=Ih(),e=aV(),i=dY(),n=aU(),s=rV(),r=yY(),a=new t({Extends:e,initialize:function(t){e.call(this,t,null,!1),this.active=!1,this.easeName="Linear",this.r=[],this.g=[],this.b=[]},getMethod:function(){return null===this.propertyValue?0:9},setMethods:function(){var t=this.propertyValue,e=t,i=this.defaultEmit,a=this.defaultUpdate;if(9===this.method){this.start=t[0],this.ease=n("Linear"),this.interpolation=s("linear"),i=this.easedValueEmit,a=this.easeValueUpdate,e=t[0],this.active=!0,this.r.length=0,this.g.length=0,this.b.length=0;for(var o=0;o<t.length;o++){var h=r(t[o]);this.r.push(h.r),this.g.push(h.g),this.b.push(h.b)}}return this.onEmit=i,this.onUpdate=a,this.current=e,this},setEase:function(t){this.easeName=t,this.ease=n(t)},easedValueEmit:function(){return this.current=this.start,this.start},easeValueUpdate:function(t,e,n){var s=this.ease(n),r=this.interpolation(this.r,s),a=this.interpolation(this.g,s),o=this.interpolation(this.b,s),h=i(r,a,o);return this.current=h,h}});return Fk=a}function hV(){return Vk?Wk:(Vk=1,Wk={COMPLETE:Ik?Dk:(Ik=1,Dk="complete"),DEATH_ZONE:Nk?Bk:(Nk=1,Bk="deathzone"),EXPLODE:Uk?zk:(Uk=1,zk="explode"),START:Xk?Yk:(Xk=1,Yk="start"),STOP:Hk?Gk:(Hk=1,Gk="stop")})}function lV(){if(qk)return jk;qk=1;var t=new(Ih())({initialize:function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=!0),this.emitter,this.x=t,this.y=e,this.active=i},update:function(){},destroy:function(){this.emitter=null}});return jk=t}function uV(){if(Zk)return Kk;Zk=1;var t=Ih(),e=kh(),i=lV(),n=new t({Extends:i,initialize:function(t,n,s,r,a){if("object"==typeof t){var o=t;t=e(o,"x",0),n=e(o,"y",0),s=e(o,"power",0),r=e(o,"epsilon",100),a=e(o,"gravity",50)}else void 0===t&&(t=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=100),void 0===a&&(a=50);i.call(this,t,n,!0),this._gravity=a,this._power=s*a,this._epsilon=r*r},update:function(t,e){var i=this.x-t.x,n=this.y-t.y,s=i*i+n*n;if(0!==s){var r=Math.sqrt(s);s<this._epsilon&&(s=this._epsilon);var a=this._power*e/(s*r)*100;t.velocityX+=i*a,t.velocityY+=n*a}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});return Kk=n}function cV(){if(Jk)return $k;Jk=1;var t=rY(),e=Yh(),i=Ih(),n=Ou(),s=Eu(),r=Su(),a=wu(),o=new i({initialize:function(e){this.emitter=e,this.texture=null,this.frame=null,this.x=0,this.y=0,this.worldPosition=new a,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.holdCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1},x:{min:0,max:0},y:{min:0,max:0},accelerationX:{min:0,max:0},accelerationY:{min:0,max:0},maxVelocityX:{min:0,max:0},maxVelocityY:{min:0,max:0},moveToX:{min:0,max:0},moveToY:{min:0,max:0},bounce:{min:0,max:0}},this.isCropped=!1,this.scene=e.scene,this.anims=null,this.emitter.anims.length>0&&(this.anims=new t(this)),this.bounds=new s},emit:function(t,e,i,n,s,r){return this.emitter.emit(t,e,i,n,s,r)},isAlive:function(){return this.lifeCurrent>0},kill:function(){this.lifeCurrent=0},setPosition:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},fire:function(t,e){var i=this.emitter,s=i.ops,r=i.getAnim();if(r?this.anims.play(r):(this.frame=i.getFrame(),this.texture=this.frame.texture),!this.frame)throw new Error("Particle has no texture frame");if(i.getEmitZone(this),void 0===t?this.x+=s.x.onEmit(this,"x"):s.x.steps>0?this.x+=t+s.x.onEmit(this,"x"):this.x+=t,void 0===e?this.y+=s.y.onEmit(this,"y"):s.y.steps>0?this.y+=e+s.y.onEmit(this,"y"):this.y+=e,this.life=s.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0,this.delayCurrent=s.delay.onEmit(this,"delay"),this.holdCurrent=s.hold.onEmit(this,"hold"),this.scaleX=s.scaleX.onEmit(this,"scaleX"),this.scaleY=s.scaleY.active?s.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=s.rotate.onEmit(this,"rotate"),this.rotation=n(this.angle),i.worldMatrix.transformPoint(this.x,this.y,this.worldPosition),0===this.delayCurrent&&i.getDeathZone(this))return this.lifeCurrent=0,!1;var a=s.speedX.onEmit(this,"speedX"),o=s.speedY.active?s.speedY.onEmit(this,"speedY"):a;if(i.radial){var h=n(s.angle.onEmit(this,"angle"));this.velocityX=Math.cos(h)*Math.abs(a),this.velocityY=Math.sin(h)*Math.abs(o)}else if(i.moveTo){var l=s.moveToX.onEmit(this,"moveToX"),u=s.moveToY.onEmit(this,"moveToY"),c=this.life/1e3;this.velocityX=(l-this.x)/c,this.velocityY=(u-this.y)/c}else this.velocityX=a,this.velocityY=o;return i.acceleration&&(this.accelerationX=s.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=s.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=s.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=s.maxVelocityY.onEmit(this,"maxVelocityY"),this.bounce=s.bounce.onEmit(this,"bounce"),this.alpha=s.alpha.onEmit(this,"alpha"),s.color.active?this.tint=s.color.onEmit(this,"tint"):this.tint=s.tint.onEmit(this,"tint"),!0},update:function(t,i,s){if(this.lifeCurrent<=0)return!(this.holdCurrent>0)||(this.holdCurrent-=t,this.holdCurrent<=0);if(this.delayCurrent>0)return this.delayCurrent-=t,!1;this.anims&&this.anims.update(0,t);var r=this.emitter,a=r.ops,o=1-this.lifeCurrent/this.life;if(this.lifeT=o,this.x=a.x.onUpdate(this,"x",o,this.x),this.y=a.y.onUpdate(this,"y",o,this.y),r.moveTo){var h=a.moveToX.onUpdate(this,"moveToX",o,r.moveToX),l=a.moveToY.onUpdate(this,"moveToY",o,r.moveToY),u=this.lifeCurrent/1e3;this.velocityX=(h-this.x)/u,this.velocityY=(l-this.y)/u}return this.computeVelocity(r,t,i,s,o),this.scaleX=a.scaleX.onUpdate(this,"scaleX",o,this.scaleX),a.scaleY.active?this.scaleY=a.scaleY.onUpdate(this,"scaleY",o,this.scaleY):this.scaleY=this.scaleX,this.angle=a.rotate.onUpdate(this,"rotate",o,this.angle),this.rotation=n(this.angle),r.getDeathZone(this)?(this.lifeCurrent=0,!0):(this.alpha=e(a.alpha.onUpdate(this,"alpha",o,this.alpha),0,1),a.color.active?this.tint=a.color.onUpdate(this,"color",o,this.tint):this.tint=a.tint.onUpdate(this,"tint",o,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0&&this.holdCurrent<=0)},computeVelocity:function(t,i,n,s,r){var a=t.ops,o=this.velocityX,h=this.velocityY,l=a.accelerationX.onUpdate(this,"accelerationX",r,this.accelerationX),u=a.accelerationY.onUpdate(this,"accelerationY",r,this.accelerationY),c=a.maxVelocityX.onUpdate(this,"maxVelocityX",r,this.maxVelocityX),d=a.maxVelocityY.onUpdate(this,"maxVelocityY",r,this.maxVelocityY);this.bounce=a.bounce.onUpdate(this,"bounce",r,this.bounce),o+=t.gravityX*n+l*n,h+=t.gravityY*n+u*n,o=e(o,-c,c),h=e(h,-d,d),this.velocityX=o,this.velocityY=h,this.x+=o*n,this.y+=h*n,t.worldMatrix.transformPoint(this.x,this.y,this.worldPosition);for(var f=0;f<s.length;f++){var p=s[f];p.active&&p.update(this,i,n,r)}},setSizeToFrame:function(){},getBounds:function(t){void 0===t&&(t=this.emitter.getWorldTransformMatrix());var e=Math.abs(t.scaleX)*this.scaleX,i=Math.abs(t.scaleY)*this.scaleY,n=this.x,s=this.y,o=this.rotation,h=this.frame.width*e/2,l=this.frame.height*i/2,u=this.bounds,c=new a(n-h,s-l),d=new a(n+h,s-l),f=new a(n-h,s+l),p=new a(n+h,s+l);return 0!==o&&(r(c,n,s,o),r(d,n,s,o),r(f,n,s,o),r(p,n,s,o)),t.transformPoint(c.x,c.y,c),t.transformPoint(d.x,d.y,d),t.transformPoint(f.x,f.y,f),t.transformPoint(p.x,p.y,p),u.x=Math.min(c.x,d.x,f.x,p.x),u.y=Math.min(c.y,d.y,f.y,p.y),u.width=Math.max(c.x,d.x,f.x,p.x)-u.x,u.height=Math.max(c.y,d.y,f.y,p.y)-u.y,u},destroy:function(){this.anims&&this.anims.destroy(),this.anims=null,this.emitter=null,this.texture=null,this.frame=null,this.scene=null}});return $k=o}function dV(){if(tD)return Qk;tD=1;var t=Ih(),e=lV(),i=Eu(),n=new t({Extends:e,initialize:function(t,n,s,r,a,o,h,l){void 0===a&&(a=!0),void 0===o&&(o=!0),void 0===h&&(h=!0),void 0===l&&(l=!0),e.call(this,t,n,!0),this.bounds=new i(t,n,s,r),this.collideLeft=a,this.collideRight=o,this.collideTop=h,this.collideBottom=l},update:function(t){var e=this.bounds,i=-t.bounce,n=t.worldPosition;n.x<e.x&&this.collideLeft?(t.x+=e.x-n.x,t.velocityX*=i):n.x>e.right&&this.collideRight&&(t.x-=n.x-e.right,t.velocityX*=i),n.y<e.y&&this.collideTop?(t.y+=e.y-n.y,t.velocityY*=i):n.y>e.bottom&&this.collideBottom&&(t.y-=n.y-e.bottom,t.velocityY*=i)}});return Qk=n}function fV(){return iD?eD:(iD=1,eD=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)})}function pV(){if(sD)return nD;sD=1;var t=new(Ih())({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=t.worldPosition,i=this.source.contains(e.x,e.y);return i&&this.killOnEnter||!i&&!this.killOnEnter}});return nD=t}function gV(){if(aD)return rD;aD=1;var t=new(Ih())({initialize:function(t,e,i,n,s,r){void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===r&&(r=-1),this.source=t,this.points=[],this.quantity=e,this.stepRate=i,this.yoyo=n,this.counter=-1,this.seamless=s,this._length=0,this._direction=0,this.total=r,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var i=this._length;return this._length=this.points.length,this._length<i&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});return rD=t}function mV(){return hD?oD:(hD=1,oD=function(t,e){for(var i=0;i<e.length;i++)if(!t.hasOwnProperty(e[i]))return!1;return!0})}function vV(){return uD?lD:(uD=1,lD=function(t,e){for(var i=0;i<e.length;i++)if(t.hasOwnProperty(e[i]))return!0;return!1})}function yV(){if(dD)return cD;dD=1;var t=SY();return cD=function(e,i,n){var s=e.centerX,r=e.centerY;return e.setSize(e.width+2*i,e.height+2*n),t(e,s,r)}}function xV(){return pD||(pD=1,fD=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.right,e.right);t.x=i,t.width=n-i;var s=Math.min(t.y,e.y),r=Math.max(t.bottom,e.bottom);return t.y=s,t.height=r-s,t}),fD}function wV(){if(mD)return gD;mD=1;var t=$H();return gD=function(e,i){var n=t(e);for(var s in i)n.hasOwnProperty(s)&&(n[s]=i[s]);return n}}function bV(){if(yD)return vD;yD=1;var t=Ih(),e=wu(),i=new t({initialize:function(t){this.source=t,this._tempVec=new e,this.total=-1},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});return vD=i}function TV(){return wD?xD:(wD=1,xD=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0||t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)})}function EV(){if(MD)return AD;MD=1;var t=Ih(),e=Zu(),i=Gu(),n=fV(),s=pV(),r=gV(),a=oV(),o=aV(),h=hV(),l=Nz(),u=kh(),c=vl(),d=uV(),f=mV(),p=vV(),g=QW(),m=yV(),v=xW(),y=xV(),x=wV(),w=cV(),b=dV(),T=bV(),E=Eu(),S=TV(),_=Cl(),C=function(){if(CD)return _D;CD=1;var t,e;Dh();return t=function(){if(TD)return bD;TD=1;var t=TV(),e=Hu(),i=NX(),n=new e,s=new e,r=new e,a=new e;return bD=function(e,o,h,l){var u=e.pipelines.set(o.pipeline),c=n,d=s,f=r,p=a;l?(p.loadIdentity(),p.multiply(l),p.translate(o.x,o.y),p.rotate(o.rotation),p.scale(o.scaleX,o.scaleY)):p.applyITRS(o.x,o.y,o.rotation,o.scaleX,o.scaleY);var g=i.getTintAppendFloatAlpha,m=h.alpha,v=o.alpha;e.pipelines.preBatch(o);var y=o.alive,x=y.length,w=o.viewBounds;if(0!==x&&(!w||t(w,h.worldView))){o.sortCallback&&o.depthSort(),h.addToRenderList(o),c.copyFrom(h.matrix),c.multiplyWithOffset(p,-h.scrollX*o.scrollFactorX,-h.scrollY*o.scrollFactorY),e.setBlendMode(o.blendMode),o.mask&&(o.mask.preRenderWebGL(e,o,h),e.pipelines.set(o.pipeline));for(var b,T,E=o.tintFill,S=0;S<x;S++){var _=y[S],C=_.alpha*v*m;if(!(C<=0||0===_.scaleX||0===_.scaleY)){f.applyITRS(_.x,_.y,_.rotation,_.scaleX,_.scaleY),f.e=_.x,f.f=_.y,c.multiply(f,d);var A=_.frame;A.glTexture!==T&&(T=A.glTexture,b=u.setGameObject(o,A));var M=-A.halfWidth,P=-A.halfHeight,R=d.setQuad(M,P,M+A.width,P+A.height),L=g(_.tint,C);u.shouldFlush(6)&&(u.flush(),b=u.setGameObject(o,A)),u.batchQuad(o,R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],A.u0,A.v0,A.u1,A.v1,L,L,L,L,E,T,b)}}o.mask&&o.mask.postRenderWebGL(e,h),e.pipelines.postBatch(o)}},bD}(),e=function(){if(SD)return ED;SD=1;var t=TV(),e=Hu(),i=new e,n=new e,s=new e,r=new e;return ED=function(e,a,o,h){var l=i,u=n,c=s,d=r;h?(d.loadIdentity(),d.multiply(h),d.translate(a.x,a.y),d.rotate(a.rotation),d.scale(a.scaleX,a.scaleY)):d.applyITRS(a.x,a.y,a.rotation,a.scaleX,a.scaleY);var f=e.currentContext,p=o.roundPixels,g=o.alpha,m=a.alpha,v=a.alive,y=v.length,x=a.viewBounds;if(a.visible&&0!==y&&(!x||t(x,o.worldView))){a.sortCallback&&a.depthSort(),o.addToRenderList(a);var w=a.scrollFactorX,b=a.scrollFactorY;f.save(),f.globalCompositeOperation=e.blendModes[a.blendMode];for(var T=0;T<y;T++){var E=v[T],S=E.alpha*m*g;if(!(S<=0||0===E.scaleX||0===E.scaleY)){c.applyITRS(E.x,E.y,E.rotation,E.scaleX,E.scaleY),l.copyFrom(o.matrix),l.multiplyWithOffset(d,-o.scrollX*w,-o.scrollY*b),c.e=E.x,c.f=E.y,l.multiply(c,u);var _=E.frame,C=_.canvasData;if(C.width>0&&C.height>0){var A=-_.halfWidth,M=-_.halfHeight;f.globalAlpha=S,f.save(),u.setToContext(f),p&&(A=Math.round(A),M=Math.round(M)),f.imageSmoothingEnabled=!_.source.scaleMode,f.drawImage(_.source.image,C.x,C.y,C.width,C.height,A,M,C.width,C.height),f.restore()}}}f.restore()}},ED}(),_D={renderWebGL:t,renderCanvas:e}}(),A=Gl(),M=Hu(),P=wu(),R=Vu(),L=["active","advance","blendMode","colorEase","deathCallback","deathCallbackScope","duration","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxAliveParticles","maxParticles","name","emitting","particleBringToTop","particleClass","radial","sortCallback","sortOrderAsc","sortProperty","stopAfter","tintFill","timeScale","trackVisible","visible"],O=["accelerationX","accelerationY","alpha","angle","bounce","color","delay","hold","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],F=new t({Extends:l,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,C],initialize:function(t,e,i,n,s){l.call(this,t,"ParticleEmitter"),this.particleClass=w,this.config=null,this.ops={accelerationX:new o("accelerationX",0),accelerationY:new o("accelerationY",0),alpha:new o("alpha",1),angle:new o("angle",{min:0,max:360},!0),bounce:new o("bounce",0),color:new a("color"),delay:new o("delay",0,!0),hold:new o("hold",0,!0),lifespan:new o("lifespan",1e3,!0),maxVelocityX:new o("maxVelocityX",1e4),maxVelocityY:new o("maxVelocityY",1e4),moveToX:new o("moveToX",0),moveToY:new o("moveToY",0),quantity:new o("quantity",1,!0),rotate:new o("rotate",0),scaleX:new o("scaleX",1),scaleY:new o("scaleY",1),speedX:new o("speedX",0,!0),speedY:new o("speedY",0,!0),tint:new o("tint",16777215),x:new o("x",0),y:new o("y",0)},this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.moveTo=!1,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.maxAliveParticles=0,this.stopAfter=0,this.duration=0,this.frequency=0,this.emitting=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZones=[],this.deathZones=[],this.viewBounds=null,this.follow=null,this.followOffset=new P,this.trackVisible=!1,this.frames=[],this.randomFrame=!0,this.frameQuantity=1,this.anims=[],this.randomAnim=!0,this.animQuantity=1,this.dead=[],this.alive=[],this.counters=new Float32Array(10),this.skipping=!1,this.worldMatrix=new M,this.sortProperty="",this.sortOrderAsc=!0,this.sortCallback=this.depthSortCallback,this.processors=new v(this),this.tintFill=!1,this.initPipeline(),this.initPostPipeline(),this.setPosition(e,i),this.setTexture(n),s&&this.setConfig(s)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},setConfig:function(t){if(!t)return this;this.config=t;var e=0,i="",n=this.ops;for(e=0;e<O.length;e++)n[i=O[e]].loadConfig(t);for(e=0;e<L.length;e++)g(t,i=L[e])&&(this[i]=u(t,i));if(this.acceleration=0!==this.accelerationX||0!==this.accelerationY,this.moveTo=f(t,["moveToX","moveToY"]),g(t,"speed")&&(n.speedX.loadConfig(t,"speed"),n.speedY.active=!1),(p(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),g(t,"scale")&&(n.scaleX.loadConfig(t,"scale"),n.scaleY.active=!1),g(t,"callbackScope")){var s=u(t,"callbackScope",null);this.emitCallbackScope=s,this.deathCallbackScope=s}if(g(t,"emitZone")&&this.addEmitZone(t.emitZone),g(t,"deathZone")&&this.addDeathZone(t.deathZone),g(t,"bounds")){var r=this.addParticleBounds(t.bounds);r.collideLeft=u(t,"collideLeft",!0),r.collideRight=u(t,"collideRight",!0),r.collideTop=u(t,"collideTop",!0),r.collideBottom=u(t,"collideBottom",!0)}return g(t,"followOffset")&&this.followOffset.setFromObject(u(t,"followOffset",0)),g(t,"texture")&&this.setTexture(t.texture),g(t,"frame")?this.setEmitterFrame(t.frame):g(t,"anim")&&this.setAnim(t.anim),g(t,"reserve")&&this.reserve(t.reserve),g(t,"advance")&&this.fastForward(t.advance),this.resetCounters(this.frequency,this.emitting),this.emitting&&this.emit(h.START,this),this},updateConfig:function(t){return t&&(this.config?this.setConfig(x(this.config,t)):this.setConfig(t)),this},toJSON:function(){var t=i(this),e=0,n="";for(e=0;e<L.length;e++)t[n=L[e]]=this[n];var s=this.ops;for(e=0;e<O.length;e++)s[n=O[e]]&&(t[n]=s[n].toJSON());return s.speedY.active||(delete t.speedX,t.speed=s.speedX.toJSON()),this.scaleX===this.scaleY&&(delete t.scaleX,delete t.scaleY,t.scale=s.scaleX.toJSON()),t},resetCounters:function(t,e){var i=this.counters;i.fill(0),i[0]=t,e&&(i[5]=1)},startFollow:function(t,e,i,n){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=!1),this.follow=t,this.followOffset.set(e,i),this.trackVisible=n,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){var t,e=this.frames,i=e.length;return 1===i?t=e[0]:this.randomFrame?t=c(e):(t=e[this.currentFrame],this.frameCounter++,this.frameCounter===this.frameQuantity&&(this.frameCounter=0,this.currentFrame++,this.currentFrame===i&&(this.currentFrame=0))),this.texture.get(t)},setEmitterFrame:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomFrame=e,this.frameQuantity=i,this.currentFrame=0;var n=typeof t;if(this.frames.length=0,Array.isArray(t))this.frames=this.frames.concat(t);else if("string"===n||"number"===n)this.frames.push(t);else if("object"===n){var s=t;(t=u(s,"frames",null))&&(this.frames=this.frames.concat(t));var r=u(s,"cycle",!1);this.randomFrame=!r,this.frameQuantity=u(s,"quantity",i)}return 1===this.frames.length&&(this.frameQuantity=1,this.randomFrame=!1),this},getAnim:function(){var t=this.anims,e=t.length;if(0===e)return null;if(1===e)return t[0];if(this.randomAnim)return c(t);var i=t[this.currentAnim];return this.animCounter++,this.animCounter>=this.animQuantity&&(this.animCounter=0,this.currentAnim=R(this.currentAnim+1,0,e)),i},setAnim:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=1),this.randomAnim=e,this.animQuantity=i,this.currentAnim=0;var n=typeof t;if(this.anims.length=0,Array.isArray(t))this.anims=this.anims.concat(t);else if("string"===n)this.anims.push(t);else if("object"===n){var s=t;(t=u(s,"anims",null))&&(this.anims=this.anims.concat(t));var r=u(s,"cycle",!1);this.randomAnim=!r,this.animQuantity=u(s,"quantity",i)}return 1===this.anims.length&&(this.animQuantity=1,this.randomAnim=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},addParticleBounds:function(t,e,i,n,s,r,a,o){if("object"==typeof t){var h=t;t=h.x,e=h.y,i=g(h,"w")?h.w:h.width,n=g(h,"h")?h.h:h.height}return this.addParticleProcessor(new b(t,e,i,n,s,r,a,o))},setParticleSpeed:function(t,e){return void 0===e&&(e=t),this.ops.speedX.onChange(t),t===e?this.ops.speedY.active=!1:this.ops.speedY.onChange(e),this.radial=!0,this},setParticleScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.ops.scaleX.onChange(t),this.ops.scaleY.onChange(e),this},setParticleGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setParticleAlpha:function(t){return this.ops.alpha.onChange(t),this},setParticleTint:function(t){return this.ops.tint.onChange(t),this},setEmitterAngle:function(t){return this.ops.angle.onChange(t),this},setParticleLifespan:function(t){return this.ops.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity=t,this},setFrequency:function(t,e){return this.frequency=t,this.flowCounter=t>0?t:0,e&&(this.quantity=e),this},addDeathZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof s)i.push(e);else if("function"==typeof e.contains)e=new s(e,!0),i.push(e);else{var r=u(e,"type","onEnter"),a=u(e,"source",null);a&&"function"==typeof a.contains&&(e=new s(a,"onEnter"===r),i.push(e))}return this.deathZones=this.deathZones.concat(i),i},removeDeathZone:function(t){return _(this.deathZones,t),this},clearDeathZones:function(){return this.deathZones.length=0,this},addEmitZone:function(t){var e;Array.isArray(t)||(t=[t]);for(var i=[],n=0;n<t.length;n++)if((e=t[n])instanceof T||e instanceof r)i.push(e);else{var s=u(e,"source",null);if(s){var a=u(e,"type","random");if("random"===a&&"function"==typeof s.getRandomPoint)e=new T(s),i.push(e);else if("edge"===a&&"function"==typeof s.getPoints){var o=u(e,"quantity",1),h=u(e,"stepRate",0),l=u(e,"yoyo",!1),c=u(e,"seamless",!0),d=u(e,"total",-1);e=new r(s,o,h,l,c,d),i.push(e)}}}return this.emitZones=this.emitZones.concat(i),i},removeEmitZone:function(t){return _(this.emitZones,t),this.zoneIndex=0,this},clearEmitZones:function(){return this.emitZones.length=0,this.zoneIndex=0,this},getEmitZone:function(t){var e=this.emitZones,i=e.length;if(0!==i){var n=e[this.zoneIndex];n.getPoint(t),n.total>-1&&(this.zoneTotal++,this.zoneTotal===n.total&&(this.zoneTotal=0,this.zoneIndex++,this.zoneIndex===i&&(this.zoneIndex=0)))}},getDeathZone:function(t){for(var e=this.deathZones,i=0;i<e.length;i++){var n=e[i];if(n.willKill(t))return this.emit(h.DEATH_ZONE,this,t,n),!0}return!1},setEmitZone:function(t){var e;return(e=isFinite(t)?t:this.emitZones.indexOf(t))>=0&&(this.zoneIndex=e),this},addParticleProcessor:function(t){return this.processors.exists(t)||(t.emitter&&t.emitter.removeParticleProcessor(t),this.processors.add(t),t.emitter=this),t},removeParticleProcessor:function(t){return this.processors.exists(t)&&(this.processors.remove(t,!0),t.emitter=null),t},getProcessors:function(){return this.processors.getAll("active",!0)},createGravityWell:function(t){return this.addParticleProcessor(new d(t))},reserve:function(t){var e=this.dead;if(this.maxParticles>0){var i=this.getParticleCount();i+t>this.maxParticles&&(t=this.maxParticles-(i+t))}for(var n=0;n<t;n++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()>=this.maxParticles||this.maxAliveParticles>0&&this.getAliveParticleCount()>=this.maxAliveParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var i=this.alive,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},forEachDead:function(t,e){for(var i=this.dead,n=i.length,s=0;s<n;s++)t.call(e,i[s],this);return this},start:function(t,e){return void 0===t&&(t=0),this.emitting||(t>0&&this.fastForward(t),this.emitting=!0,this.resetCounters(this.frequency,!0),void 0!==e&&(this.duration=Math.abs(e)),this.emit(h.START,this)),this},stop:function(t){return void 0===t&&(t=!1),this.emitting&&(this.emitting=!1,t&&this.killAll(),this.emit(h.STOP,this)),this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},setSortProperty:function(t,e){return void 0===t&&(t=""),void 0===e&&(e=this.true),this.sortProperty=t,this.sortOrderAsc=e,this.sortCallback=this.depthSortCallback,this},setSortCallback:function(t){return t=""!==this.sortProperty?this.depthSortCallback:null,this.sortCallback=t,this},depthSort:function(){return A(this.alive,this.sortCallback.bind(this)),this},depthSortCallback:function(t,e){var i=this.sortProperty;return this.sortOrderAsc?t[i]-e[i]:e[i]-t[i]},flow:function(t,e,i){return void 0===e&&(e=1),this.emitting=!1,this.frequency=t,this.quantity=e,void 0!==i&&(this.stopAfter=i),this.start()},explode:function(t,e,i){this.frequency=-1,this.resetCounters(-1,!0);var n=this.emitParticle(t,e,i);return this.emit(h.EXPLODE,this,n),n},emitParticleAt:function(t,e,i){return this.emitParticle(i,t,e)},emitParticle:function(t,e,i){if(!this.atLimit()){void 0===t&&(t=this.ops.quantity.onEmit());for(var n=this.dead,s=this.stopAfter,r=this.follow?this.follow.x+this.followOffset.x:e,a=this.follow?this.follow.y+this.followOffset.y:i,o=0;o<t;o++){var h=n.pop();if(h||(h=new this.particleClass(this)),h.fire(r,a)?(this.particleBringToTop?this.alive.push(h):this.alive.unshift(h),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,h,this)):this.dead.push(h),s>0&&(this.stopCounter++,this.stopCounter>=s))break;if(this.atLimit())break}return h}},fastForward:function(t,e){void 0===e&&(e=1e3/60);var i=0;for(this.skipping=!0;i<Math.abs(t);)this.preUpdate(0,e),i+=e;return this.skipping=!1,this},preUpdate:function(t,e){var i=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible),this.getWorldTransformMatrix(this.worldMatrix);var n=this.getProcessors(),s=this.alive,r=this.dead,a=0,o=[],l=s.length;for(a=0;a<l;a++){var u=s[a];u.update(e,i,n)&&o.push({index:a,particle:u})}if((l=o.length)>0){var c=this.deathCallback,d=this.deathCallbackScope;for(a=l-1;a>=0;a--){var f=o[a];s.splice(f.index,1),r.push(f.particle),c&&c.call(d,f.particle),f.particle.setPosition()}}if(this.emitting||this.skipping){if(0===this.frequency)this.emitParticle();else if(this.frequency>0)for(this.flowCounter-=e;this.flowCounter<=0;)this.emitParticle(),this.flowCounter+=this.frequency;this.skipping||(this.duration>0&&(this.elapsed+=e,this.elapsed>=this.duration&&this.stop()),this.stopAfter>0&&this.stopCounter>=this.stopAfter&&this.stop())}else 1===this.completeFlag&&0===s.length&&(this.completeFlag=0,this.emit(h.COMPLETE,this))},overlap:function(t){for(var e=this.getWorldTransformMatrix(),i=this.alive,n=i.length,s=[],r=0;r<n;r++){var a=i[r];S(t,a.getBounds(e))&&s.push(a)}return s},getBounds:function(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1e3/60),void 0===s&&(s=new E);var r,a,o=this.getWorldTransformMatrix(),h=this.alive,l=!1;if(s.setTo(0,0,0,0),e>0){var u=0;for(this.skipping=!0;u<Math.abs(e);){for(this.preUpdate(0,i),r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));u+=i}this.skipping=!1}else for(r=0;r<h.length;r++)a=h[r].getBounds(o),l?y(s,a):(l=!0,n(a,s));return t>0&&m(s,t,t),s},createEmitter:function(){throw new Error("createEmitter removed. See ParticleEmitter docs for info")},particleX:{get:function(){return this.ops.x.current},set:function(t){this.ops.x.onChange(t)}},particleY:{get:function(){return this.ops.y.current},set:function(t){this.ops.y.onChange(t)}},accelerationX:{get:function(){return this.ops.accelerationX.current},set:function(t){this.ops.accelerationX.onChange(t)}},accelerationY:{get:function(){return this.ops.accelerationY.current},set:function(t){this.ops.accelerationY.onChange(t)}},maxVelocityX:{get:function(){return this.ops.maxVelocityX.current},set:function(t){this.ops.maxVelocityX.onChange(t)}},maxVelocityY:{get:function(){return this.ops.maxVelocityY.current},set:function(t){this.ops.maxVelocityY.onChange(t)}},speed:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t),this.ops.speedY.onChange(t)}},speedX:{get:function(){return this.ops.speedX.current},set:function(t){this.ops.speedX.onChange(t)}},speedY:{get:function(){return this.ops.speedY.current},set:function(t){this.ops.speedY.onChange(t)}},moveToX:{get:function(){return this.ops.moveToX.current},set:function(t){this.ops.moveToX.onChange(t)}},moveToY:{get:function(){return this.ops.moveToY.current},set:function(t){this.ops.moveToY.onChange(t)}},bounce:{get:function(){return this.ops.bounce.current},set:function(t){this.ops.bounce.onChange(t)}},particleScaleX:{get:function(){return this.ops.scaleX.current},set:function(t){this.ops.scaleX.onChange(t)}},particleScaleY:{get:function(){return this.ops.scaleY.current},set:function(t){this.ops.scaleY.onChange(t)}},particleColor:{get:function(){return this.ops.color.current},set:function(t){this.ops.color.onChange(t)}},colorEase:{get:function(){return this.ops.color.easeName},set:function(t){this.ops.color.setEase(t)}},particleTint:{get:function(){return this.ops.tint.current},set:function(t){this.ops.tint.onChange(t)}},particleAlpha:{get:function(){return this.ops.alpha.current},set:function(t){this.ops.alpha.onChange(t)}},lifespan:{get:function(){return this.ops.lifespan.current},set:function(t){this.ops.lifespan.onChange(t)}},particleAngle:{get:function(){return this.ops.angle.current},set:function(t){this.ops.angle.onChange(t)}},particleRotate:{get:function(){return this.ops.rotate.current},set:function(t){this.ops.rotate.onChange(t)}},quantity:{get:function(){return this.ops.quantity.current},set:function(t){this.ops.quantity.onChange(t)}},delay:{get:function(){return this.ops.delay.current},set:function(t){this.ops.delay.onChange(t)}},hold:{get:function(){return this.ops.hold.current},set:function(t){this.ops.hold.onChange(t)}},flowCounter:{get:function(){return this.counters[0]},set:function(t){this.counters[0]=t}},frameCounter:{get:function(){return this.counters[1]},set:function(t){this.counters[1]=t}},animCounter:{get:function(){return this.counters[2]},set:function(t){this.counters[2]=t}},elapsed:{get:function(){return this.counters[3]},set:function(t){this.counters[3]=t}},stopCounter:{get:function(){return this.counters[4]},set:function(t){this.counters[4]=t}},completeFlag:{get:function(){return this.counters[5]},set:function(t){this.counters[5]=t}},zoneIndex:{get:function(){return this.counters[6]},set:function(t){this.counters[6]=t}},zoneTotal:{get:function(){return this.counters[7]},set:function(t){this.counters[7]=t}},currentFrame:{get:function(){return this.counters[8]},set:function(t){this.counters[8]=t}},currentAnim:{get:function(){return this.counters[9]},set:function(t){this.counters[9]=t}},preDestroy:function(){var t;this.texture=null,this.frames=null,this.anims=null,this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.emitZones=null,this.deathZones=null,this.bounds=null,this.follow=null,this.counters=null;var e=this.ops;for(t=0;t<O.length;t++)e[O[t]].destroy();for(t=0;t<this.alive.length;t++)this.alive[t].destroy();for(t=0;t<this.dead.length;t++)this.dead[t].destroy();this.ops=null,this.alive=[],this.dead=[],this.worldMatrix.destroy()}});return AD=F}function SV(){if(kD)return FD;kD=1;var t=Ih(),e=Zu(),i=iV(),n=new t({Extends:i,Mixins:[e.PathFollower],initialize:function(t,e,n,s,r,a){i.call(this,t,n,s,r,a),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});return FD=n}function _V(){if(ID)return DD;ID=1;var t=Ih(),e=aW(),i=hW(),n=new t({Extends:i,initialize:function(t,n,s,r,a,o){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=32),void 0===a&&(a=32),void 0===o&&(o=!0);var h=new e(t.sys.textures,"",r,a,o);i.call(this,t,n,s,h),this.type="RenderTexture",this.camera=this.texture.camera,this._saved=!1},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},resize:function(t,e,i){return this.texture.setSize(t,e,i),this.setSize(this.texture.width,this.texture.height),this},saveTexture:function(t){var e=this.texture;return e.key=t,e.manager.addDynamicTexture(e)&&(this._saved=!0),e},fill:function(t,e,i,n,s,r){return this.texture.fill(t,e,i,n,s,r),this},clear:function(){return this.texture.clear(),this},stamp:function(t,e,i,n,s){return this.texture.stamp(t,e,i,n,s),this},erase:function(t,e,i){return this.texture.erase(t,e,i),this},draw:function(t,e,i,n,s){return this.texture.draw(t,e,i,n,s),this},drawFrame:function(t,e,i,n,s,r){return this.texture.drawFrame(t,e,i,n,s,r),this},repeat:function(t,e,i,n,s,r,a,o,h){return this.texture.repeat(t,e,i,n,s,r,a,o,h),this},beginDraw:function(){return this.texture.beginDraw(),this},batchDraw:function(t,e,i,n,s){return this.texture.batchDraw(t,e,i,n,s),this},batchDrawFrame:function(t,e,i,n,s,r){return this.texture.batchDrawFrame(t,e,i,n,s,r),this},endDraw:function(t){return this.texture.endDraw(t),this},snapshotArea:function(t,e,i,n,s,r,a){return this.texture.snapshotArea(t,e,i,n,s,r,a),this},snapshot:function(t,e,i){return this.snapshotArea(0,0,this.width,this.height,t,e,i)},snapshotPixel:function(t,e,i){return this.snapshotArea(t,e,1,1,i,"pixel")},preDestroy:function(){this.camera=null,this._saved||this.texture.destroy()}});return DD=n}function CV(){if(UD)return zD;UD=1;var t=Tl();return zD=function(e,i){var n=i.width,s=i.height,r=Math.floor(n/2),a=Math.floor(s/2),o=t(i,"chars","");if(""!==o){var h=t(i,"image",""),l=e.sys.textures.getFrame(h),u=l.cutX,c=l.cutY,d=l.source.width,f=l.source.height,p=t(i,"offset.x",0),g=t(i,"offset.y",0),m=t(i,"spacing.x",0),v=t(i,"spacing.y",0),y=t(i,"lineSpacing",0),x=t(i,"charsPerRow",null);null===x&&(x=d/n)>o.length&&(x=o.length);for(var w=p,b=g,T={retroFont:!0,font:h,size:n,lineHeight:s+y,chars:{}},E=0,S=0;S<o.length;S++){var _=o.charCodeAt(S),C=(u+w)/d,A=(c+b)/f,M=(u+w+n)/d,P=(c+b+s)/f;T.chars[_]={x:w,y:b,width:n,height:s,centerX:r,centerY:a,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{},u0:C,v0:A,u1:M,v1:P},++E===x?(E=0,w=p,b+=s+v):w+=n+m}return{data:T,frame:null,texture:h}}},zD}function AV(){if(XD)return YD;XD=1;var t=ND?BD:(ND=1,BD={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}),e=jo(),i={Parse:CV()};return i=e(!1,i,t),YD=i}function MV(){if(qD)return jD;qD=1;var t,e,i=Dh();return t=function(){if(HD)return GD;HD=1;var t=SW(),e=NX();return GD=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline,n),o=t(n,s,r).calc,h=n.vertices,l=n.uv,u=n.colors,c=n.alphas,d=n.alpha,f=e.getTintAppendFloatAlpha,p=s.roundPixels,g=h.length,m=Math.floor(.5*g);a.flush(),i.pipelines.preBatch(n);var v=a.setGameObject(n),y=a.vertexViewF32,x=a.vertexViewU32,w=a.vertexCount*a.currentShader.vertexComponentCount-1,b=0,T=n.tintFill;n.dirty&&n.updateVertices();for(var E=n.debugCallback,S=[],_=0;_<g;_+=2){var C=h[_+0],A=h[_+1],M=C*o.a+A*o.c+o.e,P=C*o.b+A*o.d+o.f;p&&(M=Math.round(M),P=Math.round(P)),y[++w]=M,y[++w]=P,y[++w]=l[_+0],y[++w]=l[_+1],y[++w]=v,y[++w]=T,x[++w]=f(u[b],s.alpha*(c[b]*d)),b++,E&&(S[_+0]=M,S[_+1]=P)}E&&E.call(n,n,g,S),a.vertexCount+=m,a.currentBatch.count=a.vertexCount-a.currentBatch.start,i.pipelines.postBatch(n)},GD}(),e=VD?WD:(VD=1,WD=function(){}),jD={renderWebGL:t,renderCanvas:e}}function PV(){if(ZD)return KD;ZD=1;var t=rY(),e=Ih(),i=Zu(),n=Nz(),s=_X(),r=MV(),a=wu(),o=new e({Extends:n,Mixins:[i.AlphaSingle,i.BlendMode,i.Depth,i.Flip,i.Mask,i.Pipeline,i.PostPipeline,i.Size,i.Texture,i.Transform,i.Visible,i.ScrollFactor,r],initialize:function(e,i,r,o,h,l,u,c,d){void 0===o&&(o="__DEFAULT"),void 0===l&&(l=2),void 0===u&&(u=!0),n.call(this,e,"Rope"),this.anims=new t(this),this.points=l,this.vertices,this.uv,this.colors,this.alphas,this.tintFill="__DEFAULT"===o,this.dirty=!1,this.horizontal=u,this._flipX=!1,this._flipY=!1,this._perp=new a,this.debugCallback=null,this.debugGraphic=null,this.setTexture(o,h),this.setPosition(i,r),this.setSizeToFrame(),this.initPipeline(s.ROPE_PIPELINE),this.initPostPipeline(),Array.isArray(l)&&this.resizeArrays(l.length),this.setPoints(l,c,d),this.updateVertices()},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},preUpdate:function(t,e){var i=this.anims.currentFrame;this.anims.update(t,e),this.anims.currentFrame!==i&&(this.updateUVs(),this.updateVertices())},play:function(t,e,i){return this.anims.play(t,e,i),this},setDirty:function(){return this.dirty=!0,this},setHorizontal:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?this:(this.horizontal=!0,this.setPoints(t,e,i))},setVertical:function(t,e,i){return void 0===t&&(t=this.points.length),this.horizontal?(this.horizontal=!1,this.setPoints(t,e,i)):this},setTintFill:function(t){return void 0===t&&(t=!1),this.tintFill=t,this},setAlphas:function(t,e){var i=this.points.length;if(i<1)return this;var n,s=this.alphas;void 0===t?t=[1]:Array.isArray(t)||void 0!==e||(t=[t]);var r=0;if(void 0!==e)for(n=0;n<i;n++)s[r=2*n]=t,s[r+1]=e;else if(t.length===i)for(n=0;n<i;n++)s[r=2*n]=t[n],s[r+1]=t[n];else{var a=t[0];for(n=0;n<i;n++)r=2*n,t.length>r&&(a=t[r]),s[r]=a,t.length>r+1&&(a=t[r+1]),s[r+1]=a}return this},setColors:function(t){var e=this.points.length;if(e<1)return this;var i,n=this.colors;void 0===t?t=[16777215]:Array.isArray(t)||(t=[t]);var s=0;if(t.length===e)for(i=0;i<e;i++)n[s=2*i]=t[i],n[s+1]=t[i];else{var r=t[0];for(i=0;i<e;i++)s=2*i,t.length>s&&(r=t[s]),n[s]=r,t.length>s+1&&(r=t[s+1]),n[s+1]=r}return this},setPoints:function(t,e,i){if(void 0===t&&(t=2),"number"==typeof t){var n,s,r,a=t;if(a<2&&(a=2),t=[],this.horizontal)for(r=-this.frame.halfWidth,s=this.frame.width/(a-1),n=0;n<a;n++)t.push({x:r+n*s,y:0});else for(r=-this.frame.halfHeight,s=this.frame.height/(a-1),n=0;n<a;n++)t.push({x:0,y:r+n*s})}var o=t.length,h=this.points.length;return o<1?(console.warn("Rope: Not enough points given"),this):(1===o&&(t.unshift({x:0,y:0}),o++),h!==o&&this.resizeArrays(o),this.dirty=!0,this.points=t,this.updateUVs(),null!=e&&this.setColors(e),null!=i&&this.setAlphas(i),this)},updateUVs:function(){for(var t=this.uv,e=this.points.length,i=this.frame.u0,n=this.frame.v0,s=this.frame.u1,r=this.frame.v1,a=(s-i)/(e-1),o=(r-n)/(e-1),h=0;h<e;h++){var l,u,c,d,f=4*h;this.horizontal?(this._flipX?(l=s-h*a,c=s-h*a):(l=i+h*a,c=i+h*a),this._flipY?(u=r,d=n):(u=n,d=r)):(this._flipX?(l=i,c=s):(l=s,c=i),this._flipY?(u=r-h*o,d=r-h*o):(u=n+h*o,d=n+h*o)),t[f+0]=l,t[f+1]=u,t[f+2]=c,t[f+3]=d}return this},resizeArrays:function(t){var e=this.colors,i=this.alphas;this.vertices=new Float32Array(4*t),this.uv=new Float32Array(4*t),e=new Uint32Array(2*t),i=new Float32Array(2*t);for(var n=0;n<2*t;n++)e[n]=16777215,i[n]=1;return this.colors=e,this.alphas=i,this.dirty=!0,this},updateVertices:function(){var t=this._perp,e=this.points,i=this.vertices,n=e.length;if(this.dirty=!1,!(n<1)){for(var s,r=e[0],a=this.horizontal?this.frame.halfHeight:this.frame.halfWidth,o=0;o<n;o++){var h=e[o],l=4*o;s=o<n-1?e[o+1]:h,t.x=s.y-r.y,t.y=-(s.x-r.x);var u=t.length();t.x/=u,t.y/=u,t.x*=a,t.y*=a,i[l]=h.x+t.x,i[l+1]=h.y+t.y,i[l+2]=h.x-t.x,i[l+3]=h.y-t.y,r=h}return this}},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebugVerts:null,this},renderDebugVerts:function(t,e,i){var n=t.debugGraphic,s=i[0],r=i[1],a=i[2],o=i[3];n.lineBetween(s,r,a,o);for(var h=4;h<e;h+=4){var l=i[h+0],u=i[h+1],c=i[h+2],d=i[h+3];n.lineBetween(s,r,l,u),n.lineBetween(a,o,c,d),n.lineBetween(a,o,l,u),n.lineBetween(l,u,c,d),s=l,r=u,a=c,o=d}},preDestroy:function(){this.anims.destroy(),this.anims=void 0,this.points=null,this.vertices=null,this.uv=null,this.colors=null,this.alphas=null,this.debugCallback=null,this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(t){return this._flipX=t,this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(t){return this._flipY=t,this.updateUVs()}}});return KD=o}function RV(){return JD||(JD=1,$D=function(t,e,i){var n=t.canvas,s=t.context,r=t.style,a=[],o=0,h=i.length;r.maxLines>0&&r.maxLines<i.length&&(h=r.maxLines),r.syncFont(n,s);for(var l=t.letterSpacing,u=0;u<h;u++){var c=r.strokeThickness;if(0===l)c+=s.measureText(i[u]).width;else{for(var d=i[u],f=0;f<d.length;f++)c+=s.measureText(d[f]).width;d.length>1&&(c+=l*(d.length-1))}r.wordWrap&&(c-=s.measureText(" ").width),a[u]=Math.ceil(c),o=Math.max(o,a[u])}var p=e.fontSize+r.strokeThickness,g=p*h,m=t.lineSpacing;return h>1&&(g+=m*(h-1)),{width:o,height:g,lines:h,lineWidths:a,lineSpacing:m,lineHeight:p}}),$D}function LV(){if(sI)return nI;sI=1;var t=Dh();return t=function(){if(tI)return QD;tI=1;var t=NX();return QD=function(e,i,n,s){if(0!==i.width&&0!==i.height){n.addToRenderList(i);var r=i.frame,a=r.width,o=r.height,h=t.getTintAppendFloatAlpha,l=e.pipelines.set(i.pipeline,i),u=l.setTexture2D(r.glTexture,i);l.batchTexture(i,r.glTexture,a,o,i.x,i.y,a/i.style.resolution,o/i.style.resolution,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.displayOriginX,i.displayOriginY,0,0,a,o,h(i.tintTopLeft,n.alpha*i._alphaTL),h(i.tintTopRight,n.alpha*i._alphaTR),h(i.tintBottomLeft,n.alpha*i._alphaBL),h(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,0,0,n,s,!1,u)}},QD}(),iI||(iI=1,eI=function(t,e,i,n){0!==e.width&&0!==e.height&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),nI={renderWebGL:t,renderCanvas:eI}}function OV(){if(aI)return rI;aI=1;var t=Dl();return rI=function(e){var i=t.create(this),n=i.getContext("2d",{willReadFrequently:!0});e.syncFont(i,n);var s=n.measureText(e.testString);if("actualBoundingBoxAscent"in s){var r=s.actualBoundingBoxAscent,a=s.actualBoundingBoxDescent;return t.remove(i),{ascent:r,descent:a,fontSize:r+a}}var o=Math.ceil(s.width*e.baselineX),h=o,l=2*h;h=h*e.baselineY|0,i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=e._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(e.testString,0,h);var u={ascent:0,descent:0,fontSize:0},c=n.getImageData(0,0,o,l);if(!c)return u.ascent=h,u.descent=h+6,u.fontSize=u.ascent+u.descent,t.remove(i),u;var d,f,p=c.data,g=p.length,m=4*o,v=0,y=!1;for(d=0;d<h;d++){for(f=0;f<m;f+=4)if(255!==p[v+f]){y=!0;break}if(y)break;v+=m}for(u.ascent=h-d,v=g-m,y=!1,d=l;d>h;d--){for(f=0;f<m;f+=4)if(255!==p[v+f]){y=!0;break}if(y)break;v-=m}return u.descent=d-h,u.fontSize=u.ascent+u.descent,t.remove(i),u},rI}function FV(){if(hI)return oI;hI=1;var t=Ih(),e=_W(),i=Tl(),n=OV(),s={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|MÃâ°qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},r=new t({initialize:function(t,e){this.parent=t,this.fontFamily,this.fontSize,this.fontStyle,this.backgroundColor,this.color,this.stroke,this.strokeThickness,this.shadowOffsetX,this.shadowOffsetY,this.shadowColor,this.shadowBlur,this.shadowStroke,this.shadowFill,this.align,this.maxLines,this.fixedWidth,this.fixedHeight,this.resolution,this.rtl,this.testString,this.baselineX,this.baselineY,this.wordWrapWidth,this.wordWrapCallback,this.wordWrapCallbackScope,this.wordWrapUseAdvanced,this._font,this.setStyle(e,!1,!0)},setStyle:function(t,r,a){for(var o in void 0===r&&(r=!0),void 0===a&&(a=!1),s){var h=a?s[o][1]:this[o];"wordWrapCallback"===o||"wordWrapCallbackScope"===o?this[o]=i(t,s[o][0],h):t&&"fontSize"===o&&"number"==typeof t.fontSize?this[o]=t.fontSize.toString()+"px":this[o]=e(t,s[o][0],h)}var l=i(t,"font",null);null!==l&&this.setFont(l,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var u=i(t,"fill",null);null!==u&&(this.color=u);var c=i(t,"metrics",!1);return c?this.metrics={ascent:i(c,"ascent",0),descent:i(c,"descent",0),fontSize:i(c,"fontSize",0)}:!r&&this.metrics||(this.metrics=n(this)),r?this.parent.updateText():this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=n(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,s="",r="";if("string"!=typeof t)n=i(t,"fontFamily","Courier"),s=i(t,"fontSize","16px"),r=i(t,"fontStyle","");else{var a=t.split(" "),o=0;r=a.length>2?a[o++]:"",s=a[o++]||"16px",n=a[o++]||"Courier"}return n===this.fontFamily&&s===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=s,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="#000"),void 0===n&&(n=0),void 0===s&&(s=!1),void 0===r&&(r=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=i,this.shadowBlur=n,this.shadowStroke=s,this.shadowFill=r,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in s)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});return oI=r}function kV(){return uI?lI:(uI=1,lI=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})})}function DV(){if(dI)return cI;dI=1;var t=wH(),e=Dl(),i=Ih(),n=Zu(),s=Nz(),r=RV(),a=Tl(),o=LH(),h=LV(),l=FV(),u=kV(),c=new i({Extends:s,Mixins:[n.Alpha,n.BlendMode,n.ComputedSize,n.Crop,n.Depth,n.Flip,n.GetBounds,n.Mask,n.Origin,n.Pipeline,n.PostPipeline,n.ScrollFactor,n.Tint,n.Transform,n.Visible,h],initialize:function(t,i,n,r,a){void 0===i&&(i=0),void 0===n&&(n=0),s.call(this,t,"Text"),this.renderer=t.sys.renderer,this.setPosition(i,n),this.setOrigin(0,0),this.initPipeline(),this.initPostPipeline(!0),this.canvas=e.create(this),this.context,this.style=new l(this,a),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.letterSpacing=0,0===this.style.resolution&&(this.style.resolution=1),this._crop=this.resetCropObject(),this._textureKey=u(),this.texture=t.sys.textures.addCanvas(this._textureKey,this.canvas),this.context=this.texture.context,this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(r),a&&a.padding&&this.setPadding(a.padding),a&&a.lineSpacing&&this.setLineSpacing(a.lineSpacing),a&&a.letterSpacing&&this.setLetterSpacing(a.letterSpacing)},initRTL:function(){if(!this.style.rtl)return this.canvas.dir="ltr",void(this.context.direction="ltr");this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas),this.originX=1},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var i=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(i)&&(i=i.join("\n")),i}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,i){for(var n="",s=t.replace(/ +/gi," ").split(this.splitRegExp),r=s.length,a=0;a<r;a++){var o=s[a],h="",l=(o=o.replace(/^ *|\s*$/gi,"")).length*this.letterSpacing;if(e.measureText(o).width+l<i)n+=o+"\n";else{for(var u=i,c=o.split(" "),d=0;d<c.length;d++){var f=c[d],p=f+" ",g=p.length*this.letterSpacing,m=e.measureText(p).width+g;if(m>u){if(0===d){for(var v=p;v.length;){var y=(v=v.slice(0,-1)).length*this.letterSpacing;if((m=e.measureText(v).width+y)<=u)break}if(!v.length)throw new Error("wordWrapWidth < a single character");var x=f.substr(v.length);c[d]=x,h+=v}var w=c[d].length?d:d+1,b=c.slice(w).join(" ").replace(/[ \n]*$/gi,"");s.splice(a+1,0,b),r=s.length;break}h+=p,u-=m}n+=h.replace(/[ \n]*$/gi,"")+"\n"}}return n.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,i){for(var n="",s=t.split(this.splitRegExp),r=s.length-1,a=e.measureText(" ").width,o=0;o<=r;o++){for(var h=i,l=s[o].split(" "),u=l.length-1,c=0;c<=u;c++){var d=l[c],f=d.length*this.letterSpacing,p=e.measureText(d).width+f,g=p;c<u&&(g+=a),g>h&&c>0&&(n+="\n",h=i),n+=d,c<u?(n+=" ",h-=g):h-=p}o<r&&(n+="\n")}return n},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},appendText:function(t,e){void 0===e&&(e=!0),t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t=t.toString();var i=this._text.concat(e?"\n"+t:t);return i!==this._text&&(this._text=i,this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,i,n,s,r){return this.style.setShadow(t,e,i,n,s,r)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setLetterSpacing:function(t){return this.letterSpacing=t,this.updateText()},setPadding:function(t,e,i,n){if("object"==typeof t){var s=t,r=a(s,"x",null);null!==r?(t=r,i=r):(t=a(s,"left",0),i=a(s,"right",t));var o=a(s,"y",null);null!==o?(e=o,n=o):(e=a(s,"top",0),n=a(s,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=e);return this.padding.left=t,this.padding.top=e,this.padding.right=i,this.padding.bottom=n,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},setRTL:function(e){void 0===e&&(e=!0);var i=this.style;return i.rtl===e||(i.rtl=e,e?(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",t(this.canvas,this.scene.sys.canvas)):(this.canvas.dir="ltr",this.context.direction="ltr"),"left"===i.align?i.align="right":"right"===i.align&&(i.align="left")),this},updateText:function(){var t=this.canvas,e=this.context,i=this.style,n=i.resolution,s=i.metrics;i.syncFont(t,e);var a=this._text;(i.wordWrapWidth||i.wordWrapCallback)&&(a=this.runWordWrap(this._text));var o,h=a.split(this.splitRegExp),l=r(this,s,h),u=this.padding;0===i.fixedWidth?(this.width=l.width+u.left+u.right,o=l.width):(this.width=i.fixedWidth,(o=this.width-u.left-u.right)<l.width&&(o=l.width)),0===i.fixedHeight?this.height=l.height+u.top+u.bottom:this.height=i.fixedHeight;var c,d,f=this.width,p=this.height;this.updateDisplayOrigin(),f*=n,p*=n,f=Math.max(f,1),p=Math.max(p,1),t.width!==f||t.height!==p?(t.width=f,t.height=p,this.frame.setSize(f,p),i.syncFont(t,e),i.rtl&&(e.direction="rtl")):e.clearRect(0,0,f,p),e.save(),e.scale(n,n),i.backgroundColor&&(e.fillStyle=i.backgroundColor,e.fillRect(0,0,f,p)),i.syncStyle(t,e),e.translate(u.left,u.top);for(var g=0;g<l.lines;g++){if(c=i.strokeThickness/2,d=i.strokeThickness/2+g*l.lineHeight+s.ascent,g>0&&(d+=l.lineSpacing*g),i.rtl)c=f-c-u.left-u.right;else if("right"===i.align)c+=o-l.lineWidths[g];else if("center"===i.align)c+=(o-l.lineWidths[g])/2;else if("justify"===i.align&&l.lineWidths[g]/l.width>=.85){var m=l.width-l.lineWidths[g],v=e.measureText(" ").width,y=h[g].trim(),x=y.split(" ");m+=(h[g].length-y.length)*v;for(var w=Math.floor(m/v),b=0;w>0;)x[b]+=" ",b=(b+1)%(x.length-1||1),--w;h[g]=x.join(" ")}this.autoRound&&(c=Math.round(c),d=Math.round(d));var T=this.letterSpacing;if(i.strokeThickness&&0===T&&(i.syncShadow(e,i.shadowStroke),e.strokeText(h[g],c,d)),i.color)if(i.syncShadow(e,i.shadowFill),0!==T)for(var E=0,S=h[g].split(""),_=0;_<S.length;_++)i.strokeThickness&&(i.syncShadow(e,i.shadowStroke),e.strokeText(S[_],c+E,d),i.syncShadow(e,i.shadowFill)),e.fillText(S[_],c+E,d),E+=e.measureText(S[_]).width+T;else e.fillText(h[g],c,d)}e.restore(),this.renderer&&this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture.spectorMetadata={textureKey:"Text Game Object"});var C=this.input;return C&&!C.customHitArea&&(C.hitArea.width=this.width,C.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=n.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){o(this.canvas),e.remove(this.canvas);var t=this.texture;t&&t.destroy()}});return cI=c}function IV(){if(yI)return vI;yI=1;var t=Dh();return t=function(){if(pI)return fI;pI=1;var t=NX();return fI=function(e,i,n,s){i.updateCanvas();var r=i.width,a=i.height;if(0!==r&&0!==a){n.addToRenderList(i);var o=t.getTintAppendFloatAlpha,h=e.pipelines.set(i.pipeline,i),l=h.setTexture2D(i.fillPattern,i);h.batchTexture(i,i.fillPattern,i.displayFrame.width*i.tileScaleX,i.displayFrame.height*i.tileScaleY,i.x,i.y,r,a,i.scaleX,i.scaleY,i.rotation,i.flipX,i.flipY,i.scrollFactorX,i.scrollFactorY,i.originX*r,i.originY*a,0,0,r,a,o(i.tintTopLeft,n.alpha*i._alphaTL),o(i.tintTopRight,n.alpha*i._alphaTR),o(i.tintBottomLeft,n.alpha*i._alphaBL),o(i.tintBottomRight,n.alpha*i._alphaBR),i.tintFill,i.tilePositionX%i.displayFrame.width/i.displayFrame.width,i.tilePositionY%i.displayFrame.height/i.displayFrame.height,n,s,!1,l)}},fI}(),mI||(mI=1,gI=function(t,e,i,n){e.updateCanvas(),i.addToRenderList(e),t.batchSprite(e,e.frame,i,n)}),vI={renderWebGL:t,renderCanvas:gI}}function BV(){if(wI)return xI;wI=1;var t=Dl(),e=Ih(),i=Zu(),n=Nz(),s=hX(),r=kl(),a=IV(),o=kV(),h=wu(),l=new e({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Crop,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.Tint,i.Transform,i.Visible,a],initialize:function(e,i,r,a,l,u,c){var d=e.sys.renderer;n.call(this,e,"TileSprite");var f=e.sys.textures.get(u),p=f.get(c);p.source.compressionAlgorithm&&(console.warn("TileSprite cannot use compressed texture"),p=(f=e.sys.textures.get("__MISSING")).get()),"DynamicTexture"===f.type&&(console.warn("TileSprite cannot use Dynamic Texture"),p=(f=e.sys.textures.get("__MISSING")).get()),a&&l?(a=Math.floor(a),l=Math.floor(l)):(a=a||p.width,l=l||p.height),this._tilePosition=new h,this._tileScale=new h(1,1),this.dirty=!1,this.renderer=d,this.canvas=t.create(this,a,l),this.context=this.canvas.getContext("2d",{willReadFrequently:!1}),this.displayTexture=f,this.displayFrame=p,this._crop=this.resetCropObject(),this._textureKey=o(),this.texture=e.sys.textures.addCanvas(this._textureKey,this.canvas),this.frame=this.texture.get(),this.potWidth=s(p.width),this.potHeight=s(p.height),this.fillCanvas=t.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d",{willReadFrequently:!1}),this.fillPattern=null,this.setPosition(i,r),this.setSize(a,l),this.setFrame(c),this.setOriginFromFrame(),this.initPipeline(),this.initPostPipeline(!0)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){var e=this.displayTexture.get(t);return this.potWidth=s(e.width),this.potHeight=s(e.height),this.canvas.width=0,e.cutWidth&&e.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.displayFrame=e,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,i=this.fillCanvas,n=this.potWidth,s=this.potHeight;this.renderer&&this.renderer.gl||(n=t.cutWidth,s=t.cutHeight),e.clearRect(0,0,n,s),i.width=n,i.height=s,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,n,s),this.renderer&&this.renderer.gl?(this.fillPattern=this.renderer.canvasToTexture(i,this.fillPattern),this.fillPattern.spectorMetadata={textureKey:"TileSprite Game Object"}):this.fillPattern=e.createPattern(i,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||r.disable(e);var i=this._tileScale.x,n=this._tileScale.y,s=this._tilePosition.x,a=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(i,n),e.translate(-s,-a),e.fillStyle=this.fillPattern,e.fillRect(s,a,this.width/i,this.height/n),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),t.remove(this.canvas),t.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null;var e=this.texture;e&&e.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});return xI=l}function NV(){return TB?bB:(TB=1,Dh(),yB||(yB=1,vB=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),e.pipeline.batchSprite(e,i,n))}),wB||(wB=1,xB=function(t,e,i,n){e.videoTexture&&(i.addToRenderList(e),t.batchSprite(e,e.frame,i,n))}),bB={renderWebGL:vB,renderCanvas:xB})}function zV(){if(SB)return EB;SB=1;var t=Yh(),e=Ih(),i=Zu(),n=Bz(),s=iY(),r=Nz(),a=Gh(),o=mB?gB:(mB=1,gB={COMPLETE:TI?bI:(TI=1,bI="complete"),DECODED:SI?EI:(SI=1,EI="decoded"),DECODED_ALL:CI?_I:(CI=1,_I="decodedall"),DESTROY:MI?AI:(MI=1,AI="destroy"),DETUNE:RI?PI:(RI=1,PI="detune"),GLOBAL_DETUNE:OI?LI:(OI=1,LI="detune"),GLOBAL_MUTE:kI?FI:(kI=1,FI="mute"),GLOBAL_RATE:II?DI:(II=1,DI="rate"),GLOBAL_VOLUME:NI?BI:(NI=1,BI="volume"),LOOP:UI?zI:(UI=1,zI="loop"),LOOPED:XI?YI:(XI=1,YI="looped"),MUTE:HI?GI:(HI=1,GI="mute"),PAN:VI?WI:(VI=1,WI="pan"),PAUSE_ALL:qI?jI:(qI=1,jI="pauseall"),PAUSE:ZI?KI:(ZI=1,KI="pause"),PLAY:JI?$I:(JI=1,$I="play"),RATE:tB?QI:(tB=1,QI="rate"),RESUME_ALL:iB?eB:(iB=1,eB="resumeall"),RESUME:sB?nB:(sB=1,nB="resume"),SEEK:aB?rB:(aB=1,rB="seek"),STOP_ALL:hB?oB:(hB=1,oB="stopall"),STOP:uB?lB:(uB=1,lB="stop"),UNLOCKED:dB?cB:(dB=1,cB="unlocked"),VOLUME:pB?fB:(pB=1,fB="volume")}),h=kV(),l=NV(),u=new e({Extends:r,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.ScrollFactor,i.TextureCrop,i.Tint,i.Transform,i.Visible,l],initialize:function(t,e,i,n){r.call(this,t,"Video"),this.video,this.videoTexture,this.videoTextureSource,this.snapshotTexture,this.flipY=!1,this._key=h(),this.touchLocked=!1,this.playWhenUnlocked=!1,this.frameReady=!1,this.isStalled=!1,this.failedPlayAttempts=0,this.metadata,this.retry=0,this.retryInterval=500,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={ended:this.completeHandler.bind(this),legacy:this.legacyPlayHandler.bind(this),playing:this.playingHandler.bind(this),seeked:this.seekedHandler.bind(this),seeking:this.seekingHandler.bind(this),stalled:this.stalledHandler.bind(this),suspend:this.stalledHandler.bind(this),waiting:this.stalledHandler.bind(this)},this._loadCallbackHandler=this.loadErrorHandler.bind(this),this._metadataCallbackHandler=this.metadataHandler.bind(this),this._crop=this.resetCropObject(),this.markers={},this._markerIn=0,this._markerOut=0,this._playingMarker=!1,this._lastUpdate=0,this.cacheKey="",this.isSeeking=!1,this._playCalled=!1,this._getFrame=!1,this._rfvCallbackId=0;var a=t.sys.game;this._device=a.device.video,this.setPosition(e,i),this.setSize(256,256),this.initPipeline(),this.initPostPipeline(!0),a.events.on(s.PAUSE,this.globalPause,this),a.events.on(s.RESUME,this.globalResume,this);var l=t.sys.sound;l&&l.on(o.GLOBAL_MUTE,this.globalMute,this),n&&this.load(n)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},load:function(t){var e=this.scene.sys.cache.video.get(t);return e?(this.cacheKey=t,this.loadHandler(e.url,e.noAudio,e.crossOrigin)):console.warn("No video in cache for key: "+t),this},changeSource:function(t,e,i,n,s){void 0===e&&(e=!0),void 0===i&&(i=!1),this.cacheKey!==t&&(this.load(t),e&&this.play(i,n,s))},getVideoKey:function(){return this.cacheKey},loadURL:function(t,e,i){void 0===e&&(e=!1);var n=this._device.getVideoURL(t);return n?(this.cacheKey="",this.loadHandler(n.url,e,i)):console.warn("No supported video format found for "+t),this},loadMediaStream:function(t,e,i){return this.loadHandler(null,e,i,t)},loadHandler:function(t,e,i,n){e||(e=!1);var s=this.video;if(s?(this.removeLoadEventHandlers(),this.stop()):((s=document.createElement("video")).controls=!1,s.setAttribute("playsinline","playsinline"),s.setAttribute("preload","auto"),s.setAttribute("disablePictureInPicture","true")),e?(s.muted=!0,s.defaultMuted=!0,s.setAttribute("autoplay","autoplay")):(s.muted=!1,s.defaultMuted=!1,s.removeAttribute("autoplay")),i?s.setAttribute("crossorigin",i):s.removeAttribute("crossorigin"),n)if("srcObject"in s)try{s.srcObject=n}catch(t){if("TypeError"!==t.name)throw t;s.src=URL.createObjectURL(n)}else s.src=URL.createObjectURL(n);else s.src=t;this.retry=0,this.video=s,this._playCalled=!1,s.load(),this.addLoadEventHandlers();var r=this.scene.sys.textures.get(this._key);return this.setTexture(r),this},requestVideoFrame:function(t,e){var i=this.video;if(i){var s=e.width,r=e.height,a=this.videoTexture,o=this.videoTextureSource,h=!a||o.source!==i;h?(this._codePaused=i.paused,this._codeMuted=i.muted,a?(o.source=i,o.width=s,o.height=r,a.get().setSize(s,r)):((a=this.scene.sys.textures.create(this._key,i,s,r)).add("__BASE",0,0,0,s,r),this.setTexture(a),this.videoTexture=a,this.videoTextureSource=a.source[0],this.videoTextureSource.setFlipY(this.flipY),this.emit(n.VIDEO_TEXTURE,this,a)),this.setSizeToFrame(),this.updateDisplayOrigin()):o.update(),this.isStalled=!1,this.metadata=e;var l=e.mediaTime;h&&(this._lastUpdate=l,this.emit(n.VIDEO_CREATED,this,s,r),this.frameReady||(this.frameReady=!0,this.emit(n.VIDEO_PLAY,this))),this._playingMarker?l>=this._markerOut&&(i.loop?(i.currentTime=this._markerIn,this.emit(n.VIDEO_LOOP,this)):(this.stop(!1),this.emit(n.VIDEO_COMPLETE,this))):l<this._lastUpdate&&this.emit(n.VIDEO_LOOP,this),this._lastUpdate=l,this._getFrame?(this.removeEventHandlers(),i.pause(),this._getFrame=!1):this._rfvCallbackId=this.video.requestVideoFrameCallback(this.requestVideoFrame.bind(this))}},play:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=a.MAX_SAFE_INTEGER);var n=this.video;return!n||this.isPlaying()?(n||console.warn("Video not loaded"),this):(void 0===t&&(t=n.loop),n.loop=t,this._markerIn=e,this._markerOut=i,this._playingMarker=e>-1&&i>e&&i<a.MAX_SAFE_INTEGER,this._playCalled||(this._getFrame=!1,this._rfvCallbackId=n.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this._playCalled=!0,this.createPlayPromise()),this)},getFirstFrame:function(){var t=this.video;return!t||this.isPlaying()?(t||console.warn("Video not loaded"),this):(this._playCalled||(this._getFrame=!0,this._rfvCallbackId=t.requestVideoFrameCallback(this.requestVideoFrame.bind(this)),this.createPlayPromise()),this)},addLoadEventHandlers:function(){var t=this.video;t&&(t.addEventListener("error",this._loadCallbackHandler),t.addEventListener("abort",this._loadCallbackHandler),t.addEventListener("loadedmetadata",this._metadataCallbackHandler))},removeLoadEventHandlers:function(){var t=this.video;t&&(t.removeEventListener("error",this._loadCallbackHandler),t.removeEventListener("abort",this._loadCallbackHandler))},addEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.addEventListener(i,e[i])}},removeEventHandlers:function(){var t=this.video;if(t){var e=this._callbacks;for(var i in e)t.removeEventListener(i,e[i])}},createPlayPromise:function(t){void 0===t&&(t=!0);var e=this.video,i=e.play();if(void 0!==i){var n=this.playSuccess.bind(this),s=this.playError.bind(this);if(!t){var r=this;s=function(){r.failedPlayAttempts++}}i.then(n).catch(s)}else e.addEventListener("playing",this._callbacks.legacy),t||this.failedPlayAttempts++},addMarker:function(t,e,i){return!isNaN(e)&&e>=0&&!isNaN(i)&&i>e&&(this.markers[t]=[e,i]),this},playMarker:function(t,e){var i=this.markers[t];return i&&this.play(e,i[0],i[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,i,n,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.width),void 0===n&&(n=this.height),void 0===s&&(s=i),void 0===r&&(r=n);var a=this.video,o=this.snapshotTexture;return o?(o.setSize(s,r),a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)):(o=this.scene.sys.textures.createCanvas(h(),s,r),this.snapshotTexture=o,a&&o.context.drawImage(a,t,e,i,n,0,0,s,r)),o.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},playSuccess:function(){if(this._playCalled){this.addEventHandlers(),this._codePaused=!1,this.touchLocked&&(this.touchLocked=!1,this.emit(n.VIDEO_UNLOCKED,this));var t=this.scene.sys.sound;t&&t.mute&&this.setMute(!0),this._markerIn>-1&&(this.video.currentTime=this._markerIn)}},playError:function(t){var e=t.name;"NotAllowedError"===e?(this.touchLocked=!0,this.playWhenUnlocked=!0,this.failedPlayAttempts=1,this.emit(n.VIDEO_LOCKED,this)):"NotSupportedError"===e?(this.stop(!1),this.emit(n.VIDEO_UNSUPPORTED,this,t)):(this.stop(!1),this.emit(n.VIDEO_ERROR,this,t))},legacyPlayHandler:function(){var t=this.video;t&&(this.playSuccess(),t.removeEventListener("playing",this._callbacks.legacy))},playingHandler:function(){this.isStalled=!1,this.emit(n.VIDEO_PLAYING,this)},loadErrorHandler:function(t){this.stop(!1),this.emit(n.VIDEO_ERROR,this,t)},metadataHandler:function(t){this.emit(n.VIDEO_METADATA,this,t)},setSizeToFrame:function(t){t||(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,1!==this.scaleX&&(this.scaleX=this.displayWidth/this.width),1!==this.scaleY&&(this.scaleY=this.displayHeight/this.height);var e=this.input;return e&&!e.customHitArea&&(e.hitArea.width=this.width,e.hitArea.height=this.height),this},stalledHandler:function(t){this.isStalled=!0,this.emit(n.VIDEO_STALLED,this,t)},completeHandler:function(){this._playCalled=!1,this.emit(n.VIDEO_COMPLETE,this)},preUpdate:function(t,e){this.video&&this._playCalled&&this.touchLocked&&this.playWhenUnlocked&&(this.retry+=e,this.retry>=this.retryInterval&&(this.createPlayPromise(!1),this.retry=0))},seekTo:function(t){var e=this.video;if(e){var i=e.duration;if(i!==1/0&&!isNaN(i)){var n=i*t;this.setCurrentTime(n)}}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"==typeof t){var i=t[0],n=parseFloat(t.substr(1));"+"===i?t=e.currentTime+n:"-"===i&&(t=e.currentTime-n)}e.currentTime=t}return this},seekingHandler:function(){this.isSeeking=!0,this.emit(n.VIDEO_SEEKING,this)},seekedHandler:function(){this.isSeeking=!1,this.emit(n.VIDEO_SEEKED,this)},getProgress:function(){var t=this.video;if(t){var e=t.duration;if(e!==1/0&&!isNaN(e))return t.currentTime/e}return-1},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var i=this.video;i&&(i.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&!this.video.ended&&(this.removeEventHandlers(),this.video.pause())},globalResume:function(){this._systemPaused=!1,!this.video||this._codePaused||this.video.ended||this.createPlayPromise()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&!e.ended&&(t?e.paused||(this.removeEventHandlers(),e.pause()):t||(this._playCalled?e.paused&&!this._systemPaused&&this.createPlayPromise():this.play())),this},pause:function(){return this.setPaused(!0)},resume:function(){return this.setPaused(!1)},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(e){return void 0===e&&(e=1),this.video&&(this.video.volume=t(e,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this._playCalled&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&(this.scene.sys.textures.renameTexture(this._key,t),this.videoTextureSource.setFlipY(e)),this._key=t,this.flipY=e,!!this.videoTexture},stop:function(t){void 0===t&&(t=!0);var e=this.video;return e&&(this.removeEventHandlers(),e.cancelVideoFrameCallback(this._rfvCallbackId),e.pause()),this.retry=0,this._playCalled=!1,t&&this.emit(n.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},preDestroy:function(){this.stop(!1),this.removeLoadEventHandlers(),this.removeVideoElement();var t=this.scene.sys.game.events;t.off(s.PAUSE,this.globalPause,this),t.off(s.RESUME,this.globalResume,this);var e=this.scene.sys.sound;e&&e.off(o.GLOBAL_MUTE,this.globalMute,this)}});return EB=u}function UV(){if(CB)return _B;CB=1;var t=Ih(),e=Zu(),i=Nz(),n=bu(),s=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible],initialize:function(t,e,s){void 0===e&&(e="Shape"),i.call(this,t,e),this.geom=s,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new n,this.width=0,this.height=0,this.initPipeline(),this.initPostPipeline()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,i){return void 0===i&&(i=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=i,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}}});return _B=s}function YV(){if(MB)return AB;MB=1;var t=NX();return AB=function(e,i,n,s,r,a){for(var o=t.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*s),h=n.pathData,l=n.pathIndexes,u=0;u<l.length;u+=3){var c=2*l[u],d=2*l[u+1],f=2*l[u+2],p=h[c+0]-r,g=h[c+1]-a,m=h[d+0]-r,v=h[d+1]-a,y=h[f+0]-r,x=h[f+1]-a,w=i.getX(p,g),b=i.getY(p,g),T=i.getX(m,v),E=i.getY(m,v),S=i.getX(y,x),_=i.getY(y,x);e.batchTri(n,w,b,T,E,S,_,0,0,1,1,o,o,o,2)}},AB}function XV(){if(RB)return PB;RB=1;var t=NX();return PB=function(e,i,n,s,r){var a=e.strokeTint,o=t.getTintAppendFloatAlpha(i.strokeColor,i.strokeAlpha*n);a.TL=o,a.TR=o,a.BL=o,a.BR=o;var h=i.pathData,l=h.length-1,u=i.lineWidth,c=u/2,d=h[0]-s,f=h[1]-r;i.closePath||(l-=2);for(var p=2;p<l;p+=2){var g=h[p]-s,m=h[p+1]-r;e.batchLine(d,f,g,m,c,c,u,p-2,!!i.closePath&&p===l-1),d=g,f=m}},PB}function GV(){return kB||(kB=1,FB=function(t,e,i,n){var s=i||e.fillColor,r=n||e.fillAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.fillStyle="rgba("+a+","+o+","+h+","+r+")"}),FB}function HV(){return IB||(IB=1,DB=function(t,e,i,n){var s=i||e.strokeColor,r=n||e.strokeAlpha,a=(16711680&s)>>>16,o=(65280&s)>>>8,h=255&s;t.strokeStyle="rgba("+a+","+o+","+h+","+r+")",t.lineWidth=e.lineWidth}),DB}function WV(){if(UB)return zB;UB=1;var t,e,i=Dh();return t=function(){if(OB)return LB;OB=1;var t=SW(),e=YV(),i=XV();return LB=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&e(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},LB}(),e=function(){if(NB)return BB;NB=1;var t=Ou(),e=GV(),i=HV(),n=PW();return BB=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(n(s,h,r,a,o)){var l=r.radius;h.beginPath(),h.arc(l-r.originX*(2*l),l-r.originY*(2*l),l,t(r._startAngle),t(r._endAngle),r.anticlockwise),r.closePath&&h.closePath(),r.isFilled&&(e(h,r),h.fill()),r.isStroked&&(i(h,r),h.stroke()),h.restore()}},BB}(),zB={renderWebGL:t,renderCanvas:e}}function VV(){if(XB)return YB;XB=1;var t=WV(),e=Ih(),i=Ou(),n=TG(),s=qh(),r=Gh(),a=UV(),o=new e({Extends:a,Mixins:[t],initialize:function(t,e,i,n,r,o,h,l,u){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=128),void 0===r&&(r=0),void 0===o&&(o=360),void 0===h&&(h=!1),a.call(this,t,"Arc",new s(0,0,n)),this._startAngle=r,this._endAngle=o,this._anticlockwise=h,this._iterations=.01,this.setPosition(e,i);var c=2*this.geom.radius;this.setSize(c,c),void 0!==l&&this.setFillStyle(l,u),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,s=this.geom.radius,a=i(this._startAngle),o=i(this._endAngle),h=s,l=s;o-=a,this._anticlockwise?o<-r.PI2?o=-r.PI2:o>0&&(o=-r.PI2+o%r.PI2):o>r.PI2?o=r.PI2:o<0&&(o=r.PI2+o%r.PI2);for(var u,c=[h+Math.cos(a)*s,l+Math.sin(a)*s];e<1;)u=o*e+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),e+=t;return u=o+a,c.push(h+Math.cos(u)*s,l+Math.sin(u)*s),c.push(h+Math.cos(a)*s,l+Math.sin(a)*s),this.pathIndexes=n(c),this.pathData=c,this}});return YB=o}function jV(){if(qB)return jB;qB=1;var t,e,i=Dh();return t=function(){if(HB)return GB;HB=1;var t=YV(),e=SW(),i=XV();return GB=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX+s._curveBounds.x,c=s._displayOriginY+s._curveBounds.y,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},GB}(),e=function(){if(VB)return WB;VB=1;var t=GV(),e=HV(),i=PW();return WB=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX+s._curveBounds.x,l=s._displayOriginY+s._curveBounds.y,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,m=u[p+1]-l;o.lineTo(g,m)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},WB}(),jB={renderWebGL:t,renderCanvas:e}}function qV(){if(ZB)return KB;ZB=1;var t=Ih(),e=jV(),i=TG(),n=Eu(),s=UV(),r=new t({Extends:s,Mixins:[e],initialize:function(t,e,i,r,a,o){void 0===e&&(e=0),void 0===i&&(i=0),s.call(this,t,"Curve",r),this._smoothness=32,this._curveBounds=new n,this.closePath=!1,this.setPosition(e,i),void 0!==a&&this.setFillStyle(a,o),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],s=this.geom.getPoints(e),r=0;r<s.length;r++)n.push(s[r].x,s[r].y);return n.push(s[0].x,s[0].y),this.pathIndexes=i(n),this.pathData=n,this}});return KB=r}function KV(){if(iN)return eN;iN=1;var t,e,i=Dh();return t=function(){if(JB)return $B;JB=1;var t=YV(),e=SW(),i=XV();return $B=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},$B}(),e=function(){if(tN)return QB;tN=1;var t=GV(),e=HV(),i=PW();return QB=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,m=u[p+1]-l;o.lineTo(g,m)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},QB}(),eN={renderWebGL:t,renderCanvas:e}}function ZV(){if(sN)return nN;sN=1;var t=Ih(),e=TG(),i=KV(),n=ZW(),s=UV(),r=new t({Extends:s,Mixins:[i],initialize:function(t,e,i,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===a&&(a=128),s.call(this,t,"Ellipse",new n(r/2,a/2,r,a)),this._smoothness=64,this.setPosition(e,i),this.width=r,this.height=a,void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.width=t,this.height=e,this.geom.setPosition(t/2,e/2),this.geom.setSize(t,e),this.updateDisplayOrigin(),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],i=this.geom.getPoints(this._smoothness),n=0;n<i.length;n++)t.push(i[n].x,i[n].y);return t.push(i[0].x,i[0].y),this.pathIndexes=e(t),this.pathData=t,this}});return nN=r}function $V(){if(uN)return lN;uN=1;var t,e,i=Dh();return t=function(){if(aN)return rN;aN=1;var t=SW(),e=NX();return rN=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc).translate(-n._displayOriginX,-n._displayOriginY);var h,l,u=s.alpha*n.alpha,c=n.width,d=n.height,f=n.cellWidth,p=n.cellHeight,g=Math.ceil(c/f),m=Math.ceil(d/p),v=f,y=p,x=f-(g*f-c),w=p-(m*p-d),b=n.showCells,T=n.showAltCells,E=n.showOutline,S=0,_=0,C=0,A=0,M=0;if(E&&(v--,y--,x===f&&x--,w===p&&w--),i.pipelines.preBatch(n),b&&n.fillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.fillColor,n.fillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<m;_++)for(T&&(C=_%2),S=0;S<g;S++)T&&C?C=0:(C++,A=S<g-1?v:x,M=_<m-1?y:w,a.batchFillRect(S*f,_*p,A,M));if(T&&n.altFillAlpha>0)for(h=a.fillTint,l=e.getTintAppendFloatAlpha(n.altFillColor,n.altFillAlpha*u),h.TL=l,h.TR=l,h.BL=l,h.BR=l,_=0;_<m;_++)for(T&&(C=_%2),S=0;S<g;S++)!T||C?(C=0,A=S<g-1?v:x,M=_<m-1?y:w,a.batchFillRect(S*f,_*p,A,M)):C=1;if(E&&n.outlineFillAlpha>0){var P=a.strokeTint,R=e.getTintAppendFloatAlpha(n.outlineFillColor,n.outlineFillAlpha*u);for(P.TL=R,P.TR=R,P.BL=R,P.BR=R,S=1;S<g;S++){var L=S*f;a.batchLine(L,0,L,d,n.lineWidth,n.lineWidth,1,0,!1)}for(_=1;_<m;_++){var O=_*p;a.batchLine(0,O,c,O,n.lineWidth,n.lineWidth,1,0,!1)}}i.pipelines.postBatch(n)},rN}(),e=function(){if(hN)return oN;hN=1;var t=GV(),e=HV(),i=PW();return oN=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=-s._displayOriginX,l=-s._displayOriginY,u=r.alpha*s.alpha,c=s.width,d=s.height,f=s.cellWidth,p=s.cellHeight,g=Math.ceil(c/f),m=Math.ceil(d/p),v=f,y=p,x=f-(g*f-c),w=p-(m*p-d),b=s.showCells,T=s.showAltCells,E=s.showOutline,S=0,_=0,C=0,A=0,M=0;if(E&&(v--,y--,x===f&&x--,w===p&&w--),b&&s.fillAlpha>0)for(t(o,s),_=0;_<m;_++)for(T&&(C=_%2),S=0;S<g;S++)T&&C?C=0:(C++,A=S<g-1?v:x,M=_<m-1?y:w,o.fillRect(h+S*f,l+_*p,A,M));if(T&&s.altFillAlpha>0)for(t(o,s,s.altFillColor,s.altFillAlpha*u),_=0;_<m;_++)for(T&&(C=_%2),S=0;S<g;S++)!T||C?(C=0,A=S<g-1?v:x,M=_<m-1?y:w,o.fillRect(h+S*f,l+_*p,A,M)):C=1;if(E&&s.outlineFillAlpha>0){for(e(o,s,s.outlineFillColor,s.outlineFillAlpha*u),S=1;S<g;S++){var P=S*f;o.beginPath(),o.moveTo(P+h,l),o.lineTo(P+h,d+l),o.stroke()}for(_=1;_<m;_++){var R=_*p;o.beginPath(),o.moveTo(h,R+l),o.lineTo(h+c,R+l),o.stroke()}}o.restore()}},oN}(),lN={renderWebGL:t,renderCanvas:e}}function JV(){if(dN)return cN;dN=1;var t=Ih(),e=UV(),i=$V(),n=new t({Extends:e,Mixins:[i],initialize:function(t,i,n,s,r,a,o,h,l,u,c){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=128),void 0===r&&(r=128),void 0===a&&(a=32),void 0===o&&(o=32),e.call(this,t,"Grid",null),this.cellWidth=a,this.cellHeight=o,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.altFillColor,this.altFillAlpha,this.setPosition(i,n),this.setSize(s,r),this.setFillStyle(h,l),void 0!==u&&this.setOutlineStyle(u,c),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});return cN=n}function QV(){if(yN)return vN;yN=1;var t,e,i=Dh();return t=function(){if(pN)return fN;pN=1;var t=SW(),e=NX();return fN=function(i,n,s,r){s.addToRenderList(n);var a,o,h,l,u,c,d,f,p,g=i.pipelines.set(n.pipeline),m=t(n,s,r),v=g.calcMatrix.copyFrom(m.calc),y=n.width,x=n.height,w=y/2,b=y/n.projection,T=s.alpha*n.alpha;n.isFilled&&(i.pipelines.preBatch(n),n.showTop&&(a=e.getTintAppendFloatAlpha(n.fillTop,T),o=v.getX(-w,-x),h=v.getY(-w,-x),l=v.getX(0,-b-x),u=v.getY(0,-b-x),c=v.getX(w,-x),d=v.getY(w,-x),f=v.getX(0,b-x),p=v.getY(0,b-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showLeft&&(a=e.getTintAppendFloatAlpha(n.fillLeft,T),o=v.getX(-w,0),h=v.getY(-w,0),l=v.getX(0,b),u=v.getY(0,b),c=v.getX(0,b-x),d=v.getY(0,b-x),f=v.getX(-w,-x),p=v.getY(-w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),n.showRight&&(a=e.getTintAppendFloatAlpha(n.fillRight,T),o=v.getX(w,0),h=v.getY(w,0),l=v.getX(0,b),u=v.getY(0,b),c=v.getX(0,b-x),d=v.getY(0,b-x),f=v.getX(w,-x),p=v.getY(w,-x),g.batchQuad(n,o,h,l,u,c,d,f,p,0,0,1,1,a,a,a,a,2)),i.pipelines.postBatch(n))},fN}(),e=function(){if(mN)return gN;mN=1;var t=GV(),e=PW();return gN=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection;n.showTop&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(l,-1),a.lineTo(0,u-1),a.lineTo(-l,-1),a.lineTo(-l,-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(-l,-h),a.lineTo(-l,0),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h),a.lineTo(l,-h),a.lineTo(l,0),a.fill()),a.restore()}},gN}(),vN={renderWebGL:t,renderCanvas:e}}function tj(){if(wN)return xN;wN=1;var t=QV(),e=Ih(),i=UV(),n=new e({Extends:i,Mixins:[t],initialize:function(t,e,n,s,r,a,o,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=15658734),void 0===o&&(o=10066329),void 0===h&&(h=13421772),i.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=a,this.fillLeft=o,this.fillRight=h,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return xN=n}function ej(){if(CN)return _N;CN=1;var t,e,i=Dh();return t=function(){if(TN)return bN;TN=1;var t=SW(),e=NX();return bN=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r),h=a.calcMatrix.copyFrom(o.calc),l=n.width,u=n.height,c=l/2,d=l/n.projection,f=n.isReversed,p=s.alpha*n.alpha;if(n.isFilled){var g,m,v,y,x,w,b;if(i.pipelines.preBatch(n),n.showTop&&f){g=e.getTintAppendFloatAlpha(n.fillTop,p),m=h.getX(-c,-u),v=h.getY(-c,-u),y=h.getX(0,-d-u),x=h.getY(0,-d-u),w=h.getX(c,-u),b=h.getY(c,-u);var T=h.getX(0,d-u),E=h.getY(0,d-u);a.batchQuad(n,m,v,y,x,w,b,T,E,0,0,1,1,g,g,g,g,2)}n.showLeft&&(g=e.getTintAppendFloatAlpha(n.fillLeft,p),f?(m=h.getX(-c,-u),v=h.getY(-c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)):(m=h.getX(-c,0),v=h.getY(-c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)),a.batchTri(n,m,v,y,x,w,b,0,0,1,1,g,g,g,2)),n.showRight&&(g=e.getTintAppendFloatAlpha(n.fillRight,p),f?(m=h.getX(c,-u),v=h.getY(c,-u),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)):(m=h.getX(c,0),v=h.getY(c,0),y=h.getX(0,d),x=h.getY(0,d),w=h.getX(0,d-u),b=h.getY(0,d-u)),a.batchTri(n,m,v,y,x,w,b,0,0,1,1,g,g,g,2)),i.pipelines.postBatch(n)}},bN}(),e=function(){if(SN)return EN;SN=1;var t=GV(),e=PW();return EN=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)&&n.isFilled){var o=n.width,h=n.height,l=o/2,u=o/n.projection,c=n.isReversed;n.showTop&&c&&(t(a,n,n.fillTop),a.beginPath(),a.moveTo(-l,-h),a.lineTo(0,-u-h),a.lineTo(l,-h),a.lineTo(0,u-h),a.fill()),n.showLeft&&(t(a,n,n.fillLeft),a.beginPath(),c?(a.moveTo(-l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(-l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),n.showRight&&(t(a,n,n.fillRight),a.beginPath(),c?(a.moveTo(l,-h),a.lineTo(0,u),a.lineTo(0,u-h)):(a.moveTo(l,0),a.lineTo(0,u),a.lineTo(0,u-h)),a.fill()),a.restore()}},EN}(),_N={renderWebGL:t,renderCanvas:e}}function ij(){if(MN)return AN;MN=1;var t=Ih(),e=ej(),i=UV(),n=new t({Extends:i,Mixins:[e],initialize:function(t,e,n,s,r,a,o,h,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=48),void 0===r&&(r=32),void 0===a&&(a=!1),void 0===o&&(o=15658734),void 0===h&&(h=10066329),void 0===l&&(l=13421772),i.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=o,this.fillLeft=h,this.fillRight=l,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=a,this.isFilled=!0,this.setPosition(e,n),this.setSize(s,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),this.showTop=t,this.showLeft=e,this.showRight=i,this},setFillStyle:function(t,e,i){return this.fillTop=t,this.fillLeft=e,this.fillRight=i,this.isFilled=!0,this}});return AN=n}function nj(){if(kN)return FN;kN=1;var t,e,i=Dh();return t=function(){if(RN)return PN;RN=1;var t=SW(),e=NX();return PN=function(i,n,s,r){s.addToRenderList(n);var a=i.pipelines.set(n.pipeline),o=t(n,s,r);a.calcMatrix.copyFrom(o.calc);var h=n._displayOriginX,l=n._displayOriginY,u=s.alpha*n.alpha;if(i.pipelines.preBatch(n),n.isStroked){var c=a.strokeTint,d=e.getTintAppendFloatAlpha(n.strokeColor,n.strokeAlpha*u);c.TL=d,c.TR=d,c.BL=d,c.BR=d,a.batchLine(n.geom.x1-h,n.geom.y1-l,n.geom.x2-h,n.geom.y2-l,n._startWidth/2,n._endWidth/2,1,0,!1,o.sprite,o.camera)}i.pipelines.postBatch(n)},PN}(),e=function(){if(ON)return LN;ON=1;var t=HV(),e=PW();return LN=function(i,n,s,r){s.addToRenderList(n);var a=i.currentContext;if(e(i,a,n,s,r)){var o=n._displayOriginX,h=n._displayOriginY;n.isStroked&&(t(a,n),a.beginPath(),a.moveTo(n.geom.x1-o,n.geom.y1-h),a.lineTo(n.geom.x2-o,n.geom.y2-h),a.stroke()),a.restore()}},LN}(),FN={renderWebGL:t,renderCanvas:e}}function sj(){if(IN)return DN;IN=1;var t=Ih(),e=UV(),i=bu(),n=nj(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=128),void 0===h&&(h=0),e.call(this,t,"Line",new i(r,a,o,h));var c=Math.max(1,this.geom.right-this.geom.left),d=Math.max(1,this.geom.bottom-this.geom.top);this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(n,s),this.setSize(c,d),void 0!==l&&this.setStrokeStyle(1,l,u),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,i,n){return this.geom.setTo(t,e,i,n),this}});return DN=s}function rj(){if(XN)return YN;XN=1;var t,e,i=Dh();return t=function(){if(NN)return BN;NN=1;var t=YV(),e=SW(),i=XV();return BN=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},BN}(),e=function(){if(UN)return zN;UN=1;var t=GV(),e=HV(),i=PW();return zN=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,m=u[p+1]-l;o.lineTo(g,m)}s.closePath&&o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},zN}(),YN={renderWebGL:t,renderCanvas:e}}function aj(){if(HN)return GN;HN=1;var t=Eu();return GN=function(e,i){void 0===i&&(i=new t);for(var n,s=1/0,r=1/0,a=-s,o=-r,h=0;h<e.points.length;h++)n=e.points[h],s=Math.min(s,n.x),r=Math.min(r,n.y),a=Math.max(a,n.x),o=Math.max(o,n.y);return i.x=s,i.y=r,i.width=a-s,i.height=o-r,i},GN}function oj(){return VN||(VN=1,WN=function(t,e,i){for(var n=!1,s=-1,r=t.points.length-1;++s<t.points.length;r=s){var a=t.points[s].x,o=t.points[s].y,h=t.points[r].x,l=t.points[r].y;(o<=i&&i<l||l<=i&&i<o)&&e<(h-a)*(i-o)/(l-o)+a&&(n=!n)}return n}),WN}function hj(){if(qN)return jN;qN=1;var t=mu(),e=bu();return jN=function(i){for(var n=i.points,s=0,r=0;r<n.length;r++){var a=n[r],o=n[(r+1)%n.length],h=new e(a.x,a.y,o.x,o.y);s+=t(h)}return s},jN}function lj(){if(ZN)return KN;ZN=1;var t=mu(),e=bu(),i=hj();return KN=function(n,s,r,a){void 0===a&&(a=[]);var o=n.points,h=i(n);!s&&r>0&&(s=h/r);for(var l=0;l<s;l++)for(var u=h*(l/s),c=0,d=0;d<o.length;d++){var f=o[d],p=o[(d+1)%o.length],g=new e(f.x,f.y,p.x,p.y),m=t(g);if(!(u<c||u>c+m)){var v=g.getPoint((u-c)/m);a.push(v);break}c+=m}return a},KN}function uj(){if(JN)return $N;JN=1;var t=Ih(),e=oj(),i=lj(),n=Nh(),s=new t({initialize:function(t){this.type=n.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,i){return e(this,t,i)},setTo:function(t){if(this.area=0,this.points=[],"string"==typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,i=0;i<t.length;i++)e={x:0,y:0},"number"==typeof t[i]||"string"==typeof t[i]?(e.x=parseFloat(t[i]),e.y=parseFloat(t[i+1]),i++):Array.isArray(t[i])?(e.x=t[i][0],e.y=t[i][1]):(e.x=t[i].x,e.y=t[i].y),this.points.push(e);return this.calculateArea(),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,i=0,n=0;n<this.points.length-1;n++)t=this.points[n],i+=((e=this.points[n+1]).x-t.x)*(t.y+e.y);return t=this.points[0],e=this.points[this.points.length-1],i+=(t.x-e.x)*(e.y+t.y),this.area=.5*-i,this.area},getPoints:function(t,e,n){return i(this,t,e,n)}});return $N=s}function cj(){if(tz)return QN;tz=1;var t=function(t,e){return t[0]=e[0],t[1]=e[1],t};return QN=function(e){var i,n=[],s=e.points;for(i=0;i<s.length;i++)n.push([s[i].x,s[i].y]);var r=[];for(n.length>0&&r.push(t([0,0],n[0])),i=0;i<n.length-1;i++){var a=n[i],o=n[i+1],h=a[0],l=a[1],u=o[0],c=o[1];r.push([.85*h+.15*u,.85*l+.15*c]),r.push([.15*h+.85*u,.15*l+.85*c])}return n.length>1&&r.push(t([0,0],n[n.length-1])),e.setTo(r)},QN}function dj(){if(iz)return ez;iz=1;var t=rj(),e=Ih(),i=TG(),n=aj(),s=uj(),r=UV(),a=cj(),o=new e({Extends:r,Mixins:[t],initialize:function(t,e,i,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),r.call(this,t,"Polygon",new s(a));var l=n(this.geom);this.setPosition(e,i),this.setSize(l.width,l.height),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)a(this.geom);return this.updateData()},setTo:function(t){this.geom.setTo(t);var e=n(this.geom);return this.setSize(e.width,e.height),this.updateDisplayOrigin(),this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=i(t),this.pathData=t,this}});return ez=o}function fj(){if(hz)return oz;hz=1;var t,e,i=Dh();return t=function(){if(sz)return nz;sz=1;var t=YV(),e=SW(),i=XV(),n=NX();return nz=function(s,r,a,o){a.addToRenderList(r);var h=s.pipelines.set(r.pipeline),l=e(r,a,o);h.calcMatrix.copyFrom(l.calc);var u=r._displayOriginX,c=r._displayOriginY,d=a.alpha*r.alpha;if(s.pipelines.preBatch(r),r.isRounded&&r.isFilled)t(h,l.calc,r,d,u,c);else if(r.isFilled){var f=h.fillTint,p=n.getTintAppendFloatAlpha(r.fillColor,r.fillAlpha*d);f.TL=p,f.TR=p,f.BL=p,f.BR=p,h.batchFillRect(-u,-c,r.width,r.height)}r.isStroked&&i(h,r,d,u,c),s.pipelines.postBatch(r)},nz}(),e=function(){if(az)return rz;az=1;var t=GV(),e=HV(),i=PW(),n=function(t,e,i,n,s,r){var a=Math.min(n/2,s/2),o=Math.min(r,a);0!==o?(t.moveTo(e+o,i),t.lineTo(e+n-o,i),t.arcTo(e+n,i,e+n,i+o,o),t.lineTo(e+n,i+s-o),t.arcTo(e+n,i+s,e+n-o,i+s,o),t.lineTo(e+o,i+s),t.arcTo(e,i+s,e,i+s-o,o),t.lineTo(e,i+o),t.arcTo(e,i,e+o,i,o),t.closePath()):t.rect(e,i,n,s)};return rz=function(s,r,a,o){a.addToRenderList(r);var h=s.currentContext;if(i(s,h,r,a,o)){var l=r._displayOriginX,u=r._displayOriginY;r.isFilled&&(t(h,r),r.isRounded?(h.beginPath(),n(h,-l,-u,r.width,r.height,r.radius),h.fill()):h.fillRect(-l,-u,r.width,r.height)),r.isStroked&&(e(h,r),h.beginPath(),r.isRounded?n(h,-l,-u,r.width,r.height,r.radius):h.rect(-l,-u,r.width,r.height),h.stroke()),h.restore()}},rz}(),oz={renderWebGL:t,renderCanvas:e}}function pj(){if(uz)return lz;uz=1;var t=Ih(),e=TG(),i=Eu(),n=UV(),s=fj(),r=new t({Extends:n,Mixins:[s],initialize:function(t,e,s,r,a,o,h){void 0===e&&(e=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),n.call(this,t,"Rectangle",new i(0,0,r,a)),this.radius=20,this.isRounded=!1,this.setPosition(e,s),this.setSize(r,a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setRounded:function(t){return void 0===t&&(t=16),this.radius=t,this.isRounded=t>0,this.updateRoundedData()},setSize:function(t,e){this.width=t,this.height=e,this.geom.setSize(t,e),this.updateData(),this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},updateData:function(){if(this.isRounded)return this.updateRoundedData();var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),e.getLineD(i),t.push(i.x2,i.y2),this.pathData=t,this},updateRoundedData:function(){var t=[],i=this.width/2,n=this.height/2,s=Math.min(i,n),r=Math.min(this.radius,s),a=i,o=n,h=Math.max(1,Math.floor(r/5));return this.arcTo(t,a-i+r,o-n+r,r,Math.PI,1.5*Math.PI,h),t.push(a+i-r,o-n),this.arcTo(t,a+i-r,o-n+r,r,1.5*Math.PI,2*Math.PI,h),t.push(a+i,o+n-r),this.arcTo(t,a+i-r,o+n-r,r,0,.5*Math.PI,h),t.push(a-i+r,o+n),this.arcTo(t,a-i+r,o+n-r,r,.5*Math.PI,Math.PI,h),t.push(a-i,o-n+r),this.pathIndexes=e(t),this.pathData=t,this},arcTo:function(t,e,i,n,s,r,a){for(var o=(r-s)/a,h=0;h<=a;h++){var l=s+o*h;t.push(e+Math.cos(l)*n,i+Math.sin(l)*n)}}});return lz=r}function gj(){if(mz)return gz;mz=1;var t,e,i=Dh();return t=function(){if(dz)return cz;dz=1;var t=YV(),e=SW(),i=XV();return cz=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=e(s,r,a),l=o.calcMatrix.copyFrom(h.calc),u=s._displayOriginX,c=s._displayOriginY,d=r.alpha*s.alpha;n.pipelines.preBatch(s),s.isFilled&&t(o,l,s,d,u,c),s.isStroked&&i(o,s,d,u,c),n.pipelines.postBatch(s)},cz}(),e=function(){if(pz)return fz;pz=1;var t=GV(),e=HV(),i=PW();return fz=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.pathData,c=u.length-1,d=u[0]-h,f=u[1]-l;o.beginPath(),o.moveTo(d,f),s.closePath||(c-=2);for(var p=2;p<c;p+=2){var g=u[p]-h,m=u[p+1]-l;o.lineTo(g,m)}o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},fz}(),gz={renderWebGL:t,renderCanvas:e}}function mj(){if(yz)return vz;yz=1;var t=gj(),e=Ih(),i=TG(),n=UV(),s=new e({Extends:n,Mixins:[t],initialize:function(t,e,i,s,r,a,o,h){void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=5),void 0===r&&(r=32),void 0===a&&(a=64),n.call(this,t,"Star",null),this._points=s,this._innerRadius=r,this._outerRadius=a,this.setPosition(e,i),this.setSize(2*a,2*a),void 0!==o&&this.setFillStyle(o,h),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,s=this._outerRadius,r=Math.PI/2*3,a=Math.PI/e,o=s,h=s;t.push(o,h+-s);for(var l=0;l<e;l++)t.push(o+Math.cos(r)*s,h+Math.sin(r)*s),r+=a,t.push(o+Math.cos(r)*n,h+Math.sin(r)*n),r+=a;return t.push(o,h+-s),this.pathIndexes=i(t),this.pathData=t,this}});return vz=s}function vj(){return wz||(wz=1,xz=function(t,e,i){var n=t.x3-t.x1,s=t.y3-t.y1,r=t.x2-t.x1,a=t.y2-t.y1,o=e-t.x1,h=i-t.y1,l=n*n+s*s,u=n*r+s*a,c=n*o+s*h,d=r*r+a*a,f=r*o+a*h,p=l*d-u*u,g=0===p?0:1/p,m=(d*c-u*f)*g,v=(l*f-u*c)*g;return m>=0&&v>=0&&m+v<1}),xz}function yj(){if(Tz)return bz;Tz=1;var t=zh(),e=mu();return bz=function(i,n,s){void 0===s&&(s=new t);var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();if(n<=0||n>=1)return s.x=r.x1,s.y=r.y1,s;var h=e(r),l=e(a),u=e(o),c=(h+l+u)*n,d=0;return c<h?(d=c/h,s.x=r.x1+(r.x2-r.x1)*d,s.y=r.y1+(r.y2-r.y1)*d):c>h+l?(d=(c-=h+l)/u,s.x=o.x1+(o.x2-o.x1)*d,s.y=o.y1+(o.y2-o.y1)*d):(d=(c-=h)/l,s.x=a.x1+(a.x2-a.x1)*d,s.y=a.y1+(a.y2-a.y1)*d),s},bz}function xj(){if(Sz)return Ez;Sz=1;var t=mu(),e=zh();return Ez=function(i,n,s,r){void 0===r&&(r=[]);var a=i.getLineA(),o=i.getLineB(),h=i.getLineC(),l=t(a),u=t(o),c=t(h),d=l+u+c;!n&&s>0&&(n=d/s);for(var f=0;f<n;f++){var p=d*(f/n),g=0,m=new e;p<l?(g=p/l,m.x=a.x1+(a.x2-a.x1)*g,m.y=a.y1+(a.y2-a.y1)*g):p>l+u?(g=(p-=l+u)/c,m.x=h.x1+(h.x2-h.x1)*g,m.y=h.y1+(h.y2-h.y1)*g):(g=(p-=l)/u,m.x=o.x1+(o.x2-o.x1)*g,m.y=o.y1+(o.y2-o.y1)*g),r.push(m)}return r},Ez}function wj(){if(Cz)return _z;Cz=1;var t=Ih(),e=vj(),i=yj(),n=xj(),s=Nh(),r=bu(),a=xU(),o=new t({initialize:function(t,e,i,n,r,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),this.type=s.TRIANGLE,this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=r,this.y3=a},contains:function(t,i){return e(this,t,i)},getPoint:function(t,e){return i(this,t,e)},getPoints:function(t,e,i){return n(this,t,e,i)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,i,n,s,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),this.x1=t,this.y1=e,this.x2=i,this.y2=n,this.x3=s,this.y3=r,this},getLineA:function(t){return void 0===t&&(t=new r),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new r),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new r),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e;e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e;e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}}});return _z=o}function bj(){if(Oz)return Lz;Oz=1;var t,e,i=Dh();return t=function(){if(Mz)return Az;Mz=1;var t=SW(),e=XV(),i=NX();return Az=function(n,s,r,a){r.addToRenderList(s);var o=n.pipelines.set(s.pipeline),h=t(s,r,a);o.calcMatrix.copyFrom(h.calc);var l=s._displayOriginX,u=s._displayOriginY,c=r.alpha*s.alpha;if(n.pipelines.preBatch(s),s.isFilled){var d=o.fillTint,f=i.getTintAppendFloatAlpha(s.fillColor,s.fillAlpha*c);d.TL=f,d.TR=f,d.BL=f,d.BR=f;var p=s.geom.x1-l,g=s.geom.y1-u,m=s.geom.x2-l,v=s.geom.y2-u,y=s.geom.x3-l,x=s.geom.y3-u;o.batchFillTriangle(p,g,m,v,y,x,h.sprite,h.camera)}s.isStroked&&e(o,s,c,l,u),n.pipelines.postBatch(s)},Az}(),e=function(){if(Rz)return Pz;Rz=1;var t=GV(),e=HV(),i=PW();return Pz=function(n,s,r,a){r.addToRenderList(s);var o=n.currentContext;if(i(n,o,s,r,a)){var h=s._displayOriginX,l=s._displayOriginY,u=s.geom.x1-h,c=s.geom.y1-l,d=s.geom.x2-h,f=s.geom.y2-l,p=s.geom.x3-h,g=s.geom.y3-l;o.beginPath(),o.moveTo(u,c),o.lineTo(d,f),o.lineTo(p,g),o.closePath(),s.isFilled&&(t(o,s),o.fill()),s.isStroked&&(e(o,s),o.stroke()),o.restore()}},Pz}(),Lz={renderWebGL:t,renderCanvas:e}}function Tj(){if(kz)return Fz;kz=1;var t=Ih(),e=UV(),i=wj(),n=bj(),s=new t({Extends:e,Mixins:[n],initialize:function(t,n,s,r,a,o,h,l,u,c,d){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=128),void 0===o&&(o=64),void 0===h&&(h=0),void 0===l&&(l=128),void 0===u&&(u=128),e.call(this,t,"Triangle",new i(r,a,o,h,l,u));var f=this.geom.right-this.geom.left,p=this.geom.bottom-this.geom.top;this.setPosition(n,s),this.setSize(f,p),void 0!==c&&this.setFillStyle(c,d),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,i,n,s,r){return this.geom.setTo(t,e,i,n,s,r),this.updateData()},updateData:function(){var t=[],e=this.geom,i=this._tempLine;return e.getLineA(i),t.push(i.x1,i.y1,i.x2,i.y2),e.getLineB(i),t.push(i.x2,i.y2),e.getLineC(i),t.push(i.x2,i.y2),this.pathData=t,this}});return Fz=s}var Ej,Sj={};function _j(){if(Ej)return Sj;Ej=1;var t=kW();return Mu().register("blitter",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),Sj}var Cj,Aj={};function Mj(){if(Cj)return Aj;Cj=1;var t=IW();return Mu().register("container",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),Aj}var Pj,Rj={};function Lj(){if(Pj)return Rj;Pj=1;var t=UW();return Mu().register("dom",function(e,i,n,s,r){var a=new t(this.scene,e,i,n,s,r);return this.displayList.add(a),a}),Rj}var Oj,Fj={};function kj(){if(Oj)return Fj;Oj=1;var t=YW();return Mu().register("dynamicBitmapText",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,s,r))}),Fj}var Dj,Ij={};function Bj(){if(Dj)return Ij;Dj=1;var t=GW();return Mu().register("extern",function(){var e=new t(this.scene);return this.displayList.add(e),e}),Ij}var Nj,zj={};function Uj(){if(Nj)return zj;Nj=1;var t=JW();return Mu().register("graphics",function(e){return this.displayList.add(new t(this.scene,e))}),zj}var Yj,Xj={};function Gj(){if(Yj)return Xj;Yj=1;var t=nV();return Mu().register("group",function(e,i){return this.updateList.add(new t(this.scene,e,i))}),Xj}var Hj,Wj={};function Vj(){if(Hj)return Wj;Hj=1;var t=hW();return Mu().register("image",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),Wj}var jj,qj={};function Kj(){if(jj)return qj;jj=1;var t=sV();return Mu().register("layer",function(e){return this.displayList.add(new t(this.scene,e))}),qj}var Zj,$j={};function Jj(){if(Zj)return $j;Zj=1;var t=Mu(),e=EV();return t.register("particles",function(t,i,n,s){return void 0!==t&&"string"==typeof t&&console.warn("ParticleEmitterManager was removed."),this.displayList.add(new e(this.scene,t,i,n,s))}),$j}var Qj,tq={};function eq(){if(Qj)return tq;Qj=1;var t=Mu(),e=SV();return t.register("follower",function(t,i,n,s,r){var a=new e(this.scene,t,i,n,s,r);return this.displayList.add(a),this.updateList.add(a),a}),tq}var iq,nq={};function sq(){if(iq)return nq;iq=1;var t=Mu(),e=_V();return t.register("renderTexture",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),nq}var rq,aq={};function oq(){if(rq)return aq;rq=1;var t=PV();return Mu().register("rope",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),aq}var hq,lq={};function uq(){if(hq)return lq;hq=1;var t=Mu(),e=iV();return t.register("sprite",function(t,i,n,s){return this.displayList.add(new e(this.scene,t,i,n,s))}),lq}var cq,dq={};function fq(){if(cq)return dq;cq=1;var t=LW();return Mu().register("bitmapText",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),dq}var pq,gq={};function mq(){if(pq)return gq;pq=1;var t=DV();return Mu().register("text",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),gq}var vq,yq={};function xq(){if(vq)return yq;vq=1;var t=BV();return Mu().register("tileSprite",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),yq}var wq,bq={};function Tq(){if(wq)return bq;wq=1;var t=zz();return Mu().register("zone",function(e,i,n,s){return this.displayList.add(new t(this.scene,e,i,n,s))}),bq}var Eq,Sq={};function _q(){if(Eq)return Sq;Eq=1;var t=zV();return Mu().register("video",function(e,i,n){return this.displayList.add(new t(this.scene,e,i,n))}),Sq}var Cq,Aq={};function Mq(){if(Cq)return Aq;Cq=1;var t=VV(),e=Mu();return e.register("arc",function(e,i,n,s,r,a,o,h){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h))}),e.register("circle",function(e,i,n,s,r){return this.displayList.add(new t(this.scene,e,i,n,0,360,!1,s,r))}),Aq}var Pq,Rq={};function Lq(){if(Pq)return Rq;Pq=1;var t=Mu(),e=qV();return t.register("curve",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),Rq}var Oq,Fq={};function kq(){if(Oq)return Fq;Oq=1;var t=ZV();return Mu().register("ellipse",function(e,i,n,s,r,a){return this.displayList.add(new t(this.scene,e,i,n,s,r,a))}),Fq}var Dq,Iq={};function Bq(){if(Dq)return Iq;Dq=1;var t=Mu(),e=JV();return t.register("grid",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),Iq}var Nq,zq={};function Uq(){if(Nq)return zq;Nq=1;var t=Mu(),e=tj();return t.register("isobox",function(t,i,n,s,r,a,o){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o))}),zq}var Yq,Xq={};function Gq(){if(Yq)return Xq;Yq=1;var t=Mu(),e=ij();return t.register("isotriangle",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),Xq}var Hq,Wq={};function Vq(){if(Hq)return Wq;Hq=1;var t=Mu(),e=sj();return t.register("line",function(t,i,n,s,r,a,o,h){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h))}),Wq}var jq,qq={};function Kq(){if(jq)return qq;jq=1;var t=Mu(),e=dj();return t.register("polygon",function(t,i,n,s,r){return this.displayList.add(new e(this.scene,t,i,n,s,r))}),qq}var Zq,$q={};function Jq(){if(Zq)return $q;Zq=1;var t=Mu(),e=pj();return t.register("rectangle",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),$q}var Qq,tK={};function eK(){if(Qq)return tK;Qq=1;var t=mj();return Mu().register("star",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),tK}var iK,nK={};function sK(){if(iK)return nK;iK=1;var t=Mu(),e=Tj();return t.register("triangle",function(t,i,n,s,r,a,o,h,l,u){return this.displayList.add(new e(this.scene,t,i,n,s,r,a,o,h,l,u))}),nK}var rK,aK={};function oK(){if(rK)return aK;rK=1;var t=kW(),e=CW(),i=GH(),n=_W();return i.register("blitter",function(i,s){void 0===i&&(i={});var r=n(i,"key",null),a=n(i,"frame",null),o=new t(this.scene,0,0,r,a);return void 0!==s&&(i.add=s),e(this.scene,o,i),o}),aK}var hK,lK={};function uK(){if(hK)return lK;hK=1;var t=CW(),e=IW(),i=GH(),n=_W(),s=kh();return i.register("container",function(i,r){void 0===i&&(i={});var a=n(i,"x",0),o=n(i,"y",0),h=s(i,"children",null),l=new e(this.scene,a,o,h);return void 0!==r&&(i.add=r),t(this.scene,l,i),l}),lK}var cK,dK={};function fK(){if(cK)return dK;cK=1;var t=YW(),e=CW(),i=GH(),n=_W();return i.register("dynamicBitmapText",function(i,s){void 0===i&&(i={});var r=n(i,"font",""),a=n(i,"text",""),o=n(i,"size",!1),h=new t(this.scene,0,0,r,a,o);return void 0!==s&&(i.add=s),e(this.scene,h,i),h}),dK}var pK,gK={};function mK(){if(pK)return gK;pK=1;var t=GH(),e=JW();return t.register("graphics",function(t,i){void 0===t&&(t={}),void 0!==i&&(t.add=i);var n=new e(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n}),gK}var vK,yK={};function xK(){if(vK)return yK;vK=1;var t=GH(),e=nV();return t.register("group",function(t){return new e(this.scene,null,t)}),yK}var wK,bK={};function TK(){if(wK)return bK;wK=1;var t=CW(),e=GH(),i=_W(),n=hW();return e.register("image",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"frame",null),o=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,o,e),o}),bK}var EK,SK={};function _K(){if(EK)return SK;EK=1;var t=CW(),e=sV(),i=GH(),n=_W();return i.register("layer",function(i,s){void 0===i&&(i={});var r=n(i,"children",null),a=new e(this.scene,r);return void 0!==s&&(i.add=s),t(this.scene,a,i),a}),SK}var CK,AK={};function MK(){if(CK)return AK;CK=1;var t=CW(),e=GH(),i=_W(),n=kh(),s=EV();return e.register("particles",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=n(e,"config",null),h=new s(this.scene,0,0,a);return void 0!==r&&(e.add=r),t(this.scene,h,e),o&&h.setConfig(o),h}),AK}var PK,RK={};function LK(){if(PK)return RK;PK=1;var t=CW(),e=GH(),i=_W(),n=_V();return e.register("renderTexture",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",32),h=i(e,"height",32),l=new n(this.scene,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),RK}var OK,FK={};function kK(){if(OK)return FK;OK=1;var t=CW(),e=GH(),i=_W(),n=Tl(),s=PV();return e.register("rope",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=i(e,"horizontal",!0),l=n(e,"points",void 0),u=n(e,"colors",void 0),c=n(e,"alphas",void 0),d=new s(this.scene,0,0,a,o,l,h,u,c);return void 0!==r&&(e.add=r),t(this.scene,d,e),d}),FK}var DK,IK={};function BK(){if(DK)return IK;DK=1;var t=CW(),e=AW(),i=GH(),n=_W(),s=iV();return i.register("sprite",function(i,r){void 0===i&&(i={});var a=n(i,"key",null),o=n(i,"frame",null),h=new s(this.scene,0,0,a,o);return void 0!==r&&(i.add=r),t(this.scene,h,i),e(h,i),h}),IK}var NK,zK={};function UK(){if(NK)return zK;NK=1;var t=LW(),e=CW(),i=GH(),n=_W(),s=Tl();return i.register("bitmapText",function(i,r){void 0===i&&(i={});var a=s(i,"font",""),o=n(i,"text",""),h=n(i,"size",!1),l=s(i,"align",0),u=new t(this.scene,0,0,a,o,h,l);return void 0!==r&&(i.add=r),e(this.scene,u,i),u}),zK}var YK,XK={};function GK(){if(YK)return XK;YK=1;var t=CW(),e=GH(),i=_W(),n=DV();return e.register("text",function(e,s){void 0===e&&(e={});var r=i(e,"text",""),a=i(e,"style",null),o=i(e,"padding",null);null!==o&&(a.padding=o);var h=new n(this.scene,0,0,r,a);return void 0!==s&&(e.add=s),t(this.scene,h,e),h.autoRound=i(e,"autoRound",!0),h.resolution=i(e,"resolution",1),h}),XK}var HK,WK={};function VK(){if(HK)return WK;HK=1;var t=CW(),e=GH(),i=_W(),n=BV();return e.register("tileSprite",function(e,s){void 0===e&&(e={});var r=i(e,"x",0),a=i(e,"y",0),o=i(e,"width",512),h=i(e,"height",512),l=i(e,"key",""),u=i(e,"frame",""),c=new n(this.scene,r,a,o,h,l,u);return void 0!==s&&(e.add=s),t(this.scene,c,e),c}),WK}var jK,qK={};function KK(){if(jK)return qK;jK=1;var t=GH(),e=_W(),i=zz();return t.register("zone",function(t){var n=e(t,"x",0),s=e(t,"y",0),r=e(t,"width",1),a=e(t,"height",r);return new i(this.scene,n,s,r,a)}),qK}var ZK,$K,JK,QK,tZ,eZ,iZ,nZ,sZ,rZ,aZ,oZ,hZ,lZ,uZ,cZ,dZ,fZ,pZ,gZ,mZ,vZ,yZ,xZ,wZ,bZ,TZ,EZ,SZ,_Z,CZ,AZ,MZ,PZ,RZ,LZ,OZ,FZ,kZ,DZ,IZ,BZ,NZ,zZ={};function UZ(){if(ZK)return zZ;ZK=1;var t=CW(),e=GH(),i=_W(),n=zV();return e.register("video",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=new n(this.scene,0,0,r);return void 0!==s&&(e.add=s),t(this.scene,a,e),a}),zZ}function YZ(){return JK?$K:(JK=1,$K=function(t,e,i){if(!t||"number"==typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=i,!0;if(-1!==e.indexOf(".")){for(var n=e.split("."),s=t,r=t,a=0;a<n.length;a++){if(!s.hasOwnProperty(n[a]))return!1;r=s,s=s[n[a]]}return r[n[n.length-1]]=i,!0}return!1})}function XZ(){if(sZ)return nZ;sZ=1;var t,e,i=Dh();return t=function(){if(tZ)return QK;tZ=1;var t=SW();return QK=function(e,i,n,s){if(i.shader){if(n.addToRenderList(i),e.pipelines.clear(),i.renderToTexture)i.load(),i.flush();else{var r=t(i,n,s).calc;e.width===i._rendererWidth&&e.height===i._rendererHeight||i.projOrtho(0,e.width,e.height,0),i.load(r.matrix),i.flush()}e.pipelines.rebind()}},QK}(),e=iZ?eZ:(iZ=1,eZ=function(){}),nZ={renderWebGL:t,renderCanvas:e}}function GZ(){if(aZ)return rZ;aZ=1;var t=Ih(),e=Zu(),i=Nz(),n=kh(),s=jo(),r=YZ(),a=XZ(),o=Hu(),h=cl(),l=PX(),u=new t({Extends:i,Mixins:[e.ComputedSize,e.Depth,e.GetBounds,e.Mask,e.Origin,e.ScrollFactor,e.Transform,e.Visible,a],initialize:function(t,e,n,s,r,a,h,u){void 0===n&&(n=0),void 0===s&&(s=0),void 0===r&&(r=128),void 0===a&&(a=128),i.call(this,t,"Shader"),this.blendMode=-1,this.shader;var c=t.sys.renderer;this.renderer=c,this.gl=c.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=c.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this._deferSetShader=null,this._deferProjOrtho=null,this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new o,this._tempMatrix2=new o,this._tempMatrix3=new o,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=c.width,this._rendererHeight=c.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,s),this.setSize(r,a),this.setOrigin(.5,.5),this.setShader(e,h,u),this.renderer.on(l.RESTORE_WEBGL,this.onContextRestored,this)},willRender:function(t){return!!this.renderToTexture||!(i.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(!this.renderToTexture){var i=this.width,n=this.height,s=this.renderer;this.glTexture=s.createTextureFromSource(null,i,n,0),this.framebuffer=s.createFramebuffer(i,n,this.glTexture,!1),this._rendererWidth=i,this._rendererHeight=n,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture))}return this.shader&&(s.pipelines.clear(),this.load(),this.flush(),s.pipelines.rebind()),this},setShader:function(t,e,i){if(this.renderer.contextLost)return this._deferSetShader={key:t,textures:e,textureData:i},this;if(void 0===e&&(e=[]),"string"==typeof t){var n=this.scene.sys.cache.shader;if(!n.has(t))return console.warn("Shader missing: "+t),this;this.shader=n.get(t)}else this.shader=t;var r=this.gl,a=this.renderer;this.program&&a.deleteProgram(this.program);var o=a.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uViewMatrix"),!1,this.viewMatrix),r.uniformMatrix4fv(r.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),r.uniform2f(r.getUniformLocation(o.webGLProgram,"uResolution"),this.width,this.height),this.program=o;var h=new Date,l={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[h.getFullYear(),h.getMonth(),h.getDate(),60*h.getHours()*60+60*h.getMinutes()+h.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.shader.uniforms?this.uniforms=s(!0,{},this.shader.uniforms,l):this.uniforms=l;for(var u=0;u<4;u++)e[u]&&this.setSampler2D("iChannel"+u,e[u],u,i);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,i,n){if(this.renderer.contextLost)this._deferProjOrtho={left:t,right:e,bottom:i,top:n};else{var s=1/(t-e),r=1/(i-n),a=this.projectionMatrix;a[0]=-2*s,a[5]=-2*r,a[10]=-.001,a[12]=(t+e)*s,a[13]=(n+i)*r,a[14]=-0;var o=this.program,h=this.gl;this.renderer.setProgram(o),h.uniformMatrix4fv(h.getUniformLocation(o.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=i}},initUniforms:function(){var t=this.renderer.glFuncMap,e=this.program;for(var i in this._textureCount=0,this.uniforms){var n=this.uniforms[i],s=n.type,r=t[s];n.uniformLocation=this.renderer.createUniformLocation(e,i),"sampler2D"!==s&&(n.glMatrix=r.matrix,n.glValueLength=r.length,n.glFunc=r.func)}},setSampler2DBuffer:function(t,e,i,n,s,r){void 0===s&&(s=0),void 0===r&&(r={});var a=this.uniforms[t];return a.value=e,r.width=i,r.height=n,a.textureData=r,this._textureCount=s,this.initSampler2D(a),this},setSampler2D:function(t,e,i,n){void 0===i&&(i=0);var s=this.scene.sys.textures;if(s.exists(e)){var r=s.getFrame(e);if(r.glTexture&&r.glTexture.isRenderTexture)return this.setSampler2DBuffer(t,r.glTexture,r.width,r.height,i,n);var a=this.uniforms[t],o=r.source;a.textureKey=e,a.source=o.image,a.value=r.glTexture,o.isGLTexture&&(n||(n={}),n.width=o.width,n.height=o.height),n&&(a.textureData=n),this._textureCount=i,this.initSampler2D(a)}return this},setUniform:function(t,e){return r(this.uniforms,t,e),this},getUniform:function(t){return n(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=t.textureData;if(e&&!t.value.isRenderTexture){var i=this.gl,s=t.value,r=i[n(e,"magFilter","linear").toUpperCase()],a=i[n(e,"minFilter","linear").toUpperCase()],o=i[n(e,"wrapS","repeat").toUpperCase()],h=i[n(e,"wrapT","repeat").toUpperCase()],l=i[n(e,"format","rgba").toUpperCase()],u=n(e,"flipY",!1),c=n(e,"width",s.width),d=n(e,"height",s.height),f=n(e,"source",s.pixels);e.repeat&&(o=i.REPEAT,h=i.REPEAT),e.width&&(f=null),s.update(f,c,d,u,o,h,a,r,l)}this.renderer.setProgram(this.program),this._textureCount++}},syncUniforms:function(){var t,e,i,n,s,r=this.gl,a=this.uniforms,o=0;for(var h in a)i=(t=a[h]).glFunc,e=t.glValueLength,n=t.uniformLocation,null!==(s=t.value)&&(1===e?t.glMatrix?i.call(r,n.webGLUniformLocation,t.transpose,s):i.call(r,n.webGLUniformLocation,s):2===e?i.call(r,n.webGLUniformLocation,s.x,s.y):3===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z):4===e?i.call(r,n.webGLUniformLocation,s.x,s.y,s.z,s.w):"sampler2D"===t.type&&(r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,s.webGLTexture),r.uniform1i(n.webGLUniformLocation,o),o++))},load:function(t){var e=this.gl,i=this.width,n=this.height,s=this.renderer,r=this.program,a=this.viewMatrix;if(!this.renderToTexture){var o=-this._displayOriginX,h=-this._displayOriginY;a[0]=t[0],a[1]=t[1],a[4]=t[2],a[5]=t[3],a[8]=t[4],a[9]=t[5],a[12]=a[0]*o+a[4]*h,a[13]=a[1]*o+a[5]*h}e.useProgram(r.webGLProgram),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uViewMatrix"),!1,a),e.uniformMatrix4fv(e.getUniformLocation(r.webGLProgram,"uProjectionMatrix"),!1,this.projectionMatrix),e.uniform2f(e.getUniformLocation(r.webGLProgram,"uResolution"),this.width,this.height);var l=this.uniforms,u=l.resolution;u.value.x=i,u.value.y=n,l.time.value=s.game.loop.getDuration();var c=this.pointer;if(c){var d=l.mouse,f=c.x/i,p=1-c.y/n;d.value.x=f.toFixed(2),d.value.y=p.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,i=this.program,n=this.gl,s=this.vertexBuffer,r=this.renderer,a=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(r.setFramebuffer(this.framebuffer),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),n.bindBuffer(n.ARRAY_BUFFER,s.webGLBuffer);var o=n.getAttribLocation(i.webGLProgram,"inPosition");-1!==o&&(n.enableVertexAttribArray(o),n.vertexAttribPointer(o,2,n.FLOAT,!1,a,0));var h=this.vertexViewF32;h[3]=e,h[4]=t,h[5]=e,h[8]=t,h[9]=e,h[10]=t,n.bufferSubData(n.ARRAY_BUFFER,0,this.bytes.subarray(0,6*a)),n.drawArrays(n.TRIANGLES,0,6),this.renderToTexture&&r.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},onContextRestored:function(){if(null!==this._deferSetShader){var t=this._deferSetShader.key,e=this._deferSetShader.textures,i=this._deferSetShader.textureData;this._deferSetShader=null,this.setShader(t,e,i)}if(null!==this._deferProjOrtho){var n=this._deferProjOrtho.left,s=this._deferProjOrtho.right,r=this._deferProjOrtho.bottom,a=this._deferProjOrtho.top;this._deferProjOrtho=null,this.projOrtho(n,s,r,a)}},preDestroy:function(){var t=this.renderer;t.off(l.RESTORE_WEBGL,this.onContextRestored,this),t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(t.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null),h(this.uniforms,function(e){t.deleteUniformLocation(e.uniformLocation),e.uniformLocation=null})}});return rZ=u}function HZ(){if(hZ)return oZ;hZ=1;var t=Ih(),e=Eu(),i=wu();function n(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}var s=new t({initialize:function(t,n,s){this.vertex1=t,this.vertex2=n,this.vertex3=s,this.bounds=new e,this._inCenter=new i},getInCenter:function(t){void 0===t&&(t=!0);var e,i,s,r,a,o,h=this.vertex1,l=this.vertex2,u=this.vertex3;t?(e=h.x,i=h.y,s=l.x,r=l.y,a=u.x,o=u.y):(e=h.vx,i=h.vy,s=l.vx,r=l.vy,a=u.vx,o=u.vy);var c=n(a,o,s,r),d=n(e,i,a,o),f=n(s,r,e,i),p=c+d+f;return this._inCenter.set((e*c+s*d+a*f)/p,(i*c+r*d+o*f)/p)},contains:function(t,e,i){var n=this.vertex1,s=this.vertex2,r=this.vertex3,a=n.vx,o=n.vy,h=s.vx,l=s.vy,u=r.vx,c=r.vy;if(i){var d=i.a,f=i.b,p=i.c,g=i.d,m=i.e,v=i.f;a=n.vx*d+n.vy*p+m,o=n.vx*f+n.vy*g+v,h=s.vx*d+s.vy*p+m,l=s.vx*f+s.vy*g+v,u=r.vx*d+r.vy*p+m,c=r.vx*f+r.vy*g+v}var y=u-a,x=c-o,w=h-a,b=l-o,T=t-a,E=e-o,S=y*y+x*x,_=y*w+x*b,C=y*T+x*E,A=w*w+b*b,M=w*T+b*E,P=S*A-_*_,R=0===P?0:1/P,L=(A*C-_*M)*R,O=(S*M-_*C)*R;return L>=0&&O>=0&&L+O<1},isCounterClockwise:function(t){var e=this.vertex1,i=this.vertex2,n=this.vertex3,s=(i.vx-e.vx)*(n.vy-e.vy)-(i.vy-e.vy)*(n.vx-e.vx);return t<=0?s>=0:s<0},load:function(t,e,i,n,s){return i=this.vertex1.load(t,e,i,n,s),i=this.vertex2.load(t,e,i,n,s),this.vertex3.load(t,e,i,n,s)},transformCoordinatesLocal:function(t,e,i,n){return this.vertex1.transformCoordinatesLocal(t,e,i,n),this.vertex2.transformCoordinatesLocal(t,e,i,n),this.vertex3.transformCoordinatesLocal(t,e,i,n),this},updateBounds:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3,n=this.bounds;return n.x=Math.min(t.vx,e.vx,i.vx),n.y=Math.min(t.vy,e.vy,i.vy),n.width=Math.max(t.vx,e.vx,i.vx)-n.x,n.height=Math.max(t.vy,e.vy,i.vy)-n.y,this},isInView:function(t,e,i,n,s,r,a,o,h,l,u){this.update(n,s,r,a,o,h,l,u);var c=this.vertex1,d=this.vertex2,f=this.vertex3;if(c.ta<=0&&d.ta<=0&&f.ta<=0)return!1;if(e&&!this.isCounterClockwise(i))return!1;var p=this.bounds;p.x=Math.min(c.tx,d.tx,f.tx),p.y=Math.min(c.ty,d.ty,f.ty),p.width=Math.max(c.tx,d.tx,f.tx)-p.x,p.height=Math.max(c.ty,d.ty,f.ty)-p.y;var g=t.x+t.width,m=t.y+t.height;return!(p.width<=0||p.height<=0||t.width<=0||t.height<=0||p.right<t.x||p.bottom<t.y||p.x>g||p.y>m)},scrollUV:function(t,e){return this.vertex1.scrollUV(t,e),this.vertex2.scrollUV(t,e),this.vertex3.scrollUV(t,e),this},scaleUV:function(t,e){return this.vertex1.scaleUV(t,e),this.vertex2.scaleUV(t,e),this.vertex3.scaleUV(t,e),this},setColor:function(t){return this.vertex1.color=t,this.vertex2.color=t,this.vertex3.color=t,this},update:function(t,e,i,n,s,r,a,o){return this.vertex1.update(e,i,n,s,r,a,o,t),this.vertex2.update(e,i,n,s,r,a,o,t),this.vertex3.update(e,i,n,s,r,a,o,t),this},translate:function(t,e){void 0===e&&(e=0);var i=this.vertex1,n=this.vertex2,s=this.vertex3;return i.x+=t,i.y+=e,n.x+=t,n.y+=e,s.x+=t,s.y+=e,this},x:{get:function(){return this.getInCenter().x},set:function(t){var e=this.getInCenter();this.translate(t-e.x,0)}},y:{get:function(){return this.getInCenter().y},set:function(t){var e=this.getInCenter();this.translate(0,t-e.y)}},alpha:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.alpha+e.alpha+i.alpha)/3},set:function(t){this.vertex1.alpha=t,this.vertex2.alpha=t,this.vertex3.alpha=t}},depth:{get:function(){var t=this.vertex1,e=this.vertex2,i=this.vertex3;return(t.vz+e.vz+i.vz)/3}},destroy:function(){this.vertex1=null,this.vertex2=null,this.vertex3=null}});return oZ=s}function WZ(){if(uZ)return lZ;uZ=1;var t=Ih(),e=NX(),i=pX(),n=new t({Extends:i,initialize:function(t,e,n,s,r,a,o,h,l,u){void 0===a&&(a=16777215),void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),i.call(this,t,e,n),this.vx=0,this.vy=0,this.vz=0,this.nx=h,this.ny=l,this.nz=u,this.u=s,this.v=r,this.color=a,this.alpha=o,this.tx=0,this.ty=0,this.ta=0,this.tu=s,this.tv=r},setUVs:function(t,e){return this.u=t,this.v=e,this.tu=t,this.tv=e,this},scrollUV:function(t,e){return this.tu+=t,this.tv+=e,this},scaleUV:function(t,e){return this.tu=this.u*t,this.tv=this.v*e,this},transformCoordinatesLocal:function(t,e,i,n){var s=this.x,r=this.y,a=this.z,o=t.val,h=s*o[0]+r*o[4]+a*o[8]+o[12],l=s*o[1]+r*o[5]+a*o[9]+o[13],u=s*o[2]+r*o[6]+a*o[10]+o[14],c=s*o[3]+r*o[7]+a*o[11]+o[15];this.vx=h/c*e,this.vy=-l/c*i,this.vz=n<=0?u/c:-u/c},resize:function(t,e,i,n,s,r){return this.x=t,this.y=e,this.vx=this.x*i,this.vy=-this.y*n,this.vz=0,s<.5?this.vx+=i*(.5-s):s>.5&&(this.vx-=i*(s-.5)),r<.5?this.vy+=n*(.5-r):r>.5&&(this.vy-=n*(r-.5)),this},update:function(t,e,i,n,s,r,a,o){var h=this.vx*t+this.vy*i+s,l=this.vx*e+this.vy*n+r;return a&&(h=Math.round(h),l=Math.round(l)),this.tx=h,this.ty=l,this.ta=this.alpha*o,this},load:function(t,i,n,s,r){return t[++n]=this.tx,t[++n]=this.ty,t[++n]=this.tu,t[++n]=this.tv,t[++n]=s,t[++n]=r,i[++n]=e.getTintAppendFloatAlpha(this.color,this.ta),n}});return lZ=n}function VZ(){if(dZ)return cZ;dZ=1;var t=HZ(),e=gX(),i=pX(),n=WZ(),s=new i,r=new i,a=new e;return cZ=function(e,i,o,h,l,u,c,d,f,p){void 0===o&&(o=1),void 0===h&&(h=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===f&&(f=0),void 0===p&&(p=!0);var g={faces:[],verts:[]},m=e.materials;s.set(h,l,u),r.set(c,d,f),a.fromRotationXYTranslation(r,s,p);for(var v=0;v<e.models.length;v++)for(var y=e.models[v],x=y.vertices,w=y.textureCoords,b=y.faces,T=0;T<b.length;T++){var E=b[T],S=E.vertices[0],_=E.vertices[1],C=E.vertices[2],A=x[S.vertexIndex],M=x[_.vertexIndex],P=x[C.vertexIndex],R=S.textureCoordsIndex,L=_.textureCoordsIndex,O=C.textureCoordsIndex,F=-1===R?{u:0,v:1}:w[R],k=-1===L?{u:0,v:0}:w[L],D=-1===O?{u:1,v:1}:w[O],I=16777215;""!==E.material&&m[E.material]&&(I=m[E.material]);var B=new n(A.x*o,A.y*o,A.z*o,F.u,F.v,I).transformMat4(a),N=new n(M.x*o,M.y*o,M.z*o,k.u,k.v,I).transformMat4(a),z=new n(P.x*o,P.y*o,P.z*o,D.u,D.v,I).transformMat4(a);g.verts.push(B,N,z),g.faces.push(new t(B,N,z))}return i&&(i.faces=i.faces.concat(g.faces),i.vertices=i.vertices.concat(g.verts)),g},cZ}function jZ(){if(pZ)return fZ;pZ=1;var t=HZ(),e=WZ();return fZ=function(i,n,s,r,a,o,h,l){if(void 0===r&&(r=!1),void 0===o&&(o=16777215),void 0===h&&(h=1),void 0===l&&(l=!1),i.length===n.length||r){var u,c,d,f,p,g,m,v,y,x,w,b={faces:[],vertices:[]},T=r?3:2,E=Array.isArray(o),S=Array.isArray(h);if(Array.isArray(s)&&s.length>0)for(u=0;u<s.length;u++){var _=s[u],C=2*s[u],A=s[u]*T;c=i[A],d=i[A+1],f=r?i[A+2]:0,p=n[C],g=n[C+1],l&&(g=1-g),m=E?o[_]:o,v=S?h[_]:h,y=0,x=0,w=0,a&&(y=a[A],x=a[A+1],w=r?a[A+2]:0),b.vertices.push(new e(c,d,f,p,g,m,v,y,x,w))}else{var M=0,P=0;for(u=0;u<i.length;u+=T)c=i[u],d=i[u+1],f=r?i[u+2]:0,p=n[M],g=n[M+1],m=E?o[P]:o,v=S?h[P]:h,y=0,x=0,w=0,a&&(y=a[u],x=a[u+1],w=r?a[u+2]:0),b.vertices.push(new e(c,d,f,p,g,m,v,y,x,w)),M+=2,P++}for(u=0;u<b.vertices.length;u+=3){var R=b.vertices[u],L=b.vertices[u+1],O=b.vertices[u+2];b.faces.push(new t(R,L,O))}return b}console.warn("GenerateVerts: vertices and uvs count not equal")},fZ}function qZ(){if(wZ)return xZ;wZ=1;var t,e,i=Dh();return t=function(){if(mZ)return gZ;mZ=1;var t=SW();return gZ=function(e,i,n,s){var r=i.faces,a=r.length;if(0!==a){n.addToRenderList(i);var o=e.pipelines.set(i.pipeline,i),h=t(i,n,s).calc;e.pipelines.preBatch(i);for(var l=o.setGameObject(i),u=o.vertexViewF32,c=o.vertexViewU32,d=o.vertexCount*o.currentShader.vertexComponentCount-1,f=i.tintFill,p=[],g=i.debugCallback,m=h.a,v=h.b,y=h.c,x=h.d,w=h.e,b=h.f,T=i.viewPosition.z,E=i.hideCCW,S=n.roundPixels,_=n.alpha*i.alpha,C=0,A=0;A<a;A++){var M=r[A];M.isInView(n,E,T,_,m,v,y,x,w,b,S)&&(o.shouldFlush(3)&&(o.flush(),l=o.setGameObject(i),d=o.vertexCount*o.currentShader.vertexComponentCount-1),d=M.load(u,c,d,l,f),C++,o.vertexCount+=3,o.currentBatch.count=o.vertexCount-o.currentBatch.start,g&&p.push(M))}i.totalFrame+=C,g&&g.call(i,i,p),e.pipelines.postBatch(i)}},gZ}(),e=yZ?vZ:(yZ=1,vZ=function(){}),xZ={renderWebGL:t,renderCanvas:e}}function KZ(){if(TZ)return bZ;TZ=1;var t=Ih(),e=Zu(),i=Ou(),n=HZ(),s=Nz(),r=VZ(),a=jZ(),o=SW(),h=gX(),l=qZ(),u=vX(),c=Gl(),d=pX(),f=WZ(),p=new t({Extends:s,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Size,e.Texture,e.Transform,e.Visible,l],initialize:function(t,e,i,n,r,a,o,l,u,c,f,p){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n="__WHITE"),s.call(this,t,"Mesh"),this.faces=[],this.vertices=[],this.tintFill=!1,this.debugCallback=null,this.debugGraphic=null,this.hideCCW=!0,this.modelPosition=new d,this.modelScale=new d(1,1,1),this.modelRotation=new d,this.dirtyCache=[0,0,0,0,0,0,0,0,0,0,0,0],this.transformMatrix=new h,this.viewPosition=new d,this.viewMatrix=new h,this.projectionMatrix=new h,this.totalRendered=0,this.totalFrame=0,this.ignoreDirtyCache=!1,this.fov,this.displayOriginX=0,this.displayOriginY=0;var g=t.sys.renderer;this.setPosition(e,i),this.setTexture(n,r),this.setSize(g.width,g.height),this.initPipeline(),this.initPostPipeline(),this.setPerspective(g.width,g.height),a&&this.addVertices(a,o,l,u,c,f,p)},addedToScene:function(){this.scene.sys.updateList.add(this)},removedFromScene:function(){this.scene.sys.updateList.remove(this)},panX:function(t){return this.viewPosition.addScale(d.LEFT,t),this.dirtyCache[10]=1,this},panY:function(t){return this.viewPosition.y+=d.DOWN.y*t,this.dirtyCache[10]=1,this},panZ:function(t){return this.viewPosition.z+=t,this.dirtyCache[10]=1,this},setPerspective:function(t,e,n,s,r){return void 0===n&&(n=45),void 0===s&&(s=.01),void 0===r&&(r=1e3),this.fov=n,this.projectionMatrix.perspective(i(n),t/e,s,r),this.dirtyCache[10]=1,this.dirtyCache[11]=0,this},setOrtho:function(t,e,i,n){return void 0===t&&(t=this.scene.sys.renderer.getAspectRatio()),void 0===e&&(e=1),void 0===i&&(i=-1e3),void 0===n&&(n=1e3),this.fov=0,this.projectionMatrix.ortho(-t,t,-e,e,i,n),this.dirtyCache[10]=1,this.dirtyCache[11]=1,this},clear:function(){return this.faces.forEach(function(t){t.destroy()}),this.faces=[],this.vertices=[],this},addVerticesFromObj:function(t,e,i,n,s,a,o,h,l){var u,c=this.scene.sys.cache.obj.get(t);return c&&(u=r(c,this,e,i,n,s,a,o,h,l)),u&&0!==u.verts.length||console.warn("Mesh.addVerticesFromObj data empty:",t),this},sortByDepth:function(t,e){return t.depth-e.depth},depthSort:function(){return c(this.faces,this.sortByDepth),this},addVertex:function(t,e,i,n,s,r,a){var o=new f(t,e,i,n,s,r,a);return this.vertices.push(o),o},addFace:function(t,e,i){var s=new n(t,e,i);return this.faces.push(s),this.dirtyCache[9]=-1,s},addVertices:function(t,e,i,n,s,r,o){var h=a(t,e,i,n,s,r,o);return h?(this.faces=this.faces.concat(h.faces),this.vertices=this.vertices.concat(h.vertices)):console.warn("Mesh.addVertices data empty or invalid"),this.dirtyCache[9]=-1,this},getFaceCount:function(){return this.faces.length},getVertexCount:function(){return this.vertices.length},getFace:function(t){return this.faces[t]},hasFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=0;r<s.length;r++)if(s[r].contains(t,e,n))return!0;return!1},getFaceAt:function(t,e,i){void 0===i&&(i=this.scene.sys.cameras.main);for(var n=o(this,i).calc,s=this.faces,r=[],a=0;a<s.length;a++){var h=s[a];h.contains(t,e,n)&&r.push(h)}return c(r,this.sortByDepth)},setDebug:function(t,e){return this.debugGraphic=t,this.debugCallback=t||e?e||this.renderDebug:null,this},isDirty:function(){var t=this.modelPosition,e=this.modelRotation,i=this.modelScale,n=this.dirtyCache,s=t.x,r=t.y,a=t.z,o=e.x,h=e.y,l=e.z,u=i.x,c=i.y,d=i.z,f=this.getFaceCount(),p=n[0],g=n[1],m=n[2],v=n[3],y=n[4],x=n[5],w=n[6],b=n[7],T=n[8],E=n[9];return n[0]=s,n[1]=r,n[2]=a,n[3]=o,n[4]=h,n[5]=l,n[6]=u,n[7]=c,n[8]=d,n[9]=f,p!==s||g!==r||m!==a||v!==o||y!==h||x!==l||w!==u||b!==c||T!==d||E!==f},preUpdate:function(){this.totalRendered=this.totalFrame,this.totalFrame=0;var t=this.dirtyCache;if(this.ignoreDirtyCache||t[10]||this.isDirty()){var e=this.width,i=this.height,n=this.viewMatrix,s=this.viewPosition;t[10]&&(n.identity(),n.translate(s),n.invert(),t[10]=0);var r=this.transformMatrix;r.setWorldMatrix(this.modelRotation,this.modelPosition,this.modelScale,this.viewMatrix,this.projectionMatrix);for(var a=s.z,o=this.faces,h=0;h<o.length;h++)o[h].transformCoordinatesLocal(r,e,i,a);this.depthSort()}},renderDebug:function(t,e){for(var i=t.debugGraphic,n=0;n<e.length;n++){var s=e[n],r=s.vertex1.tx,a=s.vertex1.ty,o=s.vertex2.tx,h=s.vertex2.ty,l=s.vertex3.tx,u=s.vertex3.ty;i.strokeTriangle(r,a,o,h,l,u)}},preDestroy:function(){this.clear(),this.debugCallback=null,this.debugGraphic=null},clearTint:function(){return this.setTint()},setInteractive:function(t){void 0===t&&(t={});var e=function(t,e,i){for(var n=this.faces,s=0;s<n.length;s++)if(n[s].contains(e,i))return!0;return!1}.bind(this);return this.scene.sys.input.enable(this,t,e),this},setTint:function(t){void 0===t&&(t=16777215);for(var e=this.vertices,i=0;i<e.length;i++)e[i].color=t;return this},uvScroll:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scrollUV(t,e);return this},uvScale:function(t,e){for(var i=this.faces,n=0;n<i.length;n++)i[n].scaleUV(t,e);return this},tint:{set:function(t){this.setTint(t)}},rotateX:{get:function(){return u(this.modelRotation.x)},set:function(t){this.modelRotation.x=i(t)}},rotateY:{get:function(){return u(this.modelRotation.y)},set:function(t){this.modelRotation.y=i(t)}},rotateZ:{get:function(){return u(this.modelRotation.z)},set:function(t){this.modelRotation.z=i(t)}}});return bZ=p}function ZZ(){if(CZ)return _Z;CZ=1;var t,e=Dh(),i=e;return t=function(){if(SZ)return EZ;SZ=1;var t=SW(),e=NX();return EZ=function(i,n,s,r){var a=n.vertices,o=a.length;if(0!==o){s.addToRenderList(n);var h=i.pipelines.set(n.pipeline,n),l=t(n,s,r,!1).calc;i.pipelines.preBatch(n);var u=h.setGameObject(n),c=h.vertexViewF32,d=h.vertexViewU32,f=h.vertexCount*h.currentShader.vertexComponentCount-1,p=s.roundPixels,g=n.tintFill,m=s.alpha*n.alpha,v=e.getTintAppendFloatAlpha(n.tint,m),y=h.vertexAvailable(),x=-1;y<o&&(x=y);for(var w=0;w<o;w++){var b=a[w];w===x&&(h.flush(),u=h.setGameObject(n),f=0),c[++f]=l.getXRound(b.vx,b.vy,p),c[++f]=l.getYRound(b.vx,b.vy,p),c[++f]=b.u,c[++f]=b.v,c[++f]=u,c[++f]=g,d[++f]=v,h.vertexCount++,h.currentBatch.count=h.vertexCount-h.currentBatch.start}i.pipelines.postBatch(n)}},EZ}(),_Z={renderWebGL:t,renderCanvas:i}}function $Z(){if(MZ)return AZ;MZ=1;var t=Ih(),e=Zu(),i=Nz(),n=ZZ(),s=WZ(),r=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.GetBounds,e.Mask,e.Origin,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Texture,e.Transform,e.Visible,n],initialize:function(t,e,n,r,a,o,h,l,u,c,d){i.call(this,t,"NineSlice"),this._width,this._height,this._originX=.5,this._originY=.5,this._sizeComponent=!0,this.vertices=[],this.leftWidth,this.rightWidth,this.topHeight,this.bottomHeight,this.tint=16777215,this.tintFill=!1;var f=t.textures.getFrame(r,a);this.is3Slice=!c&&!d,f&&f.scale9&&(this.is3Slice=f.is3Slice);for(var p=this.is3Slice?18:54,g=0;g<p;g++)this.vertices.push(new s);this.setPosition(e,n),this.setTexture(r,a),this.setSlices(o,h,l,u,c,d,!1),this.updateDisplayOrigin(),this.initPipeline(),this.initPostPipeline()},setSlices:function(t,e,i,n,s,r,a){void 0===i&&(i=10),void 0===n&&(n=10),void 0===s&&(s=0),void 0===r&&(r=0),void 0===a&&(a=!1);var o=this.frame,h=!1;if(this.is3Slice&&a&&0!==s&&0!==r&&(h=!0),h)console.warn("Cannot change 9 slice to 3 slice");else{if(o&&o.scale9&&!a){var l=o.data.scale9Borders,u=l.x,c=l.y;i=u,n=o.width-l.w-u,s=c,r=o.height-l.h-c,void 0===t&&(t=o.width),void 0===e&&(e=o.height)}else void 0===t&&(t=256),void 0===e&&(e=256);this._width=t,this._height=e,this.leftWidth=i,this.rightWidth=n,this.topHeight=s,this.bottomHeight=r,this.is3Slice&&(e=o.height,this._height=e,this.topHeight=e,this.bottomHeight=0),this.updateVertices(),this.updateUVs()}return this},updateUVs:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.frame.width,r=this.frame.height;this.updateQuadUVs(0,0,0,t/s,i/r),this.updateQuadUVs(6,t/s,0,1-e/s,i/r),this.updateQuadUVs(12,1-e/s,0,1,i/r),this.is3Slice||(this.updateQuadUVs(18,0,i/r,t/s,1-n/r),this.updateQuadUVs(24,t/s,i/r,1-e/s,1-n/r),this.updateQuadUVs(30,1-e/s,i/r,1,1-n/r),this.updateQuadUVs(36,0,1-n/r,t/s,1),this.updateQuadUVs(42,t/s,1-n/r,1-e/s,1),this.updateQuadUVs(48,1-e/s,1-n/r,1,1))},updateVertices:function(){var t=this.leftWidth,e=this.rightWidth,i=this.topHeight,n=this.bottomHeight,s=this.width,r=this.height;this.updateQuad(0,-.5,.5,t/s-.5,.5-i/r),this.updateQuad(6,t/s-.5,.5,.5-e/s,.5-i/r),this.updateQuad(12,.5-e/s,.5,.5,.5-i/r),this.is3Slice||(this.updateQuad(18,-.5,.5-i/r,t/s-.5,n/r-.5),this.updateQuad(24,t/s-.5,.5-i/r,.5-e/s,n/r-.5),this.updateQuad(30,.5-e/s,.5-i/r,.5,n/r-.5),this.updateQuad(36,-.5,n/r-.5,t/s-.5,-.5),this.updateQuad(42,t/s-.5,n/r-.5,.5-e/s,-.5),this.updateQuad(48,.5-e/s,n/r-.5,.5,-.5))},updateQuad:function(t,e,i,n,s){var r=this.width,a=this.height,o=this.originX,h=this.originY,l=this.vertices;l[t+0].resize(e,i,r,a,o,h),l[t+1].resize(e,s,r,a,o,h),l[t+2].resize(n,i,r,a,o,h),l[t+3].resize(e,s,r,a,o,h),l[t+4].resize(n,s,r,a,o,h),l[t+5].resize(n,i,r,a,o,h)},updateQuadUVs:function(t,e,i,n,s){var r=this.vertices,a=this.frame,o=a.u0,h=a.v0,l=a.u1,u=a.v1;if(0!==o||1!==l){var c=l-o;e=o+e*c,n=o+n*c}if(0!==h||1!==u){var d=u-h;i=h+i*d,s=h+s*d}r[t+0].setUVs(e,i),r[t+1].setUVs(e,s),r[t+2].setUVs(n,i),r[t+3].setUVs(e,s),r[t+4].setUVs(n,s),r[t+5].setUVs(n,i)},clearTint:function(){return this.setTint(16777215),this},setTint:function(t){return void 0===t&&(t=16777215),this.tint=t,this.tintFill=!1,this},setTintFill:function(t){return this.setTint(t),this.tintFill=!0,this},isTinted:{get:function(){return 16777215!==this.tint}},width:{get:function(){return this._width},set:function(t){this._width=Math.max(t,this.leftWidth+this.rightWidth),this.updateVertices()}},height:{get:function(){return this._height},set:function(t){this.is3Slice||(this._height=Math.max(t,this.topHeight+this.bottomHeight),this.updateVertices())}},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=this.width,i.hitArea.height=this.height),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},originX:{get:function(){return this._originX},set:function(t){this._originX=t,this.updateVertices()}},originY:{get:function(){return this._originY},set:function(t){this._originY=t,this.updateVertices()}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this._originX=t,this._originY=e,this.updateVertices(),this.updateDisplayOrigin()},setSizeToFrame:function(){if(this.is3Slice){var t=this.frame.height;this._height=t,this.topHeight=t,this.bottomHeight=0}return this.updateUVs(),this},preDestroy:function(){this.vertices=[]}});return AZ=r}function JZ(){if(kZ)return FZ;kZ=1;var t=Ih(),e=Zu(),i=Nz(),n=xY(),s=_X(),r=function(){if(OZ)return LZ;OZ=1;var t,e=Dh();return t=function(){if(RZ)return PZ;RZ=1;var t=SW();return PZ=function(e,i,n,s){n.addToRenderList(i);var r=e.pipelines.set(i.pipeline),a=t(i,n,s).calc,o=i.width,h=i.height,l=-i._radius,u=-i._radius,c=l+o,d=u+h,f=a.getX(0,0),p=a.getY(0,0),g=a.getX(l,u),m=a.getY(l,u),v=a.getX(l,d),y=a.getY(l,d),x=a.getX(c,d),w=a.getY(c,d),b=a.getX(c,u),T=a.getY(c,u);e.pipelines.preBatch(i),r.batchPointLight(i,n,g,m,v,y,x,w,b,T,f,p),e.pipelines.postBatch(i)},PZ}(),LZ={renderWebGL:t,renderCanvas:e}}(),a=new t({Extends:i,Mixins:[e.AlphaSingle,e.BlendMode,e.Depth,e.Mask,e.Pipeline,e.PostPipeline,e.ScrollFactor,e.Transform,e.Visible,r],initialize:function(t,e,r,a,o,h,l){void 0===a&&(a=16777215),void 0===o&&(o=128),void 0===h&&(h=1),void 0===l&&(l=.1),i.call(this,t,"PointLight"),this.initPipeline(s.POINTLIGHT_PIPELINE),this.initPostPipeline(),this.setPosition(e,r),this.color=n(a),this.intensity=h,this.attenuation=l,this.width=2*o,this.height=2*o,this._radius=o},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this.width=2*t,this.height=2*t}},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return this._radius}},displayOriginY:{get:function(){return this._radius}}});return FZ=a}function QZ(){if(IZ)return DZ;IZ=1;var t=HZ(),e=kh(),i=gX(),n=pX(),s=WZ(),r=new n,a=new n,o=new i;return DZ=function(i){var n,h=e(i,"mesh"),l=e(i,"texture",null),u=e(i,"frame"),c=e(i,"width",1),d=e(i,"height",c),f=e(i,"widthSegments",1),p=e(i,"heightSegments",f),g=e(i,"x",0),m=e(i,"y",0),v=e(i,"z",0),y=e(i,"rotateX",0),x=e(i,"rotateY",0),w=e(i,"rotateZ",0),b=e(i,"zIsUp",!0),T=e(i,"isOrtho",!!h&&h.dirtyCache[11]),E=e(i,"colors",[16777215]),S=e(i,"alphas",[1]),_=e(i,"tile",!1),C=e(i,"flipY",!1),A=e(i,"width",null),M={faces:[],verts:[]};if(r.set(g,m,v),a.set(y,x,w),o.fromRotationXYTranslation(a,r,b),!l&&h)l=h.texture,u||(n=h.frame);else if(h&&"string"==typeof l)l=h.scene.sys.textures.get(l);else if(!l)return M;n||(n=l.get(u)),!A&&T&&l&&h&&(c=n.width/h.height,d=n.height/h.height);var P,R,L=c/2,O=d/2,F=Math.floor(f),k=Math.floor(p),D=F+1,I=k+1,B=c/F,N=d/k,z=[],U=[],Y=0,X=1,G=0,H=1;n&&(Y=n.u0,X=n.u1,C?(G=n.v1,H=n.v0):(G=n.v0,H=n.v1));var W=X-Y,V=H-G;for(R=0;R<I;R++){var j=R*N-O;for(P=0;P<D;P++){var q=P*B-L;U.push(q,-j);var K=Y+W*(P/F),Z=G+V*(R/k);z.push(K,Z)}}Array.isArray(E)||(E=[E]),Array.isArray(S)||(S=[S]);var $=0,J=0;for(R=0;R<k;R++)for(P=0;P<F;P++){var Q=2*(P+D*R),tt=2*(P+D*(R+1)),et=2*(P+1+D*(R+1)),it=2*(P+1+D*R),nt=E[J],st=S[$],rt=new s(U[Q],U[Q+1],0,z[Q],z[Q+1],nt,st).transformMat4(o),at=new s(U[tt],U[tt+1],0,z[tt],z[tt+1],nt,st).transformMat4(o),ot=new s(U[it],U[it+1],0,z[it],z[it+1],nt,st).transformMat4(o),ht=new s(U[tt],U[tt+1],0,z[tt],z[tt+1],nt,st).transformMat4(o),lt=new s(U[et],U[et+1],0,z[et],z[et+1],nt,st).transformMat4(o),ut=new s(U[it],U[it+1],0,z[it],z[it+1],nt,st).transformMat4(o);_&&(rt.setUVs(Y,H),at.setUVs(Y,G),ot.setUVs(X,H),ht.setUVs(Y,G),lt.setUVs(X,G),ut.setUVs(X,H)),++J===E.length&&(J=0),++$===S.length&&($=0),M.verts.push(rt,at,ot,ht,lt,ut),M.faces.push(new t(rt,at,ot),new t(ht,lt,ut))}return h&&(h.faces=h.faces.concat(M.faces),h.vertices=h.vertices.concat(M.verts)),M},DZ}function t$(){if(NZ)return BZ;NZ=1;var t=rY(),e=Ih(),i=QZ(),n=yY(),s=KZ(),r=kV(),a=new e({Extends:s,initialize:function(e,i,n,r,a,o,h,l){r||(r="__DEFAULT"),s.call(this,e,i,n,r,a),this.type="Plane",this.anims=new t(this),this.gridWidth,this.gridHeight,this.isTiled,this._checkerboard=null,this.hideCCW=!1,this.setGridSize(o,h,l),this.setSizeToFrame(!1),this.setViewHeight()},originX:{get:function(){return.5}},originY:{get:function(){return.5}},setGridSize:function(t,e,n){void 0===t&&(t=8),void 0===e&&(e=8),void 0===n&&(n=!1);var s=!1;return n&&(s=!0),this.gridWidth=t,this.gridHeight=e,this.isTiled=n,this.clear(),i({mesh:this,widthSegments:t,heightSegments:e,isOrtho:!1,tile:n,flipY:s}),this},setSizeToFrame:function(t){void 0===t&&(t=!0);var e=this.frame;if(this.setPerspective(this.width/e.width,this.height/e.height),this._checkerboard&&this._checkerboard!==this.texture&&this.removeCheckerboard(),!t)return this;var i,n,s=this.gridWidth,r=this.gridHeight,a=this.vertices,o=e.u0,h=e.u1,l=e.v0,u=e.v1,c=0;if(this.isTiled)for(l=e.v1,u=e.v0,n=0;n<r;n++)for(i=0;i<s;i++)a[c++].setUVs(o,u),a[c++].setUVs(o,l),a[c++].setUVs(h,u),a[c++].setUVs(o,l),a[c++].setUVs(h,l),a[c++].setUVs(h,u);else{var d=s+1,f=r+1,p=h-o,g=u-l,m=[];for(n=0;n<f;n++)for(i=0;i<d;i++){var v=o+p*(i/s),y=l+g*(n/r);m.push(v,y)}for(n=0;n<r;n++)for(i=0;i<s;i++){var x=2*(i+d*n),w=2*(i+d*(n+1)),b=2*(i+1+d*(n+1)),T=2*(i+1+d*n);a[c++].setUVs(m[x],m[x+1]),a[c++].setUVs(m[w],m[w+1]),a[c++].setUVs(m[T],m[T+1]),a[c++].setUVs(m[w],m[w+1]),a[c++].setUVs(m[b],m[b+1]),a[c++].setUVs(m[T],m[T+1])}}return this},setViewHeight:function(t){void 0===t&&(t=this.frame.height);var e=this.fov*(Math.PI/180);this.viewPosition.z=this.height/t/Math.tan(e/2),this.dirtyCache[10]=1},createCheckerboard:function(t,e,i,s,a){void 0===t&&(t=16777215),void 0===e&&(e=255),void 0===i&&(i=255),void 0===s&&(s=255),void 0===a&&(a=128);for(var o=n(t),h=n(e),l=[],u=0;u<16;u++)for(var c=0;c<16;c++)u<8&&c<8||u>7&&c>7?l.push(o.r,o.g,o.b,i):l.push(h.r,h.g,h.b,s);var d=this.scene.sys.textures.addUint8Array(r(),new Uint8Array(l),16,16);return this.removeCheckerboard(),this.setTexture(d),this.setSizeToFrame(),this.setViewHeight(a),this},removeCheckerboard:function(){this._checkerboard&&(this._checkerboard.destroy(),this._checkerboard=null)},play:function(t,e){return this.anims.play(t,e)},playReverse:function(t,e){return this.anims.playReverse(t,e)},playAfterDelay:function(t,e){return this.anims.playAfterDelay(t,e)},playAfterRepeat:function(t,e){return this.anims.playAfterRepeat(t,e)},stop:function(){return this.anims.stop()},stopAfterDelay:function(t){return this.anims.stopAfterDelay(t)},stopAfterRepeat:function(t){return this.anims.stopAfterRepeat(t)},stopOnFrame:function(t){return this.anims.stopOnFrame(t)},preUpdate:function(t,e){s.prototype.preUpdate.call(this,t,e),this.anims.update(t,e)},preDestroy:function(){this.clear(),this.removeCheckerboard(),this.anims.destroy(),this.anims=void 0,this.debugCallback=null,this.debugGraphic=null}});return BZ=a}var e$,i$,n$,s$,r$,a$,o$,h$,l$,u$,c$,d$,f$,p$,g$,m$,v$,y$,x$,w$,b$,T$,E$,S$,_$,C$,A$,M$,P$,R$,L$,O$,F$,k$,D$,I$,B$,N$,z$,U$,Y$,X$,G$,H$,W$,V$,j$,q$,K$,Z$,$$,J$,Q$,tJ,eJ,iJ,nJ,sJ,rJ,aJ,oJ,hJ,lJ,uJ,cJ,dJ,fJ,pJ,gJ,mJ,vJ,yJ,xJ,wJ,bJ,TJ,EJ,SJ,_J,CJ,AJ,MJ,PJ,RJ,LJ,OJ,FJ,kJ,DJ,IJ,BJ,NJ,zJ,UJ,YJ,XJ,GJ,HJ,WJ,VJ,jJ,qJ,KJ,ZJ,$J,JJ,QJ,tQ,eQ,iQ,nQ,sQ,rQ,aQ,oQ,hQ,lQ,uQ,cQ,dQ,fQ,pQ,gQ,mQ,vQ,yQ,xQ,wQ,bQ,TQ,EQ,SQ,_Q,CQ,AQ,MQ,PQ,RQ,LQ,OQ,FQ,kQ,DQ,IQ,BQ,NQ,zQ,UQ,YQ,XQ,GQ,HQ,WQ,VQ,jQ,qQ,KQ,ZQ,$Q,JQ,QQ,t0,e0,i0,n0,s0,r0,a0,o0,h0,l0,u0,c0,d0,f0,p0,g0,m0,v0,y0,x0,w0,b0,T0,E0,S0,_0,C0,A0,M0,P0,R0,L0,O0,F0,k0,D0,I0,B0,N0,z0,U0,Y0,X0,G0,H0,W0,V0,j0,q0,K0,Z0,$0,J0,Q0,t1,e1,i1,n1,s1,r1,a1,o1,h1,l1,u1,c1,d1,f1,p1,g1,m1,v1,y1,x1,w1,b1,T1,E1,S1,_1,C1,A1,M1,P1,R1,L1,O1,F1,k1,D1,I1,B1,N1,z1,U1,Y1,X1,G1,H1,W1,V1,j1,q1,K1,Z1,$1,J1,Q1,t2,e2,i2,n2,s2,r2,a2,o2,h2,l2,u2,c2,d2,f2,p2,g2,m2,v2,y2,x2,w2,b2,T2,E2,S2,_2,C2,A2,M2,P2,R2,L2,O2,F2,k2,D2,I2,B2,N2,z2,U2,Y2,X2,G2,H2,W2,V2,j2,q2,K2,Z2,$2,J2,Q2,t5,e5,i5,n5,s5,r5,a5,o5,h5,l5,u5,c5,d5,f5,p5,g5,m5,v5,y5,x5,w5,b5,T5,E5,S5,_5,C5,A5,M5,P5,R5,L5,O5,F5,k5,D5,I5,B5,N5,z5,U5,Y5,X5,G5,H5,W5,V5,j5,q5,K5,Z5,$5,J5,Q5,t3,e3,i3,n3,s3,r3,a3,o3,h3,l3,u3,c3,d3,f3,p3,g3,m3,v3,y3,x3,w3,b3={},T3={},E3={},S3={},_3={},C3={},A3={},M3={},P3={},R3={};function L3(){if(d$)return c$;d$=1;var t=qh(),e=Ih(),i=Zu(),n=xH(),s=NX(),r=new e({Extends:t,Mixins:[i.Origin,i.ScrollFactor,i.Visible],initialize:function(e,i,s,r,a,o,h){t.call(this,e,i,s),this.color=new n(r,a,o),this.intensity=h,this.renderFlags=15,this.cameraFilter=0,this.setScrollFactor(1,1),this.setOrigin(),this.setDisplayOrigin(s)},displayWidth:{get:function(){return this.diameter},set:function(t){this.diameter=t}},displayHeight:{get:function(){return this.diameter},set:function(t){this.diameter=t}},width:{get:function(){return this.diameter},set:function(t){this.diameter=t}},height:{get:function(){return this.diameter},set:function(t){this.diameter=t}},willRender:function(t){return!(r.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setColor:function(t){var e=s.getFloatsFromUintRGB(t);return this.color.set(e[0],e[1],e[2]),this},setIntensity:function(t){return this.intensity=t,this},setRadius:function(t){return this.radius=t,this}});return r.RENDER_MASK=15,c$=r}function O3(){return p$||(p$=1,f$=function(t,e){var i=e.width/2,n=e.height/2,s=Math.abs(t.x-e.x-i),r=Math.abs(t.y-e.y-n),a=i+t.radius,o=n+t.radius;if(s>a||r>o)return!1;if(s<=i||r<=n)return!0;var h=s-i,l=r-n;return h*h+l*l<=t.radius*t.radius}),f$}function F3(){if(m$)return g$;m$=1;var t=O3(),e=Ih(),i=EU(),n=L3(),s=JZ(),r=xH(),a=_l(),o=Gl(),h=NX(),l=new e({initialize:function(){this.lights=[],this.ambientColor=new r(.1,.1,.1),this.active=!1,this.maxLights=-1,this.visibleLights=0},addPointLight:function(t,e,i,n,r,a){return this.systems.displayList.add(new s(this.scene,t,e,i,n,r,a))},enable:function(){return-1===this.maxLights&&(this.maxLights=this.systems.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},getLights:function(e){for(var n=this.lights,s=e.worldView,r=[],a=0;a<n.length;a++){var h=n[a];h.willRender(e)&&t(h,s)&&r.push({light:h,distance:i(h.x,h.y,s.centerX,s.centerY)})}return r.length>this.maxLights&&(o(r,this.sortByDistance),r=r.slice(0,this.maxLights)),this.visibleLights=r.length,r},sortByDistance:function(t,e){return t.distance>=e.distance},setAmbientColor:function(t){var e=h.getFloatsFromUintRGB(t);return this.ambientColor.set(e[0],e[1],e[2]),this},getMaxVisibleLights:function(){return this.maxLights},getLightCount:function(){return this.lights.length},addLight:function(t,e,i,s,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=128),void 0===s&&(s=16777215),void 0===r&&(r=1);var a=h.getFloatsFromUintRGB(s),o=new n(t,e,i,a[0],a[1],a[2],r);return this.lights.push(o),o},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&a(this.lights,e),this},shutdown:function(){this.lights.length=0},destroy:function(){this.shutdown()}});return g$=l}function k3(){if(w$)return x$;w$=1;var t={Events:Bz(),DisplayList:wW(),GameObjectCreator:GH(),GameObjectFactory:Mu(),UpdateList:EW(),Components:Zu(),GetCalcMatrix:SW(),BuildGameObject:CW(),BuildGameObjectAnimation:AW(),GameObject:Nz(),BitmapText:LW(),Blitter:kW(),Bob:FW(),Container:IW(),DOMElement:UW(),DynamicBitmapText:YW(),Extern:GW(),Graphics:JW(),Group:nV(),Image:hW(),Layer:sV(),Particles:OD?LD:(OD=1,LD={EmitterColorOp:oV(),EmitterOp:aV(),Events:hV(),GravityWell:uV(),Particle:cV(),ParticleBounds:dV(),ParticleEmitter:EV(),ParticleProcessor:lV(),Zones:RD?PD:(RD=1,PD={DeathZone:pV(),EdgeZone:gV(),RandomZone:bV()})}),PathFollower:SV(),RenderTexture:_V(),RetroFont:AV(),Rope:PV(),Sprite:iV(),Text:DV(),GetTextSize:RV(),MeasureText:OV(),TextStyle:FV(),TileSprite:BV(),Zone:zz(),Video:zV(),Shape:UV(),Arc:VV(),Curve:qV(),Ellipse:ZV(),Grid:JV(),IsoBox:tj(),IsoTriangle:ij(),Line:sj(),Polygon:dj(),Rectangle:pj(),Star:mj(),Triangle:Tj(),Factories:{Blitter:_j(),Container:Mj(),DOMElement:Lj(),DynamicBitmapText:kj(),Extern:Bj(),Graphics:Uj(),Group:Gj(),Image:Vj(),Layer:Kj(),Particles:Jj(),PathFollower:eq(),RenderTexture:sq(),Rope:oq(),Sprite:uq(),StaticBitmapText:fq(),Text:mq(),TileSprite:xq(),Zone:Tq(),Video:_q(),Arc:Mq(),Curve:Lq(),Ellipse:kq(),Grid:Bq(),IsoBox:Uq(),IsoTriangle:Gq(),Line:Vq(),Polygon:Kq(),Rectangle:Jq(),Star:eK(),Triangle:sK()},Creators:{Blitter:oK(),Container:uK(),DynamicBitmapText:fK(),Graphics:mK(),Group:xK(),Image:TK(),Layer:_K(),Particles:MK(),RenderTexture:LK(),Rope:kK(),Sprite:BK(),StaticBitmapText:UK(),Text:GK(),TileSprite:VK(),Zone:KK(),Video:UZ()}};return t.Shader=GZ(),t.Mesh=KZ(),t.NineSlice=$Z(),t.PointLight=JZ(),t.Plane=t$(),t.Factories.Shader=function(){if(e$)return b3;e$=1;var t=GZ();return Mu().register("shader",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),b3}(),t.Factories.Mesh=function(){if(i$)return T3;i$=1;var t=KZ();return Mu().register("mesh",function(e,i,n,s,r,a,o,h,l,u,c){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u,c))}),T3}(),t.Factories.NineSlice=function(){if(n$)return E3;n$=1;var t=$Z();return Mu().register("nineslice",function(e,i,n,s,r,a,o,h,l,u){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o,h,l,u))}),E3}(),t.Factories.PointLight=function(){if(s$)return S3;s$=1;var t=Mu(),e=JZ();return t.register("pointlight",function(t,i,n,s,r,a){return this.displayList.add(new e(this.scene,t,i,n,s,r,a))}),S3}(),t.Factories.Plane=function(){if(r$)return _3;r$=1;var t=t$();return Mu().register("plane",function(e,i,n,s,r,a,o){return this.displayList.add(new t(this.scene,e,i,n,s,r,a,o))}),_3}(),t.Creators.Shader=function(){if(a$)return C3;a$=1;var t=CW(),e=GH(),i=_W(),n=GZ();return e.register("shader",function(e,s){void 0===e&&(e={});var r=i(e,"key",null),a=i(e,"x",0),o=i(e,"y",0),h=i(e,"width",128),l=i(e,"height",128),u=new n(this.scene,r,a,o,h,l);return void 0!==s&&(e.add=s),t(this.scene,u,e),u}),C3}(),t.Creators.Mesh=function(){if(o$)return A3;o$=1;var t=CW(),e=GH(),i=_W(),n=Tl(),s=KZ();return e.register("mesh",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"vertices",[]),l=n(e,"uvs",[]),u=n(e,"indicies",[]),c=n(e,"containsZ",!1),d=n(e,"normals",[]),f=n(e,"colors",16777215),p=n(e,"alphas",1),g=new s(this.scene,0,0,a,o,h,l,u,c,d,f,p);return void 0!==r&&(e.add=r),t(this.scene,g,e),g}),A3}(),t.Creators.NineSlice=function(){if(h$)return M3;h$=1;var t=CW(),e=GH(),i=_W(),n=Tl(),s=$Z();return e.register("nineslice",function(e,r){void 0===e&&(e={});var a=i(e,"key",null),o=i(e,"frame",null),h=n(e,"width",256),l=n(e,"height",256),u=n(e,"leftWidth",10),c=n(e,"rightWidth",10),d=n(e,"topHeight",0),f=n(e,"bottomHeight",0),p=new s(this.scene,0,0,a,o,h,l,u,c,d,f);return void 0!==r&&(e.add=r),t(this.scene,p,e),p}),M3}(),t.Creators.PointLight=function(){if(l$)return P3;l$=1;var t=CW(),e=GH(),i=_W(),n=JZ();return e.register("pointlight",function(e,s){void 0===e&&(e={});var r=i(e,"color",16777215),a=i(e,"radius",128),o=i(e,"intensity",1),h=i(e,"attenuation",.1),l=new n(this.scene,0,0,r,a,o,h);return void 0!==s&&(e.add=s),t(this.scene,l,e),l}),P3}(),t.Creators.Plane=function(){if(u$)return R3;u$=1;var t=CW(),e=AW(),i=GH(),n=_W(),s=Tl(),r=t$();return i.register("plane",function(i,a){void 0===i&&(i={});var o=n(i,"key",null),h=n(i,"frame",null),l=s(i,"width",8),u=s(i,"height",8),c=s(i,"tile",!1),d=new r(this.scene,0,0,o,h,l,u,c);void 0!==a&&(i.add=a);var f=s(i,"checkerboard",null);if(f){var p=s(f,"color1",16777215),g=s(f,"color2",255),m=s(f,"alpha1",255),v=s(f,"alpha2",255),y=s(f,"height",128);d.createCheckerboard(p,g,m,v,y)}return t(this.scene,d,i),e(d,i),d}),R3}(),t.Light=L3(),t.LightsManager=F3(),t.LightsPlugin=function(){if(y$)return v$;y$=1;var t=Ih(),e=F3(),i=Cu(),n=Au(),s=new t({Extends:e,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(n.BOOT,this.boot,this),e.call(this)},boot:function(){var t=this.systems.events;t.on(n.SHUTDOWN,this.shutdown,this),t.on(n.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});return i.register("LightsPlugin",s,"lights"),v$=s}(),x$=t}function D3(){if(U$)return z$;U$=1;var t=qh();return t.Area=(T$||(T$=1,b$=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}),b$),t.Circumference=Wh(),t.CircumferencePoint=Uh(),t.Clone=function(){if(S$)return E$;S$=1;var t=qh();return E$=function(e){return new t(e.x,e.y,e.radius)}}(),t.Contains=Bh(),t.ContainsPoint=function(){if(C$)return _$;C$=1;var t=Bh();return _$=function(e,i){return t(e,i.x,i.y)},_$}(),t.ContainsRect=function(){if(M$)return A$;M$=1;var t=Bh();return A$=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},A$}(),t.CopyFrom=R$?P$:(R$=1,P$=function(t,e){return e.setTo(t.x,t.y,t.radius)}),t.Equals=(O$||(O$=1,L$=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}),L$),t.GetBounds=function(){if(k$)return F$;k$=1;var t=Eu();return F$=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.diameter,i.height=e.diameter,i},F$}(),t.GetPoint=Hh(),t.GetPoints=Vh(),t.Offset=(I$||(I$=1,D$=function(t,e,i){return t.x+=e,t.y+=i,t}),D$),t.OffsetPoint=(N$||(N$=1,B$=function(t,e){return t.x+=e.x,t.y+=e.y,t}),B$),t.Random=jh(),z$=t}function I3(){if(aJ)return rJ;aJ=1;var t=ZW();return t.Area=(X$||(X$=1,Y$=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}),Y$),t.Circumference=qW(),t.CircumferencePoint=VW(),t.Clone=function(){if(H$)return G$;H$=1;var t=ZW();return G$=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=WW(),t.ContainsPoint=function(){if(V$)return W$;V$=1;var t=WW();return W$=function(e,i){return t(e,i.x,i.y)},W$}(),t.ContainsRect=function(){if(q$)return j$;q$=1;var t=WW();return j$=function(e,i){return t(e,i.x,i.y)&&t(e,i.right,i.y)&&t(e,i.x,i.bottom)&&t(e,i.right,i.bottom)},j$}(),t.CopyFrom=Z$?K$:(Z$=1,K$=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}),t.Equals=(J$||(J$=1,$$=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),$$),t.GetBounds=function(){if(tJ)return Q$;tJ=1;var t=Eu();return Q$=function(e,i){return void 0===i&&(i=new t),i.x=e.left,i.y=e.top,i.width=e.width,i.height=e.height,i},Q$}(),t.GetPoint=jW(),t.GetPoints=KW(),t.Offset=(iJ||(iJ=1,eJ=function(t,e,i){return t.x+=e,t.y+=i,t}),eJ),t.OffsetPoint=(sJ||(sJ=1,nJ=function(t,e){return t.x+=e.x,t.y+=e.y,t}),nJ),t.Random=gU(),rJ=t}function B3(){if(hJ)return oJ;hJ=1;var t=EU();return oJ=function(e,i){return t(e.x,e.y,i.x,i.y)<=e.radius+i.radius}}function N3(){if(uJ)return lJ;uJ=1;var t=zh(),e=B3();return lJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o,h,l=i.x,u=i.y,c=i.radius,d=n.x,f=n.y,p=n.radius;if(u===f)0==(o=(a=-2*f)*a-4*(r=1)*(d*d+(h=(p*p-c*c-d*d+l*l)/(2*(l-d)))*h-2*d*h+f*f-p*p))?s.push(new t(h,-a/(2*r))):o>0&&(s.push(new t(h,(-a+Math.sqrt(o))/(2*r))),s.push(new t(h,(-a-Math.sqrt(o))/(2*r))));else{var g=(l-d)/(u-f),m=(p*p-c*c-d*d+l*l-f*f+u*u)/(2*(u-f));0==(o=(a=2*u*g-2*m*g-2*l)*a-4*(r=g*g+1)*(l*l+u*u+m*m-c*c-2*u*m))?(h=-a/(2*r),s.push(new t(h,m-h*g))):o>0&&(h=(-a+Math.sqrt(o))/(2*r),s.push(new t(h,m-h*g)),h=(-a-Math.sqrt(o))/(2*r),s.push(new t(h,m-h*g)))}}return s}}function z3(){if(dJ)return cJ;dJ=1;var t=Bh(),e=new(zh());return cJ=function(i,n,s){if(void 0===s&&(s=e),t(n,i.x1,i.y1))return s.x=i.x1,s.y=i.y1,!0;if(t(n,i.x2,i.y2))return s.x=i.x2,s.y=i.y2,!0;var r=i.x2-i.x1,a=i.y2-i.y1,o=n.x-i.x1,h=n.y-i.y1,l=r*r+a*a,u=r,c=a;if(l>0){var d=(o*r+h*a)/l;u*=d,c*=d}return s.x=i.x1+u,s.y=i.y1+c,u*u+c*c<=l&&u*r+c*a>=0&&t(n,s.x,s.y)},cJ}function U3(){if(pJ)return fJ;pJ=1;var t=zh(),e=z3();return fJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r,a,o=i.x1,h=i.y1,l=i.x2,u=i.y2,c=n.x,d=n.y,f=n.radius,p=l-o,g=u-h,m=o-c,v=h-d,y=p*p+g*g,x=2*(p*m+g*v),w=x*x-4*y*(m*m+v*v-f*f);if(0===w){var b=-x/(2*y);r=o+b*p,a=h+b*g,b>=0&&b<=1&&s.push(new t(r,a))}else if(w>0){var T=(-x-Math.sqrt(w))/(2*y);r=o+T*p,a=h+T*g,T>=0&&T<=1&&s.push(new t(r,a));var E=(-x+Math.sqrt(w))/(2*y);r=o+E*p,a=h+E*g,E>=0&&E<=1&&s.push(new t(r,a))}}return s},fJ}function Y3(){if(mJ)return gJ;mJ=1;var t=U3(),e=O3();return gJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=n.getLineD();t(r,i,s),t(a,i,s),t(o,i,s),t(h,i,s)}return s},gJ}function X3(){if(yJ)return vJ;yJ=1;var t=pX();return vJ=function(e,i,n,s){void 0===n&&(n=!1);var r,a,o,h=e.x1,l=e.y1,u=e.x2,c=e.y2,d=i.x1,f=i.y1,p=u-h,g=c-l,m=i.x2-d,v=i.y2-f,y=p*v-g*m;if(0===y)return null;if(n){if(r=(p*(f-l)+g*(h-d))/(m*g-v*p),0!==p)a=(d+m*r-h)/p;else{if(0===g)return null;a=(f+v*r-l)/g}if(a<0||r<0||r>1)return null;o=a}else{if(a=((l-f)*p-(h-d)*g)/y,(r=((d-h)*v-(f-l)*m)/y)<0||r>1||a<0||a>1)return null;o=r}return void 0===s&&(s=new t),s.set(h+p*o,l+g*o,o)}}function G3(){if(wJ)return xJ;wJ=1;var t=X3(),e=bu(),i=pX(),n=new e,s=new i;return xJ=function(e,r,a,o){void 0===a&&(a=!1),void 0===o&&(o=new i);var h=!1;o.set(),s.set();for(var l=r[r.length-1],u=0;u<r.length;u++){var c=r[u];n.setTo(l.x,l.y,c.x,c.y),l=c,t(e,n,a,s)&&(!h||s.z<o.z)&&(o.copy(s),h=!0)}return h?o:null},xJ}function H3(){if(TJ)return bJ;TJ=1;var t=pX(),e=wX(),i=G3(),n=new t;return bJ=function(t,s,r,a){void 0===a&&(a=new e),Array.isArray(s)||(s=[s]);var o=!1;a.set(),n.set();for(var h=0;h<s.length;h++)i(t,s[h].points,r,n)&&(!o||n.z<a.z)&&(a.set(n.x,n.y,n.z,h),o=!0);return o?a:null},bJ}function W3(){return SJ?EJ:(SJ=1,EJ=function(t,e,i){var n=t.x1,s=t.y1,r=t.x2,a=t.y2,o=e.x1,h=e.y1,l=e.x2,u=e.y2;if(n===r&&s===a||o===l&&h===u)return!1;var c=(u-h)*(r-n)-(l-o)*(a-s);if(0===c)return!1;var d=((l-o)*(s-h)-(u-h)*(n-o))/c,f=((r-n)*(s-h)-(a-s)*(n-o))/c;return!(d<0||d>1||f<0||f>1||(i&&(i.x=n+d*(r-n),i.y=s+d*(a-s)),0))})}function V3(){return CJ||(CJ=1,_J=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=e.x,o=e.y,h=e.right,l=e.bottom,u=0;if(i>=a&&i<=h&&n>=o&&n<=l||s>=a&&s<=h&&r>=o&&r<=l)return!0;if(i<a&&s>=a){if((u=n+(r-n)*(a-i)/(s-i))>o&&u<=l)return!0}else if(i>h&&s<=h&&(u=n+(r-n)*(h-i)/(s-i))>=o&&u<=l)return!0;if(n<o&&r>=o){if((u=i+(s-i)*(o-n)/(r-n))>=a&&u<=h)return!0}else if(n>l&&r<=l&&(u=i+(s-i)*(l-n)/(r-n))>=a&&u<=h)return!0;return!1}),_J}function j3(){if(MJ)return AJ;MJ=1;var t=zh(),e=W3(),i=V3();return AJ=function(n,s,r){if(void 0===r&&(r=[]),i(n,s))for(var a=s.getLineA(),o=s.getLineB(),h=s.getLineC(),l=s.getLineD(),u=[new t,new t,new t,new t],c=[e(a,n,u[0]),e(o,n,u[1]),e(h,n,u[2]),e(l,n,u[3])],d=0;d<4;d++)c[d]&&r.push(u[d]);return r},AJ}function q3(){if(RJ)return PJ;RJ=1;var t=wX(),e=H3(),i=new(bu());function n(n,s,r,a,o){var h=Math.cos(n),l=Math.sin(n);i.setTo(s,r,s+h,r+l);var u=e(i,a,!0);u&&o.push(new t(u.x,u.y,n,u.w))}function s(t,e){return t.z-e.z}return PJ=function(t,e,i){Array.isArray(i)||(i=[i]);for(var r=[],a=[],o=0;o<i.length;o++)for(var h=i[o].points,l=0;l<h.length;l++){var u=Math.atan2(h[l].y-e,h[l].x-t);-1===a.indexOf(u)&&(n(u,t,e,i,r),n(u-1e-5,t,e,i,r),n(u+1e-5,t,e,i,r),a.push(u))}return r.sort(s)},PJ}function K3(){if(OJ)return LJ;OJ=1;var t=Eu(),e=TV();return LJ=function(i,n,s){return void 0===s&&(s=new t),e(i,n)&&(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y),s}}function Z3(){if(kJ)return FJ;kJ=1;var t=j3(),e=TV();return FJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC(),h=i.getLineD();t(r,n,s),t(a,n,s),t(o,n,s),t(h,n,s)}return s}}function $3(){return IJ||(IJ=1,DJ=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=[]);for(var s,r,a,o,h,l,u=t.x3-t.x1,c=t.y3-t.y1,d=t.x2-t.x1,f=t.y2-t.y1,p=u*u+c*c,g=u*d+c*f,m=d*d+f*f,v=p*m-g*g,y=0===v?0:1/v,x=t.x1,w=t.y1,b=0;b<e.length&&(r=(p*(l=d*(a=e[b].x-x)+f*(o=e[b].y-w))-g*(h=u*a+c*o))*y,!((s=(m*h-g*l)*y)>=0&&r>=0&&s+r<1&&(n.push({x:e[b].x,y:e[b].y}),i)));b++);return n}),DJ}function J3(){return NJ?BJ:(NJ=1,BJ=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e})}function Q3(){if(UJ)return zJ;UJ=1;var t=W3(),e=cu(),i=$3(),n=J3();return zJ=function(s,r){if(r.left>s.right||r.right<s.left||r.top>s.bottom||r.bottom<s.top)return!1;var a=r.getLineA(),o=r.getLineB(),h=r.getLineC();if(e(s,a.x1,a.y1)||e(s,a.x2,a.y2))return!0;if(e(s,o.x1,o.y1)||e(s,o.x2,o.y2))return!0;if(e(s,h.x1,h.y1)||e(s,h.x2,h.y2))return!0;var l=s.getLineA(),u=s.getLineB(),c=s.getLineC(),d=s.getLineD();if(t(a,l)||t(a,u)||t(a,c)||t(a,d))return!0;if(t(o,l)||t(o,u)||t(o,c)||t(o,d))return!0;if(t(h,l)||t(h,u)||t(h,c)||t(h,d))return!0;var f=n(s);return i(r,f,!0).length>0},zJ}function t4(){if(XJ)return YJ;XJ=1;var t=Q3(),e=j3();return YJ=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(r,i,s),e(a,i,s),e(o,i,s)}return s},YJ}function e4(){if(HJ)return GJ;HJ=1;var t=z3(),e=vj();return GJ=function(i,n){return!(i.left>n.right||i.right<n.left||i.top>n.bottom||i.bottom<n.top||!e(i,n.x,n.y)&&!t(i.getLineA(),n)&&!t(i.getLineB(),n)&&!t(i.getLineC(),n))},GJ}function i4(){if(VJ)return WJ;VJ=1;var t=U3(),e=e4();return WJ=function(i,n,s){if(void 0===s&&(s=[]),e(i,n)){var r=i.getLineA(),a=i.getLineB(),o=i.getLineC();t(r,n,s),t(a,n,s),t(o,n,s)}return s},WJ}function n4(){if(qJ)return jJ;qJ=1;var t=W3();return jJ=function(e,i){return!!(e.contains(i.x1,i.y1)||e.contains(i.x2,i.y2)||t(e.getLineA(),i)||t(e.getLineB(),i)||t(e.getLineC(),i))},jJ}function s4(){if(ZJ)return KJ;ZJ=1;var t=zh(),e=n4(),i=W3();return KJ=function(n,s,r){if(void 0===r&&(r=[]),e(n,s))for(var a=n.getLineA(),o=n.getLineB(),h=n.getLineC(),l=[new t,new t,new t],u=[i(a,s,l[0]),i(o,s,l[1]),i(h,s,l[2])],c=0;c<3;c++)u[c]&&r.push(l[c]);return r},KJ}function r4(){return JJ||(JJ=1,$J=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e}),$J}function a4(){if(tQ)return QJ;tQ=1;var t=$3(),e=r4(),i=W3();return QJ=function(n,s){if(n.left>s.right||n.right<s.left||n.top>s.bottom||n.bottom<s.top)return!1;var r=n.getLineA(),a=n.getLineB(),o=n.getLineC(),h=s.getLineA(),l=s.getLineB(),u=s.getLineC();if(i(r,h)||i(r,l)||i(r,u))return!0;if(i(a,h)||i(a,l)||i(a,u))return!0;if(i(o,h)||i(o,l)||i(o,u))return!0;var c=e(n),d=t(s,c,!0);return d.length>0||(c=e(s),(d=t(n,c,!0)).length>0)}}function o4(){if(iQ)return eQ;iQ=1;var t=a4(),e=s4();return eQ=function(i,n,s){if(void 0===s&&(s=[]),t(i,n)){var r=n.getLineA(),a=n.getLineB(),o=n.getLineC();e(i,r,s),e(i,a,s),e(i,o,s)}return s}}function h4(){return sQ||(sQ=1,nQ=function(t,e,i){void 0===i&&(i=1);var n=e.x1,s=e.y1,r=e.x2,a=e.y2,o=t.x,h=t.y,l=(r-n)*(r-n)+(a-s)*(a-s);if(0===l)return!1;var u=((o-n)*(r-n)+(h-s)*(a-s))/l;if(u<0)return Math.sqrt((n-o)*(n-o)+(s-h)*(s-h))<=i;if(u>=0&&u<=1){var c=((s-h)*(r-n)-(n-o)*(a-s))/l;return Math.abs(c)*Math.sqrt(l)<=i}return Math.sqrt((r-o)*(r-o)+(a-h)*(a-h))<=i}),nQ}function l4(){if(aQ)return rQ;aQ=1;var t=h4();return rQ=function(e,i){if(!t(e,i))return!1;var n=Math.min(i.x1,i.x2),s=Math.max(i.x1,i.x2),r=Math.min(i.y1,i.y2),a=Math.max(i.y1,i.y2);return e.x>=n&&e.x<=s&&e.y>=r&&e.y<=a},rQ}function u4(){return uQ?lQ:(uQ=1,lQ={CircleToCircle:B3(),CircleToRectangle:O3(),GetCircleToCircle:N3(),GetCircleToRectangle:Y3(),GetLineToCircle:U3(),GetLineToLine:X3(),GetLineToPoints:G3(),GetLineToPolygon:H3(),GetLineToRectangle:j3(),GetRaysFromPointToPolygon:q3(),GetRectangleIntersection:K3(),GetRectangleToRectangle:Z3(),GetRectangleToTriangle:t4(),GetTriangleToCircle:i4(),GetTriangleToLine:s4(),GetTriangleToTriangle:o4(),LineToCircle:z3(),LineToLine:W3(),LineToRectangle:V3(),PointToLine:h4(),PointToLineSegment:l4(),RectangleToRectangle:TV(),RectangleToTriangle:Q3(),RectangleToValues:hQ?oQ:(hQ=1,oQ=function(t,e,i,n,s,r){return void 0===r&&(r=0),!(e>t.right+r||i<t.left-r||n>t.bottom+r||s<t.top-r)}),TriangleToCircle:e4(),TriangleToLine:n4(),TriangleToTriangle:a4()})}function c4(){return dQ||(dQ=1,cQ=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}),cQ}function d4(){if(kQ)return FQ;kQ=1;var t=Gh(),e=Vu(),i=c4();return FQ=function(n){var s=i(n)-t.TAU;return e(s,-Math.PI,Math.PI)},FQ}function f4(){return VQ||(VQ=1,WQ=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,t}),WQ}function p4(){if(s0)return n0;s0=1;var t=bu();return t.Angle=c4(),t.BresenhamPoints=cU(),t.CenterOn=(pQ||(pQ=1,fQ=function(t,e,i){var n=e-(t.x1+t.x2)/2,s=i-(t.y1+t.y2)/2;return t.x1+=n,t.y1+=s,t.x2+=n,t.y2+=s,t}),fQ),t.Clone=function(){if(mQ)return gQ;mQ=1;var t=bu();return gQ=function(e){return new t(e.x1,e.y1,e.x2,e.y2)}}(),t.CopyFrom=yQ?vQ:(yQ=1,vQ=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}),t.Equals=(wQ||(wQ=1,xQ=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}),xQ),t.Extend=function(){if(TQ)return bQ;TQ=1;var t=mu();return bQ=function(e,i,n){void 0===n&&(n=i);var s=t(e),r=e.x2-e.x1,a=e.y2-e.y1;return i&&(e.x1=e.x1-r/s*i,e.y1=e.y1-a/s*i),n&&(e.x2=e.x2+r/s*n,e.y2=e.y2+a/s*n),e},bQ}(),t.GetEasedPoints=oU(),t.GetMidPoint=function(){if(SQ)return EQ;SQ=1;var t=zh();return EQ=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2)/2,i.y=(e.y1+e.y2)/2,i},EQ}(),t.GetNearestPoint=function(){if(CQ)return _Q;CQ=1;var t=zh();return _Q=function(e,i,n){void 0===n&&(n=new t);var s=e.x1,r=e.y1,a=e.x2,o=e.y2,h=(a-s)*(a-s)+(o-r)*(o-r);if(0===h)return n;var l=((i.x-s)*(a-s)+(i.y-r)*(o-r))/h;return n.x=s+l*(a-s),n.y=r+l*(o-r),n},_Q}(),t.GetNormal=function(){if(MQ)return AQ;MQ=1;var t=Gh(),e=c4(),i=zh();return AQ=function(n,s){void 0===s&&(s=new i);var r=e(n)-t.TAU;return s.x=Math.cos(r),s.y=Math.sin(r),s},AQ}(),t.GetPoint=gu(),t.GetPoints=vu(),t.GetShortestDistance=(RQ||(RQ=1,PQ=function(t,e){var i=t.x1,n=t.y1,s=t.x2,r=t.y2,a=(s-i)*(s-i)+(r-n)*(r-n);if(0===a)return!1;var o=((n-e.y)*(s-i)-(i-e.x)*(r-n))/a;return Math.abs(o)*Math.sqrt(a)}),PQ),t.Height=(OQ||(OQ=1,LQ=function(t){return Math.abs(t.y1-t.y2)}),LQ),t.Length=mu(),t.NormalAngle=d4(),t.NormalX=function(){if(IQ)return DQ;IQ=1;var t=Gh(),e=c4();return DQ=function(i){return Math.cos(e(i)-t.TAU)},DQ}(),t.NormalY=function(){if(NQ)return BQ;NQ=1;var t=Gh(),e=c4();return BQ=function(i){return Math.sin(e(i)-t.TAU)},BQ}(),t.Offset=(UQ||(UQ=1,zQ=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t}),zQ),t.PerpSlope=(XQ||(XQ=1,YQ=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}),YQ),t.Random=yu(),t.ReflectAngle=function(){if(HQ)return GQ;HQ=1;var t=c4(),e=d4();return GQ=function(i,n){return 2*e(n)-Math.PI-t(i)}}(),t.Rotate=function(){if(qQ)return jQ;qQ=1;var t=f4();return jQ=function(e,i){var n=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2;return t(e,n,s,i)},jQ}(),t.RotateAroundPoint=function(){if(ZQ)return KQ;ZQ=1;var t=f4();return KQ=function(e,i,n){return t(e,i.x,i.y,n)},KQ}(),t.RotateAroundXY=f4(),t.SetToAngle=(JQ||(JQ=1,$Q=function(t,e,i,n,s){return t.x1=e,t.y1=i,t.x2=e+Math.cos(n)*s,t.y2=i+Math.sin(n)*s,t}),$Q),t.Slope=(t0||(t0=1,QQ=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}),QQ),t.Width=(i0||(i0=1,e0=function(t){return Math.abs(t.x1-t.x2)}),e0),n0=t}function g4(){if(a0)return r0;a0=1;var t=!0,e="untitled",i="",n="";function s(t){var e=t.indexOf("#");return e>-1?t.substring(0,e):t}function r(t){return 0===t.models.length&&t.models.push({faces:[],name:e,textureCoords:[],vertexNormals:[],vertices:[]}),i="",t.models[t.models.length-1]}function a(t,n){var s=t.length>=2?t[1]:e;n.models.push({faces:[],name:s,textureCoords:[],vertexNormals:[],vertices:[]}),i=""}function o(t){2===t.length&&(i=t[1])}function h(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertices.push({x:n,y:s,z:a})}function l(e,i){var n=e.length,s=n>=2?parseFloat(e[1]):0,a=n>=3?parseFloat(e[2]):0,o=n>=4?parseFloat(e[3]):0;isNaN(s)&&(s=0),isNaN(a)&&(a=0),isNaN(o)&&(o=0),t&&(a=1-a),r(i).textureCoords.push({u:s,v:a,w:o})}function u(t,e){var i=t.length,n=i>=2?parseFloat(t[1]):0,s=i>=3?parseFloat(t[2]):0,a=i>=4?parseFloat(t[3]):0;r(e).vertexNormals.push({x:n,y:s,z:a})}function c(t,e){var s=t.length-1;if(!(s<3)){for(var a={group:i,material:n,vertices:[]},o=0;o<s;o++){var h=t[o+1].split("/"),l=h.length;if(!(l<1||l>3)){var u=0,c=0,d=0;u=parseInt(h[0],10),l>1&&""!==h[1]&&(c=parseInt(h[1],10)),l>2&&(d=parseInt(h[2],10)),0!==u&&(u<0&&(u=r(e).vertices.length+1+u),c-=1,u-=1,d-=1,a.vertices.push({textureCoordsIndex:c,vertexIndex:u,vertexNormalIndex:d}))}}r(e).faces.push(a)}}function d(t,e){t.length>=2&&e.materialLibraries.push(t[1])}function f(t){t.length>=2&&(n=t[1])}return r0=function(e,r){void 0===r&&(r=!0),t=r;var p={materials:{},materialLibraries:[],models:[]};i="",n="";for(var g=e.split("\n"),m=0;m<g.length;m++){var v=s(g[m]).replace(/\s\s+/g," ").trim().split(" ");switch(v[0].toLowerCase()){case"o":a(v,p);break;case"g":o(v);break;case"v":h(v,p);break;case"vt":l(v,p);break;case"vn":u(v,p);break;case"f":c(v,p);break;case"mtllib":d(v,p);break;case"usemtl":f(v)}}return p},r0}function m4(){if(h0)return o0;h0=1;var t=dY();return o0=function(e){for(var i={},n=e.split("\n"),s="",r=0;r<n.length;r++){var a=n[r].trim();if(0!==a.indexOf("#")&&""!==a){var o=a.replace(/\s\s+/g," ").trim().split(" ");switch(o[0].toLowerCase()){case"newmtl":s=o[1];break;case"kd":var h=Math.floor(255*o[1]),l=o.length>=2?Math.floor(255*o[2]):h,u=o.length>=3?Math.floor(255*o[3]):h;i[s]=t(h,l,u)}}}return i},o0}function v4(){if(d0)return c0;d0=1;var t={Face:HZ(),GenerateGridVerts:QZ(),GenerateObjVerts:VZ(),GenerateVerts:jZ(),ParseObj:g4(),ParseObjMaterial:m4(),RotateFace:u0?l0:(u0=1,l0=function(t,e,i,n){var s,r;if(void 0===i&&void 0===n){var a=t.getInCenter();s=a.x,r=a.y}var o=Math.cos(e),h=Math.sin(e),l=t.vertex1,u=t.vertex2,c=t.vertex3,d=l.x-s,f=l.y-r;l.set(d*o-f*h+s,d*h+f*o+r),d=u.x-s,f=u.y-r,u.set(d*o-f*h+s,d*h+f*o+r),d=c.x-s,f=c.y-r,c.set(d*o-f*h+s,d*h+f*o+r)}),Vertex:WZ()};return c0=t}function y4(){return C0||(C0=1,_0=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}),_0}function x4(){return M0||(M0=1,A0=function(t){return t.x*t.x+t.y*t.y}),A0}function w4(){if(H0)return G0;H0=1;var t=zh();return t.Ceil=(p0||(p0=1,f0=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}),f0),t.Clone=function(){if(m0)return g0;m0=1;var t=zh();return g0=function(e){return new t(e.x,e.y)}}(),t.CopyFrom=y0?v0:(y0=1,v0=function(t,e){return e.setTo(t.x,t.y)}),t.Equals=(w0||(w0=1,x0=function(t,e){return t.x===e.x&&t.y===e.y}),x0),t.Floor=(T0||(T0=1,b0=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}),b0),t.GetCentroid=function(){if(S0)return E0;S0=1;var t=zh();return E0=function(e,i){if(void 0===i&&(i=new t),!Array.isArray(e))throw new Error("GetCentroid points argument must be an array");var n=e.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)i.x=e[0].x,i.y=e[0].y;else{for(var s=0;s<n;s++)i.x+=e[s].x,i.y+=e[s].y;i.x/=n,i.y/=n}return i}}(),t.GetMagnitude=y4(),t.GetMagnitudeSq=x4(),t.GetRectangleFromPoints=function(){if(R0)return P0;R0=1;var t=Eu();return P0=function(e,i){void 0===i&&(i=new t);for(var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=0;o<e.length;o++){var h=e[o];h.x>n&&(n=h.x),h.x<s&&(s=h.x),h.y>r&&(r=h.y),h.y<a&&(a=h.y)}return i.x=s,i.y=a,i.width=n-s,i.height=r-a,i},P0}(),t.Interpolate=function(){if(O0)return L0;O0=1;var t=zh();return L0=function(e,i,n,s){return void 0===n&&(n=0),void 0===s&&(s=new t),s.x=e.x+(i.x-e.x)*n,s.y=e.y+(i.y-e.y)*n,s}}(),t.Invert=(k0||(k0=1,F0=function(t){return t.setTo(t.y,t.x)}),F0),t.Negative=function(){if(I0)return D0;I0=1;var t=zh();return D0=function(e,i){return void 0===i&&(i=new t),i.setTo(-e.x,-e.y)},D0}(),t.Project=function(){if(N0)return B0;N0=1;var t=zh(),e=x4();return B0=function(i,n,s){void 0===s&&(s=new t);var r=(i.x*n.x+i.y*n.y)/e(n);return 0!==r&&(s.x=r*n.x,s.y=r*n.y),s}}(),t.ProjectUnit=function(){if(U0)return z0;U0=1;var t=zh();return z0=function(e,i,n){void 0===n&&(n=new t);var s=e.x*i.x+e.y*i.y;return 0!==s&&(n.x=s*i.x,n.y=s*i.y),n}}(),t.SetMagnitude=function(){if(X0)return Y0;X0=1;var t=y4();return Y0=function(e,i){if(0!==e.x||0!==e.y){var n=t(e);e.x/=n,e.y/=n}return e.x*=i,e.y*=i,e},Y0}(),G0=t}function b4(){if(t1)return Q0;function t(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n}function e(t,e,i){var n=e.x,s=e.y,r=i.x-n,a=i.y-s;if(0!==r||0!==a){var o=((t.x-n)*r+(t.y-s)*a)/(r*r+a*a);o>1?(n=i.x,s=i.y):o>0&&(n+=r*o,s+=a*o)}return(r=t.x-n)*r+(a=t.y-s)*a}function i(t,n,s,r,a){for(var o,h=r,l=n+1;l<s;l++){var u=e(t[l],t[n],t[s]);u>h&&(o=l,h=u)}h>r&&(o-n>1&&i(t,n,o,r,a),a.push(t[o]),s-o>1&&i(t,o,s,r,a))}function n(t,e){var n=t.length-1,s=[t[0]];return i(t,0,n,e,s),s.push(t[n]),s}return t1=1,Q0=function(e,i,s){void 0===i&&(i=1),void 0===s&&(s=!1);var r=e.points;if(r.length>2){var a=i*i;s||(r=function(e,i){for(var n,s=e[0],r=[s],a=1,o=e.length;a<o;a++)t(n=e[a],s)>i&&(r.push(n),s=n);return s!==n&&r.push(n),r}(r,a)),e.setTo(n(r,a))}return e},Q0}function T4(){if(s1)return n1;s1=1;var t=uj();return t.Clone=function(){if(V0)return W0;V0=1;var t=uj();return W0=function(e){return new t(e.points)},W0}(),t.Contains=oj(),t.ContainsPoint=function(){if(q0)return j0;q0=1;var t=oj();return j0=function(e,i){return t(e,i.x,i.y)},j0}(),t.Earcut=TG(),t.GetAABB=aj(),t.GetNumberArray=(Z0||(Z0=1,K0=function(t,e){void 0===e&&(e=[]);for(var i=0;i<t.points.length;i++)e.push(t.points[i].x),e.push(t.points[i].y);return e}),K0),t.GetPoints=lj(),t.Perimeter=hj(),t.Reverse=(J0||(J0=1,$0=function(t){return t.points.reverse(),t}),$0),t.Simplify=b4(),t.Smooth=cj(),t.Translate=(i1||(i1=1,e1=function(t,e,i){for(var n=t.points,s=0;s<n.length;s++)n[s].x+=e,n[s].y+=i;return t}),e1),n1=t}function E4(){return m1?g1:(m1=1,g1=function(t,e){return!(e.width*e.height>t.width*t.height)&&e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom})}function S4(){return w1?x1:(w1=1,x1=function(t){return 0===t.height?NaN:t.width/t.height})}function _4(){if(i2)return e2;i2=1;var t=Eu();return t.Area=a1?r1:(a1=1,r1=function(t){return t.width*t.height}),t.Ceil=h1?o1:(h1=1,o1=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}),t.CeilAll=u1?l1:(u1=1,l1=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}),t.CenterOn=SY(),t.Clone=function(){if(d1)return c1;d1=1;var t=Eu();return c1=function(e){return new t(e.x,e.y,e.width,e.height)}}(),t.Contains=cu(),t.ContainsPoint=function(){if(p1)return f1;p1=1;var t=cu();return f1=function(e,i){return t(e,i.x,i.y)},f1}(),t.ContainsRect=E4(),t.CopyFrom=fV(),t.Decompose=J3(),t.Equals=y1?v1:(y1=1,v1=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}),t.FitInside=function(){if(T1)return b1;T1=1;var t=S4();return b1=function(e,i){var n=t(e);return n<t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)},b1}(),t.FitOutside=function(){if(S1)return E1;S1=1;var t=S4();return E1=function(e,i){var n=t(e);return n>t(i)?e.setSize(i.height*n,i.height):e.setSize(i.width,i.width/n),e.setPosition(i.centerX-e.width/2,i.centerY-e.height/2)},E1}(),t.Floor=C1?_1:(C1=1,_1=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}),t.FloorAll=M1?A1:(M1=1,A1=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}),t.FromPoints=nH(),t.FromXY=function(){if(R1)return P1;R1=1;var t=Eu();return P1=function(e,i,n,s,r){return void 0===r&&(r=new t),r.setTo(Math.min(e,n),Math.min(i,s),Math.abs(e-n),Math.abs(i-s))}}(),t.GetAspectRatio=S4(),t.GetCenter=function(){if(O1)return L1;O1=1;var t=zh();return L1=function(e,i){return void 0===i&&(i=new t),i.x=e.centerX,i.y=e.centerY,i}}(),t.GetPoint=fu(),t.GetPoints=pu(),t.GetSize=function(){if(k1)return F1;k1=1;var t=zh();return F1=function(e,i){return void 0===i&&(i=new t),i.x=e.width,i.y=e.height,i}}(),t.Inflate=yV(),t.Intersection=function(){if(I1)return D1;I1=1;var t=Eu(),e=TV();return D1=function(i,n,s){return void 0===s&&(s=new t),e(i,n)?(s.x=Math.max(i.x,n.x),s.y=Math.max(i.y,n.y),s.width=Math.min(i.right,n.right)-s.x,s.height=Math.min(i.bottom,n.bottom)-s.y):s.setEmpty(),s}}(),t.MarchingAnts=lU(),t.MergePoints=(N1||(N1=1,B1=function(t,e){for(var i=t.x,n=t.right,s=t.y,r=t.bottom,a=0;a<e.length;a++)i=Math.min(i,e[a].x),n=Math.max(n,e[a].x),s=Math.min(s,e[a].y),r=Math.max(r,e[a].y);return t.x=i,t.y=s,t.width=n-i,t.height=r-s,t}),B1),t.MergeRect=xV(),t.MergeXY=(U1||(U1=1,z1=function(t,e,i){var n=Math.min(t.x,e),s=Math.max(t.right,e);t.x=n,t.width=s-n;var r=Math.min(t.y,i),a=Math.max(t.bottom,i);return t.y=r,t.height=a-r,t}),z1),t.Offset=X1?Y1:(X1=1,Y1=function(t,e,i){return t.x+=e,t.y+=i,t}),t.OffsetPoint=(H1||(H1=1,G1=function(t,e){return t.x+=e.x,t.y+=e.y,t}),G1),t.Overlaps=V1?W1:(V1=1,W1=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}),t.Perimeter=du(),t.PerimeterPoint=function(){if(q1)return j1;q1=1;var t=zh(),e=Ou();return j1=function(i,n,s){void 0===s&&(s=new t),n=e(n);var r=Math.sin(n),a=Math.cos(n),o=a>0?i.width/2:i.width/-2,h=r>0?i.height/2:i.height/-2;return Math.abs(o*r)<Math.abs(h*a)?h=o*r/a:o=h*a/r,s.x=o+i.centerX,s.y=h+i.centerY,s},j1}(),t.Random=Tu(),t.RandomOutside=function(){if(Z1)return K1;Z1=1;var t=sY(),e=E4(),i=zh();return K1=function(n,s,r){if(void 0===r&&(r=new i),e(n,s))switch(t(0,3)){case 0:r.x=n.x+Math.random()*(s.right-n.x),r.y=n.y+Math.random()*(s.top-n.y);break;case 1:r.x=s.x+Math.random()*(n.right-s.x),r.y=s.bottom+Math.random()*(n.bottom-s.bottom);break;case 2:r.x=n.x+Math.random()*(s.x-n.x),r.y=s.y+Math.random()*(n.bottom-s.y);break;case 3:r.x=s.right+Math.random()*(n.right-s.right),r.y=n.y+Math.random()*(s.bottom-n.y)}return r}}(),t.SameDimensions=J1?$1:(J1=1,$1=function(t,e){return t.width===e.width&&t.height===e.height}),t.Scale=t2?Q1:(t2=1,Q1=function(t,e,i){return void 0===i&&(i=e),t.width*=e,t.height*=i,t}),t.Union=DW(),e2=t}function C4(){if(d2)return c2;d2=1;var t=zh();return c2=function(e,i){return void 0===i&&(i=new t),i.x=(e.x1+e.x2+e.x3)/3,i.y=(e.y1+e.y2+e.y3)/3,i},c2}function A4(){return p2||(p2=1,f2=function(t,e,i){return t.x1+=e,t.y1+=i,t.x2+=e,t.y2+=i,t.x3+=e,t.y3+=i,t}),f2}function M4(){if(R2)return P2;R2=1;var t=zh();function e(t,e,i,n){var s=t-i,r=e-n,a=s*s+r*r;return Math.sqrt(a)}return P2=function(i,n){void 0===n&&(n=new t);var s=i.x1,r=i.y1,a=i.x2,o=i.y2,h=i.x3,l=i.y3,u=e(h,l,a,o),c=e(s,r,h,l),d=e(a,o,s,r),f=u+c+d;return n.x=(s*u+a*c+h*d)/f,n.y=(r*u+o*c+l*d)/f,n},P2}function P4(){return k2||(k2=1,F2=function(t,e,i,n){var s=Math.cos(n),r=Math.sin(n),a=t.x1-e,o=t.y1-i;return t.x1=a*s-o*r+e,t.y1=a*r+o*s+i,a=t.x2-e,o=t.y2-i,t.x2=a*s-o*r+e,t.y2=a*r+o*s+i,a=t.x3-e,o=t.y3-i,t.x3=a*s-o*r+e,t.y3=a*r+o*s+i,t}),F2}function R4(){if(U2)return z2;U2=1;var t=wj();return t.Area=(s2||(s2=1,n2=function(t){var e=t.x1,i=t.y1,n=t.x2,s=t.y2,r=t.x3,a=t.y3;return Math.abs(((r-e)*(s-i)-(n-e)*(a-i))/2)}),n2),t.BuildEquilateral=function(){if(a2)return r2;a2=1;var t=wj();return r2=function(e,i,n){var s=n*(Math.sqrt(3)/2);return new t(e,i,e+n/2,i+s,e-n/2,i+s)}}(),t.BuildFromPolygon=function(){if(h2)return o2;h2=1;var t=TG(),e=wj();return o2=function(i,n,s,r,a){void 0===n&&(n=null),void 0===s&&(s=1),void 0===r&&(r=1),void 0===a&&(a=[]);for(var o,h,l,u,c,d,f,p,g,m=t(i,n),v=0;v<m.length;v+=3)o=m[v],h=m[v+1],l=m[v+2],u=i[2*o]*s,c=i[2*o+1]*r,d=i[2*h]*s,f=i[2*h+1]*r,p=i[2*l]*s,g=i[2*l+1]*r,a.push(new e(u,c,d,f,p,g));return a},o2}(),t.BuildRight=function(){if(u2)return l2;u2=1;var t=wj();return l2=function(e,i,n,s){return void 0===s&&(s=n),new t(e,i,e,i-s,e+n,i)}}(),t.CenterOn=function(){if(m2)return g2;m2=1;var t=C4(),e=A4();return g2=function(i,n,s,r){void 0===r&&(r=t);var a=r(i),o=n-a.x,h=s-a.y;return e(i,o,h)},g2}(),t.Centroid=C4(),t.CircumCenter=function(){if(y2)return v2;y2=1;var t=wu();function e(t,e,i,n){return t*n-e*i}return v2=function(i,n){void 0===n&&(n=new t);var s=i.x3,r=i.y3,a=i.x1-s,o=i.y1-r,h=i.x2-s,l=i.y2-r,u=2*e(a,o,h,l),c=e(o,a*a+o*o,l,h*h+l*l),d=e(a,a*a+o*o,h,h*h+l*l);return n.x=s-c/u,n.y=r+d/u,n},v2}(),t.CircumCircle=function(){if(w2)return x2;w2=1;var t=qh();return x2=function(e,i){void 0===i&&(i=new t);var n,s,r=e.x1,a=e.y1,o=e.x2,h=e.y2,l=e.x3,u=e.y3,c=o-r,d=h-a,f=l-r,p=u-a,g=c*(r+o)+d*(a+h),m=f*(r+l)+p*(a+u),v=2*(c*(u-h)-d*(l-o));if(Math.abs(v)<1e-6){var y=Math.min(r,o,l),x=Math.min(a,h,u);n=.5*(Math.max(r,o,l)-y),s=.5*(Math.max(a,h,u)-x),i.x=y+n,i.y=x+s,i.radius=Math.sqrt(n*n+s*s)}else i.x=(p*g-d*m)/v,i.y=(c*m-f*g)/v,n=i.x-r,s=i.y-a,i.radius=Math.sqrt(n*n+s*s);return i},x2}(),t.Clone=function(){if(T2)return b2;T2=1;var t=wj();return b2=function(e){return new t(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3)}}(),t.Contains=vj(),t.ContainsArray=$3(),t.ContainsPoint=function(){if(S2)return E2;S2=1;var t=vj();return E2=function(e,i){return t(e,i.x,i.y)},E2}(),t.CopyFrom=C2?_2:(C2=1,_2=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}),t.Decompose=r4(),t.Equals=(M2||(M2=1,A2=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}),A2),t.GetPoint=yj(),t.GetPoints=xj(),t.InCenter=M4(),t.Perimeter=function(){if(O2)return L2;O2=1;var t=mu();return L2=function(e){var i=e.getLineA(),n=e.getLineB(),s=e.getLineC();return t(i)+t(n)+t(s)},L2}(),t.Offset=A4(),t.Random=xU(),t.Rotate=function(){if(I2)return D2;I2=1;var t=P4(),e=M4();return D2=function(i,n){var s=e(i);return t(i,s.x,s.y,n)},D2}(),t.RotateAroundPoint=function(){if(N2)return B2;N2=1;var t=P4();return B2=function(e,i,n){return t(e,i.x,i.y,n)},B2}(),t.RotateAroundXY=P4(),z2=t}function L4(){if(X2)return Y2;X2=1;var t=Nh(),e=jo(),i={Circle:D3(),Ellipse:I3(),Intersects:u4(),Line:p4(),Mesh:v4(),Point:w4(),Polygon:T4(),Rectangle:_4(),Triangle:R4()};return i=e(!1,i,t),Y2=i}function O4(){return H2?G2:(H2=1,G2=function(t,e){return function(i,n,s,r){var a=t.getPixelAlpha(n,s,r.texture.key,r.frame.name);return a&&a>=e}})}function F4(){return V2?W2:(V2=1,W2=function(t,e,i){return{gameObject:t,enabled:!0,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:i,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragStartCamera:null,dragX:0,dragY:0}})}function k4(){if(q2)return j2;q2=1;var t=new(Ih())({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});return j2=t}function D4(){return h5?o5:(h5=1,o5={BUTTON_DOWN:Z2?K2:(Z2=1,K2="down"),BUTTON_UP:J2?$2:(J2=1,$2="up"),CONNECTED:t5?Q2:(t5=1,Q2="connected"),DISCONNECTED:i5?e5:(i5=1,e5="disconnected"),GAMEPAD_BUTTON_DOWN:s5?n5:(s5=1,n5="down"),GAMEPAD_BUTTON_UP:a5?r5:(a5=1,r5="up")})}function I4(){if(u5)return l5;u5=1;var t=Ih(),e=D4(),i=new t({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var i=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(e.BUTTON_DOWN,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(e.BUTTON_UP,i,this,t),this.pad.emit(e.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});return l5=i}function B4(){if(d5)return c5;d5=1;var t=k4(),e=I4(),i=Ih(),n=Iz(),s=wu(),r=new i({Extends:n,initialize:function(i,r){n.call(this),this.manager=i,this.pad=r,this.id=r.id,this.index=r.index;for(var a=[],o=0;o<r.buttons.length;o++)a.push(new e(this,o));this.buttons=a;var h=[];for(o=0;o<r.axes.length;o++)h.push(new t(this,o));this.axes=h,this.vibration=r.vibrationActuator;var l={value:0,pressed:!1};this._LCLeft=a[14]?a[14]:l,this._LCRight=a[15]?a[15]:l,this._LCTop=a[12]?a[12]:l,this._LCBottom=a[13]?a[13]:l,this._RCLeft=a[2]?a[2]:l,this._RCRight=a[1]?a[1]:l,this._RCTop=a[3]?a[3]:l,this._RCBottom=a[0]?a[0]:l,this._FBLeftTop=a[4]?a[4]:l,this._FBLeftBottom=a[6]?a[6]:l,this._FBRightTop=a[5]?a[5]:l,this._FBRightBottom=a[7]?a[7]:l;var u={value:0};this._HAxisLeft=h[0]?h[0]:u,this._VAxisLeft=h[1]?h[1]:u,this._HAxisRight=h[2]?h[2]:u,this._VAxisRight=h[3]?h[3]:u,this.leftStick=new s,this.rightStick=new s,this._created=performance.now()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){if(!(t.timestamp<this._created)){var e,i=this.buttons,n=t.buttons,s=i.length;for(e=0;e<s;e++)i[e].update(n[e].value);var r=this.axes,a=t.axes;for(s=r.length,e=0;e<s;e++)r[e].update(a[e]);s>=2&&(this.leftStick.set(r[0].getValue(),r[1].getValue()),s>=4&&this.rightStick.set(r[2].getValue(),r[3].getValue()))}},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});return c5=r}function N4(){if(p5)return f5;p5=1;var t=Tl(),e={},i={register:function(t,i,n,s,r){e[t]={plugin:i,mapping:n,settingsKey:s,configKey:r}},getPlugin:function(t){return e[t]},install:function(i){var n=i.scene.sys,s=n.settings.input,r=n.game.config;for(var a in e){var o=e[a].plugin,h=e[a].mapping,l=e[a].settingsKey,u=e[a].configKey;t(s,l,r[u])&&(i[h]=new o(i))}},remove:function(t){e.hasOwnProperty(t)&&delete e[t]}};return f5=i}function z4(){if(m5)return g5;m5=1;var t=Ih(),e=Iz(),i=D4(),n=B4(),s=Tl(),r=N4(),a=DH(),o=new t({Extends:e,initialize:function(t){e.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.target,this.gamepads=[],this.queue=[],this.onGamepadHandler,this._pad1,this._pad2,this._pad3,this._pad4,t.pluginEvents.once(a.BOOT,this.boot,this),t.pluginEvents.on(a.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,i=t.config;this.enabled=s(e,"gamepad",i.inputGamepad)&&t.device.input.gamepads,this.target=s(e,"gamepad.target",i.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(a.DESTROY,this.destroy,this)},start:function(){this.enabled&&(this.startListeners(),this.refreshPads()),this.sceneInputPlugin.pluginEvents.once(a.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,i=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=i,e.addEventListener("gamepadconnected",i,!1),e.addEventListener("gamepaddisconnected",i,!1),this.sceneInputPlugin.pluginEvents.on(a.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(a.UPDATE,this.update);for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].removeAllListeners()},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads[t].pad.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,i=0;i<t.length;i++){var s=t[i];if(s){var r=s.id,a=s.index,o=e[a];if(o)o.id!==r?(o.destroy(),e[a]=new n(this,s)):o.update(s);else{var h=new n(this,s);e[a]=h,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=h):this._pad3=h:this._pad2=h:this._pad1=h}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,i=0;i<e.length;i++)e[i]&&t.push(e[i]);return t},getPad:function(t){for(var e=this.gamepads,i=0;i<e.length;i++)if(e[i]&&e[i].index===t)return e[i]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var s=e[n],r=this.getPad(s.gamepad.index);"gamepadconnected"===s.type?this.emit(i.CONNECTED,r,s):"gamepaddisconnected"===s.type&&this.emit(i.DISCONNECTED,r,s)}}},shutdown:function(){this.stopListeners(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});return r.register("GamepadPlugin",o,"gamepad","gamepad","inputGamepad"),g5=o}function U4(){if(M5)return A5;M5=1;var t=qh(),e=Bh(),i=Ih(),n=kH(),s=F4(),r=O4(),a=EU(),o=ZW(),h=WW(),l=DH(),u=Iz(),c=kh(),d=Nh(),f=N4(),p=Vo(),g=Cu(),m=Eu(),v=cu(),y=Au(),x=wj(),w=vj(),b=new i({Extends:u,initialize:function(t){u.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new u,this.enabled=!0,this.displayList,this.cameras,f.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(y.BOOT,this.boot,this),t.sys.events.on(y.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(y.DESTROY,this.destroy,this),this.pluginEvents.emit(l.BOOT)},start:function(){var t=this.systems.events;t.on(y.TRANSITION_START,this.transitionIn,this),t.on(y.TRANSITION_OUT,this.transitionOut,this),t.on(y.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(y.PRE_UPDATE,this.preUpdate,this),t.once(y.SHUTDOWN,this.shutdown,this),this.manager.events.on(l.GAME_OUT,this.onGameOut,this),this.manager.events.on(l.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(l.START)},onGameOver:function(t){this.isActive()&&this.emit(l.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(l.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(l.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,i=t.length,n=e.length;if(0!==i||0!==n){for(var s=this._list,r=0;r<i;r++){var a=t[r],o=s.indexOf(a);o>-1&&(s.splice(o,1),this.clear(a,!0))}this._pendingRemoval.length=0,this._list=s.concat(e.splice(0))}},isActive:function(){return this.manager&&this.manager.enabled&&this.enabled&&this.scene.sys.canInput()},setCursor:function(t){this.manager&&this.manager.setCursor(t)},resetCursor:function(){this.manager&&this.manager.resetCursor(null,!0)},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(l.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var i,n=this.manager.pointers;for(i=0;i<n.length;i++)n[i].updateMotion();if(0===this._list.length)return!1;var s=this.pollRate;if(-1===s)return!1;if(s>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var r=!1;for(i=0;i<n.length;i++){var a=0,o=n[i];this._tempZones=[],this._temp=this.hitTestPointer(o),this.sortGameObjects(this._temp,o),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),a+=this.processOverOutEvents(o),2===this.getDragState(o)&&this.processDragThresholdEvent(o,t),a>0&&(r=!0)}return r},update:function(t,e){if(!this.isActive())return!1;for(var i=!1,s=0;s<e.length;s++){var r=0,a=e[s];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp,a),this.sortDropZones(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case n.MOUSE_DOWN:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_UP:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOverOutEvents(a);break;case n.TOUCH_START:r+=this.processDragDownEvent(a),r+=this.processDownEvents(a),r+=this.processOverEvents(a);break;case n.TOUCH_END:case n.TOUCH_CANCEL:r+=this.processDragUpEvent(a),r+=this.processUpEvents(a),r+=this.processOutEvents(a);break;case n.MOUSE_MOVE:case n.TOUCH_MOVE:r+=this.processDragMoveEvent(a),r+=this.processMoveEvents(a),r+=this.processOverOutEvents(a);break;case n.MOUSE_WHEEL:r+=this.processWheelEvent(a)}r>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1),this.disable(t);var i=t.input;i&&(this.removeDebug(t),this.manager.resetCursor(i),i.gameObject=void 0,i.target=void 0,i.hitArea=void 0,i.hitAreaCallback=void 0,i.callbackContext=void 0,t.input=null),e||this.queueForRemoval(t);var n=this._draggable.indexOf(t);return n>-1&&this._draggable.splice(n,1),t},disable:function(t,e){void 0===e&&(e=!1);var i=t.input;i&&(i.enabled=!1,i.dragState=0);for(var n,s=this._drag,r=this._over,a=this.manager,o=0;o<a.pointers.length;o++)(n=s[o].indexOf(t))>-1&&s[o].splice(n,1),(n=r[o].indexOf(t))>-1&&r[o].splice(n,1);return e&&this.resetCursor(),this},enable:function(t,e,i,n){return void 0===n&&(n=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,i),t.input&&n&&!t.input.dropZone&&(t.input.dropZone=n),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),i=0;i<e.length;i++){for(var n=e[i],s=this.manager.hitTest(t,this._list,n),r=0;r<s.length;r++){var a=s[r];a.input.dropZone&&this._tempZones.push(a)}if(s.length>0)return t.camera=n,s}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled&&(this.emit(l.GAMEOBJECT_DOWN,t,a,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&(t.downElement===this.manager.game.canvas?this.emit(l.POINTER_DOWN,t,i):this.emit(l.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var i=!1,n=this.dragTimeThreshold,s=this.dragDistanceThreshold;if((s>0&&a(t.x,t.y,t.downX,t.downY)>=s||n>0&&e>=t.downTime+n)&&(i=!0),i)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;s.dragState=2,s.dragStartX=n.x,s.dragStartY=n.y,s.dragStartXGlobal=t.worldX,s.dragStartYGlobal=t.worldY,s.dragStartCamera=t.camera,s.dragX=s.dragStartXGlobal-s.dragStartX,s.dragY=s.dragStartYGlobal-s.dragStartY,n.emit(l.GAMEOBJECT_DRAG_START,t,s.dragX,s.dragY),this.emit(l.DRAG_START,t,n)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var i=[],n=0;n<e.length;n++){var s=e[n];s.input.draggable&&0===s.input.dragState&&i.push(s)}return 0===i.length?(this.setDragState(t,0),0):(i.length>1&&(this.sortGameObjects(i,t),this.topOnly&&i.splice(1)),this._drag[t.id]=i,0===this.dragDistanceThreshold&&0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(2===this.getDragState(t)&&this.processDragThresholdEvent(t,this.manager.game.loop.now),4!==this.getDragState(t))return 0;var e=this._tempZones,i=this._drag[t.id];i.length>1&&(i=i.slice(0));for(var n=0;n<i.length;n++){var s,r,a=i[n],o=a.input,h=o.target;if(h){var u=e.indexOf(h);0===u?(a.emit(l.GAMEOBJECT_DRAG_OVER,t,h),this.emit(l.DRAG_OVER,t,a,h)):u>0?(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):(a.emit(l.GAMEOBJECT_DRAG_LEAVE,t,h),this.emit(l.DRAG_LEAVE,t,a,h),e[0]?(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h)):o.target=null)}else!h&&e[0]&&(o.target=e[0],h=o.target,a.emit(l.GAMEOBJECT_DRAG_ENTER,t,h),this.emit(l.DRAG_ENTER,t,a,h));var c=t.positionToCamera(o.dragStartCamera);if(a.parentContainer){var d=c.x-o.dragStartXGlobal,f=c.y-o.dragStartYGlobal,p=a.getParentRotation(),g=d*Math.cos(p)+f*Math.sin(p),m=f*Math.cos(p)-d*Math.sin(p);g*=1/a.parentContainer.scaleX,m*=1/a.parentContainer.scaleY,s=g+o.dragStartX,r=m+o.dragStartY}else s=c.x-o.dragX,r=c.y-o.dragY;a.emit(l.GAMEOBJECT_DRAG,t,s,r),this.emit(l.DRAG,t,a,s,r)}return i.length},processDragUpEvent:function(t){var e=this._drag[t.id];e.length>1&&(e=e.slice(0));for(var i=0;i<e.length;i++){var n=e[i],s=n.input;if(s&&2===s.dragState){s.dragState=0,s.dragX=s.localX-n.displayOriginX,s.dragY=s.localY-n.displayOriginY,s.dragStartCamera=null;var r=!1,a=s.target;a&&(n.emit(l.GAMEOBJECT_DROP,t,a),this.emit(l.DROP,t,n,a),s.target=null,r=!0),n.input&&n.input.enabled&&(n.emit(l.GAMEOBJECT_DRAG_END,t,s.dragX,s.dragY,r),this.emit(l.DRAG_END,t,n,r))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a.input&&a.input.enabled){if(e++,a.emit(l.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,s),n.cancelled||!this.isActive())break;if(a.input&&a.input.enabled){if(this.emit(l.GAMEOBJECT_MOVE,t,a,s),n.cancelled||!this.isActive())break;if(this.topOnly)break}}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_MOVE,t,i),e},processWheelEvent:function(t){var e=0,i=this._temp,n=this._eventData,s=this._eventContainer;n.cancelled=!1;for(var r=t.deltaX,a=t.deltaY,o=t.deltaZ,h=0;h<i.length;h++){var u=i[h];if(u.input&&u.input.enabled){if(e++,u.emit(l.GAMEOBJECT_POINTER_WHEEL,t,r,a,o,s),n.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_WHEEL,t,u,r,a,o,s),n.cancelled||!this.isActive()))break}}return!n.cancelled&&this.isActive()&&this.emit(l.POINTER_WHEEL,t,i,r,a,o),e},processOverEvents:function(t){var e=this._temp,i=0,n=e.length,s=[];if(n>0){var r=this.manager,a=this._eventData,o=this._eventContainer;a.cancelled=!1;for(var h=0;h<n;h++){var u=e[h];if(u.input&&u.input.enabled){if(s.push(u),r.setCursor(u.input),u.emit(l.GAMEOBJECT_POINTER_OVER,t,u.input.localX,u.input.localY,o),i++,a.cancelled||!this.isActive())break;if(u.input&&u.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,u,o),a.cancelled||!this.isActive()))break}}!a.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,s)}return this._over[t.id]=s,i},processOutEvents:function(t){var e=this._over[t.id],i=0,n=e.length;if(n>0){var s=this.manager,r=this._eventData,a=this._eventContainer;r.cancelled=!1,this.sortGameObjects(e,t);for(var o=0;o<n;o++){var h=e[o];if((h=e[o]).input&&h.input.enabled){if(s.resetCursor(h.input),h.emit(l.GAMEOBJECT_POINTER_OUT,t,a),i++,r.cancelled||!this.isActive())break;if(h.input&&h.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,h,a),r.cancelled||!this.isActive()))break}}!r.cancelled&&this.isActive()&&this.emit(l.POINTER_OUT,t,e),this._over[t.id]=[]}return i},processOverOutEvents:function(t){var e,i,n=this._temp,s=[],r=[],a=[],o=this._over[t.id],h=this._drag[t.id],u=this.manager;for(e=0;e<o.length;e++)i=o[e],-1===n.indexOf(i)&&-1===h.indexOf(i)?s.push(i):a.push(i);for(e=0;e<n.length;e++)i=n[e],-1===o.indexOf(i)&&r.push(i);var c=s.length,d=0,f=this._eventData,p=this._eventContainer;if(f.cancelled=!1,c>0){for(this.sortGameObjects(s,t),e=0;e<c;e++)if((i=s[e]).input&&i.input.enabled){if(u.resetCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OUT,t,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OUT,t,i,p),f.cancelled||!this.isActive()))break}f.cancelled&&!this.isActive()||this.emit(l.POINTER_OUT,t,s)}if(c=r.length,f.cancelled=!1,c>0){for(this.sortGameObjects(r,t),e=0;e<c;e++)if((i=r[e]).input&&i.input.enabled){if(u.setCursor(i.input),i.emit(l.GAMEOBJECT_POINTER_OVER,t,i.input.localX,i.input.localY,p),d++,f.cancelled||!this.isActive())break;if(i.input&&i.input.enabled&&(this.emit(l.GAMEOBJECT_OVER,t,i,p),f.cancelled||!this.isActive()))break}!f.cancelled&&this.isActive()&&this.emit(l.POINTER_OVER,t,r)}return o=a.concat(r),this._over[t.id]=this.sortGameObjects(o,t),d},processUpEvents:function(t){var e=this._temp,i=this._eventData,n=this._eventContainer;i.cancelled=!1;for(var s=0;s<e.length;s++){var r=e[s];if(r.input&&r.input.enabled){if(r.emit(l.GAMEOBJECT_POINTER_UP,t,r.input.localX,r.input.localY,n),i.cancelled||!this.isActive())break;if(r.input&&r.input.enabled&&(this.emit(l.GAMEOBJECT_UP,t,r,n),i.cancelled||!this.isActive()))break}}return!i.cancelled&&this.isActive()&&(t.upElement===this.manager.game.canvas?this.emit(l.POINTER_UP,t,e):this.emit(l.POINTER_UP_OUTSIDE,t)),e.length},forceDownState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_DOWN,l.GAMEOBJECT_DOWN,!1)},forceUpState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_UP,l.GAMEOBJECT_UP,!1)},forceOverState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OVER,l.GAMEOBJECT_OVER,!0)},forceOutState:function(t,e){this.forceState(t,e,l.GAMEOBJECT_POINTER_OUT,l.GAMEOBJECT_OUT,!1)},forceState:function(t,e,i,n,s){var r=this._eventData,a=this._eventContainer;r.cancelled=!1,e.input&&e.input.enabled&&(e.emit(i,t,e.input.localX,e.input.localY,a),s&&this.setCursor(e.input),!r.cancelled&&this.isActive()&&e.input&&e.input.enabled&&this.emit(n,t,e,a))},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];n.input.draggable=e;var s=this._draggable.indexOf(n);e&&-1===s?this._draggable.push(n):!e&&s>-1&&this._draggable.splice(s,1)}return this},makePixelPerfect:function(t){void 0===t&&(t=1);var e=this.systems.textures;return r(e,t)},setHitArea:function(t,e,i){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var n=!1,r=!1,a=!1,o=!1,h=!1,l=!0;if(p(e)&&Object.keys(e).length){var u=e,d=t.some(function(t){return t.hasOwnProperty("faces")});if(!d){e=c(u,"hitArea",null),i=c(u,"hitAreaCallback",null),h=c(u,"pixelPerfect",!1);var f=c(u,"alphaTolerance",1);h&&(e={},i=this.makePixelPerfect(f))}n=c(u,"draggable",!1),r=c(u,"dropZone",!1),a=c(u,"cursor",!1),o=c(u,"useHandCursor",!1),e&&i||(this.setHitAreaFromTexture(t),l=!1)}else"function"!=typeof e||i||(i=e,e={});for(var g=0;g<t.length;g++){var m=t[g];if(h&&"Container"===m.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var v=m.input?m.input:s(m,e,i);v.customHitArea=l,v.dropZone=r,v.cursor=o?"pointer":a,m.input=v,n&&this.setDraggable(m),this.queueForInsertion(m)}}return this},setHitAreaCircle:function(i,n,s,r,a){void 0===a&&(a=e);var o=new t(n,s,r);return this.setHitArea(i,o,a)},setHitAreaEllipse:function(t,e,i,n,s,r){void 0===r&&(r=h);var a=new o(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=v),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i],r=n.frame,a=0,o=0;n.width?(a=n.width,o=n.height):r&&(a=r.realWidth,o=r.realHeight),"Container"!==n.type||0!==a&&0!==o?0!==a&&0!==o&&(n.input=s(n,new m(0,0,a,o),e),this.queueForInsertion(n)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,i,n,s,r){void 0===r&&(r=v);var a=new m(e,i,n,s);return this.setHitArea(t,a,r)},setHitAreaTriangle:function(t,e,i,n,s,r,a,o){void 0===o&&(o=w);var h=new x(e,i,n,s,r,a);return this.setHitArea(t,h,o)},enableDebug:function(t,e){void 0===e&&(e=65280);var i=t.input;if(!i||!i.hitArea)return this;var n=i.hitArea,s=n.type,r=i.hitAreaDebug,a=this.systems.add,o=this.systems.updateList;r&&(o.remove(r),r.destroy(),r=null);var h=0,l=0;switch(s){case d.CIRCLE:r=a.arc(0,0,n.radius),h=n.x-n.radius,l=n.y-n.radius;break;case d.ELLIPSE:r=a.ellipse(0,0,n.width,n.height),h=n.x-n.width/2,l=n.y-n.height/2;break;case d.LINE:r=a.line(0,0,n.x1,n.y1,n.x2,n.y2);break;case d.POLYGON:r=a.polygon(0,0,n.points);break;case d.RECTANGLE:r=a.rectangle(0,0,n.width,n.height),h=n.x,l=n.y;break;case d.TRIANGLE:r=a.triangle(0,0,n.x1,n.y1,n.x2,n.y2,n.x3,n.y3)}return r&&(r.isFilled=!1,r.strokeColor=e,r.preUpdate=function(){r.setVisible(t.visible),r.setStrokeStyle(1/t.scale,r.strokeColor),r.setDisplayOrigin(t.displayOriginX,t.displayOriginY);var e=t.x,i=t.y,n=t.rotation,s=t.scaleX,a=t.scaleY;if(t.parentContainer){var o=t.getWorldTransformMatrix();e=o.tx,i=o.ty,n=o.rotation,s=o.scaleX,a=o.scaleY}r.setRotation(n),r.setScale(s,a),r.setPosition(e+h*s,i+l*a),r.setScrollFactor(t.scrollFactorX,t.scrollFactorY),r.setDepth(t.depth)},o.add(r),i.hitAreaDebug=r),this},removeDebug:function(t){var e=t.input;return e&&e.hitAreaDebug&&(e.hitAreaDebug.destroy(),e.hitAreaDebug=null),this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t,e){if(t.length<2||!e.camera)return t;var i=e.camera.renderList;return t.sort(function(t,e){var n=Math.max(i.indexOf(t),0);return Math.max(i.indexOf(e),0)-n})},sortDropZones:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortDropZoneHandler.bind(this)))},sortDropZoneHandler:function(t,e){if(t.parentContainer||e.parentContainer){if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var i=t.getIndexList(),n=e.getIndexList(),s=Math.min(i.length,n.length),r=0;r<s;r++){var a=i[r],o=n[r];if(a!==o)return o-a}return n.length-i.length}return this.displayList.getIndex(e)-this.displayList.getIndex(t)},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(l.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.manager;e.canvas.style.cursor=e.defaultCursor;var i=this.systems.events;i.off(y.TRANSITION_START,this.transitionIn,this),i.off(y.TRANSITION_OUT,this.transitionOut,this),i.off(y.TRANSITION_COMPLETE,this.transitionComplete,this),i.off(y.PRE_UPDATE,this.preUpdate,this),e.events.off(l.GAME_OUT,this.onGameOut,this),e.events.off(l.GAME_OVER,this.onGameOver,this),i.off(y.SHUTDOWN,this.shutdown,this)},resetPointers:function(){for(var t=this.manager.pointers,e=0;e<t.length;e++)t[e].reset()},destroy:function(){this.shutdown(),this.pluginEvents.emit(l.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(y.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});return g.register("InputPlugin",b,"input"),A5=b}function Y4(){return H5?G5:(H5=1,G5={ANY_KEY_DOWN:R5?P5:(R5=1,P5="keydown"),ANY_KEY_UP:O5?L5:(O5=1,L5="keyup"),COMBO_MATCH:k5?F5:(k5=1,F5="keycombomatch"),DOWN:I5?D5:(I5=1,D5="down"),KEY_DOWN:N5?B5:(N5=1,B5="keydown-"),KEY_UP:U5?z5:(U5=1,z5="keyup-"),UP:X5?Y5:(X5=1,Y5="up")})}function X4(){if(V5)return W5;V5=1;var t=Ih(),e=Iz(),i=Y4(),n=new t({Extends:e,initialize:function(t,i){e.call(this),this.plugin=t,this.keyCode=i,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(i.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(i.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(i.UP,this,t))},reset:function(){return this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});return W5=n}function G4(){return q5?j5:(q5=1,j5=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)})}function H4(){if(Z5)return K5;Z5=1;var t=G4();return K5=function(e,i){if(i.matched)return!0;var n=!1,s=!1;if(e.keyCode===i.current)if(i.index>0&&i.maxKeyDelay>0){var r=i.timeLastMatched+i.maxKeyDelay;e.timeStamp<=r&&(s=!0,n=t(e,i))}else s=!0,n=t(e,i);return!s&&i.resetOnWrongKey&&(i.index=0,i.current=i.keyCodes[0]),n&&(i.timeLastMatched=e.timeStamp,i.matched=!0,i.timeMatched=e.timeStamp),n}}function W4(){return J5?$5:(J5=1,$5=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t})}function V4(){if(t3)return Q5;t3=1;var t=Ih(),e=Y4(),i=kh(),n=H4(),s=W4(),r=new t({initialize:function(t,r,a){if(void 0===a&&(a={}),r.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var o=0;o<r.length;o++){var h=r[o];"string"==typeof h?this.keyCodes.push(h.toUpperCase().charCodeAt(0)):"number"==typeof h?this.keyCodes.push(h):h.hasOwnProperty("keyCode")&&this.keyCodes.push(h.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=i(a,"resetOnWrongKey",!0),this.maxKeyDelay=i(a,"maxKeyDelay",0),this.resetOnMatch=i(a,"resetOnMatch",!1),this.deleteOnMatch=i(a,"deleteOnMatch",!1);var l=this;this.onKeyDown=function(t){!l.matched&&l.enabled&&n(t,l)&&(l.manager.emit(e.COMBO_MATCH,l,t),l.resetOnMatch?s(l):l.deleteOnMatch&&l.destroy())},this.manager.on(e.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(e.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});return Q5=r}function j4(){if(s3)return n3;s3=1;var t=Ih(),e=Iz(),i=Y4(),n=iY(),s=Tl(),r=DH(),a=N4(),o=X4(),h=IH(),l=V4(),u=function(){if(i3)return e3;i3=1;var t=IH(),e={};for(var i in t)e[t[i]]=i;return e3=e}(),c=Au(),d=cX(),f=new t({Extends:e,initialize:function(t){e.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],this.prevCode=null,this.prevTime=0,this.prevType=null,t.pluginEvents.once(r.BOOT,this.boot,this),t.pluginEvents.on(r.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=s(t,"keyboard",!0);var e=s(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(r.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.events.on(r.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(r.SHUTDOWN,this.shutdown,this),this.game.events.on(n.BLUR,this.resetKeys,this),this.scene.sys.events.on(c.PAUSE,this.resetKeys,this),this.scene.sys.events.on(c.SLEEP,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.canInput()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:h.UP,down:h.DOWN,left:h.LEFT,right:h.RIGHT,space:h.SPACE,shift:h.SHIFT})},addKeys:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n={};if("string"==typeof t){t=t.split(",");for(var s=0;s<t.length;s++){var r=t[s].trim();r&&(n[r]=this.addKey(r,e,i))}}else for(var a in t)n[a]=this.addKey(t[a],e,i);return n},addKey:function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var n=this.keys;if(t instanceof o){var s=n.indexOf(t);return s>-1?n[s]=t:n[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(i),t}return"string"==typeof t&&(t=h[t.toUpperCase()]),n[t]||(n[t]=new o(this,t),e&&this.addCapture(t),n[t].setEmitOnRepeat(i)),n[t]},removeKey:function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n,s=this.keys;if(t instanceof o){var r=s.indexOf(t);r>-1&&(n=this.keys[r],this.keys[r]=void 0)}else"string"==typeof t&&(t=h[t.toUpperCase()]);return s[t]&&(n=s[t],s[t]=void 0),n&&(n.plugin=null,i&&this.removeCapture(n.keyCode),e&&n.destroy()),this},removeAllKeys:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var i=this.keys,n=0;n<i.length;n++){var s=i[n];s&&(i[n]=void 0,e&&this.removeCapture(s.keyCode),t&&s.destroy())}return this},createCombo:function(t,e){return new l(this,t,e)},checkDown:function(t,e){if(void 0===e&&(e=0),this.enabled&&t.isDown){var i=d(this.time-t.timeDown,e);if(i>t._tick)return t._tick=i,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,s=0;s<e;s++){var r=t[s],a=r.keyCode,o=n[a],h=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&(a===this.prevCode&&r.timeStamp===this.prevTime&&r.type===this.prevType||(this.prevCode=a,this.prevTime=r.timeStamp,this.prevType=r.type,"keydown"===r.type?(o&&(h=o.isDown,o.onDown(r)),r.cancelled||o&&h||(u[a]&&this.emit(i.KEY_DOWN+u[a],r),r.cancelled||this.emit(i.ANY_KEY_DOWN,r))):(o&&o.onUp(r),r.cancelled||(u[a]&&this.emit(i.KEY_UP+u[a],r),r.cancelled||this.emit(i.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0)))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.removeAllKeys(!0),this.removeAllListeners(),this.sceneInputPlugin.manager.events.off(r.MANAGER_PROCESS,this.update,this),this.game.events.off(n.BLUR,this.resetKeys),this.scene.sys.events.off(c.PAUSE,this.resetKeys,this),this.scene.sys.events.off(c.SLEEP,this.resetKeys,this),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});return a.register("KeyboardPlugin",f,"keyboard","keyboard","inputKeyboard"),n3=f}function q4(){if(w3)return x3;w3=1;var t=kH(),e=jo(),i={CreatePixelPerfectHandler:O4(),CreateInteractiveObject:F4(),Events:DH(),Gamepad:C5?_5:(C5=1,_5={Axis:k4(),Button:I4(),Events:D4(),Gamepad:B4(),GamepadPlugin:z4(),Configs:S5?E5:(S5=1,E5={DUALSHOCK_4:y5?v5:(y5=1,v5={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}),SNES_USB:w5?x5:(w5=1,x5={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}),XBOX_360:T5?b5:(T5=1,b5={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3})})}),InputManager:YH(),InputPlugin:U4(),InputPluginCache:N4(),Keyboard:p3?f3:(p3=1,f3={Events:Y4(),KeyboardManager:BH(),KeyboardPlugin:j4(),Key:X4(),KeyCodes:IH(),KeyCombo:V4(),AdvanceKeyCombo:G4(),ProcessKeyCombo:H4(),ResetKeyCombo:W4(),JustDown:a3?r3:(a3=1,r3=function(t){return!!t._justDown&&(t._justDown=!1,!0)}),JustUp:h3?o3:(h3=1,o3=function(t){return!!t._justUp&&(t._justUp=!1,!0)}),DownDuration:u3?l3:(u3=1,l3=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeDown;return t.isDown&&i<e}),UpDuration:d3?c3:(d3=1,c3=function(t,e){void 0===e&&(e=50);var i=t.plugin.game.loop.time-t.timeUp;return t.isUp&&i<e})}),Mouse:m3?g3:(m3=1,g3={MouseManager:NH()}),Pointer:zH(),Touch:y3?v3:(y3=1,v3={TouchManager:UH()})};return i=e(!1,i,t),x3=i}var K4,Z4,$4,J4,Q4,t6,e6,i6,n6,s6,r6,a6,o6,h6,l6,u6,c6,d6,f6,p6,g6,m6,v6,y6,x6,w6,b6,T6,E6,S6,_6,C6,A6={};function M6(){return Z4?K4:(Z4=1,K4={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19,FILE_PENDING_DESTROY:20})}function P6(){return J4?$4:(J4=1,$4=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)})}function R6(){return t6?Q4:(t6=1,Q4=function(t,e,i,n,s,r){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===i&&(i=""),void 0===n&&(n=""),void 0===s&&(s=0),void 0===r&&(r=!1),{responseType:t,async:e,user:i,password:n,timeout:s,headers:void 0,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0,withCredentials:r}})}function L6(){if(i6)return e6;i6=1;var t=jo(),e=R6();return e6=function(i,n){var s=void 0===i?e():t({},i);if(n)for(var r in n)void 0!==n[r]&&(s[r]=n[r]);return s}}function O6(){if(s6)return n6;s6=1;var t=L6();return n6=function(e,i){var n=t(i,e.xhrSettings);if(e.base64){var s,r=e.url.split(";base64,").pop()||e.url.split(",").pop();return s="arraybuffer"===e.xhrSettings.responseType?{response:Uint8Array.from(atob(r),function(t){return t.charCodeAt(0)}).buffer}:{responseText:atob(r)},void e.onBase64Load(s)}var a=new XMLHttpRequest;if(a.open("GET",e.src,n.async,n.user,n.password),a.responseType=e.xhrSettings.responseType,a.timeout=n.timeout,n.headers)for(var o in n.headers)a.setRequestHeader(o,n.headers[o]);return n.header&&n.headerValue&&a.setRequestHeader(n.header,n.headerValue),n.requestedWith&&a.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&a.overrideMimeType(n.overrideMimeType),n.withCredentials&&(a.withCredentials=!0),a.onload=e.onLoad.bind(e,a),a.onerror=e.onError.bind(e,a),a.onprogress=e.onProgress.bind(e),a.ontimeout=e.onError.bind(e,a),a.send(),a}}function F6(){if(a6)return r6;a6=1;var t=Ih(),e=M6(),i=qH(),n=kh(),s=P6(),r=L6(),a=O6(),o=R6(),h=new t({initialize:function(t,i){if(this.loader=t,this.cache=n(i,"cache",!1),this.type=n(i,"type",!1),!this.type)throw new Error("Invalid File type: "+this.type);this.key=n(i,"key",!1);var s=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+s),!this.key)throw new Error("Invalid File key: "+this.key);var a=n(i,"url");void 0===a?a=t.path+s+"."+n(i,"extension",""):"string"!=typeof a||a.match(/^(?:blob:|data:|capacitor:\/\/|http:\/\/|https:\/\/|\/\/)/)||(a=t.path+a),this.url=a,this.src="",this.xhrSettings=o(n(i,"responseType",void 0)),n(i,"xhrSettings",!1)&&(this.xhrSettings=r(this.xhrSettings,n(i,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?e.FILE_POPULATED:e.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=n(i,"config",{}),this.multiFile,this.linkFile,this.base64="string"==typeof a&&0===a.indexOf("data:"),this.retryAttempts=n(i,"maxRetries",t.maxRetries)},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){if(this.state===e.FILE_POPULATED)this.loader.nextFile(this,!0);else{if(this.state=e.FILE_LOADING,this.src=s(this,this.loader.baseURL),!this.src)throw new Error("URL Error in File: "+this.key+" from: "+this.url);0===this.src.indexOf("data:")&&(this.base64=!0),this.xhrLoader=a(this,this.loader.xhr)}},onLoad:function(t,i){var n=t.responseURL&&this.loader.localSchemes.some(function(e){return 0===t.responseURL.indexOf(e)})&&0===i.target.status,s=!(i.target&&200!==i.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(s=!1),this.state=e.FILE_LOADED,this.resetXHR(),this.loader.nextFile(this,s)},onBase64Load:function(t){this.xhrLoader=t,this.state=e.FILE_LOADED,this.percentComplete=1,this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete),this.loader.nextFile(this,!0)},onError:function(){this.resetXHR(),this.retryAttempts>0?(this.retryAttempts--,this.load()):this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(i.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=e.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=e.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){console.error('Failed to process file: %s "%s"',this.type,this.key),this.state=e.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.data&&this.cache.add(this.key,this.data)},pendingDestroy:function(t){if(this.state!==e.FILE_PENDING_DESTROY){void 0===t&&(t=this.data);var n=this.key,s=this.type;this.loader.emit(i.FILE_COMPLETE,n,s,t),this.loader.emit(i.FILE_KEY_COMPLETE+s+"-"+n,n,s,t),this.loader.flagForRemoval(this),this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});return h.createObjectURL=function(t,e,i){if("function"==typeof URL)t.src=URL.createObjectURL(e);else{var n=new FileReader;n.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||i)+";base64,"+n.result.split(",")[1]},n.onerror=t.onerror,n.readAsDataURL(e)}},h.revokeObjectURL=function(t){"function"==typeof URL&&URL.revokeObjectURL(t.src)},r6=h}function k6(){if(h6)return o6;h6=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Tl(),a=Vo(),o=new t({Extends:i,initialize:function(t,n,o,h,l){var u="json";if(a(n)){var c=n;n=s(c,"key"),o=s(c,"url"),h=s(c,"xhrSettings"),u=s(c,"extension",u),l=s(c,"dataKey",l)}var d={type:"json",cache:t.cacheManager.json,extension:u,responseType:"text",key:n,url:o,xhrSettings:h,config:l};i.call(this,t,d),a(o)&&(this.data=l?r(o,l):o,this.state=e.FILE_POPULATED)},onProcess:function(){if(this.state!==e.FILE_POPULATED){this.state=e.FILE_PROCESSING;try{var t=JSON.parse(this.xhrLoader.responseText)}catch(t){throw this.onProcessError(),t}var i=this.config;this.data="string"==typeof i?r(t,i,t):t}this.onProcessComplete()}});return n.register("json",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,n,i));return this}),o6=o}function D6(){if(u6)return l6;u6=1;var t=Ih(),e=XH(),i=k6(),n=qH(),s=new t({Extends:i,initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.type="animationJSON"},onProcess:function(){this.loader.once(n.POST_PROCESS,this.onLoadComplete,this),i.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});return e.register("animation",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),l6=s}function I6(){if(d6)return c6;d6=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=P6(),o=new t({Extends:i,initialize:function t(e,n,a,o,h){var l,u="png";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"normalMap"),o=s(c,"xhrSettings"),u=s(c,"extension",u),h=s(c,"frameConfig")}Array.isArray(a)&&(l=a[1],a=a[0]);var d={type:"image",cache:e.textureManager,extension:u,responseType:"blob",key:n,url:a,xhrSettings:o,config:h};if(i.call(this,e,d),l){var f=new t(e,this.key,l,o,h);f.type="normalMap",this.setLink(f),e.addFile(f)}this.useImageElementLoad="HTMLImageElement"===e.imageLoadType||this.base64,this.useImageElementLoad&&(this.load=this.loadImage,this.onProcess=this.onProcessImage)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){i.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(t.data),t.onProcessError()},i.createObjectURL(this.data,this.xhrLoader.response,"image/png")},onProcessImage:function(){var t=this.state;this.state=e.FILE_PROCESSING,t===e.FILE_LOADED?this.onProcessComplete():this.onProcessError()},loadImage:function(){this.state=e.FILE_LOADING,this.src=a(this,this.loader.baseURL),this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){t.state=e.FILE_LOADED,t.loader.nextFile(t,!0)},this.data.onerror=function(){t.loader.nextFile(t,!1)},this.data.src=this.src},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("spritesheet"===t.type?t.addToCache():"normalMap"===this.type?this.cache.addImage(this.key,t.data,this.data):this.cache.addImage(this.key,this.data,t.data)):this.cache.addImage(this.key,this.data)}});return n.register("image",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),c6=o}function B6(){if(p6)return f6;p6=1;var t=Ih(),e=M6(),i=qH(),n=new t({initialize:function(t,i,n,s){var r=[];s.forEach(function(t){t&&r.push(t)}),this.loader=t,this.type=i,this.key=n;var a=this.key;t.prefix&&""!==t.prefix&&(this.key=t.prefix+a),this.multiKeyIndex=t.multiKeyIndex++,this.files=r,this.state=e.FILE_PENDING,this.complete=!1,this.pending=r.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var o=0;o<r.length;o++)r[o].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&(this.failed++,console.error('File failed: %s "%s" (via %s "%s")',this.type,this.key,t.type,t.key))},pendingDestroy:function(){if(this.state!==e.FILE_PENDING_DESTROY){var t=this.key,n=this.type;this.loader.emit(i.FILE_COMPLETE,t,n),this.loader.emit(i.FILE_KEY_COMPLETE+n+"-"+t,t,n),this.loader.flagForRemoval(this);for(var s=0;s<this.files.length;s++)this.files[s].pendingDestroy();this.state=e.FILE_PENDING_DESTROY}},destroy:function(){this.loader=null,this.files=null,this.config=null}});return f6=n}function N6(){if(m6)return g6;m6=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=k6(),a=B6(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),e.addToCache(),this.complete=!0}}});return e.register("aseprite",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),g6=o}function z6(){if(y6)return v6;y6=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=k6(),a=B6(),o=new t({Extends:a,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new r(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","json"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new r(t,e,h,u);c.linkFile?a.call(this,t,"atlasjson",e,[c,d,c.linkFile]):a.call(this,t,"atlasjson",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),v6=o}function U6(){if(w6)return x6;w6=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=RH(),o=new t({Extends:i,initialize:function(t,e,n,a){var o="xml";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"xml",cache:t.cacheManager.xml,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=a(this.xhrLoader.responseText),this.data?this.onProcessComplete():this.onProcessError()}});return n.register("xml",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),x6=o}function Y6(){if(T6)return b6;T6=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=B6(),a=U6(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","xml"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"atlasxml",e,[c,d,c.linkFile]):r.call(this,t,"atlasxml",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("atlasXML",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),b6=o}function X6(){if(S6)return E6;S6=1;var t=Ih(),e=qH(),i=F6(),n=kh(),s=P6(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,s,a){if(r(e)){var o=e;e=n(o,"key"),a=n(o,"config",a)}var h={type:"audio",cache:t.cacheManager.audio,extension:s.type,key:e,url:s.url,config:a};i.call(this,t,h),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var i=t.target;i.oncanplaythrough=null,i.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(e.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var i=new Audio;i.dataset||(i.dataset={}),i.dataset.name=this.key+("0"+e).slice(-2),i.dataset.used="false",this.locked?i.dataset.locked="true":(i.dataset.locked="false",i.preload="auto",i.oncanplaythrough=this.onProgress.bind(this),i.onerror=this.onError.bind(this)),this.data.push(i)}for(e=0;e<this.data.length;e++)(i=this.data[e]).src=s(this,this.loader.baseURL),this.locked||i.load();this.locked&&setTimeout(this.onLoad.bind(this))}});return E6=a}function G6(){if(C6)return _6;C6=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=X6(),a=Vo(),o=new t({Extends:i,initialize:function(t,e,n,r,o){if(a(e)){var h=e;e=s(h,"key"),r=s(h,"xhrSettings"),o=s(h,"context",o)}var l={type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:r,config:{context:o}};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(e){t.data=e,t.onProcessComplete()},function(e){console.error("Error decoding audio: "+t.key+" - ",e?e.message:null),t.onProcessError()}),this.config.context=null}});return o.create=function(t,e,i,n,h){var l=t.systems.game,u=l.config.audio,c=l.device.audio;a(e)&&(i=s(e,"url",[]),n=s(e,"config",{}));var d=o.getAudioURL(l,i);return d?c.webAudio&&!u.disableWebAudio?new o(t,e,d,h,l.sound.context):new r(t,e,d,n):(console.warn('No audio URLs for "%s" can play on this device',e),null)},o.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var n=s(e[i],"url",e[i]);if(0===n.indexOf("blob:")||0===n.indexOf("data:"))return{url:n,type:""};var r=n.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=s(e[i],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:n,type:r}}return null},n.register("audio",function(t,e,i,n){var s,r=this.systems.game,a=r.config.audio,h=r.device.audio;if(a.noAudio||!h.webAudio&&!h.audioData)return this;if(Array.isArray(t))for(var l=0;l<t.length;l++)(s=o.create(this,t[l]))&&this.addFile(s);else(s=o.create(this,t,e,i,n))&&this.addFile(s);return this}),_6=o}var H6,W6,V6,j6,q6,K6,Z6,$6,J6,Q6,t8,e8,i8,n8,s8,r8,a8,o8,h8,l8,u8,c8,d8,f8,p8,g8,m8,v8,y8,x8,w8,b8,T8,E8,S8,_8,C8,A8,M8,P8,R8,L8,O8,F8,k8,D8,I8,B8,N8,z8,U8,Y8,X8,G8,H8,W8,V8,j8,q8,K8,Z8,$8,J8,Q8,t7,e7,i7,n7,s7,r7,a7,o7,h7,l7,u7,c7,d7,f7,p7,g7,m7,v7,y7,x7,w7,b7,T7,E7,S7,_7,C7,A7,M7,P7,R7,L7,O7,F7,k7,D7,I7,B7,N7,z7,U7,Y7,X7,G7,H7,W7,V7,j7,q7,K7,Z7,$7,J7,Q7,t9,e9,i9,n9,s9,r9,a9,o9,h9,l9,u9,c9,d9,f9,p9,g9,m9,v9,y9,x9,w9,b9,T9,E9,S9,_9,C9,A9,M9,P9,R9,L9,O9,F9,k9,D9,I9,B9,N9,z9,U9,Y9,X9,G9,H9,W9,V9,j9,q9,K9,Z9,$9,J9,Q9,ttt,ett,itt,ntt,stt,rtt,att,ott={};function htt(){if(H6)return ott;H6=1;var t=G6(),e=Ih(),i=XH(),n=kh(),s=Vo(),r=k6(),a=B6(),o=new e({Extends:a,initialize:function(e,i,o,h,l,u,c){if(s(i)){var d=i;i=n(d,"key"),o=n(d,"jsonURL"),h=n(d,"audioURL"),l=n(d,"audioConfig"),u=n(d,"audioXhrSettings"),c=n(d,"jsonXhrSettings")}var f;if(h){var p=t.create(e,i,h,l,u);p&&(f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[p,f]),this.config.resourceLoad=!1)}else f=new r(e,i,o,c),a.call(this,e,"audiosprite",i,[f]),this.config.resourceLoad=!0,this.config.audioConfig=l,this.config.audioXhrSettings=u},onFileComplete:function(e){if(-1!==this.files.indexOf(e)&&(this.pending--,this.config.resourceLoad&&"json"===e.type&&e.data.hasOwnProperty("resources"))){var i=e.data.resources,s=n(this.config,"audioConfig"),r=n(this.config,"audioXhrSettings"),a=t.create(this.loader,e.key,i,s,r);a&&(this.addToMultiFile(a),this.loader.addFile(a))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.complete=!0}}});return i.register("audioSprite",function(t,e,i,n,s,r){var a,h=this.systems.game,l=h.config.audio,u=h.device.audio;if(l&&l.noAudio||!u.webAudio&&!u.audioData)return this;if(Array.isArray(t))for(var c=0;c<t.length;c++)(a=new o(this,t[c])).files&&this.addFile(a.files);else(a=new o(this,t,e,i,n,s,r)).files&&this.addFile(a.files);return this}),ott}function ltt(){if(V6)return W6;V6=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="bin";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"xhrSettings"),h=s(l,"extension",h),o=s(l,"dataType",o)}var u={type:"binary",cache:t.cacheManager.binary,extension:h,responseType:"arraybuffer",key:e,url:n,xhrSettings:a,config:{dataType:o}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});return n.register("binary",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,n,i));return this}),W6=a}function utt(){if(q6)return j6;q6=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=B6(),a=MW(),o=U6(),h=new t({Extends:r,initialize:function(t,e,a,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new o(t,{key:e,url:i(f,"fontDataURL"),extension:i(f,"fontDataExtension","xml"),xhrSettings:i(f,"fontDataXhrSettings")})}else c=new n(t,e,a,l),d=new o(t,e,h,u);c.linkFile?r.call(this,t,"bitmapfont",e,[c,d,c.linkFile]):r.call(this,t,"bitmapfont",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache();var i=t.cache.get(t.key),n=a(e.data,t.cache.getFrame(t.key),0,0,i);this.loader.cacheManager.bitmapFont.add(t.key,{data:n,texture:t.key,frame:null}),this.complete=!0}}});return e.register("bitmapFont",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),j6=h}function ctt(){if(Z6)return K6;Z6=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=k6(),a=B6(),o=new t({Extends:a,initialize:function(t,e,n,o,h,l,u){if(s(e)){var c=e;e=i(c,"key"),n=i(c,"url",!1)?i(c,"url"):i(c,"atlasURL"),l=i(c,"xhrSettings"),o=i(c,"path"),h=i(c,"baseURL"),u=i(c,"textureXhrSettings")}var d=new r(t,e,n,l);a.call(this,t,"multiatlas",e,[d]),this.config.path=o,this.config.baseURL=h,this.config.textureXhrSettings=u},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,s=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=i(s,"baseURL",this.baseURL),u=i(s,"path",this.path),c=i(s,"prefix",this.prefix),d=i(s,"textureXhrSettings");r.setBaseURL(l),r.setPath(u),r.setPrefix(c);for(var f=0;f<e.length;f++){var p=e[f].image,g="MA"+this.multiKeyIndex+"_"+p,m=new n(r,g,p,d);if(this.addToMultiFile(m),r.addFile(m),e[f].normalMap){var v=new n(r,g,e[f].normalMap,d);v.type="normalMap",m.setLink(v),this.addToMultiFile(v),r.addFile(v)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],i=[],n=[],s=1;s<this.files.length;s++){var r=this.files[s];if("normalMap"!==r.type)for(var a=r.key.indexOf("_"),o=r.key.substr(a+1),h=r.data,l=0;l<t.data.textures.length;l++){var u=t.data.textures[l];if(u.image===o){i.push(h),e.push(u),r.linkFile&&n.push(r.linkFile.data);break}}}0===n.length&&(n=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,i,e,n),this.complete=!0}}});return e.register("multiatlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),K6=o}function dtt(){if(t8)return Q6;t8=1;var t=z6(),e=ltt(),i=Ih(),n=XH(),s=kh(),r=I6(),a=Vo(),o=k6(),h=cW(),l=JH(),u=ctt(),c=B6(),d=dW(),f=function(){if(J6)return $6;J6=1;var t=lX();function e(t){for(var e=t.mipmaps,i=0;i<e.length;i++){var n=e[i].width,s=e[i].height;if((n<<i)%4!=0||(s<<i)%4!=0)return console.warn("BPTC, RGTC, and S3TC dimensions must be a multiple of 4 pixels, and each successive mip level must be half the size of the previous level, rounded down. Mip level "+i+" is "+n+"x"+s),!1}return!0}function i(){return!0}function n(e){var i=e.mipmaps[0];return!!t(i.width,i.height)||(console.warn("PVRTC base dimensions must be power of two. Base level is "+i.width+"x"+i.height),!1)}function s(t){var e=t.mipmaps[0];return e.width%4==0&&e.height%4==0||(console.warn("S3TC SRGB base dimensions must be a multiple of 4 pixels. Base level is "+e.width+"x"+e.height+" pixels"),!1)}var r={37488:i,37489:i,37490:i,37491:i,37492:i,37493:i,37494:i,37495:i,37496:i,37497:i,36196:i,37808:i,37809:i,37810:i,37811:i,37812:i,37813:i,37814:i,37815:i,37816:i,37817:i,37818:i,37819:i,37820:i,37821:i,37840:i,37841:i,37842:i,37843:i,37844:i,37845:i,37846:i,37847:i,37848:i,37849:i,37850:i,37851:i,37852:i,37853:i,36492:e,36493:e,36494:e,36495:e,36283:e,36284:e,36285:e,36286:e,35840:n,35841:n,35842:n,35843:n,33776:e,33777:e,33778:e,33779:e,35916:s,35917:s,35918:s,35919:s};return $6=function(e){for(var i=e.mipmaps,n=1;n<i.length;n++){var s=i[n].width,a=i[n].height;if(!t(s,a))return console.warn("Mip level "+n+" is not a power-of-two size: "+s+"x"+a),!1}var o=r[e.internalFormat];return o?o(e):(console.warn("No format checker found for internal format "+e.internalFormat+". Assuming valid."),!0)},$6}(),p=new i({Extends:c,initialize:function(t,i,n,s){if(n.multiAtlasURL){var r=new o(t,{key:i,url:n.multiAtlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[r])}else{var a=n.textureURL.substr(n.textureURL.length-3);n.type||(n.type="ktx"===a.toLowerCase()?"KTX":"PVR");var h=new e(t,{key:i,url:n.textureURL,extension:a,xhrSettings:s,config:n});if(n.atlasURL){var l=new o(t,{key:i,url:n.atlasURL,xhrSettings:s,config:n});c.call(this,t,"texture",i,[h,l])}else c.call(this,t,"texture",i,[h])}this.config=n},onFileComplete:function(t){if(-1!==this.files.indexOf(t)){if(this.pending--,!this.config.multiAtlasURL)return;if("json"===t.type&&t.data.hasOwnProperty("textures")){var i=t.data.textures,n=this.config,r=this.loader,a=r.baseURL,o=r.path,h=r.prefix,l=s(n,"multiBaseURL",this.baseURL),u=s(n,"multiPath",this.path),c=s(n,"prefix",this.prefix),d=s(n,"textureXhrSettings");l&&r.setBaseURL(l),u&&r.setPath(u),c&&r.setPrefix(c);for(var f=0;f<i.length;f++){var p=i[f].image,g="CMA"+this.multiKeyIndex+"_"+p,m=new e(r,g,p,d);if(this.addToMultiFile(m),r.addFile(m),i[f].normalMap){var v=new e(r,g,i[f].normalMap,d);v.type="normalMap",m.setLink(v),this.addToMultiFile(v),r.addFile(v)}}r.setBaseURL(a),r.setPath(o),r.setPrefix(h)}}},addToCache:function(){function t(t){console.warn('Compressed Texture Invalid: "'+r.key+'". '+t)}if(this.isReadyToProcess()){var e=this.config;if(e.multiAtlasURL)this.addMultiToCache();else{var i,n=this.loader.systems.renderer,s=this.loader.textureManager,r=this.files[0],a=this.files[1];if("PVR"===e.type?i=d(r.data):"KTX"===e.type&&((i=h(r.data))||t("KTX file contains unsupported format.")),i&&!f(i)&&(t("Texture dimensions failed verification. Check the texture format specifications for "+e.format+" 0x"+i.internalFormat.toString(16)+"."),i=null),i&&!n.supportsCompressedTexture(e.format,i.internalFormat)&&(t("Texture format "+e.format+" with internal format "+i.internalFormat+" not supported by the GPU. Texture invalid. This is often due to the texture using sRGB instead of linear RGB."),i=null),i){i.format=n.getCompressedTextureName(e.format,i.internalFormat);var o=a&&a.data?a.data:null;s.addCompressedTexture(r.key,i,o)}}this.complete=!0}},addMultiToCache:function(){for(var t,e=this.config,i=this.files[0],n=[],s=[],r=[],a=this.loader.systems.renderer,o=this.loader.textureManager,l=1;l<this.files.length;l++){var u=this.files[l];if("normalMap"!==u.type)for(var c=u.key.indexOf("_"),f=u.key.substr(c+1),p=u.data,g=0;g<i.data.textures.length;g++){var m=i.data.textures[g];if(m.image===f){"PVR"===e.type?t=d(p):"KTX"===e.type&&(t=h(p)),t&&a.supportsCompressedTexture(e.format,t.internalFormat)&&(t.format=a.getCompressedTextureName(e.format,t.internalFormat),s.push(t),n.push(m),u.linkFile&&r.push(u.linkFile.data));break}}}0===r.length&&(r=void 0),o.addAtlasJSONArray(this.key,s,n,r),this.complete=!0}});return n.register("texture",function(e,i,n){var o=this.systems.renderer,h=function(e,i,n,h){var c={format:null,type:null,textureURL:void 0,atlasURL:void 0,multiAtlasURL:void 0,multiPath:void 0,multiBaseURL:void 0};if(a(i)){var d=i;i=s(d,"key"),n=s(d,"url"),h=s(d,"xhrSettings")}var f=!1;for(var g in n)if(o.supportsCompressedTexture(g)){var m=n[g];"string"==typeof m?c.textureURL=m:c=l(m,c),c.format=g.toUpperCase(),f=!0;break}if(f)if("IMG"===c.format){var v;v=c.multiAtlasURL?new u(e,i,c.multiAtlasURL,c.multiPath,c.multiBaseURL,h).files:c.atlasURL?new t(e,i,c.textureURL,c.atlasURL,h).files:new r(e,i,c.textureURL,h),e.addFile(v)}else{var y=new p(e,i,c,h);e.addFile(y.files)}else console.warn("No supported compressed texture format or IMG fallback",i)};if(Array.isArray(e))for(var c=0;c<e.length;c++)h(this,e[c]);else h(this,e,i,n);return this}),Q6=p}function ftt(){if(i8)return e8;i8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="css";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"script",cache:!1,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("css",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),e8=a}function ptt(){if(s8)return n8;s8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=P6(),a=Vo(),o=new t({Extends:i,initialize:function(t,n,r,o,h,l){var u="ttf";if(a(n)){var c=n;n=s(c,"key"),r=s(c,"url"),o=s(c,"format","truetype"),h=s(c,"descriptors",null),l=s(c,"xhrSettings"),u=s(c,"extension",u)}else void 0===o&&(o="truetype");var d={type:"font",cache:!1,extension:u,responseType:"text",key:n,url:r,xhrSettings:l};i.call(this,t,d),this.data={format:o,descriptors:h},this.state=e.FILE_POPULATED},onProcess:function(){var t;this.state=e.FILE_PROCESSING,this.src=r(this,this.loader.baseURL);var i=this.key,n="url("+this.src+') format("'+this.data.format+'")';t=this.data.descriptors?new FontFace(i,n,this.data.descriptors):new FontFace(i,n);var s=this;t.load().then(function(){document.fonts.add(t),document.body.classList.add("fonts-loaded"),s.onProcessComplete()}).catch(function(){console.warn("Font failed to load",n),s.onProcessComplete()})}});return n.register("font",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new o(this,t[r]));else this.addFile(new o(this,t,e,i,n,s));return this}),n8=o}function gtt(){if(a8)return r8;a8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=pH(),o=new t({Extends:i,initialize:function(t,e,n,a,o){var h="glsl";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"shaderType","fragment"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="fragment");var u={type:"glsl",cache:t.cacheManager.shader,extension:h,responseType:"text",key:e,url:n,config:{shaderType:a},xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var i=this.getShaderName(e.header),n=this.getShaderType(e.header),s=this.getShaderUniforms(e.header),r=e.shader;if(this.cache.has(i)){var o=this.cache.get(i);"fragment"===n?o.fragmentSrc=r:o.vertexSrc=r,o.uniforms||(o.uniforms=s)}else"fragment"===n?this.cache.add(i,new a(i,r,"",s)):this.cache.add(i,new a(i,"",r,s));e=this.extractBlock(t,e.offset)}else"fragment"===this.config.shaderType?this.cache.add(this.key,new a(this.key,this.data)):this.cache.add(this.key,new a(this.key,"",this.data))},getShaderName:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("name:"===i.substring(0,5))return i.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var i=t[e].trim();if("type:"===i.substring(0,5))return i.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},i=0;i<t.length;i++){var n=t[i].trim();if("uniform."===n.substring(0,8)){var s=n.indexOf(":");if(s){var r=n.substring(8,s);try{e[r]=JSON.parse(n.substring(s+1))}catch(t){console.warn("Invalid uniform JSON: "+r)}}}}return e},extractBlock:function(t,e){for(var i=-1,n=-1,s=-1,r=!1,a=!1,o=[],h=[],l=e;l<t.length;l++){var u=t[l].trim();if("---"===u)if(-1===i)i=l,r=!0;else{if(!r){a=!1;break}n=l,r=!1,a=!0}else r?o.push(u):a&&(h.push(u),s=l)}return r||-1===n?null:{header:o,shader:h.join("\n"),offset:s}}});return n.register("glsl",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new o(this,t[s]));else this.addFile(new o(this,t,e,i,n));return this}),r8=o}function mtt(){if(h8)return o8;h8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="html";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",cache:t.cacheManager.html,extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("html",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),o8=a}function vtt(){if(u8)return l8;u8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a,o,h){void 0===a&&(a=512),void 0===o&&(o=512);var l="html";if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),h=s(u,"xhrSettings"),l=s(u,"extension",l),a=s(u,"width",a),o=s(u,"height",o)}var c={type:"html",cache:t.textureManager,extension:l,responseType:"text",key:e,url:n,xhrSettings:h,config:{width:a,height:o}};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.config.width,n=this.config.height,s=[];s.push('<svg width="'+t+'px" height="'+n+'px" viewBox="0 0 '+t+" "+n+'" xmlns="http://www.w3.org/2000/svg">'),s.push('<foreignObject width="100%" height="100%">'),s.push('<body xmlns="http://www.w3.org/1999/xhtml">'),s.push(this.xhrLoader.responseText),s.push("</body>"),s.push("</foreignObject>"),s.push("</svg>");var r=[s.join("\n")],a=this;try{var o=new window.Blob(r,{type:"image/svg+xml;charset=utf-8"})}catch(t){return a.state=e.FILE_ERRORED,void a.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){i.revokeObjectURL(a.data),a.onProcessComplete()},this.data.onerror=function(){i.revokeObjectURL(a.data),a.onProcessError()},i.createObjectURL(this.data,o,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("htmlTexture",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),l8=a}function ytt(){if(d8)return c8;d8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="js";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"type","script"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}else void 0===a&&(a="script");var u={type:a,cache:!1,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});return n.register("script",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),c8=a}function xtt(){if(p8)return f8;p8=1;var t=Ih(),e=XH(),i=kh(),n=Vo(),s=B6(),r=ytt(),a=new t({Extends:s,initialize:function(t,e,a,o){var h="js",l=[];if(n(e)){var u=e;e=i(u,"key"),a=i(u,"url"),o=i(u,"xhrSettings"),h=i(u,"extension",h)}Array.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=new r(t,{key:e+"_"+c.toString(),url:a[c],extension:h,xhrSettings:o});d.onProcess=function(){this.onProcessComplete()},l.push(d)}s.call(this,t,"scripts",e,l)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});return e.register("scripts",function(t,e,i){var n;if(Array.isArray(t))for(var s=0;s<t.length;s++)n=new a(this,t[s]),this.addFile(n.files);else n=new a(this,t,e,i),this.addFile(n.files);return this}),f8=a}function wtt(){if(m8)return g8;m8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="text",h="txt",l=t.cacheManager.text;if(r(e)){var u=e;e=s(u,"key"),n=s(u,"url"),a=s(u,"xhrSettings"),h=s(u,"extension",h),o=s(u,"type",o),l=s(u,"cache",l)}var c={type:o,cache:l,extension:h,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,c)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});return n.register("text",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),g8=a}function btt(){if(y8)return v8;y8=1;var t=Ih(),e=XH(),i=kh(),n=Vo(),s=B6(),r=g4(),a=m4(),o=wtt(),h=new t({Extends:s,initialize:function(t,e,r,a,h,l){var u,c,d=t.cacheManager.obj;if(n(e)){var f=e;e=i(f,"key"),u=new o(t,{key:e,type:"obj",cache:d,url:i(f,"url"),extension:i(f,"extension","obj"),xhrSettings:i(f,"xhrSettings"),config:{flipUV:i(f,"flipUV",h)}}),(a=i(f,"matURL"))&&(c=new o(t,{key:e,type:"mat",cache:d,url:a,extension:i(f,"matExtension","mat"),xhrSettings:i(f,"xhrSettings")}))}else u=new o(t,{key:e,url:r,type:"obj",cache:d,extension:"obj",xhrSettings:l,config:{flipUV:h}}),a&&(c=new o(t,{key:e,url:a,type:"mat",cache:d,extension:"mat",xhrSettings:l}));s.call(this,t,"obj",e,[u,c])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=r(t.data,t.config.flipUV);e&&(i.materials=a(e.data)),t.cache.add(t.key,i),this.complete=!0}}});return e.register("obj",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new h(this,t[a]),this.addFile(r.files);else r=new h(this,t,e,i,n,s),this.addFile(r.files);return this}),v8=h}function Ttt(){if(w8)return x8;w8=1;var t=Ih(),e=M6(),i=XH(),n=k6(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,s,r),this.type="packfile"},onProcess:function(){if(this.state!==e.FILE_POPULATED&&(this.state=e.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.data.hasOwnProperty("files")&&this.config){var t={};t[this.config]=this.data,this.data=t}this.loader.addPack(this.data,this.config),this.onProcessComplete()}});return i.register("pack",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,n,i));return this}),x8=s}function Ett(){if(T8)return b8;T8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"start"),h=s(c,"mapping")}var d={type:"plugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{start:o,mapping:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=s(i,"start",!1),r=s(i,"mapping",null);if(this.state===e.FILE_POPULATED)t.install(this.key,this.data,n,r);else{this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var a=t.install(this.key,window[this.key],n,r);(n||r)&&(this.loader.systems[r]=a,this.loader.scene[r]=a)}this.onProcessComplete()}});return n.register("plugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),b8=a}function Stt(){if(S8)return E8;S8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a){var o="js";if(r(e)){var h=e;e=s(h,"key"),n=s(h,"url"),a=s(h,"xhrSettings"),o=s(h,"extension",o)}var l={type:"text",extension:o,responseType:"text",key:e,url:n,xhrSettings:a};i.call(this,t,l)},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);"),e=eval;this.loader.sceneManager.add(this.key,e(t)),this.complete=!0}});return n.register("sceneFile",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new a(this,t[n]));else this.addFile(new a(this,t,e,i));return this}),E8=a}function _tt(){if(C8)return _8;C8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,n,a,o,h,l){var u="js";if(r(n)){var c=n;n=s(c,"key"),a=s(c,"url"),l=s(c,"xhrSettings"),u=s(c,"extension",u),o=s(c,"systemKey"),h=s(c,"sceneKey")}var d={type:"scenePlugin",cache:!1,extension:u,responseType:"text",key:n,url:a,xhrSettings:l,config:{systemKey:o,sceneKey:h}};i.call(this,t,d),"function"==typeof a&&(this.data=a,this.state=e.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,i=this.config,n=this.key,r=s(i,"systemKey",n),a=s(i,"sceneKey",n);this.state===e.FILE_POPULATED?t.installScenePlugin(r,this.data,a,this.loader.scene,!0):(this.state=e.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(r,window[this.key],a,this.loader.scene,!0)),this.onProcessComplete()}});return n.register("scenePlugin",function(t,e,i,n,s){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n,s));return this}),_8=a}function Ctt(){if(M8)return A8;M8=1;var t=Ih(),e=M6(),i=XH(),n=I6(),s=new t({Extends:n,initialize:function(t,e,i,s,r){n.call(this,t,e,i,r,s),this.type="spritesheet"},addToCache:function(){var t=this.linkFile;t?t.state>=e.FILE_COMPLETE&&("normalMap"===this.type?this.cache.addSpriteSheet(this.key,t.data,this.config,this.data):this.cache.addSpriteSheet(this.key,this.data,this.config,t.data)):this.cache.addSpriteSheet(this.key,this.data,this.config)}});return i.register("spritesheet",function(t,e,i,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new s(this,t[r]));else this.addFile(new s(this,t,e,i,n));return this}),A8=s}function Att(){if(R8)return P8;R8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=new t({Extends:i,initialize:function(t,e,n,a,o){var h="svg";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),a=s(l,"svgConfig",{}),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"svg",cache:t.textureManager,extension:h,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:s(a,"width"),height:s(a,"height"),scale:s(a,"scale")}};i.call(this,t,u)},onProcess:function(){this.state=e.FILE_PROCESSING;var t=this.xhrLoader.responseText,n=[t],s=this.config.width,r=this.config.height,a=this.config.scale;t:if(s&&r||a){var o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],h=o.hasAttribute("viewBox"),l=parseFloat(o.getAttribute("width")),u=parseFloat(o.getAttribute("height"));if(!h&&l&&u)o.setAttribute("viewBox","0  0 "+l+" "+u);else if(h&&!l&&!u){var c=o.getAttribute("viewBox").split(/\s+|,/);l=c[2],u=c[3]}if(a){if(!l||!u)break t;s=l*a,r=u*a}o.setAttribute("width",s.toString()+"px"),o.setAttribute("height",r.toString()+"px"),n=[(new XMLSerializer).serializeToString(o)]}try{var d=new window.Blob(n,{type:"image/svg+xml;charset=utf-8"})}catch(t){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var f=this,p=!1;this.data.onload=function(){p||i.revokeObjectURL(f.data),f.onProcessComplete()},this.data.onerror=function(){p?f.onProcessError():(p=!0,i.revokeObjectURL(f.data),f.data.src="data:image/svg+xml,"+encodeURIComponent(n.join("")))},i.createObjectURL(this.data,d,"image/svg+xml")},addToCache:function(){this.cache.addImage(this.key,this.data)}});return n.register("svg",function(t,e,i,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new a(this,t[s]));else this.addFile(new a(this,t,e,i,n));return this}),P8=a}function Mtt(){return O8?L8:(O8=1,L8={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3})}function Ptt(){if(k8)return F8;k8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=kh(),r=Vo(),a=Mtt(),o=new t({Extends:i,initialize:function(t,e,n,o){var h="csv";if(r(e)){var l=e;e=s(l,"key"),n=s(l,"url"),o=s(l,"xhrSettings"),h=s(l,"extension",h)}var u={type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:h,responseType:"text",key:e,url:n,xhrSettings:o};i.call(this,t,u),this.tilemapFormat=a.CSV},onProcess:function(){this.state=e.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t)}});return n.register("tilemapCSV",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),F8=o}function Rtt(){if(I8)return D8;I8=1;var t=Ih(),e=XH(),i=k6(),n=Mtt(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.WELTMEISTER,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapImpact",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),D8=s}function Ltt(){if(N8)return B8;N8=1;var t=Ih(),e=XH(),i=k6(),n=Mtt(),s=new t({Extends:i,initialize:function(t,e,n,s){i.call(this,t,e,n,s),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:n.TILED_JSON,data:this.data};this.cache.add(this.key,t)}});return e.register("tilemapTiledJSON",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new s(this,t[n]));else this.addFile(new s(this,t,e,i));return this}),B8=s}function Ott(){if(U8)return z8;U8=1;var t=Ih(),e=XH(),i=kh(),n=I6(),s=Vo(),r=B6(),a=wtt(),o=new t({Extends:r,initialize:function(t,e,o,h,l,u){var c,d;if(s(e)){var f=e;e=i(f,"key"),c=new n(t,{key:e,url:i(f,"textureURL"),extension:i(f,"textureExtension","png"),normalMap:i(f,"normalMap"),xhrSettings:i(f,"textureXhrSettings")}),d=new a(t,{key:e,url:i(f,"atlasURL"),extension:i(f,"atlasExtension","txt"),xhrSettings:i(f,"atlasXhrSettings")})}else c=new n(t,e,o,l),d=new a(t,e,h,u);c.linkFile?r.call(this,t,"unityatlas",e,[c,d,c.linkFile]):r.call(this,t,"unityatlas",e,[c,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1],i=this.files[2]?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,i),this.complete=!0}}});return e.register("unityAtlas",function(t,e,i,n,s){var r;if(Array.isArray(t))for(var a=0;a<t.length;a++)r=new o(this,t[a]),this.addFile(r.files);else r=new o(this,t,e,i,n,s),this.addFile(r.files);return this}),z8=o}function Ftt(){if(X8)return Y8;X8=1;var t=Ih(),e=M6(),i=F6(),n=XH(),s=P6(),r=kh(),a=Vo(),o=new t({Extends:i,initialize:function(t,e,n,s){if(void 0===s&&(s=!1),a(e)){var o=e;e=r(o,"key"),n=r(o,"url",[]),s=r(o,"noAudio",!1)}var h=t.systems.game.device.video.getVideoURL(n);h||console.warn("VideoFile: No supported format for "+e);var l={type:"video",cache:t.cacheManager.video,extension:h.type,key:e,url:h.url,config:{noAudio:s}};i.call(this,t,l)},onProcess:function(){this.data={url:this.src,noAudio:this.config.noAudio,crossOrigin:this.crossOrigin},this.onProcessComplete()},load:function(){this.src=s(this,this.loader.baseURL),this.state=e.FILE_LOADED,this.loader.nextFile(this,!0)}});return n.register("video",function(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFile(new o(this,t[n]));else this.addFile(new o(this,t,e,i));return this}),Y8=o}function ktt(){if(W8)return H8;W8=1;var t=Ih(),e=M6(),i=tV(),n=Iz(),s=qH(),r=XH(),a=kh(),o=Tl(),h=Vo(),l=Cu(),u=Au(),c=R6(),d=new t({Extends:n,initialize:function(t){n.call(this);var s=t.sys.game.config,o=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,r.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(a(o,"baseURL",s.loaderBaseURL)),this.setPath(a(o,"path",s.loaderPath)),this.setPrefix(a(o,"prefix",s.loaderPrefix)),this.maxParallelDownloads=a(o,"maxParallelDownloads",s.loaderMaxParallelDownloads),this.xhr=c(a(o,"responseType",s.loaderResponseType),a(o,"async",s.loaderAsync),a(o,"user",s.loaderUser),a(o,"password",s.loaderPassword),a(o,"timeout",s.loaderTimeout),a(o,"withCredentials",s.loaderWithCredentials)),this.crossOrigin=a(o,"crossOrigin",s.loaderCrossOrigin),this.imageLoadType=a(o,"imageLoadType",s.loaderImageLoadType),this.localSchemes=a(o,"localScheme",s.loaderLocalScheme),this.totalToLoad=0,this.progress=0,this.list=new i,this.inflight=new i,this.queue=new i,this._deleteQueue=new i,this.totalFailed=0,this.totalComplete=0,this.state=e.LOADER_IDLE,this.multiKeyIndex=0,this.maxRetries=a(o,"maxRetries",s.loaderMaxRetries),t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.pluginStart,this)},boot:function(){this.systems.events.once(u.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(u.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];this.keyExists(i)||(this.list.set(i),this.emit(s.ADD,i.key,i.type,this,i),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),!e&&this.isLoading()&&(this.inflight.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1}),this.queue.iterate(function(i){if(i.type===t.type&&i.key===t.key)return e=!0,!1})),e},addPack:function(t,e){if("string"==typeof e){var i=o(t,e);i&&(t={packKey:i})}var n=0,s=this.baseURL,r=this.path,h=this.prefix;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var u=t[l],c=a(u,"baseURL",s),d=a(u,"path",r),f=a(u,"prefix",h),p=a(u,"files",null),g=a(u,"defaultType","void");if(Array.isArray(p)){this.setBaseURL(c),this.setPath(d),this.setPrefix(f);for(var m=0;m<p.length;m++){var v=p[m],y=v.hasOwnProperty("type")?v.type:g;this[y]&&(this[y](v),n++)}}}return this.setBaseURL(s),this.setPath(r),this.setPrefix(h),n>0},removePack:function(t,e){var i,n=this.systems.anims,s=this.cacheManager,r=this.textureManager,o={animation:"json",aseprite:"json",audio:"audio",audioSprite:"audio",binary:"binary",bitmapFont:"bitmapFont",css:null,glsl:"shader",html:"html",json:"json",obj:"obj",plugin:null,scenePlugin:null,script:null,spine:"json",text:"text",tilemapCSV:"tilemap",tilemapImpact:"tilemap",tilemapTiledJSON:"tilemap",video:"video",xml:"xml"};if(h(t))i=t;else if(!(i=s.json.get(t)))return void console.warn("Asset Pack not found in JSON cache:",t);for(var l in e&&(i={_:i[e]}),i){var u=i[l],c=a(u,"prefix",""),d=a(u,"files"),f=a(u,"defaultType");if(Array.isArray(d))for(var p=0;p<d.length;p++){var g=d[p],m=g.hasOwnProperty("type")?g.type:f;if(m){var v=c+g.key;if("animation"===m&&n.remove(v),"aseprite"!==m&&"atlas"!==m&&"atlasXML"!==m&&"htmlTexture"!==m&&"image"!==m&&"multiatlas"!==m&&"spritesheet"!==m&&"svg"!==m&&"texture"!==m&&"unityAtlas"!==m||(r.remove(v),o[m]))if("pack"!==m){if("spine"===m){var y=s.custom.spine.get(v);if(!y)continue;var x=void 0===y.prefix?"":y.prefix;s.custom.spine.remove(v);var w=s.custom.spineTextures.get(v);if(!w)continue;s.custom.spineTextures.remove(v);for(var b=0;b<w.pages.length;b++){var T=x+w.pages[b].name,E=v+":"+T;r.exists(E)?r.remove(E):r.remove(T)}}var S=o[m];null!==S&&(S?s[S].remove(v):console.warn("Unknown type:",m))}else this.removePack(v,g.dataKey)}else console.warn("No type:",g)}}},isLoading:function(){return this.state===e.LOADER_LOADING||this.state===e.LOADER_PROCESSING},isReady:function(){return this.state===e.LOADER_IDLE||this.state===e.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(s.START,this),0===this.list.size?this.loadComplete():(this.state=e.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(u.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(s.PROGRESS,this.progress)},update:function(){this.state===e.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(t){if((t.state===e.FILE_POPULATED||t.state===e.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(s.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(s.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===e.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===e.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&(t.multiFile.addToCache(),t.multiFile.pendingDestroy()):(t.addToCache(),t.pendingDestroy())),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(s.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=e.LOADER_COMPLETE,this.systems.events.off(u.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(s.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,i){void 0===e&&(e="file.json"),void 0===i&&(i="application/json");var n=new Blob([t],{type:i}),s=URL.createObjectURL(n),r=document.createElement("a");return r.download=e,r.textContent="Download "+e,r.href=s,r.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,i=this.systems.settings.loader;this.setBaseURL(a(i,"baseURL",t.loaderBaseURL)),this.setPath(a(i,"path",t.loaderPath)),this.setPrefix(a(i,"prefix",t.loaderPrefix)),this.state=e.LOADER_IDLE},shutdown:function(){this.reset(),this.state=e.LOADER_SHUTDOWN,this.removeAllListeners(),this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=e.LOADER_DESTROYED,this.systems.events.off(u.UPDATE,this.update,this),this.systems.events.off(u.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});return l.register("Loader",d,"load"),H8=d}function Dtt(){return q8?j8:(q8=1,j8={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14})}function Itt(){return i7?e7:(i7=1,e7=function(t){var e=0;if(Array.isArray(t))for(var i=0;i<t.length;i++)e|=t[i];else e=t;return e})}function Btt(){if(s7)return n7;s7=1;var t=Itt(),e={setCollisionCategory:function(t){return(this.body?this.body:this).collisionCategory=t,this},willCollideWith:function(t){return 0!==((this.body?this.body:this).collisionMask&t)},addCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask|t,this},removeCollidesWith:function(t){var e=this.body?this.body:this;return e.collisionMask=e.collisionMask&~t,this},setCollidesWith:function(e){return(this.body?this.body:this).collisionMask=t(e),this},resetCollisionCategory:function(){var t=this.body?this.body:this;return t.collisionCategory=1,t.collisionMask=2147483647,this}};return n7=e}function Ntt(){return w7||(w7=1,x7=function(t,e,i,n,s,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1);var o=[],h=[],l=t.treeMinMax;if(l.minX=e,l.minY=i,l.maxX=e+n,l.maxY=i+s,a&&(h=t.staticTree.search(l)),r&&t.useTree)o=t.tree.search(l);else if(r){var u=t.bodies,c={position:{x:e,y:i},left:e,top:i,right:e+n,bottom:i+s,isCircle:!1},d=t.intersects;u.iterate(function(t){d(t,c)&&o.push(t)})}return h.concat(o)}),x7}function ztt(){if(T7)return b7;T7=1;var t=Ntt(),e=qh(),i=B3(),n=O3();return b7=function(s,r,a,o,h,l){var u=t(s,r-o,a-o,2*o,2*o,h,l);if(0===u.length)return u;for(var c=new e(r,a,o),d=new e,f=[],p=0;p<u.length;p++){var g=u[p];g.isCircle?(d.setTo(g.center.x,g.center.y,g.halfWidth),i(c,d)&&f.push(g)):n(c,g)&&f.push(g)}return f}}function Utt(){return R7?P7:(R7=1,P7={Acceleration:Z8?K8:(Z8=1,K8={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}),Angular:J8?$8:(J8=1,$8={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}),Bounce:t7?Q8:(t7=1,Q8={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,i,n){return this.body.setCollideWorldBounds(t,e,i,n),this}}),Collision:Btt(),Debug:a7?r7:(a7=1,r7={setDebug:function(t,e,i){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=i,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}),Drag:h7?o7:(h7=1,o7={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}),Enable:u7?l7:(u7=1,l7={setDirectControl:function(t){return this.body.setDirectControl(t),this},enableBody:function(t,e,i,n,s){return t&&this.body.reset(e,i),n&&(this.body.gameObject.active=!0),s&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}}),Friction:d7?c7:(d7=1,c7={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}),Gravity:p7?f7:(p7=1,f7={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}),Immovable:m7?g7:(m7=1,g7={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}}),Mass:y7?v7:(y7=1,v7={setMass:function(t){return this.body.mass=t,this}}),OverlapCirc:ztt(),OverlapRect:Ntt(),Pushable:S7?E7:(S7=1,E7={setPushable:function(t){return void 0===t&&(t=!0),this.body.pushable=t,this}}),Size:C7?_7:(C7=1,_7={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,i){return this.body.setSize(t,e,i),this},setBodySize:function(t,e,i){return this.body.setSize(t,e,i),this},setCircle:function(t,e,i){return this.body.setCircle(t,e,i),this}}),Velocity:M7?A7:(M7=1,A7={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}})})}function Ytt(){if(O7)return L7;O7=1;var t=Ih(),e=Utt(),i=hW(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return L7=n}function Xtt(){if(k7)return F7;k7=1;var t=Ih(),e=Utt(),i=iV(),n=new t({Extends:i,Mixins:[e.Acceleration,e.Angular,e.Bounce,e.Collision,e.Debug,e.Drag,e.Enable,e.Friction,e.Gravity,e.Immovable,e.Mass,e.Pushable,e.Size,e.Velocity],initialize:function(t,e,n,s,r){i.call(this,t,e,n,s,r),this.body=null}});return F7=n}function Gtt(){return J7?$7:(J7=1,$7={COLLIDE:I7?D7:(I7=1,D7="collide"),OVERLAP:N7?B7:(N7=1,B7="overlap"),PAUSE:U7?z7:(U7=1,z7="pause"),RESUME:X7?Y7:(X7=1,Y7="resume"),TILE_COLLIDE:H7?G7:(H7=1,G7="tilecollide"),TILE_OVERLAP:V7?W7:(V7=1,W7="tileoverlap"),WORLD_BOUNDS:q7?j7:(q7=1,j7="worldbounds"),WORLD_STEP:Z7?K7:(Z7=1,K7="worldstep")})}function Htt(){return t9||(t9=1,Q7=function(t,e){return void 0===e&&(e={}),e.none=t,e.up=!1,e.down=!1,e.left=!1,e.right=!1,t||(e.up=!0,e.down=!0,e.left=!0,e.right=!0),e}),Q7}function Wtt(){if(i9)return e9;i9=1;var t=Ih(),e=Btt(),i=Dtt(),n=Gtt(),s=vX(),r=Eu(),a=cu(),o=Htt(),h=wu(),l=new t({Mixins:[e],initialize:function(t,e){var n=64,s=64,a=void 0!==e;a&&e.displayWidth&&(n=e.displayWidth,s=e.displayHeight),a||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=a?e:void 0,this.isBody=!0,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new h,this.position=new h(e.x-e.scaleX*e.displayOriginX,e.y-e.scaleY*e.displayOriginY),this.prev=this.position.clone(),this.prevFrame=this.position.clone(),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=s,this.sourceWidth=n,this.sourceHeight=s,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(s/2),this.center=new h(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=new h,this.newVelocity=new h,this.deltaMax=new h,this.acceleration=new h,this.allowDrag=!0,this.drag=new h,this.allowGravity=!0,this.gravity=new h,this.bounce=new h,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new h(1e4,1e4),this.maxSpeed=-1,this.friction=new h(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=i.FACING_NONE,this.immovable=!1,this.pushable=!0,this.slideFactor=new h(1,1),this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=o(!1),this.touching=o(!0),this.wasTouching=o(!0),this.blocked=o(!0),this.syncBounds=!1,this.physicsType=i.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._tx=0,this._ty=0,this._bounds=new r,this.directControl=!1,this.autoFrame=this.position.clone()},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var i=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=i.tx,e.y=i.ty,e.rotation=s(i.rotation),e.scaleX=i.scaleX,e.scaleY=i.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var n=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,n=!0}else{var a=Math.abs(e.scaleX),o=Math.abs(e.scaleY);this._sx===a&&this._sy===o||(this.width=this.sourceWidth*a,this.height=this.sourceHeight*o,this._sx=a,this._sy=o,n=!0)}n&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var t=this.transform;this.position.x=t.x+t.scaleX*(this.offset.x-t.displayOriginX),this.position.y=t.y+t.scaleY*(this.offset.y-t.displayOriginY),this.updateCenter()},resetFlags:function(t){void 0===t&&(t=!1);var e=this.wasTouching,i=this.touching,n=this.blocked;t?o(!0,e):(e.none=i.none,e.up=i.up,e.down=i.down,e.left=i.left,e.right=i.right),o(!0,i),o(!0,n),this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){if(t&&this.resetFlags(),this.gameObject&&this.updateFromGameObject(),this.rotation=this.transform.rotation,this.preRotation=this.rotation,this.moves){var i=this.position;this.prev.x=i.x,this.prev.y=i.y,this.prevFrame.x=i.x,this.prevFrame.y=i.y}t&&this.update(e)},update:function(t){var e=this.prev,i=this.position,s=this.velocity;if(e.set(i.x,i.y),!this.moves)return this._dx=i.x-e.x,void(this._dy=i.y-e.y);if(this.directControl){var r=this.autoFrame;s.set((i.x-r.x)/t,(i.y-r.y)/t),this.world.updateMotion(this,t),this._dx=i.x-r.x,this._dy=i.y-r.y}else this.world.updateMotion(this,t),this.newVelocity.set(s.x*t,s.y*t),i.add(this.newVelocity),this._dx=i.x-e.x,this._dy=i.y-e.y;var a=s.x,o=s.y;if(this.updateCenter(),this.angle=Math.atan2(o,a),this.speed=Math.sqrt(a*a+o*o),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds){var h=this.blocked;this.world.emit(n.WORLD_BOUNDS,this,h.up,h.down,h.left,h.right)}},postUpdate:function(){var t=this.position,e=t.x-this.prevFrame.x,n=t.y-this.prevFrame.y,s=this.gameObject;if(this.moves){var r=this.deltaMax.x,a=this.deltaMax.y;0!==r&&0!==e&&(e<0&&e<-r?e=-r:e>0&&e>r&&(e=r)),0!==a&&0!==n&&(n<0&&n<-a?n=-a:n>0&&n>a&&(n=a)),s&&(s.x+=e,s.y+=n)}e<0?this.facing=i.FACING_LEFT:e>0&&(this.facing=i.FACING_RIGHT),n<0?this.facing=i.FACING_UP:n>0&&(this.facing=i.FACING_DOWN),this.allowRotation&&s&&(s.angle+=this.deltaZ()),this._tx=e,this._ty=n,this.autoFrame.set(t.x,t.y)},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.velocity,i=this.blocked,n=this.customBoundsRectangle,s=this.world.checkCollision,r=this.worldBounce?-this.worldBounce.x:-this.bounce.x,a=this.worldBounce?-this.worldBounce.y:-this.bounce.y,o=!1;return t.x<n.x&&s.left?(t.x=n.x,e.x*=r,i.left=!0,o=!0):this.right>n.right&&s.right&&(t.x=n.right-this.width,e.x*=r,i.right=!0,o=!0),t.y<n.y&&s.up?(t.y=n.y,e.y*=a,i.up=!0,o=!0):this.bottom>n.bottom&&s.down&&(t.y=n.bottom-this.height,e.y*=a,i.down=!0,o=!0),o&&(this.blocked.none=!1,this.updateCenter()),o},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this},setGameObject:function(t,e){if(void 0===e&&(e=!0),!t||!t.hasTransformComponent)return this;var i=this.world;return this.gameObject&&this.gameObject.body&&(i.disable(this.gameObject),this.gameObject.body=null),t.body&&i.disable(t),this.gameObject=t,t.body=this,this.setSize(),this.enable=e,this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&(!t&&n.frame&&(t=n.frame.realWidth),!e&&n.frame&&(e=n.frame.realHeight)),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),i&&n&&n.getCenter){var s=(n.width-t)/2,r=(n.height-e)/2;this.offset.set(s,r)}return this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var i=this.gameObject;i&&(i.setPosition(t,e),this.rotation=i.angle,this.preRotation=i.angle);var n=this.position;i&&i.getTopLeft?i.getTopLeft(n):n.set(t,e),this.prev.copy(n),this.prevFrame.copy(n),this.autoFrame.copy(n),i&&this.updateBounds(),this.updateCenter(),this.collideWorldBounds&&this.checkWorldBounds(),this.resetFlags(!0)},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:a(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(i,n,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(i,n,i+this.velocity.x/2,n+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setDirectControl:function(t){return void 0===t&&(t=!0),this.directControl=t,this},setCollideWorldBounds:function(t,e,i,n){void 0===t&&(t=!0),this.collideWorldBounds=t;var s=void 0!==e,r=void 0!==i;return(s||r)&&(this.worldBounce||(this.worldBounce=new h),s&&(this.worldBounce.x=e),r&&(this.worldBounce.y=i)),void 0!==n&&(this.onWorldBounds=n),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){return this.setVelocity(t,this.velocity.y)},setVelocityY:function(t){return this.setVelocity(this.velocity.x,t)},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxVelocityX:function(t){return this.maxVelocity.x=t,this},setMaxVelocityY:function(t){return this.maxVelocity.y=t,this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setSlideFactor:function(t,e){return this.slideFactor.set(t,e),this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDamping:function(t){return this.useDamping=t,this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},processX:function(t,e,i,n){this.x+=t,this.updateCenter(),null!==e&&(this.velocity.x=e*this.slideFactor.x);var s=this.blocked;i&&(s.left=!0,s.none=!1),n&&(s.right=!0,s.none=!1)},processY:function(t,e,i,n){this.y+=t,this.updateCenter(),null!==e&&(this.velocity.y=e*this.slideFactor.y);var s=this.blocked;i&&(s.up=!0,s.none=!1),n&&(s.down=!0,s.none=!1)},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return e9=l}function Vtt(){if(s9)return n9;s9=1;var t=Xtt(),e=Ih(),i=Btt(),n=Dtt(),s=kh(),r=nV(),a=Vo(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){if(o||h)if(a(o))h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler;else if(Array.isArray(o)&&a(o[0])){var l=this;o.forEach(function(e){e.internalCreateCallback=l.createCallbackHandler,e.internalRemoveCallback=l.removeCallbackHandler,e.classType=s(e,"classType",t)}),h=null}else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};else h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler};this.world=e,h&&(h.classType=s(h,"classType",t)),this.physicsType=n.DYNAMIC_BODY,this.collisionCategory=1,this.collisionMask=2147483647,this.defaults={setCollideWorldBounds:s(h,"collideWorldBounds",!1),setBoundsRectangle:s(h,"customBoundsRectangle",null),setAccelerationX:s(h,"accelerationX",0),setAccelerationY:s(h,"accelerationY",0),setAllowDrag:s(h,"allowDrag",!0),setAllowGravity:s(h,"allowGravity",!0),setAllowRotation:s(h,"allowRotation",!0),setDamping:s(h,"useDamping",!1),setBounceX:s(h,"bounceX",0),setBounceY:s(h,"bounceY",0),setDragX:s(h,"dragX",0),setDragY:s(h,"dragY",0),setEnable:s(h,"enable",!0),setGravityX:s(h,"gravityX",0),setGravityY:s(h,"gravityY",0),setFrictionX:s(h,"frictionX",0),setFrictionY:s(h,"frictionY",0),setMaxSpeed:s(h,"maxSpeed",-1),setMaxVelocityX:s(h,"maxVelocityX",1e4),setMaxVelocityY:s(h,"maxVelocityY",1e4),setVelocityX:s(h,"velocityX",0),setVelocityY:s(h,"velocityY",0),setAngularVelocity:s(h,"angularVelocity",0),setAngularAcceleration:s(h,"angularAcceleration",0),setAngularDrag:s(h,"angularDrag",0),setMass:s(h,"mass",1),setImmovable:s(h,"immovable",!1)},r.call(this,i,o,h),this.type="PhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.DYNAMIC_BODY);var e=t.body;for(var i in this.defaults)e[i](this.defaults[i])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,i){void 0===i&&(i=0);for(var n=this.getChildren(),s=0;s<n.length;s++)n[s].body.velocity.set(t+s*i,e+s*i);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.x=t+n*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var i=this.getChildren(),n=0;n<i.length;n++)i[n].body.velocity.y=t+n*e;return this}});return n9=o}function jtt(){if(a9)return r9;a9=1;var t=Bh(),e=Ih(),i=Btt(),n=Dtt(),s=cu(),r=Htt(),a=wu(),o=new e({Mixins:[i],initialize:function(t,e){var i=64,s=64,o=void 0!==e;o&&e.displayWidth&&(i=e.displayWidth,s=e.displayHeight),o||(e={x:0,y:0,angle:0,rotation:0,scaleX:1,scaleY:1,displayOriginX:0,displayOriginY:0}),this.world=t,this.gameObject=o?e:void 0,this.isBody=!0,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new a,this.position=new a(e.x-i*e.originX,e.y-s*e.originY),this.width=i,this.height=s,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new a(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.velocity=a.ZERO,this.allowGravity=!1,this.gravity=a.ZERO,this.bounce=a.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.pushable=!1,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision=r(!1),this.touching=r(!0),this.wasTouching=r(!0),this.blocked=r(!0),this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,this._dx=0,this._dy=0},setGameObject:function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),!t||!t.hasTransformComponent)return this;var n=this.world;return this.gameObject&&this.gameObject.body&&(n.disable(this.gameObject),this.gameObject.body=null),t.body&&n.disable(t),this.gameObject=t,t.body=this,this.setSize(),e&&this.updateFromGameObject(),this.enable=i,this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,i){void 0===i&&(i=!0);var n=this.gameObject;if(n&&n.frame&&(t||(t=n.frame.realWidth),e||(e=n.frame.realHeight)),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),i&&n&&n.getCenter){var s=n.displayWidth/2,r=n.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(s-this.halfWidth,r-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,i){return void 0===e&&(e=this.offset.x),void 0===i&&(i=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,i),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var i=this.gameObject;void 0===t&&(t=i.x),void 0===e&&(e=i.y),this.world.staticTree.remove(this),i.setPosition(t,e),i.getTopLeft(this.position),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(e,i){return this.isCircle?t(this,e,i):s(this,e,i)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,i=e.x+this.halfWidth,n=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(i,n,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});return r9=o}function qtt(){if(h9)return o9;h9=1;var t=Xtt(),e=Ih(),i=Btt(),n=Dtt(),s=kh(),r=nV(),a=Vo(),o=new e({Extends:r,Mixins:[i],initialize:function(e,i,o,h){o||h?a(o)?(h=o,o=null,h.internalCreateCallback=this.createCallbackHandler,h.internalRemoveCallback=this.removeCallbackHandler,h.createMultipleCallback=this.createMultipleCallbackHandler,h.classType=s(h,"classType",t)):Array.isArray(o)&&a(o[0])?(h=o,o=null,h.forEach(function(e){e.internalCreateCallback=this.createCallbackHandler,e.internalRemoveCallback=this.removeCallbackHandler,e.createMultipleCallback=this.createMultipleCallbackHandler,e.classType=s(e,"classType",t)})):h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}:h={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:t},this.world=e,this.physicsType=n.STATIC_BODY,this.collisionCategory=1,this.collisionMask=1,r.call(this,i,o,h),this.type="StaticPhysicsGroup"},createCallbackHandler:function(t){t.body||this.world.enableBody(t,n.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});return o9=o}function Ktt(){if(u9)return l9;u9=1;var t=Ytt(),e=Xtt(),i=Wtt(),n=Ih(),s=Dtt(),r=Vtt(),a=jtt(),o=qtt(),h=new n({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,i,n,s){return this.world.addCollider(t,e,i,n,s)},overlap:function(t,e,i,n,s){return this.world.addOverlap(t,e,i,n,s)},existing:function(t,e){var i=e?s.STATIC_BODY:s.DYNAMIC_BODY;return this.world.enableBody(t,i),t},staticImage:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},image:function(e,i,n,r){var a=new t(this.scene,e,i,n,r);return this.sys.displayList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticSprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.STATIC_BODY),a},sprite:function(t,i,n,r){var a=new e(this.scene,t,i,n,r);return this.sys.displayList.add(a),this.sys.updateList.add(a),this.world.enableBody(a,s.DYNAMIC_BODY),a},staticGroup:function(t,e){return this.sys.updateList.add(new o(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new r(this.world,this.world.scene,t,e))},body:function(t,e,n,r){var a=new i(this.world);return a.position.set(t,e),n&&r&&a.setSize(n,r),this.world.add(a,s.DYNAMIC_BODY),a},staticBody:function(t,e,i,n){var r=new a(this.world);return r.position.set(t,e),i&&n&&r.setSize(i,n),this.world.add(r,s.STATIC_BODY),r},destroy:function(){this.world=null,this.scene=null,this.sys=null}});return l9=h}function Ztt(){if(d9)return c9;d9=1;var t=new(Ih())({initialize:function(t,e,i,n,s,r,a){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=i,this.object2=n,this.collideCallback=s,this.processCallback=r,this.callbackContext=a},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});return c9=t}function $tt(){if(p9)return f9;p9=1;var t=Dtt();return f9=function(e,i,n,s){var r=0,a=e.deltaAbsX()+i.deltaAbsX()+s;return 0===e._dx&&0===i._dx?(e.embedded=!0,i.embedded=!0):e._dx>i._dx?(r=e.right-i.x)>a&&!n||!1===e.checkCollision.right||!1===i.checkCollision.left?r=0:(e.touching.none=!1,e.touching.right=!0,i.touching.none=!1,i.touching.left=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.right=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.left=!0)):e._dx<i._dx&&(-(r=e.x-i.width-i.x)>a&&!n||!1===e.checkCollision.left||!1===i.checkCollision.right?r=0:(e.touching.none=!1,e.touching.left=!0,i.touching.none=!1,i.touching.right=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.left=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.right=!0))),e.overlapX=r,i.overlapX=r,r}}function Jtt(){if(m9)return g9;m9=1;var t=Dtt();return g9=function(e,i,n,s){var r=0,a=e.deltaAbsY()+i.deltaAbsY()+s;return 0===e._dy&&0===i._dy?(e.embedded=!0,i.embedded=!0):e._dy>i._dy?(r=e.bottom-i.y)>a&&!n||!1===e.checkCollision.down||!1===i.checkCollision.up?r=0:(e.touching.none=!1,e.touching.down=!0,i.touching.none=!1,i.touching.up=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.down=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.up=!0)):e._dy<i._dy&&(-(r=e.y-i.bottom)>a&&!n||!1===e.checkCollision.up||!1===i.checkCollision.down?r=0:(e.touching.none=!1,e.touching.up=!0,i.touching.none=!1,i.touching.down=!0,i.physicsType!==t.STATIC_BODY||n||(e.blocked.none=!1,e.blocked.up=!0),e.physicsType!==t.STATIC_BODY||n||(i.blocked.none=!1,i.blocked.down=!0))),e.overlapY=r,i.overlapY=r,r}}function Qtt(){if(y9)return v9;y9=1;var t=kh();return v9=function(e,i,n,s,r,a){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=a.width),void 0===s&&(s=a.height),r||(r={});var o=t(r,"isNotEmpty",!1),h=t(r,"isColliding",!1),l=t(r,"hasInterestingFace",!1);e<0&&(n+=e,e=0),i<0&&(s+=i,i=0),e+n>a.width&&(n=Math.max(a.width-e,0)),i+s>a.height&&(s=Math.max(a.height-i,0));for(var u=[],c=i;c<i+s;c++)for(var d=e;d<e+n;d++){var f=a.data[c][d];if(null!==f){if(o&&-1===f.index)continue;if(h&&!f.collides)continue;if(l&&!f.hasInterestingFace)continue;u.push(f)}}return u}}function tet(){if(w9)return x9;w9=1;var t=Qtt(),e=wu(),i=new e,n=new e;return x9=function(e,s,r,a,o,h,l){var u=l.tilemapLayer.tilemap._convert.WorldToTileXY;u(e,s,!0,i,h,l);var c=i.x,d=i.y;u(e+r,s+a,!1,n,h,l);var f=Math.ceil(n.x),p=Math.ceil(n.y);return t(c,d,f-c,p-d,o,l)}}function eet(){return T9?b9:(T9=1,b9=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)})}function iet(){if(S9)return E9;S9=1;var t=bl();function e(t){if(!(this instanceof e))return new e(t);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function n(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,s){s||(s=p(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var a,o=e;o<i;o++)a=t.children[o],r(s,t.leaf?n(a):a);return s}function r(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,r-n)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,i,n,s,r){for(var a,o=[i,n];o.length;)(n=o.pop())-(i=o.pop())<=s||(a=i+Math.ceil((n-i)/s/2)*s,t(e,a,i,n,r),o.push(i,a,a,n))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!f(t,e))return i;for(var s,r,a,o,h=[];e;){for(s=0,r=e.children.length;s<r;s++)a=e.children[s],f(t,o=e.leaf?n(a):a)&&(e.leaf?i.push(a):d(t,o)?this._all(a,i):h.push(a));e=h.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!f(t,e))return!1;for(var n,s,r,a,o=[];e;){for(n=0,s=e.children.length;n<s;n++)if(r=e.children[n],f(t,a=e.leaf?i(r):r)){if(e.leaf||d(t,a))return!0;o.push(r)}e=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,s,r,a,o=this.data,h=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],n=u.pop(),a=!0),o.leaf&&-1!==(r=i(t,o.children,e)))return o.children.splice(r,1),l.push(o),this._condense(l),this;a||o.leaf||!d(o,h)?s?(n++,o=s.children[n],a=!1):o=null:(l.push(o),u.push(n),n=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:a,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var r,a=i-e+1,o=this._maxEntries;if(a<=o)return n(r=p(t.slice(e,i+1)),this.toBBox),r;s||(s=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,s-1))),(r=p([])).leaf=!1,r.height=s;var h,l,u,c,d=Math.ceil(a/o),f=d*Math.ceil(Math.sqrt(o));for(g(t,e,i,f,this.compareMinX),h=e;h<=i;h+=f)for(g(t,h,u=Math.min(h+f-1,i),d,this.compareMinY),l=h;l<=u;l+=d)c=Math.min(l+d-1,u),r.children.push(this._build(t,l,c,s-1));return n(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var s,r,a,o,l,c,d,f;n.push(e),!e.leaf&&n.length-1!==i;){for(d=f=1/0,s=0,r=e.children.length;s<r;s++)l=h(a=e.children[s]),(c=u(t,a)-l)<f?(f=c,d=l<d?l:d,o=a):c===f&&l<d&&(d=l,o=a);e=o||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,s=i?t:n(t),a=[],o=this._chooseSubtree(s,this.data,e,a);for(o.children.push(t),r(o,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)},_split:function(t,e){var i=t[e],s=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,s);var a=this._chooseSplitIndex(i,r,s),o=p(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,n(i,this.toBBox),n(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,a,o,l,u,d,f;for(u=d=1/0,n=e;n<=i-e;n++)o=c(r=s(t,0,n,this.toBBox),a=s(t,n,i,this.toBBox)),l=h(r)+h(a),o<u?(u=o,f=n,d=l<d?l:d):o===u&&l<d&&(d=l,f=n);return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:a,s=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var a,o,h=this.toBBox,u=s(t,0,e,h),c=s(t,i-e,i,h),d=l(u)+l(c);for(a=e;a<i-e;a++)o=t.children[a],r(u,t.leaf?h(o):o),d+=l(u);for(a=i-e-1;a>=e;a--)o=t.children[a],r(c,t.leaf?h(o):o),d+=l(c);return d},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)r(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():n(t[i],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},E9=e}function net(){return C9?_9:(C9=1,_9=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,t.updateCenter(),0===t.bounce.x?t.velocity.x=0:t.velocity.x=-t.velocity.x*t.bounce.x})}function set(){if(M9)return A9;M9=1;var t=net();return A9=function(e,i,n,s,r,a){var o=0,h=i.faceLeft,l=i.faceRight,u=i.collideLeft,c=i.collideRight;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaX()<0&&c&&e.checkCollision.left?l&&e.x<s&&(o=e.x-s)<-r&&(o=0):e.deltaX()>0&&u&&e.checkCollision.right&&h&&e.right>n&&(o=e.right-n)>r&&(o=0),0!==o&&(e.customSeparateX?e.overlapX=o:t(e,o)),o}}function ret(){return R9?P9:(R9=1,P9=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,t.updateCenter(),0===t.bounce.y?t.velocity.y=0:t.velocity.y=-t.velocity.y*t.bounce.y})}function aet(){if(O9)return L9;O9=1;var t=ret();return L9=function(e,i,n,s,r,a){var o=0,h=i.faceTop,l=i.faceBottom,u=i.collideUp,c=i.collideDown;return a||(h=!0,l=!0,u=!0,c=!0),e.deltaY()<0&&c&&e.checkCollision.up?l&&e.y<s&&(o=e.y-s)<-r&&(o=0):e.deltaY()>0&&u&&e.checkCollision.down&&h&&e.bottom>n&&(o=e.bottom-n)>r&&(o=0),0!==o&&(e.customSeparateY?e.overlapY=o:t(e,o)),o}}function oet(){return k9?F9:(k9=1,F9=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)})}function het(){if(I9)return D9;I9=1;var t=set(),e=aet(),i=oet();return D9=function(n,s,r,a,o,h,l){var u=a.left,c=a.top,d=a.right,f=a.bottom,p=r.faceLeft||r.faceRight,g=r.faceTop||r.faceBottom;if(l||(p=!0,g=!0),!p&&!g)return!1;var m=0,v=0,y=0,x=1;if(s.deltaAbsX()>s.deltaAbsY()?y=-1:s.deltaAbsX()<s.deltaAbsY()&&(x=-1),0!==s.deltaX()&&0!==s.deltaY()&&p&&g&&(y=Math.min(Math.abs(s.position.x-d),Math.abs(s.right-u)),x=Math.min(Math.abs(s.position.y-f),Math.abs(s.bottom-c))),y<x){if(p&&0!==(m=t(s,r,u,d,h,l))&&!i(a,s))return!0;g&&(v=e(s,r,c,f,h,l))}else{if(g&&0!==(v=e(s,r,c,f,h,l))&&!i(a,s))return!0;p&&(m=t(s,r,u,d,h,l))}return 0!==m||0!==v}}function uet(){if(N9)return B9;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m;N9=1;var v=function(){return l&&p&&e.blocked.right?(t.processX(-m,a,!1,!0),1):h&&g&&e.blocked.left?(t.processX(m,a,!0),1):d&&g&&t.blocked.right?(e.processX(-m,o,!1,!0),2):c&&p&&t.blocked.left?(e.processX(m,o,!0),2):0},y=function(p){if(i&&n)m*=.5,0===p||3===p?(t.processX(m,s),e.processX(-m,r)):(t.processX(-m,s),e.processX(m,r));else if(i&&!n)0===p||3===p?t.processX(m,a,!0):t.processX(-m,a,!1,!0);else if(!i&&n)0===p||3===p?e.processX(-m,o,!1,!0):e.processX(m,o,!0);else{var g=.5*m;0===p?f?(t.processX(m,0,!0),e.processX(0,null,!1,!0)):d?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.x,!0),e.processX(-g,null,!1,!0)):1===p?u?(t.processX(0,null,!1,!0),e.processX(m,0,!0)):l?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,null,!1,!0),e.processX(g,t.velocity.x,!0)):2===p?f?(t.processX(-m,0,!1,!0),e.processX(0,null,!0)):c?(t.processX(-g,0,!1,!0),e.processX(g,0,!0)):(t.processX(-g,e.velocity.x,!1,!0),e.processX(g,null,!0)):3===p&&(u?(t.processX(0,null,!0),e.processX(-m,0,!1,!0)):h?(t.processX(g,0,!0),e.processX(-g,0,!1,!0)):(t.processX(g,e.velocity.y,!0),e.processX(-g,null,!1,!0)))}return!0};return B9={BlockCheck:v,Check:function(){var i=t.velocity.x,n=e.velocity.x,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.x,r=u+o*e.bounce.x,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.x,w=e.velocity.x;return i=t.pushable,h=t._dx<0,l=t._dx>0,u=0===t._dx,p=Math.abs(t.right-e.x)<=Math.abs(e.right-t.x),a=w-x*t.bounce.x,n=e.pushable,c=e._dx<0,d=e._dx>0,f=0===e._dx,g=!p,o=x-w*e.bounce.x,m=Math.abs(y),v()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.x=0:p?e.processX(m,o,!0):e.processX(-m,o,!1,!0),t.moves){var n=t.directControl?t.y-t.autoFrame.y:t.y-t.prev.y;e.y+=n*t.friction.y,e._dy=e.y-e.prev.y}},RunImmovableBody2:function(i){if(2===i?t.velocity.x=0:g?t.processX(m,a,!0):t.processX(-m,a,!1,!0),e.moves){var n=e.directControl?e.y-e.autoFrame.y:e.y-e.prev.y;t.y+=n*e.friction.y,t._dy=t.y-t.prev.y}}}}function cet(){if(U9)return z9;U9=1;var t=$tt(),e=uet();return z9=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateX||n.customSeparateX)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function det(){if(X9)return Y9;var t,e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m;X9=1;var v=function(){return l&&p&&e.blocked.down?(t.processY(-m,a,!1,!0),1):h&&g&&e.blocked.up?(t.processY(m,a,!0),1):d&&g&&t.blocked.down?(e.processY(-m,o,!1,!0),2):c&&p&&t.blocked.up?(e.processY(m,o,!0),2):0},y=function(p){if(i&&n)m*=.5,0===p||3===p?(t.processY(m,s),e.processY(-m,r)):(t.processY(-m,s),e.processY(m,r));else if(i&&!n)0===p||3===p?t.processY(m,a,!0):t.processY(-m,a,!1,!0);else if(!i&&n)0===p||3===p?e.processY(-m,o,!1,!0):e.processY(m,o,!0);else{var g=.5*m;0===p?f?(t.processY(m,0,!0),e.processY(0,null,!1,!0)):d?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)):1===p?u?(t.processY(0,null,!1,!0),e.processY(m,0,!0)):l?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,null,!1,!0),e.processY(g,t.velocity.y,!0)):2===p?f?(t.processY(-m,0,!1,!0),e.processY(0,null,!0)):c?(t.processY(-g,0,!1,!0),e.processY(g,0,!0)):(t.processY(-g,e.velocity.y,!1,!0),e.processY(g,null,!0)):3===p&&(u?(t.processY(0,null,!0),e.processY(-m,0,!1,!0)):h?(t.processY(g,0,!0),e.processY(-g,0,!1,!0)):(t.processY(g,e.velocity.y,!0),e.processY(-g,null,!1,!0)))}return!0};return Y9={BlockCheck:v,Check:function(){var i=t.velocity.y,n=e.velocity.y,a=Math.sqrt(n*n*e.mass/t.mass)*(n>0?1:-1),o=Math.sqrt(i*i*t.mass/e.mass)*(i>0?1:-1),u=.5*(a+o);return o-=u,s=u+(a-=u)*t.bounce.y,r=u+o*e.bounce.y,h&&g?y(0):c&&p?y(1):l&&p?y(2):!(!d||!g)&&y(3)},Set:function(s,r,y){e=r;var x=(t=s).velocity.y,w=e.velocity.y;return i=t.pushable,h=t._dy<0,l=t._dy>0,u=0===t._dy,p=Math.abs(t.bottom-e.y)<=Math.abs(e.bottom-t.y),a=w-x*t.bounce.y,n=e.pushable,c=e._dy<0,d=e._dy>0,f=0===e._dy,g=!p,o=x-w*e.bounce.y,m=Math.abs(y),v()},Run:y,RunImmovableBody1:function(i){if(1===i?e.velocity.y=0:p?e.processY(m,o,!0):e.processY(-m,o,!1,!0),t.moves){var n=t.directControl?t.x-t.autoFrame.x:t.x-t.prev.x;e.x+=n*t.friction.x,e._dx=e.x-e.prev.x}},RunImmovableBody2:function(i){if(2===i?t.velocity.y=0:g?t.processY(m,a,!0):t.processY(-m,a,!1,!0),e.moves){var n=e.directControl?e.x-e.autoFrame.x:e.x-e.prev.x;t.x+=n*e.friction.x,t._dx=t.x-t.prev.x}}}}function fet(){if(H9)return G9;H9=1;var t=Jtt(),e=det();return G9=function(i,n,s,r,a){void 0===a&&(a=t(i,n,s,r));var o=i.immovable,h=n.immovable;if(s||0===a||o&&h||i.customSeparateY||n.customSeparateY)return 0!==a||i.embedded&&n.embedded;var l=e.Set(i,n,a);return o||h?(o?e.RunImmovableBody1(l):h&&e.RunImmovableBody2(l),!0):l>0||e.Check()}}function pet(){if(V9)return W9;V9=1;var t=NY(),e=Wtt(),i=Yh(),n=Ih(),s=Ztt(),r=Dtt(),a=EU(),o=Wz(),h=Iz(),l=Gtt(),u=xu(),c=ZY(),d=$Y(),f=$tt(),p=Jtt(),g=tet(),m=Tl(),v=Gh(),y=TW(),x=eet(),w=Eu(),b=iet(),T=het(),E=cet(),S=fet(),_=tV(),C=jtt(),A=oet(),M=Hu(),P=wu(),R=Vu(),L=new n({Extends:h,initialize:function(t,e){h.call(this),this.scene=t,this.bodies=new _,this.staticBodies=new _,this.pendingDestroy=new _,this.colliders=new y,this.gravity=new P(m(e,"gravity.x",0),m(e,"gravity.y",0)),this.bounds=new w(m(e,"x",0),m(e,"y",0),m(e,"width",t.sys.scale.width),m(e,"height",t.sys.scale.height)),this.checkCollision={up:m(e,"checkCollision.up",!0),down:m(e,"checkCollision.down",!0),left:m(e,"checkCollision.left",!0),right:m(e,"checkCollision.right",!0)},this.fps=m(e,"fps",60),this.fixedStep=m(e,"fixedStep",!0),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=m(e,"timeScale",1),this.OVERLAP_BIAS=m(e,"overlapBias",4),this.TILE_BIAS=m(e,"tileBias",16),this.forceX=m(e,"forceX",!1),this.isPaused=m(e,"isPaused",!1),this._total=0,this.drawDebug=m(e,"debug",!1),this.debugGraphic,this.defaults={debugShowBody:m(e,"debugShowBody",!0),debugShowStaticBody:m(e,"debugShowStaticBody",!0),debugShowVelocity:m(e,"debugShowVelocity",!0),bodyDebugColor:m(e,"debugBodyColor",16711935),staticBodyDebugColor:m(e,"debugStaticBodyColor",255),velocityDebugColor:m(e,"debugVelocityColor",65280)},this.maxEntries=m(e,"maxEntries",16),this.useTree=m(e,"useTree",!0),this.tree=new b(this.maxEntries),this.staticTree=new b(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new M,this._tempMatrix2=new M,this.tileFilterOptions={isColliding:!0,isNotEmpty:!0,hasInterestingFace:!0},this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=r.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i];if(n.isParent)for(var s=n.getChildren(),a=0;a<s.length;a++){var o=s[a];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(n,e)}},enableBody:function(t,i){return void 0===i&&(i=r.DYNAMIC_BODY),t.hasTransformComponent&&(t.body||(i===r.DYNAMIC_BODY?t.body=new e(this,t):i===r.STATIC_BODY&&(t.body=new C(this,t))),this.add(t.body)),t},add:function(t){return t.physicsType===r.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===r.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];if(i.isParent)for(var n=i.getChildren(),s=0;s<n.length;s++){var r=n[s];r.isParent?this.disable(r):this.disableBody(r.body)}else this.disableBody(i.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===r.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===r.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,i,n,s,r,a,o){return this.bounds.setTo(t,e,i,n),void 0!==s&&this.setBoundsCollision(s,r,a,o),this},setBoundsCollision:function(t,e,i,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=i,this.checkCollision.down=n,this},pause:function(){return this.isPaused=!0,this.emit(l.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(l.RESUME),this},addCollider:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!1,t,e,i,n,r);return this.colliders.add(a),a},addOverlap:function(t,e,i,n,r){void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=i);var a=new s(this,!0,t,e,i,n,r);return this.colliders.add(a),a},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var i,n,s=this._frameTime,r=this._frameTimeMS*this.timeScale;this._elapsed+=e;var a=this.bodies.entries,o=this._elapsed>=r;for(this.fixedStep||(s=.001*e,o=!0,this._elapsed=0),i=0;i<a.length;i++)(n=a[i]).enable&&n.preUpdate(o,s);if(o){this._elapsed-=r,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(a));var h=this.colliders.update();for(i=0;i<h.length;i++){var u=h[i];u.active&&u.update()}this.emit(l.WORLD_STEP,s)}for(;this._elapsed>=r;)this._elapsed-=r,this.step(s)}},step:function(t){var e,i,n=this.bodies.entries,s=n.length;for(e=0;e<s;e++)(i=n[e]).enable&&i.update(t);this.useTree&&(this.tree.clear(),this.tree.load(n));var r=this.colliders.update();for(e=0;e<r.length;e++){var a=r[e];a.active&&a.update()}this.emit(l.WORLD_STEP,t),this.stepsLastFrame++},singleStep:function(){this.update(0,this._frameTimeMS),this.postUpdate()},postUpdate:function(){var t,e,i=this.bodies.entries,n=i.length,s=this.bodies,a=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<n;t++)(e=i[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o);for(n=(i=a.entries).length,t=0;t<n;t++)(e=i[t]).willDrawDebug()&&e.drawDebug(o)}var h=this.pendingDestroy;if(h.size>0){var l=this.tree,u=this.staticTree;for(n=(i=h.entries).length,t=0;t<n;t++)(e=i[t]).physicsType===r.DYNAMIC_BODY?(l.remove(e),s.delete(e)):e.physicsType===r.STATIC_BODY&&(u.remove(e),a.delete(e)),e.world=void 0,e.gameObject=void 0;h.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,s=t.angularAcceleration,r=t.angularDrag,a=t.maxAngular;s?n+=s*e:t.allowDrag&&r&&(c(n-(r*=e),0,.1)?n-=r:d(n+r,0,.1)?n+=r:n=0);var o=(n=i(n,-a,a))-t.angularVelocity;t.angularVelocity+=o,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,s=t.acceleration.x,r=t.drag.x,a=t.maxVelocity.x,o=t.velocity.y,h=t.acceleration.y,l=t.drag.y,f=t.maxVelocity.y,p=t.speed,g=t.maxSpeed,m=t.allowDrag,v=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,o+=(this.gravity.y+t.gravity.y)*e),s?n+=s*e:m&&r&&(v?(n*=r=Math.pow(r,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(n=0)):c(n-(r*=e),0,.01)?n-=r:d(n+r,0,.01)?n+=r:n=0),h?o+=h*e:m&&l&&(v?(o*=l=Math.pow(l,e),p=Math.sqrt(n*n+o*o),u(p,0,.001)&&(o=0)):c(o-(l*=e),0,.01)?o-=l:d(o+l,0,.01)?o+=l:o=0),n=i(n,-a,a),o=i(o,-f,f),t.velocity.set(n,o),g>-1&&t.velocity.length()>g&&(t.velocity.normalize().scale(g),p=g),t.speed=p},separate:function(t,e,i,n,s){var r,a,o=!1,h=!0;if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e)||0===(t.collisionMask&e.collisionCategory)||0===(e.collisionMask&t.collisionCategory))return o;if(i&&!1===i.call(n,t.gameObject||t,e.gameObject||e))return o;if(t.isCircle||e.isCircle){var u=this.separateCircle(t,e,s);u.result?(o=!0,h=!1):(r=u.x,a=u.y,h=!0)}if(h){var c=!1,d=!1,f=this.OVERLAP_BIAS;s?(c=E(t,e,s,f,r),d=S(t,e,s,f,a)):this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(c=E(t,e,s,f,r),this.intersects(t,e)&&(d=S(t,e,s,f,a))):(d=S(t,e,s,f,a),this.intersects(t,e)&&(c=E(t,e,s,f,r))),o=c||d}return o&&(s?(t.onOverlap||e.onOverlap)&&this.emit(l.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(l.COLLIDE,t.gameObject,e.gameObject,t,e)),o},separateCircle:function(e,i,n){f(e,i,!1,0),p(e,i,!1,0);var s=e.isCircle,r=i.isCircle,h=e.center,l=i.center,u=e.immovable,c=i.immovable,d=e.velocity,g=i.velocity,m=0,y=!0;if(s!==r){y=!1;var x=h.x,w=h.y,b=e.halfWidth,T=i.position.x,E=i.position.y,S=i.right,_=i.bottom;r&&(x=l.x,w=l.y,b=i.halfWidth,T=e.position.x,E=e.position.y,S=e.right,_=e.bottom),w<E?x<T?m=a(x,w,T,E)-b:x>S&&(m=a(x,w,S,E)-b):w>_&&(x<T?m=a(x,w,T,_)-b:x>S&&(m=a(x,w,S,_)-b)),m*=-1}else m=e.halfWidth+i.halfWidth-o(h,l);e.overlapR=m,i.overlapR=m;var C=t(h,l),A=(m+v.EPSILON)*Math.cos(C),M=(m+v.EPSILON)*Math.sin(C),P={overlap:m,result:!1,x:A,y:M};if(n&&(!y||y&&0!==m))return P.result=!0,P;if(!y&&0===m||u&&c||e.customSeparateX||i.customSeparateX)return P.x=void 0,P.y=void 0,P;var R=!e.pushable&&!i.pushable;if(y){var L=h.x-l.x,O=h.y-l.y,F=Math.sqrt(Math.pow(L,2)+Math.pow(O,2)),k=(l.x-h.x)/F||0,D=(l.y-h.y)/F||0,I=2*(d.x*k+d.y*D-g.x*k-g.y*D)/(e.mass+i.mass);!u&&!c&&e.pushable&&i.pushable||(I*=2),!u&&e.pushable&&(d.x=d.x-I/e.mass*k,d.y=d.y-I/e.mass*D,d.multiply(e.bounce)),!c&&i.pushable&&(g.x=g.x+I/i.mass*k,g.y=g.y+I/i.mass*D,g.multiply(i.bounce)),u||c||(A*=.5,M*=.5),(!u||e.pushable||R)&&(e.x-=A,e.y-=M,e.updateCenter()),(!c||i.pushable||R)&&(i.x+=A,i.y+=M,i.updateCenter()),P.result=!0}else u||!e.pushable&&!R||(e.x-=A,e.y-=M,e.updateCenter()),c||!i.pushable&&!R||(i.x+=A,i.y+=M,i.updateCenter()),P.x=void 0,P.y=void 0;return P},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?o(t.center,e.center)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.left||t.bottom<=e.top||t.left>=e.right||t.top>=e.bottom))},circleBodyIntersects:function(t,e){var n=i(t.center.x,e.left,e.right),s=i(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-s)*(t.center.y-s)<=t.halfWidth*t.halfWidth},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.collideObjects(t,e,i,n,s,!1)},collideObjects:function(t,e,i,n,s,r){var a,o;!t.isParent||void 0!==t.physicsType&&void 0!==e&&t!==e||(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var h=Array.isArray(t),l=Array.isArray(e);if(this._total=0,h||l)if(!h&&l)for(a=0;a<e.length;a++)this.collideHandler(t,e[a],i,n,s,r);else if(h&&!l)if(e)for(a=0;a<t.length;a++)this.collideHandler(t[a],e,i,n,s,r);else for(a=0;a<t.length;a++){var u=t[a];for(o=a+1;o<t.length;o++)a!==o&&this.collideHandler(u,t[o],i,n,s,r)}else for(a=0;a<t.length;a++)for(o=0;o<e.length;o++)this.collideHandler(t[a],e[o],i,n,s,r);else this.collideHandler(t,e,i,n,s,r);return this._total>0},collideHandler:function(t,e,i,n,s,r){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,i,n,s,r);if(!t||!e)return!1;if(t.body||t.isBody){if(e.body||e.isBody)return this.collideSpriteVsSprite(t,e,i,n,s,r);if(e.isParent)return this.collideSpriteVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,i,n,s,r)}else if(t.isParent){if(e.body||e.isBody)return this.collideSpriteVsGroup(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsGroup(t,e,i,n,s,r);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,i,n,s,r)}else if(t.isTilemap){if(e.body||e.isBody)return this.collideSpriteVsTilemapLayer(e,t,i,n,s,r);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,i,n,s,r)}},canCollide:function(t,e){return t&&e&&0!==(t.collisionMask&e.collisionCategory)&&0!==(e.collisionMask&t.collisionCategory)},collideSpriteVsSprite:function(t,e,i,n,s,r){var a=t.isBody?t:t.body,o=e.isBody?e:e.body;return!!this.canCollide(a,o)&&(this.separate(a,o,n,s,r)&&(i&&i.call(s,t,e),this._total++),!0)},collideSpriteVsGroup:function(t,e,i,n,s,a){var o,h,l,u=t.isBody?t:t.body;if(0!==e.getLength()&&u&&u.enable&&!u.checkCollision.none&&this.canCollide(u,e))if(this.useTree||e.physicsType===r.STATIC_BODY){var c=this.treeMinMax;c.minX=u.left,c.minY=u.top,c.maxX=u.right,c.maxY=u.bottom;var d=e.physicsType===r.DYNAMIC_BODY?this.tree.search(c):this.staticTree.search(c);for(h=d.length,o=0;o<h;o++)u!==(l=d[o])&&l.enable&&!l.checkCollision.none&&e.contains(l.gameObject)&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}else{var f=e.getChildren(),p=e.children.entries.indexOf(t);for(h=f.length,o=0;o<h;o++)(l=f[o].body)&&o!==p&&l.enable&&this.separate(u,l,n,s,a)&&(i&&i.call(s,u.gameObject,l.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,i,n,s,r){if(!this.canCollide(t,e))return!1;var a=t.getChildren();if(0===a.length)return!1;for(var o=!1,h=0;h<a.length;h++)(a[h].body||a[h].isBody)&&this.collideSpriteVsTilemapLayer(a[h],e,i,n,s,r)&&(o=!0);return o},collideTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!1,!1)},overlapTiles:function(t,e,i,n,s){return!(0===e.length||t.body&&!t.body.enable||t.isBody&&!t.enable)&&this.collideSpriteVsTilesHandler(t,e,i,n,s,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,i,n,s,r){var a=t.isBody?t:t.body;if(!a.enable||a.checkCollision.none||!this.canCollide(a,e))return!1;var o=e.layer,h=a.x-o.tileWidth*e.scaleX,l=a.y-o.tileHeight*e.scaleY,u=a.width+o.tileWidth*e.scaleX,c=a.height+o.tileHeight*e.scaleY,d=r?null:this.tileFilterOptions,f=g(h,l,u,c,d,e.scene.cameras.main,e.layer);return 0!==f.length&&this.collideSpriteVsTilesHandler(t,f,i,n,s,r,!0)},collideSpriteVsTilesHandler:function(t,e,i,n,s,r,a){for(var o,h,u=t.isBody?t:t.body,c={left:0,right:0,top:0,bottom:0},d=!1,f=0;f<e.length;f++){var p=(h=(o=e[f]).tilemapLayer).tileToWorldXY(o.x,o.y);c.left=p.x,c.top=p.y,c.right=c.left+o.width*h.scaleX,c.bottom=c.top+o.height*h.scaleY,A(c,u)&&(!n||n.call(s,t,o))&&x(o,t)&&(r||T(f,u,o,c,h,this.TILE_BIAS,a))&&(this._total++,d=!0,i&&i.call(s,t,o),r&&u.onOverlap?this.emit(l.TILE_OVERLAP,t,o,u):u.onCollide&&this.emit(l.TILE_COLLIDE,t,o,u))}return d},collideGroupVsGroup:function(t,e,i,n,s,r){if(0!==t.getLength()&&0!==e.getLength()&&this.canCollide(t,e))for(var a=t.getChildren(),o=0;o<a.length;o++)this.collideSpriteVsGroup(a[o],e,i,n,s,r)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var i=0;i<t.length;i++)this.wrapObject(t[i],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=R(t.x,this.bounds.left-e,this.bounds.right+e),t.y=R(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null,this.debugGraphic&&(this.debugGraphic.destroy(),this.debugGraphic=null)}});return W9=L}function get(){if(q9)return j9;q9=1;var t=Ih(),e=Ou(),i=EU(),n=KY(),s=Ktt(),r=kh(),a=JH(),o=ztt(),h=Ntt(),l=Cu(),u=Au(),c=wu(),d=pet(),f=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.world,this.add,this._category=1,t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.start,this)},boot:function(){this.world=new d(this.scene,this.config),this.add=new s(this.world),this.systems.events.once(u.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new d(this.scene,this.config),this.add=new s(this.world));var t=this.systems.events;r(this.config,"customUpdate",!1)||t.on(u.UPDATE,this.world.update,this.world),t.on(u.POST_UPDATE,this.world.postUpdate,this.world),t.once(u.SHUTDOWN,this.shutdown,this)},enableUpdate:function(){this.systems.events.on(u.UPDATE,this.world.update,this.world)},disableUpdate:function(){this.systems.events.off(u.UPDATE,this.world.update,this.world)},getConfig:function(){var t=this.systems.game.config.physics,e=this.systems.settings.physics;return a(r(e,"arcade",{}),r(t,"arcade",{}))},nextCategory:function(){return this._category=this._category<<1,this._category},overlap:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!0)},collide:function(t,e,i,n,s){return void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=i),this.world.collideObjects(t,e,i,n,s,!1)},collideTiles:function(t,e,i,n,s){return this.world.collideTiles(t,e,i,n,s)},overlapTiles:function(t,e,i,n,s){return this.world.overlapTiles(t,e,i,n,s)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,i,n,s,r){void 0===n&&(n=60);var a=Math.atan2(i-t.y,e-t.x);return t.body.acceleration.setToPolar(a,n),void 0!==s&&void 0!==r&&t.body.maxVelocity.set(s,r),a},accelerateToObject:function(t,e,i,n,s){return this.accelerateTo(t,e.x,e.y,i,n,s)},closest:function(t,e){e||(e=this.world.bodies.entries);for(var i=Number.MAX_VALUE,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c<i&&(s=l,i=c)}}return s},furthest:function(t,e){e||(e=this.world.bodies.entries);for(var i=-1,s=null,r=t.x,a=t.y,o=e.length,h=0;h<o;h++){var l=e[h],u=l.body||l;if(t!==l&&t!==u&&t!==u.gameObject&&t!==u.center){var c=n(r,a,u.center.x,u.center.y);c>i&&(s=l,i=c)}}return s},moveTo:function(t,e,n,s,r){void 0===s&&(s=60),void 0===r&&(r=0);var a=Math.atan2(n-t.y,e-t.x);return r>0&&(s=i(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(a,s),a},moveToObject:function(t,e,i,n){return this.moveTo(t,e.x,e.y,i,n)},velocityFromAngle:function(t,i,n){return void 0===i&&(i=60),void 0===n&&(n=new c),n.setToPolar(e(t),i)},velocityFromRotation:function(t,e,i){return void 0===e&&(e=60),void 0===i&&(i=new c),i.setToPolar(t,e)},overlapRect:function(t,e,i,n,s,r){return h(this.world,t,e,i,n,s,r)},overlapCirc:function(t,e,i,n,s){return o(this.world,t,e,i,n,s)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(u.UPDATE,this.world.update,this.world),t.off(u.POST_UPDATE,this.world.postUpdate,this.world),t.off(u.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null,this._category=1}},destroy:function(){this.shutdown(),this.scene.sys.events.off(u.START,this.start,this),this.scene=null,this.systems=null}});return l.register("ArcadePhysics",f,"arcadePhysics"),j9=f}function met(){if(Z9)return K9;Z9=1;var t={ProcessTileCallbacks:eet(),ProcessTileSeparationX:net(),ProcessTileSeparationY:ret(),SeparateTile:het(),TileCheckX:set(),TileCheckY:aet(),TileIntersectsBody:oet()};return K9=t}function vet(){if(J9)return $9;J9=1;var t=Dtt(),e=jo(),i={ArcadePhysics:get(),Body:Wtt(),Collider:Ztt(),Components:Utt(),Events:Gtt(),Factory:Ktt(),GetCollidesWith:Itt(),GetOverlapX:$tt(),GetOverlapY:Jtt(),SeparateX:cet(),SeparateY:fet(),Group:Vtt(),Image:Ytt(),Sprite:Xtt(),StaticBody:jtt(),StaticGroup:qtt(),Tilemap:met(),World:pet()};return i=e(!1,i,t),$9=i}function yet(){if(itt)return ett;itt=1;var t=new(Ih())({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return ett=t}function xet(){if(stt)return ntt;stt=1;var t=yet(),e=Ih(),i=Au(),n=new e({Extends:t,initialize:function(e,n,s){t.call(this,n),this.scene=e,this.systems=e.sys,this.pluginKey=s,e.sys.events.once(i.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});return ntt=n}var wet,bet,Tet,Eet,_et,Cet,Aet,Met,Pet,Ret,Let,Oet,Fet,ket,Det,Iet,Bet,Net,zet,Uet,Yet,Xet,Get,Het,Wet,Vet,jet,qet,Ket,Zet,$et,Jet,Qet,tit,eit,iit,nit,sit,rit,ait,oit,hit,lit,uit,cit,dit,fit,pit,git,mit,vit,yit,xit,wit,bit,Tit,Eit,Sit,_it,Cit,Ait,Mit,Pit,Rit,Lit,Oit,Fit,kit,Dit,Iit,Bit,Nit,zit,Uit,Yit,Xit,Git,Hit,Wit,Vit,jit,qit,Kit,Zit,$it,Jit,Qit,tnt,ent,int,nnt,snt,rnt,ant,ont,hnt,lnt,unt,cnt,dnt,fnt,pnt,gnt,mnt,vnt,ynt,xnt,wnt,bnt,Tnt,Ent,Snt,_nt,Cnt,Ant,Mnt,Pnt,Rnt,Lnt,Ont,Fnt,knt,Dnt,Int,Bnt,Nnt,znt,Unt,Ynt,Xnt,Gnt,Hnt,Wnt,Vnt,jnt,qnt,Knt,Znt,$nt,Jnt,Qnt,tst,est,ist,nst,sst,rst,ast,ost,hst,lst,ust,cst,dst,fst,pst,gst,mst,vst,yst,xst,wst,bst,Tst,Est,Sst,_st,Cst,Ast,Mst,Pst,Rst,Lst,Ost,Fst,kst,Dst,Ist,Bst,Nst,zst,Ust,Yst,Xst,Gst,Hst,Wst,Vst,jst,qst,Kst,Zst,$st,Jst,Qst,trt,ert,irt,nrt,srt,rrt,art,ort,hrt,lrt,urt,crt,drt,frt,prt,grt,mrt,vrt,yrt,xrt,wrt,brt,Trt,Ert,Srt,_rt,Crt,Art,Mrt,Prt,Rrt,Lrt,Ort,Frt,krt,Drt,Irt,Brt,Nrt,zrt,Urt,Yrt,Xrt,Grt,Hrt={exports:{}};function Wrt(){if(Cet)return _et;Cet=1;var t=_X(),e=jo(),i={FX:wG(),BitmapMaskPipeline:YX(),Events:BX(),FXPipeline:DG(),LightPipeline:IG(),MobilePipeline:BG(),MultiPipeline:_G(),PointLightPipeline:NG(),PostFXPipeline:WX(),PreFXPipeline:MG(),RopePipeline:zG(),SinglePipeline:UG(),UtilityPipeline:YG()};return i=e(!1,i,t),_et=i}function Vrt(){if(Met)return Aet;Met=1;var t={WebGLAttribLocationWrapper:qG(),WebGLBufferWrapper:HG(),WebGLProgramWrapper:WG(),WebGLTextureWrapper:VG(),WebGLFramebufferWrapper:jG(),WebGLUniformLocationWrapper:KG()};return Aet=t}function jrt(){if(Fet)return Oet;Fet=1;var t=jo(),e=AH(),i={Center:EH(),Events:kY(),Orientation:SH(),ScaleManager:VH(),ScaleModes:_H(),Zoom:CH()};return i=t(!1,i,e.CENTER),i=t(!1,i,e.ORIENTATION),i=t(!1,i,e.SCALE_MODE),i=t(!1,i,e.ZOOM),Oet=i}function qrt(){if(Det)return ket;Det=1;var t=Yh(),e=Ih(),i=Au(),n=kh(),s=Cu(),r=new e({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._onUpdate,this._onUpdateScope,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.pluginStart,this)},boot:function(){this.systems.events.once(i.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(i.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=n(t,"target",!1),s=this.manager.getScene(e);if(!e||!this.checkValidTransition(s))return!1;var r=n(t,"duration",1e3);this._elapsed=0,this._target=s,this._duration=r,this._willSleep=n(t,"sleep",!1),this._willRemove=n(t,"remove",!1);var a=n(t,"onUpdate",null);a&&(this._onUpdate=a,this._onUpdateScope=n(t,"onUpdateScope",this.scene));var o=n(t,"allowInput",!1);this.settings.transitionAllowInput=o;var h=s.sys.settings;h.isTransition=!0,h.transitionFrom=this.scene,h.transitionDuration=r,h.transitionAllowInput=o,n(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):n(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),s.sys.isSleeping()?s.sys.wake(n(t,"data")):this.manager.start(e,n(t,"data"));var l=n(t,"onStart",null),u=n(t,"onStartScope",this.scene);return l&&l.call(u,this.scene,s,r),this.systems.events.emit(i.TRANSITION_OUT,s,r),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(e,i){this._elapsed+=i,this.transitionProgress=t(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;t.events.emit(i.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,i,n){return this.manager.add(t,e,i,n)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t,e){return t!==this.key&&this.manager.queueOp("switch",this.key,t,e),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,i){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setActive(t,i),this},setVisible:function(t,e){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getStatus:function(t){var e=this.manager.getScene(t);if(e)return e.sys.getStatus()},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(i.SHUTDOWN,this.shutdown,this),t.off(i.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});return s.register("ScenePlugin",r,"scenePlugin"),ket=r}function Krt(){if(Bet)return Iet;Bet=1;var t=jH(),e=jo(),i={Events:Au(),GetPhysicsPlugins:KH(),GetScenePlugins:ZH(),SceneManager:iW(),ScenePlugin:qrt(),Settings:QH(),Systems:tW()};return i=e(!1,i,t),Iet=i}function Zrt(){if(Get)return Xet;Get=1;var t=jo(),e=Yet?Uet:(Yet=1,Uet={LINEAR:0,NEAREST:1}),i={CanvasTexture:rW(),DynamicTexture:aW(),Events:LX(),FilterMode:e,Frame:Uu(),Parsers:mW(),Texture:sW(),TextureManager:vW(),TextureSource:nW()};return i=t(!1,i,e),Xet=i}function $rt(){return Wet?Het:(Wet=1,Het={ORTHOGONAL:0,ISOMETRIC:1,STAGGERED:2,HEXAGONAL:3})}function Jrt(){return Ket?qet:(Ket=1,qet=function(t,e,i){return t>=0&&t<i.width&&e>=0&&e<i.height})}function Qrt(){if($et)return Zet;$et=1;var t=Jrt();return Zet=function(e,i,n,s){if(t(e,i,s)){var r=s.data[i][e]||null;return r?-1===r.index?n?r:null:r:null}return null}}function tat(){if(Qet)return Jet;Qet=1;var t=Qrt();return Jet=function(e,i,n){var s=t(e,i,!0,n),r=t(e,i-1,!0,n),a=t(e,i+1,!0,n),o=t(e-1,i,!0,n),h=t(e+1,i,!0,n),l=s&&s.collides;return l&&(s.faceTop=!0,s.faceBottom=!0,s.faceLeft=!0,s.faceRight=!0),r&&r.collides&&(l&&(s.faceTop=!1),r.faceBottom=!l),a&&a.collides&&(l&&(s.faceBottom=!1),a.faceTop=!l),o&&o.collides&&(l&&(s.faceLeft=!1),o.faceRight=!l),h&&h.collides&&(l&&(s.faceRight=!1),h.faceLeft=!l),s&&!s.collides&&s.resetFaces(),s}}function eat(){if(eit)return tit;eit=1;var t=Qrt(),e=Qtt();return tit=function(i,n,s,r,a){for(var o=null,h=null,l=null,u=null,c=e(i,n,s,r,null,a),d=0;d<c.length;d++){var f=c[d];f&&(f.collides?(o=t(f.x,f.y-1,!0,a),h=t(f.x,f.y+1,!0,a),l=t(f.x-1,f.y,!0,a),u=t(f.x+1,f.y,!0,a),f.faceTop=!o||!o.collides,f.faceBottom=!h||!h.collides,f.faceLeft=!l||!l.collides,f.faceRight=!u||!u.collides):f.resetFaces())}}}function iat(){if(nit)return iit;nit=1;var t=new(wu());return iit=function(e,i,n,s){var r=n.tilemapLayer,a=r.cullPaddingX,o=r.cullPaddingY,h=r.tilemap.tileToWorldXY(e,i,t,s,r);return h.x>s.worldView.x+r.scaleX*n.tileWidth*(-a-.5)&&h.x<s.worldView.right+r.scaleX*n.tileWidth*(a-.5)&&h.y>s.worldView.y+r.scaleY*n.tileHeight*(-o-1)&&h.y<s.worldView.bottom+r.scaleY*n.tileHeight*(o-.5)}}function nat(){if(rit)return sit;rit=1;var t=Ih(),e=Zu(),i=$rt(),n=Iu(),s=_4(),r=new t({Mixins:[e.AlphaSingle,e.Flip,e.Visible],initialize:function(t,e,i,n,s,r,a,o){this.layer=t,this.index=e,this.x=i,this.y=n,this.width=s,this.height=r,this.right,this.bottom,this.baseWidth=void 0!==a?a:s,this.baseHeight=void 0!==o?o:r,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=void 0,this.collisionCallbackContext=this,this.tint=16777215,this.tintFill=!1,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=n(t.properties),this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).x:this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldXY(this.x,this.y,void 0,t).y:this.y*this.baseWidth-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new s),e.x=this.getLeft(t),e.y=this.getTop(t),e.width=this.getRight(t)-e.x,e.height=this.getBottom(t)-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},intersects:function(t,e,i,n){return!(i<=this.pixelX||n<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){return void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,i,n,s){return void 0===e&&(e=t),void 0===i&&(i=t),void 0===n&&(n=t),void 0===s&&(s=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=i,this.collideDown=n,this.faceLeft=t,this.faceRight=e,this.faceTop=i,this.faceBottom=n,s&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,i,n){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==i&&(this.baseWidth=i),void 0!==n&&(this.baseHeight=n),this.updatePixelXY(),this},updatePixelXY:function(){var t=this.layer.orientation;if(t===i.ORTHOGONAL)this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight;else if(t===i.ISOMETRIC)this.pixelX=(this.x-this.y)*this.baseWidth*.5,this.pixelY=(this.x+this.y)*this.baseHeight*.5;else if(t===i.STAGGERED)this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2),this.pixelY=this.y*(this.baseHeight/2);else if(t===i.HEXAGONAL){var e,n,s=this.layer.staggerAxis,r=this.layer.staggerIndex,a=this.layer.hexSideLength;"y"===s?(n=(this.baseHeight-a)/2+a,this.pixelX="odd"===r?this.x*this.baseWidth+this.y%2*(this.baseWidth/2):this.x*this.baseWidth-this.y%2*(this.baseWidth/2),this.pixelY=this.y*n):"x"===s&&(e=(this.baseWidth-a)/2+a,this.pixelX=this.x*e,this.pixelY="odd"===r?this.y*this.baseHeight+this.x%2*(this.baseHeight/2):this.y*this.baseHeight-this.x%2*(this.baseHeight/2))}return this.right=this.pixelX+this.baseWidth,this.bottom=this.pixelY+this.baseHeight,this},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||void 0!==this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});return sit=r}function sat(){if(oit)return ait;oit=1;var t=eat(),e=Qtt(),i=Jrt(),n=nat();return ait=function(s,r,a,o,h,l,u,c){void 0===u&&(u=!0);var d=e(s,r,a,o,null,c),f=[];d.forEach(function(t){var e=new n(t.layer,t.index,t.x,t.y,t.width,t.height,t.baseWidth,t.baseHeight);e.copy(t),f.push(e)});for(var p=h-s,g=l-r,m=0;m<f.length;m++){var v=f[m],y=v.x+p,x=v.y+g;i(y,x,c)&&c.data[x][y]&&(v.x=y,v.y=x,v.updatePixelXY(),c.data[x][y]=v)}u&&t(h-1,l-1,a+2,o+2,c),d.length=0,f.length=0}}function rat(){if(lit)return hit;lit=1;var t=Qtt();return hit=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&h[l].index===e&&(h[l].index=i)}}function aat(){if(cit)return uit;cit=1;var t=Iu(),e=Qtt(),i=rat();return uit=function(n,s,r,a,o,h){r||(r={}),Array.isArray(n)||(n=[n]);var l=h.tilemapLayer;a||(a=l.scene),o||(o=a.cameras.main);var u,c=h.width,d=h.height,f=e(0,0,c,d,null,h),p=[],g=function(t,e,i){for(var n=0;n<i.length;n++){var s=i[n];t.hasOwnProperty(s)||(t[s]=e[s])}};for(u=0;u<f.length;u++){var m=f[u],v=t(r);if(-1!==n.indexOf(m.index)){var y=l.tileToWorldXY(m.x,m.y,void 0,o,h);v.x=y.x,v.y=y.y,g(v,m,["rotation","flipX","flipY","alpha","visible","tint"]),v.hasOwnProperty("origin")||(v.x+=.5*m.width,v.y+=.5*m.height),v.hasOwnProperty("useSpriteSheet")&&(v.key=m.tileset.image,v.frame=m.index-m.tileset.firstgid),p.push(a.make.sprite(v))}}if(Array.isArray(s))for(u=0;u<n.length;u++)i(n[u],s[u],0,0,c,d,h);else if(null!==s)for(u=0;u<n.length;u++)i(n[u],s,0,0,c,d,h);return p},uit}function oat(){if(fit)return dit;fit=1;var t=Eu(),e=uX(),i=cX(),n=new t;return dit=function(t,s){var r=t.tilemapLayer.tilemap,a=t.tilemapLayer,o=Math.floor(r.tileWidth*a.scaleX),h=Math.floor(r.tileHeight*a.scaleY),l=i(s.worldView.x-a.x,o,0,!0)-a.cullPaddingX,u=e(s.worldView.right-a.x,o,0,!0)+a.cullPaddingX,c=i(s.worldView.y-a.y,h,0,!0)-a.cullPaddingY,d=e(s.worldView.bottom-a.y,h,0,!0)+a.cullPaddingY;return n.setTo(l,c,u-l,d-c)},dit}function hat(){return git||(git=1,pit=function(t,e,i,n){var s,r,a,o=t.data,h=t.width,l=t.height,u=t.tilemapLayer,c=Math.max(0,e.left),d=Math.min(h,e.right),f=Math.max(0,e.top),p=Math.min(l,e.bottom);if(0===i)for(r=f;r<p;r++)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(1===i)for(r=f;r<p;r++)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(2===i)for(r=p;r>=f;r--)for(s=c;o[r]&&s<d;s++)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);else if(3===i)for(r=p;r>=f;r--)for(s=d;o[r]&&s>=c;s--)(a=o[r][s])&&-1!==a.index&&a.visible&&0!==a.alpha&&n.push(a);return u.tilesDrawn=n.length,u.tilesTotal=h*l,n}),pit}function lat(){if(vit)return mit;vit=1;var t=oat(),e=hat();return mit=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return(a.skipCull||1!==a.scrollFactorX||1!==a.scrollFactorY)&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},mit}function uat(){return xit?yit:(xit=1,yit=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)})}function cat(){if(bit)return wit;bit=1;var t=Qtt(),e=eat(),i=uat();return wit=function(n,s,r,a,o,h,l){for(var u=-1!==l.collideIndexes.indexOf(n),c=t(s,r,a,o,null,l),d=0;d<c.length;d++)c[d].index=n,i(c[d],u);h&&e(s-1,r-1,a+2,o+2,l)}}function dat(){if(Eit)return Tit;Eit=1;var t=Qtt();return Tit=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).filter(e,i)}}function fat(){if(Ait)return Cit;Ait=1;var t=Qtt();return Cit=function(e,i,n,s,r,a,o,h){return t(n,s,r,a,o,h).find(e,i)||null}}function pat(){if(Pit)return Mit;Pit=1;var t=Qtt();return Mit=function(e,i,n,s,r,a,o,h){t(n,s,r,a,o,h).forEach(e,i)}}function gat(){if(Lit)return Rit;Lit=1;var t=uX(),e=cX();return Rit=function(i,n){var s,r,a,o,h=i.tilemapLayer.tilemap,l=i.tilemapLayer,u=Math.floor(h.tileWidth*l.scaleX),c=Math.floor(h.tileHeight*l.scaleY),d=i.hexSideLength;if("y"===i.staggerAxis){var f=(c-d)/2+d;s=e(n.worldView.x-l.x,u,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,u,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,f,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,f,0,!0)+l.cullPaddingY}else{var p=(u-d)/2+d;s=e(n.worldView.x-l.x,p,0,!0)-l.cullPaddingX,r=t(n.worldView.right-l.x,p,0,!0)+l.cullPaddingX,a=e(n.worldView.y-l.y,c,0,!0)-l.cullPaddingY,o=t(n.worldView.bottom-l.y,c,0,!0)+l.cullPaddingY}return{left:s,right:r,top:a,bottom:o}},Rit}function mat(){if(Fit)return Oit;Fit=1;var t=gat(),e=hat();return Oit=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},Oit}function vat(){if(Dit)return kit;Dit=1;var t=iat();return kit=function(e,i,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var r,a,o,h=e.tilemapLayer,l=e.data,u=e.width,c=e.height,d=h.skipCull,f=u,p=c;if(0===s)for(a=0;a<p;a++)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(1===s)for(a=0;a<p;a++)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(2===s)for(a=p;a>=0;a--)for(r=0;r<f;r++)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);else if(3===s)for(a=p;a>=0;a--)for(r=f;r>=0;r--)(o=l[a][r])&&-1!==o.index&&o.visible&&0!==o.alpha&&(d||t(r,a,e,i))&&n.push(o);return h.tilesDrawn=n.length,h.tilesTotal=u*c,n}}function yat(){if(Bit)return Iit;Bit=1;var t=uX(),e=cX();return Iit=function(i,n){var s=i.tilemapLayer.tilemap,r=i.tilemapLayer,a=Math.floor(s.tileWidth*r.scaleX),o=Math.floor(s.tileHeight*r.scaleY);return{left:e(n.worldView.x-r.x,a,0,!0)-r.cullPaddingX,right:t(n.worldView.right-r.x,a,0,!0)+r.cullPaddingX,top:e(n.worldView.y-r.y,o/2,0,!0)-r.cullPaddingY,bottom:t(n.worldView.bottom-r.y,o/2,0,!0)+r.cullPaddingY}},Iit}function xat(){if(zit)return Nit;zit=1;var t=yat(),e=hat();return Nit=function(i,n,s,r){void 0===s&&(s=[]),void 0===r&&(r=0),s.length=0;var a=i.tilemapLayer,o=t(i,n);return a.skipCull&&1===a.scrollFactorX&&1===a.scrollFactorY&&(o.left=0,o.right=i.width,o.top=0,o.bottom=i.height),e(i,o,r,s),s},Nit}function wat(){if(Yit)return Uit;Yit=1;var t=$rt(),e=lat(),i=mat(),n=vat(),s=Dh(),r=xat();return Uit=function(a){return a===t.ORTHOGONAL?e:a===t.HEXAGONAL?i:a===t.STAGGERED?r:a===t.ISOMETRIC?n:s}}function bat(){if(Git)return Xit;Git=1;var t=Qrt(),e=new(wu());return Xit=function(i,n,s,r,a){return a.tilemapLayer.worldToTileXY(i,n,!0,e,r),t(e.x,e.y,s,a)}}function Tat(){if(Wit)return Hit;Wit=1;var t=wu();return Hit=function(e,i,n,s){var r=s.baseTileWidth,a=s.baseTileHeight,o=s.tilemapLayer,h=0,l=0;o&&(n||(n=o.scene.cameras.main),h=o.x+n.scrollX*(1-o.scrollFactorX),l=o.y+n.scrollY*(1-o.scrollFactorY),r*=o.scaleX,a*=o.scaleY);var u=h+e*r,c=l+i*a;return[new t(u,c),new t(u+r,c),new t(u+r,c+a),new t(u,c+a)]}}function Eat(){if(jit)return Vit;jit=1;var t=wu();return Vit=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),u=h.y+s.scrollY*(1-h.scrollFactorY),a*=h.scaleX,o*=h.scaleY);var c,d,f=a/2,p=o/2,g=r.staggerAxis,m=r.staggerIndex;return"y"===g?(c=l+a*e+a,d=u+1.5*i*p+p,i%2==0&&("odd"===m?c-=f:c+=f)):"x"===g&&"odd"===m&&(c=l+1.5*e*f+f,d=u+o*e+o,e%2==0&&("odd"===m?d-=p:d+=p)),n.set(c,d)},Vit}function Sat(){if(Kit)return qit;Kit=1;var t=Eat(),e=wu(),i=new e;return qit=function(n,s,r,a){var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(o*=l.scaleX,h*=l.scaleY);var u,c,d=t(n,s,i,r,a),f=[],p=.5773502691896257;"y"===a.staggerAxis?(u=p*o,c=h/2):(u=o/2,c=p*h);for(var g=0;g<6;g++){var m=2*Math.PI*(.5-g)/6;f.push(new e(d.x+u*Math.cos(m),d.y+c*Math.sin(m)))}return f}}function _at(){if($it)return Zit;$it=1;var t=$rt(),e=Sat(),i=Dh(),n=Tat();return Zit=function(s){return s===t.ORTHOGONAL?n:s===t.ISOMETRIC?i:s===t.HEXAGONAL?e:(t.STAGGERED,i)}}function Cat(){if(Qit)return Jit;Qit=1;var t=L4(),e=Qtt(),i=u4(),n=Dh(),s=wu(),r=$rt(),a=function(t,e){return i.RectangleToTriangle(e,t)},o=new s,h=new s,l=new s;return Jit=function(s,u,c,d){if(d.orientation!==r.ORTHOGONAL)return console.warn("GetTilesWithinShape only works with orthogonal tilemaps"),[];if(void 0===s)return[];var f=n;s instanceof t.Circle?f=i.CircleToRectangle:s instanceof t.Rectangle?f=i.RectangleToRectangle:s instanceof t.Triangle?f=a:s instanceof t.Line&&(f=i.LineToRectangle),d.tilemapLayer.worldToTileXY(s.left,s.top,!0,h,c);var p=h.x,g=h.y;d.tilemapLayer.worldToTileXY(s.right,s.bottom,!1,l,c);var m=Math.ceil(l.x),v=Math.ceil(l.y),y=Math.max(m-p,1),x=Math.max(v-g,1),w=e(p,g,y,x,u,d),b=d.tileWidth,T=d.tileHeight;d.tilemapLayer&&(b*=d.tilemapLayer.scaleX,T*=d.tilemapLayer.scaleY);for(var E=[],S=new t.Rectangle(0,0,b,T),_=0;_<w.length;_++){var C=w[_];d.tilemapLayer.tileToWorldXY(C.x,C.y,o,c),S.x=o.x,S.y=o.y,f(s,S)&&E.push(C)}return E}}function Aat(){return ent?tnt:(ent=1,tnt=function(t,e,i){var n=i.baseTileWidth,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.x+e.scrollX*(1-s.scrollFactorX),n*=s.scaleX),r+t*n})}function Mat(){if(nnt)return int;nnt=1;var t=$rt(),e=Dh(),i=Aat();return int=function(n){return n===t.ORTHOGONAL?i:e}}function Pat(){if(rnt)return snt;rnt=1;var t=wu();return snt=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+a/2*(e-i),d=u+(e+i)*(o/2);return n.set(c,d)},snt}function Rat(){if(ont)return ant;ont=1;var t=wu();return ant=function(e,i,n,s,r){n||(n=new t);var a=r.baseTileWidth,o=r.baseTileHeight,h=r.tilemapLayer,l=0,u=0;h&&(s||(s=h.scene.cameras.main),l=h.x+s.scrollX*(1-h.scrollFactorX),a*=h.scaleX,u=h.y+s.scrollY*(1-h.scrollFactorY),o*=h.scaleY);var c=l+e*a+i%2*(a/2),d=u+i*(o/2);return n.set(c,d)},ant}function Lat(){return lnt?hnt:(lnt=1,hnt=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(e||(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*n})}function Oat(){if(cnt)return unt;cnt=1;var t=Aat(),e=Lat(),i=wu();return unt=function(n,s,r,a,o){return r||(r=new i(0,0)),r.x=t(n,a,o),r.y=e(s,a,o),r},unt}function Fat(){if(fnt)return dnt;fnt=1;var t=$rt(),e=Eat(),i=Pat(),n=Dh(),s=Rat(),r=Oat();return dnt=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function kat(){return gnt?pnt:(gnt=1,pnt=function(t,e,i){var n=i.baseTileHeight,s=i.tilemapLayer,r=0;return s&&(void 0===e&&(e=s.scene.cameras.main),r=s.y+e.scrollY*(1-s.scrollFactorY),n*=s.scaleY),r+t*(n/2)+n})}function Dat(){if(vnt)return mnt;vnt=1;var t=$rt(),e=Dh(),i=kat(),n=Lat();return mnt=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function Iat(){return xnt?ynt:(xnt=1,ynt=function(){return null})}function Bat(){if(bnt)return wnt;bnt=1;var t=wu();return wnt=function(e,i,n,s,r,a){void 0===n&&(n=!0),s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u=e/o,c=i/h;return n&&(u=Math.floor(u),c=Math.floor(c)),s.set(u,c)},wnt}function Nat(){if(Ent)return Tnt;Ent=1;var t=Bat(),e=new(wu());return Tnt=function(i,n,s,r){return t(i,0,n,e,s,r),e.x}}function zat(){if(_nt)return Snt;_nt=1;var t=$rt(),e=Iat(),i=Nat();return Snt=function(n){return n===t.ORTHOGONAL?i:e}}function Uat(){if(Ant)return Cnt;Ant=1;var t=wu();return Cnt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),e-=l.x+r.scrollX*(1-l.scrollFactorX),i-=l.y+r.scrollY*(1-l.scrollFactorY),o*=l.scaleX,h*=l.scaleY);var u,c,d,f,p,g=.5773502691896257,m=-.3333333333333333,v=.6666666666666666,y=o/2,x=h/2;"y"===a.staggerAxis?(d=g*(u=(e-y)/(g*o))+m*(c=(i-x)/x),f=0*u+v*c):(d=m*(u=(e-y)/y)+g*(c=(i-x)/(g*h)),f=v*u+0*c),p=-d-f;var w,b=Math.round(d),T=Math.round(f),E=Math.round(p),S=Math.abs(b-d),_=Math.abs(T-f),C=Math.abs(E-p);S>_&&S>C?b=-T-E:_>C&&(T=-b-E);var A=T;return w="odd"===a.staggerIndex?A%2==0?T/2+b:T/2+b-.5:A%2==0?T/2+b:T/2+b+.5,s.set(w,A)},Cnt}function Yat(){if(Pnt)return Mnt;Pnt=1;var t=wu();return Mnt=function(e,i,n,s,r,a,o){s||(s=new t);var h=a.baseTileWidth,l=a.baseTileHeight,u=a.tilemapLayer;u&&(r||(r=u.scene.cameras.main),i-=u.y+r.scrollY*(1-u.scrollFactorY),l*=u.scaleY,e-=u.x+r.scrollX*(1-u.scrollFactorX),h*=u.scaleX);var c=h/2,d=l/2;o||(i-=l);var f=.5*((e-=c)/c+i/d),p=.5*(-e/c+i/d);return n&&(f=Math.floor(f),p=Math.floor(p)),s.set(f,p)},Mnt}function Xat(){if(Lnt)return Rnt;Lnt=1;var t=wu();return Rnt=function(e,i,n,s,r,a){s||(s=new t);var o=a.baseTileWidth,h=a.baseTileHeight,l=a.tilemapLayer;l&&(r||(r=l.scene.cameras.main),i-=l.y+r.scrollY*(1-l.scrollFactorY),h*=l.scaleY,e-=l.x+r.scrollX*(1-l.scrollFactorX),o*=l.scaleX);var u=n?Math.floor(i/(h/2)):i/(h/2),c=n?Math.floor((e+u%2*.5*o)/o):(e+u%2*.5*o)/o;return s.set(c,u)},Rnt}function Gat(){if(Fnt)return Ont;Fnt=1;var t=$rt(),e=Uat(),i=Yat(),n=Dh(),s=Xat(),r=Bat();return Ont=function(a){return a===t.ORTHOGONAL?r:a===t.ISOMETRIC?i:a===t.HEXAGONAL?e:a===t.STAGGERED?s:n}}function Hat(){return Dnt?knt:(Dnt=1,knt=function(t,e,i,n){var s=n.baseTileHeight,r=n.tilemapLayer;return r&&(i||(i=r.scene.cameras.main),t-=r.y+i.scrollY*(1-r.scrollFactorY),s*=r.scaleY),e?Math.floor(t/(s/2)):t/(s/2)})}function Wat(){if(Bnt)return Int;Bnt=1;var t=Bat(),e=new(wu());return Int=function(i,n,s,r){return t(0,i,n,e,s,r),e.y}}function Vat(){if(znt)return Nnt;znt=1;var t=$rt(),e=Iat(),i=Hat(),n=Wat();return Nnt=function(s){return s===t.ORTHOGONAL?n:s===t.STAGGERED?i:e}}function jat(){if(Ynt)return Unt;Ynt=1;var t=Jrt();return Unt=function(e,i,n){if(t(e,i,n)){var s=n.data[i][e];return null!==s&&s.index>-1}return!1}}function qat(){if(Gnt)return Xnt;Gnt=1;var t=jat(),e=new(wu());return Xnt=function(i,n,s,r){r.tilemapLayer.worldToTileXY(i,n,!0,e,s);var a=e.x,o=e.y;return t(a,o,r)}}function Kat(){if(Wnt)return Hnt;Wnt=1;var t=nat(),e=Jrt(),i=tat(),n=uat();return Hnt=function(s,r,a,o,h){if(void 0===o&&(o=!0),!e(r,a,h))return null;var l,u=h.data[a][r],c=u&&u.collides;s instanceof t?(null===h.data[a][r]&&(h.data[a][r]=new t(h,s.index,r,a,h.tileWidth,h.tileHeight)),h.data[a][r].copy(s)):(l=s,null===h.data[a][r]?h.data[a][r]=new t(h,l,r,a,h.tileWidth,h.tileHeight):h.data[a][r].index=l);var d=h.data[a][r],f=-1!==h.collideIndexes.indexOf(d.index);if(-1===(l=s instanceof t?s.index:s))d.width=h.tileWidth,d.height=h.tileHeight;else{var p=h.tilemapLayer.tilemap,g=p.tiles[l][2],m=p.tilesets[g];d.width=m.tileWidth,d.height=m.tileHeight}return n(d,f),o&&c!==d.collides&&i(r,a,h),d},Hnt}function Zat(){if(jnt)return Vnt;jnt=1;var t=Kat(),e=new(wu());return Vnt=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(n,s,!0,e,a,o),t(i,e.x,e.y,r,o)}}function $at(){if(Knt)return qnt;Knt=1;var t=eat(),e=Kat();return qnt=function(i,n,s,r,a){if(void 0===r&&(r=!0),!Array.isArray(i))return null;Array.isArray(i[0])||(i=[i]);for(var o=i.length,h=i[0].length,l=0;l<o;l++)for(var u=0;u<h;u++){var c=i[l][u];e(c,n+u,s+l,!1,a)}r&&t(n-1,s-1,h+2,o+2,a)}}function Jat(){if($nt)return Znt;$nt=1;var t=Qtt(),e=vl();return Znt=function(i,n,s,r,a,o){var h,l=t(i,n,s,r,{},o);if(!a)for(a=[],h=0;h<l.length;h++)-1===a.indexOf(l[h].index)&&a.push(l[h].index);for(h=0;h<l.length;h++)l[h].index=e(a)}}function Qat(){if(Qnt)return Jnt;Qnt=1;var t=nat(),e=Jrt(),i=tat();return Jnt=function(n,s,r,a,o){if(void 0===r&&(r=!0),void 0===a&&(a=!0),!e(n,s,o))return null;var h=o.data[s][n];return h?(o.data[s][n]=r?null:new t(o,-1,n,s,o.tileWidth,o.tileHeight),a&&h&&h.collides&&i(n,s,o),h):null}}function tot(){if(est)return tst;est=1;var t=Qat(),e=new(wu());return tst=function(i,n,s,r,a,o){return o.tilemapLayer.worldToTileXY(i,n,!0,e,a,o),t(e.x,e.y,s,r,o)}}function eot(){if(nst)return ist;nst=1;var t=Qtt(),e=yH(),i=new e(105,210,231,150),n=new e(243,134,48,200),s=new e(40,39,37,150);return ist=function(e,r,a){void 0===r&&(r={});var o=void 0!==r.tileColor?r.tileColor:i,h=void 0!==r.collidingTileColor?r.collidingTileColor:n,l=void 0!==r.faceColor?r.faceColor:s,u=t(0,0,a.width,a.height,null,a);e.translateCanvas(a.tilemapLayer.x,a.tilemapLayer.y),e.scaleCanvas(a.tilemapLayer.scaleX,a.tilemapLayer.scaleY);for(var c=0;c<u.length;c++){var d=u[c],f=d.tileset?d.tileset.tileOffset:{x:0,y:0},p=d.width,g=d.height,m=d.pixelX-f.x,v=d.pixelY-f.y,y=d.collides?h:o;null!==y&&(e.fillStyle(y.color,y.alpha/255),e.fillRect(m,v,p,g)),m+=1,v+=1,p-=2,g-=2,null!==l&&(e.lineStyle(1,l.color,l.alpha/255),d.faceTop&&e.lineBetween(m,v,m+p,v),d.faceRight&&e.lineBetween(m+p,v,m+p,v+g),d.faceBottom&&e.lineBetween(m,v+g,m+p,v+g),d.faceLeft&&e.lineBetween(m,v,m,v+g))}},ist}function iot(){return rst?sst:(rst=1,sst=function(t,e,i){var n=i.collideIndexes.indexOf(t);e&&-1===n?i.collideIndexes.push(t):e||-1===n||i.collideIndexes.splice(n,1)})}function not(){if(ost)return ast;ost=1;var t=uat(),e=eat(),i=iot();return ast=function(n,s,r,a,o){void 0===s&&(s=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),Array.isArray(n)||(n=[n]);for(var h=0;h<n.length;h++)i(n[h],s,a);if(o)for(var l=0;l<a.height;l++)for(var u=0;u<a.width;u++){var c=a.data[l][u];c&&-1!==n.indexOf(c.index)&&t(c,s)}r&&e(0,0,a.width,a.height,a)}}function sot(){if(lst)return hst;lst=1;var t=uat(),e=eat(),i=iot();return hst=function(n,s,r,a,o,h){if(void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===h&&(h=!0),!(n>s)){for(var l=n;l<=s;l++)i(l,r,o);if(h)for(var u=0;u<o.height;u++)for(var c=0;c<o.width;c++){var d=o.data[u][c];d&&d.index>=n&&d.index<=s&&t(d,r)}a&&e(0,0,o.width,o.height,o)}}}function rot(){if(cst)return ust;cst=1;var t=uat(),e=eat(),i=iot();return ust=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0),Array.isArray(n)||(n=[n]);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];l&&-1===n.indexOf(l.index)&&(t(l,s),i(l.index,s,a))}r&&e(0,0,a.width,a.height,a)}}function aot(){if(fst)return dst;fst=1;var t=uat(),e=eat(),i=QW();return dst=function(n,s,r,a){void 0===s&&(s=!0),void 0===r&&(r=!0);for(var o=0;o<a.height;o++)for(var h=0;h<a.width;h++){var l=a.data[o][h];if(l)for(var u in n)if(i(l.properties,u)){var c=n[u];Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;d++)l.properties[u]===c[d]&&t(l,s)}}r&&e(0,0,a.width,a.height,a)}}function oot(){if(gst)return pst;gst=1;var t=uat(),e=eat();return pst=function(i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0);for(var r=0;r<s.height;r++)for(var a=0;a<s.width;a++){var o=s.data[r][a];if(o){var h=o.getCollisionGroup();h&&h.objects&&h.objects.length>0&&t(o,i)}}n&&e(0,0,s.width,s.height,s)}}function hot(){if(xst)return yst;xst=1;var t=Qtt();return yst=function(e,i,n,s,r,a,o){for(var h=t(e,i,n,s,null,o),l=0;l<h.length;l++)h[l].setCollisionCallback(r,a)}}function lot(){if(bst)return wst;bst=1;var t=Qtt(),e=El();return wst=function(i,n,s,r,a){var o=t(i,n,s,r,null,a),h=o.map(function(t){return t.index});e(h);for(var l=0;l<o.length;l++)o[l].index=h[l]}}function uot(){if(Est)return Tst;Est=1;var t=Qtt();return Tst=function(e,i,n,s,r,a,o){for(var h=t(n,s,r,a,null,o),l=0;l<h.length;l++)h[l]&&(h[l].index===e?h[l].index=i:h[l].index===i&&(h[l].index=e))}}function cot(){if(_st)return Sst;_st=1;var t=Qtt(),e=SX();return Sst=function(i,n,s,r,a,o){if(a){var h,l=t(i,n,s,r,null,o),u=0;for(h=0;h<a.length;h++)u+=a[h].weight;if(!(u<=0))for(h=0;h<l.length;h++){for(var c=e.RND.frac()*u,d=0,f=-1,p=0;p<a.length;p++)if(c<=(d+=a[p].weight)){var g=a[p].index;f=Array.isArray(g)?g[Math.floor(e.RND.frac()*g.length)]:g;break}l[h].index=f}}}}function dot(){return Ast?Cst:(Ast=1,Cst={CalculateFacesAt:tat(),CalculateFacesWithin:eat(),CheckIsoBounds:iat(),Copy:sat(),CreateFromTiles:aat(),CullBounds:oat(),CullTiles:lat(),Fill:cat(),FilterTiles:dat(),FindByIndex:_it?Sit:(_it=1,Sit=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=!1);var s,r,a,o=0;if(i){for(r=n.height-1;r>=0;r--)for(s=n.width-1;s>=0;s--)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}}else for(r=0;r<n.height;r++)for(s=0;s<n.width;s++)if((a=n.data[r][s])&&a.index===t){if(o===e)return a;o+=1}return null}),FindTile:fat(),ForEachTile:pat(),GetCullTilesFunction:wat(),GetTileAt:Qrt(),GetTileAtWorldXY:bat(),GetTileCorners:Tat(),GetTileCornersFunction:_at(),GetTilesWithin:Qtt(),GetTilesWithinShape:Cat(),GetTilesWithinWorldXY:tet(),GetTileToWorldXFunction:Mat(),GetTileToWorldXYFunction:Fat(),GetTileToWorldYFunction:Dat(),GetWorldToTileXFunction:zat(),GetWorldToTileXYFunction:Gat(),GetWorldToTileYFunction:Vat(),HasTileAt:jat(),HasTileAtWorldXY:qat(),HexagonalCullBounds:gat(),HexagonalCullTiles:mat(),HexagonalGetTileCorners:Sat(),HexagonalTileToWorldXY:Eat(),HexagonalWorldToTileXY:Uat(),IsInLayerBounds:Jrt(),IsometricCullTiles:vat(),IsometricTileToWorldXY:Pat(),IsometricWorldToTileXY:Yat(),PutTileAt:Kat(),PutTileAtWorldXY:Zat(),PutTilesAt:$at(),Randomize:Jat(),RemoveTileAt:Qat(),RemoveTileAtWorldXY:tot(),RenderDebug:eot(),ReplaceByIndex:rat(),RunCull:hat(),SetCollision:not(),SetCollisionBetween:sot(),SetCollisionByExclusion:rot(),SetCollisionByProperty:aot(),SetCollisionFromCollisionGroup:oot(),SetLayerCollisionIndex:iot(),SetTileCollision:uat(),SetTileIndexCallback:vst?mst:(vst=1,mst=function(t,e,i,n){if("number"==typeof t)n.callbacks[t]=null!==e?{callback:e,callbackContext:i}:void 0;else for(var s=0,r=t.length;s<r;s++)n.callbacks[t[s]]=null!==e?{callback:e,callbackContext:i}:void 0}),SetTileLocationCallback:hot(),Shuffle:lot(),StaggeredCullBounds:yat(),StaggeredCullTiles:xat(),StaggeredTileToWorldXY:Rat(),StaggeredTileToWorldY:kat(),StaggeredWorldToTileXY:Xat(),StaggeredWorldToTileY:Hat(),SwapByIndex:uot(),TileToWorldX:Aat(),TileToWorldXY:Oat(),TileToWorldY:Lat(),WeightedRandomize:cot(),WorldToTileX:Nat(),WorldToTileXY:Bat(),WorldToTileY:Wat()})}function fot(){if(Pst)return Mst;Pst=1;var t=$rt();return Mst=function(e){return"isometric"===(e=e.toLowerCase())?t.ISOMETRIC:"staggered"===e?t.STAGGERED:"hexagonal"===e?t.HEXAGONAL:t.ORTHOGONAL}}function pot(){if(Lst)return Rst;Lst=1;var t=Ih(),e=$rt(),i=kh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","layer"),this.id=i(t,"id",0),this.x=i(t,"x",0),this.y=i(t,"y",0),this.width=i(t,"width",0),this.height=i(t,"height",0),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.baseTileWidth=i(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=i(t,"baseTileHeight",this.tileHeight),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.widthInPixels=i(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=i(t,"alpha",1),this.visible=i(t,"visible",!0),this.properties=i(t,"properties",[]),this.indexes=i(t,"indexes",[]),this.collideIndexes=i(t,"collideIndexes",[]),this.callbacks=i(t,"callbacks",[]),this.bodies=i(t,"bodies",[]),this.data=i(t,"data",[]),this.tilemapLayer=i(t,"tilemapLayer",null),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return Rst=n}function got(){if(Fst)return Ost;Fst=1;var t=Ih(),e=$rt(),i=kh(),n=new t({initialize:function(t){void 0===t&&(t={}),this.name=i(t,"name","map"),this.width=i(t,"width",0),this.height=i(t,"height",0),this.infinite=i(t,"infinite",!1),this.tileWidth=i(t,"tileWidth",0),this.tileHeight=i(t,"tileHeight",0),this.widthInPixels=i(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=i(t,"heightInPixels",this.height*this.tileHeight),this.format=i(t,"format",null),this.orientation=i(t,"orientation",e.ORTHOGONAL),this.renderOrder=i(t,"renderOrder","right-down"),this.version=i(t,"version","1"),this.properties=i(t,"properties",{}),this.layers=i(t,"layers",[]),this.images=i(t,"images",[]),this.objects=i(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[]),this.collision=i(t,"collision",{}),this.tilesets=i(t,"tilesets",[]),this.imageCollections=i(t,"imageCollections",[]),this.tiles=i(t,"tiles",[]),this.hexSideLength=i(t,"hexSideLength",0),this.staggerAxis=i(t,"staggerAxis","y"),this.staggerIndex=i(t,"staggerIndex","odd")}});return Ost=n}function mot(){if(Dst)return kst;Dst=1;var t=Mtt(),e=pot(),i=got(),n=nat();return kst=function(s,r,a,o,h){for(var l=new e({tileWidth:a,tileHeight:o}),u=new i({name:s,tileWidth:a,tileHeight:o,format:t.ARRAY_2D,layers:[l]}),c=[],d=r.length,f=0,p=0;p<r.length;p++){c[p]=[];for(var g=r[p],m=0;m<g.length;m++){var v=parseInt(g[m],10);isNaN(v)||-1===v?c[p][m]=h?null:new n(l,-1,m,p,a,o):c[p][m]=new n(l,v,m,p,a,o)}0===f&&(f=g.length)}return u.width=l.width=f,u.height=l.height=d,u.widthInPixels=l.widthInPixels=f*a,u.heightInPixels=l.heightInPixels=d*o,l.data=c,u},kst}function vot(){if(Bst)return Ist;Bst=1;var t=Mtt(),e=mot();return Ist=function(i,n,s,r,a){var o=n.trim().split("\n").map(function(t){return t.split(",")}),h=e(i,o,s,r,a);return h.format=t.CSV,h},Ist}function yot(){if(zst)return Nst;zst=1;var t=jo();return Nst=function(e){for(var i,n,s,r,a,o=0;o<e.layers.length;o++){i=e.layers[o],r=null;for(var h=0;h<i.data.length;h++){a=i.data[h];for(var l=0;l<a.length;l++)null===(n=a[l])||n.index<0||(s=e.tiles[n.index][2],r=e.tilesets[s],n.width=r.tileWidth,n.height=r.tileHeight,r.tileProperties&&r.tileProperties[n.index-r.firstgid]&&(n.properties=t(n.properties,r.tileProperties[n.index-r.firstgid])))}}}}function xot(){if(Yst)return Ust;Yst=1;var t=Ih(),e=wu(),i=new t({initialize:function(t,i,n,s,r,a,o,h,l){(void 0===n||n<=0)&&(n=32),(void 0===s||s<=0)&&(s=32),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o={}),void 0===h&&(h={}),this.name=t,this.firstgid=i,this.tileWidth=n,this.tileHeight=s,this.tileMargin=r,this.tileSpacing=a,this.tileProperties=o,this.tileData=h,this.tileOffset=new e,void 0!==l&&this.tileOffset.set(l.x,l.y),this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){this.image=t;var e=t.get(),i=t.getFrameBounds();return this.glTexture=e.source.glTexture,e.width>i.width||e.height>i.height?this.updateTileData(e.width,e.height):this.updateTileData(i.width,i.height,i.x,i.y),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var s=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),r=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);s%1==0&&r%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),s=Math.floor(s),r=Math.floor(r),this.rows=s,this.columns=r,this.total=s*r,this.texCoordinates.length=0;for(var a=this.tileMargin+i,o=this.tileMargin+n,h=0;h<this.rows;h++){for(var l=0;l<this.columns;l++)this.texCoordinates.push({x:a,y:o}),a+=this.tileWidth+this.tileSpacing;a=this.tileMargin+i,o+=this.tileHeight+this.tileSpacing}return this}});return Ust=i}function wot(){if(Gst)return Xst;Gst=1;var t=xot();return Xst=function(e){var i,n,s=[];for(i=0;i<e.imageCollections.length;i++)for(var r=e.imageCollections[i].images,a=0;a<r.length;a++){var o=r[a],h={x:0,y:o.height-e.tileHeight};(n=new t(o.image,o.gid,o.width,o.height,0,0,void 0,void 0,h)).updateTileData(o.width,o.height),e.tilesets.push(n)}for(i=0;i<e.tilesets.length;i++)for(var l=(n=e.tilesets[i]).tileMargin,u=n.tileMargin,c=0,d=0,f=0,p=n.firstgid;p<n.firstgid+n.total&&(s[p]=[l,u,i],l+=n.tileWidth+n.tileSpacing,++c!==n.total)&&(++d!==n.columns||(l=n.tileMargin,u+=n.tileHeight+n.tileSpacing,d=0,++f!==n.rows));p++);return s}}function bot(){if(Wst)return Hst;Wst=1;var t=kh();return Hst=function(e,i,n){if(!i)return{i:0,layers:e.layers,name:"",opacity:1,visible:!0,x:0,y:0};var s=i.x+t(i,"startx",0)*e.tilewidth+t(i,"offsetx",0),r=i.y+t(i,"starty",0)*e.tileheight+t(i,"offsety",0);return{i:0,layers:i.layers,name:n.name+i.name+"/",opacity:n.opacity*i.opacity,visible:n.visible&&i.visible,x:n.x+s,y:n.y+r}}}function Tot(){if(jst)return Vst;jst=1;var t=kh(),e=bot();return Vst=function(i){for(var n=[],s=[],r=e(i);r.i<r.layers.length||s.length>0;)if(r.i>=r.layers.length){if(s.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}r=s.pop()}else{var a=r.layers[r.i];if(r.i++,"imagelayer"===a.type){var o=t(a,"offsetx",0)+t(a,"startx",0),h=t(a,"offsety",0)+t(a,"starty",0);n.push({name:r.name+a.name,image:a.image,x:r.x+o+a.x,y:r.y+h+a.y,alpha:r.opacity*a.opacity,visible:r.visible&&a.visible,properties:t(a,"properties",{})})}else if("group"===a.type){var l=e(i,a,r);s.push(r),r=l}}return n}}function Eot(){if(Kst)return qst;Kst=1;var t=QW();return qst=function(e,i){for(var n={},s=0;s<i.length;s++){var r=i[s];t(e,r)&&(n[r]=e[r])}return n},qst}function Sot(){if($st)return Zst;$st=1;return Zst=function(t){var e=Boolean(2147483648&t),i=Boolean(1073741824&t),n=Boolean(536870912&t);t&=536870911;var s=0,r=!1;return e&&i&&n?(s=Math.PI/2,r=!0):e&&i&&!n?(s=Math.PI,r=!1):e&&!i&&n?(s=Math.PI/2,r=!1):!e||i||n?!e&&i&&n?(s=3*Math.PI/2,r=!1):e||!i||n?e||i||!n?e||i||n||(s=0,r=!1):(s=3*Math.PI/2,r=!0):(s=Math.PI,r=!0):(s=0,r=!0),{gid:t,flippedHorizontal:e,flippedVertical:i,flippedAntiDiagonal:n,rotation:s,flipped:r}}}function _ot(){if(Qst)return Jst;Qst=1;var t=Eot(),e=Sot(),i=function(t){return{x:t.x,y:t.y}},n=["id","name","type","rotation","properties","visible","x","y","width","height"];return Jst=function(s,r,a){void 0===r&&(r=0),void 0===a&&(a=0);var o=t(s,n);if(o.x+=r,o.y+=a,s.gid){var h=e(s.gid);o.gid=h.gid,o.flippedHorizontal=h.flippedHorizontal,o.flippedVertical=h.flippedVertical,o.flippedAntiDiagonal=h.flippedAntiDiagonal}else s.polyline?o.polyline=s.polyline.map(i):s.polygon?o.polygon=s.polygon.map(i):s.ellipse?o.ellipse=s.ellipse:s.text?o.text=s.text:s.point?o.point=!0:o.rectangle=!0;return o}}function Cot(){if(ert)return trt;ert=1;var t=Ih(),e=kh(),i=new t({initialize:function(t){void 0===t&&(t={}),this.name=e(t,"name","object layer"),this.id=e(t,"id",0),this.opacity=e(t,"opacity",1),this.properties=e(t,"properties",{}),this.propertyTypes=e(t,"propertytypes",{}),this.type=e(t,"type","objectgroup"),this.visible=e(t,"visible",!0),this.objects=e(t,"objects",[]),Array.isArray(this.objects)||(this.objects=[])}});return trt=i}function Aot(){if(nrt)return irt;nrt=1;var t=kh(),e=_ot(),i=Cot(),n=bot();return irt=function(s){for(var r=[],a=[],o=n(s);o.i<o.layers.length||a.length>0;)if(o.i>=o.layers.length){if(a.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}o=a.pop()}else{var h=o.layers[o.i];if(o.i++,h.opacity*=o.opacity,h.visible=o.visible&&h.visible,"objectgroup"===h.type){h.name=o.name+h.name;for(var l=o.x+t(h,"startx",0)+t(h,"offsetx",0),u=o.y+t(h,"starty",0)+t(h,"offsety",0),c=[],d=0;d<h.objects.length;d++){var f=e(h.objects[d],l,u);c.push(f)}var p=new i(h);p.objects=c,r.push(p)}else if("group"===h.type){var g=n(s,h,o);a.push(o),o=g}}return r}}function Mot(){return rrt||(rrt=1,srt=function(t){for(var e=window.atob(t),i=e.length,n=new Array(i/4),s=0;s<i;s+=4)n[s/4]=(e.charCodeAt(s)|e.charCodeAt(s+1)<<8|e.charCodeAt(s+2)<<16|e.charCodeAt(s+3)<<24)>>>0;return n}),srt}function Pot(){if(ort)return art;ort=1;var t=Mot(),e=$rt(),i=bot(),n=fot(),s=kh(),r=pot(),a=Sot(),o=nat();return art=function(h,l){for(var u=s(h,"infinite",!1),c=[],d=[],f=i(h);f.i<f.layers.length||d.length>0;)if(f.i>=f.layers.length){if(d.length<1){console.warn("TilemapParser.parseTiledJSON - Invalid layer group hierarchy");break}f=d.pop()}else{var p=f.layers[f.i];if(f.i++,"tilelayer"===p.type)if(p.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+p.name+"'");else{if(p.encoding&&"base64"===p.encoding){if(p.chunks)for(var g=0;g<p.chunks.length;g++)p.chunks[g].data=t(p.chunks[g].data);p.data&&(p.data=t(p.data)),delete p.encoding}var m,v,y,x,w,b,T=[],E=0;if(u){var S=s(p,"startx",0)+p.x,_=s(p,"starty",0)+p.y;(m=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+S*h.tilewidth,y:f.y+s(p,"offsety",0)+_*h.tileheight,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(m.hexSideLength=h.hexsidelength,m.staggerAxis=h.staggeraxis,m.staggerIndex=h.staggerindex,"y"===m.staggerAxis?(w=(m.tileHeight-m.hexSideLength)/2,m.widthInPixels=m.tileWidth*(m.width+.5),m.heightInPixels=m.height*(m.hexSideLength+w)+w):(b=(m.tileWidth-m.hexSideLength)/2,m.widthInPixels=m.width*(m.hexSideLength+b)+b,m.heightInPixels=m.tileHeight*(m.height+.5)));for(var C=0;C<p.height;C++){T[C]=[null];for(var A=0;A<p.width;A++)T[C][A]=null}for(C=0,N=p.chunks.length;C<N;C++)for(var M=p.chunks[C],P=M.x-S,R=M.y-_,L=0,O=0,F=M.data.length;O<F;O++){var k=E+P,D=L+R;(v=a(M.data[O])).gid>0?((y=new o(m,v.gid,k,D,h.tilewidth,h.tileheight)).rotation=v.rotation,y.flipX=v.flipped,T[D][k]=y):(x=l?null:new o(m,-1,k,D,h.tilewidth,h.tileheight),T[D][k]=x),++E===M.width&&(L++,E=0)}}else{(m=new r({name:f.name+p.name,id:p.id,x:f.x+s(p,"offsetx",0)+p.x,y:f.y+s(p,"offsety",0)+p.y,width:p.width,height:p.height,tileWidth:h.tilewidth,tileHeight:h.tileheight,alpha:f.opacity*p.opacity,visible:f.visible&&p.visible,properties:s(p,"properties",[]),orientation:n(h.orientation)})).orientation===e.HEXAGONAL&&(m.hexSideLength=h.hexsidelength,m.staggerAxis=h.staggeraxis,m.staggerIndex=h.staggerindex,"y"===m.staggerAxis?(w=(m.tileHeight-m.hexSideLength)/2,m.widthInPixels=m.tileWidth*(m.width+.5),m.heightInPixels=m.height*(m.hexSideLength+w)+w):(b=(m.tileWidth-m.hexSideLength)/2,m.widthInPixels=m.width*(m.hexSideLength+b)+b,m.heightInPixels=m.tileHeight*(m.height+.5)));for(var I=[],B=0,N=p.data.length;B<N;B++)(v=a(p.data[B])).gid>0?((y=new o(m,v.gid,E,T.length,h.tilewidth,h.tileheight)).rotation=v.rotation,y.flipX=v.flipped,I.push(y)):(x=l?null:new o(m,-1,E,T.length,h.tilewidth,h.tileheight),I.push(x)),++E===p.width&&(T.push(I),E=0,I=[])}m.data=T,c.push(m)}else if("group"===p.type){var z=i(h,p,f);d.push(f),f=z}}return c}}function Rot(){if(lrt)return hrt;lrt=1;var t=new(Ih())({initialize:function(t,e,i,n,s,r,a){(void 0===i||i<=0)&&(i=32),(void 0===n||n<=0)&&(n=32),void 0===s&&(s=0),void 0===r&&(r=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|i,this.imageHeight=0|n,this.imageMargin=0|s,this.imageSpacing=0|r,this.properties=a||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e,i,n){return this.images.push({gid:t,image:e,width:i,height:n}),this.total++,this}});return hrt=t}function Lot(){if(frt)return drt;frt=1;var t=xot(),e=Rot(),i=_ot(),n=(crt||(crt=1,urt=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],s=i;if(n.name&&""!==n.name&&(s=n.name),Array.isArray(n.wangtiles)&&n.wangtiles.length>0){var r,a,o,h={},l={};if(Array.isArray(n.edgecolors))for(r=0;r<n.edgecolors.length;r++)o=1+r,""!==(a=n.edgecolors[r]).name&&(h[o]=a.name);if(Array.isArray(n.cornercolors))for(r=0;r<n.cornercolors.length;r++)o=1+r,""!==(a=n.cornercolors[r]).name&&(l[o]=a.name);if(Array.isArray(n.colors))for(r=0;r<n.colors.length;r++)o=1+r,""!==(a=n.colors[r]).name&&(h[o]=l[o]=a.name);for(var u=[h,l,h,l,h,l,h,l],c=0;c<n.wangtiles.length;c++){var d=n.wangtiles[c],f=e[d.tileid]||(e[d.tileid]={});f=f.wangid||(f.wangid={});for(var p=[],g=0;g<Math.min(u.length,d.wangid.length);g++)if(0!==(a=d.wangid[g])){var m=u[g][a];void 0===m?p.push(a):p.push(m)}else p.push(void 0);f[s]=p}}}}),urt);return drt=function(s){for(var r,a=[],o=[],h=null,l=0;l<s.tilesets.length;l++){var u=s.tilesets[l];if(u.source)console.warn("External tilesets unsupported. Use Embed Tileset and re-export");else if(u.image){var c=new t(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,void 0,void 0,u.tileoffset);if(s.version>1){var d=void 0,f=void 0;if(Array.isArray(u.tiles)){d=d||{},f=f||{};for(var p=0;p<u.tiles.length;p++){var g=u.tiles[p];if(g.properties){var m={};g.properties.forEach(function(t){m[t.name]=t.value}),f[g.id]=m}if(g.objectgroup&&((d[g.id]||(d[g.id]={})).objectgroup=g.objectgroup,g.objectgroup.objects)){var v=g.objectgroup.objects.map(function(t){return i(t)});d[g.id].objectgroup.objects=v}g.animation&&((d[g.id]||(d[g.id]={})).animation=g.animation),g.type&&((d[g.id]||(d[g.id]={})).type=g.type)}}Array.isArray(u.wangsets)&&(d=d||{},f=f||{},n(u.wangsets,d)),d&&(c.tileData=d,c.tileProperties=f)}else if(u.tileproperties&&(c.tileProperties=u.tileproperties),u.tiles)for(r in c.tileData=u.tiles,c.tileData){var y=c.tileData[r].objectgroup;if(y&&y.objects){var x=y.objects.map(function(t){return i(t)});c.tileData[r].objectgroup.objects=x}}c.updateTileData(u.imagewidth,u.imageheight),a.push(c)}else{var w=new e(u.name,u.firstgid,u.tilewidth,u.tileheight,u.margin,u.spacing,u.properties),b=0;for(p=0;p<u.tiles.length;p++){var T=(g=u.tiles[p]).image,E=parseInt(g.id,10),S=u.firstgid+E,_=g.imagewidth,C=g.imageheight;w.addImage(S,T,_,C),b=Math.max(E,b)}w.maxId=b,o.push(w)}h&&(h.lastgid=u.firstgid-1),h=u}return{tilesets:a,imageCollections:o}}}function Oot(){if(grt)return prt;grt=1;var t=yot(),e=wot(),i=$rt(),n=Iu(),s=Mtt(),r=fot(),a=got(),o=Tot(),h=Aot(),l=Pot(),u=Lot();return prt=function(c,d,f){var p=n(d),g=new a({width:p.width,height:p.height,name:c,tileWidth:p.tilewidth,tileHeight:p.tileheight,orientation:r(p.orientation),format:s.TILED_JSON,version:p.version,properties:p.properties,renderOrder:p.renderorder,infinite:p.infinite});if(g.orientation===i.HEXAGONAL)if(g.hexSideLength=p.hexsidelength,g.staggerAxis=p.staggeraxis,g.staggerIndex=p.staggerindex,"y"===g.staggerAxis){var m=(g.tileHeight-g.hexSideLength)/2;g.widthInPixels=g.tileWidth*(g.width+.5),g.heightInPixels=g.height*(g.hexSideLength+m)+m}else{var v=(g.tileWidth-g.hexSideLength)/2;g.widthInPixels=g.width*(g.hexSideLength+v)+v,g.heightInPixels=g.tileHeight*(g.height+.5)}g.layers=l(p,f),g.images=o(p);var y=u(p);return g.tilesets=y.tilesets,g.imageCollections=y.imageCollections,g.objects=h(p),g.tiles=e(g),t(g),g}}function Fot(){if(vrt)return mrt;vrt=1;var t=pot(),e=nat();return mrt=function(i,n){for(var s=[],r=0;r<i.layer.length;r++){for(var a=i.layer[r],o=new t({name:a.name,width:a.width,height:a.height,tileWidth:a.tilesize,tileHeight:a.tilesize,visible:1===a.visible}),h=[],l=[],u=0;u<a.data.length;u++){for(var c=0;c<a.data[u].length;c++){var d,f=a.data[u][c]-1;d=f>-1?new e(o,f,c,u,a.tilesize,a.tilesize):n?null:new e(o,-1,c,u,a.tilesize,a.tilesize),h.push(d)}l.push(h),h=[]}o.data=l,s.push(o)}return s}}function kot(){if(xrt)return yrt;xrt=1;var t=xot();return yrt=function(e){for(var i=[],n=[],s=0;s<e.layer.length;s++){var r=e.layer[s],a=r.tilesetName;""!==a&&-1===n.indexOf(a)&&(n.push(a),i.push(new t(a,0,r.tilesize,r.tilesize,0,0)))}return i}}function Dot(){if(brt)return wrt;brt=1;var t=Mtt(),e=got(),i=Fot(),n=kot();return wrt=function(s,r,a){if(0===r.layer.length)return console.warn("No layers found in the Weltmeister map: "+s),null;for(var o=0,h=0,l=0;l<r.layer.length;l++)r.layer[l].width>o&&(o=r.layer[l].width),r.layer[l].height>h&&(h=r.layer[l].height);var u=new e({width:o,height:h,name:s,tileWidth:r.layer[0].tilesize,tileHeight:r.layer[0].tilesize,format:t.WELTMEISTER});return u.layers=i(r,a),u.tilesets=n(r),u}}function Iot(){if(Ert)return Trt;Ert=1;var t=Mtt(),e=mot(),i=vot(),n=Oot(),s=Dot();return Trt=function(r,a,o,h,l,u){var c;switch(a){case t.ARRAY_2D:c=e(r,o,h,l,u);break;case t.CSV:c=i(r,o,h,l,u);break;case t.TILED_JSON:c=n(r,o,u);break;case t.WELTMEISTER:c=s(r,o,u);break;default:console.warn("Unrecognized tilemap data format: "+a),c=null}return c},Trt}function Bot(){if(Brt)return Irt;Brt=1;var t,e,i=Dh();return t=function(){if(Frt)return Ort;Frt=1;var t=NX();return Ort=function(e,i,n){var s=i.cull(n),r=s.length,a=n.alpha*i.alpha;if(!(0===r||a<=0)){var o=i.gidMap,h=e.pipelines.set(i.pipeline,i),l=t.getTintAppendFloatAlpha,u=i.scrollFactorX,c=i.scrollFactorY,d=i.x,f=i.y,p=i.scaleX,g=i.scaleY;e.pipelines.preBatch(i);for(var m=0;m<r;m++){var v=s[m],y=o[v.index];if(y){var x=y.getTileTextureCoordinates(v.index),w=y.tileWidth,b=y.tileHeight;if(x&&0!==w&&0!==b){var T=.5*w,E=.5*b,S=y.glTexture,_=h.setTexture2D(S,i),C=w,A=b,M=x.x,P=x.y,R=y.tileOffset.x,L=y.tileOffset.y,O=l(v.tint,a*v.alpha);h.batchTexture(i,S,S.width,S.height,d+v.pixelX*p+(T*p-R),f+v.pixelY*g+(E*g-L),w,b,p,g,v.rotation,v.flipX,v.flipY,u,c,T,E,M,P,C,A,O,O,O,O,v.tintFill,0,0,n,null,!0,_,!0)}}}e.pipelines.postBatch(i)}},Ort}(),e=function(){if(Drt)return krt;Drt=1;var t=Hu(),e=new t,i=new t,n=new t;return krt=function(t,s,r,a){var o=s.cull(r),h=o.length,l=r.alpha*s.alpha;if(!(0===h||l<=0)){var u=e,c=i,d=n;c.applyITRS(s.x,s.y,s.rotation,s.scaleX,s.scaleY),u.copyFrom(r.matrix);var f=t.currentContext,p=s.gidMap;f.save(),a?(u.multiplyWithOffset(a,-r.scrollX*s.scrollFactorX,-r.scrollY*s.scrollFactorY),c.e=s.x,c.f=s.y,u.multiply(c,d),d.copyToContext(f)):(c.e-=r.scrollX*s.scrollFactorX,c.f-=r.scrollY*s.scrollFactorY,c.copyToContext(f)),(!t.antialias||s.scaleX>1||s.scaleY>1)&&(f.imageSmoothingEnabled=!1);for(var g=0;g<h;g++){var m=o[g],v=p[m.index];if(v){var y=v.image.getSourceImage(),x=v.getTileTextureCoordinates(m.index),w=v.tileWidth,b=v.tileHeight;if(null!==x&&0!==w&&0!==b){var T=.5*w,E=.5*b;x.x+=v.tileOffset.x,x.y+=v.tileOffset.y,f.save(),f.translate(m.pixelX+T,m.pixelY+E),0!==m.rotation&&f.rotate(m.rotation),(m.flipX||m.flipY)&&f.scale(m.flipX?-1:1,m.flipY?-1:1),f.globalAlpha=l*m.alpha,f.drawImage(y,x.x,x.y,w,b,-T,-E,w,b),f.restore()}}}f.restore()}},krt}(),Irt={renderWebGL:t,renderCanvas:e}}function Not(){if(zrt)return Nrt;zrt=1;var t=Ih(),e=Btt(),i=Zu(),n=Nz(),s=dot(),r=Bot(),a=wu(),o=new t({Extends:n,Mixins:[i.Alpha,i.BlendMode,i.ComputedSize,i.Depth,i.Flip,i.GetBounds,i.Mask,i.Origin,i.Pipeline,i.PostPipeline,i.Transform,i.Visible,i.ScrollFactor,e,r],initialize:function(t,e,i,r,o,h){n.call(this,t,"TilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=i,this.layer=e.layers[i],this.layer.tilemapLayer=this,this.tileset=[],this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.culledTiles=[],this.skipCull=!1,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=s.GetCullTilesFunction(this.layer.orientation),this._renderOrder=0,this.gidMap=[],this.tempVec=new a,this.collisionCategory=1,this.collisionMask=1,this.setTilesets(r),this.setAlpha(this.layer.alpha),this.setPosition(o,h),this.setOrigin(0,0),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline(),this.initPostPipeline(!1)},setTilesets:function(t){var e=[],i=[],n=this.tilemap;Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];if("string"==typeof r&&(r=n.getTileset(r)),r){i.push(r);for(var a=r.firstgid,o=0;o<r.total;o++)e[a+o]=r}}this.gidMap=e,this.tileset=i},setRenderOrder:function(t){return"string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return s.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,i,n){return s.CalculateFacesWithin(t,e,i,n,this.layer),this},createFromTiles:function(t,e,i,n,r){return s.CreateFromTiles(t,e,i,n,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,i,n,r,a,o){return s.Copy(t,e,i,n,r,a,o,this.layer),this},fill:function(t,e,i,n,r,a){return s.Fill(t,e,i,n,r,a,this.layer),this},filterTiles:function(t,e,i,n,r,a,o){return s.FilterTiles(t,e,i,n,r,a,o,this.layer)},findByIndex:function(t,e,i){return s.FindByIndex(t,e,i,this.layer)},findTile:function(t,e,i,n,r,a,o){return s.FindTile(t,e,i,n,r,a,o,this.layer)},forEachTile:function(t,e,i,n,r,a,o){return s.ForEachTile(t,e,i,n,r,a,o,this.layer),this},setTint:function(t,e,i,n,s,r){return void 0===t&&(t=16777215),this.forEachTile(function(e){e.tint=t,e.tintFill=!1},this,e,i,n,s,r)},setTintFill:function(t,e,i,n,s,r){return void 0===t&&(t=16777215),this.forEachTile(function(e){e.tint=t,e.tintFill=!0},this,e,i,n,s,r)},getTileAt:function(t,e,i){return s.GetTileAt(t,e,i,this.layer)},getTileAtWorldXY:function(t,e,i,n){return s.GetTileAtWorldXY(t,e,i,n,this.layer)},getIsoTileAtWorldXY:function(t,e,i,n,r){void 0===i&&(i=!0);var a=this.tempVec;return s.IsometricWorldToTileXY(t,e,!0,a,r,this.layer,i),this.getTileAt(a.x,a.y,n)},getTilesWithin:function(t,e,i,n,r){return s.GetTilesWithin(t,e,i,n,r,this.layer)},getTilesWithinShape:function(t,e,i){return s.GetTilesWithinShape(t,e,i,this.layer)},getTilesWithinWorldXY:function(t,e,i,n,r,a){return s.GetTilesWithinWorldXY(t,e,i,n,r,a,this.layer)},hasTileAt:function(t,e){return s.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,i){return s.HasTileAtWorldXY(t,e,i,this.layer)},putTileAt:function(t,e,i,n){return s.PutTileAt(t,e,i,n,this.layer)},putTileAtWorldXY:function(t,e,i,n,r){return s.PutTileAtWorldXY(t,e,i,n,r,this.layer)},putTilesAt:function(t,e,i,n){return s.PutTilesAt(t,e,i,n,this.layer),this},randomize:function(t,e,i,n,r){return s.Randomize(t,e,i,n,r,this.layer),this},removeTileAt:function(t,e,i,n){return s.RemoveTileAt(t,e,i,n,this.layer)},removeTileAtWorldXY:function(t,e,i,n,r){return s.RemoveTileAtWorldXY(t,e,i,n,r,this.layer)},renderDebug:function(t,e){return s.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,i,n,r,a){return s.ReplaceByIndex(t,e,i,n,r,a,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,i,n){return s.SetCollision(t,e,i,this.layer,n),this},setCollisionBetween:function(t,e,i,n){return s.SetCollisionBetween(t,e,i,n,this.layer),this},setCollisionByProperty:function(t,e,i){return s.SetCollisionByProperty(t,e,i,this.layer),this},setCollisionByExclusion:function(t,e,i){return s.SetCollisionByExclusion(t,e,i,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return s.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,i){return s.SetTileIndexCallback(t,e,i,this.layer),this},setTileLocationCallback:function(t,e,i,n,r,a){return s.SetTileLocationCallback(t,e,i,n,r,a,this.layer),this},shuffle:function(t,e,i,n){return s.Shuffle(t,e,i,n,this.layer),this},swapByIndex:function(t,e,i,n,r,a){return s.SwapByIndex(t,e,i,n,r,a,this.layer),this},tileToWorldX:function(t,e){return this.tilemap.tileToWorldX(t,e,this)},tileToWorldY:function(t,e){return this.tilemap.tileToWorldY(t,e,this)},tileToWorldXY:function(t,e,i,n){return this.tilemap.tileToWorldXY(t,e,i,n,this)},getTileCorners:function(t,e,i){return this.tilemap.getTileCorners(t,e,i,this)},weightedRandomize:function(t,e,i,n,r){return s.WeightedRandomize(e,i,n,r,t,this.layer),this},worldToTileX:function(t,e,i){return this.tilemap.worldToTileX(t,e,i,this)},worldToTileY:function(t,e,i){return this.tilemap.worldToTileY(t,e,i,this)},worldToTileXY:function(t,e,i,n,s){return this.tilemap.worldToTileXY(t,e,i,n,s,this)},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],n.prototype.destroy.call(this))}});return Nrt=o}function zot(){if(Yrt)return Urt;Yrt=1;var t=wot(),e=Ih(),i=Ou(),n=Mtt(),s=kh(),r=pot(),a=function(){if(Lrt)return Rrt;Lrt=1;var t=new(Ih())({initialize:function(t){if(this.gids=[],void 0!==t)for(var e=0;e<t.length;++e)for(var i=t[e],n=0;n<i.total;++n)this.gids[i.firstgid+n]=i;this._gids=this.gids},enabled:{get:function(){return!!this.gids},set:function(t){this.gids=t?this._gids:void 0}},getTypeIncludingTile:function(t){if(void 0!==t.type&&""!==t.type)return t.type;if(this.gids&&void 0!==t.gid){var e=this.gids[t.gid];if(e){var i=e.getTileData(t.gid);if(i)return i.type}}},setTextureAndFrame:function(t,e,i,n){if(null===e&&this.gids&&void 0!==n.gid){var s=this.gids[n.gid];s&&(null===e&&void 0!==s.image&&(e=s.image.key),null===i&&(i=n.gid-s.firstgid),t.scene.textures.getFrame(e,i)||(e=null,i=null))}t.setTexture(e,i)},setPropertiesFromTiledObject:function(t,e){if(void 0!==this.gids&&void 0!==e.gid){var i=this.gids[e.gid];void 0!==i&&this.setFromJSON(t,i.getTileProperties(e.gid))}this.setFromJSON(t,e.properties)},setFromJSON:function(t,e){if(e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];void 0!==t[n.name]?t[n.name]=n.value:t.setData(n.name,n.value)}else for(var s in e)void 0!==t[s]?t[s]=e[s]:t.setData(s,e[s])}});return Rrt=t}(),o=$rt(),h=yX(),l=_l(),u=iV(),c=nat(),d=dot(),f=Not(),p=xot(),g=new e({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tiles=e.tiles,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0,this.hexSideLength=e.hexSideLength;var i=this.orientation;this._convert={WorldToTileXY:d.GetWorldToTileXYFunction(i),WorldToTileX:d.GetWorldToTileXFunction(i),WorldToTileY:d.GetWorldToTileYFunction(i),TileToWorldXY:d.GetTileToWorldXYFunction(i),TileToWorldX:d.GetTileToWorldXFunction(i),TileToWorldY:d.GetTileToWorldYFunction(i),GetTileCorners:d.GetTileCornersFunction(i)}},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"==typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(e,i,s,r,a,o,h,l){if(void 0===e)return null;null==i&&(i=e);var u=this.scene.sys.textures;if(!u.exists(i))return console.warn('Texture key "%s" not found',i),null;var c=u.get(i),d=this.getTilesetIndex(e);if(null===d&&this.format===n.TILED_JSON)return console.warn('Tilemap has no tileset "%s". Its tilesets are %o',e,this.tilesets),null;var f=this.tilesets[d];return f?((s||r)&&f.setTileSize(s,r),(a||o)&&f.setSpacing(a,o),f.setImage(c),f):(void 0===s&&(s=this.tileWidth),void 0===r&&(r=this.tileHeight),void 0===a&&(a=0),void 0===o&&(o=0),void 0===h&&(h=0),void 0===l&&(l={x:0,y:0}),(f=new p(e,h,s,r,a,o,void 0,void 0,l)).setImage(c),this.tilesets.push(f),this.tiles=t(this),f)},copy:function(t,e,i,n,s,r,a,o){return null!==(o=this.getLayer(o))?(d.Copy(t,e,i,n,s,r,a,o),this):null},createBlankLayer:function(t,e,i,n,s,a,o,h){if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=this.width),void 0===a&&(a=this.height),void 0===o&&(o=this.tileWidth),void 0===h&&(h=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var l,u=new r({name:t,tileWidth:o,tileHeight:h,width:s,height:a,orientation:this.orientation,hexSideLength:this.hexSideLength}),d=0;d<a;d++){l=[];for(var p=0;p<s;p++)l.push(new c(u,-1,p,d,o,h,this.tileWidth,this.tileHeight));u.data.push(l)}this.layers.push(u),this.currentLayerIndex=this.layers.length-1;var g=new f(this.scene,this,this.currentLayerIndex,e,i,n);return g.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(g),g},createLayer:function(t,e,i,n){var s=this.getLayerIndex(t);if(null===s)return console.warn("Invalid Tilemap Layer ID: "+t),"string"==typeof t&&console.warn("Valid tilelayer names: %o",this.getTileLayerNames()),null;var r=this.layers[s];if(r.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=s,void 0===i&&(i=r.x),void 0===n&&(n=r.y);var a=new f(this.scene,this,s,e,i,n);return a.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(a),a},createFromObjects:function(t,e,n){void 0===n&&(n=!0);var r=[],l=this.getObjectLayer(t);if(!l)return console.warn("createFromObjects: Invalid objectLayerName given: "+t),r;var c=new a(n?this.tilesets:void 0);Array.isArray(e)||(e=[e]);for(var d=l.objects,f=0;f<e.length;f++){var p,g=e[f],m=s(g,"id",null),v=s(g,"gid",null),y=s(g,"name",null),x=s(g,"type",null);c.enabled=!s(g,"ignoreTileset",null);for(var w=[],b=0;b<d.length;b++)p=d[b],(null===m&&null===v&&null===y&&null===x||null!==m&&p.id===m||null!==v&&p.gid===v||null!==y&&p.name===y||null!==x&&c.getTypeIncludingTile(p)===x)&&w.push(p);for(var T=s(g,"classType",u),E=s(g,"scene",this.scene),S=s(g,"container",null),_=s(g,"key",null),C=s(g,"frame",null),A=0;A<w.length;A++){p=w[A];var M=new T(E);if(M.setName(p.name),M.setPosition(p.x,p.y),c.setTextureAndFrame(M,_,C,p),p.width&&(M.displayWidth=p.width),p.height&&(M.displayHeight=p.height),this.orientation===o.ISOMETRIC){var P=this.tileWidth/this.tileHeight,R={x:M.x-M.y,y:(M.x+M.y)/P};M.x=R.x,M.y=R.y}var L={x:M.originX*p.width,y:(M.originY-(p.gid?1:0))*p.height};if(p.rotation){var O=i(p.rotation);h(L,O),M.rotation=O}M.x+=L.x,M.y+=L.y,void 0===p.flippedHorizontal&&void 0===p.flippedVertical||M.setFlip(p.flippedHorizontal,p.flippedVertical),p.visible||(M.visible=!1),c.setPropertiesFromTiledObject(M,p),S?S.add(M):E.add.existing(M),r.push(M)}}return r},createFromTiles:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.CreateFromTiles(t,e,i,n,s,r)},fill:function(t,e,i,n,s,r,a){return void 0===r&&(r=!0),null===(a=this.getLayer(a))?null:(d.Fill(t,e,i,n,s,r,a),this)},filterObjects:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.filter(e,i)},filterTiles:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FilterTiles(t,e,i,n,s,r,a,o)},findByIndex:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.FindByIndex(t,e,i,n)},findObject:function(t,e,i){if("string"==typeof t){var n=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+n),null}return t.objects.find(e,i)||null},findTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:d.FindTile(t,e,i,n,s,r,a,o)},forEachTile:function(t,e,i,n,s,r,a,o){return null===(o=this.getLayer(o))?null:(d.ForEachTile(t,e,i,n,s,r,a,o),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getImageLayerNames:function(){return this.images&&Array.isArray(this.images)?this.images.map(function(t){return t.name}):[]},getIndex:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return i;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getObjectLayerNames:function(){return this.objects&&Array.isArray(this.objects)?this.objects.map(function(t){return t.name}):[]},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"==typeof t?this.getLayerIndexByName(t):"number"==typeof t&&t<this.layers.length?t:t instanceof f&&t.tilemap===this?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTileAt(t,e,i,n)},getTileAtWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:d.GetTileAtWorldXY(t,e,i,n,s)},getTileLayerNames:function(){return this.layers&&Array.isArray(this.layers)?this.layers.map(function(t){return t.name}):[]},getTilesWithin:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:d.GetTilesWithin(t,e,i,n,s,r)},getTilesWithinShape:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.GetTilesWithinShape(t,e,i,n)},getTilesWithinWorldXY:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:d.GetTilesWithinWorldXY(t,e,i,n,s,r,a)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,i){return null===(i=this.getLayer(i))?null:d.HasTileAt(t,e,i)},hasTileAtWorldXY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:d.HasTileAtWorldXY(t,e,i,n)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.PutTileAt(t,e,i,n,s)},putTileAtWorldXY:function(t,e,i,n,s,r){return void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.PutTileAtWorldXY(t,e,i,n,s,r)},putTilesAt:function(t,e,i,n,s){return void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.PutTilesAt(t,e,i,n,s),this)},randomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.Randomize(t,e,i,n,s,r),this)},calculateFacesAt:function(t,e,i){return null===(i=this.getLayer(i))?null:(d.CalculateFacesAt(t,e,i),this)},calculateFacesWithin:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.CalculateFacesWithin(t,e,i,n,s),this)},removeLayer:function(t){var e=this.getLayerIndex(t);if(null!==e){l(this.layers,e);for(var i=e;i<this.layers.length;i++)this.layers[i].tilemapLayer&&this.layers[i].tilemapLayer.layerIndex--;return this.currentLayerIndex===e&&(this.currentLayerIndex=0),this}return null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).tilemapLayer.destroy(),l(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=!0);var n=[];Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++){var r=t[s];n.push(this.removeTileAt(r.x,r.y,!0,i,r.tilemapLayer)),e>-1&&this.putTileAt(e,r.x,r.y,i,r.tilemapLayer)}return n},removeTileAt:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:d.RemoveTileAt(t,e,i,n,s)},removeTileAtWorldXY:function(t,e,i,n,s,r){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(r=this.getLayer(r))?null:d.RemoveTileAtWorldXY(t,e,i,n,s,r)},renderDebug:function(t,e,i){return null===(i=this.getLayer(i))?null:(this.orientation===o.ORTHOGONAL&&d.RenderDebug(t,e,i),this)},renderDebugFull:function(t,e){for(var i=this.layers,n=0;n<i.length;n++)d.RenderDebug(t,e,i[n]);return this},replaceByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.ReplaceByIndex(t,e,i,n,s,r,a),this)},setCollision:function(t,e,i,n,s){return void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===s&&(s=!0),null===(n=this.getLayer(n))?null:(d.SetCollision(t,e,i,n,s),this)},setCollisionBetween:function(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),null===(s=this.getLayer(s))?null:(d.SetCollisionBetween(t,e,i,n,s),this)},setCollisionByProperty:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByProperty(t,e,i,n),this)},setCollisionByExclusion:function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),null===(n=this.getLayer(n))?null:(d.SetCollisionByExclusion(t,e,i,n),this)},setCollisionFromCollisionGroup:function(t,e,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),null===(i=this.getLayer(i))?null:(d.SetCollisionFromCollisionGroup(t,e,i),this)},setTileIndexCallback:function(t,e,i,n){return null===(n=this.getLayer(n))?null:(d.SetTileIndexCallback(t,e,i,n),this)},setTileLocationCallback:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SetTileLocationCallback(t,e,i,n,s,r,a),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var i=0;i<this.layers.length;i++){this.layers[i].baseTileWidth=t,this.layers[i].baseTileHeight=e;for(var n=this.layers[i].data,s=this.layers[i].width,r=this.layers[i].height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,i){if(null===(i=this.getLayer(i)))return this;i.tileWidth=t,i.tileHeight=e;for(var n=i.data,s=i.width,r=i.height,a=0;a<r;a++)for(var o=0;o<s;o++){var h=n[a][o];null!==h&&h.setSize(t,e)}return this},shuffle:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:(d.Shuffle(t,e,i,n,s),this)},swapByIndex:function(t,e,i,n,s,r,a){return null===(a=this.getLayer(a))?null:(d.SwapByIndex(t,e,i,n,s,r,a),this)},tileToWorldX:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldX(t,e,i)},tileToWorldY:function(t,e,i){return null===(i=this.getLayer(i))?null:this._convert.TileToWorldY(t,e,i)},tileToWorldXY:function(t,e,i,n,s){return null===(s=this.getLayer(s))?null:this._convert.TileToWorldXY(t,e,i,n,s)},getTileCorners:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.GetTileCorners(t,e,i,n)},weightedRandomize:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:(d.WeightedRandomize(e,i,n,s,t,r),this)},worldToTileX:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileX(t,e,i,n)},worldToTileY:function(t,e,i,n){return null===(n=this.getLayer(n))?null:this._convert.WorldToTileY(t,e,i,n)},worldToTileXY:function(t,e,i,n,s,r){return null===(r=this.getLayer(r))?null:this._convert.WorldToTileXY(t,e,i,n,s,r)},destroy:function(){this.removeAllLayers(),this.tiles.length=0,this.tilesets.length=0,this.objects.length=0,this.scene=null}});return Urt=g}function Uot(){if(Grt)return Xrt;Grt=1;var t=Mtt(),e=got(),i=Iot(),n=zot();return Xrt=function(s,r,a,o,h,l,u,c){void 0===a&&(a=32),void 0===o&&(o=32),void 0===h&&(h=10),void 0===l&&(l=10),void 0===c&&(c=!1);var d=null;if(Array.isArray(u))d=i(void 0!==r?r:"map",t.ARRAY_2D,u,a,o,c);else if(void 0!==r){var f=s.cache.tilemap.get(r);f?d=i(r,f.format,f.data,a,o,c):console.warn("No map data found for key "+r)}return null===d&&(d=new e({tileWidth:a,tileHeight:o,width:h,height:l})),new n(s,d)},Xrt}var Yot,Xot={};function Got(){if(Yot)return Xot;Yot=1;var t=GH(),e=Uot();return t.register("tilemap",function(t){var i=void 0!==t?t:{};return e(this.scene,i.key,i.tileWidth,i.tileHeight,i.width,i.height,i.data,i.insertNull)}),Xot}var Hot,Wot,Vot,jot,qot,Kot,Zot,$ot,Jot,Qot,tht,eht,iht,nht,sht,rht,aht,oht,hht,lht,uht,cht,dht,fht,pht,ght,mht,vht,yht,xht,wht,bht,Tht,Eht,Sht,_ht,Cht,Aht,Mht,Pht,Rht,Lht,Oht,Fht,kht,Dht,Iht,Bht,Nht,zht,Uht,Yht,Xht,Ght,Hht,Wht,Vht,jht,qht,Kht,Zht,$ht,Jht,Qht,tlt,elt,ilt,nlt,slt,rlt,alt,olt,hlt,llt,ult,clt,dlt,flt,plt,glt,mlt,vlt,ylt,xlt,wlt,blt,Tlt,Elt,Slt,_lt,Clt,Alt,Mlt,Plt,Rlt,Llt,Olt,Flt={};function klt(){if(Hot)return Flt;Hot=1;var t=Mu(),e=Uot();return t.register("tilemap",function(t,i,n,s,r,a,o){return null===t&&(t=void 0),null===i&&(i=void 0),null===n&&(n=void 0),null===s&&(s=void 0),null===r&&(r=void 0),e(this.scene,t,i,n,s,r,a,o)}),Flt}function Dlt(){if(Vot)return Wot;Vot=1;var t=jo(),e=function(){if(jet)return Vet;jet=1;var t={ORIENTATION:$rt()};return Vet=t}(),i={Components:dot(),Parsers:Prt?Mrt:(Prt=1,Mrt={FromOrientationString:fot(),Parse:Iot(),Parse2DArray:mot(),ParseCSV:vot(),Impact:_rt?Srt:(_rt=1,Srt={ParseTileLayers:Fot(),ParseTilesets:kot(),ParseWeltmeister:Dot()}),Tiled:Art?Crt:(Art=1,Crt={AssignTileProperties:yot(),Base64Decode:Mot(),BuildTilesetIndex:wot(),CreateGroupLayer:bot(),ParseGID:Sot(),ParseImageLayers:Tot(),ParseJSONTiled:Oot(),ParseObject:_ot(),ParseObjectLayers:Aot(),ParseTileLayers:Pot(),ParseTilesets:Lot()})}),Formats:Mtt(),ImageCollection:Rot(),ParseToTilemap:Uot(),Tile:nat(),Tilemap:zot(),TilemapCreator:Got(),TilemapFactory:klt(),Tileset:xot(),TilemapLayer:Not(),Orientation:$rt(),LayerData:pot(),MapData:got(),ObjectLayer:Cot()};return i=t(!1,i,e.ORIENTATION),Wot=i}function Ilt(){if(qot)return jot;qot=1;var t=Ih(),e=kh(),i=new t({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.callback,this.callbackScope,this.args,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){if(this.delay=e(t,"delay",0),this.repeat=e(t,"repeat",0),this.loop=e(t,"loop",!1),this.callback=e(t,"callback",void 0),this.callbackScope=e(t,"callbackScope",this),this.args=e(t,"args",[]),this.timeScale=e(t,"timeScale",1),this.startAt=e(t,"startAt",0),this.paused=e(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this.delay<=0&&this.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay");return this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){if(this.repeat>0){var t=this.delay+this.delay*this.repeat;return(this.elapsed+this.delay*(this.repeat-this.repeatCount))/t}return this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},getRemaining:function(){return this.delay-this.elapsed},getRemainingSeconds:function(){return.001*this.getRemaining()},getOverallRemaining:function(){return this.delay*(1+this.repeatCount)-this.elapsed},getOverallRemainingSeconds:function(){return.001*this.getOverallRemaining()},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});return jot=i}function Blt(){if(Zot)return Kot;Zot=1;var t=Ih(),e=Cu(),i=Au(),n=Ilt(),s=Cl(),r=new t({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.startTime=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(i.BOOT,this.boot,this),t.sys.events.on(i.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(i.DESTROY,this.destroy,this)},start:function(){this.startTime=this.systems.game.loop.time;var t=this.systems.events;t.on(i.PRE_UPDATE,this.preUpdate,this),t.on(i.UPDATE,this.update,this),t.once(i.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e;if(t instanceof n){if(e=t,this.removeEvent(e),e.elapsed=e.startAt,e.hasDispatched=!1,e.repeatCount=-1===e.repeat||e.loop?999999999999:e.repeat,e.delay<=0&&e.repeatCount>0)throw new Error("TimerEvent infinite loop created via zero delay")}else e=new n(t);return this._pendingInsertion.push(e),e},delayedCall:function(t,e,i,n){return this.addEvent({delay:t,callback:e,args:i,callbackScope:n})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeEvent:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];s(this._pendingRemoval,i),s(this._pendingInsertion,i),s(this._active,i)}return this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var i,n;for(i=0;i<t;i++){n=this._pendingRemoval[i];var s=this._active.indexOf(n);s>-1&&this._active.splice(s,1),n.destroy()}for(i=0;i<e;i++)n=this._pendingInsertion[i],this._active.push(n);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var i=0;i<this._active.length;i++){var n=this._active[i];if(!n.paused&&(n.elapsed+=e*n.timeScale,n.elapsed>=n.delay)){var s=n.elapsed-n.delay;if(n.elapsed=n.delay,!n.hasDispatched&&n.callback&&(n.hasDispatched=!0,n.callback.apply(n.callbackScope,n.args)),n.repeatCount>0){if(n.repeatCount--,s>=n.delay)for(;s>=n.delay&&n.repeatCount>0;)n.callback&&n.callback.apply(n.callbackScope,n.args),s-=n.delay,n.repeatCount--;n.elapsed=s,n.hasDispatched=!1}else n.hasDispatched&&this._pendingRemoval.push(n)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(i.PRE_UPDATE,this.preUpdate,this),e.off(i.UPDATE,this.update,this),e.off(i.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(i.START,this.start,this),this.scene=null,this.systems=null}});return e.register("Clock",r,"time"),Kot=r}function Nlt(){return tht?Qot:(tht=1,Qot={COMPLETE:Jot?$ot:(Jot=1,$ot="complete")})}function zlt(){if(iht)return eht;iht=1;var t=Ih(),e=Iz(),i=Mu(),n=kh(),s=Au(),r=Nlt(),a=new t({Extends:e,initialize:function(t,i){e.call(this),this.scene=t,this.systems=t.sys,this.elapsed=0,this.timeScale=1,this.paused=!0,this.complete=!1,this.totalComplete=0,this.loop=0,this.iteration=0,this.events=[];var n=this.systems.events;n.on(s.PRE_UPDATE,this.preUpdate,this),n.on(s.UPDATE,this.update,this),n.once(s.SHUTDOWN,this.destroy,this),i&&this.add(i)},preUpdate:function(t,e){this.paused||(this.elapsed+=e*this.timeScale)},update:function(){if(!this.paused&&!this.complete){var t,e,i=this.events,n=!1,s=this.systems;for(t=0;t<i.length;t++){var a=i[t];if(!a.complete&&a.time<=this.elapsed){if(a.complete=!0,this.totalComplete++,e=a.target?a.target:this,a.if&&!a.if.call(e,a))continue;if(a.once&&(n=!0),a.set&&a.target)for(var o in a.set)a.target[o]=a.set[o];this.iteration&&a.repeat++,a.loop&&a.repeat&&a.loop.call(e),a.tween&&(a.tweenInstance=s.tweens.add(a.tween)),a.sound&&("string"==typeof a.sound?s.sound.play(a.sound):s.sound.play(a.sound.key,a.sound.config)),a.event&&this.emit(a.event,e),a.run&&a.run.call(e),a.stop&&this.stop()}}if(n)for(t=0;t<i.length;t++)i[t].complete&&i[t].once&&(i.splice(t,1),t--);this.totalComplete>=i.length&&(0!==this.loop&&(-1===this.loop||this.loop>this.iteration)?(this.iteration++,this.reset(!0)):this.complete=!0),this.complete&&this.emit(r.COMPLETE,this)}},play:function(t){return void 0===t&&(t=!0),this.paused=!1,this.complete=!1,this.totalComplete=0,t&&this.reset(),this},pause:function(){this.paused=!0;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!0)}return this},repeat:function(t){return void 0!==t&&!0!==t||(t=-1),!1===t&&(t=0),this.loop=t,this},resume:function(){this.paused=!1;for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&(i.tweenInstance.paused=!1)}return this},stop:function(){return this.paused=!0,this.complete=!0,this},reset:function(t){void 0===t&&(t=!1),this.elapsed=0,t||(this.iteration=0);for(var e=this.events,i=0;i<e.length;i++){var n=e[i];n.complete=!1,t||(n.repeat=0),n.tweenInstance&&n.tweenInstance.stop()}return this.play(!1)},add:function(t){Array.isArray(t)||(t=[t]);var e=this.events,i=0;e.length>0&&(i=e[e.length-1].time);for(var s=0;s<t.length;s++){var r=t[s],a=n(r,"at",0),o=n(r,"in",null);null!==o&&(a=this.elapsed+o);var h=n(r,"from",null);null!==h&&(a=i+h),e.push({complete:!1,time:a,repeat:0,if:n(r,"if",null),run:n(r,"run",null),loop:n(r,"loop",null),event:n(r,"event",null),target:n(r,"target",null),set:n(r,"set",null),tween:n(r,"tween",null),sound:n(r,"sound",null),once:n(r,"once",!1),stop:n(r,"stop",!1)}),i=a}return this.complete=!1,this},clear:function(){for(var t=this.events,e=0;e<t.length;e++){var i=t[e];i.tweenInstance&&i.tweenInstance.stop()}return t=[],this.elapsed=0,this.paused=!0,this},isPlaying:function(){return!this.paused&&!this.complete},getProgress:function(){return Math.min(this.totalComplete,this.events.length)/this.events.length},destroy:function(){var t=this.systems.events;t.off(s.PRE_UPDATE,this.preUpdate,this),t.off(s.UPDATE,this.update,this),t.off(s.SHUTDOWN,this.destroy,this),this.clear(),this.scene=null,this.systems=null}});return i.register("timeline",function(t){return new a(this.scene,t)}),eht=a}function Ult(){return aht||(aht=1,rht=function(t,e,i){var n;return n=t.hasOwnProperty(e)?"function"==typeof t[e]?function(i,n,s,r,a,o){return t[e](i,n,s,r,a,o)}:function(){return t[e]}:"function"==typeof i?i:function(){return i},n}),rht}function Ylt(){if(uht)return lht;uht=1;var t=hht?oht:(hht=1,oht=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","interpolation","loop","loopDelay","onActive","onActiveParams","onComplete","onCompleteParams","onLoop","onLoopParams","onPause","onPauseParams","onRepeat","onRepeatParams","onResume","onResumeParams","onStart","onStartParams","onStop","onStopParams","onUpdate","onUpdateParams","onYoyo","onYoyoParams","paused","persist","props","repeat","repeatDelay","targets","yoyo"]);return lht=function(e){var i,n=[];if(e.hasOwnProperty("props"))for(i in e.props)"_"!==i.substring(0,1)&&n.push({key:i,value:e.props[i]});else for(i in e)-1===t.indexOf(i)&&"_"!==i.substring(0,1)&&n.push({key:i,value:e[i]});return n}}function Xlt(){if(dht)return cht;dht=1;var t=Tl();return cht=function(e){var i=t(e,"targets",null);return null===i||("function"==typeof i&&(i=i.call()),Array.isArray(i)||(i=[i])),i}}function Glt(){if(pht)return fht;pht=1;var t=sY(),e=HY();function i(t){return!!t.getActive&&"function"==typeof t.getActive}function n(t){return!!t.getStart&&"function"==typeof t.getStart}function s(t){return!!t.getEnd&&"function"==typeof t.getEnd}var r=function(a,o){var h,l,u=function(t,e,i){return i},c=function(t,e,i){return i},d=null,f=typeof o;if("number"===f)u=function(){return o};else if(Array.isArray(o))c=function(){return o[0]},u=function(){return o[o.length-1]};else if("string"===f){var p=o.toLowerCase(),g="random"===p.substring(0,6),m="int"===p.substring(0,3);if(g||m){var v=p.indexOf("("),y=p.indexOf(")"),x=p.indexOf(",");if(!(v&&y&&x))throw new Error("invalid random() format");var w=parseFloat(p.substring(v+1,x)),b=parseFloat(p.substring(x+1,y));u=g?function(){return e(w,b)}:function(){return t(w,b)}}else{p=p[0];var T=parseFloat(o.substr(2));switch(p){case"+":u=function(t,e,i){return i+T};break;case"-":u=function(t,e,i){return i-T};break;case"*":u=function(t,e,i){return i*T};break;case"/":u=function(t,e,i){return i/T};break;default:u=function(){return parseFloat(o)}}}}else if("function"===f)u=o;else if("object"===f)if(n(l=o)||s(l)||i(l))i(o)&&(d=o.getActive),s(o)&&(u=o.getEnd),n(o)&&(c=o.getStart);else if(o.hasOwnProperty("value"))h=r(a,o.value);else{var E=o.hasOwnProperty("to"),S=o.hasOwnProperty("from"),_=o.hasOwnProperty("start");if(E&&(S||_)){if(h=r(a,o.to),_){var C=r(a,o.start);h.getActive=C.getEnd}if(S){var A=r(a,o.from);h.getStart=A.getEnd}}}return h||(h={getActive:d,getEnd:u,getStart:c}),h};return fht=r}function Hlt(){return Iht?Dht:(Iht=1,Dht={TWEEN_ACTIVE:mht?ght:(mht=1,ght="active"),TWEEN_COMPLETE:yht?vht:(yht=1,vht="complete"),TWEEN_LOOP:wht?xht:(wht=1,xht="loop"),TWEEN_PAUSE:Tht?bht:(Tht=1,bht="pause"),TWEEN_RESUME:Sht?Eht:(Sht=1,Eht="resume"),TWEEN_REPEAT:Cht?_ht:(Cht=1,_ht="repeat"),TWEEN_START:Mht?Aht:(Mht=1,Aht="start"),TWEEN_STOP:Rht?Pht:(Rht=1,Pht="stop"),TWEEN_UPDATE:Oht?Lht:(Oht=1,Lht="update"),TWEEN_YOYO:kht?Fht:(kht=1,Fht="yoyo")})}function Wlt(){if(Nht)return Bht;Nht=1;var t=Ih(),e=Iz(),i=Hlt(),n=ku(),s=new t({Extends:e,initialize:function(t){e.call(this),this.parent=t,this.data=[],this.totalData=0,this.startDelay=0,this.hasStarted=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=n.PENDING,this.paused=!1,this.callbacks={onActive:null,onComplete:null,onLoop:null,onPause:null,onRepeat:null,onResume:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null},this.callbackScope,this.persist=!1},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return!this.paused&&this.isActive()},isPaused:function(){return this.paused},pause:function(){return this.paused||(this.paused=!0,this.dispatchEvent(i.TWEEN_PAUSE,"onPause")),this},resume:function(){return this.paused&&(this.paused=!1,this.dispatchEvent(i.TWEEN_RESUME,"onResume")),this},makeActive:function(){this.parent.makeActive(this),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")},onCompleteHandler:function(){this.setPendingRemoveState(),this.dispatchEvent(i.TWEEN_COMPLETE,"onComplete")},complete:function(t){return void 0===t&&(t=0),t?(this.setCompleteDelayState(),this.countdown=t):this.onCompleteHandler(),this},completeAfterLoop:function(t){return void 0===t&&(t=0),this.loopCounter>t&&(this.loopCounter=t),this},remove:function(){return this.parent&&this.parent.remove(this),this},stop:function(){return!this.parent||this.isRemoved()||this.isPendingRemove()||this.isDestroyed()||(this.dispatchEvent(i.TWEEN_STOP,"onStop"),this.setPendingRemoveState()),this},updateLoopCountdown:function(t){this.countdown-=t,this.countdown<=0&&(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"))},updateStartCountdown:function(t){return this.countdown-=t,this.countdown<=0&&(this.hasStarted=!0,this.setActiveState(),this.dispatchEvent(i.TWEEN_START,"onStart"),t=0),t},updateCompleteDelay:function(t){this.countdown-=t,this.countdown<=0&&this.onCompleteHandler()},setCallback:function(t,e,i){return void 0===i&&(i=[]),this.callbacks.hasOwnProperty(t)&&(this.callbacks[t]={func:e,params:i}),this},setPendingState:function(){this.state=n.PENDING},setActiveState:function(){this.state=n.ACTIVE,this.hasStarted=!1},setLoopDelayState:function(){this.state=n.LOOP_DELAY},setCompleteDelayState:function(){this.state=n.COMPLETE_DELAY},setStartDelayState:function(){this.state=n.START_DELAY,this.countdown=this.startDelay,this.hasStarted=!1},setPendingRemoveState:function(){this.state=n.PENDING_REMOVE},setRemovedState:function(){this.state=n.REMOVED},setFinishedState:function(){this.state=n.FINISHED},setDestroyedState:function(){this.state=n.DESTROYED},isPending:function(){return this.state===n.PENDING},isActive:function(){return this.state===n.ACTIVE},isLoopDelayed:function(){return this.state===n.LOOP_DELAY},isCompleteDelayed:function(){return this.state===n.COMPLETE_DELAY},isStartDelayed:function(){return this.state===n.START_DELAY},isPendingRemove:function(){return this.state===n.PENDING_REMOVE},isRemoved:function(){return this.state===n.REMOVED},isFinished:function(){return this.state===n.FINISHED},isDestroyed:function(){return this.state===n.DESTROYED},destroy:function(){this.data&&this.data.forEach(function(t){t.destroy()}),this.removeAllListeners(),this.callbacks=null,this.data=null,this.parent=null,this.setDestroyedState()}});return s.TYPES=["onActive","onComplete","onLoop","onPause","onRepeat","onResume","onStart","onStop","onUpdate","onYoyo"],Bht=s}function Vlt(){return Uht?zht:(Uht=1,zht={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1,persist:!1,interpolation:null})}function jlt(){if(Xht)return Yht;Xht=1;var t=Ih(),e=Hlt(),i=ku(),n=new t({initialize:function(t,e,i,n,s,r,a,o,h,l){this.tween=t,this.targetIndex=e,this.duration=n<=0?.01:n,this.totalDuration=0,this.delay=0,this.getDelay=i,this.yoyo=s,this.hold=r,this.repeat=a,this.repeatDelay=o,this.repeatCounter=0,this.flipX=h,this.flipY=l,this.progress=0,this.elapsed=0,this.state=0,this.isCountdown=!1},getTarget:function(){return this.tween.targets[this.targetIndex]},setTargetValue:function(t){void 0===t&&(t=this.current),this.tween.targets[this.targetIndex][this.key]=t},setCreatedState:function(){this.state=i.CREATED,this.isCountdown=!1},setDelayState:function(){this.state=i.DELAY,this.isCountdown=!0},setPendingRenderState:function(){this.state=i.PENDING_RENDER,this.isCountdown=!1},setPlayingForwardState:function(){this.state=i.PLAYING_FORWARD,this.isCountdown=!1},setPlayingBackwardState:function(){this.state=i.PLAYING_BACKWARD,this.isCountdown=!1},setHoldState:function(){this.state=i.HOLD_DELAY,this.isCountdown=!0},setRepeatState:function(){this.state=i.REPEAT_DELAY,this.isCountdown=!0},setCompleteState:function(){this.state=i.COMPLETE,this.isCountdown=!1},isCreated:function(){return this.state===i.CREATED},isDelayed:function(){return this.state===i.DELAY},isPendingRender:function(){return this.state===i.PENDING_RENDER},isPlayingForward:function(){return this.state===i.PLAYING_FORWARD},isPlayingBackward:function(){return this.state===i.PLAYING_BACKWARD},isHolding:function(){return this.state===i.HOLD_DELAY},isRepeating:function(){return this.state===i.REPEAT_DELAY},isComplete:function(){return this.state===i.COMPLETE},setStateFromEnd:function(t){this.yoyo?this.onRepeat(t,!0,!0):this.repeatCounter>0?this.onRepeat(t,!0,!1):this.setCompleteState()},setStateFromStart:function(t){this.repeatCounter>0?this.onRepeat(t,!1):this.setCompleteState()},reset:function(){var t=this.tween,e=t.totalTargets,n=this.targetIndex,s=t.targets[n],r=this.key;this.progress=0,this.elapsed=0,this.delay=this.getDelay(s,r,0,n,e,t),this.repeatCounter=-1===this.repeat?i.MAX:this.repeat,this.setPendingRenderState();var a=this.duration+this.hold;this.yoyo&&(a+=this.duration);var o=a+this.repeatDelay;this.totalDuration=this.delay+a,-1===this.repeat?(this.totalDuration+=o*i.MAX,t.isInfinite=!0):this.repeat>0&&(this.totalDuration+=o*this.repeat),this.totalDuration>t.duration&&(t.duration=this.totalDuration),this.delay<t.startDelay&&(t.startDelay=this.delay),this.delay>0&&(this.elapsed=this.delay,this.setDelayState())},onRepeat:function(t,i,n){var s=this.tween,r=s.totalTargets,a=this.targetIndex,o=s.targets[a],h=this.key,l="texture"!==h;if(this.elapsed=t,this.progress=t/this.duration,this.flipX&&o.toggleFlipX(),this.flipY&&o.toggleFlipY(),l&&(i||n)&&(this.start=this.getStartValue(o,h,this.start,a,r,s)),n)return this.setPlayingBackwardState(),void this.dispatchEvent(e.TWEEN_YOYO,"onYoyo");this.repeatCounter--,l&&(this.end=this.getEndValue(o,h,this.start,a,r,s)),this.repeatDelay>0?(this.elapsed=this.repeatDelay-t,l&&(this.current=this.start,o[h]=this.current),this.setRepeatState()):(this.setPlayingForwardState(),this.dispatchEvent(e.TWEEN_REPEAT,"onRepeat"))},destroy:function(){this.tween=null,this.getDelay=null,this.setCompleteState()}});return Yht=n}function qlt(){if(Hht)return Ght;Hht=1;var t=jlt(),e=Yh(),i=Ih(),n=Hlt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g,m,v){t.call(this,e,i,h,l,u,c,d,f,p,g),this.key=n,this.getActiveValue=a,this.getEndValue=s,this.getStartValue=r,this.ease=o,this.start=0,this.previous=0,this.current=0,this.end=0,this.interpolation=m,this.interpolationData=v},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex],n=this.key;e&&(i[n]=this.start),this.start=0,this.previous=0,this.current=0,this.end=0,this.getActiveValue&&(i[n]=this.getActiveValue(i,n,0))},update:function(t){var i=this.tween,s=i.totalTargets,r=this.targetIndex,a=i.targets[r],o=this.key;if(!a)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.start=this.getStartValue(a,o,a[o],r,s,i),this.end=this.getEndValue(a,o,this.start,r,s,i),this.current=this.start,a[o]=this.start,this.setPlayingForwardState(),!0;var h=this.isPlayingForward(),l=this.isPlayingBackward();if(h||l){var u=this.elapsed,c=this.duration,d=0,f=!1;(u+=t)>=c?(d=u-c,u=c,f=!0):u<0&&(u=0);var p=e(u/c,0,1);this.elapsed=u,this.progress=p,this.previous=this.current,h||(p=1-p);var g=this.ease(p);this.interpolation?this.current=this.interpolation(this.interpolationData,g):this.current=this.start+(this.end-this.start)*g,a[o]=this.current,f&&(h?(i.isNumberTween&&(this.current=this.end,a[o]=this.current),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(d)):(i.isNumberTween&&(this.current=this.start,a[o]=this.current),this.setStateFromStart(d))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key,r=this.current,a=this.previous;i.emit(t,i,s,n,r,a);var o=i.callbacks[e];o&&o.func.apply(i.callbackScope,[i,n,s,r,a].concat(o.params))}},destroy:function(){t.prototype.destroy.call(this),this.getActiveValue=null,this.getEndValue=null,this.getStartValue=null,this.ease=null}});return Ght=s}function Klt(){if(Vht)return Wht;Vht=1;var t=jlt(),e=Yh(),i=Ih(),n=Hlt(),s=new i({Extends:t,initialize:function(e,i,n,s,r,a,o,h,l,u,c){t.call(this,e,i,r,a,!1,o,h,l,u,c),this.key="texture",this.startTexture=null,this.endTexture=n,this.startFrame=null,this.endFrame=s,this.yoyo=0!==h},reset:function(e){t.prototype.reset.call(this);var i=this.tween.targets[this.targetIndex];this.startTexture||(this.startTexture=i.texture.key,this.startFrame=i.frame.name),e&&i.setTexture(this.startTexture,this.startFrame)},update:function(t){var i=this.tween,s=this.targetIndex,r=i.targets[s];if(!r)return this.setCompleteState(),!1;if(this.isCountdown&&(this.elapsed-=t,this.elapsed<=0&&(this.elapsed=0,t=0,this.isDelayed()?this.setPendingRenderState():this.isRepeating()?(this.setPlayingForwardState(),this.dispatchEvent(n.TWEEN_REPEAT,"onRepeat")):this.isHolding()&&this.setStateFromEnd(0))),this.isPendingRender())return this.startTexture&&r.setTexture(this.startTexture,this.startFrame),this.setPlayingForwardState(),!0;var a=this.isPlayingForward(),o=this.isPlayingBackward();if(a||o){var h=this.elapsed,l=this.duration,u=0,c=!1;(h+=t)>=l?(u=h-l,h=l,c=!0):h<0&&(h=0);var d=e(h/l,0,1);this.elapsed=h,this.progress=d,c&&(a?(r.setTexture(this.endTexture,this.endFrame),this.hold>0?(this.elapsed=this.hold,this.setHoldState()):this.setStateFromEnd(u)):(r.setTexture(this.startTexture,this.startFrame),this.setStateFromStart(u))),this.dispatchEvent(n.TWEEN_UPDATE,"onUpdate")}return!this.isComplete()},dispatchEvent:function(t,e){var i=this.tween;if(!i.isSeeking){var n=i.targets[this.targetIndex],s=this.key;i.emit(t,i,s,n);var r=i.callbacks[e];r&&r.func.apply(i.callbackScope,[i,n,s].concat(r.params))}},destroy:function(){t.prototype.destroy.call(this),this.startTexture=null,this.endTexture=null,this.startFrame=null,this.endFrame=null}});return Wht=s}function Zlt(){if(qht)return jht;qht=1;var t=Wlt(),e=Ih(),i=Hlt(),n=GH(),s=Mu(),r=Gh(),a=ku(),o=qlt(),h=Klt(),l=new e({Extends:t,initialize:function(e,i){t.call(this,e),this.targets=i,this.totalTargets=i.length,this.isSeeking=!1,this.isInfinite=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.isNumberTween=!1},add:function(t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,m){var v=new o(this,t,e,i,n,s,r,a,h,l,u,c,d,f,p,g,m);return this.totalData=this.data.push(v),v},addFrame:function(t,e,i,n,s,r,a,o,l,u){var c=new h(this,t,e,i,n,s,r,a,o,l,u);return this.totalData=this.data.push(c),c},getValue:function(t){void 0===t&&(t=0);var e=null;return this.data&&(e=this.data[t].current),e},hasTarget:function(t){return this.targets&&-1!==this.targets.indexOf(t)},updateTo:function(t,e,i){if(void 0===i&&(i=!1),"texture"!==t)for(var n=0;n<this.totalData;n++){var s=this.data[n];s.key===t&&(s.isPlayingForward()||s.isPlayingBackward())&&(s.end=e,i&&(s.start=s.current))}return this},restart:function(){switch(this.state){case a.REMOVED:case a.FINISHED:this.seek(),this.parent.makeActive(this);break;case a.PENDING:case a.PENDING_REMOVE:this.parent.reset(this);break;case a.DESTROYED:console.warn("Cannot restart destroyed Tween",this);break;default:this.seek()}return this.paused=!1,this.hasStarted=!1,this},nextState:function(){if(this.loopCounter>0)this.elapsed=0,this.progress=0,this.loopCounter--,this.initTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(i.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},onCompleteHandler:function(){this.progress=1,this.totalProgress=1,t.prototype.onCompleteHandler.call(this)},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed Tween",this),this):((this.isPendingRemove()||this.isFinished())&&this.seek(),this.paused=!1,this.setActiveState(),this)},seek:function(t,e,n){if(void 0===t&&(t=0),void 0===e&&(e=16.6),void 0===n&&(n=!1),this.isDestroyed())return console.warn("Cannot seek destroyed Tween",this),this;n||(this.isSeeking=!0),this.reset(!0),this.initTweenData(!0),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive");var s=this.paused;if(this.paused=!1,t>0){for(var r=Math.floor(t/e),a=t-r*e,o=0;o<r;o++)this.update(e);a>0&&this.update(a)}return this.paused=s,this.isSeeking=!1,this},initTweenData:function(t){void 0===t&&(t=!1),this.duration=0,this.startDelay=r.MAX_SAFE_INTEGER;for(var e=this.data,i=0;i<this.totalData;i++)e[i].reset(t);this.duration=Math.max(this.duration,.01);var n=this.duration,s=this.completeDelay,a=this.loopCounter,o=this.loopDelay;this.totalDuration=a>0?n+s+(n+o)*a:n+s},reset:function(t){return void 0===t&&(t=!1),this.elapsed=0,this.totalElapsed=0,this.progress=0,this.totalProgress=0,this.loopCounter=this.loop,-1===this.loop&&(this.isInfinite=!0,this.loopCounter=a.MAX),t||(this.initTweenData(),this.setActiveState(),this.dispatchEvent(i.TWEEN_ACTIVE,"onActive")),this},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.paused||this.isFinished())return!1;if(t*=this.timeScale*this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(i.TWEEN_START,"onStart"),t=0));var e=!1;if(this.isActive())for(var n=this.data,s=0;s<this.totalData;s++)n[s].update(t)&&(e=!0);this.elapsed+=t,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=t,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),e||this.nextState();var r=this.isPendingRemove();return r&&this.persist&&(this.setFinishedState(),r=!1),r},forward:function(t){return this.update(t),this},rewind:function(t){return this.update(-t),this},dispatchEvent:function(t,e){if(!this.isSeeking){if(this.emit(t,this,this.targets),!this.callbacks)return;var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this,this.targets].concat(i.params))}},destroy:function(){t.prototype.destroy.call(this),this.targets=null}});return s.register("tween",function(t){return this.scene.sys.tweens.add(t)}),n.register("tween",function(t){return this.scene.sys.tweens.create(t)}),jht=l}function $lt(){if(Zht)return Kht;Zht=1;var t=Wlt(),e=Vlt(),i=_W(),n=Fu(),s=aU(),r=kh(),a=Ult(),o=Tl(),h=Glt(),l=wV(),u=Zlt();return Kht=function(c,d,f){if(d instanceof u)return d.parent=c,d;f=void 0===f?e:l(e,f);var p=r(d,"from",0),g=r(d,"to",1),m=[{value:p}],v=r(d,"delay",f.delay),y=r(d,"easeParams",f.easeParams),x=r(d,"ease",f.ease),w=h("value",g),b=new u(c,m),T=b.add(0,"value",w.getEnd,w.getStart,w.getActive,s(r(d,"ease",x),r(d,"easeParams",y)),a(d,"delay",v),r(d,"duration",f.duration),n(d,"yoyo",f.yoyo),r(d,"hold",f.hold),r(d,"repeat",f.repeat),r(d,"repeatDelay",f.repeatDelay),!1,!1);T.start=p,T.current=p,b.completeDelay=i(d,"completeDelay",0),b.loop=Math.round(i(d,"loop",0)),b.loopDelay=Math.round(i(d,"loopDelay",0)),b.paused=n(d,"paused",!1),b.persist=n(d,"persist",!1),b.isNumberTween=!0,b.callbackScope=o(d,"callbackScope",b);for(var E=t.TYPES,S=0;S<E.length;S++){var _=E[S],C=o(d,_,!1);if(C){var A=o(d,_+"Params",[]);b.setCallback(_,C,A)}}return b},Kht}function Jlt(){if(Jht)return $ht;Jht=1;var t=aU(),e=Tl(),i=Gh();return $ht=function(n,s){var r;void 0===s&&(s={});var a=e(s,"start",0),o=e(s,"ease",null),h=e(s,"grid",null),l=e(s,"from",0),u="first"===l,c="center"===l,d="last"===l,f="number"==typeof l,p=Array.isArray(n),g=p?parseFloat(n[0]):parseFloat(n),m=p?parseFloat(n[1]):0,v=Math.max(g,m);if(p&&(a+=g),h){var y=h[0],x=h[1],w=0,b=0,T=0,E=0,S=[];d?(w=y-1,b=x-1):f?(w=l%y,b=Math.floor(l/y)):c&&(w=(y-1)/2,b=(x-1)/2);for(var _=i.MIN_SAFE_INTEGER,C=0;C<x;C++){S[C]=[];for(var A=0;A<y;A++){T=w-A,E=b-C;var M=Math.sqrt(T*T+E*E);M>_&&(_=M),S[C][A]=M}}}var P=o?t(o):null;return r=h?function(t,e,i,n){var s,r=0,o=n%y,h=Math.floor(n/y);if(o>=0&&o<y&&h>=0&&h<x&&(r=S[h][o]),p){var l=m-g;s=P?r/_*l*P(r/_):r/_*l}else s=P?r*g*P(r/_):r*g;return s+a}:function(t,e,i,n,s){var r,o,h;return s--,u?r=n:c?r=Math.abs(s/2-n):d?r=s-n:f&&(r=Math.abs(l-n)),p?(h=c?(m-g)/s*(2*r):(m-g)/s*r,o=P?h*P(r/s):h):o=P?s*v*P(r/s):r*g,o+a},r}}function Qlt(){if(tlt)return Qht;tlt=1;var t=Wlt(),e=Vlt(),i=_W(),n=Fu(),s=aU(),r=kh(),a=rV(),o=Ult(),h=Ylt(),l=Xlt(),u=Tl(),c=Glt(),d=wV(),f=Zlt();return Qht=function(p,g,m){if(g instanceof f)return g.parent=p,g;m=void 0===m?e:d(e,m);var v=l(g);!v&&m.targets&&(v=m.targets);for(var y=h(g),x=r(g,"delay",m.delay),w=r(g,"duration",m.duration),b=r(g,"easeParams",m.easeParams),T=r(g,"ease",m.ease),E=r(g,"hold",m.hold),S=r(g,"repeat",m.repeat),_=r(g,"repeatDelay",m.repeatDelay),C=n(g,"yoyo",m.yoyo),A=n(g,"flipX",m.flipX),M=n(g,"flipY",m.flipY),P=r(g,"interpolation",m.interpolation),R=function(t,e,i,h){if("texture"===i){var l=h,u=void 0;Array.isArray(h)?(l=h[0],u=h[1]):h.hasOwnProperty("value")?(l=h.value,Array.isArray(h.value)?(l=h.value[0],u=h.value[1]):"string"==typeof h.value&&(l=h.value)):"string"==typeof h&&(l=h),t.addFrame(e,l,u,o(h,"delay",x),r(h,"duration",w),r(h,"hold",E),r(h,"repeat",S),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",M))}else{var d=c(i,h),f=a(r(h,"interpolation",P));t.add(e,i,d.getEnd,d.getStart,d.getActive,s(r(h,"ease",T),r(h,"easeParams",b)),o(h,"delay",x),r(h,"duration",w),n(h,"yoyo",C),r(h,"hold",E),r(h,"repeat",S),r(h,"repeatDelay",_),n(h,"flipX",A),n(h,"flipY",M),f,f?h:null)}},L=new f(p,v),O=0;O<y.length;O++)for(var F=y[O].key,k=y[O].value,D=0;D<v.length;D++)"scale"!==F||v[D].hasOwnProperty("scale")?R(L,D,F,k):(R(L,D,"scaleX",k),R(L,D,"scaleY",k));L.completeDelay=i(g,"completeDelay",0),L.loop=Math.round(i(g,"loop",0)),L.loopDelay=Math.round(i(g,"loopDelay",0)),L.paused=n(g,"paused",!1),L.persist=n(g,"persist",!1),L.callbackScope=r(g,"callbackScope",L);for(var I=t.TYPES,B=0;B<I.length;B++){var N=I[B],z=u(g,N,!1);if(z){var U=u(g,N+"Params",[]);L.setCallback(N,z,U)}}return L},Qht}function tut(){if(slt)return nlt;slt=1;var t=Cl(),e=Wlt(),i=Ih(),n=Hlt(),s=GH(),r=Mu(),a=ku(),o=new i({Extends:e,initialize:function(t){e.call(this,t),this.currentTween=null,this.currentIndex=0},init:function(){return this.loopCounter=-1===this.loop?a.MAX:this.loop,this.setCurrentTween(0),this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this},add:function(t){var e=this.parent.create(t);Array.isArray(e)||(e=[e]);for(var i=this.data,n=0;n<e.length;n++){var s=e[n];s.parent=this,i.push(s.reset())}return this.totalData=i.length,this},remove:function(e){return t(this.data,e),e.setRemovedState(),e===this.currentTween&&this.nextTween(),this.totalData=this.data.length,this},hasTarget:function(t){for(var e=this.data,i=0;i<this.totalData;i++)if(e[i].hasTarget(t))return!0;return!1},restart:function(){return this.isDestroyed()?(console.warn("Cannot restart destroyed TweenChain",this),this):(this.isRemoved()&&this.parent.makeActive(this),this.resetTweens(),this.paused=!1,this.init())},reset:function(t){return t.seek(),t.setActiveState(),this},makeActive:function(t){return t.reset(),t.setActiveState(),this},nextState:function(){if(this.loopCounter>0)this.loopCounter--,this.resetTweens(),this.loopDelay>0?(this.countdown=this.loopDelay,this.setLoopDelayState()):(this.setActiveState(),this.dispatchEvent(n.TWEEN_LOOP,"onLoop"));else{if(!(this.completeDelay>0))return this.onCompleteHandler(),!0;this.countdown=this.completeDelay,this.setCompleteDelayState()}return!1},play:function(){return this.isDestroyed()?(console.warn("Cannot play destroyed TweenChain",this),this):((this.isPendingRemove()||this.isPending())&&this.resetTweens(),this.paused=!1,this.startDelay>0&&!this.isStartDelayed()?this.setStartDelayState():this.setActiveState(),this)},resetTweens:function(){for(var t=this.data,e=this.totalData,i=0;i<e;i++)t[i].reset(!1);this.setCurrentTween(0)},update:function(t){if(this.isPendingRemove()||this.isDestroyed())return!this.persist||(this.setFinishedState(),!1);if(this.isFinished()||this.paused)return!1;if(t*=this.parent.timeScale,this.isLoopDelayed())return this.updateLoopCountdown(t),!1;if(this.isCompleteDelayed())return this.updateCompleteDelay(t),!1;this.hasStarted||(this.startDelay-=t,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchEvent(n.TWEEN_START,"onStart"),t=0));var e=!1;return this.isActive()&&this.currentTween&&(this.currentTween.update(t)&&this.nextTween()&&this.nextState(),(e=this.isPendingRemove())&&this.persist&&(this.setFinishedState(),e=!1)),e},nextTween:function(){return this.currentIndex++,this.currentIndex===this.totalData||(this.setCurrentTween(this.currentIndex),!1)},setCurrentTween:function(t){this.currentIndex=t,this.currentTween=this.data[t],this.currentTween.setActiveState()},dispatchEvent:function(t,e){this.emit(t,this);var i=this.callbacks[e];i&&i.func.apply(this.callbackScope,[this].concat(i.params))},destroy:function(){e.prototype.destroy.call(this),this.currentTween=null}});return r.register("tweenchain",function(t){return this.scene.sys.tweens.chain(t)}),s.register("tweenchain",function(t){return this.scene.sys.tweens.create(t)}),nlt=o}function eut(){if(hlt)return olt;hlt=1;var t=Cl(),e=Ih(),i=pl(),n=$lt(),s=Cu(),r=Au(),a=Jlt(),o=Zlt(),h=Qlt(),l=tut(),u=function(){if(alt)return rlt;alt=1;var t=Wlt(),e=_W(),i=Fu(),n=Xlt(),s=Tl(),r=Qlt(),a=tut();return rlt=function(o,h){if(h instanceof a)return h.parent=o,h;var l,u=new a(o);u.startDelay=s(h,"delay",0),u.completeDelay=e(h,"completeDelay",0),u.loop=Math.round(e(h,"loop",s(h,"repeat",0))),u.loopDelay=Math.round(e(h,"loopDelay",s(h,"repeatDelay",0))),u.paused=i(h,"paused",!1),u.persist=i(h,"persist",!1),u.callbackScope=s(h,"callbackScope",u);var c=t.TYPES;for(l=0;l<c.length;l++){var d=c[l],f=s(h,d,!1);if(f){var p=s(h,d+"Params",[]);u.setCallback(d,f,p)}}var g=s(h,"tweens",null);if(Array.isArray(g)){var m=[],v=n(h),y=void 0;for(v&&(y={targets:v}),l=0;l<g.length;l++)m.push(r(u,g[l],y));u.add(m)}return u},rlt}(),c=new e({initialize:function(t){this.scene=t,this.events=t.sys.events,this.timeScale=1,this.paused=!1,this.processing=!1,this.tweens=[],this.time=0,this.startTime=0,this.nextTime=0,this.prevTime=0,this.maxLag=500,this.lagSkip=33,this.gap=1e3/240,this.events.once(r.BOOT,this.boot,this),this.events.on(r.START,this.start,this)},boot:function(){this.events.once(r.DESTROY,this.destroy,this)},start:function(){this.timeScale=1,this.paused=!1,this.startTime=Date.now(),this.prevTime=this.startTime,this.nextTime=this.gap,this.events.on(r.UPDATE,this.update,this),this.events.once(r.SHUTDOWN,this.shutdown,this)},create:function(t){Array.isArray(t)||(t=[t]);for(var e=[],i=0;i<t.length;i++){var n=t[i];n instanceof o||n instanceof l?e.push(n):Array.isArray(n.tweens)?e.push(u(this,n)):e.push(h(this,n))}return 1===e.length?e[0]:e},add:function(t){var e=t,i=this.tweens;return e instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),i.push(e.reset()),e},addMultiple:function(t){for(var e,i=[],n=this.tweens,s=0;s<t.length;s++)(e=t[s])instanceof o||e instanceof l||(e=Array.isArray(e.tweens)?u(this,e):h(this,e)),n.push(e.reset()),i.push(e);return i},chain:function(t){var e=u(this,t);return this.tweens.push(e.init()),e},getChainedTweens:function(t){return t.getChainedTweens()},has:function(t){return this.tweens.indexOf(t)>-1},existing:function(t){return this.has(t)||this.tweens.push(t.reset()),this},addCounter:function(t){var e=n(this,t);return this.tweens.push(e.reset()),e},stagger:function(t,e){return a(t,e)},setLagSmooth:function(t,e){return void 0===t&&(t=1/1e-8),void 0===e&&(e=0),this.maxLag=t,this.lagSkip=Math.min(e,this.maxLag),this},setFps:function(t){return void 0===t&&(t=240),this.gap=1e3/t,this.nextTime=1e3*this.time+this.gap,this},getDelta:function(t){var e=Date.now()-this.prevTime;e>this.maxLag&&(this.startTime+=e-this.lagSkip),this.prevTime+=e;var i=this.prevTime-this.startTime,n=i-this.nextTime,s=i-1e3*this.time;return n>0||t?(i/=1e3,this.time=i,this.nextTime+=n+(n>=this.gap?4:this.gap-n)):s=0,s},tick:function(){return this.step(!0),this},update:function(){this.paused||this.step(!1)},step:function(t){void 0===t&&(t=!1);var e=this.getDelta(t);if(!(e<=0)){var i,n;this.processing=!0;var s=[],r=this.tweens;for(i=0;i<r.length;i++)(n=r[i]).update(e)&&s.push(n);var a=s.length;if(a&&r.length>0){for(i=0;i<a;i++){n=s[i];var o=r.indexOf(n);o>-1&&(n.isPendingRemove()||n.isDestroyed())&&(r.splice(o,1),n.destroy())}s.length=0}this.processing=!1}},remove:function(e){return this.processing?e.setPendingRemoveState():(t(this.tweens,e),e.setRemovedState()),this},reset:function(t){return this.existing(t),t.seek(),t.setActiveState(),this},makeActive:function(t){return this.existing(t),t.setActiveState(),this},each:function(t,e){var i,n=[null];for(i=1;i<arguments.length;i++)n.push(arguments[i]);return this.tweens.forEach(function(i){n[0]=i,t.apply(e,n)}),this},getTweens:function(){return this.tweens.slice()},getTweensOf:function(t){for(var e=[],n=this.tweens,s=(t=Array.isArray(t)?i(t):[t]).length,r=0;r<n.length;r++)for(var a=n[r],o=0;o<s;o++)!a.isDestroyed()&&a.hasTarget(t[o])&&e.push(a);return e},getGlobalTimeScale:function(){return this.timeScale},setGlobalTimeScale:function(t){return this.timeScale=t,this},isTweening:function(t){for(var e,i=this.tweens,n=0;n<i.length;n++)if((e=i[n]).isPlaying()&&e.hasTarget(t))return!0;return!1},killAll:function(){for(var t=this.processing?this.getTweens():this.tweens,e=0;e<t.length;e++)t[e].destroy();return this.processing||(t.length=0),this},killTweensOf:function(t){for(var e=this.getTweensOf(t),i=0;i<e.length;i++)e[i].destroy();return this},pauseAll:function(){return this.paused=!0,this},resumeAll:function(){return this.paused=!1,this},shutdown:function(){this.killAll(),this.tweens=[],this.events.off(r.UPDATE,this.update,this),this.events.off(r.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.events.off(r.START,this.start,this),this.scene=null,this.events=null}});return s.register("TweenManager",c,"tweens"),olt=c}function iut(){if(ult)return llt;ult=1;var t={States:ku(),Builders:ilt?elt:(ilt=1,elt={GetBoolean:Fu(),GetEaseFunction:aU(),GetInterpolationFunction:rV(),GetNewValue:Ult(),GetProps:Ylt(),GetTargets:Xlt(),GetValueOp:Glt(),NumberTweenBuilder:$lt(),StaggerBuilder:Jlt(),TweenBuilder:Qlt()}),Events:Hlt(),TweenManager:eut(),Tween:Zlt(),TweenData:qlt(),TweenFrameData:Klt(),BaseTween:Wlt(),TweenChain:tut()};return llt=t}function nut(){if(dlt)return clt;dlt=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return clt=function(e,i){for(var n=new Uint8Array(e),s=n.length,r=i?"data:"+i+";base64,":"",a=0;a<s;a+=3)r+=t[n[a]>>2],r+=t[(3&n[a])<<4|n[a+1]>>4],r+=t[(15&n[a+1])<<2|n[a+2]>>6],r+=t[63&n[a+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},clt}function sut(){if(plt)return flt;plt=1;for(var t=new Uint8Array(256),e=0;e<64;e++)t["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=e;return flt=function(e){var i,n,s,r,a=(e=e.substr(e.indexOf(",")+1)).length,o=.75*a,h=0;"="===e[a-1]&&(o--,"="===e[a-2]&&o--);for(var l=new ArrayBuffer(o),u=new Uint8Array(l),c=0;c<a;c+=4)i=t[e.charCodeAt(c)],n=t[e.charCodeAt(c+1)],s=t[e.charCodeAt(c+2)],r=t[e.charCodeAt(c+3)],u[h++]=i<<2|n>>4,u[h++]=(15&n)<<4|s>>2,u[h++]=(3&s)<<6|63&r;return l},flt}function rut(){if(ylt)return vlt;ylt=1;var t=Tl(),e=Yh();return vlt=function(i,n,s,r,a){void 0===a&&(a=s);var o=t(i,n,a);return e(o,s,r)}}var aut=Xo(function(){if(Olt)return Llt;Olt=1,E||(E=1,"undefined"!=typeof HTMLVideoElement&&!("requestVideoFrameCallback"in HTMLVideoElement.prototype)&&"getVideoPlaybackQuality"in HTMLVideoElement.prototype&&(HTMLVideoElement.prototype._rvfcpolyfillmap={},HTMLVideoElement.prototype.requestVideoFrameCallback=function(t){const e=performance.now(),i=this.getVideoPlaybackQuality(),n=this.mozPresentedFrames||this.mozPaintedFrames||i.totalVideoFrames-i.droppedVideoFrames,s=(r,a)=>{const o=this.getVideoPlaybackQuality(),h=this.mozPresentedFrames||this.mozPaintedFrames||o.totalVideoFrames-o.droppedVideoFrames;if(h>n){const n=this.mozFrameDelay||o.totalFrameDelay-i.totalFrameDelay||0,s=a-r;t(a,{presentationTime:a+1e3*n,expectedDisplayTime:a+s,width:this.videoWidth,height:this.videoHeight,mediaTime:Math.max(0,this.currentTime||0)+s/1e3,presentedFrames:h,processingDuration:n}),delete this._rvfcpolyfillmap[e]}else this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(a,t))};return this._rvfcpolyfillmap[e]=requestAnimationFrame(t=>s(e,t)),e},HTMLVideoElement.prototype.cancelVideoFrameCallback=function(t){cancelAnimationFrame(this._rvfcpolyfillmap[t]),delete this._rvfcpolyfillmap[t]}));var t=Wo(),e=jo(),i={Actions:$U(),Animations:tv?Qm:(tv=1,Qm={Animation:tY(),AnimationFrame:QU(),AnimationManager:nY(),AnimationState:rY(),Events:JU()}),BlendModes:Go(),Cache:dv?cv:(dv=1,cv={BaseCache:oY(),CacheManager:hY(),Events:aY()}),Cameras:dx?cx:(dx=1,cx={Controls:yv?vv:(yv=1,vv={FixedKeyControl:lY(),SmoothedKeyControl:uY()}),Scene2D:ux?lx:(ux=1,lx={Camera:FY(),BaseCamera:EY(),CameraManager:DY(),Effects:LY(),Events:cY()})}),Core:dC?cC:(dC=1,cC={Config:CX(),CreateRenderer:$G(),Events:iY(),TimeStep:QG(),VisibilityHandler:tH()}),Class:Ih(),Create:MC?AC:(MC=1,AC={GenerateTexture:iH(),Palettes:CC?_C:(CC=1,_C={ARNE16:eH(),C64:yC?vC:(yC=1,vC={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}),CGA:wC?xC:(wC=1,xC={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}),JMP:TC?bC:(TC=1,bC={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}),MSX:SC?EC:(SC=1,EC={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"})})}),Curves:qC?jC:(qC=1,jC={Path:cH(),MoveTo:hH(),CubicBezier:rH(),Curve:sH(),Ellipse:aH(),Line:oH(),QuadraticBezier:lH(),Spline:uH()}),Data:JC?$C:(JC=1,$C={DataManager:Ju(),DataManagerPlugin:dH(),Events:$u()}),Display:VA?WA:(VA=1,WA={Align:fH(),BaseShader:pH(),Bounds:pA?fA:(pA=1,fA={CenterOn:Ch(),GetBottom:Ko(),GetBounds:gH(),GetCenterX:Zo(),GetCenterY:hh(),GetLeft:th(),GetOffsetX:uA?lA:(uA=1,lA=function(t){return t.width*t.originX}),GetOffsetY:dA?cA:(dA=1,cA=function(t){return t.height*t.originY}),GetRight:nh(),GetTop:ch(),SetBottom:ah(),SetCenterX:$o(),SetCenterY:lh(),SetLeft:eh(),SetRight:sh(),SetTop:Jo()}),Canvas:wA?xA:(wA=1,xA={CanvasInterpolation:AX(),CanvasPool:Dl(),Smoothing:kl(),TouchAction:(mA||(mA=1,gA=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t}),gA),UserSelect:(yA||(yA=1,vA=function(t,e){return void 0===e&&(e="none"),["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(i){t.style[i+"user-select"]=e}),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t}),vA)}),Color:yH(),ColorMatrix:Ql(),Masks:XA?YA:(XA=1,YA={BitmapMask:Pu(),GeometryMask:Ru()}),RGB:xH()}),DOM:OH(),Events:TM?bM:(TM=1,bM={EventEmitter:FH()}),FX:lu(),Game:yW(),GameObjects:k3(),Geom:L4(),Input:q4(),Loader:(V8||(V8=1,M6(),jo(),qH(),G8||(G8=1,D6(),N6(),z6(),Y6(),G6(),htt(),ltt(),utt(),dtt(),ftt(),ptt(),gtt(),X6(),mtt(),vtt(),I6(),k6(),ctt(),xtt(),btt(),Ttt(),Ett(),Stt(),_tt(),ytt(),Ctt(),Att(),wtt(),Ptt(),Rtt(),Ltt(),Ott(),Ftt(),U6()),F6(),XH(),P6(),ktt(),L6(),B6(),O6(),R6()),A6),Math:SX(),Physics:ttt?Q9:(ttt=1,Q9={Arcade:vet()}),Plugins:att?rtt:(att=1,rtt={BasePlugin:yet(),DefaultPlugins:IY(),PluginCache:Cu(),PluginManager:HH(),ScenePlugin:xet()}),Renderer:(Let||(Let=1,Hrt.exports={Events:PX(),Snapshot:bet?wet:(bet=1,wet={Canvas:MX(),WebGL:GG()})},Hrt.exports.Canvas=Eet?Tet:(Eet=1,Tet={CanvasRenderer:OX(),GetBlendModes:RX(),SetTransform:PW()}),Hrt.exports.WebGL=function(){if(Ret)return Pet;Ret=1;var t=IX(),e=jo(),i={PipelineManager:XG(),Pipelines:Wrt(),RenderTarget:FX(),Utils:NX(),WebGLPipeline:UX(),WebGLRenderer:ZG(),WebGLShader:zX(),Wrappers:Vrt()};return i=e(!1,i,t),Pet=i}()),Hrt.exports),Scale:jrt(),ScaleModes:Ho(),Scene:eW(),Scenes:Krt(),Structs:zet?Net:(zet=1,Net={Events:bW(),List:xW(),Map:eY(),ProcessQueue:TW(),RTree:iet(),Set:tV(),Size:WH()}),Textures:Zrt(),Tilemaps:Dlt(),Time:sht?nht:(sht=1,nht={Clock:Blt(),Events:Nlt(),Timeline:zlt(),TimerEvent:Ilt()}),Tweens:iut(),Utils:Rlt?Plt:(Rlt=1,Plt={Array:Hl(),Base64:mlt?glt:(mlt=1,glt={ArrayBufferToBase64:nut(),Base64ToArrayBuffer:sut()}),Objects:wlt?xlt:(wlt=1,xlt={Clone:$H(),DeepCopy:Iu(),Extend:jo(),GetAdvancedValue:_W(),GetFastValue:kh(),GetMinMaxValue:rut(),GetValue:Tl(),HasAll:mV(),HasAny:vV(),HasValue:QW(),IsPlainObject:Vo(),Merge:JH(),MergeRight:wV(),Pick:Eot(),SetValue:YZ()}),String:Mlt?Alt:(Mlt=1,Alt={Format:(Tlt||(Tlt=1,blt=function(t,e){return t.replace(/%([0-9]+)/g,function(t,i){return e[Number(i)-1]})}),blt),Pad:Qh(),RemoveAt:(Slt||(Slt=1,Elt=function(t,e){return 0===e?t.slice(1):t.slice(0,e)+t.slice(e+1)}),Elt),Reverse:(Clt||(Clt=1,_lt=function(t){return t.split("").reverse().join("")}),_lt),UppercaseFirst:rU(),UUID:kV()}),NOOP:Dh(),NULL:Iat()})};return i=e(!1,i,t),Llt=i,Yo.HawkEngine=i,Llt}());const out=(t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},hut=t=>t*(Math.PI/180),lut=new Map,uut=t=>{lut.has(t)&&clearTimeout(lut.get(t)),lut.set(t,setTimeout(t,100))},cut=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent&&t.attachEvent(s,i)},dut=(t,e,i)=>{const n=e.split(/[ ,]+/g);let s;for(let e=0;e<n.length;e+=1)s=n[e],t.removeEventListener?t.removeEventListener(s,i):t.detachEvent&&t.detachEvent(s,i)},fut=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),put=()=>({x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}),gut=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},mut=(t,e,i)=>{const n=vut(t);for(let t in n)if(n.hasOwnProperty(t))if("string"==typeof e)n[t]=e+" "+i;else{let s="";for(let t=0,n=e.length;t<n;t+=1)s+=e[t]+" "+i+", ";n[t]=s.slice(0,-2)}return n},vut=t=>{const e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},yut=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},xut=(t,e)=>{if(t.length)for(let i=0,n=t.length;i<n;i+=1)e(t[i]);else e(t)};var wut,but=!!("ontouchstart"in window),Tut=!!window.PointerEvent,Eut=!!window.MSPointerEvent,Sut={start:"mousedown",move:"mousemove",end:"mouseup"},_ut={};function Cut(){}function Aut(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=Aut.id,Aut.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function Mut(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=Mut.id,Mut.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),"static"!==i.options.mode&&"semi"!==i.options.mode||(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);const n=getComputedStyle(i.options.zone.parentElement);return n&&"flex"===n.display&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}function Put(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=put(),e.config(t),e.prepareCollections();var i=function(){var t;e.collections.forEach(function(i){i.forEach(function(i){t=i.el.getBoundingClientRect(),i.position={x:e.scroll.x+t.left,y:e.scroll.y+t.top}})})};cut(window,"resize",function(){uut(i)});var n=function(){e.scroll=put()};return cut(window,"scroll",function(){uut(n)}),e.collections}Tut?wut={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Eut?wut={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:but?(wut={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},_ut=Sut):wut=Sut,Cut.prototype.on=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]=n._handlers_[i]||[],n._handlers_[i].push(e);return n},Cut.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},void 0===t?i._handlers_={}:void 0===e?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i},Cut.prototype.trigger=function(t,e){var i,n=this,s=t.split(/[ ,]+/g);n._handlers_=n._handlers_||{};for(var r=0;r<s.length;r+=1)i=s[r],n._handlers_[i]&&n._handlers_[i].length&&n._handlers_[i].forEach(function(t){t.call(n,{type:i,target:n},e)})},Cut.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=((t,e)=>{const i={};for(let n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)?i[n]=e[n]:t.hasOwnProperty(n)&&(i[n]=t[n]);return i})(e.options,t))},Cut.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){"function"==typeof i["on"+e]?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},cut(t,wut[e],i._domHandlers_[e]),_ut[e]&&cut(t,_ut[e],i._domHandlers_[e]),i},Cut.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},dut(t,wut[e],i._domHandlers_[e]),_ut[e]&&dut(t,_ut[e],i._domHandlers_[e]),delete i._domHandlers_[e],this},Aut.prototype=new Cut,Aut.constructor=Aut,Aut.id=0,Aut.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},Aut.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=(()=>{const t=vut("borderRadius");for(let e in t)t.hasOwnProperty(e)&&(t[e]="50%");return t})(),i=mut("transition","opacity",t),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:100},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},yut(n.el,i),"circle"===this.options.shape&&yut(n.back,e),yut(n.front,e),this.applyStyles(n),this},Aut.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this},Aut.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},Aut.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},Aut.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},Aut.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),"function"==typeof t&&t.call(this)},e.options.fadeTime)),e},Aut.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i="dynamic"===e.options.mode?"none":"block";e.ui.el.style.display=i,"function"==typeof t&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const i=e.options.restJoystick,n={};n.x=!0===i||!1!==i.x?0:e.instance.frontPosition.x,n.y=!0===i||!1!==i.y?0:e.instance.frontPosition.y,e.setPosition(t,n)}return e},Aut.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var n=i.options.fadeTime+"ms",s={};s.front=mut("transition",["transform"],n);var r={front:{}};r.front={transform:"translate("+i.frontPosition.x+"px,"+i.frontPosition.y+"px)"},i.applyStyles(s),i.applyStyles(r),i.restTimeout=setTimeout(function(){"function"==typeof t&&t.call(i),i.restCallback()},i.options.fadeTime)},Aut.prototype.restCallback=function(){var t=this,e={};e.front=mut("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)},Aut.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},Aut.prototype.computeDirection=function(t){var e,i,n,s=t.angle.radian,r=Math.PI/4,a=Math.PI/2;if(s>r&&s<3*r&&!t.lockX?e="up":s>-r&&s<=r&&!t.lockY?e="left":s>3*-r&&s<=-r&&!t.lockX?e="down":t.lockY||(e="right"),t.lockY||(i=s>-a&&s<a?"left":"right"),t.lockX||(n=s>0?"up":"down"),t.force>this.options.threshold){var o,h={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(h[o]=this.direction[o]);var l={};for(o in this.direction={x:i,y:n,angle:e},t.direction=this.direction,h)h[o]===this.direction[o]&&(l[o]=!0);if(l.x&&l.y&&l.angle)return t;l.x&&l.y||this.trigger("plain",t),l.x||this.trigger("plain:"+i,t),l.y||this.trigger("plain:"+n,t),l.angle||this.trigger("dir dir:"+e,t)}else this.resetDirection();return t},Mut.prototype=new Cut,Mut.constructor=Mut,Mut.id=0,Mut.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(t){if(void 0===t)return e[0];for(var i=0,n=e.length;i<n;i+=1)if(e[i].identifier===t)return e[i];return!1}},Mut.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"},Mut.prototype.begin=function(){var t=this,e=t.options;if("static"===e.mode){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}},Mut.prototype.createNipple=function(t,e){var i=this,n=i.manager.scroll,s={},r=i.options,a=i.parentIsFlex?n.x:n.x+i.box.left,o=i.parentIsFlex?n.y:n.y+i.box.top;if(t.x&&t.y)s={x:t.x-a,y:t.y-o};else if(t.top||t.right||t.bottom||t.left){var h=document.createElement("DIV");h.style.display="hidden",h.style.top=t.top,h.style.right=t.right,h.style.bottom=t.bottom,h.style.left=t.left,h.style.position="absolute",r.zone.appendChild(h);var l=h.getBoundingClientRect();r.zone.removeChild(h),s=t,t={x:l.left+n.x,y:l.top+n.y}}var u=new Aut(i,{color:r.color,size:r.size,threshold:r.threshold,fadeTime:r.fadeTime,dataOnly:r.dataOnly,restJoystick:r.restJoystick,restOpacity:r.restOpacity,mode:r.mode,identifier:e,position:t,zone:r.zone,frontPosition:{x:0,y:0},shape:r.shape});return r.dataOnly||(gut(u.ui.el,s),gut(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u},Mut.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},Mut.prototype.bindNipple=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},Mut.prototype.pressureFn=function(t,e,i){var n=this,s=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval(function(){var i=t.force||t.pressure||t.webkitForce||0;i!==s&&(e.trigger("pressure",i),n.trigger("pressure "+e.identifier+":pressure",i),s=i)}.bind(n),100)},Mut.prototype.onstart=function(t){var e=this,i=e.options,n=t;return t=fut(t),e.updateBox(),xut(t,function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(i){if(Object.values(n.touches).findIndex(function(t){return t.identifier===i})<0){var s=[t[0]];s.identifier=i,e.processOnEnd(s)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))}),e.manager.bindDocument(),!1},Mut.prototype.processOnStart=function(t){var e,i=this,n=i.options,s=i.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,a={x:t.pageX,y:t.pageY},o=i.getOrCreate(s,a);o.identifier!==s&&i.manager.removeIdentifier(o.identifier),o.identifier=s;var h=function(e){e.trigger("start",e),i.trigger("start "+e.id+":start",e),e.show(),r>0&&i.pressureFn(t,e,e.identifier),i.processOnMove(t)};if((e=i.idles.indexOf(o))>=0&&i.idles.splice(e,1),i.actives.push(o),i.ids.push(o.identifier),"semi"!==n.mode)h(o);else{if(!(out(a,o.position)<=n.catchDistance))return o.destroy(),void i.processOnStart(t);h(o)}return o},Mut.prototype.getOrCreate=function(t,e){var i,n=this,s=n.options;return/(semi|static)/.test(s.mode)?(i=n.idles[0])?(n.idles.splice(0,1),i):"semi"===s.mode?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1):i=n.createNipple(e,t)},Mut.prototype.processOnMove=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.scroll;if((t=>isNaN(t.buttons)?0!==t.pressure:0!==t.buttons)(t)){if(!s)return console.error("Found zombie joystick with ID "+n),void e.manager.removeIdentifier(n);if(i.dynamicPage){var a=s.el.getBoundingClientRect();s.position={x:r.x+a.left,y:r.y+a.top}}s.identifier=n;var o=s.options.size/2,h={x:t.pageX,y:t.pageY};i.lockX&&(h.y=s.position.y),i.lockY&&(h.x=s.position.x);var l,u,c=out(h,s.position),d=((t,e)=>{const i=e.x-t.x,n=e.y-t.y;return Math.atan2(n,i)*(180/Math.PI)})(h,s.position),f=hut(d),p=c/o,g={distance:c,position:h};if("circle"===s.options.shape?(l=Math.min(c,o),u=((t,e,i)=>{const n={x:0,y:0};return i=hut(i),n.x=t.x-e*Math.cos(i),n.y=t.y-e*Math.sin(i),n})(s.position,l,d)):(u=((t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)}))(h,s.position,o),l=out(u,s.position)),i.follow){if(c>o){let t=h.x-u.x,i=h.y-u.y;s.position.x+=t,s.position.y+=i,s.el.style.top=s.position.y-(e.box.top+r.y)+"px",s.el.style.left=s.position.x-(e.box.left+r.x)+"px",c=out(h,s.position)}}else h=u,c=l;var m=h.x-s.position.x,v=h.y-s.position.y;s.frontPosition={x:m,y:v},i.dataOnly||(s.ui.front.style.transform="translate("+m+"px,"+v+"px)");var y={identifier:s.identifier,position:h,force:p,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:f,degree:d},vector:{x:m/o,y:-v/o},raw:g,instance:s,lockX:i.lockX,lockY:i.lockY};(y=s.computeDirection(y)).angle={radian:hut(180-d),degree:180-d},s.trigger("move",y),e.trigger("move "+s.id+":move",y)}else this.processOnEnd(t)},Mut.prototype.processOnEnd=function(t){var e=this,i=e.options,n=e.manager.getIdentifier(t),s=e.nipples.get(n),r=e.manager.removeIdentifier(s.identifier);s&&(i.dataOnly||s.hide(function(){"dynamic"===i.mode&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(i.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[r.id]=r.identifier))},Mut.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()},Mut.prototype.destroy=function(){var t=this;for(var e in t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(t){t.destroy()}),t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()},Put.prototype=new Cut,Put.constructor=Put,Put.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(t){return!(i=t.get(e))}),i}},Put.prototype.create=function(t){return this.createCollection(t)},Put.prototype.createCollection=function(t){var e=this,i=new Mut(e,t);return e.bindCollection(i),e.collections.push(i),i},Put.prototype.bindCollection=function(t){var e,i=this,n=function(t,n){e=t.type+" "+n.id+":"+t.type,i.trigger(e,n)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",n),t.on("dir:up dir:right dir:down dir:left",n),t.on("plain:up plain:right plain:down plain:left",n)},Put.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)},Put.prototype.unbindDocument=function(t){var e=this;Object.keys(e.ids).length&&!0!==t||(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)},Put.prototype.getIdentifier=function(t){var e;return t?void 0===(e=void 0===t.identifier?t.pointerId:t.identifier)&&(e=this.latest||0):e=this.index,void 0===this.ids[e]&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},Put.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e},Put.prototype.onmove=function(t){return this.onAny("move",t),!1},Put.prototype.onend=function(t){return this.onAny("end",t),!1},Put.prototype.oncancel=function(t){return this.onAny("end",t),!1},Put.prototype.onAny=function(t,e){var i,n=this,s="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=fut(e);var r=function(t,e,i){i.ids.indexOf(e)>=0&&(i[s](t),t._found_=!0)};return xut(e,function(t){i=n.getIdentifier(t),xut(n.collections,r.bind(null,t,i)),t._found_||n.removeIdentifier(i)}),!1},Put.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(t){t.destroy()}),t.off()},Put.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};const Rut=new Put;class Lut{constructor(t){this.name=t,this.el=null}render(t){}toggle(){if(!this.el)return;const t="none"===this.el.style.display;this.el.style.display=t?"":"none"}close(){this.el.style.display=""}}class Out{constructor(t){this.container=t,this.messages=[],this.maxMessages=10,this.displayTime=5e3}add(t){const e=document.createElement("div");if(e.className="live-chat-message",e.innerHTML=t,this.container.appendChild(e),this.messages.push(e),this.messages.length>this.maxMessages){const t=this.messages.shift();this._removeMessage(t)}setTimeout(()=>{this._removeMessage(e),this.messages=this.messages.filter(t=>t!==e)},this.displayTime)}_removeMessage(t){this.container.contains(t)&&this.container.removeChild(t)}}class Fut{static schema={topleftchatlog:{default:!1,name:"Top left Chat Log",type:"boolean",desc:"Enable or disable top-left chat log",category:"general"},use12hFormat:{default:!1,name:"12h time format",type:"boolean",desc:"Use 12h time format (AM/PM)",category:"general"},quality:{default:"high",name:"Render Quality",type:"select",options:["high","medium","low"],desc:"Requires restart",category:"render"},debug:{default:!1,name:"Debug mode",type:"boolean",desc:"Requires restart",category:"development"}};static store=Object.fromEntries(Object.entries(Fut.schema).map(([t,e])=>[t,e.default]));static loadFromLocalStorage(){const t=JSON.parse(localStorage.getItem("options"));if(t)for(const e in t)e in Fut.store&&(Fut.store[e]=t[e])}static saveToLocalStorage(){localStorage.setItem("options",JSON.stringify(Fut.store))}static get(t){if(!(t in Fut.store))throw new Error(`Option "${t}" is not defined.`);return Fut.store[t]}static put(t,e){const i=Fut.schema[t];if(!i)throw new Error(`Option "${t}" does not exist.`);switch(i.type){case"string":if("string"!=typeof e)throw new Error(`"${t}" must be a string.`);if(e.length<i.minLength||e.length>i.maxLength)throw new Error(`"${t}" length must be between ${i.minLength} and ${i.maxLength}.`);break;case"number":if("number"!=typeof e)throw new Error(`"${t}" must be a number.`);if(e<i.min||e>i.max)throw new Error(`"${t}" must be between ${i.min} and ${i.max}.`);break;case"boolean":if("boolean"!=typeof e)throw new Error(`"${t}" must be a boolean.`);break;case"array":if(!Array.isArray(e))throw new Error(`"${t}" must be an array.`);break;case"object":if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(`"${t}" must be an object.`);break;case"select":if(!i.options.includes(e))throw new Error(`"${t}" must be one of: ${i.options.join(", ")}.`);break;default:throw new Error(`Unsupported type for "${t}".`)}Fut.store[t]=e,Fut.saveToLocalStorage()}static resetAll(){Fut.store=Object.fromEntries(Object.entries(Fut.schema).map(([t,e])=>[t,e.default])),Fut.saveToLocalStorage()}}Fut.loadFromLocalStorage();class kut{static commands=[{name:"rand",id:"/rand",description:"Random integer between two numbers: /rand min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /rand min max",!0);const n=t=>"string"==typeof t&&"wah"===t.toLowerCase();if(n(i[0])&&n(i[1])){const t=Math.floor(11*Math.random())+5,i="wah"+"h".repeat(t);return void e.send("Random number between wah and wah: "+i,!0)}const s=Number(i[0]),r=Number(i[1]);if(!Number.isFinite(s)||!Number.isFinite(r))return void e.send("Both min and max must be valid numbers.",!0);let a=Math.ceil(Math.min(s,r)),o=Math.floor(Math.max(s,r));const h=Math.floor(Math.random()*(o-a+1))+a;e.send("Random number between "+String(a)+" and "+String(o)+": "+String(h),!0)}},{name:"randf",id:"/randf",description:"Random float between two numbers: /randf min max",execute:(t,e,i)=>{if(!i||i.length<2)return void e.send("Usage: /randf min max",!0);const n=Number(i[0]),s=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(s))return void e.send("Both min and max must be valid numbers.",!0);const r=Math.min(n,s),a=Math.max(n,s),o=Math.random()*(a-r)+r;e.send("Random float between "+String(r)+" and "+String(a)+": "+String(o),!0)}},{name:"choose",id:"/choose",description:"Choose one item from a list: /choose option1 option2 ...",execute:(t,e,i)=>{if(!i||0===i.length)return void e.send("Usage: /choose option1 option2 ...",!0);const n=i[Math.floor(Math.random()*i.length)];e.send('Choosed "'+n+'"',!0)}},{name:"time",id:"/time",description:"Show current time",execute:(t,e,i)=>{e.send("Time: "+t.lightManager.getTimeF(),!0)}},{name:"shrug",id:"/shrug",description:"Send a shrug emoticon",execute:(t,e,i)=>{const n=i.join(" "),s=n?`${n} Â¯\\_(ã)_/Â¯`:"Â¯\\_(ã)_/Â¯";t.networkManager.send("chat",{message:s})}},{name:"tableflip",id:"/tableflip",description:"Flip a table",execute:(t,e,i)=>{const n=i.join(" "),s=n?`${n} (â¯Â°â¡Â°)â¯ï¸µ â»ââ»`:"(â¯Â°â¡Â°)â¯ï¸µ â»ââ»";t.networkManager.send("chat",{message:s})}},{name:"flip",id:"/flip",description:"Flip a table",execute:(t,e,i)=>{const n=i.join(" "),s=n?`${n} (â¯Â°â¡Â°)â¯ï¸µ â»ââ»`:"(â¯Â°â¡Â°)â¯ï¸µ â»ââ»";t.networkManager.send("chat",{message:s})}},{name:"unflip",id:"/unflip",description:"Put the table back",execute:(t,e,i)=>{const n=i.join(" "),s=n?`${n} â¬ââ¬ã( Âº _ Âºã)`:"â¬ââ¬ã( Âº _ Âºã)";t.networkManager.send("chat",{message:s})}},{name:"lenny",id:"/lenny",description:"Send a lenny face",execute:(t,e,i)=>{const n=i.join(" "),s=n?`${n} ( Í¡Â° ÍÊ Í¡Â°)`:"( Í¡Â° ÍÊ Í¡Â°)";t.networkManager.send("chat",{message:s})}},{name:"stuck",id:"/stuck",description:"Teleport to spawn if you are stuck",execute:(t,e,i)=>{t.player?(t.player.sprite.x=512,t.player.sprite.y=512,e.send("Teleported to spawn!",!0)):e.send("Error: Player not found",!0)}},{name:"clear",id:"/clear",description:"Clear your chat",execute:(t,e,i)=>{e.clear(),e.send("Chat cleared!",!0)}},{name:"help",id:"/help",description:"Show available commands",execute:(t,e,i)=>{e.send("=== Available Commands ===",!0),kut.commands.forEach(t=>{e.send(`${t.id} - ${t.description}`,!0)})}}];static parseArgs(t){if(!t||"string"!=typeof t)return[];const e=t.trim().split(" ").slice(1).join(" "),i=[],n=/"([^"\\]*(\\.[^"\\]*)*)"|'([^'\\]*(\\.[^'\\]*)*)'|(\S+)/g;let s;for(;null!==(s=n.exec(e));)void 0!==s[1]?i.push(s[1].replace(/\\(["'\\])/g,"$1")):void 0!==s[3]?i.push(s[3].replace(/\\(["'\\])/g,"$1")):void 0!==s[5]&&i.push(s[5]);return i}static isCommand(t){if(!t||"string"!=typeof t)return!1;const e=t.trim();if(!e.startsWith("/"))return!1;const i=e.split(" ")[0];return kut.commands.some(t=>t.id===i)}static handleCommand(t,e,i){if(!kut.isCommand(t))return!1;const n=t.split(" ")[0],s=kut.commands.find(t=>t.id===n);if(!s)return!1;const r=kut.parseArgs(t);try{return s.execute(e,i,r),!0}catch(t){return console.error("Command error:",t),i.send("Command execution error.",!0),!1}}}class Dut extends Lut{constructor({scene:t,network:e,minChars:i=1,maxChars:n=75}){super("chatbox"),this.minChars=i,this.maxChars=n,this.visible=!1,this.logVisible=!1,this.scene=t,this.network=e,this.suggestIndex=-1,this.isTyping=!1,this.typingTimeout=null,this.TYPING_DELAY=5e3}render(t){this.el=document.createElement("div"),this.el.className="chatbox-container";const i=document.createElement("button");i.className="chatbox-button",i.innerHTML='<img src="'+e.getBlob("assets/icons/message.png").dataUrl+'" alt="Chat">',i.addEventListener("click",()=>this.toggleBox()),this.el.appendChild(i);const n=document.createElement("button");n.className="chatbox-log-button",n.innerHTML='<img src="'+e.getBlob("assets/icons/list.png").dataUrl+'" alt="Chat List">',n.addEventListener("click",()=>this.toggleLogBox()),this.el.appendChild(n),this.chatBox=document.createElement("div"),this.chatBox.className="chatbox-box",this.chatBox.style.display="none",this.chatBoxLog=document.createElement("div"),this.chatBoxLog.className="chatbox-log-box",this.chatBoxLog.style.display="none",this.textarea=document.createElement("input"),this.textarea.className="chatbox-input",this.textarea.setAttribute("placeholder","Write your message..."),this.textarea.setAttribute("maxlength",this.maxChars),this.chatBox.appendChild(this.textarea),this.suggestBox=document.createElement("div"),this.suggestBox.className="chatbox-suggest",this.suggestBox.style.display="none",this.suggestBox.setAttribute("role","listbox"),this.chatBox.appendChild(this.suggestBox),this.charCounter=document.createElement("div"),this.charCounter.className="chatbox-counter",this.updateCounter(),this.chatBox.appendChild(this.charCounter);const s=document.createElement("button");s.className="chatbox-send",s.innerHTML='<img src="'+e.getBlob("assets/icons/rightarrow.png").dataUrl+'">',s.disabled=!0,s.addEventListener("click",()=>this.handleSend()),this.chatBox.appendChild(s),this.textarea.addEventListener("input",()=>{const t=this.textarea.value.trim().length;s.disabled=t<this.minChars,this.updateCounter(),this.updateSuggestions(),this._onUserTyping()}),this.textarea.addEventListener("keydown",t=>{"Enter"===t.key&&this.handleSend()}),document.getElementById("chat-log"),this.lchatlog=new Out(t),this.el.appendChild(this.chatBox),this.el.appendChild(this.chatBoxLog),t.appendChild(this.el)}_emitTyping(t){this.scene.networkManager.emitTyping(t)}_onUserTyping(){this.isTyping||(this.isTyping=!0,this._emitTyping(!0)),this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(()=>{this.isTyping=!1,this._emitTyping(!1),this.typingTimeout=null},this.TYPING_DELAY)}_stopTypingImmediate(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null),this.isTyping&&(this.isTyping=!1,this._emitTyping(!1))}toggleBox(){this.visible=!this.visible,this.chatBox.style.display=this.visible?"flex":"none",this.visible?this.textarea.focus():(this._stopTypingImmediate(),this.textarea.value=""),this.scene.inputManager.setKeysStatus(!this.visible)}toggleLogBox(){this.logVisible=!this.logVisible,this.chatBoxLog.style.display=this.logVisible?"flex":"none"}updateCounter(){const t=this.textarea.value.length;this.charCounter.textContent=`${t}/${this.maxChars}`}handleSend(){const t=this.textarea.value.trim();t.length>=this.minChars&&t.length<=this.maxChars&&(this.send(t),this.textarea.value="",this.updateCounter(),this.chatBox.style.display="none",this.visible=!1,this.hideSuggestions(),this._stopTypingImmediate())}send(t,e=!1){kut.isCommand(t)?kut.handleCommand(t,this.scene,this):this.scene.networkManager.emitChatMessage(t,e)}addMessage(t,e,i){const n=document.createElement("span");n.className="chatbox-log-message";const s=document.createElement("span");s.textContent=this.scene.lightManager.getTimeF(),s.className="timestamp";const r=document.createElement("span");r.textContent=t,r.className="name";const a=document.createElement("span");a.textContent=e,a.className="message",i&&(a.style.color="yellow"),n.appendChild(s),n.appendChild(r),n.appendChild(a),Fut.get("topleftchatlog")&&this.lchatlog.add(n.innerHTML),this.chatBoxLog.appendChild(n)}updateSuggestions(){const t=this.textarea.value;if(!t.startsWith("/"))return void this.hideSuggestions();const e=t.slice(1).toLowerCase(),i=(kut.commands||[]).filter(t=>{const i=(t.name||"").toLowerCase(),n=(t.id||"").toLowerCase();return i.includes(e)||n.includes(e)});i.length?(this.suggestBox.innerHTML="",i.slice(0,8).forEach((t,e)=>{const i=document.createElement("div");i.className="chatbox-suggest-item",i.setAttribute("role","option"),i.textContent=`/${t.name} â ${t.description||""}`,i.addEventListener("click",e=>{e.preventDefault(),this.applySuggestion(t)}),this.suggestBox.appendChild(i)}),this.suggestIndex=-1,this.updateSuggestHighlight(),this.suggestBox.style.display="block"):this.hideSuggestions()}applySuggestion(t){this.textarea.value=`/${t.name} `,this.updateCounter(),this.hideSuggestions(),this.textarea.focus(),this._onUserTyping()}hideSuggestions(){this.suggestBox&&(this.suggestBox.style.display="none",this.suggestBox.innerHTML="",this.suggestIndex=-1)}updateSuggestHighlight(){Array.from(this.suggestBox.querySelectorAll(".chatbox-suggest-item")).forEach((t,e)=>{e===this.suggestIndex?(t.classList.add("active"),t.scrollIntoView({block:"nearest"})):t.classList.remove("active")})}}class Iut extends Lut{constructor({scene:t}){super("options"),this.options=[{execute:()=>{t.inputManager.optionsModal.toggle()},html:"<img src='"+e.getBlob("assets/icons/control.png").dataUrl+"'>Settings",name:"options"},{execute:()=>{window.location.reload()},html:"<img src='"+e.getBlob("assets/icons/leave.png").dataUrl+"'>Leave",name:"leave"}],t.dev&&this.options.push({execute:()=>{t.inputManager.editorModal.toggle()},html:"<img src='"+e.getBlob("assets/icons/box.png").dataUrl+"'>Map editor",name:"open_editor"}),this.scene=t,this.headerTime=null,this.scene.lightManager.onTimeChange(t=>{this.headerTime&&(this.headerTime.textContent=t.getTimeF())})}render(t){const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/settings.png").dataUrl+'">',i.className="options-button",i.onclick=()=>this.toggle(),this.el=document.createElement("ul"),this.el.className="options-list",this.el.style.display="none";const n=document.createElement("div");n.innerHTML="<div class=\"header-brand\"><img src='/logo.png'>Hawk</div>",n.className="options-header",this.headerTime=document.createElement("div"),n.appendChild(this.headerTime),this.el.appendChild(n),this.options.forEach(t=>{const e=document.createElement("li");e.innerHTML=t.html,e.addEventListener("click",()=>{t.execute()}),this.el.appendChild(e)}),t.appendChild(i),t.appendChild(this.el)}}class But extends Lut{constructor({onZoomIn:t,onZoomOut:e}){super("zoom"),this.onZoomIn=t,this.onZoomOut=e}render(t){this.el=document.createElement("div"),this.el.className="zoom-container";const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/plus.png").dataUrl+'">',i.className="zoom-button",i.onclick=this.onZoomIn;const n=document.createElement("button");n.innerHTML='<img src="'+e.getBlob("assets/icons/hyphen.png").dataUrl+'">',n.className="zoom-button",n.onclick=this.onZoomOut,this.el.appendChild(i),this.el.appendChild(n),t.appendChild(this.el)}}class Nut extends Lut{constructor({scene:t,onClickMe:e,onClickPeople:i}){super("acc"),this.onClickMe=e,this.onClickPeople=i,this.scene=t,this.peopleVisible=!1}render(t){this.el=document.createElement("div"),this.el.className="acc-container";const i=document.createElement("button");i.innerHTML='<img src="'+e.getBlob("assets/icons/Person.png").dataUrl+'">',i.className="acc-button",i.onclick=this.onClickMe;const n=document.createElement("button");n.innerHTML='<img src="'+e.getBlob("assets/icons/people.png").dataUrl+'">',n.className="acc-button",n.onclick=()=>this.togglePeople(),this.peopleContainer=document.createElement("div"),this.peopleContainer.className="people-container",this.peopleContainer.style.display="none";const s=document.createElement("div");s.innerHTML='<div class="header-brand"><img src=\''+e.getBlob("assets/icons/people.png").dataUrl+"'>People</div><button class=\"header-button\"><img src='"+e.getBlob("assets/icons/friends.png").dataUrl+"'></button>",s.className="people-header",s.querySelector("button").addEventListener("click",()=>{this.scene.inputManager.peopleModal.toggle()}),this.peopleList=document.createElement("ul"),this.peopleList.className="people-list",this.peopleContainer.appendChild(s),this.peopleContainer.appendChild(this.peopleList),this.el.appendChild(i),this.el.appendChild(n),t.appendChild(this.el),t.appendChild(this.peopleContainer)}togglePeople(){if(this.peopleVisible=!this.peopleVisible,this.peopleContainer.style.display=this.peopleVisible?"block":"none",this.peopleVisible){const t=this.scene.networkManager.players;t!={}?(this.peopleList.innerHTML="",Object.values(t).forEach(t=>{const e=document.createElement("li"),i=document.createElement("div");i.className="people-user-header";const n=document.createElement("img");n.src=t.avatar||"logo.png";const s=document.createElement("p");s.innerText=t.display_name+(t.id==this.scene.player.id?" (you)":"");const r=document.createElement("p");r.className="accent",r.innerText="@"+t.username,i.appendChild(n),i.appendChild(s),e.appendChild(i),e.appendChild(r),this.peopleList.appendChild(e)})):this.peopleList.innerHTML="<small class='accent'>There are no people nearby.</small>"}}}class zut{constructor(t,{components:e=[]}){this.container=document.createElement("div"),this.container.id="game-hud",this.container.style.display="none",Object.assign(this.container.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"});const i=document.createElement("p");i.innerText="FPS: 0",i.id="fps-text",this.container.appendChild(i),"static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(this.container),this.components=e.map(t=>{const e=new(0,t.type)(t.options||{});return e.render(this.container),e})}getComponent(t){return this.components.find(e=>e.name===t)}}class Uut{constructor(t,e,i=null,n={showHeader:!0}){this.scene=i,this.overlay=document.createElement("div"),this.overlay.className="modal-overlay",this.modal=document.createElement("div"),this.modal.className="modal-container";const s=document.createElement("div");s.className="modal-header";const r=document.createElement("p");r.textContent=e,s.appendChild(r),this.closeBtn=document.createElement("button"),this.closeBtn.className="modal-close",this.closeBtn.innerHTML="&times;",this.closeBtn.addEventListener("click",()=>this.toggle()),s.appendChild(this.closeBtn),this.body=document.createElement("div"),this.body.className="modal-body",n.showHeader?this.modal.append(s,this.body):this.modal.append(this.body),this.overlay.appendChild(this.modal),t.appendChild(this.overlay),this.isOpen=!1}toggle(){this.isOpen=!this.isOpen,this.overlay.style.display=this.isOpen?"flex":"none",this.scene&&this.scene.inputManager.joystickModalEnable(this.isOpen)}}class Yut extends Uut{constructor(t,e){super(t,"Options",e,{showHeader:!1}),this.categories=this._groupByCategory(),this._categoriesInfo={general:{icon:"assets/icons/generalinfo.png",name:"General"},render:{icon:"assets/icons/bright.png",name:"Render"},development:{icon:"assets/icons/control.png",name:"Development"}},this._originalValues={},this._buildTabs(),this._buildForms(),this._bindEvents(),this.scene=e}_groupByCategory(){const t={};for(const[e,i]of Object.entries(Fut.schema)){if("development"==i.category&&!this.scene.dev)continue;const n=i.category||"general";t[n]||(t[n]=[]),t[n].push({name:e,cfg:i})}return t}_buildTabs(){this.tabNav=document.createElement("ul"),this.tabNav.className="options-tabs",Object.keys(this.categories).forEach((t,e)=>{const i=document.createElement("li");i.innerHTML="<img src='"+this._categoriesInfo[t]?.icon+"'>",i.dataset.tab=t,0===e&&i.classList.add("active"),this.tabNav.append(i)}),this.body.append(this.tabNav)}_buildForms(){this.forms={},Object.entries(this.categories).forEach(([t,e],i)=>{const n=document.createElement("form");n.className="options-form",0!==i&&(n.style.display="none"),n.dataset.cat=t,e.forEach(({name:t,cfg:e})=>{const i=document.createElement("div");i.className="option-item";const s=document.createElement("label");let r;s.htmlFor=t,s.innerHTML=`${e.name}<br><span>${e.desc}</span>`,s.className="option-label",i.append(s);const a=Fut.get(t);switch(e.type){case"string":case"number":r=document.createElement("input"),r.type="string"===e.type?"text":"number",void 0!==e.min&&(r.min=e.min),void 0!==e.max&&(r.max=e.max),void 0!==e.minLength&&(r.minLength=e.minLength),void 0!==e.maxLength&&(r.maxLength=e.maxLength),r.value=a;break;case"boolean":r=document.createElement("div");const t=document.createElement("input");t.type="checkbox",t.className="ikxBAC",t.checked=a,r.appendChild(t),i.className="option-item-checkbox";break;case"select":r=document.createElement("select"),e.options.forEach(t=>{const e=document.createElement("option");e.value=t,e.innerText=t,t===a&&(e.selected=!0),r.append(e)});break;case"array":r=document.createElement("textarea"),r.value=JSON.stringify(a);break;case"object":r=document.createElement("textarea"),r.value=JSON.stringify(a,null,2)}r.id=t,i.append(r),n.append(i)}),this.forms[t]=n,this.body.append(n)});const t=document.createElement("div");t.className="options-footer";const e=document.createElement("button");e.type="button",e.textContent="Save",e.className="button-save button-green",e.disabled=!0;const i=document.createElement("button");i.type="button",i.textContent="Cancel",i.className="button-cancel button-gray",t.appendChild(e),t.appendChild(i),this.body.append(t),this._btnSave=e,this._btnCancel=i}toggle(){super.toggle(),this.visible&&(this._captureOriginalValues(),this._setSaveDisabled(!0))}_captureOriginalValues(){this._originalValues={};for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Fut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;if("object"===i.type||"array"===i.type)try{this._originalValues[t]=JSON.parse(JSON.stringify(n))}catch{this._originalValues[t]=n}else this._originalValues[t]=n}}_setSaveDisabled(t){this._btnSave.disabled=t}_bindEvents(){this.tabNav.addEventListener("click",t=>{if("LI"!==t.target.tagName)return;const e=t.target.dataset.tab;[...this.tabNav.children].forEach(t=>t.classList.toggle("active",t.dataset.tab===e)),Object.values(this.forms).forEach(t=>{t.style.display=t.dataset.cat===e?"":"none"})}),this._btnCancel.addEventListener("click",()=>{this._restoreOriginalValues(),this.toggle()}),this._btnSave.addEventListener("click",()=>{try{for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Fut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else n="number"===i.type?""===e.value?null:Number(e.value):"array"===i.type||"object"===i.type?JSON.parse(e.value||("array"===i.type?"[]":"{}")):e.value;Fut.put(t,n)}this._captureOriginalValues(),this._setSaveDisabled(!0),this.toggle()}catch(t){console.error(t),alert(t.message)}});for(const t of Object.values(this.forms))t.addEventListener("input",()=>this._checkForModifications()),t.addEventListener("change",()=>this._checkForModifications())}_checkForModifications(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Fut.schema[t];let n;if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");n=!(!t||!t.checked)}else if("number"===i.type)n=""===e.value?null:Number(e.value);else if("array"===i.type||"object"===i.type)try{n=JSON.parse(e.value||("array"===i.type?"[]":"{}"))}catch{n=e.value}else n=e.value;if(!((t,e)=>{try{return JSON.stringify(t)===JSON.stringify(e)}catch{return t===e}})(n,this._originalValues[t]))return void this._setSaveDisabled(!1)}this._setSaveDisabled(!0)}_restoreOriginalValues(){for(const t of Object.values(this.forms))for(const e of t.querySelectorAll("[id]")){const t=e.id;if(!t)continue;const i=Fut.schema[t],n=this._originalValues[t];if("boolean"===i.type){const t=e.querySelector("input[type=checkbox]");t&&(t.checked=!!n)}else if("number"===i.type)e.value=null==n?"":String(n);else if("array"===i.type||"object"===i.type)try{e.value=JSON.stringify(n,null,"object"===i.type?2:0)}catch{e.value=n}else e.value=void 0===n?"":String(n)}this._setSaveDisabled(!0)}}const Xut=`\n<div class="auth" id="people-container">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/people.png").dataUrl}"></canv-icon>People</h3>\n  <span class="description">Search friends and manage friend requests.</span>\n          <div class="friends-actions">\n            <button id="refreshBtn" class="friends-ghost">Refresh</button>\n            <button id="closeBtn" class="friends-ghost" style="display:none">Close</button>\n          </div>\n</div>\n<hr>\n    <aside class="friends-sidebar mini">\n      <div class="friends-card" style="padding-bottom:10px">\n        <div style="margin-top:10px">\n          <div class="small" style="color:rgba(255,255,255,0.7)">Search friends by username</div>\n          <div class="friends-send-row">\n            <input id="searchUsername" class="friends-input" placeholder="Search username..." />\n            <button id="searchBtn" class="friends-primary">Search</button>\n          </div>\n          <div id="searchResult" class="friends-empty" style="margin-top:8px"></div>\n        </div>\n      </div>\n\n      <div class="friends-card">\n        <div id="accountInfo" style="margin-top:8px;color:rgba(255,255,255,0.8)"></div>\n      </div>\n    </aside>\n\n    <section>\n      <div id="incomingSection" class="friends-card" style="margin-bottom:16px">\n        <h4 style="margin:0 0 12px 0;color:rgba(255,255,255,0.9)">Incoming Requests</h4>\n        <div id="incomingPanel"></div>\n      </div>\n\n      <div class="friends-card">\n        <h4 style="margin:0 0 12px 0;color:rgba(255,255,255,0.9)">Friends</h4>\n        <div id="friendsPanel"></div>\n        <div id="friendsPagination" style="margin-top:12px;display:flex;justify-content:center;gap:8px;align-items:center"></div>\n      </div>\n    </section>\n    </div>\n`;function Gut(t,e=!1,r=!1){if((t||document.getElementById("app")).innerHTML=Xut,e){const t=document.getElementById("people-container");t&&(t.style.margin="0 0")}if(r){const t=document.getElementById("closeBtn");t&&(t.style.display="inline-block",t.addEventListener("click",()=>{"function"==typeof window.renderGame&&window.renderGame()}))}const a=n(),o=document.getElementById("accountInfo");a.username&&a.password?o.innerHTML=`<div><strong>@${i(a.username)}</strong></div><div class="accent small">Your username</div>`:o.innerText="Not authenticated. Please log in.";let h=[],l=1;async function u(){if(document.getElementById("friendsPanel").innerHTML='<div class="friends-empty">Loading friends...</div>',document.getElementById("incomingPanel").innerHTML='<div class="friends-empty">Loading incoming...</div>',!a.username||!a.password)return t="Not authenticated. Please log in.",document.getElementById("friendsPanel").innerHTML=`<div class="friends-empty">${i(t)}</div>`,void(document.getElementById("incomingPanel").innerHTML=`<div class="friends-empty">${i(t)}</div>`);var t;const[e,n,r]=await Promise.allSettled([s("/api/friends/list",a),s("/api/friends/requests",a),s("/api/friends/pending",a)]),o="fulfilled"===e.status&&e.value&&e.value.friends?e.value.friends:[];"fulfilled"===n.status&&n.value&&n.value;const u="fulfilled"===r.status&&r.value?r.value:null;let f=[];u&&(Array.isArray(u.incoming)?f=u.incoming:Array.isArray(u.pending)&&(f=u.pending)),h=o,l=1,async function(t){const e=document.getElementById("incomingPanel");if(e.innerHTML="",Array.isArray(t)&&t.length)for(const i of t)e.append(await p(i));else e.append(d("No incoming requests."))}(f),c()}function c(){const t=document.getElementById("friendsPanel"),e=document.getElementById("friendsPagination");if(t.innerHTML="",e.innerHTML="",!Array.isArray(h)||!h.length)return void t.append(d("No friends yet."));const n=Math.ceil(h.length/10),r=10*(l-1),o=r+10;if(h.slice(r,o).forEach(e=>t.append(function(t){const e=document.createElement("div");e.className="friends-row";const n=document.createElement("div");n.innerHTML=`<div class="friends-name">${i(t.display_name||t.username||"Unnamed")}</div><div class="friends-meta">@${i(t.username)} Â· ID ${i(String(t.id))}</div>`;const r=document.createElement("div");r.className="friends-controls";const o=document.createElement("button");return o.className="friends-ghost",o.textContent="Remove",o.addEventListener("click",async()=>{await async function(t){t&&(await s("/api/friends/remove",{...a,friendUsername:t}),await u())}(t.username)}),r.appendChild(o),e.appendChild(n),e.appendChild(r),e}(e))),n>1){const t=document.createElement("button");t.className="friends-ghost",t.textContent="Previous",t.disabled=1===l,t.addEventListener("click",()=>{l--,c()});const i=document.createElement("span");i.style.color="rgba(255,255,255,0.7)",i.textContent=`Page ${l} of ${n}`;const s=document.createElement("button");s.className="friends-ghost",s.textContent="Next",s.disabled=l===n,s.addEventListener("click",()=>{l++,c()}),e.appendChild(t),e.appendChild(i),e.appendChild(s)}}function d(t){const e=document.createElement("div");return e.className="friends-empty",e.textContent=t,e}async function p(t){const e=document.createElement("div");e.className="friends-row";const n=document.createElement("div"),r=t.requesterId,o=(await s("/api/auth/profile",{id:r})).username||"Unknown";n.innerHTML=`<div class="friends-name">From ${i(String(o))}</div><div class="friends-meta">Request ID: ${i(String(t.id||""))}</div>`;const h=document.createElement("div");h.className="friends-controls";const l=document.createElement("button");l.className="friends-primary",l.textContent="Accept";const c=document.createElement("button");return c.className="friends-ghost",c.textContent="Deny",l.addEventListener("click",async()=>{await async function(t){t&&(await s("/api/friends/accept",{...a,requestId:t}),await u())}(t.id)}),c.addEventListener("click",async()=>{await async function(t){t&&(await s("/api/friends/deny",{...a,requestId:t}),await u())}(t.id)}),h.appendChild(l),h.appendChild(c),e.appendChild(n),e.appendChild(h),e}async function g(t){const e=document.getElementById("searchResult");if(t){e.innerHTML='<div class="friends-empty">Searching...</div>';try{const n=await s("/api/auth/profile",{username:t});if(!n||!n.username)return void(e.innerHTML='<div class="friends-empty">User not found.</div>');h.some(t=>t.username===n.username)?e.innerHTML=`\n          <div class="friends-row">\n            <div>\n              <div class="friends-name">${i(n.display_name||n.username)}</div>\n              <div class="friends-meta">@${i(n.username)} Â· Already a friend</div>\n            </div>\n          </div>\n        `:(e.innerHTML=`\n          <div class="friends-row">\n            <div>\n              <div class="friends-name">${i(n.display_name||n.username)}</div>\n              <div class="friends-meta">@${i(n.username)}</div>\n            </div>\n            <div class="friends-controls">\n              <button id="sendRequestBtn" class="friends-primary">Send Request</button>\n            </div>\n          </div>\n        `,document.getElementById("sendRequestBtn").addEventListener("click",async()=>{await async function(t){if(!t)return alert("Enter a username.");const e={...a,targetUsername:t},i=await s(f,e),n=i&&(i.error||i.message||JSON.stringify(i));document.getElementById("searchResult").innerText=n||"Sent",await u()}(n.username),e.innerHTML='<div class="friends-empty">Request sent!</div>'}))}catch(t){e.innerHTML='<div class="friends-empty">Error searching user.</div>'}}else e.innerHTML=""}document.getElementById("searchBtn").addEventListener("click",async()=>{const t=document.getElementById("searchUsername").value.trim();await g(t)}),document.getElementById("searchUsername").addEventListener("keypress",async t=>{if("Enter"===t.key){const t=document.getElementById("searchUsername").value.trim();await g(t)}}),document.getElementById("refreshBtn").addEventListener("click",u),u()}var Hut,Wut,Vut,jut=Object.freeze({__proto__:null,options:{title:"People",auth:!0,description:"Manage friends, and send game invites."},html:Xut,render:Gut});class qut extends Uut{constructor(t,e){super(t,"People",e,{showHeader:!1}),this.scene=e,this.body.innerHTML=Xut,Gut(this.body,!0,!0),this.body.querySelector("#closeBtn").addEventListener("click",t=>{this.toggle()})}toggle(){super.toggle()}}class Kut extends Uut{constructor(t,e){super(t,"Player Info",e),this.currentPlayer=null,this.currentUserData=null}async showPlayer(t,e){this.currentPlayer=t,this.currentUserData=e;const i=n();try{const e=await s("/api/auth/profile",{username:i.username});if(e&&e.id===t)return}catch(t){console.error("Error checking current user:",t)}let r=null;this.body.innerHTML='<div style="padding: 20px; text-align: center; color: rgba(255,255,255,0.7);">Loading player information...</div>',this.toggle();try{r=await s("/api/auth/profile",{username:e.username})}catch(t){console.error("Error fetching player profile:",t)}if(!r||!1===r.valid)return void(this.body.innerHTML='<div style="padding: 20px; text-align: center; color: #f44336;">Error loading player information</div>');console.log(r);const a=await this.checkIfModerator(i.username);this.renderPlayerInfo(r,e,i,a)}async checkIfModerator(t){try{const t=n(),e=await fetch(`/api/auth/roles?username=${encodeURIComponent(t.username)}&password=${encodeURIComponent(t.password)}`),i=await e.json();return!(i.error||!i.roles)&&(i.roles.includes("moderator")||i.roles.includes("admin")||i.roles.includes("superadmin"))}catch(t){return!1}}renderPlayerInfo(t,e,n,s){const r=i(t.display_name||t.username||"Unknown"),a=i(t.username||"unknown"),o=i(t.bio||"This player has not set a bio yet."),h=t.avatar||t.game?.avatar||e?.avatar||"",l=t.id||"N/A";this.body.innerHTML=`\n            <div class="player-info-container">\n                <div class="player-info-header">\n                    ${h?`<img src="${h}" class="player-info-avatar" alt="Avatar" />`:'<div class="player-info-avatar-placeholder"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div>'}\n                    <div class="player-info-details">\n                        <h2 class="player-info-name">${r}</h2>\n                        <p class="player-info-username">@${a}</p>\n                        <p class="player-info-id">ID: ${i(l)}</p>\n                        ${t.roles&&t.roles.length>0?`\n                            <div class="player-info-roles">\n                                ${t.roles.map(t=>`<span class="player-role-badge ${t}">${i(t)}</span>`).join("")}\n                            </div>\n                        `:""}\n                    </div>\n                </div>\n                \n                <div class="player-info-section">\n                    <h3>About</h3>\n                    <p class="player-bio-text">${o}</p>\n                </div>\n\n                <div class="player-info-section">\n                    <div class="player-action-buttons">\n                        <button id="sendFriendRequestBtn" class="player-action-btn primary">\n                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>\n                                <circle cx="8.5" cy="7" r="4"></circle>\n                                <line x1="20" y1="8" x2="20" y2="14"></line>\n                                <line x1="23" y1="11" x2="17" y2="11"></line>\n                            </svg>\n                            Send Friend Request\n                        </button>\n                    </div>\n                </div>\n\n                ${s?'\n                    <div class="player-info-section player-info-moderation">\n                        <div class="player-action-buttons moderation">\n                            <button id="timeoutPlayerBtn" class="player-action-btn warning">\n                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                    <circle cx="12" cy="12" r="10"></circle>\n                                    <polyline points="12 6 12 12 16 14"></polyline>\n                                </svg>\n                                Timeout (Mute)\n                            </button>\n                            \n                            <button id="banPlayerBtn" class="player-action-btn danger">\n                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                    <circle cx="12" cy="12" r="10"></circle>\n                                    <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>\n                                </svg>\n                                Ban Player\n                            </button>\n\n                            <button id="kickPlayerBtn" class="player-action-btn warning">\n                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>\n                                    <circle cx="8.5" cy="7" r="4"></circle>\n                                    <line x1="18" y1="8" x2="23" y2="13"></line>\n                                    <line x1="23" y1="8" x2="18" y2="13"></line>\n                                </svg>\n                                Kick\n                            </button>\n                        </div>\n                    </div>\n                ':""}\n\n                <div id="actionResult" class="player-action-result"></div>\n            </div>\n        `,this.addStyles(),this.attachEventListeners(t,n,s)}addStyles(){if(document.getElementById("player-info-modal-styles"))return;const t=document.createElement("style");t.id="player-info-modal-styles",t.textContent="\n            .player-info-container {\n                padding: 20px;\n                color: rgba(255, 255, 255, 0.9);\n            }\n\n            .player-info-header {\n                display: flex;\n                align-items: center;\n                gap: 20px;\n                margin-bottom: 24px;\n                padding-bottom: 20px;\n                border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n            }\n\n            .player-info-avatar {\n                width: 80px;\n                height: 80px;\n                border-radius: 8px;\n                object-fit: cover;\n                border: 2px solid rgba(255, 255, 255, 0.2);\n            }\n\n            .player-info-details {\n                flex: 1;\n            }\n\n            .player-info-name {\n                margin: 0 0 8px 0;\n                font-size: 24px;\n                color: #fff;\n            }\n\n            .player-info-username {\n                margin: 0 0 4px 0;\n                color: rgba(255, 255, 255, 0.6);\n                font-size: 14px;\n            }\n\n            .player-info-id {\n                margin: 0 0 8px 0;\n                color: rgba(255, 255, 255, 0.4);\n                font-size: 12px;\n                font-family: monospace;\n            }\n\n            .player-info-avatar-placeholder {\n                width: 80px;\n                height: 80px;\n                border-radius: 8px;\n                background: rgba(255, 255, 255, 0.05);\n                border: 2px solid rgba(255, 255, 255, 0.1);\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: rgba(255, 255, 255, 0.3);\n            }\n\n            .player-info-roles {\n                display: flex;\n                gap: 8px;\n                flex-wrap: wrap;\n            }\n\n            .player-role-badge {\n                padding: 4px 12px;\n                border-radius: 12px;\n                font-size: 12px;\n                font-weight: bold;\n                text-transform: uppercase;\n            }\n\n            .player-role-badge.player {\n                background: rgba(74, 158, 255, 0.2);\n                color: #4a9eff;\n            }\n\n            .player-role-badge.moderator {\n                background: rgba(255, 193, 7, 0.2);\n                color: #ffc107;\n            }\n\n            .player-role-badge.admin {\n                background: rgba(156, 39, 176, 0.2);\n                color: #9c27b0;\n            }\n\n            .player-role-badge.superadmin {\n                background: rgba(244, 67, 54, 0.2);\n                color: #f44336;\n            }\n\n            .player-info-section {\n                margin-bottom: 24px;\n                padding: 16px;\n                background: rgba(255, 255, 255, 0.03);\n                border-radius: 8px;\n                border: 1px solid rgba(255, 255, 255, 0.08);\n            }\n\n            .player-info-section h3 {\n                margin: 0 0 12px 0;\n                font-size: 16px;\n                color: rgba(255, 255, 255, 0.9);\n                font-weight: 600;\n            }\n\n            .player-bio-text {\n                margin: 0;\n                line-height: 1.8;\n                color: rgba(255, 255, 255, 0.7);\n                font-style: italic;\n                white-space: pre-wrap;\n                word-wrap: break-word;\n            }\n\n            .player-stats-grid {\n                display: grid;\n                gap: 12px;\n            }\n\n            .stat-item {\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 8px 12px;\n                background: rgba(0, 0, 0, 0.2);\n                border-radius: 6px;\n            }\n\n            .stat-label {\n                color: rgba(255, 255, 255, 0.6);\n                font-size: 13px;\n            }\n\n            .stat-value {\n                color: rgba(74, 158, 255, 0.9);\n                font-weight: 600;\n                font-size: 13px;\n                font-family: monospace;\n            }\n\n            .player-info-actions {\n                padding: 0;\n                background: transparent;\n                border: none;\n            }\n\n            .player-info-actions h3,\n            .player-info-moderation h3 {\n                margin: 0 0 12px 0;\n                font-size: 16px;\n                color: rgba(255, 255, 255, 0.9);\n                font-weight: 600;\n            }\n            \n            .player-info-moderation {\n                padding: 16px;\n                background: rgba(255, 193, 7, 0.05);\n                border: 1px solid rgba(255, 193, 7, 0.2);\n            }\n\n            .player-action-buttons {\n                display: flex;\n                flex-direction: column;\n                gap: 12px;\n            }\n\n            .player-action-buttons.moderation {\n                margin-top: 12px;\n            }\n\n            .player-action-btn {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                padding: 12px 16px;\n                background: rgba(255, 255, 255, 0.1);\n                border: 1px solid rgba(255, 255, 255, 0.2);\n                border-radius: 6px;\n                color: #fff;\n                font-size: 14px;\n                cursor: pointer;\n                transition: all 0.2s;\n            }\n\n            .player-action-btn:hover {\n                background: rgba(255, 255, 255, 0.15);\n                transform: translateY(-1px);\n            }\n\n            .player-action-btn.primary {\n                background: rgba(74, 158, 255, 0.2);\n                border-color: #4a9eff;\n            }\n\n            .player-action-btn.primary:hover {\n                background: rgba(74, 158, 255, 0.3);\n            }\n\n            .player-action-btn.warning {\n                background: rgba(255, 193, 7, 0.2);\n                border-color: #ffc107;\n            }\n\n            .player-action-btn.warning:hover {\n                background: rgba(255, 193, 7, 0.3);\n            }\n\n            .player-action-btn.danger {\n                background: rgba(244, 67, 54, 0.2);\n                border-color: #f44336;\n            }\n\n            .player-action-btn.danger:hover {\n                background: rgba(244, 67, 54, 0.3);\n            }\n\n            .player-action-result {\n                margin-top: 16px;\n                padding: 12px;\n                border-radius: 6px;\n                font-size: 14px;\n                display: none;\n            }\n\n            .player-action-result.success {\n                display: block;\n                background: rgba(76, 175, 80, 0.2);\n                border: 1px solid #4caf50;\n                color: #4caf50;\n            }\n\n            .player-action-result.error {\n                display: block;\n                background: rgba(244, 67, 54, 0.2);\n                border: 1px solid #f44336;\n                color: #f44336;\n            }\n        ",document.head.appendChild(t)}attachEventListeners(t,e,i){const n=document.getElementById("sendFriendRequestBtn"),r=document.getElementById("actionResult"),a=()=>!!(e&&e.username&&e.password)||(this.showResult(r,"You must be logged in to perform this action","error"),!1);if(n&&n.addEventListener("click",async()=>{if(a())try{const i=await s(f,{...e,targetUsername:t.username});i.error?this.showResult(r,i.error,"error"):this.showResult(r,i.message||"Friend request sent!","success")}catch(t){this.showResult(r,t.error||t.message||"Error sending friend request","error")}}),i){const i=document.getElementById("timeoutPlayerBtn"),n=document.getElementById("banPlayerBtn"),o=document.getElementById("kickPlayerBtn");i&&i.addEventListener("click",async()=>{if(!a())return;const i=prompt("Enter timeout reason:")||"No reason provided",n=prompt("Enter duration (5min, 1hour, 1day):","5min")||"5min";try{const a=await s("/api/moderation/timeout",{...e,targetId:t.id,duration:n,reason:i});a.success?this.showResult(r,`Player timed out for ${n}`,"success"):this.showResult(r,a.error||"Error timing out player","error")}catch(t){this.showResult(r,t.message||"Error timing out player","error")}}),n&&n.addEventListener("click",async()=>{if(!a())return;const i=prompt("Enter ban reason:")||"No reason provided";if(window.confirm(`Are you sure you want to PERMANENTLY ban ${t.username}?\n\nReason: ${i}`))try{const n=await s("/api/moderation/ban",{...e,targetId:t.id,reason:i});n.success?this.showResult(r,"Player banned successfully","success"):this.showResult(r,n.error||"Error banning player","error")}catch(t){this.showResult(r,t.message||"Error banning player","error")}}),o&&o.addEventListener("click",async()=>{if(a()&&window.confirm(`Are you sure you want to kick ${t.username} from the server?`))try{const i=await s("/api/moderation/kick",{...e,targetId:t.id});i.success?this.showResult(r,"Player kicked successfully","success"):this.showResult(r,i.error||"Error kicking player","error")}catch(t){this.showResult(r,t.message||"Error kicking player","error")}})}}showResult(t,e,i){t.textContent=e,t.className=`player-action-result ${i}`}}class Zut{static _nextId=1;static textureCache=new Map;constructor(t,e,i,n,s,r,a,o=0){this.id=Zut._nextId++,this.scene=t,this.width=r,this.height=a,this.zoffset=o,this.x=e,this.y=i,this.isOverlapping=!1,this._textureKey=this._getCachedTexture(n,s,r,a),this.image=t.add.image(e,i,this._textureKey).setOrigin(0,0).setDepth(this._calculateDepth(i)),this._setupPhysics(),this.image.setData("id",this.id),this.image.setData("mapObject",this)}_getCachedTexture(t,e,i,n){const s=Zut.textureCache,r=`${t}|${e.u},${e.v}|${i}x${n}`;let a=s.get(r);if(a)a.refCount++;else{const o=`crop-${t}-${e.u}-${e.v}-${i}x${n}`;this.scene.textures.exists(o)||this._createCroppedTexture(t,e,i,n,o),a={key:o,refCount:1},s.set(r,a)}return this._cacheKey=r,a.key}_createCroppedTexture(t,e,i,n,s){const r=this.scene.textures.get(t).getSourceImage();this.scene.textures.createCanvas(s,i,n);const a=this.scene.textures.get(s);a.getSourceImage().getContext("2d").drawImage(r,e.u,e.v,i,n,0,0,i,n),a.refresh()}_setupPhysics(){this.scene.physics.add.existing(this.image),this.image.body.setSize(0,0).setBounce(0,0).setCollideWorldBounds(!0).setImmovable(!0)}_calculateDepth(t){return t+this.height-this.zoffset}update(t,e){this.image.setDepth(this._calculateDepth(this.image.y))}setPosition(t,e){this.x=t,this.y=e,this.image.setPosition(t,e),this.image.setDepth(this._calculateDepth(e))}destroy(){if(this._cacheKey){const t=Zut.textureCache.get(this._cacheKey);t&&(t.refCount--,t.refCount<=0&&(Zut.textureCache.delete(this._cacheKey),this.scene.textures.exists(t.key)&&this.scene.textures.remove(t.key)))}this.image&&(this.image.body&&this.scene.physics.world.disableBody(this.image.body),this.image.destroy(),this.image=null)}}class $ut extends Zut{static texture="plants";static types=[{name:"1",uvStartPx:{u:19,v:76},widthPx:65,heightPx:108,zoffset:8,collision:{startx:25,starty:97,width:6,height:11}},{name:"2",uvStartPx:{u:104,v:59},widthPx:87,heightPx:124,zoffset:7,collision:{startx:35,starty:115,width:8,height:9}},{name:"3",uvStartPx:{u:196,v:42},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"4",uvStartPx:{u:319,v:21},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"5",uvStartPx:{u:445,v:5},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}},{name:"6",uvStartPx:{u:19,v:271},widthPx:65,heightPx:108,zoffset:10,collision:{startx:25,starty:97,width:6,height:11}},{name:"7",uvStartPx:{u:104,v:254},widthPx:87,heightPx:124,zoffset:8,collision:{startx:35,starty:115,width:8,height:9}},{name:"8",uvStartPx:{u:196,v:237},widthPx:96,heightPx:141,zoffset:10,collision:{startx:39,starty:127,width:11,height:13}},{name:"9",uvStartPx:{u:319,v:216},widthPx:112,heightPx:162,zoffset:10,collision:{startx:43,starty:147,width:12,height:15}},{name:"10",uvStartPx:{u:445,v:200},widthPx:117,heightPx:180,zoffset:10,collision:{startx:46,starty:163,width:13,height:15}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt($ut.types.length),r=$ut.types[s];super(t,e,i,$ut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Jut extends Zut{static texture="props";static types=[{name:"1",uvStartPx:{u:683,v:1994},widthPx:14,heightPx:13,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"2",uvStartPx:{u:681,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"3",uvStartPx:{u:715,v:1994},widthPx:14,heightPx:13,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"4",uvStartPx:{u:713,v:2026},widthPx:16,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"5",uvStartPx:{u:740,v:1991},widthPx:22,heightPx:19,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"6",uvStartPx:{u:739,v:2028},widthPx:22,heightPx:12,zoffset:4,collision:{startx:0,starty:4,width:12,height:6}},{name:"7",uvStartPx:{u:770,v:1990},widthPx:25,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"8",uvStartPx:{u:771,v:2021},widthPx:27,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"9",uvStartPx:{u:801,v:1991},widthPx:28,heightPx:19,zoffset:5,collision:{startx:0,starty:4,width:12,height:6}},{name:"10",uvStartPx:{u:847,v:1954},widthPx:28,heightPx:28,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"11",uvStartPx:{u:845,v:1990},widthPx:35,heightPx:20,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"12",uvStartPx:{u:848,v:2016},widthPx:33,heightPx:27,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"13",uvStartPx:{u:904,v:1953},widthPx:41,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"14",uvStartPx:{u:909,v:1985},widthPx:36,heightPx:26,zoffset:8,collision:{startx:0,starty:4,width:12,height:6}},{name:"15",uvStartPx:{u:912,v:2016},widthPx:34,heightPx:24,zoffset:6,collision:{startx:0,starty:4,width:12,height:6}},{name:"16",uvStartPx:{u:969,v:1965},widthPx:46,heightPx:36,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}},{name:"17",uvStartPx:{u:965,v:2016},widthPx:55,heightPx:30,zoffset:9,collision:{startx:0,starty:4,width:12,height:6}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Jut.types.length),r=Jut.types[s];super(t,e,i,Jut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class Qut extends Zut{static texture="props";static types=[{name:"1",uvStartPx:{u:96,v:18},widthPx:39,heightPx:46,zoffset:20,collision:{startx:0,starty:26,width:32,height:20}},{name:"2",uvStartPx:{u:163,v:22},widthPx:31,heightPx:39,zoffset:10,collision:{startx:0,starty:25,width:26,height:14}},{name:"3",uvStartPx:{u:95,v:81},widthPx:41,heightPx:47,zoffset:20,collision:{startx:0,starty:27,width:32,height:20}},{name:"4",uvStartPx:{u:162,v:85},widthPx:33,heightPx:40,zoffset:10,collision:{startx:0,starty:25,width:26,height:24}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(Qut.types.length),r=Qut.types[s];super(t,e,i,Qut.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class tct extends Zut{static texture="props";static types=[{name:"normal",uvStartPx:{u:225,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"without_cap",uvStartPx:{u:289,v:1114},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_water",uvStartPx:{u:225,v:1178},widthPx:33,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"with_plant",uvStartPx:{u:353,v:1104},widthPx:36,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"with_props",uvStartPx:{u:289,v:1168},widthPx:35,heightPx:48,zoffset:10,collision:{startx:0,starty:28,width:30,height:20}},{name:"sided",uvStartPx:{u:225,v:1242},widthPx:32,heightPx:38,zoffset:10,collision:{startx:0,starty:18,width:30,height:20}},{name:"pile",uvStartPx:{u:290,v:1225},widthPx:62,heightPx:54,zoffset:10,collision:{startx:0,starty:34,width:60,height:20}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(tct.types.length),r=tct.types[s];super(t,e,i,tct.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class ect extends Zut{static texture="props";static type={name:"1",uvStartPx:{u:491,v:1640},widthPx:13,heightPx:17,zoffset:3,collision:{startx:0,starty:11,width:9,height:6}};constructor(t,e,i,n={}){super(t,e,i,ect.texture,ect.type.uvStartPx,ect.type.widthPx,ect.type.heightPx,ect.type.zoffset),this.type=ect.type.name,this.hasCollision=n.used||!1,this._setupLight(e,i),this.hasCollision&&this._setupCollision()}_setupLight(t,e){const i=t+this.width/2,n=e+this.height/2;this.light=this.scene.lightManager.addLight(i,n,160,16775392,.92,1.05)}_setupCollision(){const{startx:t,starty:e,width:i,height:n}=ect.type.collision;this.image.body.setSize(i,n).setOffset(t,e)}setPosition(t,e){super.setPosition(t,e),this.light&&(this.light.x=t+this.width/2,this.light.y=e+this.height/2)}destroy(){this.light&&(this.scene.lightManager.removeLightObj(this.light),this.light=null),super.destroy()}}class ict extends Zut{static texture="props";static types=[{name:"1",uvStartPx:{u:391,v:1676},widthPx:64,heightPx:84,zoffset:9,collision:{startx:0,starty:74,width:17,height:10},lampOffset:{x:35,y:22},lightOffset:{x:39,y:30}},{name:"2",uvStartPx:{u:461,v:1676},widthPx:57,heightPx:84,zoffset:9,collision:{startx:28,starty:74,width:17,height:10},lampOffset:{x:1,y:22},lightOffset:{x:5,y:30}}];static lampUV={uvStartPx:{u:491,v:1640},widthPx:9,heightPx:17};constructor(t,e,i,n=-1){const s=-1!==n?n:t.random.getNextInt(ict.types.length),r=ict.types[s];super(t,e,i,ict.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name,this.typeIndex=s,this._setupCollision(r.collision),this._setupLamp(e,i,r.lampOffset),this._setupLight(e,i,r.lightOffset)}_setupCollision(t){const{startx:e,starty:i,width:n,height:s}=t;this.image.body.setSize(n,s).setOffset(e,i)}_setupLamp(t,e,i){const n=this._getCachedTexture(ict.texture,ict.lampUV.uvStartPx,ict.lampUV.widthPx,ict.lampUV.heightPx);this.lampImage=this.scene.add.image(t+i.x,e+i.y,n).setOrigin(0,0).setDepth(e-1)}_setupLight(t,e,i){this.light=this.scene.lightManager.addLight(t+i.x,e+i.y,200,16774352,.93,1.15)}update(t,e){super.update(t,e),this.lampImage&&this.lampImage.setDepth(this._calculateDepth(this.image.y))}setPosition(t,e){super.setPosition(t,e);const i=ict.types[this.typeIndex];this.lampImage&&(this.lampImage.setPosition(t+i.lampOffset.x,e+i.lampOffset.y),this.lampImage.setDepth(this._calculateDepth(e))),this.light&&(this.light.x=t+i.lightOffset.x,this.light.y=e+i.lightOffset.y)}destroy(){this.lampImage&&(this.lampImage.body&&this.scene.physics.world.disableBody(this.lampImage.body),this.lampImage.destroy(),this.lampImage=null),this.light&&(this.scene.lightManager.removeLightObj(this.light),this.light=null),super.destroy()}}class nct extends Zut{static texture="plants";static types=[{name:"1",uvStartPx:{u:34,v:899},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"2",uvStartPx:{u:93,v:896},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"3",uvStartPx:{u:153,v:887},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"4",uvStartPx:{u:217,v:890},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"5",uvStartPx:{u:293,v:886},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"6",uvStartPx:{u:379,v:886},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"7",uvStartPx:{u:472,v:872},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}},{name:"8",uvStartPx:{u:34,v:963},widthPx:32,heightPx:27,zoffset:10,collision:{startx:0,starty:10,width:25,height:17}},{name:"9",uvStartPx:{u:93,v:960},widthPx:41,heightPx:30,zoffset:12,collision:{startx:0,starty:15,width:36,height:15}},{name:"10",uvStartPx:{u:153,v:951},widthPx:45,heightPx:39,zoffset:13,collision:{startx:0,starty:20,width:40,height:18}},{name:"11",uvStartPx:{u:217,v:954},widthPx:50,heightPx:38,zoffset:15,collision:{startx:0,starty:20,width:44,height:18}},{name:"12",uvStartPx:{u:293,v:950},widthPx:61,heightPx:41,zoffset:15,collision:{startx:0,starty:18,width:57,height:23}},{name:"13",uvStartPx:{u:379,v:950},widthPx:79,heightPx:45,zoffset:16,collision:{startx:0,starty:20,width:71,height:25}},{name:"14",uvStartPx:{u:472,v:936},widthPx:85,heightPx:57,zoffset:18,collision:{startx:0,starty:30,width:80,height:27}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(nct.types.length),r=nct.types[s];super(t,e,i,nct.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class sct extends Zut{static texture="plants";static types=[{name:"cabbage_1",uvStartPx:{u:867,v:646},widthPx:29,heightPx:22,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_2",uvStartPx:{u:931,v:648},widthPx:28,heightPx:19,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"cabbage_3",uvStartPx:{u:999,v:652},widthPx:19,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_1",uvStartPx:{u:861,v:674},widthPx:38,heightPx:28,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_2",uvStartPx:{u:931,v:678},widthPx:31,heightPx:21,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"pumpkin_3",uvStartPx:{u:1e3,v:682},widthPx:18,heightPx:14,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_1",uvStartPx:{u:869,v:707},widthPx:25,heightPx:24,zoffset:5,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_2",uvStartPx:{u:935,v:711},widthPx:20,heightPx:18,zoffset:4,collision:{startx:0,starty:0,width:0,height:0}},{name:"carrot_3",uvStartPx:{u:1e3,v:713},widthPx:16,heightPx:15,zoffset:3,collision:{startx:0,starty:0,width:0,height:0}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(sct.types.length),r=sct.types[s];super(t,e,i,sct.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class rct extends Zut{static texture="building";static type={name:"1",uvStartPx:{u:569,v:425},widthPx:155,heightPx:279,zoffset:10,collision:{startx:0,starty:79,width:142,height:200}};constructor(t,e,i){super(t,e,i,rct.texture,rct.type.uvStartPx,rct.type.widthPx,rct.type.heightPx,rct.type.zoffset),this.type=rct.type.name;const{startx:n,starty:s,width:r,height:a}=rct.type.collision;this.image.body.setSize(r,a),this.image.body.setOffset(n,s)}}class act extends Zut{static texture="props";static types=[{name:"1",uvStartPx:{u:905,v:1728},widthPx:46,heightPx:32,zoffset:9,collision:{startx:0,starty:4,width:46,height:28},lightOffset:{x:23,y:8}}];static FRAME_COUNT=25;static FRAME_DURATION=75;constructor(t,e,i,n=0){const s=act.types[n];super(t,e,i,act.texture,s.uvStartPx,s.widthPx,s.heightPx,s.zoffset),this.type=s.name,this._setupCollision(s.collision),this._setupFire(e,i,s.lightOffset),this.frame=0,this.frameTime=0}_setupCollision(t){const{startx:e,starty:i,width:n,height:s}=t;this.image.body.setSize(n,s).setOffset(e,i)}_setupFire(t,e,i){this.fireImage=this.scene.add.image(t+i.x-15,e+i.y-15,"flame").setOrigin(0,0).setDepth(e-1).setTint(16742144),this.light=this.scene.lightManager.addLight(t+i.x,e+i.y,180,16746564,.95,1.1)}update(t,e){super.update(t,e),this.frameTime+=e,this.frameTime>=act.FRAME_DURATION&&(this.frameTime-=act.FRAME_DURATION,this.frame=(this.frame+1)%act.FRAME_COUNT,this.fireImage.setFrame(this.frame)),this.fireImage.setDepth(this._calculateDepth(this.image.y))}setPosition(t,e){super.setPosition(t,e);const i=act.types[0],n=i.lightOffset.x-15,s=i.lightOffset.y-15;this.fireImage.setPosition(t+n,e+s),this.fireImage.setDepth(this._calculateDepth(e)),this.light&&(this.light.x=t+i.lightOffset.x,this.light.y=e+i.lightOffset.y)}destroy(){this.fireImage&&(this.fireImage.body&&this.scene.physics.world.disableBody(this.fireImage.body),this.fireImage.destroy(),this.fireImage=null),this.light&&(this.scene.lightManager.removeLightObj(this.light),this.light=null),super.destroy()}}class oct extends Zut{static texture="props";static types=[{name:"empty_h",uvStartPx:{u:224,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"empty_v",uvStartPx:{u:261,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"apple_h",uvStartPx:{u:224,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"apple_v",uvStartPx:{u:261,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"lemom_h",uvStartPx:{u:288,v:295},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"lemon_v",uvStartPx:{u:325,v:287},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"pear_h",uvStartPx:{u:288,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"pear_v",uvStartPx:{u:325,v:223},widthPx:25,heightPx:33,zoffset:10,collision:{startx:0,starty:10,width:23,height:23}},{name:"fish_h",uvStartPx:{u:352,v:231},widthPx:34,heightPx:25,zoffset:4,collision:{startx:0,starty:15,width:32,height:10}},{name:"fish_v",uvStartPx:{u:389,v:222},widthPx:25,heightPx:34,zoffset:10,collision:{startx:0,starty:11,width:23,height:23}},{name:"carrot_h",uvStartPx:{u:351,v:291},widthPx:36,heightPx:29,zoffset:4,collision:{startx:0,starty:19,width:33,height:10}},{name:"carrot_v",uvStartPx:{u:389,v:284},widthPx:25,heightPx:36,zoffset:10,collision:{startx:0,starty:13,width:23,height:23}},{name:"cabbage_h",uvStartPx:{u:415,v:290},widthPx:35,heightPx:30,zoffset:4,collision:{startx:0,starty:20,width:32,height:10}},{name:"cabbage_v",uvStartPx:{u:453,v:285},widthPx:25,heightPx:35,zoffset:10,collision:{startx:0,starty:12,width:23,height:23}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(oct.types.length),r=oct.types[s];super(t,e,i,oct.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class hct extends Zut{static texture="props";static types=[{name:"bench_1_h",uvStartPx:{u:537,v:920},widthPx:82,heightPx:40,zoffset:10,collision:{startx:0,starty:10,width:77,height:30}},{name:"bench_1_v_1",uvStartPx:{u:544,v:974},widthPx:34,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_1_v_2",uvStartPx:{u:608,v:974},widthPx:35,heightPx:82,zoffset:20,collision:{startx:4,starty:15,width:22,height:67}},{name:"bench_2_h_1",uvStartPx:{u:742,v:1030},widthPx:84,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:81,height:10}},{name:"bench_2_h_2",uvStartPx:{u:835,v:1030},widthPx:61,heightPx:20,zoffset:9,collision:{startx:0,starty:10,width:58,height:10}},{name:"bench_2_v_1",uvStartPx:{u:712,v:1053},widthPx:19,heightPx:67,zoffset:10,collision:{startx:0,starty:17,width:17,height:50}},{name:"bench_2_v_2",uvStartPx:{u:744,v:1070},widthPx:19,heightPx:50,zoffset:10,collision:{startx:0,starty:10,width:17,height:40}},{name:"table_1_h",uvStartPx:{u:551,v:1075},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_1_v",uvStartPx:{u:652,v:1045},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}},{name:"table_2_h",uvStartPx:{u:551,v:1139},widthPx:85,heightPx:45,zoffset:20,collision:{startx:0,starty:10,width:82,height:35}},{name:"table_2_v",uvStartPx:{u:652,v:1141},widthPx:45,heightPx:75,zoffset:20,collision:{startx:0,starty:10,width:41,height:65}}];constructor(t,e,i,n=-1){const s=-1!=n?n:t.random.getNextInt(hct.types.length),r=hct.types[s];super(t,e,i,hct.texture,r.uvStartPx,r.widthPx,r.heightPx,r.zoffset),this.type=r.name;const{startx:a,starty:o,width:h,height:l}=r.collision;this.image.body.setSize(h,l),this.image.body.setOffset(a,o)}}class lct{static objects=[{name:"Campfire",category:"props",create:(t,e,i,n)=>new act(t,e,i),id:"campfire",getType:()=>act.types?.[0],getTexture:()=>act.texture},{name:"House 1",category:"building",create:(t,e,i,n)=>new rct(t,e,i),id:"house_1",getType:()=>rct.type,getTexture:()=>rct.texture},{name:"Tree Birch 0",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,0),id:"tree_0",getType:()=>$ut.types?.[0],getTexture:()=>$ut.texture},{name:"Tree Birch 1",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,1),id:"tree_1",getType:()=>$ut.types?.[1],getTexture:()=>$ut.texture},{name:"Tree Birch 2",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,2),id:"tree_2",getType:()=>$ut.types?.[2],getTexture:()=>$ut.texture},{name:"Tree Birch 3",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,3),id:"tree_3",getType:()=>$ut.types?.[3],getTexture:()=>$ut.texture},{name:"Tree Birch 4",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,4),id:"tree_4",getType:()=>$ut.types?.[4],getTexture:()=>$ut.texture},{name:"Autumn Tree Birch 0",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,5),id:"tree_5",getType:()=>$ut.types?.[5],getTexture:()=>$ut.texture},{name:"Autumn Tree Birch 1",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,6),id:"tree_6",getType:()=>$ut.types?.[6],getTexture:()=>$ut.texture},{name:"Autumn Tree Birch 2",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,7),id:"tree_7",getType:()=>$ut.types?.[7],getTexture:()=>$ut.texture},{name:"Autumn Tree Birch 3",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,8),id:"tree_8",getType:()=>$ut.types?.[8],getTexture:()=>$ut.texture},{name:"Autumn Tree Birch 4",category:"plants",create:(t,e,i,n)=>new $ut(t,e,i,9),id:"tree_9",getType:()=>$ut.types?.[9],getTexture:()=>$ut.texture},{name:"Rock 0",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,0),id:"rock_0",getType:()=>Jut.types?.[0],getTexture:()=>Jut.texture},{name:"Rock 1",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,1),id:"rock_1",getType:()=>Jut.types?.[1],getTexture:()=>Jut.texture},{name:"Rock 2",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,2),id:"rock_2",getType:()=>Jut.types?.[2],getTexture:()=>Jut.texture},{name:"Rock 3",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,3),id:"rock_3",getType:()=>Jut.types?.[3],getTexture:()=>Jut.texture},{name:"Rock 4",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,4),id:"rock_4",getType:()=>Jut.types?.[4],getTexture:()=>Jut.texture},{name:"Rock 5",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,5),id:"rock_5",getType:()=>Jut.types?.[5],getTexture:()=>Jut.texture},{name:"Rock 6",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,6),id:"rock_6",getType:()=>Jut.types?.[6],getTexture:()=>Jut.texture},{name:"Rock 7",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,7),id:"rock_7",getType:()=>Jut.types?.[7],getTexture:()=>Jut.texture},{name:"Rock 8",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,8),id:"rock_8",getType:()=>Jut.types?.[8],getTexture:()=>Jut.texture},{name:"Rock 9",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,9),id:"rock_9",getType:()=>Jut.types?.[9],getTexture:()=>Jut.texture},{name:"Rock 10",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,10),id:"rock_10",getType:()=>Jut.types?.[10],getTexture:()=>Jut.texture},{name:"Rock 11",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,11),id:"rock_11",getType:()=>Jut.types?.[11],getTexture:()=>Jut.texture},{name:"Rock 12",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,12),id:"rock_12",getType:()=>Jut.types?.[12],getTexture:()=>Jut.texture},{name:"Rock 13",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,13),id:"rock_13",getType:()=>Jut.types?.[13],getTexture:()=>Jut.texture},{name:"Rock 14",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,14),id:"rock_14",getType:()=>Jut.types?.[14],getTexture:()=>Jut.texture},{name:"Rock 15",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,15),id:"rock_15",getType:()=>Jut.types?.[15],getTexture:()=>Jut.texture},{name:"Rock 16",category:"props",create:(t,e,i,n)=>new Jut(t,e,i,16),id:"rock_16",getType:()=>Jut.types?.[16],getTexture:()=>Jut.texture},{name:"WoodBox Large",category:"props",create:(t,e,i,n)=>new Qut(t,e,i,0),id:"woodbox_0",getType:()=>Qut.types?.[0],getTexture:()=>Qut.texture},{name:"WoodBox Small",category:"props",create:(t,e,i,n)=>new Qut(t,e,i,1),id:"woodbox_1",getType:()=>Qut.types?.[1],getTexture:()=>Qut.texture},{name:"Covered WoodBox Large",category:"props",create:(t,e,i,n)=>new Qut(t,e,i,2),id:"woodbox_2",getType:()=>Qut.types?.[2],getTexture:()=>Qut.texture},{name:"Covered WoodBox Small",category:"props",create:(t,e,i,n)=>new Qut(t,e,i,3),id:"woodbox_3",getType:()=>Qut.types?.[3],getTexture:()=>Qut.texture},{name:"Empty Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,0),id:"crate_0",getType:()=>oct.types?.[0],getTexture:()=>oct.texture},{name:"Empty Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,1),id:"crate_1",getType:()=>oct.types?.[1],getTexture:()=>oct.texture},{name:"Apple Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,2),id:"crate_2",getType:()=>oct.types?.[2],getTexture:()=>oct.texture},{name:"Apple Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,3),id:"crate_3",getType:()=>oct.types?.[3],getTexture:()=>oct.texture},{name:"Lemon Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,4),id:"crate_4",getType:()=>oct.types?.[4],getTexture:()=>oct.texture},{name:"Lemon Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,5),id:"crate_5",getType:()=>oct.types?.[5],getTexture:()=>oct.texture},{name:"Pear Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,6),id:"crate_6",getType:()=>oct.types?.[6],getTexture:()=>oct.texture},{name:"Pear Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,7),id:"crate_7",getType:()=>oct.types?.[7],getTexture:()=>oct.texture},{name:"Fish Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,8),id:"crate_8",getType:()=>oct.types?.[8],getTexture:()=>oct.texture},{name:"Fish Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,9),id:"crate_9",getType:()=>oct.types?.[9],getTexture:()=>oct.texture},{name:"Carrot Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,10),id:"crate_10",getType:()=>oct.types?.[10],getTexture:()=>oct.texture},{name:"Carrot Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,11),id:"crate_11",getType:()=>oct.types?.[11],getTexture:()=>oct.texture},{name:"Cabbage Pallet Crate Horizontal",category:"props",create:(t,e,i,n)=>new oct(t,e,i,12),id:"crate_12",getType:()=>oct.types?.[12],getTexture:()=>oct.texture},{name:"Cabbage Pallet Crate Vertical",category:"props",create:(t,e,i,n)=>new oct(t,e,i,13),id:"crate_13",getType:()=>oct.types?.[13],getTexture:()=>oct.texture},{name:"Lamp",category:"props",create:(t,e,i,n)=>new ect(t,e,i,n),id:"lamp",getType:()=>ect.type,getTexture:()=>ect.texture},{name:"Road Lamp Left",category:"props",create:(t,e,i,n)=>new ict(t,e,i,0),id:"roadlamp_left",getType:()=>ict.types?.[0],getTexture:()=>ict.texture},{name:"Road Lamp Right",category:"props",create:(t,e,i,n)=>new ict(t,e,i,1),id:"roadlamp_right",getType:()=>ict.types?.[1],getTexture:()=>ict.texture},{name:"Autumn Bush 0",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,0),id:"bush_0",getType:()=>nct.types?.[0],getTexture:()=>nct.texture},{name:"Autumn Bush 1",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,1),id:"bush_1",getType:()=>nct.types?.[1],getTexture:()=>nct.texture},{name:"Autumn Bush 2",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,2),id:"bush_2",getType:()=>nct.types?.[2],getTexture:()=>nct.texture},{name:"Autumn Bush 3",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,3),id:"bush_3",getType:()=>nct.types?.[3],getTexture:()=>nct.texture},{name:"Autumn Bush 4",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,4),id:"bush_4",getType:()=>nct.types?.[4],getTexture:()=>nct.texture},{name:"Autumn Bush 5",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,5),id:"bush_5",getType:()=>nct.types?.[5],getTexture:()=>nct.texture},{name:"Autumn Bush 6",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,6),id:"bush_6",getType:()=>nct.types?.[6],getTexture:()=>nct.texture},{name:"Bush 0",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,7),id:"bush_7",getType:()=>nct.types?.[7],getTexture:()=>nct.texture},{name:"Bush 1",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,8),id:"bush_8",getType:()=>nct.types?.[8],getTexture:()=>nct.texture},{name:"Bush 2",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,9),id:"bush_9",getType:()=>nct.types?.[9],getTexture:()=>nct.texture},{name:"Bush 3",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,10),id:"bush_10",getType:()=>nct.types?.[10],getTexture:()=>nct.texture},{name:"Bush 4",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,11),id:"bush_11",getType:()=>nct.types?.[11],getTexture:()=>nct.texture},{name:"Bush 5",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,12),id:"bush_12",getType:()=>nct.types?.[12],getTexture:()=>nct.texture},{name:"Bush 6",category:"plants",create:(t,e,i,n)=>new nct(t,e,i,13),id:"bush_13",getType:()=>nct.types?.[13],getTexture:()=>nct.texture},{name:"Large Cabbage",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,0),id:"morenature_0",getType:()=>sct.types?.[0],getTexture:()=>sct.texture},{name:"Medium Cabbage",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,1),id:"morenature_1",getType:()=>sct.types?.[1],getTexture:()=>sct.texture},{name:"Small Cabbage",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,2),id:"morenature_2",getType:()=>sct.types?.[2],getTexture:()=>sct.texture},{name:"Large Pumpkin",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,3),id:"morenature_3",getType:()=>sct.types?.[3],getTexture:()=>sct.texture},{name:"Medium Pumpkin",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,4),id:"morenature_4",getType:()=>sct.types?.[4],getTexture:()=>sct.texture},{name:"Small Pumpkin",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,5),id:"morenature_5",getType:()=>sct.types?.[5],getTexture:()=>sct.texture},{name:"Large Carrot",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,6),id:"morenature_6",getType:()=>sct.types?.[6],getTexture:()=>sct.texture},{name:"Medium Carrot",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,7),id:"morenature_7",getType:()=>sct.types?.[7],getTexture:()=>sct.texture},{name:"Small Carrot",category:"plants",create:(t,e,i,n)=>new sct(t,e,i,8),id:"morenature_8",getType:()=>sct.types?.[8],getTexture:()=>sct.texture},{name:"Barrel",category:"props",create:(t,e,i,n)=>new tct(t,e,i,0),id:"barrel_0",getType:()=>tct.types?.[0],getTexture:()=>tct.texture},{name:"Barrel Without Cap",category:"props",create:(t,e,i,n)=>new tct(t,e,i,1),id:"barrel_1",getType:()=>tct.types?.[1],getTexture:()=>tct.texture},{name:"Barrel With Water",category:"props",create:(t,e,i,n)=>new tct(t,e,i,2),id:"barrel_2",getType:()=>tct.types?.[2],getTexture:()=>tct.texture},{name:"Barrel With Plants",category:"props",create:(t,e,i,n)=>new tct(t,e,i,3),id:"barrel_3",getType:()=>tct.types?.[3],getTexture:()=>tct.texture},{name:"Barrel With Props",category:"props",create:(t,e,i,n)=>new tct(t,e,i,4),id:"barrel_4",getType:()=>tct.types?.[4],getTexture:()=>tct.texture},{name:"Barrel Sided",category:"props",create:(t,e,i,n)=>new tct(t,e,i,5),id:"barrel_5",getType:()=>tct.types?.[5],getTexture:()=>tct.texture},{name:"Barrel Pile",category:"props",create:(t,e,i,n)=>new tct(t,e,i,6),id:"barrel_6",getType:()=>tct.types?.[6],getTexture:()=>tct.texture},{name:"Bench 1 Horizontal",category:"props",create:(t,e,i,n)=>new hct(t,e,i,0),id:"outdoor_0",getType:()=>hct.types?.[0],getTexture:()=>hct.texture},{name:"Bench 1 Vertical 1",category:"props",create:(t,e,i,n)=>new hct(t,e,i,1),id:"outdoor_1",getType:()=>hct.types?.[1],getTexture:()=>hct.texture},{name:"Bench 1 Vertical 2",category:"props",create:(t,e,i,n)=>new hct(t,e,i,2),id:"outdoor_2",getType:()=>hct.types?.[2],getTexture:()=>hct.texture},{name:"Bench 2 Horizontal Large",category:"props",create:(t,e,i,n)=>new hct(t,e,i,3),id:"outdoor_3",getType:()=>hct.types?.[3],getTexture:()=>hct.texture},{name:"Bench 2 Horizontal Small",category:"props",create:(t,e,i,n)=>new hct(t,e,i,4),id:"outdoor_4",getType:()=>hct.types?.[4],getTexture:()=>hct.texture},{name:"Bench 2 Vertical Large",category:"props",create:(t,e,i,n)=>new hct(t,e,i,5),id:"outdoor_5",getType:()=>hct.types?.[5],getTexture:()=>hct.texture},{name:"Bench 2 Vertical Small",category:"props",create:(t,e,i,n)=>new hct(t,e,i,6),id:"outdoor_6",getType:()=>hct.types?.[6],getTexture:()=>hct.texture},{name:"Table 1 Horizontal",category:"props",create:(t,e,i,n)=>new hct(t,e,i,7),id:"outdoor_7",getType:()=>hct.types?.[7],getTexture:()=>hct.texture},{name:"Table 1 Vertical",category:"props",create:(t,e,i,n)=>new hct(t,e,i,8),id:"outdoor_8",getType:()=>hct.types?.[8],getTexture:()=>hct.texture},{name:"Table 2 Horizontal",category:"props",create:(t,e,i,n)=>new hct(t,e,i,9),id:"outdoor_9",getType:()=>hct.types?.[9],getTexture:()=>hct.texture},{name:"Table 2 Vertical",category:"props",create:(t,e,i,n)=>new hct(t,e,i,10),id:"outdoor_10",getType:()=>hct.types?.[10],getTexture:()=>hct.texture}];constructor(t,e=[]){this.scene=t,this.list=e,this.allElementsByChunk=new Map,this.loadedChunks=new Set,this.serverIdIndex=new Map,this.playerChunk=null,this.chunkSize=512}loadJsonMap(t=[]){t.forEach(t=>{if("number"!=typeof t.x||"number"!=typeof t.y||!t.id)return;const e=`${Math.floor(t.x/512)}:${Math.floor(t.y/512)}`;this.allElementsByChunk.has(e)||this.allElementsByChunk.set(e,[]),this.allElementsByChunk.get(e).find(e=>e.options?.serverId&&e.options.serverId===t.options?.serverId)||this.allElementsByChunk.get(e).push(t)})}loadChunksData(t=[]){t.forEach(t=>{t.objects&&Array.isArray(t.objects)&&this.loadJsonMap(t.objects);const[e,i]=t.key.split(/[,:]/).map(Number);this.loadChunkByCoords(e,i)})}unloadChunksData(t=[]){t.forEach(t=>{const[e,i]=t.split(/[,:]/).map(Number);this.unloadChunkByCoords(e,i)})}_chunkKey(t,e){return`${t}:${e}`}create(t,e,i,n,s={}){const r=lct.objects.find(e=>e.id===t);if(!r)throw new Error(`Unknown object id: ${t}`);const a=r.create(e,i,n,s);return a.typeId=t,a.typeOptions=s,a.serverId=s.serverId,a.idBase||(a.idBase=`${t}_${Date.now()}_${Math.floor(1e4*Math.random())}`),this.list.push(a),a.serverId&&this.serverIdIndex.set(a.serverId,a),this.scene.events&&this.scene.events.emit("objectCreated",a),a}exportElements(){return this.list.map(t=>({x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId}}))}exportElement(t){const e=t.image?.body?{width:t.image.body.width,height:t.image.body.height,offsetX:t.image.body.offset?.x||0,offsetY:t.image.body.offset?.y||0}:null;return{x:t.x,y:t.y,id:t.typeId,options:{...t.typeOptions,serverId:t.serverId,collision:e}}}destroy(t){try{const e=this.list.length;for(let i=0;i<e;i++)if(this.list[i].idBase===t.idBase){const t=this.list[i];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(i,1),t.serverId&&this.serverIdIndex.delete(t.serverId);break}}catch(t){}}destroyByServerId(t){try{const e=this.list.length;for(let i=0;i<e;i++)if(this.list[i].serverId==t){const t=this.list[i];if("function"==typeof t.destroy)try{t.destroy()}catch(t){}try{t.image&&"function"==typeof t.image.destroy&&t.image.destroy()}catch(t){}this.list.splice(i,1),t.serverId&&this.serverIdIndex.delete(t.serverId);break}}catch(t){}}moveByServerId(t,e,i){const n=this.serverIdIndex.get(t);if(n)try{n.setPosition(e,i)}catch(t){}}destroyAll(){0!==this.list.length&&[...this.list].forEach(t=>this.destroy(t))}loadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(this.loadedChunks.has(i))return 0;const n=this.allElementsByChunk.get(i)||[],s=[];return n.forEach(t=>{try{if(t.options&&t.options.serverId&&this.serverIdIndex.has(t.options.serverId))return;const e=this.create(t.id,this.scene,t.x,t.y,t.options||{});s.push(e)}catch(t){console.warn("Error creating object in chunk:",t)}}),this.loadedChunks.add(i),s.length>0&&console.log(`Loaded chunk ${i}: ${s.length} objects`),s.length}unloadChunkByCoords(t,e){const i=this._chunkKey(t,e);if(!this.loadedChunks.has(i))return 0;const n=t*this.chunkSize,s=(t+1)*this.chunkSize,r=e*this.chunkSize,a=(e+1)*this.chunkSize,o=this.list.filter(t=>t.x>=n&&t.x<s&&t.y>=r&&t.y<a);return o.forEach(t=>this.destroy(t)),this.loadedChunks.delete(i),o.length>0&&console.log(`Unloaded chunk ${i}: ${o.length} objects`),o.length}update(t,e,i){const n=this.scene.cameras.main.worldView;(!this._lastView||Math.abs(this._lastView.x-n.x)>10||Math.abs(this._lastView.y-n.y)>10)&&(this._lastView={x:n.x,y:n.y,width:n.width,height:n.height},this._viewPadded=new aut.Geom.Rectangle(n.x-64,n.y-64,n.width+128,n.height+128));const s=this.list.length;for(let t=0;t<s;t++){const n=this.list[t];if(!n)continue;const s=n.image||n.sprite||n;if(!s||!s.getBounds)continue;const r=aut.Geom.Intersects.RectangleToRectangle(this._viewPadded,s.getBounds());if(s.visible!==r&&"function"==typeof s.setVisible&&s.setVisible(r),s.body&&void 0!==s.body.enable&&s.body.enable!==r&&(s.body.enable=r),n.active=r,r&&"function"==typeof n.update)try{n.update(e,i)}catch(t){}}}loadChunk({cx:t,cy:e}){return this.loadChunkByCoords(t,e)}unloadChunk({cx:t,cy:e}){return this.unloadChunkByCoords(t,e)}getChunkElements(t,e){return this.allElementsByChunk.get(this._chunkKey(t,e))||[]}}class uct{static getTexture(t,e,i,n,s,r){const a=t.textures.get(e);if(!a)throw new Error(`Texture not found with id ${e}`);const o=document.createElement("canvas");return o.width=s,o.height=r,o.getContext("2d").drawImage(a.source[0].image,i,n,s,r,0,0,s,r),o.toDataURL()}}class cct{constructor(t){this.scene=t,this.keys=t.input.keyboard.addKeys("W,A,S,D,SHIFT"),this.inputVector={x:0,y:0},this.isRunning=!1,this.lastJoystickValue=!0,this.joystickOptions={zone:document.getElementById("game-container"),mode:"dynamic",size:100,color:"black",fadeTime:120},this.categoryConfig={special:{icon:"assets/icons/generalinfo.png",description:"Portals and special items."},plants:{icon:"assets/icons/plant.png",description:"Trees, flowers, and natural things."},props:{icon:"assets/icons/fire.png",description:"Barrels, boxes, and more props."},building:{icon:"assets/icons/generalinfo.png",description:"Buildings, houses, and moee."}},this.inputVector={x:0,y:0},this._createJoystick(),this.optionsModal=new Yut(document.getElementById("game-container"),this.scene),this.editorModal=new Uut(document.getElementById("game-container"),"Editor",this.scene),this.peopleModal=new qut(document.getElementById("game-container"),this.scene),this.playerInfoModal=new Kut(document.getElementById("game-container"),this.scene),this.setupEditorModal(this.editorModal),this.hud=new zut(document.getElementById("game-container"),{components:[{type:Dut,options:{scene:t,network:t.networkManager}},{type:Iut,options:{scene:t}},{type:But,options:{onZoomIn:()=>t.zoomIn(),onZoomOut:()=>t.zoomOut()}},{type:Nut,options:{scene:t}}]}),setTimeout(()=>this.updateEditorVisibility(),100),this.scene.events.on("objectCreated",()=>{"move"===this.currentEditorMode&&this.setupMoveMode(),"delete"===this.currentEditorMode&&this.setupDeleteMode()})}_createJoystick(){var t;this.joystick=(t=this.joystickOptions,Rut.create(t)),this.joystickRunThreshold=.7,this.joystickRunning=!1,this.moveHandler=(t,e)=>{const i=e.vector.x,n=-e.vector.y;Math.sqrt(i*i+n*n)<.2?(this.inputVector.x=0,this.inputVector.y=0):(this.inputVector.x=i,this.inputVector.y=n);const s=e.distance||0,r=this.joystickOptions.size/2,a=r>0?s/r:0;this.joystickRunning=a>this.joystickRunThreshold},this.endHandler=()=>{this.inputVector.x=0,this.inputVector.y=0,this.joystickRunning=!1},this.joystick.on("move",this.moveHandler),this.joystick.on("end",this.endHandler)}setKeysStatus(t){t?this.scene.input.keyboard.enableGlobalCapture():this.scene.input.keyboard.disableGlobalCapture();for(const e in this.keys)this.keys[e]&&(this.keys[e].enabled=t)}joystickSetEnabled(t,e=!0){e&&(this.lastJoystickValue=t),t?this.joystick||this._createJoystick():(this.joystick&&(this.joystick.destroy(),this.joystick=null,document.querySelectorAll(".nipple")[0]?.remove()),this.inputVector.x=0,this.inputVector.y=0)}joystickModalEnable(t){1==t?this.joystickSetEnabled(!1,!1):this.joystickSetEnabled(this.lastJoystickValue,!1)}setupEditorModal(t){const e=this;this.currentEditorMode="idle",this.selectedElement=null,this.selectedTileType="grass",this.draggedObject=null,this.dragOffset={x:0,y:0},t.body.innerHTML="";const i=document.createElement("div");i.className="editor-modes-container",i.innerHTML='\n      <div class="editor-section">\n        <h3>Editor Mode</h3>\n        <div class="mode-buttons">\n          <button class="mode-btn active" data-mode="idle">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <circle cx="12" cy="12" r="10"></circle>\n              <line x1="12" y1="8" x2="12" y2="12"></line>\n              <line x1="12" y1="16" x2="12.01" y2="16"></line>\n            </svg>\n            <span>Idle</span>\n          </button>\n          <button class="mode-btn" data-mode="move">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3M2 12h20M12 2v20"></path>\n            </svg>\n            <span>Move</span>\n          </button>\n          <button class="mode-btn" data-mode="elements">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>\n              <line x1="12" y1="8" x2="12" y2="16"></line>\n              <line x1="8" y1="12" x2="16" y2="12"></line>\n            </svg>\n            <span>Elements</span>\n          </button>\n          <button class="mode-btn" data-mode="tiles">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <rect x="3" y="3" width="7" height="7"></rect>\n              <rect x="14" y="3" width="7" height="7"></rect>\n              <rect x="14" y="14" width="7" height="7"></rect>\n              <rect x="3" y="14" width="7" height="7"></rect>\n            </svg>\n            <span>Tiles</span>\n          </button>\n          <button class="mode-btn" data-mode="delete">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <polyline points="3 6 5 6 21 6"></polyline>\n              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>\n              <line x1="10" y1="11" x2="10" y2="17"></line>\n              <line x1="14" y1="11" x2="14" y2="17"></line>\n            </svg>\n            <span>Delete</span>\n          </button>\n        </div>\n      </div>\n    ',t.body.appendChild(i);const n=i.querySelectorAll(".mode-btn");n.forEach(i=>{i.addEventListener("click",()=>{const s=i.dataset.mode;e.currentEditorMode=s,n.forEach(t=>t.classList.remove("active")),i.classList.add("active"),e.updateEditorCursor(),e.updateEditorContent(t),e.setupMoveMode(),e.setupDeleteMode()})});const s=document.createElement("div");s.className="editor-content-container",t.body.appendChild(s),this.updateEditorContent(t)}updateEditorCursor(){this.scene.game.canvas.style.cursor={idle:"default",move:"grab",elements:"crosshair",tiles:"crosshair",delete:"pointer"}[this.currentEditorMode]||"default"}setupMoveMode(){const t=this;this.scene.mapObjects&&this.scene.mapObjects.list&&("move"===this.currentEditorMode?this.scene.mapObjects.list.forEach(t=>{t.image&&!t.image.getData("moveEnabled")&&(t.image.setInteractive({draggable:!0}),t.image.setData("moveEnabled",!0))}):(this.scene.mapObjects.list.forEach(t=>{t.image&&t.image.getData("moveEnabled")&&(t.image.disableInteractive(),t.image.removeAllListeners("pointerdown"),t.image.removeAllListeners("drag"),t.image.removeAllListeners("dragend"),t.image.setData("moveEnabled",!1),t.image.setAlpha(1))}),this.draggedObject&&(this.draggedObject.image.setAlpha(1),this.draggedObject=null)),"move"===this.currentEditorMode&&this.scene.mapObjects.list.filter(t=>t.image).forEach(e=>{e.image.removeAllListeners("pointerdown"),e.image.removeAllListeners("drag"),e.image.removeAllListeners("dragend"),e.image.on("pointerdown",function(i){t.draggedObject=e,e.image.setAlpha(.6),t.scene.game.canvas.style.cursor="grabbing";const n="number"==typeof e.image.originX?e.image.originX:.5,s="number"==typeof e.image.originY?e.image.originY:.5,r=e.image.x-e.image.displayWidth*n,a=e.image.y-e.image.displayHeight*s;t.dragOffset.x=i.worldX-r,t.dragOffset.y=i.worldY-a}),e.image.on("drag",function(i){if(!t.draggedObject||t.draggedObject!==e)return;const n=i.worldX-t.dragOffset.x,s=i.worldY-t.dragOffset.y,r="number"==typeof e.image.originX?e.image.originX:.5,a="number"==typeof e.image.originY?e.image.originY:.5,o=n+e.image.displayWidth*r,h=s+e.image.displayHeight*a;e.setPosition(Math.floor(o),Math.floor(h))}),e.image.on("dragend",function(i){t.draggedObject===e&&(e.image.setAlpha(1),t.scene.game.canvas.style.cursor="grab",t.scene.networkManager.emitMoveElement(e),t.draggedObject=null)})}))}setupDeleteMode(){const t=this;this.scene.mapObjects&&this.scene.mapObjects.list&&("delete"===this.currentEditorMode?this.scene.mapObjects.list.forEach(t=>{t.image&&!t.image.getData("deleteEnabled")&&(t.image.setInteractive(),t.image.setData("deleteEnabled",!0))}):this.scene.mapObjects.list.forEach(t=>{t.image&&t.image.getData("deleteEnabled")&&(t.image.disableInteractive(),t.image.removeAllListeners("pointerdown"),t.image.removeAllListeners("pointerover"),t.image.removeAllListeners("pointerout"),t.image.setData("deleteEnabled",!1),t.image.setAlpha(1))}),"delete"===this.currentEditorMode&&this.scene.mapObjects.list.filter(t=>t.image).forEach(e=>{e.image.removeAllListeners("pointerdown"),e.image.removeAllListeners("pointerover"),e.image.removeAllListeners("pointerout"),e.image.on("pointerover",function(){e.image.setAlpha(.5),e.image.setTint(16737894)}),e.image.on("pointerout",function(){e.image.setAlpha(1),e.image.clearTint()}),e.image.on("pointerdown",function(){e.image.clearTint(),t.scene.networkManager.emitDeleteElement(e),t.scene.mapObjects.destroy(e)})}))}updateEditorContent(t){const e=t.body.querySelector(".editor-content-container");e&&(e.innerHTML="","idle"===this.currentEditorMode?e.innerHTML='<p style="text-align: center; color: #888; padding: 20px;">Select a mode to start editing</p>':"move"===this.currentEditorMode?e.innerHTML='<p style="text-align: center; color: #4a9eff; padding: 20px;">Click and drag elements to move them</p>':"elements"===this.currentEditorMode?this.showElementsEditor(e):"tiles"===this.currentEditorMode?this.showTilesEditor(e):"delete"===this.currentEditorMode&&(e.innerHTML='<p style="text-align: center; color: #ff4a4a; padding: 20px;">Click on elements to delete them</p>'))}showElementsEditor(t){const e=this,i=document.createElement("div");i.className="categories-container";const n={};lct.objects.forEach(t=>{const i=t.getType(),s=t.category;if(!n[s]){const t=this.categoryConfig[s]||{icon:"",description:"",color:"#999"};n[s]={config:t,items:[]}}n[s].items.push({...t,icon:uct.getTexture(e.scene,t.getTexture(),i.uvStartPx.u,i.uvStartPx.v,i.widthPx,i.heightPx)})}),Object.entries(n).forEach(([n,s])=>{const{icon:r,description:a,color:o}=s.config,h=s.items.length,l=document.createElement("div");l.className="category-card",l.style.borderColor=o,l.innerHTML=`\n        <div class="category-header">\n          <div class="title">\n            <img src="${r}" class="category-icon">\n            <h2>${n}</h2>\n          </div>\n        </div>\n        <p>${a}</p>\n        <p><b>Items:</b> ${h}</p>\n        <button class="open-category-btn">Open Category</button>\n      `,l.querySelector("button").addEventListener("click",()=>{!function(n,{config:s,items:r}){t.innerHTML="";const a=document.createElement("div");a.className="category-header",a.innerHTML=`\n        <div class="title">\n          <img src="${s.icon}" class="category-icon">\n          <h2>${n}</h2>\n        </div>\n      `,t.appendChild(a);const o=document.createElement("div");o.className="object-list",r.forEach(t=>{const i=document.createElement("div");i.className="object-card",i.innerHTML=`\n          <div class="object-header">\n            <img src="${t.icon}">\n          </div>\n          <div class="object-footer">\n            <h3>${t.name}</h3>\n            <button></button>\n          </div>\n        `;const n=i.querySelector("button");n.textContent=e.selectedElement===t.id?"Selected â":"Select",e.selectedElement===t.id&&i.classList.add("selected"),n.addEventListener("click",s=>{e.selectedElement=t.id,o.querySelectorAll(".object-card").forEach(t=>t.classList.remove("selected")),i.classList.add("selected"),o.querySelectorAll("button").forEach(t=>t.textContent="Select"),n.textContent="Selected â"}),o.appendChild(i)}),t.appendChild(o);const h=document.createElement("button");h.className="back-to-categories-btn",h.textContent="Back",h.addEventListener("click",()=>{t.innerHTML="",t.appendChild(i)}),a.appendChild(h)}(n,s)}),i.appendChild(l)}),t.appendChild(i)}showTilesEditor(t){const e=this;t.innerHTML=`\n      <div class="editor-section">\n        <h4>Select Tile Type</h4>\n        <div class="tile-type-buttons">\n          <button class="tile-type-btn ${"grass"===e.selectedTileType?"active":""}" data-type="grass">\n            <div class="tile-preview tile-grass"></div>\n            <span>Grass</span>\n          </button>\n          <button class="tile-type-btn ${"dirt"===e.selectedTileType?"active":""}" data-type="dirt">\n            <div class="tile-preview tile-dirt"></div>\n            <span>Dirt</span>\n          </button>\n        </div>\n      </div>\n    `;const i=t.querySelectorAll(".tile-type-btn");i.forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.type;e.selectedTileType=n,i.forEach(t=>t.classList.remove("active")),t.classList.add("active")})})}handleEditorClick(t,e){const i=this.scene.dev||this.scene.canEditMap;"elements"===this.currentEditorMode&&this.selectedElement&&i?this.placeElement(t,e):"tiles"===this.currentEditorMode&&i&&this.paintTile(t,e)}placeElement(t,e){if(!this.selectedElement)return;if(!this.scene.dev&&!this.scene.canEditMap)return;const i=function(){let t="";for(let e=0;e<64;e++)t+=Math.floor(10*Math.random()).toString();return t}(),n=this.scene.mapObjects.create(this.selectedElement,this.scene,Math.floor(t),Math.floor(e),{serverId:i});this.scene.networkManager.emitCreateElement(n)}paintTile(t,e){if(!this.scene.tileManager)return;if(!this.scene.dev&&!this.scene.canEditMap)return;const i=this.scene.tileManager.setTile(t,e,this.selectedTileType);i&&this.scene.networkManager.send("setTile",i)}updateEditorVisibility(){const t=document.querySelector('[data-modal="editor"]'),e=this.scene.dev||this.scene.canEditMap;t&&(e?t.style.display="flex":(t.style.display="none",this.editorModal.isOpen&&this.editorModal.close())),e&&(this.setupMoveMode(),this.setupDeleteMode())}getDirection(){let t=0,e=0;this.keys.A.isDown&&(t=-1),this.keys.D.isDown&&(t=1),this.keys.W.isDown&&(e=-1),this.keys.S.isDown&&(e=1);const i=this.keys.SHIFT.isDown,n=0!==t||0!==e;return this.isRunning=n?i:this.joystickRunning,t||e?{x:t,y:e,running:this.isRunning}:{...this.inputVector,running:this.isRunning}}}class dct{constructor(t,e,i,n={}){this.scene=t,this.getX=e,this.getY=i,this._bubbles=[],this._bubblePaddingX=n.bubblePaddingX??4,this._bubblePaddingY=n.bubblePaddingY??2,this._bubbleSeparation=n.bubbleSeparation??0,this._bubbleDuration=n.bubbleDuration??5e3,this._bubbleMaxWidth=n.bubbleMaxWidth??200,this._bubbleLimit=n.bubbleLimit??5,this.bubblePosFPlayer=n.bubblePosFPlayer??40,this._delayedCalls=new Set,this._typingBubble=null,this._typingTween=null,this._typingDelayedCall=null,this.needsUpdate=!1,this._lastX=null,this._lastY=null}_wrapAndTruncateByWords(t,e,i,n=10){if(!t)return"";const s=this.scene.add.bitmapText(0,0,"hawkpixelated","",parseInt(e.fontSize,10)||16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10000001);s.setOrigin(0,0);const r=t.split(/\s+/),a=[];let o="";const h=t=>{a.push(t),o=""};for(let t=0;t<r.length;t++){const e=r[t],l=o?o+" "+e:e;if(s.setText(l),s.getBounds().width<=i)o=l;else if(s.setText(e),s.getBounds().width>i){let t="";for(let n=0;n<e.length;n++){const r=t+e[n];if(s.setText(r),s.getBounds().width>i)break;t=r}o&&h(o),t.length&&h(t);const n=e.slice(t.length);o=n.length?n:""}else o&&h(o),o=e;if(a.length>=n)break}o&&h(o),a.length>n&&(a.length=n);let l=a.join("\n");if(s.setText(l),s.getBounds(),(()=>{if(!l)return 0;const t=l.replace(/\n/g," ").trim();return t?t.split(/\s+/).length:0})()<r.length){let t=a[a.length-1]||"";for(s.setText(t+"...");s.getBounds().width>i&&t.length>0;){const e=t.split(/\s+/);if(e.pop(),t=e.join(" "),s.setText(t+"..."),0===e.length)break}if(s.getBounds().width>i){let e=t;for(;e.length>0;)if(e=e.slice(0,-1),s.setText(e+"..."),s.getBounds().width<=i){t=e;break}}a[a.length-1]=t.trim()?t.trim()+"...":"..."}const u=a.join("\n");return s.destroy(),u}say(t,e=!1,i=void 0){if(!t)return;const n="number"==typeof i&&i>=0?i:this._bubbleDuration;if(this._bubbles.length>=this._bubbleLimit){const t=this._bubbles.shift();if(t&&(t.container&&this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:150,onComplete:()=>{t.container.destroyed||t.container.destroy()}}),t._delayedCall&&!t._delayedCall.hasDispatched))try{t._delayedCall.remove(!1)}catch(t){}this._updateBubbleStack()}const s={fontFamily:"Hawk",fontSize:"16px",color:e?"yellow":"#aaaaaa"},r=this._wrapAndTruncateByWords(t,s,this._bubbleMaxWidth),a=this.scene.add.bitmapText(0,0,"hawkpixelated",r,parseInt(s.fontSize,10)||16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10000001);a.setOrigin(0,0);const o=a.getBounds(),h=Math.ceil(o.width),l=Math.ceil(o.height),u=h+2*this._bubblePaddingX,c=l+2*this._bubblePaddingY,d=this.scene.add.container(0,0).setDepth(10000002),f=this.scene.add.graphics({pixelArt:!0});f.fillStyle(0,.6),f.fillRoundedRect(0,0,u,c,4);const p=this.scene.add.bitmapText(this._bubblePaddingX,this._bubblePaddingY,"hawkpixelated",r,parseInt(s.fontSize,10)||16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10000003);p.setOrigin(0,0),p.setCharacterTint(0,-1,!0,e?16776960:8421504);const g=this.scene.add.graphics({pixelArt:!0});g.fillStyle(0,.6),d.add([f,p,g]);const m=this._bubbles.length,v=Math.round(this.getX()),y=Math.round(this.getY()),x=Math.round(v-Math.floor(u/2)),w=Math.round(y-this.bubblePosFPlayer-(c+this._bubbleSeparation)*m-c);d.x=Math.floor(x),d.y=Math.floor(w);const b={container:d,bg:f,text:p,cloud:g,width:u,height:c,createdAt:Date.now(),_delayedCall:null};this._bubbles.push(b),this._updateBubbleStack(),a.destroy(),this._clampBubbleToCameraAndPoint(b);const T=this.scene.time.delayedCall(n,()=>{this._removeBubble(b),this._delayedCalls.delete(T)});return b._delayedCall=T,this._delayedCalls.add(T),b}setTyping(t,e=void 0){if(t){if(this._typingBubble){if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if("number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return void this._typingBubble.container.setVisible(0===this._bubbles.length)}const t={fontFamily:"Hawk",fontSize:"16px",color:"#aaaaaa"},i="...",n=this.scene.add.bitmapText(0,0,"hawkpixelated",i,parseInt(t.fontSize,10)||16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10000001);n.setOrigin(0,0);const s=n.getBounds(),r=Math.ceil(s.width),a=Math.ceil(s.height);n.destroy();const o=r+2*this._bubblePaddingX,h=a+2*this._bubblePaddingY,l=this.scene.add.container(0,0).setDepth(10000010),u=this.scene.add.graphics({pixelArt:!0});u.fillStyle(0,.6);const c=4;u.fillRoundedRect(0,0,o,h,c);const d=this._bubblePaddingX,f=this._bubblePaddingY;this._bubblePaddingX;const p=3,g=2,m=()=>{const t=Math.floor(170+86*Math.random()).toString(16).padStart(2,"0");return`#${t}${t}${t}`},v=[];for(let e=0;e<p;e++){m();const i=this.scene.add.bitmapText(0,0,"hawkpixelated",".",parseInt(t.fontSize,10)||16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10000011+e);i.setCharacterTint(0,-1,!0,16777215),i.setOrigin(.5,.5);const n=g*(e+1)+d-.5,s=f+Math.floor(a/2);i.x=n,i.y=s,i.setScale(1,1),i.setAlpha(1),l.add(i),v.push({text:i})}const y=this.scene.add.graphics({pixelArt:!0});y.fillStyle(0,.6),l.add([u,y]),l.sendToBack(u);const x=Math.round(this.getX()),w=Math.round(this.getY()),b=Math.round(x-Math.floor(o/2)),T=Math.round(w-this.bubblePosFPlayer-h);l.x=Math.floor(b),l.y=Math.floor(T);const E={container:l,bg:u,dots:v,cloud:y,width:o,height:h};this._typingBubble=E,this._clampBubbleToCameraAndPoint(E);const S=[],_=500;for(let t=0;t<v.length;t++){const e=v[t],i=this.scene.tweens.add({targets:e.text,alpha:{from:.4,to:1},ease:"Sine.easeInOut",duration:_,yoyo:!0,repeat:-1,delay:t*(_/3)});S.push(i)}if(this._typingTween={tweens:S},"number"==typeof e&&e>=0){const t=this.scene.time.delayedCall(e,()=>{this.setTyping(!1)});this._typingDelayedCall=t,this._delayedCalls.add(t)}return void this._updateBubbleStack()}{if(!this._typingBubble)return;if(this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(this._typingDelayedCall),this._typingDelayedCall=null}if(this._typingTween&&Array.isArray(this._typingTween.tweens)){for(const t of this._typingTween.tweens)try{t.remove(!1)}catch(t){}this._typingTween=null}const t=this._typingBubble;try{this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:120,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}})}catch(e){t.container&&!t.container.destroyed&&t.container.destroy()}return this._typingBubble=null,void this._updateBubbleStack()}}_clampBubbleToCameraAndPoint(t){if(!this.scene.cameras||!this.scene.cameras.main)return;const e=this.scene.cameras.main,i=e.worldView.x,n=e.worldView.y,s=e.worldView.x+e.worldView.width,r=e.worldView.y+e.worldView.height;let a=t.container.x;a<i+4&&(a=Math.floor(i+4)),a+t.width>s-4&&(a=Math.floor(s-t.width-4)),t.container.x=a;let o=t.container.y;o<n+4&&(o=Math.floor(n+4)),o+t.height>r-4&&(o=Math.floor(r-t.height-4)),t.container.y=o,this._drawCloudForBubble(t)}_drawCloudForBubble(t){if(!t.cloud)return;const e=t.cloud;e.clear(),e.fillStyle(0,.6);const i=t.container.x;let n=Math.round(this.getX())-i;n=Math.max(6,Math.min(t.width-6,n));const s=this._typingBubble===t,r=t.container.y+t.height<=this.getY()-8,a=r?t.height:-4,o=r?t.height+4:0,h=Math.floor(n-Math.floor(2)),l=Math.floor(n+Math.ceil(2));if(e.beginPath(),e.moveTo(h,a),e.lineTo(l,a),e.lineTo(n,o),e.closePath(),e.fillPath(),s)e.setVisible(!0);else{const e=this._bubbles.length?this._bubbles[this._bubbles.length-1]:null;e&&e.cloud&&e.cloud.setVisible(e===t)}}_repositionBubbles(){if(this._typingBubble){const t=this._typingBubble,e=Math.round(this.getX()),i=Math.round(this.getY()),n=Math.round(e-Math.floor(t.width/2)),s=Math.round(i-this.bubblePosFPlayer-t.height);t.container.x=Math.floor(n),t.container.y=Math.floor(s),this._clampBubbleToCameraAndPoint(t)}if(!this._bubbles.length)return;const t=Math.round(this.getX()),e=Math.round(this.getY());for(let i=0;i<this._bubbles.length;i++){const n=this._bubbles[i],s=n.width,r=n.height,a=i,o=0,h=Math.round(t-Math.floor(s/2)),l=Math.round(e-this.bubblePosFPlayer-(r+this._bubbleSeparation)*(this._bubbles.length-1-a+o)-r);n.container.x=Math.floor(h),n.container.y=Math.floor(l),this._clampBubbleToCameraAndPoint(n)}}_updateBubbleStack(){this._typingBubble&&(this._typingBubble.container.setDepth(10000020),this._typingBubble.container.setVisible(0===this._bubbles.length),this._typingBubble.cloud&&this._typingBubble.cloud.setVisible(0===this._bubbles.length));for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t],i=10000002;e.container.setDepth(i+t),e.cloud&&e.cloud.setVisible(!this._typingBubble&&t===this._bubbles.length-1)}this._repositionBubbles()}_removeBubble(t){const e=this._bubbles.indexOf(t);if(-1!==e){if(t._delayedCall){try{t._delayedCall.remove(!1)}catch(t){}this._delayedCalls.delete(t._delayedCall),t._delayedCall=null}this.scene.tweens.add({targets:[t.container],alpha:{from:1,to:0},duration:200,onComplete:()=>{t.container&&!t.container.destroyed&&t.container.destroy()}}),this._bubbles.splice(e,1),this._updateBubbleStack()}}destroy(){for(const t of this._delayedCalls)try{t.remove(!1)}catch(t){}if(this._delayedCalls.clear(),this._typingDelayedCall){try{this._typingDelayedCall.remove(!1)}catch(t){}this._typingDelayedCall=null}if(this._typingTween){try{this._typingTween.remove(!1)}catch(t){}this._typingTween=null}if(this._typingBubble&&this._typingBubble.container&&!this._typingBubble.container.destroyed){try{this._typingBubble.container.destroy()}catch(t){}this._typingBubble=null}for(let t=0;t<this._bubbles.length;t++){const e=this._bubbles[t];if(e&&e._delayedCall){try{e._delayedCall.remove(!1)}catch(t){}e._delayedCall=null}if(e&&e.container&&!e.container.destroyed)try{this.scene.tweens.add({targets:[e.container],alpha:{from:1,to:0},duration:100,onComplete:()=>{e.container&&!e.container.destroyed&&e.container.destroy()}})}catch(t){e.container&&!e.container.destroyed&&e.container.destroy()}}this._bubbles=[],this.scene=null,this.getX=null,this.getY=null}update(){const t=this.getX(),e=this.getY();this._lastX!==t||this._lastY!==e?(this._repositionBubbles(),this._lastX=t,this._lastY=e,this.needsUpdate=!0):this.needsUpdate=!1}}class fct{constructor(t,e,i,n,s,r,a,o){this.id=e,this.scene=t,this.display_name=s,this.username=n,this.avatar=o,this.uuid=i;const h="avatar-"+i;if(this.sprite=t.add.image(r,a,"wah"),t.physics.add.existing(this.sprite),this.sprite.body.setCollideWorldBounds(!0),this.sprite.body.setSize(32,16).setOffset(0,16),this.sprite.body.debugShowBody=!1,this.sprite.body.roundPixels=!0,this.sprite.setInteractive(),this.sprite.setData("playerId",e),this.sprite.setData("playerUuid",i),this.sprite.setData("playerData",{id:e,uuid:i,username:n,display_name:s,avatar:o}),this.sprite.on("pointerdown",()=>{const t=this.scene;t&&t.inputManager&&t.inputManager.playerInfoModal&&t.inputManager.playerInfoModal.showPlayer(i,{id:e,uuid:i,username:n,display_name:s,avatar:o})}),o){const t=new Image;t.onload=()=>{this.scene.textures.exists(h)&&this.scene.textures.remove(h),this.scene.textures.addImage(h,t),this.sprite.setTexture(h)},t.onerror=t=>{console.error("Error loading custom avatar",t)},t.src=o}this.nameText=t.add.bitmapText(Math.floor(r-16),Math.floor(a-32),"hawkpixelated",s||"",16,aut.GameObjects.BitmapText.ALIGN_LEFT).setDepth(10248),this.nameText.setCharacterTint(0,-1,!0,16777215),this._positionTween=null,this._smoothDuration=150,this._targetPosition={x:r,y:a},this._interpolationSpeed=.25,this.chat=new dct(t,()=>this.sprite.x,()=>this.sprite.y,{bubblePosFPlayer:s&&""!=s?40:24})}update(){this.chat.update()}updateMovement(t){const e=t.running?150:100,i=Math.floor(t.x*e),n=Math.floor(t.y*e);this.sprite.body.velocity.x===i&&this.sprite.body.velocity.y===n||this.sprite.body.setVelocity(i,n);const s=Math.floor(this.sprite.x-Math.floor(this.sprite.width/2)),r=Math.floor(this.sprite.y-30);this.nameText.x===s&&this.nameText.y===r||this.nameText.setPosition(s,r);const a=this.sprite.y+16;this.sprite.depth!==a&&this.sprite.setDepth(a)}setPosition(t,e,i=!1){if(!i)return this.sprite.setPosition(t,e),this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-25)),this.sprite.body&&this.sprite.body.reset(t,e),this._targetPosition.x=t,this._targetPosition.y=e,void(this.chat&&this.chat.needsUpdate&&this.chat.update());this._targetPosition.x=t,this._targetPosition.y=e;const n=t-this.sprite.x,s=e-this.sprite.y;if(Math.sqrt(n*n+s*s)>200)return this.sprite.setPosition(t,e),this.sprite.body&&this.sprite.body.reset(t,e),void(this.nameText&&this.nameText.setPosition(Math.floor(t-16),Math.floor(e-25)));this.scene.tweens.add({targets:this.sprite,x:t,y:e,duration:this._smoothDuration,ease:"Linear",onUpdate:()=>{this.sprite.body&&this.sprite.body.reset(this.sprite.x,this.sprite.y),this.nameText&&this.nameText.setPosition(Math.floor(this.sprite.x-16),Math.floor(this.sprite.y-25))},onComplete:()=>{this.sprite.body&&this.sprite.body.reset(t,e)}})}setSmoothDuration(t){this._smoothDuration=Math.max(0,0|t)}say(t,e){return this.chat.say(t,e,function(t){const e=t.replace(/\s/g,"").length;return Math.min(12e4,Math.max(1e3,500*e))}(t))}destroy(){if(this._positionTween){try{this._positionTween.stop()}catch(t){}this._positionTween=null}if(this.chat){try{this.chat.destroy()}catch(t){}this.chat=null}if(this.sprite){try{this.sprite.destroy()}catch(t){}this.sprite=null}if(this.nameText){try{this.nameText.destroy()}catch(t){}this.nameText=null}this.scene=null}}try{Hut=new TextDecoder}catch(t){}var pct,gct,mct,vct,yct,xct=0,wct={},bct=0,Tct=0,Ect=[],Sct={useRecords:!1,mapsAsObjects:!0};class _ct{}const Cct=new _ct;Cct.name="MessagePack 0xC1";var Act=!1,Mct=2;try{new Function("")}catch(t){Mct=1/0}class Pct{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0),t.int64AsNumber&&(t.int64AsType="number")),Object.assign(this,t)}unpack(t,e){if(Wut)return sdt(()=>(rdt(),this?this.unpack(t,e):Pct.prototype.unpack.call(Sct,t,e)));t.buffer||t.constructor!==ArrayBuffer||(t="undefined"!=typeof Buffer?Buffer.from(t):new Uint8Array(t)),"object"==typeof e?(Vut=e.end||t.length,xct=e.start||0):(xct=0,Vut=e>-1?e:t.length),Tct=0,gct=null,mct=null,Wut=t;try{yct=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(Wut=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof Pct){if(wct=this,this.structures)return pct=this.structures,Rct();(!pct||pct.length>0)&&(pct=[])}else wct=Sct,(!pct||pct.length>0)&&(pct=[]);return Rct()}unpackMultiple(t,e){let i,n=0;try{Act=!0;let s=t.length,r=this?this.unpack(t,s):odt.unpack(t,s);if(!e){for(i=[r];xct<s;)n=xct,i.push(Rct());return i}if(!1===e(r,n,xct))return;for(;xct<s;)if(n=xct,!1===e(Rct(),n,xct))return}catch(t){throw t.lastPosition=n,t.values=i,t}finally{Act=!1,rdt()}}_mergeStructures(t,e){t=t||[],Object.isFrozen(t)&&(t=t.map(t=>t.slice(0)));for(let e=0,i=t.length;e<i;e++){let i=t[e];i&&(i.isShared=!0,e>=32&&(i.highByte=e-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let n=t[i],s=e[i];s&&(n&&((t.restoreStructures||(t.restoreStructures=[]))[i]=n),t[i]=s)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function Rct(t){try{if(!wct.trusted&&!Act){let t=pct.sharedLength||0;t<pct.length&&(pct.length=t)}let t;if(wct.randomAccessStructure&&Wut[xct]<64&&Wut[xct],t=Oct(),mct&&(xct=mct.postBundlePosition,mct=null),Act&&(pct.restoreStructures=null),xct==Vut)pct&&pct.restoreStructures&&Lct(),pct=null,Wut=null,vct&&(vct=null);else{if(xct>Vut)throw new Error("Unexpected end of MessagePack data");if(!Act){let e;try{e=JSON.stringify(t,(t,e)=>"bigint"==typeof e?`${e}n`:e).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw new Error("Data read, but end of buffer not reached "+e)}}return t}catch(t){throw pct&&pct.restoreStructures&&Lct(),rdt(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||xct>Vut)&&(t.incomplete=!0),t}}function Lct(){for(let t in pct.restoreStructures)pct[t]=pct.restoreStructures[t];pct.restoreStructures=null}function Oct(){let t=Wut[xct++];if(t<160){if(t<128){if(t<64)return t;{let e=pct[63&t]||wct.getStructures&&Ict()[63&t];return e?(e.read||(e.read=kct(e,63&t)),e.read()):t}}if(t<144){if(t-=128,wct.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=$ct();"__proto__"===t&&(t="__proto_"),e[t]=Oct()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(Oct(),Oct());return e}}{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=Oct();return wct.freezeData?Object.freeze(e):e}}if(t<192){let e=t-160;if(Tct>=xct)return gct.slice(xct-bct,(xct+=e)-bct);if(0==Tct&&Vut<140){let t=e<16?Vct(e):Wct(e);if(null!=t)return t}return Bct(e)}{let e;switch(t){case 192:return null;case 193:return mct?(e=Oct(),e>0?mct[1].slice(mct.position1,mct.position1+=e):mct[0].slice(mct.position0,mct.position0-=e)):Cct;case 194:return!1;case 195:return!0;case 196:if(e=Wut[xct++],void 0===e)throw new Error("Unexpected end of buffer");return qct(e);case 197:return e=yct.getUint16(xct),xct+=2,qct(e);case 198:return e=yct.getUint32(xct),xct+=4,qct(e);case 199:return Kct(Wut[xct++]);case 200:return e=yct.getUint16(xct),xct+=2,Kct(e);case 201:return e=yct.getUint32(xct),xct+=4,Kct(e);case 202:if(e=yct.getFloat32(xct),wct.useFloat32>2){let t=adt[(127&Wut[xct])<<1|Wut[xct+1]>>7];return xct+=4,(t*e+(e>0?.5:-.5)|0)/t}return xct+=4,e;case 203:return e=yct.getFloat64(xct),xct+=8,e;case 204:return Wut[xct++];case 205:return e=yct.getUint16(xct),xct+=2,e;case 206:return e=yct.getUint32(xct),xct+=4,e;case 207:return"number"===wct.int64AsType?(e=4294967296*yct.getUint32(xct),e+=yct.getUint32(xct+4)):"string"===wct.int64AsType?e=yct.getBigUint64(xct).toString():"auto"===wct.int64AsType?(e=yct.getBigUint64(xct),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=yct.getBigUint64(xct),xct+=8,e;case 208:return yct.getInt8(xct++);case 209:return e=yct.getInt16(xct),xct+=2,e;case 210:return e=yct.getInt32(xct),xct+=4,e;case 211:return"number"===wct.int64AsType?(e=4294967296*yct.getInt32(xct),e+=yct.getUint32(xct+4)):"string"===wct.int64AsType?e=yct.getBigInt64(xct).toString():"auto"===wct.int64AsType?(e=yct.getBigInt64(xct),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=yct.getBigInt64(xct),xct+=8,e;case 212:if(e=Wut[xct++],114==e)return Qct(63&Wut[xct++]);{let t=Ect[e];if(t)return t.read?(xct++,t.read(Oct())):t.noBuffer?(xct++,t()):t(Wut.subarray(xct,++xct));throw new Error("Unknown extension "+e)}case 213:return e=Wut[xct],114==e?(xct++,Qct(63&Wut[xct++],Wut[xct++])):Kct(2);case 214:return Kct(4);case 215:return Kct(8);case 216:return Kct(16);case 217:return e=Wut[xct++],Tct>=xct?gct.slice(xct-bct,(xct+=e)-bct):Nct(e);case 218:return e=yct.getUint16(xct),Tct>=(xct+=2)?gct.slice(xct-bct,(xct+=e)-bct):zct(e);case 219:return e=yct.getUint32(xct),Tct>=(xct+=4)?gct.slice(xct-bct,(xct+=e)-bct):Uct(e);case 220:return e=yct.getUint16(xct),xct+=2,Xct(e);case 221:return e=yct.getUint32(xct),xct+=4,Xct(e);case 222:return e=yct.getUint16(xct),xct+=2,Gct(e);case 223:return e=yct.getUint32(xct),xct+=4,Gct(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const Fct=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function kct(t,e){function i(){if(i.count++>Mct){let i=t.read=new Function("r","return function(){return "+(wct.freezeData?"Object.freeze":"")+"({"+t.map(t=>"__proto__"===t?"__proto_:r()":Fct.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()").join(",")+"})}")(Oct);return 0===t.highByte&&(t.read=Dct(e,t.read)),i()}let n={};for(let e=0,i=t.length;e<i;e++){let i=t[e];"__proto__"===i&&(i="__proto_"),n[i]=Oct()}return wct.freezeData?Object.freeze(n):n}return i.count=0,0===t.highByte?Dct(e,i):i}const Dct=(t,e)=>function(){let i=Wut[xct++];if(0===i)return e();let n=t<32?-(t+(i<<5)):t+(i<<5),s=pct[n]||Ict()[n];if(!s)throw new Error("Record id is not defined for "+n);return s.read||(s.read=kct(s,t)),s.read()};function Ict(){let t=sdt(()=>(Wut=null,wct.getStructures()));return pct=wct._mergeStructures(t,pct)}var Bct=Yct,Nct=Yct,zct=Yct,Uct=Yct;function Yct(t){let e;if(t<16&&(e=Vct(t)))return e;if(t>64&&Hut)return Hut.decode(Wut.subarray(xct,xct+=t));const i=xct+t,n=[];for(e="";xct<i;){const t=Wut[xct++];if(128&t)if(192==(224&t)){const e=63&Wut[xct++];n.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&Wut[xct++],i=63&Wut[xct++];n.push((31&t)<<12|e<<6|i)}else if(240==(248&t)){let e=(7&t)<<18|(63&Wut[xct++])<<12|(63&Wut[xct++])<<6|63&Wut[xct++];e>65535&&(e-=65536,n.push(e>>>10&1023|55296),e=56320|1023&e),n.push(e)}else n.push(t);else n.push(t);n.length>=4096&&(e+=Hct.apply(String,n),n.length=0)}return n.length>0&&(e+=Hct.apply(String,n)),e}function Xct(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=Oct();return wct.freezeData?Object.freeze(e):e}function Gct(t){if(wct.mapsAsObjects){let e={};for(let i=0;i<t;i++){let t=$ct();"__proto__"===t&&(t="__proto_"),e[t]=Oct()}return e}{let e=new Map;for(let i=0;i<t;i++)e.set(Oct(),Oct());return e}}var Hct=String.fromCharCode;function Wct(t){let e=xct,i=new Array(t);for(let n=0;n<t;n++){const t=Wut[xct++];if((128&t)>0)return void(xct=e);i[n]=t}return Hct.apply(String,i)}function Vct(t){if(t<4){if(t<2){if(0===t)return"";{let t=Wut[xct++];return(128&t)>1?void(xct-=1):Hct(t)}}{let e=Wut[xct++],i=Wut[xct++];if((128&e)>0||(128&i)>0)return void(xct-=2);if(t<3)return Hct(e,i);let n=Wut[xct++];return(128&n)>0?void(xct-=3):Hct(e,i,n)}}{let e=Wut[xct++],i=Wut[xct++],n=Wut[xct++],s=Wut[xct++];if((128&e)>0||(128&i)>0||(128&n)>0||(128&s)>0)return void(xct-=4);if(t<6){if(4===t)return Hct(e,i,n,s);{let t=Wut[xct++];return(128&t)>0?void(xct-=5):Hct(e,i,n,s,t)}}if(t<8){let r=Wut[xct++],a=Wut[xct++];if((128&r)>0||(128&a)>0)return void(xct-=6);if(t<7)return Hct(e,i,n,s,r,a);let o=Wut[xct++];return(128&o)>0?void(xct-=7):Hct(e,i,n,s,r,a,o)}{let r=Wut[xct++],a=Wut[xct++],o=Wut[xct++],h=Wut[xct++];if((128&r)>0||(128&a)>0||(128&o)>0||(128&h)>0)return void(xct-=8);if(t<10){if(8===t)return Hct(e,i,n,s,r,a,o,h);{let t=Wut[xct++];return(128&t)>0?void(xct-=9):Hct(e,i,n,s,r,a,o,h,t)}}if(t<12){let l=Wut[xct++],u=Wut[xct++];if((128&l)>0||(128&u)>0)return void(xct-=10);if(t<11)return Hct(e,i,n,s,r,a,o,h,l,u);let c=Wut[xct++];return(128&c)>0?void(xct-=11):Hct(e,i,n,s,r,a,o,h,l,u,c)}{let l=Wut[xct++],u=Wut[xct++],c=Wut[xct++],d=Wut[xct++];if((128&l)>0||(128&u)>0||(128&c)>0||(128&d)>0)return void(xct-=12);if(t<14){if(12===t)return Hct(e,i,n,s,r,a,o,h,l,u,c,d);{let t=Wut[xct++];return(128&t)>0?void(xct-=13):Hct(e,i,n,s,r,a,o,h,l,u,c,d,t)}}{let f=Wut[xct++],p=Wut[xct++];if((128&f)>0||(128&p)>0)return void(xct-=14);if(t<15)return Hct(e,i,n,s,r,a,o,h,l,u,c,d,f,p);let g=Wut[xct++];return(128&g)>0?void(xct-=15):Hct(e,i,n,s,r,a,o,h,l,u,c,d,f,p,g)}}}}}function jct(){let t,e=Wut[xct++];if(e<192)t=e-160;else switch(e){case 217:t=Wut[xct++];break;case 218:t=yct.getUint16(xct),xct+=2;break;case 219:t=yct.getUint32(xct),xct+=4;break;default:throw new Error("Expected string")}return Yct(t)}function qct(t){return wct.copyBuffers?Uint8Array.prototype.slice.call(Wut,xct,xct+=t):Wut.subarray(xct,xct+=t)}function Kct(t){let e=Wut[xct++];if(Ect[e]){let i;return Ect[e](Wut.subarray(xct,i=xct+=t),t=>{xct=t;try{return Oct()}finally{xct=i}})}throw new Error("Unknown extension type "+e)}var Zct=new Array(4096);function $ct(){let t=Wut[xct++];if(!(t>=160&&t<192))return xct--,Jct(Oct());if(t-=160,Tct>=xct)return gct.slice(xct-bct,(xct+=t)-bct);if(!(0==Tct&&Vut<180))return Bct(t);let e,i=4095&(t<<5^(t>1?yct.getUint16(xct):t>0?Wut[xct]:0)),n=Zct[i],s=xct,r=xct+t-3,a=0;if(n&&n.bytes==t){for(;s<r;){if(e=yct.getUint32(s),e!=n[a++]){s=1879048192;break}s+=4}for(r+=3;s<r;)if(e=Wut[s++],e!=n[a++]){s=1879048192;break}if(s===r)return xct=s,n.string;r-=3,s=xct}for(n=[],Zct[i]=n,n.bytes=t;s<r;)e=yct.getUint32(s),n.push(e),s+=4;for(r+=3;s<r;)e=Wut[s++],n.push(e);let o=t<16?Vct(t):Wct(t);return n.string=null!=o?o:Bct(t)}function Jct(t){if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t.toString();if(null==t)return t+"";if(wct.allowArraysInMapKeys&&Array.isArray(t)&&t.flat().every(t=>["string","number","boolean","bigint"].includes(typeof t)))return t.flat().toString();throw new Error("Invalid property type for record: "+typeof t)}const Qct=(t,e)=>{let i=Oct().map(Jct),n=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let s=pct[t];return s&&(s.isShared||Act)&&((pct.restoreStructures||(pct.restoreStructures=[]))[t]=s),pct[t]=i,i.read=kct(i,n),i.read()};Ect[0]=()=>{},Ect[0].noBuffer=!0,Ect[66]=t=>{let e=t.byteLength%8||8,i=BigInt(128&t[0]?t[0]-256:t[0]);for(let n=1;n<e;n++)i<<=BigInt(8),i+=BigInt(t[n]);if(t.byteLength!==e){let n=new DataView(t.buffer,t.byteOffset,t.byteLength),s=(t,e)=>{let i=e-t;if(i<=40){let i=n.getBigUint64(t);for(let s=t+8;s<e;s+=8)i<<=BigInt(64n),i|=n.getBigUint64(s);return i}let r=t+(i>>4<<3),a=s(t,r),o=s(r,e);return a<<BigInt(8*(e-r))|o};i=i<<BigInt(8*(n.byteLength-e))|s(e,n.byteLength)}return i};let tdt={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,AggregateError:"function"==typeof AggregateError?AggregateError:null};Ect[101]=()=>{let t=Oct();if(!tdt[t[0]]){let e=Error(t[1],{cause:t[2]});return e.name=t[0],e}return tdt[t[0]](t[1],{cause:t[2]})},Ect[105]=t=>{if(!1===wct.structuredClone)throw new Error("Structured clone extension is disabled");let e=yct.getUint32(xct-4);vct||(vct=new Map);let i,n=Wut[xct];i=n>=144&&n<160||220==n||221==n?[]:n>=128&&n<144||222==n||223==n?new Map:(n>=199&&n<=201||n>=212&&n<=216)&&115===Wut[xct+1]?new Set:{};let s={target:i};vct.set(e,s);let r=Oct();if(!s.used)return s.target=r;if(Object.assign(i,r),i instanceof Map)for(let[t,e]of r.entries())i.set(t,e);if(i instanceof Set)for(let t of Array.from(r))i.add(t);return i},Ect[112]=t=>{if(!1===wct.structuredClone)throw new Error("Structured clone extension is disabled");let e=yct.getUint32(xct-4),i=vct.get(e);return i.used=!0,i.target},Ect[115]=()=>new Set(Oct());const edt=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let idt="object"==typeof globalThis?globalThis:window;Ect[116]=t=>{let e=t[0],i=Uint8Array.prototype.slice.call(t,1).buffer,n=edt[e];if(!n){if(16===e)return i;if(17===e)return new DataView(i);throw new Error("Could not find typed array for code "+e)}return new idt[n](i)},Ect[120]=()=>{let t=Oct();return new RegExp(t[0],t[1])};const ndt=[];function sdt(t){let e=Vut,i=xct,n=bct,s=Tct,r=gct,a=vct,o=mct,h=new Uint8Array(Wut.slice(0,Vut)),l=pct,u=pct.slice(0,pct.length),c=wct,d=Act,f=t();return Vut=e,xct=i,bct=n,Tct=s,gct=r,vct=a,mct=o,Wut=h,Act=d,(pct=l).splice(0,pct.length,...u),wct=c,yct=new DataView(Wut.buffer,Wut.byteOffset,Wut.byteLength),f}function rdt(){Wut=null,vct=null,pct=null}Ect[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=xct;return xct+=e-t.length,mct=ndt,(mct=[jct(),jct()]).position0=0,mct.position1=0,mct.postBundlePosition=xct,xct=i,Oct()},Ect[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const adt=new Array(147);for(let t=0;t<256;t++)adt[t]=+("1e"+Math.floor(45.15-.30103*t));var odt=new Pct({useRecords:!1});const hdt=odt.unpack;odt.unpackMultiple,odt.unpack;let ldt,udt,cdt,ddt=new Float32Array(1);new Uint8Array(ddt.buffer,0,4);try{ldt=new TextEncoder}catch(t){}const fdt="undefined"!=typeof Buffer,pdt=fdt?function(t){return Buffer.allocUnsafeSlow(t)}:Uint8Array,gdt=fdt?Buffer:Uint8Array,mdt=fdt?4294967296:2144337920;let vdt,ydt,xdt,wdt,bdt=0,Tdt=null;const Edt=/[\u0080-\uFFFF]/,Sdt=Symbol("record-id");function _dt(t,e,i,n){let s=t.byteLength;if(s+1<256){var{target:r,position:a}=i(4+s);r[a++]=199,r[a++]=s+1}else if(s+1<65536){var{target:r,position:a}=i(5+s);r[a++]=200,r[a++]=s+1>>8,r[a++]=s+1&255}else{var{target:r,position:a,targetView:o}=i(7+s);r[a++]=201,o.setUint32(a,s+1),a+=4}r[a++]=116,r[a++]=e,t.buffer||(t=new Uint8Array(t)),r.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function Cdt(t,e){let i=t.byteLength;var n,s;if(i<256){var{target:n,position:s}=e(i+2);n[s++]=196,n[s++]=i}else if(i<65536){var{target:n,position:s}=e(i+3);n[s++]=197,n[s++]=i>>8,n[s++]=255&i}else{var{target:n,position:s,targetView:r}=e(i+5);n[s++]=198,r.setUint32(s,i),s+=4}n.set(t,s)}function Adt(t,e,i,n){let s=t.length;switch(s){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:s<256?(e[i++]=199,e[i++]=s):s<65536?(e[i++]=200,e[i++]=s>>8,e[i++]=255&s):(e[i++]=201,e[i++]=s>>24,e[i++]=s>>16&255,e[i++]=s>>8&255,e[i++]=255&s)}return e[i++]=n,e.set(t,i),i+s}function Mdt(t,e,i){if(Tdt.length>0){xdt.setUint32(Tdt.position+t,bdt+i-Tdt.position-t),Tdt.stringsPosition=bdt-t;let n=Tdt;Tdt=null,e(n[0]),e(n[1])}}cdt=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,_ct],udt=[{pack(t,e,i){let n=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&n>=0&&n<4294967296){let{target:t,targetView:i,position:s}=e(6);t[s++]=214,t[s++]=255,i.setUint32(s,n)}else if(n>0&&n<4294967296){let{target:i,targetView:s,position:r}=e(10);i[r++]=215,i[r++]=255,s.setUint32(r,4e6*t.getMilliseconds()+(n/1e3/4294967296|0)),s.setUint32(r+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:t,targetView:n,position:s}=e(3);t[s++]=212,t[s++]=255,t[s++]=255}else{let{target:i,targetView:s,position:r}=e(15);i[r++]=199,i[r++]=12,i[r++]=255,s.setUint32(r,1e6*t.getMilliseconds()),s.setBigInt64(r+4,BigInt(Math.floor(n)))}}},{pack(t,e,i){if(this.setAsEmptyObject)return e(0),i({});let n=Array.from(t),{target:s,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(s[r++]=212,s[r++]=115,s[r++]=0),i(n)}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=101,n[s++]=0),i([t.name,t.message,t.cause])}},{pack(t,e,i){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=120,n[s++]=0),i([t.source,t.flags])}},{pack(t,e){this.moreTypes?_dt(t,16,e):Cdt(fdt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==gdt&&this.moreTypes?_dt(t,edt.indexOf(i.name),e):Cdt(t,e)}},{pack(t,e){this.moreTypes?_dt(t,17,e):Cdt(fdt?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let{target:i,position:n}=e(1);i[n]=193}}];let Pdt=new class extends Pct{constructor(t){let e,i,n,s;super(t),this.offset=0;let r=gdt.prototype.utf8Write?function(t,e){return vdt.utf8Write(t,e,vdt.byteLength-e)}:!(!ldt||!ldt.encodeInto)&&function(t,e){return ldt.encodeInto(t,vdt.subarray(e)).written},a=this;t||(t={});let o=t&&t.sequential,h=t.structures||t.saveStructures,l=t.maxSharedStructures;if(null==l&&(l=h?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(this.moreTypes=!0);let u=t.maxOwnStructures;null==u&&(u=h?32:64),this.structures||0==t.useRecords||(this.structures=[]);let c=l>32||u+l>64,d=l+64,f=l+u+64;if(f>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let p=[],g=0,m=0;this.pack=this.encode=function(t,r){if(vdt||(vdt=new pdt(8192),xdt=vdt.dataView||(vdt.dataView=new DataView(vdt.buffer,0,8192)),bdt=0),wdt=vdt.length-10,wdt-bdt<2048?(vdt=new pdt(vdt.length),xdt=vdt.dataView||(vdt.dataView=new DataView(vdt.buffer,0,vdt.length)),wdt=vdt.length-10,bdt=0):bdt=bdt+7&2147483640,e=bdt,r&Fdt&&(bdt+=255&r),s=a.structuredClone?new Map:null,a.bundleStrings&&"string"!=typeof t?(Tdt=[],Tdt.size=1/0):Tdt=null,n=a.structures,n){n.uninitialized&&(n=a._mergeStructures(a.getStructures()));let t=n.sharedLength||0;if(t>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let e=0;e<t;e++){let t=n[e];if(!t)continue;let i,s=n.transitions;for(let e=0,n=t.length;e<n;e++){let n=t[e];i=s[n],i||(i=s[n]=Object.create(null)),s=i}s[Sdt]=e+64}this.lastNamedStructuresLength=t}o||(n.nextId=t+64)}let h;i&&(i=!1);try{a.randomAccessStructure&&t&&t.constructor&&t.constructor===Object?A(t):x(t);let i=Tdt;if(Tdt&&Mdt(e,x,0),s&&s.idsToInsert){let t=s.idsToInsert.sort((t,e)=>t.offset>e.offset?1:-1),n=t.length,r=-1;for(;i&&n>0;){let s=t[--n].offset+e;s<i.stringsPosition+e&&-1===r&&(r=0),s>i.position+e?r>=0&&(r+=6):(r>=0&&(xdt.setUint32(i.position+e,xdt.getUint32(i.position+e)+r),r=-1),i=i.previous,n++)}r>=0&&i&&xdt.setUint32(i.position+e,xdt.getUint32(i.position+e)+r),bdt+=6*t.length,bdt>wdt&&S(bdt),a.offset=bdt;let o=function(t,e){let i,n=6*e.length,s=t.length-n;for(;i=e.pop();){let e=i.offset,r=i.id;t.copyWithin(e+n,e,s),n-=6;let a=e+n;t[a++]=214,t[a++]=105,t[a++]=r>>24,t[a++]=r>>16&255,t[a++]=r>>8&255,t[a++]=255&r,s=e}return t}(vdt.subarray(e,bdt),t);return s=null,o}return a.offset=bdt,r&Ldt?(vdt.start=e,vdt.end=bdt,vdt):vdt.subarray(e,bdt)}catch(t){throw h=t,t}finally{if(n&&(v(),i&&a.saveStructures)){let i=n.sharedLength||0,s=vdt.subarray(e,bdt),o=function(t,e){return t.isCompatible=t=>{let i=!t||(e.lastNamedStructuresLength||0)===t.length;return i||e._mergeStructures(t),i},t}(n,a);if(!h)return!1===a.saveStructures(o,o.isCompatible)?a.pack(t,r):(a.lastNamedStructuresLength=i,vdt.length>1073741824&&(vdt=null),s)}vdt.length>1073741824&&(vdt=null),r&Odt&&(bdt=e)}};const v=()=>{m<10&&m++;let t=n.sharedLength||0;if(n.length>t&&!o&&(n.length=t),g>1e4)n.transitions=null,m=0,g=0,p.length>0&&(p=[]);else if(p.length>0&&!o){for(let t=0,e=p.length;t<e;t++)p[t][Sdt]=0;p=[]}},y=t=>{var e=t.length;e<16?vdt[bdt++]=144|e:e<65536?(vdt[bdt++]=220,vdt[bdt++]=e>>8,vdt[bdt++]=255&e):(vdt[bdt++]=221,xdt.setUint32(bdt,e),bdt+=4);for(let i=0;i<e;i++)x(t[i])},x=t=>{bdt>wdt&&(vdt=S(bdt));var i,n=typeof t;if("string"===n){let n,s=t.length;if(Tdt&&s>=4&&s<4096){if((Tdt.size+=s)>21760){let t,i,n=(Tdt[0]?3*Tdt[0].length+Tdt[1].length:0)+10;bdt+n>wdt&&(vdt=S(bdt+n)),Tdt.position?(i=Tdt,vdt[bdt]=200,bdt+=3,vdt[bdt++]=98,t=bdt-e,bdt+=4,Mdt(e,x,0),xdt.setUint16(t+e-3,bdt-e-t)):(vdt[bdt++]=214,vdt[bdt++]=98,t=bdt-e,bdt+=4),Tdt=["",""],Tdt.previous=i,Tdt.size=0,Tdt.position=t}let i=Edt.test(t);return Tdt[i?0:1]+=t,vdt[bdt++]=193,void x(i?-s:s)}n=s<32?1:s<256?2:s<65536?3:5;let a=3*s;if(bdt+a>wdt&&(vdt=S(bdt+a)),s<64||!r){let e,r,a,o=bdt+n;for(e=0;e<s;e++)r=t.charCodeAt(e),r<128?vdt[o++]=r:r<2048?(vdt[o++]=r>>6|192,vdt[o++]=63&r|128):55296==(64512&r)&&56320==(64512&(a=t.charCodeAt(e+1)))?(r=65536+((1023&r)<<10)+(1023&a),e++,vdt[o++]=r>>18|240,vdt[o++]=r>>12&63|128,vdt[o++]=r>>6&63|128,vdt[o++]=63&r|128):(vdt[o++]=r>>12|224,vdt[o++]=r>>6&63|128,vdt[o++]=63&r|128);i=o-bdt-n}else i=r(t,bdt+n);i<32?vdt[bdt++]=160|i:i<256?(n<2&&vdt.copyWithin(bdt+2,bdt+1,bdt+1+i),vdt[bdt++]=217,vdt[bdt++]=i):i<65536?(n<3&&vdt.copyWithin(bdt+3,bdt+2,bdt+2+i),vdt[bdt++]=218,vdt[bdt++]=i>>8,vdt[bdt++]=255&i):(n<5&&vdt.copyWithin(bdt+5,bdt+3,bdt+3+i),vdt[bdt++]=219,xdt.setUint32(bdt,i),bdt+=4),bdt+=i}else if("number"===n)if(t>>>0===t)t<32||t<128&&!1===this.useRecords||t<64&&!this.randomAccessStructure?vdt[bdt++]=t:t<256?(vdt[bdt++]=204,vdt[bdt++]=t):t<65536?(vdt[bdt++]=205,vdt[bdt++]=t>>8,vdt[bdt++]=255&t):(vdt[bdt++]=206,xdt.setUint32(bdt,t),bdt+=4);else if((0|t)===t)t>=-32?vdt[bdt++]=256+t:t>=-128?(vdt[bdt++]=208,vdt[bdt++]=t+256):t>=-32768?(vdt[bdt++]=209,xdt.setInt16(bdt,t),bdt+=2):(vdt[bdt++]=210,xdt.setInt32(bdt,t),bdt+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let i;if(vdt[bdt++]=202,xdt.setFloat32(bdt,t),e<4||(0|(i=t*adt[(127&vdt[bdt])<<1|vdt[bdt+1]>>7]))===i)return void(bdt+=4);bdt--}vdt[bdt++]=203,xdt.setFloat64(bdt,t),bdt+=8}else if("object"===n||"function"===n)if(t){if(s){let i=s.get(t);if(i){if(!i.id){let t=s.idsToInsert||(s.idsToInsert=[]);i.id=t.push(i)}return vdt[bdt++]=214,vdt[bdt++]=112,xdt.setUint32(bdt,i.id),void(bdt+=4)}s.set(t,{offset:bdt-e})}let r=t.constructor;if(r===Object)E(t);else if(r===Array)y(t);else if(r===Map)if(this.mapAsEmptyObject)vdt[bdt++]=128;else{(i=t.size)<16?vdt[bdt++]=128|i:i<65536?(vdt[bdt++]=222,vdt[bdt++]=i>>8,vdt[bdt++]=255&i):(vdt[bdt++]=223,xdt.setUint32(bdt,i),bdt+=4);for(let[e,i]of t)x(e),x(i)}else{for(let e=0,i=udt.length;e<i;e++)if(t instanceof cdt[e]){let i=udt[e];if(i.write){i.type&&(vdt[bdt++]=212,vdt[bdt++]=i.type,vdt[bdt++]=0);let e=i.write.call(this,t);return void(e===t?Array.isArray(t)?y(t):E(t):x(e))}let n,s=vdt,r=xdt,a=bdt;vdt=null;try{n=i.pack.call(this,t,t=>(vdt=s,s=null,bdt+=t,bdt>wdt&&S(bdt),{target:vdt,targetView:xdt,position:bdt-t}),x)}finally{s&&(vdt=s,xdt=r,bdt=a,wdt=vdt.length-10)}return void(n&&(n.length+bdt>wdt&&S(n.length+bdt),bdt=Adt(n,vdt,bdt,i.type)))}if(Array.isArray(t))y(t);else{if(t.toJSON){const e=t.toJSON();if(e!==t)return x(e)}if("function"===n)return x(this.writeFunction&&this.writeFunction(t));E(t)}}}else vdt[bdt++]=192;else if("boolean"===n)vdt[bdt++]=t?195:194;else if("bigint"===n){if(t<0x8000000000000000&&t>=-0x8000000000000000)vdt[bdt++]=211,xdt.setBigInt64(bdt,t);else if(t<0x10000000000000000&&t>0)vdt[bdt++]=207,xdt.setBigUint64(bdt,t);else{if(!this.largeBigIntToFloat){if(this.largeBigIntToString)return x(t.toString());if(this.useBigIntExtension||this.moreTypes){let e,i=t<0?BigInt(-1):BigInt(0);if(t>>BigInt(65536)===i){let n=BigInt(0x10000000000000000)-BigInt(1),s=[];for(;s.push(t&n),t>>BigInt(63)!==i;)t>>=BigInt(64);e=new Uint8Array(new BigUint64Array(s).buffer),e.reverse()}else{let i=t<0,n=(i?~t:t).toString(16);if(n.length%2?n="0"+n:parseInt(n.charAt(0),16)>=8&&(n="00"+n),fdt)e=Buffer.from(n,"hex");else{e=new Uint8Array(n.length/2);for(let t=0;t<e.length;t++)e[t]=parseInt(n.slice(2*t,2*t+2),16)}if(i)for(let t=0;t<e.length;t++)e[t]=~e[t]}return e.length+bdt>wdt&&S(e.length+bdt),void(bdt=Adt(e,vdt,bdt,66))}throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}vdt[bdt++]=203,xdt.setFloat64(bdt,Number(t))}bdt+=8}else{if("undefined"!==n)throw new Error("Unknown type: "+n);this.encodeUndefinedAsNil?vdt[bdt++]=192:(vdt[bdt++]=212,vdt[bdt++]=0,vdt[bdt++]=0)}},w=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?t=>{let e;if(this.skipValues){e=[];for(let i in t)"function"==typeof t.hasOwnProperty&&!t.hasOwnProperty(i)||this.skipValues.includes(t[i])||e.push(i)}else e=Object.keys(t);let i,n=e.length;if(n<16?vdt[bdt++]=128|n:n<65536?(vdt[bdt++]=222,vdt[bdt++]=n>>8,vdt[bdt++]=255&n):(vdt[bdt++]=223,xdt.setUint32(bdt,n),bdt+=4),this.coercibleKeyAsNumber)for(let s=0;s<n;s++){i=e[s];let n=Number(i);x(isNaN(n)?i:n),x(t[i])}else for(let s=0;s<n;s++)x(i=e[s]),x(t[i])}:t=>{vdt[bdt++]=222;let i=bdt-e;bdt+=2;let n=0;for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&(x(e),x(t[e]),n++);if(n>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');vdt[i+++e]=n>>8,vdt[i+e]=255&n},b=!1===this.useRecords?w:t.progressiveRecords&&!c?t=>{let i,s,r=n.transitions||(n.transitions=Object.create(null)),a=bdt++-e;for(let o in t)if("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(o)){if(i=r[o],i)r=i;else{let h=Object.keys(t),l=r;r=n.transitions;let u=0;for(let t=0,e=h.length;t<e;t++){let e=h[t];i=r[e],i||(i=r[e]=Object.create(null),u++),r=i}a+e+1==bdt?(bdt--,_(r,h,u)):C(r,h,a,u),s=!0,r=l[o]}x(t[o])}if(!s){let i=r[Sdt];i?vdt[a+e]=i:C(r,Object.keys(t),a,0)}}:t=>{let e,i=n.transitions||(n.transitions=Object.create(null)),s=0;for(let n in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(n))&&(e=i[n],e||(e=i[n]=Object.create(null),s++),i=e);let r=i[Sdt];r?r>=96&&c?(vdt[bdt++]=96+(31&(r-=96)),vdt[bdt++]=r>>5):vdt[bdt++]=r:_(i,i.__keys__||Object.keys(t),s);for(let e in t)("function"!=typeof t.hasOwnProperty||t.hasOwnProperty(e))&&x(t[e])},T="function"==typeof this.useRecords&&this.useRecords,E=T?t=>{T(t)?b(t):w(t)}:b,S=t=>{let i;if(t>16777216){if(t-e>mdt)throw new Error("Packed buffer would be larger than maximum buffer size");i=Math.min(mdt,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else i=1+(Math.max(t-e<<2,vdt.length-1)>>12)<<12;let n=new pdt(i);return xdt=n.dataView||(n.dataView=new DataView(n.buffer,0,i)),t=Math.min(t,vdt.length),vdt.copy?vdt.copy(n,0,e,t):n.set(vdt.slice(e,t)),bdt-=e,e=0,wdt=n.length-10,vdt=n},_=(t,e,s)=>{let r=n.nextId;r||(r=64),r<d&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(r=n.nextOwnId,r<f||(r=d),n.nextOwnId=r+1):(r>=f&&(r=d),n.nextId=r+1);let a=e.highByte=r>=96&&c?r-96>>5:-1;t[Sdt]=r,t.__keys__=e,n[r-64]=e,r<d?(e.isShared=!0,n.sharedLength=r-63,i=!0,a>=0?(vdt[bdt++]=96+(31&r),vdt[bdt++]=a):vdt[bdt++]=r):(a>=0?(vdt[bdt++]=213,vdt[bdt++]=114,vdt[bdt++]=96+(31&r),vdt[bdt++]=a):(vdt[bdt++]=212,vdt[bdt++]=114,vdt[bdt++]=r),s&&(g+=m*s),p.length>=u&&(p.shift()[Sdt]=0),p.push(t),x(e))},C=(t,i,n,s)=>{let r=vdt,a=bdt,o=wdt,h=e;vdt=ydt,bdt=0,e=0,vdt||(ydt=vdt=new pdt(8192)),wdt=vdt.length-10,_(t,i,s),ydt=vdt;let l=bdt;if(vdt=r,bdt=a,wdt=o,e=h,l>1){let t=bdt+l-1;t>wdt&&S(t);let i=n+e;vdt.copyWithin(i+l,i+1,bdt),vdt.set(ydt.slice(0,l),i),bdt=t}else vdt[n+e]=ydt[0]},A=t=>{let s=(void 0)(t,vdt,e,bdt,n,S,(t,e,n)=>{if(n)return i=!0;bdt=e;let s=vdt;return x(t),v(),s!==vdt?{position:bdt,targetView:xdt,target:vdt}:bdt},this);if(0===s)return E(t);bdt=s}}useBuffer(t){vdt=t,vdt.dataView||(vdt.dataView=new DataView(vdt.buffer,vdt.byteOffset,vdt.byteLength)),xdt=vdt.dataView,bdt=0}set position(t){bdt=t}get position(){return bdt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}({useRecords:!1});const Rdt=Pdt.pack;Pdt.pack;const Ldt=512,Odt=1024,Fdt=2048;class kdt{constructor(t){this.scene=t,this.players={},this.ws=null,this.myId=null,this.connect(),this.last={type:null,data:null},this.messageQueue=[],this.processingQueue=!1}connect(){this.server=JSON.parse(localStorage.getItem("server")),this.ws=new WebSocket(this.server.path),this.ws.addEventListener("open",()=>{}),this.ws.addEventListener("message",async t=>{let e,i;try{i=await t.data.arrayBuffer(),e=hdt(i)}catch(t){return}this.messageQueue.push(e),this.processingQueue||this.processMessageQueue()}),this.ws.addEventListener("close",()=>{this.scene.errorModal.throwError("Disconnected from server.<br></br>Websocket closed connection.")})}processMessageQueue(){this.processingQueue=!0;const t=()=>{if(0===this.messageQueue.length)return void(this.processingQueue=!1);const e=this.messageQueue.shift(),{type:i,data:s}=e;switch(this.last={type:i,data:s},i){case"addPlayer":this.addPlayer(s);break;case"loggedIn":this.scene.connectingOverlay.remove(),this.scene.inputManager.hud.container.style.display="block",Object.values(s.players).forEach(t=>this.addPlayer(t)),this.scene.player=this.addPlayer(s.player),this.myId=s.player.id,this.scene.physics.add.collider(this.scene.player.sprite,this.scene.collisionGroup),this.scene.cameras.main.startFollow(this.scene.player.sprite,!0,.1,.1,.5,.5),this.scene.cameras.main.roundPixels=!0;const t=s.player.roles||[];this.scene.canEditMap=t.includes("superadmin"),this.scene.inputManager.updateEditorVisibility();break;case"chatmessage":if(!this.players[s.id])return;this.players[s.id].say(s.message,s.isCommandResponse),this.scene.inputManager.hud.getComponent("chatbox").addMessage(s.user,s.message,s.isCommandResponse);break;case"localBubble":this.scene.player.say(s.message,s.isCommandResponse);break;case"playerMoved":if(!this.scene.player||s.id==this.scene.player.id)return;const e=this.players[s.id];e&&e.setPosition(s.x,s.y,!0);break;case"removePlayer":this.players[s]&&(this.players[s].destroy(),delete this.players[s]);break;case"time":this.scene.lightManager.timeSeconds=s.time;break;case"connected":this.send("login",{...n(),range:this.scene.getCameraInfo().maxSize});break;case"loginError":this.scene.connectingOverlay.textString=s.error,this.scene.connectingOverlay.show();break;case"disconnect":this.scene.errorModal.throwError("Disconnected from server.");break;case"kick":this.scene.errorModal.throwError("You are kicked from this server.<br>"+s);break;case"typing":if(!this.players[s.id])return;this.players[s.id].chat.setTyping(s.status||!1);break;case"chunks":case"loadChunks":s.chunks&&Array.isArray(s.chunks)&&this.scene.mapObjects.loadChunksData(s.chunks);break;case"unloadChunks":s.chunks&&Array.isArray(s.chunks)&&this.scene.mapObjects.unloadChunksData(s.chunks);break;case"tiles":s.tiles&&Array.isArray(s.tiles)&&(this.scene.tileManager.loadTilesFromData(s.tiles),this.scene.tileManager.create());break;case"setTile":this.scene.tileManager&&void 0!==s.x&&void 0!==s.y&&s.type&&(this.scene.tileManager.tiles[s.x][s.y]={type:s.type},this.scene.tileManager.renderTile(s.x,s.y),this.scene.tileManager.updateTexture());break;case"map":this.scene.mapObjects.loadJsonMap(s.map);break;case"createElement":this.scene.mapObjects.create(s.id,this.scene,s.x,s.y,s.options);break;case"deleteElement":this.scene.mapObjects.destroyByServerId(s.options?.serverId);break;case"moveElement":this.scene.mapObjects.moveByServerId(s.options?.serverId,s.x,s.y)}requestAnimationFrame(t)};t()}send(t,e){this.last={type:t,data:e};const i=Rdt({type:t,data:e});this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(i)}addPlayer({id:t,uuid:e,username:i,display_name:n,x:s,y:r,avatar:a}){return this.players[t]=new fct(this.scene,t,e,i,n,s,r,a)}emitChatMessage(t,e=!1){this.send("chat",{message:t,isCommandResponse:e})}emitExportElements(t){this.send("exportElements",t)}emitRange(t){this.send("camerarange",{range:t})}emitMovement(t,e){this.send("playerMovement",{x:t,y:e})}emitCreateElement(t){this.send("createElement",this.scene.mapObjects.exportElement(t))}emitDeleteElement(t){this.send("deleteElement",this.scene.mapObjects.exportElement(t))}emitMoveElement(t){this.send("moveElement",this.scene.mapObjects.exportElement(t))}emitTyping(t){this.send("typing",{status:t})}}class Ddt{constructor(t,e={}){this.scene=t,this.textString=e.text||"Connecting...",this.fontSize=e.fontSize||32,this.depth="number"==typeof e.depth?e.depth:10248,this.container=null,this.visible=!1}_createElements(){if(this.container)return;const t=this.scene.scale.width,e=this.scene.scale.height,i=this.scene.add.rectangle(0,0,t,e,2236962).setOrigin(0,0),n=Math.floor(t/2),s=Math.floor(e/2),r=this.scene.add.bitmapText(n,s,"hawkpixelated",this.textString,this.fontSize,aut.GameObjects.BitmapText.ALIGN_LEFT).setOrigin(.5,.5);this.container=this.scene.add.container(0,0,[i,r]).setDepth(this.depth).setVisible(!1),this._bg=i,this._text=r,this._tween=this.scene.tweens.add({targets:this._text,alpha:{from:1,to:.4},duration:700,yoyo:!0,repeat:-1,paused:!0}),this._resizeHandler=()=>{const t=this.scene.scale.width,e=this.scene.scale.height;this._bg.setSize(t,e),this._text.setPosition(Math.floor(t/2),Math.floor(e/2))},this.scene.scale&&this.scene.scale.on&&this.scene.scale.on("resize",this._resizeHandler)}show(){this._createElements(),this.container&&!this.visible&&(this.container.setVisible(!0),this._tween&&this._tween.play(),this.visible=!0)}remove(){this.container&&(this._tween&&(this._tween.stop(),this._tween=null),this.scene.scale&&this.scene.scale.off&&this._resizeHandler&&(this.scene.scale.off("resize",this._resizeHandler),this._resizeHandler=null),this.container.removeAll(!0),this.container.destroy(),this.container=null,this._bg=null,this._text=null,this.visible=!1)}}class Idt{constructor(t,e={}){this.scene=t,this.game=t.sys.game,this.totalMinutes=e.timeMinutes??24,this.totalSeconds=60*this.totalMinutes,this.running=e.startRunning??!0,this.timeSeconds=60*(e.startAtMinutes??12),this.timeScale=e.timeScale??.5,this.nightColor=e.nightColor??132634,this.nightAlpha=e.nightAlpha??.7,this.totalMinutes,this.phasesMinutes=e.phasesMinutes??[{start:0,color:657952,alpha:.8},{start:3,color:986922,alpha:.75},{start:5,color:1710650,alpha:.65},{start:5.5,color:2760784,alpha:.55},{start:6,color:4862064,alpha:.4},{start:6.5,color:9064592,alpha:.25},{start:7,color:13660256,alpha:.15},{start:7.5,color:15769680,alpha:.08},{start:8,color:16769152,alpha:.03},{start:9,color:16773312,alpha:0},{start:12,color:16777215,alpha:0},{start:15,color:16775392,alpha:0},{start:17,color:16769184,alpha:.05},{start:17.5,color:16760960,alpha:.1},{start:18,color:16748640,alpha:.2},{start:18.5,color:13656192,alpha:.35},{start:19,color:8405152,alpha:.5},{start:19.5,color:4206752,alpha:.6},{start:20,color:2105504,alpha:.7},{start:21,color:1381712,alpha:.75},{start:23,color:855344,alpha:.8}],this.phases=this.phasesMinutes.slice().map((t,e)=>({start:aut.Math.Clamp(60*(t.start??0),0,this.totalSeconds),color:void 0!==t.color?t.color>>>0:void 0,alpha:void 0!==t.alpha?aut.Math.Clamp(t.alpha,0,1):void 0,index:e})).sort((t,e)=>t.start-e.start),this.lights=[],this._created=!1,this._rtKey="__light_manager_rt",this._rt=null,this._quad=null,this._camera=null,this._onResize=this._onResize.bind(this),this._lastPhase=null,this._phaseCallbacks=[],this._timeCallbacks=[],this.overlayEvaluator=e.overlayEvaluator??this._defaultOverlayEvaluator.bind(this),this._glowPipeline=null,this._useLowQuality="low"==Fut.get("quality"),this._mergedLights=[],this._lightBridges=[],this._lastCamX=0,this._lastCamY=0,this._updateCounter=0,this._time=0,this._lightPulseOffsets=new Map,this._skipFrames=0,this._renderQuality=this._useLowQuality?.35:.6}create(t="lightRadial",e="imageMask"){if(this._created)return;const i=this.scene.cameras.main;this._camera=i;const n=i.width,s=i.height,r=`__light_manager_rt_${Date.now()}`;if(this.scene.textures.exists(this._rtKey))try{this.scene.textures.remove(this._rtKey)}catch(t){}this._rtKey=r,this._rt=this.scene.make.renderTexture({width:Math.floor(n*this._renderQuality),height:Math.floor(s*this._renderQuality),key:r}),this._quad=this.scene.add.image(0,0).setOrigin(0,0).setScrollFactor(0).setDepth(5e3),this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(r),this._quad.setDisplaySize(n,s),this.scene.textures.exists(t)||console.warn(`LightManager: radial texture "${t}" not found.`),this._lightSprite=this.scene.add.image(0,0,t).setVisible(!1).setOrigin(.5),this._maskKey=e,this.scene.scale.on("resize",this._onResize);try{const t=aut.Renderer?.WebGL?.Pipelines?.PostFXPipeline;t&&this.scene.renderer.pipelines&&this._setupGlowPipeline()}catch(t){console.warn("LightManager: Could not setup glow pipeline",t)}this._created=!0}_setupGlowPipeline(){try{const t="\n        precision mediump float;\n        uniform sampler2D uMainSampler;\n        uniform vec2 uResolution;\n        uniform float uGlowStrength;\n        varying vec2 outTexCoord;\n        \n        void main() {\n          vec4 color = texture2D(uMainSampler, outTexCoord);\n          vec4 glow = vec4(0.0);\n          \n          float blur = uGlowStrength / uResolution.x;\n          \n          // Solo 9 muestras (cruz + diagonales)\n          glow += texture2D(uMainSampler, outTexCoord + vec2(-blur, 0.0)) * 0.12;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(blur, 0.0)) * 0.12;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(0.0, -blur)) * 0.12;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(0.0, blur)) * 0.12;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(-blur, -blur)) * 0.08;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(blur, -blur)) * 0.08;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(-blur, blur)) * 0.08;\n          glow += texture2D(uMainSampler, outTexCoord + vec2(blur, blur)) * 0.08;\n          glow += color * 0.2;\n          \n          gl_FragColor = color + glow * 0.8;\n        }\n      ";if(this._quad&&this._quad.setPostPipeline){const e=this.scene.renderer.pipelines.addPostPipeline("LightGlow",t);e&&(this._glowPipeline=e,this._quad.setPostPipeline(e))}}catch(t){console.warn("LightManager: Glow pipeline setup failed",t)}}static _lerpColor(t,e,i){const n=aut.Display.Color.IntegerToColor(t>>>0),s=aut.Display.Color.IntegerToColor(e>>>0),r=Math.round(aut.Math.Linear(n.red,s.red,i)),a=Math.round(aut.Math.Linear(n.green,s.green,i)),o=Math.round(aut.Math.Linear(n.blue,s.blue,i));return aut.Display.Color.GetColor(r,a,o)}_defaultOverlayEvaluator(t){const e=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds;let i=-1;for(let t=this.phases.length-1;t>=0;t--)if(e>=this.phases[t].start){i=t;break}-1===i&&(i=this.phases.length-1);const n=this.phases[i],s=(i+1)%this.phases.length,r=this.phases[s];let a=r.start-n.start;a<=0&&(a+=this.totalSeconds);let o=e-n.start;o<0&&(o+=this.totalSeconds);const h=a>0?aut.Math.Clamp(o/a,0,1):0,l=void 0!==n.color?n.color>>>0:this.nightColor,u=void 0!==n.alpha?n.alpha:this.nightAlpha,c=void 0!==r.color?r.color>>>0:this.nightColor,d=void 0!==r.alpha?r.alpha:this.nightAlpha;return{color:Idt._lerpColor(l,c,h),alpha:aut.Math.Clamp(aut.Math.Linear(u,d,h),0,1),progress:h,phaseIndex:i}}_mergeLights(t,e,i,n){this._mergedLights=[],this._lightBridges=[];const s=this.lights.filter(s=>{const r=s.x-t,a=s.y-e,o=s.radius||128;return r+o>=-50&&r-o<=i+50&&a+o>=-50&&a-o<=n+50});if(s.forEach(t=>{this._mergedLights.push({x:t.x,y:t.y,radius:t.radius||128,color:t.color||16777215,alpha:t.alpha||1,intensity:t.intensity||1,mask:t.mask,_original:!0})}),s.length>1)for(let t=0;t<s.length;t++){const e=s[t];for(let i=t+1;i<s.length;i++){const t=s[i],n=t.x-e.x,r=t.y-e.y,a=n*n+r*r;if(a<22500&&a>1){const i=Math.sqrt(a),s=e.radius||128,o=t.radius||128,h=1-i/150,l=aut.Display.Color.IntegerToColor(e.color||16777215),u=aut.Display.Color.IntegerToColor(t.color||16777215),c=Math.max(1,Math.floor(i/60));for(let i=1;i<c;i++){const a=i/c,d=a*a*(3-2*a),f=e.x+n*d,p=e.y+r*d,g=f-e.x,m=p-e.y,v=f-t.x,y=p-t.y,x=Math.sqrt(g*g+m*m),w=Math.sqrt(v*v+y*y),b=Math.max(0,1-x/s),T=Math.max(0,1-w/o),E=b+T;if(E>.15){const i=b/E,n=(s*i+o*(1-i))*(.6+.4*h),r=aut.Display.Color.GetColor(Math.round(l.red*i+u.red*(1-i)),Math.round(l.green*i+u.green*(1-i)),Math.round(l.blue*i+u.blue*(1-i))),a=((e.alpha||1)*b+(t.alpha||1)*T)*h*.65,c=((e.intensity||1)*b+(t.intensity||1)*T)/E;this._lightBridges.push({x:f,y:p,radius:n,color:r,alpha:Math.min(a,1),intensity:c,mask:e.mask,_bridge:!0})}}}}}}update(t,e){if(!this._created)return;const i=(e??0)/1e3;this._time+=i,this.running&&(this.timeSeconds+=i*this.timeScale,this.timeSeconds>=this.totalSeconds&&(this.timeSeconds-=this.totalSeconds),this.timeSeconds<0&&(this.timeSeconds=(this.timeSeconds%this.totalSeconds+this.totalSeconds)%this.totalSeconds),this._timeCallbacks.forEach(t=>{try{t(this)}catch(t){}}));const n=this.overlayEvaluator(this.timeSeconds);n&&n.phaseIndex!==this._lastPhase&&(this._lastPhase=n.phaseIndex,this._phaseCallbacks.forEach(t=>{try{t(n,n.phaseIndex)}catch(t){}}));const s=this._camera||this.scene.cameras.main,r=s.width,a=s.height,o=s.zoom||1;if(!this._rt||!this._rt.texture)return void console.warn("LightManager.update: missing RenderTexture");if(!this._quad)return;this._skipFrames++;const h=this._useLowQuality?2:1;if(this._skipFrames<h)return;this._skipFrames=0;const l=s.worldView&&"number"==typeof s.worldView.x?s.worldView.x:s.scrollX||0,u=s.worldView&&"number"==typeof s.worldView.y?s.worldView.y:s.scrollY||0;this._updateCounter++,(this._updateCounter%(this._useLowQuality?5:3)==0||Math.abs(l-this._lastCamX)>80||Math.abs(u-this._lastCamY)>80)&&(this._mergeLights(l,u,r,a),this._lastCamX=l,this._lastCamY=u),this._rt.clear();const c=aut.Display.Color.IntegerToColor(n.color??this.nightColor),d=aut.Display.Color.GetColor(c.red,c.green,c.blue),f=aut.Math.Clamp(n.alpha??this.nightAlpha,0,1);this._rt.fill(d,f);const p="number"==typeof s.x?s.x:0,g="number"==typeof s.y?s.y:0,m=(t,e=1,i=1)=>{if(!t)return;const n=((t.x-l)*o+p)*this._renderQuality,s=((t.y-u)*o+g)*this._renderQuality;if(!this._lightSprite||!this._lightSprite.texture)return;const r=`${Math.round(t.x/10)}_${Math.round(t.y/10)}`;this._lightPulseOffsets.has(r)||this._lightPulseOffsets.set(r,Math.random()*Math.PI*2);const a=this._lightPulseOffsets.get(r),h=.5*this._time+a,c=.035*Math.sin(h)+.025*Math.sin(1.5*h)+1,d=.025*Math.sin(.5*h),f=(t._original?1.2:.9)*i,m=aut.Math.Clamp(t.alpha*(t.intensity??1)*f*c*e,0,1),v=t.radius/64*this._renderQuality*o,y=v*(1+d),x=v*(1-.5*d);this._lightSprite.setPosition(n,s).setAlpha(m).setTint(t.color).setScale(y,x).setRotation(.015*h),this._rt.draw(this._lightSprite),m>.3&&t._original&&(this._lightSprite.setAlpha(.35*m).setScale(1.5*y,1.5*x),this._rt.draw(this._lightSprite))};if(this._lightBridges&&this._lightBridges.length>0)for(let t=0;t<this._lightBridges.length;t++)m(this._lightBridges[t],.75,1);for(let t=0;t<this._mergedLights.length;t++)m(this._mergedLights[t],1,1);if(this._rt&&this._rt.texture&&this._quad.texture!==this._rt.texture?(this._quad.setTexture(this._rt.texture),this._quad.setDisplaySize(r,a)):this._quad.setDisplaySize(r,a),this._quad.setBlendMode(aut.BlendModes.MULTIPLY),this._glowPipeline&&this._glowPipeline.set2f&&this._glowPipeline.set1f)try{this._glowPipeline.set2f("uResolution",r,a),this._glowPipeline.set1f("uGlowStrength",this._useLowQuality?4:6)}catch(t){}}addLight(t,e,i=128,n=16777215,s=1,r=1,a=null){if(this.lights.length>=64)return null;const o={x:t??0,y:e??0,radius:i??128,color:n>>>0,alpha:aut.Math.Clamp(s,0,1),intensity:r??1,mask:a??this._maskKey};return this.lights.push(o),o}removeLightObj(t){const e=this.lights.indexOf(t);-1!==e&&this.lights.splice(e,1)}clearLights(){this.lights.length=0,this._mergedLights=[],this._lightBridges=[]}setNightAlpha(t){this.nightAlpha=aut.Math.Clamp(t,0,1)}setNightColor(t){this.nightColor=t>>>0}start(){this.running=!0}pause(){this.running=!1}reset(){this.timeSeconds=0}setTime(t){this.timeSeconds=(t%this.totalSeconds+this.totalSeconds)%this.totalSeconds}getTime(){return this.timeSeconds}getTimeF(){const t=Fut.get("use12hFormat");let e=Math.floor(this.timeSeconds/60);const i=Math.floor(this.timeSeconds%60);if(t){const t=e>=12?"PM":"AM";return e%=12,0===e&&(e=12),e+":"+String(i).padStart(2,"0")+" "+t}return String(e).padStart(2,"0")+":"+String(i).padStart(2,"0")}setTimeMinutes(t){this.setTime(60*t)}getTimeMinutes(){return this.timeSeconds/60}onPhaseChange(t){"function"==typeof t&&this._phaseCallbacks.push(t)}onTimeChange(t){"function"==typeof t&&this._timeCallbacks.push(t)}_onResize(){const t=this.scene.cameras.main,e=t.width,i=t.height;this._rt&&(this._rt.destroy(),this._rt=this.scene.make.renderTexture({width:Math.floor(e*this._renderQuality),height:Math.floor(i*this._renderQuality),key:this._rtKey}),this._quad&&(this._rt&&this._rt.texture?this._quad.setTexture(this._rt.texture):this._quad.setTexture(this._rtKey),this._quad.setDisplaySize(e,i)))}destroy(){if(this._quad){if(this._glowPipeline)try{this._quad.resetPostPipeline()}catch(t){}this._quad.destroy(),this._quad=null}this._lightSprite&&(this._lightSprite.destroy(),this._lightSprite=null),this._rt&&(this._rt.destroy(),this._rt=null),this.scene.scale.off("resize",this._onResize),this._created=!1,this._mergedLights=[],this._lightBridges=[]}}class Bdt{constructor(t,{mapPixelWidth:e=2048,mapPixelHeight:i=2048,tileSize:n=32}={}){this.scene=t,this.tileSize=n,this.widthPx=e,this.heightPx=i,this.cols=Math.ceil(this.widthPx/this.tileSize),this.rows=Math.ceil(this.heightPx/this.tileSize),this.tiles=Array.from({length:this.cols},()=>Array.from({length:this.rows},()=>({type:"grass"}))),this.canvas=document.createElement("canvas"),this.canvas.width=this.widthPx,this.canvas.height=this.heightPx,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.sprite=null,this.setupTextures(),this.setupRules()}setupTextures(){const t=this.scene.textures.get("dirt"),e=this.scene.textures.get("grass2");if(!t||!e)throw new Error("Require textures 'dirt' and 'grass2' loaded in scene.");this.dirtImage=t.getSourceImage(),this.grassImage=e.getSourceImage()}setupRules(){this.rules=[{name:"air",test:t=>!t.self},{name:"grass_isolated",test:t=>t.self&&0===t.totalAdjacent},{name:"grass_horizontal_interior",test:t=>t.self&&t.w&&t.e&&!t.n&&!t.s,out:"grass"},{name:"grass_left",test:t=>t.self&&t.w&&!t.e&&!t.n&&!t.s,out:"grass_left"},{name:"grass_right",test:t=>t.self&&t.e&&!t.w&&!t.n&&!t.s,out:"grass_right"},{name:"grass_vertical_interior",test:t=>t.self&&t.n&&t.s&&!t.w&&!t.e,out:"grass"},{name:"grass_top",test:t=>t.self&&t.n&&!t.s&&!t.w&&!t.e,out:"grass_top"},{name:"grass_bottom",test:t=>t.self&&t.s&&!t.n&&!t.w&&!t.e,out:"grass_bottom"},{name:"grass_bottom_edges",test:t=>t.self&&t.s&&!t.n&&t.w&&t.e,out:"grass_bottom"},{name:"grass_bottom_left",test:t=>t.self&&t.s&&!t.n&&t.w&&!t.e,out:"grass_bottom_left"},{name:"grass_bottom_right",test:t=>t.self&&t.s&&!t.n&&t.e&&!t.w,out:"grass_bottom_right"},{name:"grass_top_edges",test:t=>t.self&&t.n&&!t.s&&t.w&&t.e,out:"grass_top"},{name:"grass_top_left",test:t=>t.self&&t.n&&!t.s&&t.w&&!t.e,out:"grass_top_left"},{name:"grass_top_right",test:t=>t.self&&t.n&&!t.s&&t.e&&!t.w,out:"grass_top_right"},{name:"grass_left_mixed",test:t=>t.self&&t.w&&!t.e&&(t.n||t.s),out:"grass_left"},{name:"grass_right_mixed",test:t=>t.self&&t.e&&!t.w&&(t.n||t.s),out:"grass_right"},{name:"grass_topleft_min",test:t=>t.self&&!t.se&&(t.s||t.e),out:"grass_top_left_min"},{name:"grass_topright_min",test:t=>t.self&&!t.sw&&(t.s||t.w),out:"grass_top_right_min"},{name:"grass_bottomleft_min",test:t=>t.self&&!t.ne&&(t.n||t.e),out:"grass_bottom_left_min"},{name:"grass_bottomright_min",test:t=>t.self&&!t.nw&&(t.n||t.w),out:"grass_bottom_right_min"},{name:"grass_fallback",test:t=>t.self,out:"grass"}],this.types={grass:{rand:[{x:13,y:0},{x:14,y:0},{x:15,y:0},{x:12,y:1},{x:13,y:1},{x:14,y:1},{x:15,y:1},{x:12,y:2},{x:13,y:2},{x:14,y:2},{x:15,y:2},{x:12,y:3},{x:13,y:3},{x:14,y:3},{x:15,y:3}]},air:{x:11,y:0},grass_top_left_min:{x:0,y:3},grass_bottom_left_min:{x:0,y:5},grass_bottom_right_min:{x:2,y:5},grass_top_right_min:{x:2,y:3},grass_top:{rand:[{x:1,y:3},{x:1,y:2}]},grass_bottom:{rand:[{x:1,y:5},{x:1,y:0}]},grass_left:{rand:[{x:0,y:4},{x:2,y:1}]},grass_right:{rand:[{x:2,y:4},{x:0,y:1}]},grass_bottom_left:{x:2,y:0},grass_bottom_right:{x:0,y:0},grass_top_right:{x:0,y:2},grass_top_left:{x:2,y:2}}}loadTilesFromData(t=[]){t.forEach(t=>{const{x:e,y:i,type:n}=t;e>=0&&e<this.cols&&i>=0&&i<this.rows&&(this.tiles[e][i]={type:n})})}exportTiles(){const t=[];for(let e=0;e<this.cols;e++)for(let i=0;i<this.rows;i++)"grass"!==this.tiles[e][i].type&&t.push({x:e,y:i,type:this.tiles[e][i].type});return t}isGrass(t,e){return!(t<0||t>=this.cols||e<0||e>=this.rows)&&"grass"===this.tiles[t][e].type}neighbors4(t,e){return{n:this.isGrass(t,e-1),s:this.isGrass(t,e+1),w:this.isGrass(t-1,e),e:this.isGrass(t+1,e)}}neighbors8(t,e){return{nw:this.isGrass(t-1,e-1),ne:this.isGrass(t+1,e-1),sw:this.isGrass(t-1,e+1),se:this.isGrass(t+1,e+1)}}classify(t,e){const i=this.isGrass(t,e),n=this.neighbors4(t,e),s=this.neighbors8(t,e),r=[n.n,n.s,n.w,n.e,s.nw,s.ne,s.sw,s.se].filter(Boolean).length,a={self:i,...n,...s,totalAdjacent:r};for(const t of this.rules)if(t.test(a))return(t.out||t.name).toLowerCase();return"grass"}getRandomFrom(t){return t[Math.floor(Math.random()*t.length)]}setTile(t,e,i){const n=Math.floor(t/this.tileSize),s=Math.floor(e/this.tileSize);if(n>=0&&n<this.cols&&s>=0&&s<this.rows){this.tiles[n][s]={type:i};for(let t=-1;t<=1;t++)for(let e=-1;e<=1;e++){const i=n+t,r=s+e;i>=0&&i<this.cols&&r>=0&&r<this.rows&&this.renderTile(i,r)}return this.updateTexture(),{x:n,y:s,type:i}}return null}renderTile(t,e){const i=this.tiles[t][e],n=t*this.tileSize,s=e*this.tileSize;if("dirt"===i.type){const t=Math.floor(4*Math.random())*this.tileSize,e=Math.floor(4*Math.random())*this.tileSize;this.ctx.drawImage(this.dirtImage,t,e,this.tileSize,this.tileSize,n,s,this.tileSize,this.tileSize)}else{const i=Math.floor(4*Math.random())*this.tileSize,r=Math.floor(4*Math.random())*this.tileSize;this.ctx.drawImage(this.dirtImage,i,r,this.tileSize,this.tileSize,n,s,this.tileSize,this.tileSize);const a=this.classify(t,e),o=this.types[a];if(o){let t=o;o.rand&&(t=this.getRandomFrom(o.rand));const e=t.x*this.tileSize,i=t.y*this.tileSize;this.ctx.drawImage(this.grassImage,e,i,this.tileSize,this.tileSize,n,s,this.tileSize,this.tileSize)}}}renderAll(){this.ctx.clearRect(0,0,this.widthPx,this.heightPx);for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)this.renderTile(e,t);this.updateTexture()}updateTexture(){const t="floor_dynamic";this.scene.textures.exists(t)&&this.scene.textures.remove(t),this.scene.textures.addCanvas(t,this.canvas),this.sprite?this.sprite.setTexture(t):this.sprite=this.scene.add.image(0,0,t).setOrigin(0).setDepth(-1e3)}create(){this.renderAll()}destroy(){const t="floor_dynamic";this.scene.textures.exists(t)&&this.scene.textures.remove(t),this.sprite&&this.sprite.destroy()}clearTiles(){this.tiles=Array.from({length:this.cols},()=>Array.from({length:this.rows},()=>({type:"grass"}))),this.renderAll()}loadTiles(t){this.clearTiles(),Array.isArray(t)&&t.forEach(t=>{const{x:e,y:i,type:n}=t;e>=0&&e<this.cols&&i>=0&&i<this.rows&&(this.tiles[e][i]={type:n})}),this.renderAll()}}class Ndt extends aut.GameObjects.Container{constructor(t,{textureKey:e="floor_dynamic",mapPixelWidth:i=2048,mapPixelHeight:n=2048,cellSize:s=32,tilemapWidth:r=null,tilemapHeight:a=null,baseTilemap:o=null}={}){super(t,0,0),this.scene=t,this.cellSize=s,this.textureKey=e,this.widthPx=i,this.heightPx=n,this.cols=r||Math.ceil(this.widthPx/this.cellSize),this.rows=a||Math.ceil(this.heightPx/this.cellSize),this.canvas=document.createElement("canvas"),this.canvas.width=this.widthPx,this.canvas.height=this.heightPx,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0});const h=t.textures.get("dirt"),l=t.textures.get("grass2");if(!h||!l)throw new Error("Require textures 'dirt' and 'grass2' loaded in scene.");this.dirtImage=h.getSourceImage(),this.grassImage=l.getSourceImage(),this.tilemapNames=Array.from({length:this.cols},()=>new Array(this.rows)),this.tilemapIds=Array.from({length:this.cols},()=>new Array(this.rows)),this.cells=Array.from({length:this.cols},()=>new Array(this.rows).fill(!1)),this.rules=[{name:"air",test:t=>!t.self},{name:"grass_isolated",test:t=>t.self&&0===t.totalAdjacent},{name:"grass_horizontal_interior",test:t=>t.self&&t.w&&t.e&&!t.n&&!t.s,out:"grass"},{name:"grass_left",test:t=>t.self&&t.w&&!t.e&&!t.n&&!t.s,out:"grass_left"},{name:"grass_right",test:t=>t.self&&t.e&&!t.w&&!t.n&&!t.s,out:"grass_right"},{name:"grass_vertical_interior",test:t=>t.self&&t.n&&t.s&&!t.w&&!t.e,out:"grass"},{name:"grass_top",test:t=>t.self&&t.n&&!t.s&&!t.w&&!t.e,out:"grass_top"},{name:"grass_bottom",test:t=>t.self&&t.s&&!t.n&&!t.w&&!t.e,out:"grass_bottom"},{name:"grass_bottom_edges",test:t=>t.self&&t.s&&!t.n&&t.w&&t.e,out:"grass_bottom"},{name:"grass_bottom_left",test:t=>t.self&&t.s&&!t.n&&t.w&&!t.e,out:"grass_bottom_left"},{name:"grass_bottom_right",test:t=>t.self&&t.s&&!t.n&&t.e&&!t.w,out:"grass_bottom_right"},{name:"grass_top_edges",test:t=>t.self&&t.n&&!t.s&&t.w&&t.e,out:"grass_top"},{name:"grass_top_left",test:t=>t.self&&t.n&&!t.s&&t.w&&!t.e,out:"grass_top_left"},{name:"grass_top_right",test:t=>t.self&&t.n&&!t.s&&t.e&&!t.w,out:"grass_top_right"},{name:"grass_left_mixed",test:t=>t.self&&t.w&&!t.e&&(t.n||t.s),out:"grass_left"},{name:"grass_right_mixed",test:t=>t.self&&t.e&&!t.w&&(t.n||t.s),out:"grass_right"},{name:"grass_topleft_min",test:t=>t.self&&!t.se&&(t.s||t.e),out:"grass_top_left_min"},{name:"grass_topright_min",test:t=>t.self&&!t.sw&&(t.s||t.w),out:"grass_top_right_min"},{name:"grass_bottomleft_min",test:t=>t.self&&!t.ne&&(t.n||t.e),out:"grass_bottom_left_min"},{name:"grass_bottomright_min",test:t=>t.self&&!t.nw&&(t.n||t.w),out:"grass_bottom_right_min"},{name:"grass_fallback",test:t=>t.self,out:"grass"}],this.types={grass:{rand:[{x:13,y:0},{x:14,y:0},{x:15,y:0},{x:12,y:1},{x:13,y:1},{x:14,y:1},{x:15,y:1},{x:12,y:2},{x:13,y:2},{x:14,y:2},{x:15,y:2},{x:12,y:3},{x:13,y:3},{x:14,y:3},{x:15,y:3}]},air:{x:11,y:0},grass_top_left_min:{x:0,y:3},grass_bottom_left_min:{x:0,y:5},grass_bottom_right_min:{x:2,y:5},grass_top_right_min:{x:2,y:3},grass_top:{rand:[{x:1,y:3},{x:1,y:2}]},grass_bottom:{rand:[{x:1,y:5},{x:1,y:0}]},grass_left:{rand:[{x:0,y:4},{x:2,y:1}]},grass_right:{rand:[{x:2,y:4},{x:0,y:1}]},grass_bottom_left:{x:2,y:0},grass_bottom_right:{x:0,y:0},grass_top_right:{x:0,y:2},grass_top_left:{x:2,y:2}},this.getRandomFrom=t=>t[Math.floor(Math.random()*t.length)],this.bitblt=(t,e,i,n,s,r,a,o=!1)=>{o?(this.ctx.save(),this.ctx.translate(r+n,a),this.ctx.scale(-1,1),this.ctx.drawImage(t,e,i,n,s,0,0,n,s),this.ctx.restore()):this.ctx.drawImage(t,e,i,n,s,r,a,n,s)};const u=t.textures.get("tilemap");if(u&&u.source&&u.source[0]){const t=u.getSourceImage(),e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d",{willReadFrequently:!0});i.drawImage(t,0,0);const n=i.getImageData(0,0,e.width,e.height);this.refWidth=e.width,this.refHeight=e.height,this.refData=n.data}else this.refWidth=0,this.refHeight=0,this.refData=null;this.getPixelGrass=(t,e)=>{if(!this.refData)return null;if(t<0||t>=this.refWidth||e<0||e>=this.refHeight)return null;const i=e*this.refWidth+t<<2,n=this.refData[i],s=this.refData[i+1],r=this.refData[i+2];return 0!==this.refData[i+3]&&(n+s+r)/3<128},this.isGrass=(t,e,i=t,n=e)=>{const s=this.getPixelGrass(t,e);if(null!==s)return s;if(!this.refData)return!1;const r=Math.max(0,Math.min(this.refWidth-1,i)),a=Math.max(0,Math.min(this.refHeight-1,n));return!0===this.getPixelGrass(r,a)},this.neighbors4=(t,e)=>({n:this.isGrass(t,e-1,t,e),s:this.isGrass(t,e+1,t,e),w:this.isGrass(t-1,e,t,e),e:this.isGrass(t+1,e,t,e)}),this.neighbors8=(t,e)=>({nw:this.isGrass(t-1,e-1,t,e),ne:this.isGrass(t+1,e-1,t,e),sw:this.isGrass(t-1,e+1,t,e),se:this.isGrass(t+1,e+1,t,e)}),this.classify=(t,e)=>{const i=this.isGrass(t,e),n=this.neighbors4(t,e),s=this.neighbors8(t,e),r=n.n,a=n.s,o=n.w,h=n.e,l=s.nw,u=s.ne,c=s.sw,d=s.se,f=[r,a,o,h,l,u,c,d].filter(Boolean).length,p={self:i,n:r,s:a,w:o,e:h,nw:l,ne:u,sw:c,se:d,totalAdjacent:f};for(const t of this.rules)if(t.test(p))return(t.out||t.name).toLowerCase();return"grass"};const c=32;for(let t=0;t<this.heightPx/c;t++)for(let e=0;e<this.widthPx/c;e++){const i=e*c,n=t*c,s=Math.floor(4*Math.random())*c,r=Math.floor(4*Math.random())*c;this.bitblt(this.dirtImage,s,r,c,c,i,n)}for(let t=0;t<this.cols;t++)for(let e=0;e<this.rows;e++){const i=this.classify(t,e);this.tilemapNames[t][e]=i;const n=this.types[i];if(this.tilemapIds[t][e]={...n.rand?{rand:n.rand.slice()}:n},this.tilemapIds[t][e].rand){const i=this.getRandomFrom(this.tilemapIds[t][e].rand);this.tilemapIds[t][e].x=i.x,this.tilemapIds[t][e].y=i.y}const s=this.tilemapIds[t][e].x*this.cellSize,r=this.tilemapIds[t][e].y*this.cellSize,a=t*this.cellSize,o=e*this.cellSize;this.bitblt(this.grassImage,s,r,this.cellSize,this.cellSize,a,o)}t.textures.exists(this.textureKey)&&t.textures.remove(this.textureKey),t.textures.addCanvas(this.textureKey,this.canvas),this.sprite=t.add.image(0,0,this.textureKey).setOrigin(0),this.add(this.sprite),t.add.existing(this)}destroy(t){this.scene.textures.exists(this.textureKey)&&this.scene.textures.remove(this.textureKey),super.destroy(t)}}class zdt{constructor(t=Date.now()){this._modulus=2**31,this._multiplier=1103515245,this._increment=12345,this._state=t%this._modulus}_nextState(){return this._state=(this._multiplier*this._state+this._increment)%this._modulus,this._state}getNextFloat(){return this._nextState()/this._modulus}getNextInt(t){if(t<=0)throw new Error("El parÃ¡metro max debe ser mayor que 0.");return Math.floor(this.getNextFloat()*t)}getNextIntRange(t,e){if(t>=e)throw new Error("min debe ser menor que max.");return t+this.getNextInt(e-t)}getNextBool(t=.5){if(t<0||t>1)throw new Error("p debe estar entre 0 y 1.");return this.getNextFloat()<t}}class Udt extends Uut{constructor(t,e){super(t,"Error",e)}throwError(t,e=()=>window.location.reload()){this.body.innerHTML=t,this.closeBtn.addEventListener("click",e),this.toggle()}}class Ydt extends aut.Scene{constructor(){super({key:"GameScene"}),this.zoom=1,this.minZoom=1,this.maxZoom=2,this.movementTimer=0,this.player=null,this.lastSentPos={x:null,y:null},this.errorModal=new Udt(document.getElementById("game-container"),this),this.dev=!1,this.floor=null,this.mapSize={width:2048,height:2048}}preload(){o(this,a())}create(){this._configureWorld(this.mapSize.width,this.mapSize.height),this.connectingOverlay=new Ddt(this),this.connectingOverlay.show(),this.tileManager=new Bdt(this,{mapPixelWidth:this.mapSize.width,mapPixelHeight:this.mapSize.height,tileSize:32}),this.lightManager=new Idt(this,{startAtMinutes:12}),this.inputManager=new cct(this),this.networkManager=new kdt(this),this.fpsElement=document.getElementById("fps-text"),this.lightManager.create(),this.random=new zdt(12344),this.mapObjects=new lct(this),this.collisionGroup=this.physics.add.group({immovable:!0}),this.input.on("pointerdown",t=>{(this.dev||this.canEditMap)&&"idle"!==this.inputManager.currentEditorMode&&this.inputManager.handleEditorClick(t.worldX,t.worldY)}),this.game.events.emit("gameLoad")}update(t,e){this.fpsElement.innerHTML="Engine - HawkEngine<br>"+this.game.renderer.constructor.name+" v"+this.game.renderer.gl.VERSION;const i=this.inputManager.getDirection();if(this.player){if(this.mapObjects.list.forEach(t=>{this.collisionGroup.contains(t.image)||this.collisionGroup.add(t.image),aut.Geom.Rectangle.Overlaps(this.player.sprite.getBounds(),t.image.getBounds())&&this.player.sprite.depth<t.image.depth?t.isOverlapping||(t.isOverlapping=!0,this.tweens.add({targets:t.image,alpha:.5,duration:150,ease:"Linear"})):t.isOverlapping&&(t.isOverlapping=!1,this.tweens.add({targets:t.image,alpha:1,duration:150,ease:"Linear"}))}),this.player.update(),this.player.updateMovement(i),this.movementTimer+=e,this.movementTimer>=100){const t=Math.floor(this.player.sprite.x),e=Math.floor(this.player.sprite.y),i=this.lastSentPos.x,n=this.lastSentPos.y;(i!==t||n!==e)&&(this.networkManager.emitMovement(t,e),this.lastSentPos.x=t,this.lastSentPos.y=e),this.movementTimer-=100}}else this.lastSentPos.x=null,this.lastSentPos.y=null;this.lightManager.update(t,e),this.mapObjects.update(t,e)}zoomIn(){const t=this.cameras.main,e=aut.Math.Clamp(this.zoom+1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}zoomOut(){const t=this.cameras.main,e=aut.Math.Clamp(this.zoom-1,this.minZoom,this.maxZoom);this.tweens.add({targets:t,zoom:e,duration:500,ease:"Sine.easeInOut",onComplete:()=>{this.zoom=e,this.networkManager.emitRange(this.getCameraInfo().maxSize/2)}})}getCameraInfo(t=this.cameras.main){const e=t.worldView.x,i=t.worldView.y,n=t.worldView.width,s=t.worldView.height;return{x:e,y:i,width:n,height:s,maxSize:Math.max(n,s)}}_configureWorld(t,e){this.physics.world.setBounds(0,0,t,e),this.cameras.main.setBounds(0,0,t,e)}isVisible(t,e){const i=t.worldView,n=e.getBounds();return aut.Geom.Intersects.RectangleToRectangle(i,n)}}class Xdt{constructor(t){const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),i=navigator.hardwareConcurrency<=4||navigator.deviceMemory<=4,n={banner:!1,parent:t,width:window.innerWidth,height:window.innerHeight,pixelArt:!0,render:{roundPixels:!0,preserveDrawingBuffer:!1,antialias:!1,antialiasGL:!1,powerPreference:e||i?"default":"high-performance",batchSize:e?1024:2048,maxTextures:e?8:16},physics:{default:"arcade",arcade:{debug:Fut.get("debug"),fps:e||i?30:60}},fps:{target:e||i?30:60,forceSetTimeOut:e},scene:[Ydt]};this.game=new aut.Game(n),this.resizeTimeout=null,window.addEventListener("resize",()=>{this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>this._onResize(),200)})}_onResize(){const t=Math.min(window.devicePixelRatio,2),e=window.innerWidth*t/2,i=window.innerHeight*t/2;this.game.scale.resize(e,i),this.game.renderer.resize(e,i)}}class Gdt extends aut.Scene{constructor(){super({key:"DashScene"}),this.player=null}preload(){o(this,a())}create(){this.floor=new Ndt(this,{mapPixelWidth:128,mapPixelHeight:128}),(async()=>{const t=await s(p,n()),e=t.id||"000_000000";this.player=new fct(this,e+"_b",e,t.username||"___","",64,82,t.game.avatar||""),this.player.sprite.setInteractive({draggable:!0}),this.player.chat.setTyping(!0)})()}update(t,e){this.player&&this.player.update({x:0,y:0})}}class Hdt{constructor(t){const e={banner:!1,parent:t,pixelArt:!0,width:128,height:128,physics:{default:"arcade",arcade:{}},scene:[Gdt]};this.game=new aut.Game(e)}}const Wdt=`\n<div class="auth">\n  <div class="main-header">\n    <button class="btn" id="discord">\n      <span><canv-icon src="${e.getBlob("assets/icons/flag.png").dataUrl}"></canv-icon>Join our <strong>Discord</strong> server</span>\n    </button>\n    <button class="btn" id="support">\n      <span><canv-icon src="${e.getBlob("assets/icons/kofi.png").dataUrl}"></canv-icon>Become a <strong>supporter</strong>!</span>\n    </button>\n    <button class="btn" id="install">\n      <span><canv-icon src="${e.getBlob("assets/icons/createintegration.png").dataUrl}"></canv-icon>Install <strong>Hawk</strong> App</span>\n    </button>\n  </div>\n  <hr>\n  <div style="margin-bottom: 10px;" id="preview"></div>\n  <button class="btn" id="play">\n    <div id="play-button">\n    <div id="title">\n      <div class="btn-text" style="display:none">Play on <strong id="server-name"></strong></div>\n      <div class="btn-spinner">Loading... <span class="loader"></span></div>\n    </div>\n    <div id="server-dropdown">\n      <div class="hamburger-menu">\n        <span class="bar bar1"></span>\n        <span class="bar bar2"></span>\n        <span class="bar bar3"></span>\n      </div>\n    </div>\n    </div>\n  </button>\n  <div id="server-dropdown-menu"></div>\n  <hr>\n  <div class="card" style="margin-top:14px">\n    <div style="display:flex;justify-content:space-between;align-items:center">\n      <div>\n        <div style="font-size:13px;color:var(--muted)">Server rules</div>\n      </div>\n      <div style="color:var(--muted);font-size:13px">#rules</div>\n    </div>\n\n    <ul id="ruleList" style="margin:12px 0 0 0;padding:0;list-style:none;display:grid;gap:8px"></ul>\n  </div>\n</div>\n`;var Vdt=Object.freeze({__proto__:null,options:{title:"Dashboard",auth:!0,description:"Sign in, and play on the community."},html:Wdt,render:function(){document.getElementById("app").innerHTML=Wdt;const t=document.getElementById("preview"),e=new Hdt(t),n=document.getElementById("discord"),s=document.getElementById("install"),a=document.getElementById("title"),o=a.querySelector(".btn-text"),h=a.querySelector(".btn-spinner"),l=document.querySelector("#ruleList"),u=document.querySelector("#server-dropdown"),c=document.querySelector("#server-dropdown-menu"),d=u.querySelector(".hamburger-menu"),f=document.querySelector("#server-name");let p=!0;function g(t){t?(a.classList.add("loading"),o.style.display="none",h.style.display="flex"):(a.classList.remove("loading"),o.style.display="flex",h.style.display="none")}function m(t){l.innerHTML="",t.forEach(t=>{l.innerHTML+=`<li style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)">\n        <div>\n          <div style="font-weight:600">${t.title}</div>\n          <div style="font-size:12px;color:var(--muted)">${t.description}</div>\n        </div>\n      </li>`})}n.addEventListener("click",()=>{location.href=v}),s.style.display=window.deferredInstallPrompt?s.style.display:"none",s.addEventListener("click",()=>{!async function(){window.deferredInstallPrompt&&(window.deferredInstallPrompt.prompt(),await window.deferredInstallPrompt.userChoice)}()}),a.addEventListener("click",()=>{p||function(){p=!0,g(!0);const t=document.createElement("div");t.id="game-container",t.style.display="none",document.body.appendChild(t);const i=new Xdt(t);i.game.events.on("gameLoad",()=>{t.style.display="block",e.game.destroy(),g(!1);for(let e=document.body.children.length-1;e>=0;e--){const i=document.body.children[e];i!==t&&document.body.removeChild(i)}i._onResize()})}()}),u.addEventListener("click",t=>{t.stopPropagation(),function(){const t="block"===c.style.display;c.style.display=t?"none":"block",d.className=t?"hamburger-menu":"hamburger-menu open"}()}),document.addEventListener("click",function(){c.style.display="none",d.className="hamburger-menu"}),r("/api/game/servers").then(t=>{if(!t||0===t.length)return p=!0,void g(!1);const e=t[0];f.innerHTML=i(e.name),localStorage.setItem("server",JSON.stringify(e)),m(e.rules),t.forEach(t=>{const e=document.createElement("div");e.className="item",e.innerHTML=`\n        <div class="header">\n          <span class="name">${i(t.name)}</span>\n          <span class="players">${t.players} players online</span>\n        </div>\n        <div class="content">\n          <span class="description">${i(t.description||"")}</span>\n        </div>\n      `,e.addEventListener("click",()=>{f.innerHTML=i(t.name),localStorage.setItem("server",JSON.stringify(t)),m(t.rules)}),c.appendChild(e)}),p=!1,g(!1)}).catch(()=>{p=!0,g(!1)})}});const jdt=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>About</h3>\n  <span class="description">About Hawk.</span>\n</div>\n<hr>\n  <p>A game written in <strong>Javascript</strong> using Hawk engine, check <a href="/help">help page</a> for controls and more.</p>\n  \n  <h3>Contact</h3>\n  <p>You can contact us on <strong>Discord</strong> <a href="${v}">here</a>.</p>\n  \n  <h3>Team</h3>\n  <p>Our team has <strong>${y.length}</strong> contributor(s). You can be one by joining our Discord Server and contributing!</p>\n  <div id="contributors"></div>\n  </div>\n`;var qdt=Object.freeze({__proto__:null,options:{title:"About",auth:!1,description:"Overview of Hawk, its mission, and team."},html:jdt,render:function(){document.getElementById("app").innerHTML=jdt;let t="";y.forEach(e=>{t+=`<div class="contributor">\n      <span>${e.name} <span class="accent">@${e.username}</span></span>\n      <br>\n      <small>Role: <span class="accent">${e.role}</span></small>\n    </div><br>`}),document.getElementById("contributors").innerHTML=t}});const Kdt=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>Help</h3>\n  <span class="description">Help and controls of Hawk.</span>\n</div>\n<hr>\n  <p>Our help page, check <a href="/about">about page</a> for more info.</p>\n  \n  <h3>Contact</h3>\n  <p>You can contact us on <strong>Discord</strong> <a href="${v}">here</a>.</p>\n  \n  <h3>Controls</h3>\n  <p>\n    <strong>PC:</strong> Use the <span class="highlight">W</span><span class="highlight">A</span><span class="highlight">S</span><span class="highlight">D</span> keys for movement.\n  </p>\n  <p>\n    <strong>Mobile:</strong> Use the dynamic joystick on the screen for movement.\n  </p>\n\n  <h3>Commands</h3>\n  <p>You can use commands by typing <span class="highlight">/</span>.</p>\n  <p>List of commands will be automatically displayed when typing <span class="highlight">/</span></p>\n  </div>\n`;var Zdt=Object.freeze({__proto__:null,options:{title:"Help",auth:!1,description:"Controls, and some help."},html:Kdt,render:function(){document.getElementById("app").innerHTML=Kdt}});const $dt=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Profile</h3>\n  <span class="description">Main profile.</span>\n</div>\n<hr>\n    <div class="profile-header" style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">\n      <img id="profileAvatar" src="/assets/generic-profile.png" width="64" height="64" style="border-radius:50%;object-fit:cover;background:#222;">\n      <div>\n        <div id="profileUsername" style="font-weight:700;font-size:18px"></div>\n        <div id="profileDisplayName" style="color:#666;margin-top:4px"></div>\n        <div id="profileId" style="color:#999;font-size:12px;margin-top:6px">ID: â</div>\n      </div>\n    </div>\n\n    <div>\n      <span id="profileFieldBio">No bio.</span>\n      <p id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n        <a class="btn mini" id="editProfileBtn" href="/profile-settings">Edit profile</a>\n        <a class="btn mini" id="editAvatarBtn" href="/avatar">Edit in-game avatar</a>\n      </p>\n    </div>\n  </div>\n`;var Jdt=Object.freeze({__proto__:null,options:{title:"Profile",auth:!0,description:"View and edit your public profile."},html:$dt,render:async function(){document.getElementById("app").innerHTML=$dt;const t=document.getElementById("profileAvatar"),e=document.getElementById("profileUsername"),n=document.getElementById("profileDisplayName"),s=document.getElementById("profileId"),r=document.getElementById("profileFieldBio"),a=document.getElementById("profileActions");function o(t,a,o,h){e.textContent=i(t||"Username"),n.textContent=i(a||"Display name"),r.textContent=i(h||"No bio."),s.textContent=`ID: ${i(String(o||"â"))}`}function h(){a&&(a.style.display="none")}function l(){a&&(a.style.display="flex")}async function u(e){t.src=e?`${m}/${encodeURIComponent(e)}`:""}document.getElementById("editProfileBtn"),document.getElementById("editAvatarBtn"),(async()=>{const t=new URLSearchParams(window.location.search).get("id"),e=await async function(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await c(p,{username:t,password:e})||null}catch{return null}}(),i=e&&e.id?String(e.id):null;if(t){const e=await async function(t){try{const e=await c("/api/auth/profile",{id:t});if(!e)return null;const i=e.username||"",n=e.displayName||e.display_name||"",s=e.bio||"";return o(i,n,e.id||t,s),(e.id||t)&&await u(e.id||t),e}catch(t){return null}}(t);if(e)return void(i&&String(e.id||t)===i?l():h())}e?(o(e.username||localStorage.getItem("username")||"",e.displayName||localStorage.getItem("display_name")||"",e.id,e.bio),e.id&&await u(e.id),e.username&&localStorage.setItem("username",e.username),e.displayName&&localStorage.setItem("display_name",e.displayName),l()):(o("","","â",""),h())})()}});const Qdt=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/control.png").dataUrl}"></canv-icon>Profile Settings</h3>\n  <span class="description">Edit/Modify your profile with ease.</span>\n</div>\n<hr>\n\n    <div class="header-row" id="headerRow">\n      <div class="avatar-wrap"><canvas id="settingsAvatarPreview" width=128 height=128></canvas></div>\n      <div class="header-meta">\n        <div id="settingsUsername" class="username"></div>\n        <div id="settingsDisplayName" class="displayname"></div>\n        <div id="settingsId" class="id">ID: â</div>\n      </div>\n    </div>\n\n    <div class="profile-grid">\n      <div class="profile-section">\n        <label for="settingsDisplayNameInput">Display name</label>\n        <input id="settingsDisplayNameInput" type="text" />\n        <button id="settingsSaveDisplayName" class="btn mini">Save</button>\n        <div id="settingsDisplayNameMsg" class="message" aria-live="polite"></div>\n      </div>\n\n      <div class="profile-section">\n        <label for="settingsUsernameInput">Username</label>\n        <input id="settingsUsernameInput" type="text" />\n        <button id="settingsSaveUsername" class="btn mini">Save</button>\n        <div id="settingsUsernameMsg" class="message" aria-live="polite"></div>\n      </div>\n\n      <div class="profile-section">\n        <label for="settingsPasswordInput">Password</label>\n        <input id="settingsPasswordInput" type="password" />\n        <button id="settingsSavePassword" class="btn mini">Save</button>\n        <div id="settingsPasswordMsg" class="message" aria-live="polite"></div>\n      </div>\n\n      <div class="profile-section">\n        <label for="settingsBioInput">Bio</label>\n        <input id="settingsBioInput" type="bio" />\n        <button id="settingsSaveBio" class="btn mini">Save</button>\n        <div id="settingsBioMsg" class="message" aria-live="polite"></div>\n      </div>\n\n      <div class="avatar-block">\n        <div class="avatar-row" style="margin-top:8px;">\n          <canvas id="settingsAvatarPreviewSmall" width="128" height="128"></canvas>\n          <div>\n            <input id="settingsAvatarInput" type="file" accept="image/*" />\n            <button id="settingsUploadAvatar" class="uploadBtn">Upload avatar</button>\n            <div id="settingsAvatarMsg" class="message" aria-live="polite"></div>\n          </div>\n        </div>\n      </div>\n\n      <div id="profileActions" style="margin-top:40px; display: flex; gap: 5px;">\n        <a class="btn mini" href="/profile">Back to profile</a>\n      </div>\n    </div>\n  </div>\n`;var tft=Object.freeze({__proto__:null,options:{title:"Profile Settings",auth:!0,description:"Manage data and security settings."},html:Qdt,render:async function(){document.getElementById("app").innerHTML=Qdt;const t=t=>document.getElementById(t),e=t("settingsAvatarPreview"),n=t("settingsAvatarPreviewSmall"),s=t("settingsUsername"),r=t("settingsDisplayName"),a=t("settingsId"),o=t("settingsDisplayNameInput"),d=t("settingsSaveDisplayName"),f=t("settingsDisplayNameMsg"),g=t("settingsUsernameInput"),v=t("settingsSaveUsername"),y=t("settingsUsernameMsg"),x=t("settingsPasswordInput"),w=t("settingsSavePassword"),b=t("settingsPasswordMsg"),T=t("settingsBioInput"),E=t("settingsSaveBio"),S=t("settingsBioMsg"),_=t("settingsAvatarInput"),C=t("settingsUploadAvatar"),A=t("settingsAvatarMsg"),M=e.getContext("2d"),P=n.getContext("2d");function R(t,e,i=!1){t.textContent=e,t.style.color=i?"crimson":""}async function L(){const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return null;try{return await c(p,{username:t,password:e})||null}catch{return null}}async function O(t){if(!t)return;const o=t.id,h=t.username||localStorage.getItem("username")||"",l=t.displayName||localStorage.getItem("display_name")||"";if(s.textContent=i(h),r.textContent=i(l),a.textContent=`ID: ${i(String(o))}`,o)try{const t=new Image;t.src=`${m}/${encodeURIComponent(o)}`,t.onload=()=>{u(t,e,Math.min(e.width,e.height)),u(t,n,Math.min(n.width,n.height))},t.onerror=()=>{M.clearRect(0,0,e.width,e.height),P.clearRect(0,0,n.width,n.height)}}catch{M.clearRect(0,0,e.width,e.height),P.clearRect(0,0,n.width,n.height)}}async function F({key:t,inputEl:e,msgEl:i,successLocalKey:n}){const s=localStorage.getItem("username"),r=localStorage.getItem("password"),a=e.value;if(s&&r)try{const e=await c("/api/user/edit",{username:s,password:r,key:t,value:a});R(i,e&&(e.message||e.success)||"Done"),n&&localStorage.setItem(n,a);const h=await L();h&&(h.displayName&&(o.value=h.displayName,localStorage.setItem("display_name",h.displayName)),h.username&&(g.value=h.username,localStorage.setItem("username",h.username)),await O(h))}catch(t){R(i,t.message||"Error",!0)}else R(i,"Credentials not stored locally.",!0)}M.clearRect(0,0,e.width,e.height),P.clearRect(0,0,n.width,n.height),d.addEventListener("click",()=>F({key:"displayName",inputEl:o,msgEl:f,successLocalKey:"display_name"})),v.addEventListener("click",()=>F({key:"username",inputEl:g,msgEl:y,successLocalKey:"username"})),w.addEventListener("click",()=>F({key:"password",inputEl:x,msgEl:b})),E.addEventListener("click",()=>F({key:"bio",inputEl:T,msgEl:S})),_.addEventListener("change",async t=>{A.textContent="";const i=t.target.files&&t.target.files[0];if(i)try{const t=await h(i),s=await l(t);u(s,e,Math.min(e.width,e.height)),u(s,n,Math.min(n.width,n.height))}catch(t){R(A,t.message||"Error processing image",!0)}}),C.addEventListener("click",async()=>{R(A,"Uploading..."),C.disabled=!0;try{const t=_.files&&_.files[0];if(!t)throw new Error("Please select an image first");const e=await async function(t){if(!t)throw new Error("No file provided");if(!t.type.startsWith("image/"))throw new Error("File is not an image");const e=await h(t),i=await l(e);if(128===i.width&&128===i.height)return e;const n=document.createElement("canvas");return n.width=128,n.height=128,u(i,n,128),n.toDataURL("image/png")}(t),i=localStorage.getItem("username"),n=localStorage.getItem("password"),s=await c(m,{image:e,username:i,password:n});R(A,s&&(s.message||"Avatar uploaded successfully")||"Avatar uploaded");const r=await L();r&&(r.displayName&&localStorage.setItem("display_name",r.displayName),r.username&&localStorage.setItem("username",r.username),await O(r))}catch(t){R(A,t.message||"Upload error",!0)}finally{C.disabled=!1}}),(async()=>{const t=await L();if(t)t.displayName&&(o.value=t.displayName,localStorage.setItem("display_name",t.displayName)),t.username&&(g.value=t.username,localStorage.setItem("username",t.username)),await O(t);else{const t=localStorage.getItem("display_name")||"",e=localStorage.getItem("username")||"";o.value=t,g.value=e,s.textContent=i(e||"Username"),r.textContent=i(t||"Display name")}})()}});function eft(t){return new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(new Error("Error reading file")),n.onload=()=>e(String(n.result)),n.readAsDataURL(t)})}function ift(t){return new Promise((e,i)=>{const n=new Image;n.onload=()=>e(n),n.onerror=()=>i(new Error("Could not load image")),n.src=t})}async function nft(t,{maxBytes:e=5e6}={}){if(!t)throw new Error("No file provided");if("string"!=typeof t.type||!t.type.startsWith("image/"))throw new Error("File is not an image");if(t.size&&t.size>e)throw new Error(`File too large (max ${Math.round(e/1e6)} MB)`);const i=await eft(t);return function(t){const e=32,i=document.createElement("canvas");i.width=e,i.height=e;const n=i.getContext("2d");n.clearRect(0,0,e,e);const s=t.width/t.height;let r=e,a=e;s>1?a=e/s:s<1&&(r=e*s);const o=Math.round((e-r)/2),h=Math.round((e-a)/2);return n.drawImage(t,o,h,r,a),i.toDataURL("image/png")}(await ift(i))}const sft=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/createemoji.png").dataUrl}"></canv-icon>In-Game avatar</h3>\n  <span class="description">Modify your in-game avatar.</span>\n</div>\n<hr>\n    <section class="avatar-section">\n      <div class="header-row">\n        <div>\n          <p id="avatar-desc" class="lead">Upload an avatar for your character.</p>\n          <p class="small accent">Accepted: images. Max 5 MB.</p>\n        </div>\n      </div>\n\n      <label for="avatarInput" class="file-label">\n        <input id="avatarInput" type="file" accept="image/*" class="visually-hidden" />\n      </label>\n\n      <div class="preview-row" aria-live="polite">\n        <canvas id="avatarPreview" width="32" height="32" class="avatar-canvas"></canvas>\n        <div class="preview-text">Preview</div>\n      </div>\n\n      <div class="controls">\n        <button id="uploadAvatarBtn" class="uploadBtn">Upload avatar</button>\n        <div id="avatarMessage" class="message"></div>\n      </div>\n    </section>\n  </div>\n`;var rft=Object.freeze({__proto__:null,validateAndConvertImage:nft,options:{title:"Avatar",auth:!0,description:"Customize your in-game avatar with a custom image."},html:sft,render:function(){document.getElementById("app").innerHTML=sft;const t=document.getElementById("avatarInput"),e=document.getElementById("avatarPreview").getContext("2d"),i=document.getElementById("avatarMessage"),n=document.getElementById("uploadAvatarBtn");t.addEventListener("change",async t=>{i.textContent="";const n=t.target.files&&t.target.files[0];if(n)try{const t=await eft(n);(t=>{const i=32;e.clearRect(0,0,i,i);const n=t.width/t.height;let s=i,r=i;n>1?r=i/n:n<1&&(s=i*n);const a=Math.round((i-s)/2),o=Math.round((i-r)/2);e.drawImage(t,a,o,s,r)})(await ift(t))}catch(t){i.textContent=t.message||"Error processing image",e.clearRect(0,0,32,32)}}),n.addEventListener("click",async()=>{i.textContent="",n.disabled=!0;try{const e=t.files&&t.files[0];if(!e)throw new Error("Please select an image first");const n=await nft(e,{maxBytes:5e6});if(!n)throw new Error("Could not convert image");const r=localStorage.getItem("username"),a=localStorage.getItem("password");await async function(t,e=null,i=null){if(!t)throw new Error("No image to upload");const n={image:t,username:e??null,password:i??null};try{const t=await s("/api/avatar",n);if(t.error)throw new Error(t.error);return t}catch(t){throw new Error(t.message||"Network error while uploading avatar")}}(n,r,a),i.textContent="Avatar uploaded successfully"}catch(t){i.textContent=t.message||"Upload error"}finally{n.disabled=!1}})}});const aft=`\n<span>\n<strong>Terms of Service (TERMS) - Hawk</strong>\n<br><br>\n1. <strong>Acceptance</strong><br>\nBy using this site you accept these Terms. If you do not agree, do not use the service.\n<br><br>\n2. <strong>Registration and account</strong><br>\n- To create an account you must register with: <strong>username</strong>, <strong>password</strong> and <strong>display name</strong>.<br>\n- <strong>username</strong> and <strong>password</strong> are used to log in. <strong>display name</strong> is used only to identify you publicly within the site.<br>\n- You are responsible for keeping your <strong>username</strong> and <strong>password</strong> confidential and for all activities that occur under your account.\n<br><br>\n3. <strong>Permitted use</strong><br>\n- Do not use the service for illegal, fraudulent, defamatory activities, or to infringe the rights of others.<br>\n- We may suspend or delete accounts that violate these Terms.\n<br><br>\n4. <strong>User content</strong><br>\n- You retain ownership of content you publish.<br>\n- By posting content you agree the site may display it to other users according to the site's functionality.\n<br><br>\n5. <strong>Account status</strong><br>\n- Accounts remain on the system indefinitely.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.<br>\n- Use strong, unique passwords.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update these Terms at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${v}">here</a>.\n</span>`;var oft=Object.freeze({__proto__:null,options:{title:"Terms Of Service",auth:!1,description:"Rules and legal terms governing use of Hawk."},html:aft,render:function(){document.getElementById("app").innerHTML=aft}});const hft=`\n<span>\n<strong>Privacy Policy (PRIVACY) - Hawk</strong>\n<br><br>\n1. <strong>Data collected</strong><br>\n- At registration we collect: <strong>username</strong>, <strong>password</strong>, and <strong>display name</strong>.\n<br><br>\n2. <strong>Purpose and use</strong><br>\n- <strong>username</strong> and <strong>password</strong>: validated and used exclusively for authentication and friend requests.<br>\n- <strong>display name</strong>: shown on the site to identify the user.\n<br><br>\n3. <strong>No cookies</strong><br>\n- <strong>We do not use cookies.</strong>\n<br><br>\n4. <strong>Sharing</strong><br>\n- We do not share personal data with third parties, except when required by law.\n<br><br>\n5. <strong>Retention</strong><br>\n- Account data is retained indefinitely and <strong>accounts cannot be deleted</strong>.\n<br><br>\n6. <strong>Security</strong><br>\n- We implement reasonable measures to protect your data but cannot guarantee absolute security.\n<br><br>\n7. <strong>Minors</strong><br>\n- The service is not intended for minors. Do not register without parental or guardian consent.\n<br><br>\n8. <strong>Changes</strong><br>\n- We may update this Privacy Policy at any time. Continued use after changes implies acceptance.\n<br><br>\n9. <strong>Contact</strong><br>\n- For questions or security reports contact us on Discord by clicking <a href="${v}">here</a>.\n</span>`;var lft=Object.freeze({__proto__:null,options:{title:"Privacy Policy",auth:!1,description:"Details on how Hawk collects, uses, and protects data."},html:hft,render:function(){document.getElementById("app").innerHTML=hft}});const uft=`\n  <div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/endstage.png").dataUrl}"></canv-icon>404 - Not Found</h3>\n  <span class="description">Not found</span>\n</div>\n<hr>\n  <p>This page was not found.</p>\n  <p>If you think this is a mistake, You can contact us on <strong>Discord</strong> <a href="${v}">here</a>.</p>\n  \n  <a class="btn" href="/dashboard">Go to dashboard</a>\n  </div>\n`;var cft=Object.freeze({__proto__:null,options:{title:"404",auth:!1,description:"This page has not found."},html:uft,render:function(){document.getElementById("app").innerHTML=uft}});const dft=`\n  <div class="auth">\n    <div class="header">\n      <h3><canv-icon src="${e.getBlob("assets/icons/pings.png").dataUrl}"></canv-icon>Ping</h3>\n      <span class="description">Ping check</span>\n    </div>\n    <hr>\n    <p>Check your ping between you and <strong>Hawk</strong> servers.</p>\n    <br>\n    <p id="ping-result"><i>Your result will appear here.</i></p>\n    <br>\n    <button class="btn" id="ping-button">Check your ping</button>\n    <small>The result can not be same as play ping. It also depends of device speed.</small>\n  </div>\n`;var fft=Object.freeze({__proto__:null,options:{title:"Ping",auth:!1,description:"Check the ping between you and Hawk servers."},html:dft,render:function(){document.getElementById("app").innerHTML=dft;const t=document.getElementById("ping-button"),i=document.getElementById("ping-result");t.addEventListener("click",async()=>{const t=(new Date).getTime();try{await r("/api/game/servers");const n=(new Date).getTime()-t;let s;s=n<100?`<canv-icon src="${e.getBlob("assets/icons/goodping.png").dataUrl}"></canv-icon>`:n<300?`<canv-icon src="${e.getBlob("assets/icons/idelping.png").dataUrl}"></canv-icon>`:`<canv-icon src="${e.getBlob("assets/icons/badping.png").dataUrl}"></canv-icon>`,i.innerHTML=`${s} Ping: ${n} ms`}catch(t){i.innerText="Error checking your ping"}})}});const pft=`\n  <div class="dms-container">\n    <div class="dms-header">\n      <h2>Direct Messages</h2>\n      <button class="btn btn-primary" id="new-conversation">\n        <canv-icon src="${e.getBlob("assets/icons/createintegration.png").dataUrl}"></canv-icon>\n        New Conversation\n      </button>\n    </div>\n    <div id="conversations-list" class="conversations-list">\n      <div class="loading">\n        <span class="loader"></span> Loading conversations...\n      </div>\n    </div>\n  </div>\n`;var gft=Object.freeze({__proto__:null,options:{title:"Messages",auth:!0,description:"Send and receive direct messages with other users."},html:pft,render:function(){document.getElementById("app").innerHTML=pft;const t=document.getElementById("conversations-list");document.getElementById("new-conversation").addEventListener("click",()=>{!async function(){const t=document.createElement("div");t.className="modal",t.innerHTML='\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3>New Conversation</h3>\n          <button class="modal-close">&times;</button>\n        </div>\n        <div class="modal-body">\n          <div class="friends-list-header">\n            <h4>Your Friends</h4>\n          </div>\n          <div id="friends-list-container">\n            <div class="loading">\n              <span class="loader"></span> Loading friends...\n            </div>\n          </div>\n          <div class="pagination-controls" id="pagination-controls" style="display: none;">\n            <button class="btn btn-secondary" id="prev-page" disabled>Previous</button>\n            <span id="page-info">Page 1</span>\n            <button class="btn btn-secondary" id="next-page">Next</button>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <button class="btn btn-secondary" id="cancel-modal">Cancel</button>\n        </div>\n      </div>\n    ',document.body.appendChild(t);const e=t.querySelector(".modal-close"),n=t.querySelector("#cancel-modal"),r=t.querySelector("#friends-list-container"),a=t.querySelector("#pagination-controls"),o=t.querySelector("#prev-page"),h=t.querySelector("#next-page"),l=t.querySelector("#page-info");let u=[],c=1;const d=()=>{t.remove()};function f(){const t=Math.ceil(u.length/10),e=10*(c-1),n=e+10,s=u.slice(e,n);r.innerHTML="",s.forEach(t=>{const e=document.createElement("div");e.className="friend-item",e.innerHTML=`\n          <div class="friend-info">\n            <img src="/api/pavatar/${t.id}" alt="${i(t.display_name)}" class="friend-avatar">\n            <div class="friend-details">\n              <div class="friend-name">${i(t.display_name)}</div>\n              <div class="friend-username">@${i(t.username)}</div>\n            </div>\n          </div>\n          <button class="btn btn-primary btn-start-chat" data-user-id="${t.id}">\n            Start Chat\n          </button>\n        `,e.querySelector(".btn-start-chat").addEventListener("click",()=>{d(),window.router.navigateTo(`/dms/${t.id}`)}),r.appendChild(e)}),t>1?(a.style.display="flex",l.textContent=`Page ${c} of ${t}`,o.disabled=1===c,h.disabled=c===t):a.style.display="none"}e.addEventListener("click",d),n.addEventListener("click",d),o.addEventListener("click",()=>{c>1&&(c--,f())}),h.addEventListener("click",()=>{const t=Math.ceil(u.length/10);c<t&&(c++,f())}),async function(){try{const t=localStorage.getItem("username"),e=localStorage.getItem("password");if(!t||!e)return void(r.innerHTML='<div class="error">Please log in first.</div>');const i=await s("/api/friends/list",{username:t,password:e});if(u=i.friends||[],0===u.length)return void(r.innerHTML='<div class="empty-state">No friends yet. Add some friends first!</div>');f()}catch(t){console.error("Error loading friends:",t),r.innerHTML='<div class="error">Failed to load friends.</div>'}}()}()}),async function(){try{const e=localStorage.getItem("username"),n=localStorage.getItem("password");if(!e||!n)return void(t.innerHTML='<div class="error">Please log in first.</div>');const r=await s("/api/messages/conversations",{username:e,password:n});r.conversations&&r.conversations.length>0?(t.innerHTML="",r.conversations.forEach(e=>{const n=function(t){const e=document.createElement("div");e.className="conversation-item"+(t.unreadCount>0?" unread":"");const n=function(t){const e=new Date(t),i=new Date-e,n=Math.floor(i/6e4),s=Math.floor(i/36e5),r=Math.floor(i/864e5);return n<1?"Just now":n<60?`${n}m`:s<24?`${s}h`:r<7?`${r}d`:e.toLocaleDateString()}(t.lastMessage.timestamp),s=t.lastMessage.fromMe?`You: ${t.lastMessage.content}`:t.lastMessage.content;return e.innerHTML=`\n      <div class="conversation-avatar">\n        <img src="/api/pavatar/${t.userId}" alt="${i(t.displayName)}">\n      </div>\n      <div class="conversation-info">\n        <div class="conversation-header">\n          <span class="conversation-name">${i(t.displayName)}</span>\n          <span class="conversation-time">${n}</span>\n        </div>\n        <div class="conversation-preview">\n          ${i(s.substring(0,100))}${s.length>100?"...":""}\n        </div>\n      </div>\n      ${t.unreadCount>0?`<div class="unread-badge">${t.unreadCount}</div>`:""}\n    `,e.addEventListener("click",()=>{window.router.navigateTo(`/dms/${t.userId}`)}),e}(e);t.appendChild(n)})):t.innerHTML='<div class="empty-state">No conversations yet. Start a new conversation!</div>'}catch(e){console.error("Error loading conversations:",e),t.innerHTML='<div class="error">Failed to load conversations.</div>'}}()}});const mft=`\n<div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>Login</h3>\n  <span class="description">Log in into Hawk.</span>\n</div>\n<hr>\n<form id="loginForm" class="gap">\n  <input type="text" id="username" placeholder="Username" required>\n  <input type="password" id="password" placeholder="Password" required>\n  <br>\n  <div id="turnstile-container"></div>\n  <br>\n  <button class="btn" type="submit">Login</button>\n  <br>\n  <small class="accent">By logging in you accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n</form>\n<hr>\n<p>New here? <a href="/register">Register</a></p>\n</div>\n`;var vft=Object.freeze({__proto__:null,options:{title:"Login",auth:!1,description:"Sign in to your Hawk account."},html:mft,render:function(){document.getElementById("app").innerHTML=mft,d(t=>{window.turnstileToken=t}),document.getElementById("loginForm").addEventListener("submit",async t=>{t.preventDefault();const e=t.target.username.value,i=t.target.password.value,n=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:i,turnstile:window.turnstileToken})}),s=await n.json();n.ok?(localStorage.setItem("loggedIn","true"),localStorage.setItem("username",s.username),localStorage.setItem("password",s.password),window.location="/dashboard"):b.add("Login error",s.error)})}});const yft=`\n<div class="auth">\n<div class="header">\n  <h3><canv-icon src="${e.getBlob("assets/icons/unbanmember.png").dataUrl}"></canv-icon>Register</h3>\n  <span class="description">Create a new account.</span>\n</div>\n<hr>\n<form id="regForm" class="gap">\n  <input type="text" id="display_name" placeholder="Display Name" required>\n  <input type="text" id="username" placeholder="Username" required>\n  <input type="password" id="password" placeholder="Password" required>\n  <br>\n  <div id="turnstile-container"></div>\n  <br>\n  <button class="btn" type="submit">Register</button>\n  <br>\n  <small class="accent">By creating a account your accept our <a href="/termsofservice">Terms Of Service</a> and <a href="/privacypolicy">Privacy Policy</a></small>\n</form>\n<hr>\n<p>Already have a account? <a href="/login">Login</a></p>\n</div>\n`;var xft=Object.freeze({__proto__:null,options:{title:"Register",auth:!1,description:"Create a Hawk account and join the community."},html:yft,render:function(){function t(t,e){switch(t){case"display_name":return e.length>=3&&e.length<=32;case"username":{const t=e.length>=3&&e.length<=16,i=/^[A-Za-z0-9_]+$/.test(e);return t&&i}case"password":return e.length>=8&&e.length<=16;default:return!1}}function e(t){switch(t){case"display_name":return"Display name must be between 3 and 32 characters.";case"username":return"Username must be between 3 and 16 characters and contain only letters, numbers and underscores (a-zA-Z0-9_).";case"password":return"Password must be between 8 and 16 characters.";default:return"Invalid field."}}document.getElementById("app").innerHTML=yft,d(t=>{window.turnstileToken=t}),document.getElementById("regForm").addEventListener("submit",async i=>{i.preventDefault();const n=i.target.display_name.value.trim(),s=i.target.username.value.trim(),r=i.target.password.value;if(window.turnstileToken)if(t("display_name",n))if(t("username",s))if(t("password",r))try{const t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:n,username:s,password:r,turnstile:window.turnstileToken})}),e=await t.json();t.ok?b.add("Registered",'Succesfully registered.<br>Login by clicking <a href="/login">here</a>.'):b.add("Register error",e.error||"Unknown error.<br>This maybe is a mistake, please contact an administrator.")}catch(t){b.add("Network error",t.message)}else b.add("Validation error",e("password"));else b.add("Validation error",e("username"));else b.add("Validation error",e("display_name"));else b.add("Validation error","Please complete captcha")})}});const wft=`\n<div class="auth">\n  <div class="header">\n    <h3><canv-icon src="${e.getBlob("assets/icons/settings.png").dataUrl}"></canv-icon>Admin Panel</h3>\n    <span class="description">Manage users and permissions</span>\n  </div>\n  <hr>\n  \n  <div class="admin-stats">\n    <div class="stat-card">\n      <div class="stat-number" id="totalUsers">-</div>\n      <div class="stat-label">Total Users</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-number" id="totalMods">-</div>\n      <div class="stat-label">Moderators</div>\n    </div>\n    <div class="stat-card">\n      <div class="stat-number" id="totalAdmins">-</div>\n      <div class="stat-label">Admins</div>\n    </div>\n  </div>\n\n  <div class="admin-section">\n    <h3>User Management</h3>\n    \n    <div class="search-bar">\n      <input type="text" id="userSearch" placeholder="Search users by username...">\n      <button id="searchBtn" class="btn">Search</button>\n      <button id="clearSearchBtn" class="btn btn-secondary">Clear</button>\n    </div>\n\n    <div id="userList" class="user-list">\n      <p class="loading">Loading users...</p>\n    </div>\n\n    <div id="pagination" class="pagination-controls">\n      <button id="prevBtn" class="btn btn-secondary">Previous</button>\n      <span id="pageInfo">Page 1</span>\n      <button id="nextBtn" class="btn btn-secondary">Next</button>\n    </div>\n  </div>\n</div>\n\n<div id="editUserModal" class="modal-overlay hidden">\n  <div class="modal-dialog">\n    <div class="modal-header">\n      <h3>Edit User</h3>\n      <button id="closeEditModal" class="close-btn">&times;</button>\n    </div>\n    <div class="modal-body">\n      <div id="editUserInfo"></div>\n      \n      <div class="form-group">\n        <label>Display Name</label>\n        <input type="text" id="editDisplayName" class="input">\n      </div>\n      \n      <div class="form-group">\n        <label>Username</label>\n        <input type="text" id="editUsername" class="input" disabled>\n      </div>\n      \n      <div class="form-group">\n        <label>Bio</label>\n        <textarea id="editBio" class="input" rows="3"></textarea>\n      </div>\n      \n      <div class="form-group">\n        <label>Avatar URL</label>\n        <input type="text" id="editAvatar" class="input" placeholder="https://...">\n        <small>Leave empty to remove avatar</small>\n      </div>\n      \n      <div class="form-group">\n        <label>Roles</label>\n        <div class="role-checkboxes">\n          <label class="checkbox-label">\n            <input type="checkbox" name="role" value="moderator"> Moderator\n          </label>\n          <label class="checkbox-label">\n            <input type="checkbox" name="role" value="admin"> Admin\n          </label>\n          <label class="checkbox-label">\n            <input type="checkbox" name="role" value="superadmin"> Superadmin\n          </label>\n        </div>\n      </div>\n      \n      <button id="saveUserBtn" class="btn btn-primary">Save Changes</button>\n    </div>\n  </div>\n</div>\n`,bft={"/auth":Uo,"/login":vft,"/register":xft,"/admin":Object.freeze({__proto__:null,options:{title:"Admin Panel",auth:!0,superadmin:!0,description:"Manage users and permissions"},html:wft,render:async function(){const t=document.getElementById("app");t.innerHTML=wft,function(){if(document.getElementById("admin-page-styles"))return;const t=document.createElement("style");t.id="admin-page-styles",t.textContent='\n    .admin-stats {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n      gap: 16px;\n      margin-bottom: 24px;\n    }\n\n    .stat-card {\n      background: var(--surface-color);\n      border: 1px solid var(--border-color);\n      border-radius: 8px;\n      padding: 20px;\n      text-align: center;\n    }\n\n    .stat-number {\n      font-size: 32px;\n      font-weight: 700;\n      color: var(--primary-color);\n      margin-bottom: 8px;\n    }\n\n    .stat-label {\n      font-size: 13px;\n      color: var(--muted);\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n    }\n\n    .admin-section {\n      background: var(--surface-color);\n      border: 1px solid var(--border-color);\n      border-radius: 8px;\n      padding: 20px;\n    }\n\n    .admin-section h3 {\n      margin: 0 0 16px 0;\n      font-size: 18px;\n      color: #fff;\n    }\n\n    .search-bar {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 20px;\n    }\n\n    .search-bar input {\n      flex: 1;\n      padding: 10px 15px;\n      background: var(--bg-color);\n      border: 1px solid var(--border-color);\n      border-radius: 6px;\n      color: var(--text-color);\n      font-size: 14px;\n    }\n\n    .search-bar input:focus {\n      outline: none;\n      border-color: var(--primary-color);\n    }\n\n    .user-list {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n      margin-bottom: 20px;\n    }\n\n    .user-card {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 16px;\n      padding: 16px;\n      background: rgba(255, 255, 255, 0.03);\n      border: 1px solid var(--border-color);\n      border-radius: 8px;\n      transition: all 0.2s;\n    }\n\n    .user-card:hover {\n      background: rgba(255, 255, 255, 0.05);\n      border-color: var(--border-hover);\n    }\n\n    .user-info {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      flex: 1;\n    }\n\n    .user-avatar {\n      width: 50px;\n      height: 50px;\n      border-radius: 8px;\n      overflow: hidden;\n      background: rgba(255, 255, 255, 0.05);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      flex-shrink: 0;\n    }\n\n    .user-avatar img {\n      width: 100%;\n      height: 100%;\n      object-fit: cover;\n    }\n\n    .avatar-placeholder {\n      font-size: 24px;\n      color: var(--muted);\n    }\n\n    .user-details {\n      flex: 1;\n      min-width: 0;\n    }\n\n    .user-details h3 {\n      margin: 0 0 4px 0;\n      font-size: 16px;\n      color: #fff;\n    }\n\n    .user-username {\n      margin: 0 0 2px 0;\n      font-size: 13px;\n      color: var(--muted);\n    }\n\n    .user-id {\n      margin: 0;\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.3);\n      font-family: monospace;\n    }\n\n    .user-roles {\n      display: flex;\n      gap: 6px;\n      flex-wrap: wrap;\n    }\n\n    .role-badge {\n      padding: 4px 10px;\n      border-radius: 12px;\n      font-size: 11px;\n      font-weight: 600;\n      text-transform: uppercase;\n    }\n\n    .role-badge.moderator {\n      background: rgba(255, 193, 7, 0.2);\n      color: #ffc107;\n    }\n\n    .role-badge.admin {\n      background: rgba(156, 39, 176, 0.2);\n      color: #9c27b0;\n    }\n\n    .role-badge.superadmin {\n      background: rgba(244, 67, 54, 0.2);\n      color: #f44336;\n    }\n\n    .role-badge.no-role {\n      background: rgba(255, 255, 255, 0.05);\n      color: var(--muted);\n    }\n\n    .user-actions {\n      display: flex;\n      gap: 8px;\n    }\n\n    .btn-small {\n      padding: 8px 16px;\n      font-size: 13px;\n    }\n\n    .btn-primary {\n      background: var(--primary-color);\n      color: #fff;\n    }\n\n    .btn-primary:hover {\n      background: var(--primary-hover);\n    }\n\n    .btn-secondary {\n      background: transparent;\n      border: 1px solid var(--border-color);\n      color: var(--text-color);\n    }\n\n    .btn-secondary:hover {\n      background: rgba(255, 255, 255, 0.05);\n    }\n\n    .btn-secondary:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    .pagination-controls {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      gap: 15px;\n      padding: 10px 0;\n    }\n\n    .pagination-controls button {\n      padding: 8px 16px;\n      font-size: 13px;\n    }\n\n    #pageInfo {\n      font-size: 13px;\n      color: var(--muted);\n      min-width: 200px;\n      text-align: center;\n    }\n\n    .loading, .empty, .error {\n      text-align: center;\n      padding: 40px 20px;\n      color: var(--muted);\n    }\n\n    .error {\n      color: var(--danger);\n    }\n\n    .modal-overlay {\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background: rgba(0, 0, 0, 0.8);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n    }\n\n    .modal-overlay.hidden {\n      display: none;\n    }\n\n    .modal-dialog {\n      background: var(--surface-color);\n      border: 1px solid var(--border-color);\n      border-radius: 12px;\n      width: 90%;\n      max-width: 600px;\n      max-height: 90vh;\n      overflow-y: auto;\n    }\n\n    .modal-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 20px;\n      border-bottom: 1px solid var(--border-color);\n    }\n\n    .modal-header h3 {\n      margin: 0;\n      color: #fff;\n    }\n\n    .close-btn {\n      background: transparent;\n      border: none;\n      font-size: 28px;\n      color: var(--muted);\n      cursor: pointer;\n      padding: 0;\n      width: 30px;\n      height: 30px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .close-btn:hover {\n      color: var(--text-color);\n    }\n\n    .modal-body {\n      padding: 20px;\n    }\n\n    .form-group {\n      margin-bottom: 20px;\n    }\n\n    .form-group label {\n      display: block;\n      margin-bottom: 8px;\n      font-size: 14px;\n      font-weight: 600;\n      color: #fff;\n    }\n\n    .form-group small {\n      display: block;\n      margin-top: 4px;\n      font-size: 12px;\n      color: var(--muted);\n    }\n\n    .input {\n      width: 100%;\n      padding: 10px 15px;\n      background: var(--bg-color);\n      border: 1px solid var(--border-color);\n      border-radius: 6px;\n      color: var(--text-color);\n      font-size: 14px;\n      font-family: inherit;\n    }\n\n    .input:focus {\n      outline: none;\n      border-color: var(--primary-color);\n    }\n\n    .input:disabled {\n      opacity: 0.5;\n      cursor: not-allowed;\n    }\n\n    textarea.input {\n      resize: vertical;\n      min-height: 80px;\n    }\n\n    .role-checkboxes {\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n\n    .checkbox-label {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      padding: 12px;\n      background: rgba(255, 255, 255, 0.03);\n      border: 1px solid var(--border-color);\n      border-radius: 6px;\n      cursor: pointer;\n      transition: all 0.2s;\n      font-weight: normal;\n    }\n\n    .checkbox-label:hover {\n      background: rgba(255, 255, 255, 0.05);\n    }\n\n    .checkbox-label input[type="checkbox"] {\n      width: 18px;\n      height: 18px;\n      cursor: pointer;\n    }\n\n    @media (max-width: 768px) {\n      .user-card {\n        flex-direction: column;\n        align-items: stretch;\n      }\n\n      .user-actions {\n        width: 100%;\n      }\n\n      .btn-small {\n        width: 100%;\n      }\n\n      .admin-stats {\n        grid-template-columns: 1fr;\n      }\n    }\n  ',document.head.appendChild(t)}();const e=localStorage.getItem("username"),n=localStorage.getItem("password");if(!e||!n)return void(t.innerHTML='<div class="auth"><p class="error">Not authenticated</p></div>');let r=[],a=[],o=1,h=null;async function l(){const t=document.getElementById("userList");t.innerHTML='<p class="loading">Loading users...</p>';try{const h=await s("/api/admin/users",{username:e,password:n});if(h.error)return void(t.innerHTML=`<p class="error">${i(h.error)}</p>`);r=h.users||[],a=r,function(){document.getElementById("totalUsers").textContent=r.length;const t=r.filter(t=>t.roles&&t.roles.includes("moderator")).length,e=r.filter(t=>t.roles&&(t.roles.includes("admin")||t.roles.includes("superadmin"))).length;document.getElementById("totalMods").textContent=t,document.getElementById("totalAdmins").textContent=e}(),o=1,u()}catch(e){t.innerHTML=`<p class="error">${i(e.message||"Error loading users")}</p>`}}function u(){const t=document.getElementById("userList");if(0===a.length)return t.innerHTML='<p class="empty">No users found</p>',void c();const e=10*(o-1),n=e+10,s=a.slice(e,n);t.innerHTML=s.map(t=>`\n      <div class="user-card" data-user-id="${i(t.id)}">\n        <div class="user-info">\n          <div class="user-avatar">\n            ${t.avatar?`<img src="${i(t.avatar)}" alt="Avatar">`:'<div class="avatar-placeholder">?</div>'}\n          </div>\n          <div class="user-details">\n            <h3>${i(t.displayName||t.username)}</h3>\n            <p class="user-username">@${i(t.username)}</p>\n            <p class="user-id">ID: ${i(t.id)}</p>\n          </div>\n        </div>\n        <div class="user-roles">\n          ${t.roles&&t.roles.length>0?t.roles.map(t=>`<span class="role-badge ${t}">${i(t)}</span>`).join(""):'<span class="role-badge no-role">No roles</span>'}\n        </div>\n        <div class="user-actions">\n          <button class="btn btn-small edit-user-btn" data-user-id="${i(t.id)}">Edit</button>\n        </div>\n      </div>\n    `).join(""),document.querySelectorAll(".edit-user-btn").forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.userId,i=r.find(t=>t.id===e);i&&function(t){h=t;const e=document.getElementById("editUserModal");document.getElementById("editDisplayName").value=t.displayName||"",document.getElementById("editUsername").value=t.username||"",document.getElementById("editBio").value=t.bio||"",document.getElementById("editAvatar").value=t.avatar||"",e.querySelectorAll('input[name="role"]').forEach(e=>{e.checked=t.roles&&t.roles.includes(e.value)}),e.classList.remove("hidden")}(i)})}),c()}function c(){const t=Math.ceil(a.length/10),e=document.getElementById("pageInfo"),i=document.getElementById("prevBtn"),n=document.getElementById("nextBtn");e.textContent=`Page ${o} of ${t||1} (${a.length} users)`,i.disabled=o<=1,n.disabled=o>=t}function d(){document.getElementById("editUserModal").classList.add("hidden"),h=null}function f(){const t=document.getElementById("userSearch").value.toLowerCase();a=t?r.filter(e=>e.username.toLowerCase().includes(t)||(e.displayName||"").toLowerCase().includes(t)||e.id.toLowerCase().includes(t)):r,o=1,u()}document.getElementById("searchBtn").addEventListener("click",f),document.getElementById("clearSearchBtn").addEventListener("click",()=>{document.getElementById("userSearch").value="",f()}),document.getElementById("userSearch").addEventListener("keyup",t=>{"Enter"===t.key&&f()}),document.getElementById("prevBtn").addEventListener("click",()=>{o>1&&(o--,u())}),document.getElementById("nextBtn").addEventListener("click",()=>{const t=Math.ceil(a.length/10);o<t&&(o++,u())}),document.getElementById("closeEditModal").addEventListener("click",d),document.getElementById("saveUserBtn").addEventListener("click",async function(){if(!h)return;const t=document.getElementById("editDisplayName").value,i=document.getElementById("editBio").value,r=document.getElementById("editAvatar").value,a=document.querySelectorAll('input[name="role"]:checked'),o=Array.from(a).map(t=>t.value);try{const a=await s("/api/admin/edit-user",{username:e,password:n,targetId:h.id,displayName:t,bio:i,avatar:r,roles:o});if(a.error)return void alert("Error: "+a.error);alert("User updated successfully!"),d(),l()}catch(t){alert("Error updating user: "+t.message)}}),document.getElementById("editUserModal").addEventListener("click",t=>{"editUserModal"===t.target.id&&d()}),l()}}),"/dashboard":Vdt,"/avatar":rft,"/profile":Jdt,"/profile-settings":tft,"/people":jut,"/dms":gft,"/about":qdt,"/help":Zdt,"/privacypolicy":lft,"/termsofservice":oft,"/404":cft,"/ping":fft,"/":{redirect:"/dashboard"}};function Tft(){const t=window.location.pathname.split("/").filter(Boolean);return"/"+(t.length?t[t.length-1]:"")}let Eft=null,Sft=null,_ft=!1;function Cft(t){if(t.defaultPrevented)return;if(0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;let e=t.target;for(;e&&"A"!==e.nodeName;)e=e.parentElement;if(!e)return;const i=e.getAttribute("href");!i||i.startsWith("http")||i.startsWith("mailto:")||i.startsWith("tel:")||(t.preventDefault(),Aft(i))}function Aft(t){t.startsWith("/")||(t=window.location.pathname.replace(/\/+$/,"")+"/"+t),window.history.pushState({},"",t),Mft()}function Mft(){const t=window.location.pathname,n=Tft();let r=bft[n]||{};if(t.startsWith("/dms/")&&"/dms"!==t){const n=t.split("/")[2],a=bft["/dms"];r={...a,render:()=>function(t){const n=document.getElementById("app");n.classList.add("no-scroll"),n.innerHTML=`\n    <div class="dm-chat-container">\n      <div class="dm-chat-header">\n        <button class="btn-back" id="back-to-dms">\n          <canv-icon src="${e.getBlob("assets/icons/arrowleft.png").dataUrl}"></canv-icon>\n        </button>\n        <div class="dm-chat-user-info">\n          <img class="dm-chat-avatar" id="chat-avatar" src="/api/pavatar/${t}" alt="User">\n          <div>\n            <div class="dm-chat-username" id="chat-username">Loading...</div>\n            <div class="dm-chat-status">Online</div>\n          </div>\n        </div>\n      </div>\n      <div class="dm-chat-messages" id="chat-messages">\n        <div class="loading">\n          <span class="loader"></span> Loading messages...\n        </div>\n      </div>\n      <div class="dm-chat-input-container">\n        <textarea \n          id="message-input" \n          class="dm-chat-input" \n          placeholder="Type a message..."\n          rows="1"\n        ></textarea>\n        <button class="btn btn-primary" id="send-message">\n          <canv-icon src="${e.getBlob("assets/icons/send.png").dataUrl}"></canv-icon>\n          Send\n        </button>\n      </div>\n    </div>\n  `;const r=document.getElementById("back-to-dms"),a=document.getElementById("chat-messages"),o=document.getElementById("message-input"),h=document.getElementById("send-message"),l=document.getElementById("chat-username");let u=[],c=null,d=null;function f(){0!==u.length?(a.innerHTML="",u.forEach(t=>{const e=function(t){const e=document.createElement("div");e.className="message"+(t.fromMe?" message-sent":" message-received");const n=function(t){const e=new Date(t);return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`}(t.timestamp);return e.innerHTML=`\n      <div class="message-content">\n        ${i(t.content)}\n      </div>\n      <div class="message-time">${n}</div>\n    `,e}(t);a.appendChild(e)})):a.innerHTML='<div class="empty-state">No messages yet. Say hi!</div>'}function p(){setTimeout(()=>{a.scrollTop=a.scrollHeight},100)}async function g(){const e=o.value.trim();if(e)try{const i=localStorage.getItem("username"),n=localStorage.getItem("password");h.disabled=!0,o.disabled=!0;const r=await s("/api/messages/send",{username:i,password:n,toUserId:t,content:e});r.messageData&&(u.push(r.messageData),f(),p(),o.value="",d&&d.readyState===WebSocket.OPEN&&d.send(JSON.stringify({type:"new_message",toUserId:t,message:r.messageData})))}catch(t){console.error("Error sending message:",t),alert("Failed to send message. Please try again.")}finally{h.disabled=!1,o.disabled=!1,o.focus()}}r.addEventListener("click",()=>{d&&d.close(),n.classList.remove("no-scroll"),window.router.navigateTo("/dms")}),h.addEventListener("click",g),o.addEventListener("keydown",t=>{"Enter"!==t.key||t.shiftKey||(t.preventDefault(),g())}),o.addEventListener("input",()=>{o.style.height="auto",o.style.height=Math.min(o.scrollHeight,120)+"px"}),async function(){try{const e=await s("/api/auth/profile",{id:t});e.id?(c=e,l.textContent=e.displayName):l.textContent="Unknown User"}catch(t){console.error("Error loading user info:",t),l.textContent="Unknown User"}}(),async function(){try{const e=localStorage.getItem("username"),i=localStorage.getItem("password");if(!e||!i)return void(a.innerHTML='<div class="error">Please log in first.</div>');const n=await s("/api/messages/get",{username:e,password:i,otherUserId:t});u=n.messages||[],f(),p()}catch(t){console.error("Error loading messages:",t),a.innerHTML='<div class="error">Failed to load messages.</div>'}}(),function e(){const i=`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}/ws/messages`;d=new WebSocket(i),d.onopen=()=>{console.log("WebSocket connected");const t=localStorage.getItem("username"),e=localStorage.getItem("password");d.send(JSON.stringify({type:"auth",username:t,password:e}))},d.onmessage=e=>{try{const i=JSON.parse(e.data);"new_message"===i.type&&i.fromUserId===t&&(u.push({id:i.message.id,content:i.message.content,timestamp:i.message.timestamp,fromMe:!1,read:!0}),f(),p())}catch(t){console.error("Error processing WebSocket message:",t)}},d.onerror=t=>{console.error("WebSocket error:",t)},d.onclose=()=>{console.log("WebSocket disconnected"),setTimeout(()=>{window.location.pathname.startsWith("/dms/")&&e()},5e3)}}()}(n),options:{...a.options,title:"Chat"}}}const a=!!localStorage.getItem("loggedIn");if("/"===n&&(a?window.history.replaceState({},"","/dashboard"):window.history.replaceState({},"","/auth")),r.redirect)return window.history.replaceState({},"",r.redirect),Mft();if(r.options?.auth&&!a)return window.history.replaceState({},"","/auth"),Mft();if(!r.options?.auth&&a&&"/auth"===n)return window.history.replaceState({},"","/dashboard"),Mft();if(r.options?.superadmin&&a){const t=localStorage.getItem("username"),e=localStorage.getItem("password");return void fetch(`/api/auth/roles?username=${encodeURIComponent(t)}&password=${encodeURIComponent(e)}`).then(t=>t.json()).then(t=>{!t.error&&t.roles&&t.roles.includes("superadmin")?Pft():(window.history.replaceState({},"","/dashboard"),Mft())}).catch(()=>{window.history.replaceState({},"","/dashboard"),Mft()})}Pft()}function Pft(){const t=Tft(),i=bft[t]||{};if(!i.render)return window.history.replaceState({},"","/404"),Mft();document.title="Hawk - "+i.options?.title,localStorage.getItem("display_name");const r=document.getElementById("app");r&&r.classList.add("hidden"),setTimeout(()=>{(function(){if(!_ft){document.body.innerHTML="",Eft=function(){const t=localStorage.getItem("loggedIn"),i=document.createElement("nav");i.className="main-nav",i.innerHTML=`\n    <div class="nav-brand">\n      <div class="nav-icon">\n        <img src="${e.getBlob("logo.svg").dataUrl}" alt="Hawk" width="auto" height="28">\n      </div>\n      <p class="nav-title">Hawk</p>\n    </div>\n    \n    ${t?`\n    <div class="nav-links">\n      <a href="/dashboard" class="nav-link">\n        <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/generalinfo.png").dataUrl}"></canv-icon>\n        <span>Dashboard</span>\n      </a>\n      <a href="/people" class="nav-link">\n        <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/people.png").dataUrl}"></canv-icon>\n        <span>People</span>\n      </a>\n      <a href="/dms" class="nav-link">\n        <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/message.png").dataUrl}"></canv-icon>\n        <span>Messages</span>\n      </a>\n    </div>\n    `:""}\n    \n    <div class="nav-dropdown">\n      <button id="dropdownBtn" class="nav-dropdown-btn">\n        ${t?'\n        <div id="user" class="nav-user">\n          <img id="pavatar" class="nav-avatar" alt="Profile"></img>\n          <span class="nav-username" id="displayName"></span>\n        </div>\n        ':"\n        "}\n        <div class="hamburger-menu">\n          <span class="bar bar1"></span>\n          <span class="bar bar2"></span>\n          <span class="bar bar3"></span>\n        </div>\n      </button>\n      <div id="dropdownMenu" class="dropdown-menu">\n        ${t?`\n        <div class="dropdown-category">\n          <div class="dropdown-category-title">Main</div>\n          <a href="/dashboard" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/generalinfo.png").dataUrl}"></canv-icon>\n            <span>Dashboard</span>\n          </a>\n        </div>\n        <div class="dropdown-divider"></div>\n        <div class="dropdown-category">\n          <div class="dropdown-category-title">Social</div>\n          <a href="/profile" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/Person.png").dataUrl}"></canv-icon>\n            <span>Profile</span>\n          </a>\n          <a href="/people" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/people.png").dataUrl}"></canv-icon>\n            <span>People</span>\n          </a>\n          <a href="/dms" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/message.png").dataUrl}"></canv-icon>\n            <span>Messages</span>\n          </a>\n        </div>\n        <div class="dropdown-divider"></div>\n        <div class="dropdown-category">\n          <div class="dropdown-category-title">Customize</div>\n          <a href="/avatar" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/createemoji.png").dataUrl}"></canv-icon>\n            <span>Avatar</span>\n          </a>\n          <a href="/profile-settings" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/settings.png").dataUrl}"></canv-icon>\n            <span>Settings</span>\n          </a>\n        </div>\n        <div class="dropdown-divider"></div>\n        <a id="logoutBtn" class="dropdown-item dropdown-item-danger">\n          <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/leave.png").dataUrl}"></canv-icon>\n          <span>Logout</span>\n        </a>\n        `:`\n        <div class="dropdown-category">\n          <div class="dropdown-category-title">Get Started</div>\n          <a href="/auth" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/join.png").dataUrl}"></canv-icon>\n            <span>Auth</span>\n          </a>\n        </div>\n        <div class="dropdown-divider"></div>\n        `}\n        <div class="dropdown-category">\n          <div class="dropdown-category-title">Info</div>\n          <a href="/about" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>\n            <span>About</span>\n          </a>\n          <a href="/help" class="dropdown-item">\n            <canv-icon id="auth-icon" src="${e.getBlob("assets/icons/info.png").dataUrl}"></canv-icon>\n            <span>Help</span>\n          </a>\n        </div>\n      </div>\n    </div>\n  `;const r=i.querySelector("#dropdownBtn"),a=i.querySelector("#dropdownMenu"),o=r?r.querySelector(".hamburger-menu"):null;return r.addEventListener("click",t=>{t.stopPropagation(),a.style.display="block"===a.style.display?"none":"block",o.className="block"===a.style.display?"hamburger-menu open":"hamburger-menu"}),document.addEventListener("click",()=>{a.style.display="none",o.className="block"===a.style.display?"hamburger-menu open":"hamburger-menu"}),t&&(i.querySelector("#logoutBtn").addEventListener("click",()=>{localStorage.removeItem("loggedIn"),localStorage.removeItem("username"),localStorage.removeItem("password"),window.location="/"}),s(p,n()).then(t=>{const e=document.getElementById("displayName"),i=document.getElementById("pavatar");e.innerText=t.displayName,i.src="/api/pavatar/"+t.id})),i}(),document.body.appendChild(Eft);const t=document.createElement("main");t.id="app",document.body.appendChild(t),Sft=document.createElement("footer"),Sft.className="site-footer",Sft.innerHTML=`\n      <div class="footer-top">\n        <div class="brand">\n          <img src="${e.getBlob("logo.svg").dataUrl}" alt="Logo" class="footer-logo">\n          <span class="brand-name">Hawk</span>\n        </div>\n        <div class="right-side">\n        </div>\n      </div>\n      <div class="footer-bottom">\n        <div class="authors">\n          Â© ${(new Date).getFullYear()} â tsumugi_dev\n        </div>\n        <div class="extras">\n          <p>0.17.6-beta Â· assets-${w}</p>\n          <a href="/termsofservice">Terms Of Service</a> Â· <a href="/privacypolicy">Privacy Policy</a> Â· <a href="${v}">Discord</a>\n        </div>\n      </div>\n    `,Sft.style.marginTop="170px",document.body.appendChild(Sft),document.body.addEventListener("click",Cft),_ft=!0}})(),function(){const t=document.getElementById("app");t&&(t.innerHTML="")}();const t=document.getElementById("app");t&&t.classList.remove("no-scroll"),i.render(),setTimeout(()=>{t&&t.classList.remove("hidden")},500)},500)}window.router={navigateTo:Aft},window.addEventListener("popstate",()=>{Mft()});var Rft={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};function Lft(){if("function"==typeof importScripts)return Rft;var t=navigator.userAgent;/Windows/.test(t)?Rft.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(Rft.iOS=!0,Rft.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),Rft.iOSVersion=parseInt(RegExp.$1,10)):Rft.macOS=!0:/Android/.test(t)?Rft.android=!0:/Linux/.test(t)?Rft.linux=!0:/iP[ao]d|iPhone/i.test(t)?(Rft.iOS=!0,navigator.appVersion.match(/OS (\d+)/),Rft.iOSVersion=parseInt(RegExp.$1,10),Rft.iPhone=-1!==t.toLowerCase().indexOf("iphone"),Rft.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?Rft.kindle=!0:/CrOS/.test(t)&&(Rft.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(Rft.android=!1,Rft.iOS=!1,Rft.macOS=!1,Rft.windows=!0,Rft.windowsPhone=!0);var e=/Silk/.test(t);return(Rft.windows||Rft.macOS||Rft.linux&&!e||Rft.chromeOS)&&(Rft.desktop=!0),(Rft.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(Rft.desktop=!1),navigator.standalone&&(Rft.webApp=!0),"function"!=typeof importScripts&&(void 0!==window.cordova&&(Rft.cordova=!0),void 0!==window.ejecta&&(Rft.ejecta=!0)),"undefined"!=typeof process&&process.versions&&process.versions.node&&(Rft.node=!0),Rft.node&&"object"==typeof process.versions&&(Rft.nodeWebkit=!!process.versions["node-webkit"],Rft.electron=!!process.versions.electron),/Crosswalk/.test(t)&&(Rft.crosswalk=!0),Rft.pixelRatio=window.devicePixelRatio||1,Rft}var Oft={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0,es2019:!1};function Fft(){var t=navigator.userAgent;return/Edg\/\d+/.test(t)?(Oft.edge=!0,Oft.es2019=!0):/OPR/.test(t)?(Oft.opera=!0,Oft.es2019=!0):/Chrome\/(\d+)/.test(t)&&!Lft().windowsPhone?(Oft.chrome=!0,Oft.chromeVersion=parseInt(RegExp.$1,10),Oft.es2019=Oft.chromeVersion>69):/Firefox\D+(\d+)/.test(t)?(Oft.firefox=!0,Oft.firefoxVersion=parseInt(RegExp.$1,10),Oft.es2019=Oft.firefoxVersion>10):/AppleWebKit\/(?!.*CriOS)/.test(t)&&Lft().iOS?(Oft.mobileSafari=!0,Oft.es2019=!0):/MSIE (\d+\.\d+);/.test(t)?(Oft.ie=!0,Oft.ieVersion=parseInt(RegExp.$1,10)):/Version\/(\d+\.\d+(\.\d+)?) Safari/.test(t)&&!Lft().windowsPhone?(Oft.safari=!0,Oft.safariVersion=parseInt(RegExp.$1,10),Oft.es2019=Oft.safariVersion>10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t)&&(Oft.ie=!0,Oft.trident=!0,Oft.tridentVersion=parseInt(RegExp.$1,10),Oft.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(t)&&(Oft.silk=!0),Oft}var kft={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,stableSort:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};const Dft=["assets/icons/0.png","assets/icons/1.png","assets/icons/10.png","assets/icons/18.png","assets/icons/2.png","assets/icons/3.png","assets/icons/4.png","assets/icons/5.png","assets/icons/6.png","assets/icons/7.png","assets/icons/8.png","assets/icons/9.png","assets/icons/Bugs.png","assets/icons/Correct.png","assets/icons/DAC.png","assets/icons/Discord.png                               ./public/assets/icons/Download.png","assets/icons/Female.png","assets/icons/Guardian.png","assets/icons/HSbalance.png","assets/icons/HSbravery.png","assets/icons/HSbrilliance.png","assets/icons/MSvisualcode.png","assets/icons/Male.png","assets/icons/New.png","assets/icons/OAuth2.png","assets/icons/Person.png","assets/icons/Wrong.png","assets/icons/a.png","assets/icons/activedevbadge.png","assets/icons/activities.png","assets/icons/addreactions.png","assets/icons/aka.png","assets/icons/amogus.png","assets/icons/announce.png","assets/icons/archive.png","assets/icons/audiodisable.png","assets/icons/audioenable.png","assets/icons/award.png","assets/icons/awardcup.png","assets/icons/b.png","assets/icons/backforward.png","assets/icons/badping.png","assets/icons/ban.png","assets/icons/bank.png","assets/icons/banmembers.png","assets/icons/bday.png","assets/icons/behance.png","assets/icons/beta.png","assets/icons/beta1.png","assets/icons/beta1A.png","assets/icons/beta2.png","assets/icons/beta2A.png","assets/icons/bigender.png","assets/icons/birdman.png","assets/icons/book.png","assets/icons/bookmark.png","assets/icons/bots.png","assets/icons/box.png","assets/icons/bright.png","assets/icons/bulb.png","assets/icons/busy.png","assets/icons/c.png","assets/icons/calendar1.png","assets/icons/calender.png","assets/icons/calenderdate.png","assets/icons/callconnect.png","assets/icons/calldecline.png","assets/icons/calldisconnect.png","assets/icons/camera.png","assets/icons/channel.png","assets/icons/channelfollowed.png","assets/icons/clean.png","assets/icons/clock.png","assets/icons/clouddown.png","assets/icons/cmd.png","assets/icons/code.png","assets/icons/coin.png","assets/icons/colorboostnitro.png","assets/icons/colornitro.png","assets/icons/colorserverpartner.png","assets/icons/colorserververified.png","assets/icons/colorstaff.png","assets/icons/connect.png","assets/icons/control.png","assets/icons/createcategory.png","assets/icons/createchannel.png","assets/icons/createchannels.png","assets/icons/createemoji.png","assets/icons/createintegration.png","assets/icons/createrole.png","assets/icons/createsticker.png","assets/icons/createthread.png","assets/icons/createwebhook.png","assets/icons/creditcard.png","assets/icons/customstaff.png","assets/icons/d.png","assets/icons/dblurple.png","assets/icons/defaultperms.png","assets/icons/delete.png","assets/icons/deletechannel.png","assets/icons/deleteemoji.png","assets/icons/deleteevent.png","assets/icons/deleteintegration.png","assets/icons/deleterole.png","assets/icons/deletesticker.png","assets/icons/deletethread.png","assets/icons/deletewebhook.png","assets/icons/dfuchsia.png","assets/icons/dgreen.png","assets/icons/disable.png","assets/icons/discordbotdev.png","assets/icons/discordbughunter.png","assets/icons/discordhypesquard.png","assets/icons/discordjs.png","assets/icons/discordmod.png","assets/icons/discordnitro.png","assets/icons/discordpartner.png","assets/icons/discordstaff.png","assets/icons/discover.png","assets/icons/dislike.png","assets/icons/djoin.png","assets/icons/dleave.png","assets/icons/dollar.png","assets/icons/downarrow.png","assets/icons/downvote.png","assets/icons/dred.png","assets/icons/dwhite.png","assets/icons/dyellow.png","assets/icons/e.png","assets/icons/earlysupporter.png","assets/icons/edit.png","assets/icons/education.png","assets/icons/emojiguardian.png","assets/icons/enable.png","assets/icons/endstage.png","assets/icons/eventcolour.png","assets/icons/exclamation.png","assets/icons/f.png","assets/icons/fb.png","assets/icons/figma.png","assets/icons/file.png","assets/icons/files.png","assets/icons/fingerprint.png","assets/icons/fire.png","assets/icons/flag.png","assets/icons/folder.png","assets/icons/forum.png","assets/icons/forumNFSW.png","assets/icons/friends.png","assets/icons/frontforward.png","assets/icons/fword.png","assets/icons/g.png","assets/icons/games.png","assets/icons/gay.png","assets/icons/gender.png","assets/icons/generalinfo.png","assets/icons/gif.png","assets/icons/gift.png","assets/icons/gitbranch.png","assets/icons/gitcommit.png","assets/icons/github.png","assets/icons/gitmerge.png","assets/icons/gitpullrequest.png","assets/icons/globe.png","assets/icons/goodping.png","assets/icons/growth.png","assets/icons/h.png","assets/icons/hammer.png","assets/icons/he_him.png","assets/icons/headphone.png","assets/icons/headphonedeafen.png","assets/icons/heart.png","assets/icons/hetero.png","assets/icons/hi.png","assets/icons/hoursglass.png","assets/icons/hyphen.png","assets/icons/i.png","assets/icons/id.png","assets/icons/idelping.png","assets/icons/idle.png","assets/icons/illustrator.png","assets/icons/image.png","assets/icons/info.png","assets/icons/instagram.png","assets/icons/invite.png","assets/icons/j.png","assets/icons/join.png","assets/icons/jpg.png","assets/icons/js.png","assets/icons/k.png","assets/icons/kick.png","assets/icons/kicking.png","assets/icons/kofi.png","assets/icons/l.png","assets/icons/leave.png","assets/icons/leftarrow.png","assets/icons/lesbian.png","assets/icons/library.png","assets/icons/like.png","assets/icons/link.png","assets/icons/linkadd.png","assets/icons/linked.png","assets/icons/linkrevoke.png","assets/icons/linkupdate.png","assets/icons/list.png","assets/icons/live.png","assets/icons/loading.png","assets/icons/loadingerror.png","assets/icons/locked.png","assets/icons/loop.png","assets/icons/m.png","assets/icons/magicwand.png","assets/icons/markasread.png","assets/icons/mashroomman.png","assets/icons/mentalhealth.png","assets/icons/menu.png","assets/icons/message.png","assets/icons/mic.png","assets/icons/micmute.png","assets/icons/moderationhig.png","assets/icons/moderationhighest.png","assets/icons/moderationlow.png","assets/icons/moderationmedium.png","assets/icons/moderationnone.png","assets/icons/monitor.png","assets/icons/music.png","assets/icons/musicstop.png","assets/icons/n.png","assets/icons/new1.png","assets/icons/new1A.png","assets/icons/new2.png","assets/icons/new2A.png","assets/icons/newmembers.png","assets/icons/news1.png","assets/icons/news2.png","assets/icons/night.png","assets/icons/nitro.png","assets/icons/nitroboost.png","assets/icons/nodejs.png","assets/icons/notificationsettings.png","assets/icons/notify.png","assets/icons/o.png","assets/icons/off.png","assets/icons/offline.png","assets/icons/on.png","assets/icons/online.png","assets/icons/outage.png","assets/icons/owner.png","assets/icons/p.png","assets/icons/paintpadbrush.png","assets/icons/partner.png","assets/icons/patreon.png","assets/icons/pause.png","assets/icons/paypal.png","assets/icons/pen.png","assets/icons/people.png","assets/icons/photoshop.png","assets/icons/pin.png","assets/icons/ping.png","assets/icons/pings.png","assets/icons/plant.png","assets/icons/play.png","assets/icons/plus.png","assets/icons/png.png","assets/icons/podcast.png","assets/icons/premium.png","assets/icons/premiumchannel.png","assets/icons/q.png","assets/icons/question.png","assets/icons/queue.png","assets/icons/quotes.png","assets/icons/r.png","assets/icons/rVIP.png","assets/icons/radmins.png","assets/icons/rartists.png","assets/icons/rboosters.png","assets/icons/rbots.png","assets/icons/rcamera.png","assets/icons/rdevelopers.png","assets/icons/reddit.png","assets/icons/reminder.png","assets/icons/repeat.png","assets/icons/repeatonce.png","assets/icons/reply.png","assets/icons/revents.png","assets/icons/rfire.png","assets/icons/rguardians.png","assets/icons/rhelpers.png","assets/icons/richpresence.png","assets/icons/rightarrow.png","assets/icons/rmembers.png","assets/icons/rmods.png","assets/icons/roles.png","assets/icons/rowner.png","assets/icons/rpodcast.png","assets/icons/rsdonator.png","assets/icons/rspartner.png","assets/icons/rsstaffs.png","assets/icons/rstaff.png","assets/icons/rules.png","assets/icons/rverification.png","assets/icons/rverified.png","assets/icons/s.png","assets/icons/saturn.png","assets/icons/scheduleevent.png","assets/icons/screenshare.png","assets/icons/search.png","assets/icons/sentry.png","assets/icons/serverinsight.png","assets/icons/servermute.png","assets/icons/serverpartner.png","assets/icons/serververified.png","assets/icons/settings.png","assets/icons/share.png","assets/icons/she_her.png","assets/icons/shine1.png","assets/icons/shine2.png","assets/icons/shine3.png","assets/icons/shuffle.png","assets/icons/slashcmd.png","assets/icons/snapchat.png","assets/icons/snowflake.png","assets/icons/spark.png","assets/icons/speaker.png","assets/icons/speakerlock.png","assets/icons/speakerlow.png","assets/icons/speakermute.png","assets/icons/splash.png","assets/icons/spotify.png","assets/icons/stageleave.png","assets/icons/stagelocked.png","assets/icons/stagemoderator.png","assets/icons/stagemoveaudience.png","assets/icons/stagemovespeaker.png","assets/icons/stagerequesttospeak.png","assets/icons/stagerequesttospeaklist.png","assets/icons/star.png","assets/icons/startstage.png","assets/icons/statsdown.png","assets/icons/stickers.png","assets/icons/store.png","assets/icons/stream.png","assets/icons/supportscommandsbadge.png","assets/icons/supportteam.png","assets/icons/swardx.png","assets/icons/t.png","assets/icons/tada.png","assets/icons/text1.png","assets/icons/text2.png","assets/icons/text3.png","assets/icons/text4.png","assets/icons/text5.png","assets/icons/text6.png","assets/icons/they_them.png","assets/icons/threadchannel.png","assets/icons/ticket.png","assets/icons/tiktok.png","assets/icons/tilde.png","assets/icons/timeout.png","assets/icons/todolist.png","assets/icons/topgg.png","assets/icons/transferownership.png","assets/icons/transgender.png","assets/icons/translate.png","assets/icons/twitch.png","assets/icons/twitter.png","assets/icons/u.png","assets/icons/unbanmember.png","assets/icons/unlock.png","assets/icons/uparrow.png","assets/icons/update.png","assets/icons/update1.png","assets/icons/update2.png","assets/icons/updatechannel.png","assets/icons/updateemoji.png","assets/icons/updateevent.png","assets/icons/updateintegration.png","assets/icons/updatemember.png","assets/icons/updaterole.png","assets/icons/updateserver.png","assets/icons/updatestage.png","assets/icons/updatesticker.png","assets/icons/updatethread.png","assets/icons/updatewebhook.png","assets/icons/upvote.png","assets/icons/v.png","assets/icons/verified.png","assets/icons/video.png","assets/icons/view.png","assets/icons/vip.png","assets/icons/vklogo.png","assets/icons/vpn.png","assets/icons/w.png","assets/icons/warning.png","assets/icons/wave.png","assets/icons/webp.png","assets/icons/wumpus.png","assets/icons/x.png","assets/icons/xmarkwhite.png","assets/icons/y.png","assets/icons/youtube.png","assets/icons/z.png"],Ift=document.createElement("canvas"),Bft=Ift.getContext("2d",{willReadFrequently:!0});class Nft extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const t=this.getAttribute("src"),e=this.getAttribute("color"),i=document.createElement("img");i.src=t,i.style.width="2em",i.style.height="2em",i.style.verticalAlign="middle",i.style.marginRight="5px",i.onload=()=>{Ift.width=128,Ift.height=128,Bft.drawImage(i,0,0);const t=Bft.getImageData(0,0,Ift.width,Ift.height);for(let e=0;e<t.data.length;e+=4){const i=(t.data[e]+t.data[e+1]+t.data[e+2])/3;t.data[e+3]=i<64?0:255}if(Bft.putImageData(t,0,0),e){const[t,i,n]=function(t){const e=t.replace("#",""),i=parseInt(e,16);return[i>>16&255,i>>8&255,255&i]}(e),s=Bft.getImageData(0,0,Ift.width,Ift.height);for(let e=0;e<s.data.length;e+=4)s.data[e+3]>0&&(s.data[e]=t,s.data[e+1]=i,s.data[e+2]=n);Bft.putImageData(s,0,0)}const n=document.createElement("img");n.src=Ift.toDataURL(),n.style.width="2em",n.style.height="2em",n.style.verticalAlign="middle",n.style.marginRight="5px",this.shadowRoot.innerHTML="",this.shadowRoot.appendChild(n)}}}window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),window.deferredInstallPrompt=t}),window.addEventListener("DOMContentLoaded",async()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(t=>{}).catch(t=>{console.error("Error registering service worker:",t)});const t=document.getElementById("loading");function i(){t.querySelector("#tip").innerHTML=function(t){return t[Math.floor(Math.random()*t.length)]}(x)}t.querySelector("#tip-title").innerHTML="DID YOU KNOW";const n=setInterval(()=>i(),5e3);i(),customElements.define("canv-icon",Nft);let s=[];const r=function(){if("function"==typeof importScripts)return kft;kft.canvas=!!window.CanvasRenderingContext2D;try{kft.localStorage=!!localStorage.getItem}catch(t){kft.localStorage=!1}kft.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),kft.fileSystem=!!window.requestFileSystem;var t,e,i,n=!1;return kft.webGL=function(){if(window.WebGLRenderingContext)try{var t=document.createElement("canvas"),e=t.getContext("webgl")||t.getContext("experimental-webgl"),i=document.createElement("canvas").getContext("2d",{willReadFrequently:!0}).createImageData(1,1);return n=i.data instanceof Uint8ClampedArray,!!e}catch(t){return!1}return!1}(),kft.worker=!!window.Worker,kft.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,kft.getUserMedia=kft.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,Fft().firefox&&Fft().firefoxVersion<21&&(kft.getUserMedia=!1),!Lft().iOS&&(Fft().ie||Fft().firefox||Fft().chrome)&&(kft.canvasBitBltShift=!0),(Fft().safari||Fft().mobileSafari)&&(kft.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(kft.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(kft.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),i=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===i[0]||2712847316!==i[0]&&null)),kft.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==kft.littleEndian&&n,kft}();if(r.canvas||s.push("2D_CONTEXT_ERROR"),r.localStorage||s.push("LOCAL_STORAGE_NOT_FOUND"),r.webGL||s.push("WEBGL_CONTEXT_ERROR"),r.file||s.push("FILE_SYSTEM_ERROR"),s.length){const e=document.createElement("main");e.id="app",e.className="when-error",e.innerHTML=`\n      <main class="main">\n        <div class="header">\n          <h3>Aw man :(</h3>\n        </div>\n        <p>Your browser is not compatible with <span class="highlight">Hawk Engine</span>.</p>\n        <div class="try-footer">\n          <p>You can try:</p>                                                                        \n          <p>- <a href="/assets/wah.png">View a cute cat</a>.</p>\n        </div>\n        <br>\n        <small class="accent">${s.join(", ")}</small>\n      </main>\n    `,document.body.appendChild(e),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(n),t.remove()})}else await e.load(w,["assets/entities/bee.png","assets/fonts/at02.png","assets/fonts/at02.xml","assets/game/props.png","assets/game/plants.png","assets/game/building.png","assets/game/terrain.png","assets/game/animated.png","assets/game/grass2.png","assets/game/dirt.png","assets/game/grass2_snow.png","assets/game/dirt_snow.png","assets/masks/lightMask.png","assets/masks/flame.png","assets/masks/candle_flame.png","assets/masks/water_foam.png","assets/masks/smoke.png","assets/masks/smoke_ramp.png","assets/masks/lightMask_o.png","assets/tilemap.png","assets/ui/main.png","assets/wah.png","styles/main.css","logo.png","logo.svg","banner.png",...Dft],e=>{t.querySelector("#loading-bar div").style.width=e.percentage+"%"}),t.classList.add("hidden"),t.addEventListener("transitionend",()=>{clearInterval(n),t.remove()}),Mft()});